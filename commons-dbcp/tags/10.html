<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestBasicDataSource </h4><pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidationQueryTimoutFail(){
  ds.setTestOnBorrow(true);
  ds.setValidationQueryTimeout(3);
  try (Connection c=ds.getConnection()){
    fail("expected SQLException");
  }
 catch (  SQLException ex) {
    if (ex.toString().indexOf("timeout") < 0) {
      fail("expected timeout error message");
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetProperties() throws Exception {
  ds.setConnectionProperties("name1=value1;name2=value2;name3=value3");
  assertEquals(3,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("value2",ds.getConnectionProperties().getProperty("name2"));
  assertEquals("value3",ds.getConnectionProperties().getProperty("name3"));
  ds.setConnectionProperties("name1=value1;name2=value2");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("value2",ds.getConnectionProperties().getProperty("name2"));
  assertFalse(ds.getConnectionProperties().containsKey("name3"));
  ds.setConnectionProperties("name1=value1;name2");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("",ds.getConnectionProperties().getProperty("name2"));
  ds.setConnectionProperties("name1=value1;name2=");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("",ds.getConnectionProperties().getProperty("name2"));
  ds.setConnectionProperties("name1=value1");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  ds.setConnectionProperties("name1=value1;");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  ds.setConnectionProperties("name1");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("",ds.getConnectionProperties().getProperty("name1"));
  try {
    ds.setConnectionProperties(null);
    fail("Expected NullPointerException");
  }
 catch (  NullPointerException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidConnectionInitSql(){
  try {
    ds.setConnectionInitSqls(Arrays.asList(new String[]{"SELECT 1","invalid"}));
    try (Connection c=ds.getConnection()){
    }
     fail("expected SQLException");
  }
 catch (  SQLException e) {
    if (e.toString().indexOf("invalid") < 0) {
      fail("expected detailed error message");
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-8 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bugzilla Bug 29832: Broken behaviour for BasicDataSource.setMaxTotal(0)
 * MaxTotal == 0 should throw SQLException on getConnection.
 * Results from Bug 29863 in commons-pool.
 */
@Test public void testMaxTotalZero() throws Exception {
  ds.setMaxTotal(0);
  try {
    Connection conn=ds.getConnection();
    assertNotNull(conn);
    fail("SQLException expected");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-10 type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsClosedFailure() throws SQLException {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  assertEquals(1,ds.getNumActive());
  TesterConnection tconn=(TesterConnection)((DelegatingConnection<?>)conn).getInnermostDelegate();
  tconn.setFailure(new IOException("network error"));
  try {
    conn.close();
    fail("Expected SQLException");
  }
 catch (  SQLException ex) {
  }
  assertEquals(0,ds.getNumActive());
}

</code></pre>

<br>
<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClose() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection activeConnection=getConnection();
  Connection rawActiveConnection=((DelegatingConnection<?>)activeConnection).getInnermostDelegate();
  assertFalse(activeConnection.isClosed());
  assertFalse(rawActiveConnection.isClosed());
  Connection idleConnection=getConnection();
  Connection rawIdleConnection=((DelegatingConnection<?>)idleConnection).getInnermostDelegate();
  assertFalse(idleConnection.isClosed());
  assertFalse(rawIdleConnection.isClosed());
  idleConnection.close();
  assertTrue(idleConnection.isClosed());
  assertFalse(rawIdleConnection.isClosed());
  ds.close();
  assertTrue(rawIdleConnection.isClosed());
  assertFalse(activeConnection.isClosed());
  assertFalse(rawActiveConnection.isClosed());
  activeConnection.close();
  assertTrue(activeConnection.isClosed());
  assertTrue(rawActiveConnection.isClosed());
  try {
    getConnection();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
  }
  ds.close();
}

</code></pre>

<br>
<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidValidationQuery(){
  ds.setValidationQuery("invalid");
  try (Connection c=ds.getConnection()){
    fail("expected SQLException");
  }
 catch (  SQLException e) {
    if (e.toString().indexOf("invalid") < 0) {
      fail("expected detailed error message");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestConnectionPool </h4><pre class="type-9 type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testThreaded(){
  TestThread[] threads=new TestThread[getMaxTotal()];
  for (int i=0; i < threads.length; i++) {
    threads[i]=new TestThread(50,50);
    Thread t=new Thread(threads[i]);
    t.start();
  }
  for (int i=0; i < threads.length; i++) {
    while (!(threads[i]).complete()) {
      try {
        Thread.sleep(100L);
      }
 catch (      Exception e) {
      }
    }
    if (threads[i] != null && threads[i].failed()) {
      fail("Thread failed: " + i);
    }
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimple2() throws Exception {
  Connection conn=newConnection();
  assertNotNull(conn);
{
    PreparedStatement stmt=conn.prepareStatement("select * from dual");
    assertNotNull(stmt);
    ResultSet rset=stmt.executeQuery();
    assertNotNull(rset);
    assertTrue(rset.next());
    rset.close();
    stmt.close();
  }
{
    PreparedStatement stmt=conn.prepareStatement("select * from dual");
    assertNotNull(stmt);
    ResultSet rset=stmt.executeQuery();
    assertNotNull(rset);
    assertTrue(rset.next());
    rset.close();
    stmt.close();
  }
  conn.close();
  try (Statement s=conn.createStatement()){
    fail("Can't use closed connections");
  }
 catch (  SQLException e) {
  }
  conn=newConnection();
  assertNotNull(conn);
{
    PreparedStatement stmt=conn.prepareStatement("select * from dual");
    assertNotNull(stmt);
    ResultSet rset=stmt.executeQuery();
    assertNotNull(rset);
    assertTrue(rset.next());
    rset.close();
    stmt.close();
  }
{
    PreparedStatement stmt=conn.prepareStatement("select * from dual");
    assertNotNull(stmt);
    ResultSet rset=stmt.executeQuery();
    assertNotNull(rset);
    assertTrue(rset.next());
    rset.close();
    stmt.close();
  }
  conn.close();
  conn=null;
}

</code></pre>

<br>
<pre class="type-9 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxTotal() throws Exception {
  Connection[] c=new Connection[getMaxTotal()];
  for (int i=0; i < c.length; i++) {
    c[i]=newConnection();
    assertTrue(c[i] != null);
  }
  try {
    newConnection();
    fail("Allowed to open more than DefaultMaxTotal connections.");
  }
 catch (  java.sql.SQLException e) {
  }
  for (  Connection element : c) {
    element.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestDelegatingConnection </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify fix for DBCP-241
 */
@Test public void testCheckOpenNull() throws Exception {
  try {
    conn.close();
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is closed."));
  }
  try {
    conn=new DelegatingConnection<>(null);
    conn.setClosedInternal(true);
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is null."));
  }
  try {
    PoolingConnection pc=new PoolingConnection(delegateConn2);
    pc.setStatementPool(new GenericKeyedObjectPool<>(pc));
    conn=new DelegatingConnection<>(pc);
    pc.close();
    conn.close();
    try (PreparedStatement ps=conn.prepareStatement("")){
    }
     fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is closed."));
  }
  try {
    conn=new DelegatingConnection<>(new RTEGeneratingConnection());
    conn.close();
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
    assertTrue(ex.getMessage().endsWith("is closed."));
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCheckOpen() throws Exception {
  conn.checkOpen();
  conn.close();
  try {
    conn.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestDelegatingStatement </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCheckOpen() throws Exception {
  stmt.checkOpen();
  stmt.close();
  try {
    stmt.checkOpen();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPStmtPooling </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClosePool() throws Exception {
  DriverManager.registerDriver(new TesterDriver());
  ConnectionFactory connFactory=new DriverManagerConnectionFactory("jdbc:apache:commons:testdriver","u1","p1");
  PoolableConnectionFactory pcf=new PoolableConnectionFactory(connFactory,null);
  pcf.setPoolStatements(true);
  pcf.setDefaultReadOnly(Boolean.FALSE);
  pcf.setDefaultAutoCommit(Boolean.TRUE);
  ObjectPool<PoolableConnection> connPool=new GenericObjectPool<>(pcf);
  pcf.setPool(connPool);
  PoolingDataSource<?> ds=new PoolingDataSource<>(connPool);
  ((PoolingDataSource<?>)ds).setAccessToUnderlyingConnectionAllowed(true);
  Connection conn=ds.getConnection();
  try (Statement s=conn.prepareStatement("select 1 from dual")){
  }
   Connection poolableConnection=((DelegatingConnection<?>)conn).getDelegate();
  Connection poolingConnection=((DelegatingConnection<?>)poolableConnection).getDelegate();
  poolingConnection.close();
  try (PreparedStatement ps=conn.prepareStatement("select 1 from dual")){
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
    assertTrue(ex.getMessage().endsWith("invalid PoolingConnection."));
  }
  ds.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPStmtPoolingBasicDataSource </h4><pre class="type-2 type-10 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreparedStatementPooling() throws Exception {
  Connection conn=getConnection();
  assertNotNull(conn);
  PreparedStatement stmt1=conn.prepareStatement("select 'a' from dual");
  assertNotNull(stmt1);
  PreparedStatement stmt2=conn.prepareStatement("select 'b' from dual");
  assertNotNull(stmt2);
  assertTrue(stmt1 != stmt2);
  PreparedStatement stmt3=null;
  try (PreparedStatement ps=conn.prepareStatement("select 'c' from dual")){
    fail("expected SQLException");
  }
 catch (  SQLException e) {
  }
  stmt2.close();
  stmt3=conn.prepareStatement("select 'c' from dual");
  assertNotNull(stmt3);
  assertTrue(stmt3 != stmt1);
  assertTrue(stmt3 != stmt2);
  stmt1.close();
  PreparedStatement stmt4=conn.prepareStatement("select 'a' from dual");
  assertNotNull(stmt4);
}

</code></pre>

<br>
<pre class="type-2 type-10 type-13 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies that the prepared statement pool behaves as an LRU cache,
 * closing least-recently-used statements idle in the pool to make room
 * for new ones if necessary.
 */
@Test public void testLRUBehavior() throws Exception {
  ds.setMaxOpenPreparedStatements(3);
  Connection conn=getConnection();
  assertNotNull(conn);
  PreparedStatement stmt1=conn.prepareStatement("select 'a' from dual");
  PreparedStatement inner1=(PreparedStatement)((DelegatingPreparedStatement)stmt1).getInnermostDelegate();
  PreparedStatement stmt2=conn.prepareStatement("select 'b' from dual");
  PreparedStatement inner2=(PreparedStatement)((DelegatingPreparedStatement)stmt2).getInnermostDelegate();
  PreparedStatement stmt3=conn.prepareStatement("select 'c' from dual");
  PreparedStatement inner3=(PreparedStatement)((DelegatingPreparedStatement)stmt3).getInnermostDelegate();
  stmt1.close();
  Thread.sleep(100);
  stmt2.close();
  Thread.sleep(100);
  stmt3.close();
  PreparedStatement stmt4=conn.prepareStatement("select 'd' from dual");
  assertNotNull(stmt4);
  try {
    inner1.clearParameters();
    fail("expecting SQLExcption - statement should be closed");
  }
 catch (  SQLException ex) {
  }
  inner2.clearParameters();
  inner3.clearParameters();
  PreparedStatement stmt5=conn.prepareStatement("select 'a' from dual");
  PreparedStatement inner5=(PreparedStatement)((DelegatingPreparedStatement)stmt5).getInnermostDelegate();
  assertNotSame(inner5,inner1);
  try {
    inner2.clearParameters();
    fail("expecting SQLExcption - statement should be closed");
  }
 catch (  SQLException ex) {
  }
  inner3.clearParameters();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPoolableConnection </h4><pre class="type-10 type-8 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFastFailValidationCustomCodes() throws Exception {
  pool.setTestOnReturn(true);
  PoolableConnectionFactory factory=(PoolableConnectionFactory)pool.getFactory();
  factory.setFastFailValidation(true);
  ArrayList<String> disconnectionSqlCodes=new ArrayList<>();
  disconnectionSqlCodes.add("XXX");
  factory.setDisconnectionSqlCodes(disconnectionSqlCodes);
  PoolableConnection conn=pool.borrowObject();
  TesterConnection nativeConnection=(TesterConnection)conn.getInnermostDelegate();
  nativeConnection.setFailure(new SQLException("Fatal connection error.","XXX"));
  try {
    conn.createStatement();
    fail("Should throw SQL exception.");
  }
 catch (  SQLException ignored) {
    nativeConnection.setFailure(null);
  }
  conn.close();
  assertEquals("The pool should have no active connections",0,pool.getNumActive());
  assertEquals("The pool should have no idle connections",0,pool.getNumIdle());
}

</code></pre>

<br>
<pre class="type-10 type-8 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFastFailValidation() throws Exception {
  pool.setTestOnReturn(true);
  PoolableConnectionFactory factory=(PoolableConnectionFactory)pool.getFactory();
  factory.setFastFailValidation(true);
  PoolableConnection conn=pool.borrowObject();
  TesterConnection nativeConnection=(TesterConnection)conn.getInnermostDelegate();
  nativeConnection.setFailure(new SQLException("Not fatal error.","Invalid syntax."));
  try {
    conn.createStatement();
    fail("Should throw SQL exception.");
  }
 catch (  SQLException ignored) {
    nativeConnection.setFailure(null);
  }
  conn.validate("SELECT 1",1000);
  nativeConnection.setFailure(new SQLException("Fatal connection error.","01002"));
  try {
    conn.createStatement();
    fail("Should throw SQL exception.");
  }
 catch (  SQLException ignored) {
    nativeConnection.setFailure(null);
  }
  try {
    conn.validate("SELECT 1",1000);
    fail("Should throw SQL exception on validation.");
  }
 catch (  SQLException notValid) {
  }
  conn.close();
  assertEquals("The pool should have no active connections",0,pool.getNumActive());
  assertEquals("The pool should have no idle connections",0,pool.getNumIdle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPoolingDriver </h4><pre class="type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClosePool() throws Exception {
  Connection conn=DriverManager.getConnection("jdbc:apache:commons:dbcp:test");
  assertNotNull(conn);
  conn.close();
  PoolingDriver driver2=(PoolingDriver)DriverManager.getDriver("jdbc:apache:commons:dbcp:");
  driver2.closePool("test");
  try (Connection c=DriverManager.getConnection("jdbc:apache:commons:dbcp:test")){
    fail("expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.cpdsadapter.TestDriverAdapterCPDS </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * JIRA: DBCP-245
 */
@Test public void testIncorrectPassword() throws Exception {
  pcds.getPooledConnection("u2","p2").close();
  try {
    pcds.getPooledConnection("u1","zlsafjk");
    fail("Able to retrieve connection with incorrect password");
  }
 catch (  SQLException e1) {
  }
  pcds.getPooledConnection("u1","p1").close();
  try {
    pcds.getPooledConnection("u1","x");
    fail("Able to retrieve connection with incorrect password");
  }
 catch (  SQLException e) {
    if (!e.getMessage().startsWith("x is not the correct password")) {
      throw e;
    }
  }
  pcds.getPooledConnection("u1","p1").close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestCPDSConnectionFactory </h4><pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA DBCP-216
 * Verify that pool counters are maintained properly and listeners are
 * cleaned up when a PooledConnection throws a connectionError event.
 */
@Test public void testConnectionErrorCleanup() throws Exception {
  CPDSConnectionFactory factory=new CPDSConnectionFactory(cpds,null,-1,false,"username","password");
  GenericObjectPool<PooledConnectionAndInfo> pool=new GenericObjectPool<>(factory);
  factory.setPool(pool);
  PooledConnection pcon1=pool.borrowObject().getPooledConnection();
  Connection con1=pcon1.getConnection();
  PooledConnection pcon2=pool.borrowObject().getPooledConnection();
  assertEquals(2,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  PooledConnectionProxy pc=(PooledConnectionProxy)pcon1;
  assertTrue(pc.getListeners().contains(factory));
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  PooledConnection pcon3=pool.borrowObject().getPooledConnection();
  assertTrue(!pcon3.equals(pcon1));
  assertTrue(!pc.getListeners().contains(factory));
  assertEquals(2,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  pcon2.getConnection().close();
  pcon3.getConnection().close();
  assertEquals(2,pool.getNumIdle());
  assertEquals(0,pool.getNumActive());
  try {
    pc.getConnection();
    fail("Expecting SQLException using closed PooledConnection");
  }
 catch (  SQLException ex) {
  }
  con1.close();
  assertEquals(2,pool.getNumIdle());
  assertEquals(0,pool.getNumActive());
  factory.getPool().clear();
  assertEquals(0,pool.getNumIdle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestInstanceKeyDataSource </h4><pre class="type-10 type-8 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that exception on setupDefaults does not leak PooledConnection
 * JIRA: DBCP-237
 */
@Test public void testExceptionOnSetupDefaults() throws Exception {
  DriverAdapterCPDS pcds;
  pcds=new DriverAdapterCPDS();
  pcds.setDriver("org.apache.commons.dbcp2.TesterDriver");
  pcds.setUrl("jdbc:apache:commons:testdriver");
  pcds.setUser("foo");
  pcds.setPassword("bar");
  pcds.setPoolPreparedStatements(false);
  ThrowOnSetupDefaultsDataSource tds=new ThrowOnSetupDefaultsDataSource();
  tds.setConnectionPoolDataSource(pcds);
  int numConnections=tds.getNumActive();
  try {
    tds.getConnection("foo","bar");
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
  }
  assertEquals(numConnections,tds.getNumActive());
  tds.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestKeyedCPDSConnectionFactory </h4><pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA DBCP-216
 * Verify that pool counters are maintained properly and listeners are
 * cleaned up when a PooledConnection throws a connectionError event.
 */
@Test public void testConnectionErrorCleanup() throws Exception {
  UserPassKey key=new UserPassKey("username","password");
  KeyedCPDSConnectionFactory factory=new KeyedCPDSConnectionFactory(cpds,null,-1,false);
  KeyedObjectPool<UserPassKey,PooledConnectionAndInfo> pool=new GenericKeyedObjectPool<>(factory);
  factory.setPool(pool);
  PooledConnection pcon1=pool.borrowObject(key).getPooledConnection();
  Connection con1=pcon1.getConnection();
  PooledConnection pcon2=pool.borrowObject(key).getPooledConnection();
  assertEquals(2,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  PooledConnectionProxy pc=(PooledConnectionProxy)pcon1;
  assertTrue(pc.getListeners().contains(factory));
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  PooledConnection pcon3=pool.borrowObject(key).getPooledConnection();
  assertTrue(!pcon3.equals(pcon1));
  assertTrue(!pc.getListeners().contains(factory));
  assertEquals(2,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  pcon2.getConnection().close();
  pcon3.getConnection().close();
  assertEquals(2,pool.getNumIdle(key));
  assertEquals(0,pool.getNumActive(key));
  try {
    pc.getConnection();
    fail("Expecting SQLException using closed PooledConnection");
  }
 catch (  SQLException ex) {
  }
  con1.close();
  assertEquals(2,pool.getNumIdle(key));
  assertEquals(0,pool.getNumActive(key));
  factory.getPool().clear();
  assertEquals(0,pool.getNumIdle(key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestPerUserPoolDataSource </h4><pre class="type-2 type-9 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testMaxTotal() throws Exception {
  Connection[] c=new Connection[getMaxTotal()];
  for (int i=0; i < c.length; i++) {
    c[i]=ds.getConnection();
    assertTrue(c[i] != null);
  }
  try (Connection conn=ds.getConnection()){
    fail("Allowed to open more than DefaultMaxTotal connections.");
  }
 catch (  java.sql.SQLException e) {
  }
  for (  Connection element : c) {
    element.close();
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangePassword() throws Exception {
  try (Connection c=ds.getConnection("foo","bay")){
    fail("Should have generated SQLException");
  }
 catch (  SQLException expected) {
  }
  Connection con1=ds.getConnection("foo","bar");
  Connection con2=ds.getConnection("foo","bar");
  Connection con3=ds.getConnection("foo","bar");
  con1.close();
  con2.close();
  TesterDriver.addUser("foo","bay");
  try {
    Connection con4=ds.getConnection("foo","bay");
    assertEquals("Should be no idle connections in the pool",0,((PerUserPoolDataSource)ds).getNumIdle("foo"));
    con4.close();
    assertEquals("Should be one idle connection in the pool",1,((PerUserPoolDataSource)ds).getNumIdle("foo"));
    try (Connection c=ds.getConnection("foo","bar")){
      fail("Should have generated SQLException");
    }
 catch (    SQLException expected) {
    }
    Connection con5=ds.getConnection("foo","bay");
    con3.close();
    ds.getConnection("foo","bay").close();
    assertEquals("Should be one idle connection in the pool",1,((PerUserPoolDataSource)ds).getNumIdle("foo"));
    con5.close();
  }
  finally {
    TesterDriver.addUser("foo","bar");
  }
}

</code></pre>

<br>
<pre class="type-2 type-10 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testSimple2() throws Exception {
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  PreparedStatement stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  ResultSet rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  conn.close();
  try (Statement s=conn.createStatement()){
    fail("Can't use closed connections");
  }
 catch (  SQLException e) {
  }
  conn=ds.getConnection();
  assertNotNull(conn);
  stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  conn.close();
  conn=null;
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Verify that defaultMaxWaitMillis = 0 means immediate failure when
 * pool is exhausted.
 */
@Test public void testMaxWaitMillisZero() throws Exception {
  PerUserPoolDataSource tds=(PerUserPoolDataSource)ds;
  tds.setDefaultMaxWaitMillis(0);
  tds.setPerUserMaxTotal("u1",Integer.valueOf(1));
  Connection conn=tds.getConnection("u1","p1");
  try (Connection c2=tds.getConnection("u1","p1")){
    fail("Expecting Pool Exhausted exception");
  }
 catch (  SQLException ex) {
  }
  conn.close();
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Switching 'u1 to 'u2' and 'p1' to 'p2' will
 * exhibit the bug detailed in
 * http://issues.apache.org/bugzilla/show_bug.cgi?id=18905
 */
@Test public void testIncorrectPassword() throws Exception {
  try (Connection c=ds.getConnection("u1","zlsafjk")){
    fail("Able to retrieve connection with incorrect password");
  }
 catch (  SQLException e1) {
  }
  ds.getConnection("u1","p1").close();
  try (Connection c=ds.getConnection("u1","x")){
    fail("Able to retrieve connection with incorrect password");
  }
 catch (  SQLException e) {
    if (!e.getMessage().startsWith("Given password did not match")) {
      throw e;
    }
  }
  ds.getConnection("u1","p1").close();
  ds.getConnection("foo","bar").close();
  try (Connection c=ds.getConnection("foob","ar")){
    fail("Should have caused an SQLException");
  }
 catch (  SQLException expected) {
  }
  try (Connection c=ds.getConnection("foo","baz")){
    fail("Should have generated SQLException");
  }
 catch (  SQLException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestSharedPoolDataSource </h4><pre class="type-2 type-10 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testSimple2() throws Exception {
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  PreparedStatement stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  ResultSet rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  conn.close();
  try (Statement s=conn.createStatement()){
    fail("Can't use closed connections");
  }
 catch (  SQLException e) {
  }
  conn=ds.getConnection();
  assertNotNull(conn);
  stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  conn.close();
  conn=null;
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Starting with a successful connection, then incorrect password,
 * then correct password for same user illustrates
 * JIRA: DBCP-245
 */
@Test public void testIncorrectPassword() throws Exception {
  ds.getConnection("u2","p2").close();
  try (Connection c=ds.getConnection("u1","zlsafjk")){
    fail("Able to retrieve connection with incorrect password");
  }
 catch (  SQLException e1) {
  }
  ds.getConnection("u1","p1").close();
  try (Connection c=ds.getConnection("u1","x")){
    fail("Able to retrieve connection with incorrect password");
  }
 catch (  SQLException e) {
    if (!e.getMessage().startsWith("Given password did not match")) {
      throw e;
    }
  }
  ds.getConnection("u1","p1").close();
  ds.getConnection("foo","bar").close();
  try (Connection c=ds.getConnection("u1","ar")){
    fail("Should have caused an SQLException");
  }
 catch (  SQLException expected) {
  }
  try (Connection c=ds.getConnection("u1","baz")){
    fail("Should have generated SQLException");
  }
 catch (  SQLException expected) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-9 type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testMaxTotal() throws Exception {
  Connection[] c=new Connection[getMaxTotal()];
  for (int i=0; i < c.length; i++) {
    c[i]=ds.getConnection();
    assertTrue(c[i] != null);
  }
  try (Connection conn=ds.getConnection()){
    fail("Allowed to open more than DefaultMaxTotal connections.");
  }
 catch (  java.sql.SQLException e) {
  }
  for (  Connection element : c) {
    element.close();
  }
}

</code></pre>

<br>
<pre class="type-10 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangePassword() throws Exception {
  try (Connection c=ds.getConnection("foo","bay")){
    fail("Should have generated SQLException");
  }
 catch (  SQLException expected) {
  }
  Connection con1=ds.getConnection("foo","bar");
  Connection con2=ds.getConnection("foo","bar");
  Connection con3=ds.getConnection("foo","bar");
  con1.close();
  con2.close();
  TesterDriver.addUser("foo","bay");
  try (Connection con4=ds.getConnection("foo","bay")){
    assertEquals("Should be no idle connections in the pool",0,((SharedPoolDataSource)ds).getNumIdle());
    con4.close();
    assertEquals("Should be one idle connection in the pool",1,((SharedPoolDataSource)ds).getNumIdle());
    try (Connection con4b=ds.getConnection("foo","bar")){
      fail("Should have generated SQLException");
    }
 catch (    SQLException expected) {
    }
    Connection con5=ds.getConnection("foo","bay");
    con3.close();
    ds.getConnection("foo","bay").close();
    assertEquals("Should be one idle connection in the pool",1,((SharedPoolDataSource)ds).getNumIdle());
    con5.close();
  }
  finally {
    TesterDriver.addUser("foo","bar");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.managed.TestBasicManagedDataSource </h4><pre class="type-10 type-8 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA: DBCP-294
 * Verify that PoolableConnections created by BasicManagedDataSource unregister themselves
 * when reallyClosed.
 */
@Test public void testReallyClose() throws Exception {
  BasicManagedDataSource basicManagedDataSource=new BasicManagedDataSource();
  basicManagedDataSource.setTransactionManager(new TransactionManagerImpl());
  basicManagedDataSource.setDriverClassName("org.apache.commons.dbcp2.TesterDriver");
  basicManagedDataSource.setUrl("jdbc:apache:commons:testdriver");
  basicManagedDataSource.setUsername("username");
  basicManagedDataSource.setPassword("password");
  basicManagedDataSource.setMaxIdle(1);
  ManagedConnection<?> conn=(ManagedConnection<?>)basicManagedDataSource.getConnection();
  assertNotNull(basicManagedDataSource.getTransactionRegistry().getXAResource(conn));
  ManagedConnection<?> conn2=(ManagedConnection<?>)basicManagedDataSource.getConnection();
  conn2.close();
  conn.close();
  try {
    basicManagedDataSource.getTransactionRegistry().getXAResource(conn);
    fail("Expecting SQLException - XAResources orphaned");
  }
 catch (  SQLException ex) {
  }
  conn2.close();
  basicManagedDataSource.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.managed.TestManagedDataSourceInTx </h4><pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testAutoCommitBehavior() throws Exception {
  Connection connection=newConnection();
  assertFalse("Auto-commit should be disabled",connection.getAutoCommit());
  try {
    connection.setAutoCommit(true);
    fail("setAutoCommit method should be disabled while enlisted in a transaction");
  }
 catch (  SQLException e) {
  }
  assertFalse("Auto-commit should be disabled",connection.getAutoCommit());
  connection.close();
}

</code></pre>

<br>
<pre class="type-9 type-10 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Test public void testMaxTotal() throws Exception {
  Transaction[] transactions=new Transaction[getMaxTotal()];
  Connection[] c=new Connection[getMaxTotal()];
  for (int i=0; i < c.length; i++) {
    c[i]=newConnection();
    assertNotNull(c[i]);
    transactions[i]=transactionManager.suspend();
    assertNotNull(transactions[i]);
    transactionManager.begin();
  }
  try {
    newConnection();
    fail("Allowed to open more than DefaultMaxTotal connections.");
  }
 catch (  java.sql.SQLException e) {
  }
 finally {
    transactionManager.commit();
    for (int i=0; i < c.length; i++) {
      transactionManager.resume(transactions[i]);
      c[i].close();
      transactionManager.commit();
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadOnly() throws Exception {
  Connection connection=newConnection();
  assertTrue("Connection be read-only",connection.isReadOnly());
  try {
    connection.setReadOnly(true);
    fail("setReadOnly method should be disabled while enlisted in a transaction");
  }
 catch (  SQLException e) {
  }
  assertTrue("Connection be read-only",connection.isReadOnly());
  try {
    connection.setReadOnly(false);
    fail("setReadOnly method should be disabled while enlisted in a transaction");
  }
 catch (  SQLException e) {
  }
  assertTrue("Connection be read-only",connection.isReadOnly());
  connection.close();
}

</code></pre>

<br>
<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommit() throws Exception {
  Connection connection=newConnection();
  assertFalse("Connection should be open",connection.isClosed());
  try {
    connection.commit();
    fail("commit method should be disabled while enlisted in a transaction");
  }
 catch (  SQLException e) {
  }
  assertFalse("Connection should be open",connection.isClosed());
  connection.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
