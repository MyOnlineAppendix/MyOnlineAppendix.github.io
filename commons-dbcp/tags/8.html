<h3><span class=" glyphicon glyphicon-tag"/>&nbspInternalCallVerifier</h3><kbd>Verifies values of objects/variables related to AUT calls</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestAbandonedBasicDataSource </h4><pre class="type-2 type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * DBCP-180 - things get more interesting with statement pooling.
 */
@Test public void testGarbageCollectorCleanUp02() throws Exception {
  ds.setPoolPreparedStatements(true);
  ds.setAccessToUnderlyingConnectionAllowed(true);
  DelegatingConnection<?> conn=(DelegatingConnection<?>)ds.getConnection();
  PoolableConnection poolableConn=(PoolableConnection)conn.getDelegate();
  PoolingConnection poolingConn=(PoolingConnection)poolableConn.getDelegate();
  @SuppressWarnings("unchecked") GenericKeyedObjectPool<PStmtKey,DelegatingPreparedStatement> gkop=(GenericKeyedObjectPool<PStmtKey,DelegatingPreparedStatement>)TesterUtils.getField(poolingConn,"_pstmtPool");
  Assert.assertEquals(0,conn.getTrace().size());
  Assert.assertEquals(0,gkop.getNumActive());
  createStatement(conn);
  Assert.assertEquals(1,conn.getTrace().size());
  Assert.assertEquals(1,gkop.getNumActive());
  System.gc();
  int count=0;
  while (count < 50 && gkop.getNumActive() > 0) {
    Thread.sleep(100);
    count++;
  }
  Assert.assertEquals(0,gkop.getNumActive());
  Assert.assertEquals(0,conn.getTrace().size());
}

</code></pre>

<br>
<pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * DBCP-180 - verify that a GC can clean up an unused Statement when it is
 * no longer referenced even when it is tracked via the AbandonedTrace
 * mechanism.
 */
@Test public void testGarbageCollectorCleanUp01() throws Exception {
  DelegatingConnection<?> conn=(DelegatingConnection<?>)ds.getConnection();
  Assert.assertEquals(0,conn.getTrace().size());
  createStatement(conn);
  Assert.assertEquals(1,conn.getTrace().size());
  System.gc();
  Assert.assertEquals(0,conn.getTrace().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestBasicDataSource </h4><pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetValidationTestProperties(){
  assertEquals(true,ds.getTestOnBorrow());
  assertEquals(false,ds.getTestOnReturn());
  assertEquals(false,ds.getTestWhileIdle());
  ds.setTestOnBorrow(true);
  ds.setTestOnReturn(true);
  ds.setTestWhileIdle(true);
  assertEquals(true,ds.getTestOnBorrow());
  assertEquals(true,ds.getTestOnReturn());
  assertEquals(true,ds.getTestWhileIdle());
  ds.setTestOnBorrow(false);
  ds.setTestOnReturn(false);
  ds.setTestWhileIdle(false);
  assertEquals(false,ds.getTestOnBorrow());
  assertEquals(false,ds.getTestOnReturn());
  assertEquals(false,ds.getTestWhileIdle());
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA: DBCP-437
 * Verify that BasicDataSource sets disconnect codes properties.
 * Functionality is verified in pcf tests.
 */
@Test public void testDisconnectSqlCodes() throws Exception {
  ArrayList<String> disconnectionSqlCodes=new ArrayList<>();
  disconnectionSqlCodes.add("XXX");
  ds.setDisconnectionSqlCodes(disconnectionSqlCodes);
  ds.setFastFailValidation(true);
  ds.getConnection();
  PoolableConnectionFactory pcf=(PoolableConnectionFactory)ds.getConnectionPool().getFactory();
  assertTrue(pcf.isFastFailValidation());
  assertTrue(pcf.getDisconnectionSqlCodes().contains("XXX"));
  assertEquals(1,pcf.getDisconnectionSqlCodes().size());
}

</code></pre>

<br>
<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA: DBCP-342, DBCP-93
 * Verify that when errors occur during BasicDataSource initialization, GenericObjectPool
 * Evictors are cleaned up.
 */
@Test public void testCreateDataSourceCleanupEvictor() throws Exception {
  ds.close();
  ds=null;
  ds=createDataSource();
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterConnRequestCountDriver");
  ds.setUrl("jdbc:apache:commons:testerConnRequestCountDriver");
  ds.setValidationQuery("SELECT DUMMY FROM DUAL");
  ds.setUsername("username");
  ds.setPassword("wrong");
  ds.setTimeBetweenEvictionRunsMillis(100);
  ds.setMinIdle(2);
synchronized (TesterConnRequestCountDriver.class) {
    TesterConnRequestCountDriver.initConnRequestCount();
    for (int i=0; i < 10; i++) {
      try {
        @SuppressWarnings("unused") DataSource ds2=ds.createDataSource();
      }
 catch (      SQLException e) {
      }
    }
    Thread.sleep(1000);
    assertEquals(10,TesterConnRequestCountDriver.getConnectionRequestCount());
  }
  assertNull(ds.getConnectionPool());
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxConnLifetimeExceeded() throws Exception {
  try {
    StackMessageLog.lock();
    ds.setMaxConnLifetimeMillis(100);
    Connection conn=ds.getConnection();
    assertEquals(1,ds.getNumActive());
    Thread.sleep(500);
    conn.close();
    assertEquals(0,ds.getNumIdle());
    String message=StackMessageLog.popMessage();
    assertTrue(message.indexOf("exceeds the maximum permitted value") > 0);
  }
  finally {
    StackMessageLog.clear();
    StackMessageLog.unLock();
  }
}

</code></pre>

<br>
<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyInitConnectionSql() throws Exception {
  ds.setConnectionInitSqls(Arrays.asList(new String[]{"","   "}));
  assertNotNull(ds.getConnectionInitSqls());
  assertEquals(0,ds.getConnectionInitSqls().size());
  ds.setConnectionInitSqls(null);
  assertNotNull(ds.getConnectionInitSqls());
  assertEquals(0,ds.getConnectionInitSqls().size());
}

</code></pre>

<br>
<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitialSize() throws Exception {
  ds.setMaxTotal(20);
  ds.setMaxIdle(20);
  ds.setInitialSize(10);
  Connection conn=getConnection();
  assertNotNull(conn);
  conn.close();
  assertEquals(0,ds.getNumActive());
  assertEquals(10,ds.getNumIdle());
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testConcurrentInitBorrow() throws Exception {
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterConnectionDelayDriver");
  ds.setUrl("jdbc:apache:commons:testerConnectionDelayDriver:50");
  ds.setInitialSize(8);
  TestThread testThread=new TestThread(1,0);
  Thread t=new Thread(testThread);
  t.start();
  Thread.sleep(100);
  ds.getConnection();
  assertTrue(ds.getConnectionPool().getNumIdle() > 5);
  t.join();
  assertFalse(testThread.failed());
  ds.close();
}

</code></pre>

<br>
<pre class="type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testEmptyValidationQuery() throws Exception {
  assertNotNull(ds.getValidationQuery());
  ds.setValidationQuery("");
  assertNull(ds.getValidationQuery());
  ds.setValidationQuery("   ");
  assertNull(ds.getValidationQuery());
}

</code></pre>

<br>
<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bugzilla Bug 29054:
 * The BasicDataSource.setTestOnReturn(boolean) is not carried through to
 * the GenericObjectPool variable _testOnReturn.
 */
@Test public void testPropertyTestOnReturn() throws Exception {
  ds.setValidationQuery("select 1 from dual");
  ds.setTestOnBorrow(false);
  ds.setTestWhileIdle(false);
  ds.setTestOnReturn(true);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  assertEquals(false,ds.getConnectionPool().getTestOnBorrow());
  assertEquals(false,ds.getConnectionPool().getTestWhileIdle());
  assertEquals(true,ds.getConnectionPool().getTestOnReturn());
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccessToUnderlyingConnectionAllowed() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  assertEquals(true,ds.isAccessToUnderlyingConnectionAllowed());
  Connection conn=getConnection();
  Connection dconn=((DelegatingConnection<?>)conn).getDelegate();
  assertNotNull(dconn);
  dconn=((DelegatingConnection<?>)conn).getInnermostDelegate();
  assertNotNull(dconn);
  assertTrue(dconn instanceof TesterConnection);
}

</code></pre>

<br>
<pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetProperties() throws Exception {
  ds.setConnectionProperties("name1=value1;name2=value2;name3=value3");
  assertEquals(3,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("value2",ds.getConnectionProperties().getProperty("name2"));
  assertEquals("value3",ds.getConnectionProperties().getProperty("name3"));
  ds.setConnectionProperties("name1=value1;name2=value2");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("value2",ds.getConnectionProperties().getProperty("name2"));
  assertFalse(ds.getConnectionProperties().containsKey("name3"));
  ds.setConnectionProperties("name1=value1;name2");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("",ds.getConnectionProperties().getProperty("name2"));
  ds.setConnectionProperties("name1=value1;name2=");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("",ds.getConnectionProperties().getProperty("name2"));
  ds.setConnectionProperties("name1=value1");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  ds.setConnectionProperties("name1=value1;");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  ds.setConnectionProperties("name1");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("",ds.getConnectionProperties().getProperty("name1"));
  try {
    ds.setConnectionProperties(null);
    fail("Expected NullPointerException");
  }
 catch (  NullPointerException e) {
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Bugzilla Bug 29055: AutoCommit and ReadOnly
 * The DaffodilDB driver throws an SQLException if
 * trying to commit or rollback a readOnly connection.
 */
@Test public void testRollbackReadOnly() throws Exception {
  ds.setDefaultReadOnly(Boolean.TRUE);
  ds.setDefaultAutoCommit(Boolean.FALSE);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  conn.close();
}

</code></pre>

<br>
<pre class="type-10 type-8 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bugzilla Bug 29832: Broken behaviour for BasicDataSource.setMaxTotal(0)
 * MaxTotal == 0 should throw SQLException on getConnection.
 * Results from Bug 29863 in commons-pool.
 */
@Test public void testMaxTotalZero() throws Exception {
  ds.setMaxTotal(0);
  try {
    Connection conn=ds.getConnection();
    assertNotNull(conn);
    fail("SQLException expected");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA DBCP-333: Check that a custom class loader is used.
 * @throws Exception
 */
@Test public void testDriverClassLoader() throws Exception {
  getConnection();
  ClassLoader cl=ds.getDriverClassLoader();
  assertNotNull(cl);
  assertTrue(cl instanceof TesterClassLoader);
  assertTrue(((TesterClassLoader)cl).didLoad(ds.getDriverClassName()));
}

</code></pre>

<br>
<pre class="type-10 type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsClosedFailure() throws SQLException {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  assertEquals(1,ds.getNumActive());
  TesterConnection tconn=(TesterConnection)((DelegatingConnection<?>)conn).getInnermostDelegate();
  tconn.setFailure(new IOException("network error"));
  try {
    conn.close();
    fail("Expected SQLException");
  }
 catch (  SQLException ex) {
  }
  assertEquals(0,ds.getNumActive());
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidateConnection() throws Exception {
  ds.setMaxTotal(2);
  Connection conn1=ds.getConnection();
  Connection conn2=ds.getConnection();
  ds.invalidateConnection(conn1);
  assertTrue(conn1.isClosed());
  assertEquals(1,ds.getNumActive());
  assertEquals(0,ds.getNumIdle());
  Connection conn3=ds.getConnection();
  conn2.close();
  conn3.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxConnLifetimeExceededMutedLog() throws Exception {
  try {
    StackMessageLog.lock();
    StackMessageLog.clear();
    ds.setMaxConnLifetimeMillis(100);
    ds.setLogExpiredConnections(false);
    Connection conn=ds.getConnection();
    assertEquals(1,ds.getNumActive());
    Thread.sleep(500);
    conn.close();
    assertEquals(0,ds.getNumIdle());
    assertTrue(StackMessageLog.isEmpty());
  }
  finally {
    StackMessageLog.clear();
    StackMessageLog.unLock();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestDelegatingConnection </h4><pre class="type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionToString() throws Exception {
  String s=conn.toString();
  assertNotNull(s);
  assertTrue(s.length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestDelegatingDatabaseMetaData </h4><pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCheckOpen() throws Exception {
  ResultSet rst=meta.getSchemas();
  assertTrue(!rst.isClosed());
  conn.close();
  assertTrue(rst.isClosed());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestDelegatingStatement </h4><pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsWrapperFor() throws Exception {
  TesterConnection tstConn=new TesterConnection("test","test");
  TesterStatement tstStmt=new TesterStatementNonWrapping(tstConn);
  DelegatingConnection<TesterConnection> dconn=new DelegatingConnection<>(tstConn);
  DelegatingStatement stamt=new DelegatingStatement(dconn,tstStmt);
  Class<?> stmtProxyClass=Proxy.getProxyClass(this.getClass().getClassLoader(),Statement.class);
  assertTrue(stamt.isWrapperFor(DelegatingStatement.class));
  assertTrue(stamt.isWrapperFor(TesterStatement.class));
  assertFalse(stamt.isWrapperFor(stmtProxyClass));
  stamt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPStmtPooling </h4><pre class="type-2 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testBatchUpdate() throws Exception {
  DriverManager.registerDriver(new TesterDriver());
  ConnectionFactory connFactory=new DriverManagerConnectionFactory("jdbc:apache:commons:testdriver","u1","p1");
  PoolableConnectionFactory pcf=new PoolableConnectionFactory(connFactory,null);
  pcf.setPoolStatements(true);
  pcf.setDefaultReadOnly(Boolean.FALSE);
  pcf.setDefaultAutoCommit(Boolean.TRUE);
  ObjectPool<PoolableConnection> connPool=new GenericObjectPool<>(pcf);
  pcf.setPool(connPool);
  PoolingDataSource<?> ds=new PoolingDataSource<>(connPool);
  Connection conn=ds.getConnection();
  PreparedStatement ps=conn.prepareStatement("select 1 from dual");
  Statement inner=((DelegatingPreparedStatement)ps).getInnermostDelegate();
  ps.addBatch();
  ps.close();
  conn.close();
  Assert.assertFalse(inner.isClosed());
  ds.close();
}

</code></pre>

<br>
<pre class="type-2 type-8 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testCallableStatementPooling() throws Exception {
  DriverManager.registerDriver(new TesterDriver());
  ConnectionFactory connFactory=new DriverManagerConnectionFactory("jdbc:apache:commons:testdriver","u1","p1");
  ObjectName oName=new ObjectName("UnitTests:DataSource=test");
  PoolableConnectionFactory pcf=new PoolableConnectionFactory(connFactory,oName);
  pcf.setPoolStatements(true);
  pcf.setDefaultReadOnly(Boolean.FALSE);
  pcf.setDefaultAutoCommit(Boolean.TRUE);
  GenericObjectPoolConfig config=new GenericObjectPoolConfig();
  config.setJmxNameBase("UnitTests:DataSource=test,connectionpool=connections");
  config.setJmxNamePrefix("");
  ObjectPool<PoolableConnection> connPool=new GenericObjectPool<>(pcf,config);
  pcf.setPool(connPool);
  PoolingDataSource<?> ds=new PoolingDataSource<>(connPool);
  try (Connection conn=ds.getConnection()){
    Statement stmt1=conn.prepareStatement("select 1 from dual");
    Statement ustmt1=((DelegatingStatement)stmt1).getInnermostDelegate();
    Statement cstmt1=conn.prepareCall("{call home}");
    Statement ucstmt1=((DelegatingStatement)cstmt1).getInnermostDelegate();
    stmt1.close();
    cstmt1.close();
    Statement stmt2=conn.prepareStatement("select 1 from dual");
    Statement ustmt2=((DelegatingStatement)stmt2).getInnermostDelegate();
    Statement cstmt2=conn.prepareCall("{call home}");
    Statement ucstmt2=((DelegatingStatement)cstmt2).getInnermostDelegate();
    stmt2.close();
    cstmt2.close();
    assertSame(ustmt1,ustmt2);
    assertSame(ucstmt1,ucstmt2);
    Statement stmt3=conn.prepareCall("select 1 from dual");
    Statement ustmt3=((DelegatingStatement)stmt3).getInnermostDelegate();
    stmt3.close();
    assertNotSame(ustmt1,ustmt3);
    assertNotSame(ustmt3,ucstmt1);
  }
   ds.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPStmtPoolingBasicDataSource </h4><pre class="type-2 type-8 type-13 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPStmtCatalog() throws Exception {
  Connection conn=getConnection();
  conn.setCatalog("catalog1");
  DelegatingPreparedStatement stmt1=(DelegatingPreparedStatement)conn.prepareStatement("select 'a' from dual");
  TesterPreparedStatement inner1=(TesterPreparedStatement)stmt1.getInnermostDelegate();
  assertEquals("catalog1",inner1.getCatalog());
  stmt1.close();
  conn.setCatalog("catalog2");
  DelegatingPreparedStatement stmt2=(DelegatingPreparedStatement)conn.prepareStatement("select 'a' from dual");
  TesterPreparedStatement inner2=(TesterPreparedStatement)stmt2.getInnermostDelegate();
  assertEquals("catalog2",inner2.getCatalog());
  stmt2.close();
  conn.setCatalog("catalog1");
  DelegatingPreparedStatement stmt3=(DelegatingPreparedStatement)conn.prepareStatement("select 'a' from dual");
  TesterPreparedStatement inner3=(TesterPreparedStatement)stmt3.getInnermostDelegate();
  assertEquals("catalog1",inner3.getCatalog());
  stmt3.close();
  assertNotSame(inner1,inner2);
  assertSame(inner1,inner3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPoolableConnection </h4><pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPoolableConnectionLeak() throws Exception {
  Connection conn=pool.borrowObject();
  ((PoolableConnection)conn).getInnermostDelegate().close();
  try {
    conn.close();
  }
 catch (  SQLException e) {
  }
  assertEquals("The pool should have no active connections",0,pool.getNumActive());
}

</code></pre>

<br>
<pre class="type-10 type-8 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFastFailValidationCustomCodes() throws Exception {
  pool.setTestOnReturn(true);
  PoolableConnectionFactory factory=(PoolableConnectionFactory)pool.getFactory();
  factory.setFastFailValidation(true);
  ArrayList<String> disconnectionSqlCodes=new ArrayList<>();
  disconnectionSqlCodes.add("XXX");
  factory.setDisconnectionSqlCodes(disconnectionSqlCodes);
  PoolableConnection conn=pool.borrowObject();
  TesterConnection nativeConnection=(TesterConnection)conn.getInnermostDelegate();
  nativeConnection.setFailure(new SQLException("Fatal connection error.","XXX"));
  try {
    conn.createStatement();
    fail("Should throw SQL exception.");
  }
 catch (  SQLException ignored) {
    nativeConnection.setFailure(null);
  }
  conn.close();
  assertEquals("The pool should have no active connections",0,pool.getNumActive());
  assertEquals("The pool should have no idle connections",0,pool.getNumIdle());
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClosingWrappedInDelegate() throws Exception {
  Assert.assertEquals(0,pool.getNumActive());
  Connection conn=pool.borrowObject();
  DelegatingConnection<Connection> outer=new DelegatingConnection<>(conn);
  Assert.assertFalse(outer.isClosed());
  Assert.assertFalse(conn.isClosed());
  Assert.assertEquals(1,pool.getNumActive());
  outer.close();
  Assert.assertTrue(outer.isClosed());
  Assert.assertTrue(conn.isClosed());
  Assert.assertEquals(0,pool.getNumActive());
  Assert.assertEquals(1,pool.getNumIdle());
}

</code></pre>

<br>
<pre class="type-10 type-8 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFastFailValidation() throws Exception {
  pool.setTestOnReturn(true);
  PoolableConnectionFactory factory=(PoolableConnectionFactory)pool.getFactory();
  factory.setFastFailValidation(true);
  PoolableConnection conn=pool.borrowObject();
  TesterConnection nativeConnection=(TesterConnection)conn.getInnermostDelegate();
  nativeConnection.setFailure(new SQLException("Not fatal error.","Invalid syntax."));
  try {
    conn.createStatement();
    fail("Should throw SQL exception.");
  }
 catch (  SQLException ignored) {
    nativeConnection.setFailure(null);
  }
  conn.validate("SELECT 1",1000);
  nativeConnection.setFailure(new SQLException("Fatal connection error.","01002"));
  try {
    conn.createStatement();
    fail("Should throw SQL exception.");
  }
 catch (  SQLException ignored) {
    nativeConnection.setFailure(null);
  }
  try {
    conn.validate("SELECT 1",1000);
    fail("Should throw SQL exception on validation.");
  }
 catch (  SQLException notValid) {
  }
  conn.close();
  assertEquals("The pool should have no active connections",0,pool.getNumActive());
  assertEquals("The pool should have no idle connections",0,pool.getNumIdle());
}

</code></pre>

<br>
<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionPool() throws Exception {
  Connection c=pool.borrowObject();
  assertNotNull("Connection should be created and should not be null",c);
  assertEquals("There should be exactly one active object in the pool",1,pool.getNumActive());
  c.close();
  assertEquals("There should now be zero active objects in the pool",0,pool.getNumActive());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPoolingDataSource </h4><pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPoolGuardConnectionWrapperEqualsNull() throws Exception {
  Connection con1=ds.getConnection();
  Connection con2=null;
  assertFalse(con1.equals(con2));
  con1.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPoolGuardConnectionWrapperEqualsType() throws Exception {
  Connection con1=ds.getConnection();
  Integer con2=Integer.valueOf(0);
  assertFalse(con1.equals(con2));
  con1.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClose() throws Exception {
  Properties props=new Properties();
  props.setProperty("user","username");
  props.setProperty("password","password");
  PoolableConnectionFactory f=new PoolableConnectionFactory(new DriverConnectionFactory(new TesterDriver(),"jdbc:apache:commons:testdriver",props),null);
  f.setValidationQuery("SELECT DUMMY FROM DUAL");
  f.setDefaultReadOnly(Boolean.TRUE);
  f.setDefaultAutoCommit(Boolean.TRUE);
  GenericObjectPool<PoolableConnection> p=new GenericObjectPool<>(f);
  p.setMaxTotal(getMaxTotal());
  p.setMaxWaitMillis(getMaxWaitMillis());
  try (PoolingDataSource<PoolableConnection> dataSource=new PoolingDataSource<>(p)){
    Connection connection=dataSource.getConnection();
    assertNotNull(connection);
    connection.close();
  }
   assertTrue(p.isClosed());
  assertEquals(0,p.getNumIdle());
  assertEquals(0,p.getNumActive());
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * DBCP-412
 * Verify that omitting factory.setPool(pool) when setting up PDS does not
 * result in NPE.
 */
@Test public void testFixFactoryConfig() throws Exception {
  Properties props=new Properties();
  props.setProperty("user","username");
  props.setProperty("password","password");
  PoolableConnectionFactory f=new PoolableConnectionFactory(new DriverConnectionFactory(new TesterDriver(),"jdbc:apache:commons:testdriver",props),null);
  f.setValidationQuery("SELECT DUMMY FROM DUAL");
  f.setDefaultReadOnly(Boolean.TRUE);
  f.setDefaultAutoCommit(Boolean.TRUE);
  GenericObjectPool<PoolableConnection> p=new GenericObjectPool<>(f);
  p.setMaxTotal(getMaxTotal());
  p.setMaxWaitMillis(getMaxWaitMillis());
  ds=new PoolingDataSource<>(p);
  assertTrue(f.getPool().equals(p));
  ds.getConnection();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPoolGuardConnectionWrapperEqualsFail() throws Exception {
  Connection con1=ds.getConnection();
  Connection con2=ds.getConnection();
  assertFalse(con1.equals(con2));
  con1.close();
  con2.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPoolGuardConnectionWrapperEqualInnermost() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  DelegatingConnection<?> con=(DelegatingConnection<?>)ds.getConnection();
  Connection inner=con.getInnermostDelegate();
  ds.setAccessToUnderlyingConnectionAllowed(false);
  DelegatingConnection<Connection> con2=new DelegatingConnection<>(inner);
  assertFalse(con2.equals(con));
  assertTrue(con.innermostDelegateEquals(con2.getInnermostDelegate()));
  assertTrue(con2.innermostDelegateEquals(inner));
  assertFalse(con.equals(con2));
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPoolGuardConnectionWrapperEqualsReflexive() throws Exception {
  Connection con=ds.getConnection();
  Connection con2=con;
  assertTrue(con2.equals(con));
  assertTrue(con.equals(con2));
  con.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.TestPoolingDriver </h4><pre class="type-9 type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * "http://issues.apache.org/bugzilla/show_bug.cgi?id=12400" 
 */
@Test public void testReportedBug12400() throws Exception {
  GenericObjectPoolConfig config=new GenericObjectPoolConfig();
  config.setMaxTotal(70);
  config.setMaxWaitMillis(60000);
  config.setMaxIdle(10);
  ConnectionFactory connectionFactory=new DriverManagerConnectionFactory("jdbc:apache:commons:testdriver","username","password");
  PoolableConnectionFactory poolableConnectionFactory=new PoolableConnectionFactory(connectionFactory,null);
  poolableConnectionFactory.setDefaultReadOnly(Boolean.FALSE);
  poolableConnectionFactory.setDefaultAutoCommit(Boolean.TRUE);
  ObjectPool<PoolableConnection> connectionPool=new GenericObjectPool<>(poolableConnectionFactory,config);
  poolableConnectionFactory.setPool(connectionPool);
  assertNotNull(poolableConnectionFactory);
  PoolingDriver driver2=new PoolingDriver();
  driver2.registerPool("neusoftim",connectionPool);
  Connection[] conn=new Connection[25];
  for (int i=0; i < 25; i++) {
    conn[i]=DriverManager.getConnection("jdbc:apache:commons:dbcp:neusoftim");
    for (int j=0; j < i; j++) {
      assertTrue(conn[j] != conn[i]);
      assertTrue(!conn[j].equals(conn[i]));
    }
  }
  for (int i=0; i < 25; i++) {
    conn[i].close();
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  DriverConnectionFactory cf=new DriverConnectionFactory(new TesterDriver(),"jdbc:apache:commons:testdriver",null);
  PoolableConnectionFactory pcf=new PoolableConnectionFactory(cf,null);
  pcf.setPoolStatements(true);
  pcf.setMaxOpenPrepatedStatements(10);
  pcf.setValidationQuery("SELECT COUNT(*) FROM DUAL");
  pcf.setDefaultReadOnly(Boolean.FALSE);
  pcf.setDefaultAutoCommit(Boolean.TRUE);
  GenericObjectPoolConfig poolConfig=new GenericObjectPoolConfig();
  poolConfig.setMaxTotal(getMaxTotal());
  poolConfig.setMaxWaitMillis(getMaxWaitMillis());
  poolConfig.setMinIdle(10);
  poolConfig.setTestOnBorrow(true);
  poolConfig.setTestOnReturn(true);
  poolConfig.setTestWhileIdle(true);
  poolConfig.setTimeBetweenEvictionRunsMillis(10000L);
  poolConfig.setNumTestsPerEvictionRun(5);
  poolConfig.setMinEvictableIdleTimeMillis(5000L);
  GenericObjectPool<PoolableConnection> pool=new GenericObjectPool<>(pcf,poolConfig);
  pcf.setPool(pool);
  assertNotNull(pcf);
  driver=new PoolingDriver(true);
  driver.registerPool("test",pool);
}

</code></pre>

<br>
<pre class="type-8 type-6 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidateConnection() throws Exception {
  Connection conn=DriverManager.getConnection("jdbc:apache:commons:dbcp:test");
  assertNotNull(conn);
  ObjectPool<?> pool=driver.getConnectionPool("test");
  assertEquals(1,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  PoolingDriver driver2=(PoolingDriver)DriverManager.getDriver("jdbc:apache:commons:dbcp:");
  driver2.invalidateConnection(conn);
  assertEquals(0,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  assertTrue(conn.isClosed());
}

</code></pre>

<br>
<pre class="type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void test1(){
  ConnectionFactory connectionFactory=new DriverManagerConnectionFactory("jdbc:some:connect:string","username","password");
  PoolableConnectionFactory pcf=new PoolableConnectionFactory(connectionFactory,null);
  pcf.setDefaultReadOnly(Boolean.FALSE);
  pcf.setDefaultAutoCommit(Boolean.TRUE);
  GenericObjectPool<PoolableConnection> connectionPool=new GenericObjectPool<>(pcf);
  pcf.setPool(connectionPool);
  DataSource ds=new PoolingDataSource<>(connectionPool);
  Assert.assertNotNull(ds);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.cpdsadapter.TestDriverAdapterCPDS </h4><pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetProperties() throws Exception {
  pcds.setUser("bad");
  Properties properties=new Properties();
  properties.put("user","foo");
  pcds.setConnectionProperties(properties);
  pcds.getPooledConnection().close();
  assertEquals("foo",pcds.getUser());
  properties.put("password","bad");
  assertEquals("bar",pcds.getPassword());
  pcds.getPooledConnection("foo","bar").close();
  assertEquals("bar",pcds.getConnectionProperties().getProperty("password"));
}

</code></pre>

<br>
<pre class="type-2 type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleWithUsername() throws Exception {
  Connection conn=pcds.getPooledConnection("u1","p1").getConnection();
  assertNotNull(conn);
  PreparedStatement stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  ResultSet rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  conn.close();
}

</code></pre>

<br>
<pre class="type-2 type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimple() throws Exception {
  Connection conn=pcds.getPooledConnection().getConnection();
  assertNotNull(conn);
  PreparedStatement stmt=conn.prepareStatement("select * from dual");
  assertNotNull(stmt);
  ResultSet rset=stmt.executeQuery();
  assertNotNull(rset);
  assertTrue(rset.next());
  rset.close();
  stmt.close();
  conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestCPDSConnectionFactory </h4><pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * JIRA DBCP-216
 * Check PoolableConnection close triggered by destroy is handled
 * properly. PooledConnectionProxy (dubiously) fires connectionClosed
 * when PooledConnection itself is closed.
 */
@Test public void testSharedPoolDSDestroyOnReturn() throws Exception {
  PerUserPoolDataSource ds=new PerUserPoolDataSource();
  ds.setConnectionPoolDataSource(cpds);
  ds.setPerUserMaxTotal("username",Integer.valueOf(10));
  ds.setPerUserMaxWaitMillis("username",Long.valueOf(50));
  ds.setPerUserMaxIdle("username",Integer.valueOf(2));
  Connection conn1=ds.getConnection("username","password");
  Connection conn2=ds.getConnection("username","password");
  Connection conn3=ds.getConnection("username","password");
  assertEquals(3,ds.getNumActive("username"));
  conn1.close();
  assertEquals(1,ds.getNumIdle("username"));
  conn2.close();
  assertEquals(2,ds.getNumIdle("username"));
  conn3.close();
  assertEquals(2,ds.getNumIdle("username"));
  ds.close();
}

</code></pre>

<br>
<pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA DBCP-216
 * Verify that pool counters are maintained properly and listeners are
 * cleaned up when a PooledConnection throws a connectionError event.
 */
@Test public void testConnectionErrorCleanup() throws Exception {
  CPDSConnectionFactory factory=new CPDSConnectionFactory(cpds,null,-1,false,"username","password");
  GenericObjectPool<PooledConnectionAndInfo> pool=new GenericObjectPool<>(factory);
  factory.setPool(pool);
  PooledConnection pcon1=pool.borrowObject().getPooledConnection();
  Connection con1=pcon1.getConnection();
  PooledConnection pcon2=pool.borrowObject().getPooledConnection();
  assertEquals(2,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  PooledConnectionProxy pc=(PooledConnectionProxy)pcon1;
  assertTrue(pc.getListeners().contains(factory));
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  PooledConnection pcon3=pool.borrowObject().getPooledConnection();
  assertTrue(!pcon3.equals(pcon1));
  assertTrue(!pc.getListeners().contains(factory));
  assertEquals(2,pool.getNumActive());
  assertEquals(0,pool.getNumIdle());
  pcon2.getConnection().close();
  pcon3.getConnection().close();
  assertEquals(2,pool.getNumIdle());
  assertEquals(0,pool.getNumActive());
  try {
    pc.getConnection();
    fail("Expecting SQLException using closed PooledConnection");
  }
 catch (  SQLException ex) {
  }
  con1.close();
  assertEquals(2,pool.getNumIdle());
  assertEquals(0,pool.getNumActive());
  factory.getPool().clear();
  assertEquals(0,pool.getNumIdle());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestInstanceKeyDataSource </h4><pre class="type-10 type-8 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that exception on setupDefaults does not leak PooledConnection
 * JIRA: DBCP-237
 */
@Test public void testExceptionOnSetupDefaults() throws Exception {
  DriverAdapterCPDS pcds;
  pcds=new DriverAdapterCPDS();
  pcds.setDriver("org.apache.commons.dbcp2.TesterDriver");
  pcds.setUrl("jdbc:apache:commons:testdriver");
  pcds.setUser("foo");
  pcds.setPassword("bar");
  pcds.setPoolPreparedStatements(false);
  ThrowOnSetupDefaultsDataSource tds=new ThrowOnSetupDefaultsDataSource();
  tds.setConnectionPoolDataSource(pcds);
  int numConnections=tds.getNumActive();
  try {
    tds.getConnection("foo","bar");
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
  }
  assertEquals(numConnections,tds.getNumActive());
  tds.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestKeyedCPDSConnectionFactory </h4><pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA DBCP-216
 * Verify that pool counters are maintained properly and listeners are
 * cleaned up when a PooledConnection throws a connectionError event.
 */
@Test public void testConnectionErrorCleanup() throws Exception {
  UserPassKey key=new UserPassKey("username","password");
  KeyedCPDSConnectionFactory factory=new KeyedCPDSConnectionFactory(cpds,null,-1,false);
  KeyedObjectPool<UserPassKey,PooledConnectionAndInfo> pool=new GenericKeyedObjectPool<>(factory);
  factory.setPool(pool);
  PooledConnection pcon1=pool.borrowObject(key).getPooledConnection();
  Connection con1=pcon1.getConnection();
  PooledConnection pcon2=pool.borrowObject(key).getPooledConnection();
  assertEquals(2,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  PooledConnectionProxy pc=(PooledConnectionProxy)pcon1;
  assertTrue(pc.getListeners().contains(factory));
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  pc.throwConnectionError();
  assertEquals(1,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  PooledConnection pcon3=pool.borrowObject(key).getPooledConnection();
  assertTrue(!pcon3.equals(pcon1));
  assertTrue(!pc.getListeners().contains(factory));
  assertEquals(2,pool.getNumActive(key));
  assertEquals(0,pool.getNumIdle(key));
  pcon2.getConnection().close();
  pcon3.getConnection().close();
  assertEquals(2,pool.getNumIdle(key));
  assertEquals(0,pool.getNumActive(key));
  try {
    pc.getConnection();
    fail("Expecting SQLException using closed PooledConnection");
  }
 catch (  SQLException ex) {
  }
  con1.close();
  assertEquals(2,pool.getNumIdle(key));
  assertEquals(0,pool.getNumActive(key));
  factory.getPool().clear();
  assertEquals(0,pool.getNumIdle(key));
}

</code></pre>

<br>
<pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * JIRA DBCP-216
 * Check PoolableConnection close triggered by destroy is handled
 * properly. PooledConnectionProxy (dubiously) fires connectionClosed
 * when PooledConnection itself is closed.
 */
@Test public void testSharedPoolDSDestroyOnReturn() throws Exception {
  SharedPoolDataSource ds=new SharedPoolDataSource();
  ds.setConnectionPoolDataSource(cpds);
  ds.setMaxTotal(10);
  ds.setDefaultMaxWaitMillis(50);
  ds.setDefaultMaxIdle(2);
  Connection conn1=ds.getConnection("username","password");
  Connection conn2=ds.getConnection("username","password");
  Connection conn3=ds.getConnection("username","password");
  assertEquals(3,ds.getNumActive());
  conn1.close();
  assertEquals(1,ds.getNumIdle());
  conn2.close();
  assertEquals(2,ds.getNumIdle());
  conn3.close();
  assertEquals(2,ds.getNumIdle());
  ds.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.datasources.TestPerUserPoolDataSource </h4><pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerUserMethods() throws Exception {
  PerUserPoolDataSource tds=(PerUserPoolDataSource)ds;
  tds.setPerUserMaxTotal("u1",Integer.valueOf(5));
  tds.setPerUserMaxTotal("u2",Integer.valueOf(5));
  assertEquals(0,tds.getNumActive());
  assertEquals(0,tds.getNumActive("u1"));
  assertEquals(0,tds.getNumActive("u2"));
  assertEquals(0,tds.getNumIdle());
  assertEquals(0,tds.getNumIdle("u1"));
  assertEquals(0,tds.getNumIdle("u2"));
  Connection conn=tds.getConnection();
  assertNotNull(conn);
  assertEquals(1,tds.getNumActive());
  assertEquals(0,tds.getNumActive("u1"));
  assertEquals(0,tds.getNumActive("u2"));
  assertEquals(0,tds.getNumIdle());
  assertEquals(0,tds.getNumIdle("u1"));
  assertEquals(0,tds.getNumIdle("u2"));
  conn.close();
  assertEquals(0,tds.getNumActive());
  assertEquals(0,tds.getNumActive("u1"));
  assertEquals(0,tds.getNumActive("u2"));
  assertEquals(1,tds.getNumIdle());
  assertEquals(0,tds.getNumIdle("u1"));
  assertEquals(0,tds.getNumIdle("u2"));
  conn=tds.getConnection("u1","p1");
  assertNotNull(conn);
  assertEquals(0,tds.getNumActive());
  assertEquals(1,tds.getNumActive("u1"));
  assertEquals(0,tds.getNumActive("u2"));
  assertEquals(1,tds.getNumIdle());
  assertEquals(0,tds.getNumIdle("u1"));
  assertEquals(0,tds.getNumIdle("u2"));
  conn.close();
  assertEquals(0,tds.getNumActive());
  assertEquals(0,tds.getNumActive("u1"));
  assertEquals(0,tds.getNumActive("u2"));
  assertEquals(1,tds.getNumIdle());
  assertEquals(1,tds.getNumIdle("u1"));
  assertEquals(0,tds.getNumIdle("u2"));
}

</code></pre>

<br>
<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnregisteredUser() throws Exception {
  PerUserPoolDataSource tds=(PerUserPoolDataSource)ds;
  assertEquals(0,tds.getNumActive());
  assertEquals(0,tds.getNumIdle());
  Connection conn=tds.getConnection();
  assertNotNull(conn);
  assertEquals(1,tds.getNumActive());
  assertEquals(0,tds.getNumIdle());
  conn.close();
  assertEquals(0,tds.getNumActive());
  assertEquals(1,tds.getNumIdle());
  conn=tds.getConnection("u1","p1");
  assertNotNull(conn);
  assertEquals(0,tds.getNumActive());
  assertEquals(1,tds.getNumIdle());
  assertEquals(1,tds.getNumActive("u1"));
  assertEquals(0,tds.getNumIdle("u1"));
  conn.close();
  assertEquals(0,tds.getNumActive());
  assertEquals(1,tds.getNumIdle());
  assertEquals(0,tds.getNumActive("u1"));
  assertEquals(1,tds.getNumIdle("u1"));
}

</code></pre>

<br>
<pre class="type-9 type-8 type-4 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDefaultUser1() throws Exception {
  TesterDriver.addUser("mkh","password");
  TesterDriver.addUser("hanafey","password");
  TesterDriver.addUser("jsmith","password");
  PerUserPoolDataSource puds=(PerUserPoolDataSource)ds;
  puds.setPerUserMaxTotal("jsmith",Integer.valueOf(2));
  String[] users={"mkh","hanafey","jsmith"};
  String password="password";
  Connection[] c=new Connection[users.length];
  for (int i=0; i < users.length; i++) {
    c[i]=puds.getConnection(users[i],password);
    assertEquals(users[i],getUsername(c[i]));
  }
  for (int i=0; i < users.length; i++) {
    c[i].close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-8 type-4 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testDefaultUser2() throws Exception {
  TesterDriver.addUser("mkh","password");
  TesterDriver.addUser("hanafey","password");
  TesterDriver.addUser("jsmith","password");
  PerUserPoolDataSource puds=(PerUserPoolDataSource)ds;
  puds.setPerUserMaxTotal("jsmith",Integer.valueOf(2));
  String[] users={"jsmith","hanafey","mkh"};
  String password="password";
  Connection[] c=new Connection[users.length];
  for (int i=0; i < users.length; i++) {
    c[i]=puds.getConnection(users[i],password);
    assertEquals(users[i],getUsername(c[i]));
  }
  for (int i=0; i < users.length; i++) {
    c[i].close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.managed.TestBasicManagedDataSource </h4><pre class="type-10 type-8 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA: DBCP-294
 * Verify that PoolableConnections created by BasicManagedDataSource unregister themselves
 * when reallyClosed.
 */
@Test public void testReallyClose() throws Exception {
  BasicManagedDataSource basicManagedDataSource=new BasicManagedDataSource();
  basicManagedDataSource.setTransactionManager(new TransactionManagerImpl());
  basicManagedDataSource.setDriverClassName("org.apache.commons.dbcp2.TesterDriver");
  basicManagedDataSource.setUrl("jdbc:apache:commons:testdriver");
  basicManagedDataSource.setUsername("username");
  basicManagedDataSource.setPassword("password");
  basicManagedDataSource.setMaxIdle(1);
  ManagedConnection<?> conn=(ManagedConnection<?>)basicManagedDataSource.getConnection();
  assertNotNull(basicManagedDataSource.getTransactionRegistry().getXAResource(conn));
  ManagedConnection<?> conn2=(ManagedConnection<?>)basicManagedDataSource.getConnection();
  conn2.close();
  conn.close();
  try {
    basicManagedDataSource.getTransactionRegistry().getXAResource(conn);
    fail("Expecting SQLException - XAResources orphaned");
  }
 catch (  SQLException ex) {
  }
  conn2.close();
  basicManagedDataSource.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.managed.TestManagedConnection </h4><pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConnectionReturnOnErrorWhenEnlistingXAResource() throws Exception {
  transactionManager.begin();
  try {
    DelegatingConnection<?> connectionA=(DelegatingConnection<?>)getConnection();
    connectionA.close();
  }
 catch (  SQLException e) {
  }
  transactionManager.commit();
  assertEquals(1,pool.getBorrowedCount());
  assertEquals(1,pool.getDestroyedCount());
  assertEquals(0,pool.getNumActive());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.managed.TestManagedDataSource </h4><pre class="type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify the accessToUnderlyingConnectionAllowed properly limits access to the physical connection.
 */
@Test public void testAccessToUnderlyingConnectionAllowed() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  ManagedConnection<?> connection=(ManagedConnection<?>)newConnection();
  assertTrue(connection.isAccessToUnderlyingConnectionAllowed());
  assertNotNull(connection.getDelegate());
  assertNotNull(connection.getInnermostDelegate());
  connection.close();
  ds.setAccessToUnderlyingConnectionAllowed(false);
  connection=(ManagedConnection<?>)newConnection();
  assertFalse(connection.isAccessToUnderlyingConnectionAllowed());
  assertNull(connection.getDelegate());
  assertNull(connection.getInnermostDelegate());
  connection.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testManagedConnectionEqualsNull() throws Exception {
  Connection con1=ds.getConnection();
  Connection con2=null;
  assertFalse(con1.equals(con2));
  con1.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testManagedConnectionEqualsType() throws Exception {
  Connection con1=ds.getConnection();
  Integer con2=Integer.valueOf(0);
  assertFalse(con1.equals(con2));
  con1.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testManagedConnectionEqualInnermost() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  DelegatingConnection<?> con=(DelegatingConnection<?>)ds.getConnection();
  Connection inner=con.getInnermostDelegate();
  ds.setAccessToUnderlyingConnectionAllowed(false);
  DelegatingConnection<Connection> con2=new DelegatingConnection<>(inner);
  assertFalse(con2.equals(con));
  assertTrue(con.innermostDelegateEquals(con2.getInnermostDelegate()));
  assertTrue(con2.innermostDelegateEquals(inner));
  assertFalse(con.equals(con2));
}

</code></pre>

<br>
<pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConnectionReturnOnCommit() throws Exception {
  transactionManager.begin();
  DelegatingConnection<?> connectionA=(DelegatingConnection<?>)newConnection();
  connectionA.close();
  transactionManager.commit();
  assertEquals(1,pool.getBorrowedCount());
  assertEquals(1,pool.getReturnedCount());
  assertEquals(0,pool.getNumActive());
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testManagedConnectionEqualsFail() throws Exception {
  Connection con1=ds.getConnection();
  Connection con2=ds.getConnection();
  assertFalse(con1.equals(con2));
  con1.close();
  con2.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Verify that connection sharing is working (or not working) as expected.
 */
@Test public void testSharedConnection() throws Exception {
  DelegatingConnection<?> connectionA=(DelegatingConnection<?>)newConnection();
  DelegatingConnection<?> connectionB=(DelegatingConnection<?>)newConnection();
  assertFalse(connectionA.equals(connectionB));
  assertFalse(connectionB.equals(connectionA));
  assertFalse(connectionA.innermostDelegateEquals(connectionB.getInnermostDelegate()));
  assertFalse(connectionB.innermostDelegateEquals(connectionA.getInnermostDelegate()));
  connectionA.close();
  connectionB.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testManagedConnectionEqualsReflexive() throws Exception {
  Connection con=ds.getConnection();
  Connection con2=con;
  assertTrue(con2.equals(con));
  assertTrue(con.equals(con2));
  con.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.commons.dbcp2.managed.TestManagedDataSourceInTx </h4><pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCloseInTransaction() throws Exception {
  DelegatingConnection<?> connectionA=(DelegatingConnection<?>)newConnection();
  DelegatingConnection<?> connectionB=(DelegatingConnection<?>)newConnection();
  assertFalse(connectionA.equals(connectionB));
  assertFalse(connectionB.equals(connectionA));
  assertTrue(connectionA.innermostDelegateEquals(connectionB.getInnermostDelegate()));
  assertTrue(connectionB.innermostDelegateEquals(connectionA.getInnermostDelegate()));
  connectionA.close();
  connectionB.close();
  Connection connection=newConnection();
  assertFalse("Connection should be open",connection.isClosed());
  connection.close();
  assertTrue("Connection should be closed",connection.isClosed());
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSharedTransactionConversion() throws Exception {
  DelegatingConnection<?> connectionA=(DelegatingConnection<?>)newConnection();
  DelegatingConnection<?> connectionB=(DelegatingConnection<?>)newConnection();
  assertFalse(connectionA.equals(connectionB));
  assertFalse(connectionB.equals(connectionA));
  assertTrue(connectionA.innermostDelegateEquals(connectionB.getInnermostDelegate()));
  assertTrue(connectionB.innermostDelegateEquals(connectionA.getInnermostDelegate()));
  transactionManager.commit();
  connectionA.getAutoCommit();
  connectionB.getAutoCommit();
  assertFalse(connectionA.equals(connectionB));
  assertFalse(connectionB.equals(connectionA));
  assertFalse(connectionA.innermostDelegateEquals(connectionB.getInnermostDelegate()));
  assertFalse(connectionB.innermostDelegateEquals(connectionA.getInnermostDelegate()));
  transactionManager.begin();
  connectionA.getAutoCommit();
  connectionB.getAutoCommit();
  assertFalse(connectionA.equals(connectionB));
  assertFalse(connectionB.equals(connectionA));
  assertTrue(connectionA.innermostDelegateEquals(connectionB.getInnermostDelegate()));
  assertTrue(connectionB.innermostDelegateEquals(connectionA.getInnermostDelegate()));
  connectionA.close();
  connectionB.close();
}

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Override @Test public void testSharedConnection() throws Exception {
  DelegatingConnection<?> connectionA=(DelegatingConnection<?>)newConnection();
  DelegatingConnection<?> connectionB=(DelegatingConnection<?>)newConnection();
  assertFalse(connectionA.equals(connectionB));
  assertFalse(connectionB.equals(connectionA));
  assertTrue(connectionA.innermostDelegateEquals(connectionB.getInnermostDelegate()));
  assertTrue(connectionB.innermostDelegateEquals(connectionA.getInnermostDelegate()));
  connectionA.close();
  connectionB.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
