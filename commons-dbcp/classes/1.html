<h3 style="margin:0px">Class: org.apache.commons.dbcp2.TestBasicDataSource (36 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(4)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-8 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetValidationTestProperties(){
  assertEquals(true,ds.getTestOnBorrow());
  assertEquals(false,ds.getTestOnReturn());
  assertEquals(false,ds.getTestWhileIdle());
  ds.setTestOnBorrow(true);
  ds.setTestOnReturn(true);
  ds.setTestWhileIdle(true);
  assertEquals(true,ds.getTestOnBorrow());
  assertEquals(true,ds.getTestOnReturn());
  assertEquals(true,ds.getTestWhileIdle());
  ds.setTestOnBorrow(false);
  ds.setTestOnReturn(false);
  ds.setTestWhileIdle(false);
  assertEquals(false,ds.getTestOnBorrow());
  assertEquals(false,ds.getTestOnReturn());
  assertEquals(false,ds.getTestWhileIdle());
}

</code></pre>

<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA: DBCP-437
 * Verify that BasicDataSource sets disconnect codes properties.
 * Functionality is verified in pcf tests.
 */
@Test public void testDisconnectSqlCodes() throws Exception {
  ArrayList<String> disconnectionSqlCodes=new ArrayList<>();
  disconnectionSqlCodes.add("XXX");
  ds.setDisconnectionSqlCodes(disconnectionSqlCodes);
  ds.setFastFailValidation(true);
  ds.getConnection();
  PoolableConnectionFactory pcf=(PoolableConnectionFactory)ds.getConnectionPool().getFactory();
  assertTrue(pcf.isFastFailValidation());
  assertTrue(pcf.getDisconnectionSqlCodes().contains("XXX"));
  assertEquals(1,pcf.getDisconnectionSqlCodes().size());
}

</code></pre>

<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA: DBCP-342, DBCP-93
 * Verify that when errors occur during BasicDataSource initialization, GenericObjectPool
 * Evictors are cleaned up.
 */
@Test public void testCreateDataSourceCleanupEvictor() throws Exception {
  ds.close();
  ds=null;
  ds=createDataSource();
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterConnRequestCountDriver");
  ds.setUrl("jdbc:apache:commons:testerConnRequestCountDriver");
  ds.setValidationQuery("SELECT DUMMY FROM DUAL");
  ds.setUsername("username");
  ds.setPassword("wrong");
  ds.setTimeBetweenEvictionRunsMillis(100);
  ds.setMinIdle(2);
synchronized (TesterConnRequestCountDriver.class) {
    TesterConnRequestCountDriver.initConnRequestCount();
    for (int i=0; i < 10; i++) {
      try {
        @SuppressWarnings("unused") DataSource ds2=ds.createDataSource();
      }
 catch (      SQLException e) {
      }
    }
    Thread.sleep(1000);
    assertEquals(10,TesterConnRequestCountDriver.getConnectionRequestCount());
  }
  assertNull(ds.getConnectionPool());
}

</code></pre>

<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxConnLifetimeExceeded() throws Exception {
  try {
    StackMessageLog.lock();
    ds.setMaxConnLifetimeMillis(100);
    Connection conn=ds.getConnection();
    assertEquals(1,ds.getNumActive());
    Thread.sleep(500);
    conn.close();
    assertEquals(0,ds.getNumIdle());
    String message=StackMessageLog.popMessage();
    assertTrue(message.indexOf("exceeds the maximum permitted value") > 0);
  }
  finally {
    StackMessageLog.clear();
    StackMessageLog.unLock();
  }
}

</code></pre>

<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidationQueryTimoutFail(){
  ds.setTestOnBorrow(true);
  ds.setValidationQueryTimeout(3);
  try (Connection c=ds.getConnection()){
    fail("expected SQLException");
  }
 catch (  SQLException ex) {
    if (ex.toString().indexOf("timeout") < 0) {
      fail("expected timeout error message");
    }
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Override @Test public void testPooling() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  super.testPooling();
}

</code></pre>

<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyInitConnectionSql() throws Exception {
  ds.setConnectionInitSqls(Arrays.asList(new String[]{"","   "}));
  assertNotNull(ds.getConnectionInitSqls());
  assertEquals(0,ds.getConnectionInitSqls().size());
  ds.setConnectionInitSqls(null);
  assertNotNull(ds.getConnectionInitSqls());
  assertEquals(0,ds.getConnectionInitSqls().size());
}

</code></pre>

<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInitialSize() throws Exception {
  ds.setMaxTotal(20);
  ds.setMaxIdle(20);
  ds.setInitialSize(10);
  Connection conn=getConnection();
  assertNotNull(conn);
  conn.close();
  assertEquals(0,ds.getNumActive());
  assertEquals(10,ds.getNumIdle());
}

</code></pre>

<pre class="type-9 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultCatalog() throws Exception {
  Connection[] c=new Connection[getMaxTotal()];
  for (int i=0; i < c.length; i++) {
    c[i]=getConnection();
    assertTrue(c[i] != null);
    assertEquals(CATALOG,c[i].getCatalog());
  }
  for (  Connection element : c) {
    element.setCatalog("error");
    element.close();
  }
  for (int i=0; i < c.length; i++) {
    c[i]=getConnection();
    assertTrue(c[i] != null);
    assertEquals(CATALOG,c[i].getCatalog());
  }
  for (  Connection element : c) {
    element.close();
  }
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * JIRA: DBCP-444
 * Verify that invalidate does not return closed connection to the pool.
 */
@Test public void testConcurrentInvalidateBorrow() throws Exception {
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterConnRequestCountDriver");
  ds.setUrl("jdbc:apache:commons:testerConnRequestCountDriver");
  ds.setTestOnBorrow(true);
  ds.setValidationQuery("SELECT DUMMY FROM DUAL");
  ds.setMaxTotal(8);
  ds.setLifo(true);
  ds.setMaxWaitMillis(-1);
  TestThread testThread1=new TestThread(1000,0);
  Thread t1=new Thread(testThread1);
  t1.start();
  TestThread testThread2=new TestThread(1000,0);
  Thread t2=new Thread(testThread1);
  t2.start();
  for (int i=0; i < 1000; i++) {
    Connection conn=ds.getConnection();
    ds.invalidateConnection(conn);
  }
  t1.join();
  t2.join();
  assertFalse(testThread1.failed());
  assertFalse(testThread2.failed());
  ds.close();
}

</code></pre>

<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testConcurrentInitBorrow() throws Exception {
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterConnectionDelayDriver");
  ds.setUrl("jdbc:apache:commons:testerConnectionDelayDriver:50");
  ds.setInitialSize(8);
  TestThread testThread=new TestThread(1,0);
  Thread t=new Thread(testThread);
  t.start();
  Thread.sleep(100);
  ds.getConnection();
  assertTrue(ds.getConnectionPool().getNumIdle() > 5);
  t.join();
  assertFalse(testThread.failed());
  ds.close();
}

</code></pre>

<pre class="type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransactionIsolationBehavior() throws Exception {
  Connection conn=getConnection();
  assertNotNull(conn);
  assertEquals(Connection.TRANSACTION_READ_COMMITTED,conn.getTransactionIsolation());
  conn.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITTED);
  conn.close();
  Connection conn2=getConnection();
  assertEquals(Connection.TRANSACTION_READ_COMMITTED,conn2.getTransactionIsolation());
  Connection conn3=getConnection();
  assertEquals(Connection.TRANSACTION_READ_COMMITTED,conn3.getTransactionIsolation());
  conn2.close();
  conn3.close();
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * JIRA DBCP-93: If an SQLException occurs after the GenericObjectPool is
 * initialized in createDataSource, the evictor task is not cleaned up.
 */
@Test public void testCreateDataSourceCleanupThreads() throws Exception {
  ds.close();
  ds=null;
  ds=createDataSource();
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterDriver");
  ds.setUrl("jdbc:apache:commons:testdriver");
  ds.setMaxTotal(getMaxTotal());
  ds.setMaxWaitMillis(getMaxWaitMillis());
  ds.setDefaultAutoCommit(Boolean.TRUE);
  ds.setDefaultReadOnly(Boolean.FALSE);
  ds.setDefaultTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED);
  ds.setDefaultCatalog(CATALOG);
  ds.setUsername("username");
  ds.setTimeBetweenEvictionRunsMillis(100);
  ds.setPassword("wrong");
  ds.setValidationQuery("SELECT DUMMY FROM DUAL");
  int threadCount=Thread.activeCount();
  for (int i=0; i < 10; i++) {
    try (Connection c=ds.getConnection()){
    }
 catch (    SQLException ex) {
    }
  }
  assertTrue(Thread.activeCount() <= threadCount + 1);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidationQueryTimeoutSucceed() throws Exception {
  ds.setTestOnBorrow(true);
  ds.setTestOnReturn(true);
  ds.setValidationQueryTimeout(100);
  Connection con=ds.getConnection();
  con.close();
}

</code></pre>

<pre class="type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testEmptyValidationQuery() throws Exception {
  assertNotNull(ds.getValidationQuery());
  ds.setValidationQuery("");
  assertNull(ds.getValidationQuery());
  ds.setValidationQuery("   ");
  assertNull(ds.getValidationQuery());
}

</code></pre>

<pre class="type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bugzilla Bug 29054:
 * The BasicDataSource.setTestOnReturn(boolean) is not carried through to
 * the GenericObjectPool variable _testOnReturn.
 */
@Test public void testPropertyTestOnReturn() throws Exception {
  ds.setValidationQuery("select 1 from dual");
  ds.setTestOnBorrow(false);
  ds.setTestWhileIdle(false);
  ds.setTestOnReturn(true);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  assertEquals(false,ds.getConnectionPool().getTestOnBorrow());
  assertEquals(false,ds.getConnectionPool().getTestWhileIdle());
  assertEquals(true,ds.getConnectionPool().getTestOnReturn());
}

</code></pre>

<pre class="type-8 type-6 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccessToUnderlyingConnectionAllowed() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  assertEquals(true,ds.isAccessToUnderlyingConnectionAllowed());
  Connection conn=getConnection();
  Connection dconn=((DelegatingConnection<?>)conn).getDelegate();
  assertNotNull(dconn);
  dconn=((DelegatingConnection<?>)conn).getInnermostDelegate();
  assertNotNull(dconn);
  assertTrue(dconn instanceof TesterConnection);
}

</code></pre>

<pre class="type-10 type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetProperties() throws Exception {
  ds.setConnectionProperties("name1=value1;name2=value2;name3=value3");
  assertEquals(3,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("value2",ds.getConnectionProperties().getProperty("name2"));
  assertEquals("value3",ds.getConnectionProperties().getProperty("name3"));
  ds.setConnectionProperties("name1=value1;name2=value2");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("value2",ds.getConnectionProperties().getProperty("name2"));
  assertFalse(ds.getConnectionProperties().containsKey("name3"));
  ds.setConnectionProperties("name1=value1;name2");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("",ds.getConnectionProperties().getProperty("name2"));
  ds.setConnectionProperties("name1=value1;name2=");
  assertEquals(2,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  assertEquals("",ds.getConnectionProperties().getProperty("name2"));
  ds.setConnectionProperties("name1=value1");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  ds.setConnectionProperties("name1=value1;");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("value1",ds.getConnectionProperties().getProperty("name1"));
  ds.setConnectionProperties("name1");
  assertEquals(1,ds.getConnectionProperties().size());
  assertEquals("",ds.getConnectionProperties().getProperty("name1"));
  try {
    ds.setConnectionProperties(null);
    fail("Expected NullPointerException");
  }
 catch (  NullPointerException e) {
  }
}

</code></pre>

<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidConnectionInitSql(){
  try {
    ds.setConnectionInitSqls(Arrays.asList(new String[]{"SELECT 1","invalid"}));
    try (Connection c=ds.getConnection()){
    }
     fail("expected SQLException");
  }
 catch (  SQLException e) {
    if (e.toString().indexOf("invalid") < 0) {
      fail("expected detailed error message");
    }
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidationQueryTimeoutZero() throws Exception {
  ds.setTestOnBorrow(true);
  ds.setTestOnReturn(true);
  ds.setValidationQueryTimeout(0);
  Connection con=ds.getConnection();
  con.close();
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws Exception {
  ds=createDataSource();
  ds.setDriverClassName("org.apache.commons.dbcp2.TesterDriver");
  ds.setUrl("jdbc:apache:commons:testdriver");
  ds.setMaxTotal(getMaxTotal());
  ds.setMaxWaitMillis(getMaxWaitMillis());
  ds.setDefaultAutoCommit(Boolean.TRUE);
  ds.setDefaultReadOnly(Boolean.FALSE);
  ds.setDefaultTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED);
  ds.setDefaultCatalog(CATALOG);
  ds.setUsername("username");
  ds.setPassword("password");
  ds.setValidationQuery("SELECT DUMMY FROM DUAL");
  ds.setConnectionInitSqls(Arrays.asList(new String[]{"SELECT 1","SELECT 2"}));
  ds.setDriverClassLoader(new TesterClassLoader());
  ds.setJmxName("org.apache.commons.dbcp2:name=test");
}

</code></pre>

<pre class="type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Bugzilla Bug 29055: AutoCommit and ReadOnly
 * The DaffodilDB driver throws an SQLException if
 * trying to commit or rollback a readOnly connection.
 */
@Test public void testRollbackReadOnly() throws Exception {
  ds.setDefaultReadOnly(Boolean.TRUE);
  ds.setDefaultAutoCommit(Boolean.FALSE);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  conn.close();
}

</code></pre>

<pre class="type-10 type-8 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Bugzilla Bug 29832: Broken behaviour for BasicDataSource.setMaxTotal(0)
 * MaxTotal == 0 should throw SQLException on getConnection.
 * Results from Bug 29863 in commons-pool.
 */
@Test public void testMaxTotalZero() throws Exception {
  ds.setMaxTotal(0);
  try {
    Connection conn=ds.getConnection();
    assertNotNull(conn);
    fail("SQLException expected");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<pre class="type-8 type-6 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * JIRA DBCP-333: Check that a custom class loader is used.
 * @throws Exception
 */
@Test public void testDriverClassLoader() throws Exception {
  getConnection();
  ClassLoader cl=ds.getDriverClassLoader();
  assertNotNull(cl);
  assertTrue(cl instanceof TesterClassLoader);
  assertTrue(((TesterClassLoader)cl).didLoad(ds.getDriverClassName()));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidationQueryTimeoutNegative() throws Exception {
  ds.setTestOnBorrow(true);
  ds.setTestOnReturn(true);
  ds.setValidationQueryTimeout(-1);
  Connection con=ds.getConnection();
  con.close();
}

</code></pre>

<pre class="type-10 type-8 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsClosedFailure() throws SQLException {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection conn=ds.getConnection();
  assertNotNull(conn);
  assertEquals(1,ds.getNumActive());
  TesterConnection tconn=(TesterConnection)((DelegatingConnection<?>)conn).getInnermostDelegate();
  tconn.setFailure(new IOException("network error"));
  try {
    conn.close();
    fail("Expected SQLException");
  }
 catch (  SQLException ex) {
  }
  assertEquals(0,ds.getNumActive());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Make sure setting jmxName to null suppresses JMX registration of connection and statement pools.
 * JIRA: DBCP-434
 */
@Test public void testJmxDisabled() throws Exception {
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  ObjectName commons=new ObjectName("org.apache.commons.*:*");
  Set<ObjectName> results=mbs.queryNames(commons,null);
  for (  ObjectName result : results) {
    mbs.unregisterMBean(result);
  }
  ds.setJmxName(null);
  ds.setPoolPreparedStatements(true);
  ds.getConnection();
  assertEquals(0,mbs.queryNames(commons,null).size());
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@Override @After public void tearDown() throws Exception {
  super.tearDown();
  ds.close();
  ds=null;
}

</code></pre>

<pre class="type-10 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClose() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection activeConnection=getConnection();
  Connection rawActiveConnection=((DelegatingConnection<?>)activeConnection).getInnermostDelegate();
  assertFalse(activeConnection.isClosed());
  assertFalse(rawActiveConnection.isClosed());
  Connection idleConnection=getConnection();
  Connection rawIdleConnection=((DelegatingConnection<?>)idleConnection).getInnermostDelegate();
  assertFalse(idleConnection.isClosed());
  assertFalse(rawIdleConnection.isClosed());
  idleConnection.close();
  assertTrue(idleConnection.isClosed());
  assertFalse(rawIdleConnection.isClosed());
  ds.close();
  assertTrue(rawIdleConnection.isClosed());
  assertFalse(activeConnection.isClosed());
  assertFalse(rawActiveConnection.isClosed());
  activeConnection.close();
  assertTrue(activeConnection.isClosed());
  assertTrue(rawActiveConnection.isClosed());
  try {
    getConnection();
    fail("Expecting SQLException");
  }
 catch (  SQLException ex) {
  }
  ds.close();
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testPoolCloseRTE() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection conn=ds.getConnection();
  TesterConnection tc=(TesterConnection)((DelegatingConnection<?>)conn).getInnermostDelegate();
  conn.close();
  tc.setFailure(new IllegalStateException("boom"));
  try {
    StackMessageLog.lock();
    StackMessageLog.clear();
    ds.close();
    assertTrue(StackMessageLog.popMessage().indexOf("boom") > 0);
  }
 catch (  IllegalStateException ex) {
    assertTrue(ex.getMessage().indexOf("boom") > 0);
  }
 finally {
    StackMessageLog.unLock();
  }
}

</code></pre>

<pre class="type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetAutoCommitTrueOnClose() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  ds.setDefaultAutoCommit(Boolean.FALSE);
  Connection conn=getConnection();
  assertNotNull(conn);
  assertEquals(false,conn.getAutoCommit());
  Connection dconn=((DelegatingConnection<?>)conn).getInnermostDelegate();
  assertNotNull(dconn);
  assertEquals(false,dconn.getAutoCommit());
  conn.close();
  assertEquals(true,dconn.getAutoCommit());
}

</code></pre>

<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidateConnection() throws Exception {
  ds.setMaxTotal(2);
  Connection conn1=ds.getConnection();
  Connection conn2=ds.getConnection();
  ds.invalidateConnection(conn1);
  assertTrue(conn1.isClosed());
  assertEquals(1,ds.getNumActive());
  assertEquals(0,ds.getNumIdle());
  Connection conn3=ds.getConnection();
  conn2.close();
  conn3.close();
}

</code></pre>

<pre class="type-8 type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxConnLifetimeExceededMutedLog() throws Exception {
  try {
    StackMessageLog.lock();
    StackMessageLog.clear();
    ds.setMaxConnLifetimeMillis(100);
    ds.setLogExpiredConnections(false);
    Connection conn=ds.getConnection();
    assertEquals(1,ds.getNumActive());
    Thread.sleep(500);
    conn.close();
    assertEquals(0,ds.getNumIdle());
    assertTrue(StackMessageLog.isEmpty());
  }
  finally {
    StackMessageLog.clear();
    StackMessageLog.unLock();
  }
}

</code></pre>

<pre class="type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoAccessToUnderlyingConnectionAllowed() throws Exception {
  assertEquals(false,ds.isAccessToUnderlyingConnectionAllowed());
  Connection conn=getConnection();
  Connection dconn=((DelegatingConnection<?>)conn).getDelegate();
  assertNull(dconn);
  dconn=((DelegatingConnection<?>)conn).getInnermostDelegate();
  assertNull(dconn);
}

</code></pre>

<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidValidationQuery(){
  ds.setValidationQuery("invalid");
  try (Connection c=ds.getConnection()){
    fail("expected SQLException");
  }
 catch (  SQLException e) {
    if (e.toString().indexOf("invalid") < 0) {
      fail("expected detailed error message");
    }
  }
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Verifies correct handling of exceptions generated by the underlying pool as it closes
 * connections in response to BDS#close. Exceptions have to be either swallowed by the
 * underlying pool and logged, or propagated and wrapped.
 */
@Test public void testPoolCloseCheckedException() throws Exception {
  ds.setAccessToUnderlyingConnectionAllowed(true);
  Connection conn=ds.getConnection();
  TesterConnection tc=(TesterConnection)((DelegatingConnection<?>)conn).getInnermostDelegate();
  conn.close();
  tc.setFailure(new SQLException("bang"));
  try {
    StackMessageLog.lock();
    StackMessageLog.clear();
    ds.close();
    assertTrue(StackMessageLog.popMessage().indexOf("bang") > 0);
  }
 catch (  SQLException ex) {
    assertTrue(ex.getMessage().indexOf("Cannot close") > 0);
    assertTrue(ex.getCause().getMessage().indexOf("bang") > 0);
  }
 finally {
    StackMessageLog.unLock();
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
