<h3 style="margin:0px">Class: org.apache.tika.parser.microsoft.ooxml.OOXMLParserTest (41 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(13)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies values related to public fields."><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >PublicFieldVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Is not executed with the test suite"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >IgnoredMethod&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testWordMissingOOXMLBeans() throws Exception {
  String[] fileNames=new String[]{"testWORD_missing_ooxml_bean1.docx"};
  PrintStream origErr=System.err;
  for (  String fileName : fileNames) {
    Metadata metadata=new Metadata();
    ContentHandler handler=new BodyContentHandler();
    ParseContext context=new ParseContext();
    InputStream input=getTestDocument(fileName);
    ByteArrayOutputStream errContent=new ByteArrayOutputStream();
    System.setErr(new PrintStream(errContent,true,UTF_8.name()));
    parser.parse(input,handler,metadata,context);
    System.setErr(origErr);
    String err=errContent.toString(UTF_8.name());
    assertTrue(err.length() == 0);
    input.close();
  }
}

</code></pre>

<pre class="type-7 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * For the PowerPoint formats we don't currently support, ensure that
 * we don't break either
 */
@Test public void testUnsupportedPowerPoint() throws Exception {
  String[] extensions=new String[]{"xps","thmx"};
  String[] mimeTypes=new String[]{"application/vnd.ms-xpsdocument","application/vnd.openxmlformats-officedocument"};
  for (int i=0; i < extensions.length; i++) {
    String extension=extensions[i];
    String filename="testPPT." + extension;
    Parser parser=new AutoDetectParser();
    Metadata metadata=new Metadata();
    metadata.set(Metadata.RESOURCE_NAME_KEY,filename);
    ContentHandler handler=new BodyContentHandler();
    ParseContext context=new ParseContext();
    try (InputStream input=getTestDocument(filename)){
      parser.parse(input,handler,metadata,context);
      assertEquals("Mime-type checking for " + filename,mimeTypes[i],metadata.get(Metadata.CONTENT_TYPE));
    }
   }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTextInsideTextBox() throws Exception {
  String xml=getXML("testWORD_text_box.docx").xml;
  assertContains("This text is directly in the body of the document.",xml);
  assertContains("This text is inside of a text box in the body of the document.",xml);
  assertContains("This text is inside of a text box in the header of the document.",xml);
  assertContains("This text is inside of a text box in the footer of the document.",xml);
}

</code></pre>

<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPPTXThumbnail() throws Exception {
  String xml=getXML("testPPTX_Thumbnail.pptx").xml;
  int a=xml.indexOf("<body><div class=\"slide-content\"><p>This file contains an embedded thumbnail");
  int b=xml.indexOf("<div class=\"embedded\" id=\"/docProps/thumbnail.jpeg\" />");
  assertTrue(a != -1);
  assertTrue(b != -1);
  assertTrue(a < b);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVarious() throws Exception {
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  try (InputStream stream=OOXMLParserTest.class.getResourceAsStream("/test-documents/testWORD_various.docx")){
    new AutoDetectParser().parse(stream,handler,metadata,new ParseContext());
  }
   String content=handler.toString();
  assertContains("Footnote appears here",content);
  assertContains("This is a footnote.",content);
  assertContains("This is the header text.",content);
  assertContains("This is the footer text.",content);
  assertContains("Here is a text box",content);
  assertContains("Bold",content);
  assertContains("italic",content);
  assertContains("underline",content);
  assertContains("superscript",content);
  assertContains("subscript",content);
  assertContains("Here is a citation:",content);
  assertContains("Figure 1 This is a caption for Figure 1",content);
  assertContains("(Kramer)",content);
  assertContains("Row 1 Col 1 Row 1 Col 2 Row 1 Col 3 Row 2 Col 1 Row 2 Col 2 Row 2 Col 3",content.replaceAll("\\s+"," "));
  assertContains("Row 1 column 1 Row 2 column 1 Row 1 column 2 Row 2 column 2",content.replaceAll("\\s+"," "));
  assertContains("This is a hyperlink",content);
  assertContains("Here is a list:",content);
  for (int row=1; row <= 3; row++) {
    assertContains("Bullet " + row,content);
  }
  assertContains("Here is a numbered list:",content);
  for (int row=1; row <= 3; row++) {
    assertContains("Number bullet " + row,content);
  }
  for (int row=1; row <= 2; row++) {
    for (int col=1; col <= 3; col++) {
      assertContains("Row " + row + " Col "+ col,content);
    }
  }
  assertContains("Keyword1 Keyword2",content);
  assertEquals("Keyword1 Keyword2",metadata.get(Metadata.KEYWORDS));
  assertContains("Subject is here",content);
  assertEquals("Subject is here",metadata.get(Metadata.SUBJECT));
  assertEquals("Subject is here",metadata.get(OfficeOpenXMLCore.SUBJECT));
  assertContains("Suddenly some Japanese text:",content);
  assertContains("\uff08\uff27\uff28\uff31\uff09",content);
  assertContains("\u30be\u30eb\u30b2\u3068\u5c3e\u5d0e\u3001\u6de1\u3005\u3068\u6700\u671f",content);
  assertContains("And then some Gothic text:",content);
  assertContains("\uD800\uDF32\uD800\uDF3f\uD800\uDF44\uD800\uDF39\uD800\uDF43\uD800\uDF3A",content);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Documents with some sheets are protected, but not all.
 * See TIKA-364.
 */
@Test public void testProtectedExcelSheets() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  try (InputStream input=OOXMLParserTest.class.getResourceAsStream("/test-documents/protectedSheets.xlsx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata.get(Metadata.CONTENT_TYPE));
    assertEquals("true",metadata.get(TikaMetadataKeys.PROTECTED));
  }
 }

</code></pre>

<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExcelFormats() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  context.set(Locale.class,Locale.US);
  try (InputStream input=getTestDocument("testEXCEL-formats.xlsx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata.get(Metadata.CONTENT_TYPE));
    String content=handler.toString();
    assertContains("1,599.99",content);
    assertContains("-1,599.99",content);
    assertContains("$1,599.99",content);
    assertContains("$1,599.99)",content);
    assertTrue(content.contains("1.98E08") || content.contains("1.98E+08"));
    assertTrue(content.contains("-1.98E08") || content.contains("-1.98E+08"));
    assertContains("2.50%",content);
    if (System.getProperty("java.version").startsWith("1.5")) {
      assertContains("2%",content);
    }
 else {
      assertContains("3%",content);
    }
    assertContains("6:15",content);
    assertContains("18:15",content);
    assertContains("17-May-07",content);
    assertContains("$1,599.99",content);
    assertContains("($1,599.99)",content);
    assertContains("2 1/2",content);
  }
 }

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test docx without headers
 * TIKA-633
 */
@Test public void testNullHeaders() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  try (InputStream input=getTestDocument("NullHeader.docx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("Should have found some text",false,handler.toString().isEmpty());
  }
 }

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExcelHeaderAndFooterExtraction() throws Exception {
  XMLResult xml=getXML("testEXCEL_headers_footers.xlsx");
  assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml.metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("Internal spreadsheet",xml.metadata.get(TikaCoreProperties.TITLE));
  assertEquals("Aeham Abushwashi",xml.metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Aeham Abushwashi",xml.metadata.get(Metadata.AUTHOR));
  String content=xml.xml;
  assertContains("John Smith1",content);
  assertContains("John Smith50",content);
  assertContains("1 Corporate HQ",content);
  assertContains("Header - Corporate Spreadsheet",content);
  assertContains("Header - For Internal Use Only",content);
  assertContains("Header - Author: John Smith",content);
  assertContains("Footer - Corporate Spreadsheet",content);
  assertContains("Footer - For Internal Use Only",content);
  assertContains("Footer - Author: John Smith",content);
}

</code></pre>

<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEmbeddedPDF() throws Exception {
  Metadata metadata=new Metadata();
  StringWriter sw=new StringWriter();
  SAXTransformerFactory factory=(SAXTransformerFactory)SAXTransformerFactory.newInstance();
  TransformerHandler handler=factory.newTransformerHandler();
  handler.getTransformer().setOutputProperty(OutputKeys.METHOD,"xml");
  handler.getTransformer().setOutputProperty(OutputKeys.INDENT,"no");
  handler.setResult(new StreamResult(sw));
  try (InputStream input=OOXMLParserTest.class.getResourceAsStream("/test-documents/testWORD_embedded_pdf.docx")){
    new OOXMLParser().parse(input,handler,metadata,new ParseContext());
  }
   String xml=sw.toString();
  int i=xml.indexOf("Here is the pdf file:");
  int j=xml.indexOf("<div class=\"embedded\" id=\"rId5\"/>");
  int k=xml.indexOf("Bye Bye");
  int l=xml.indexOf("<div class=\"embedded\" id=\"rId6\"/>");
  int m=xml.indexOf("Bye for real.");
  assertTrue(i != -1);
  assertTrue(j != -1);
  assertTrue(k != -1);
  assertTrue(l != -1);
  assertTrue(m != -1);
  assertTrue(i < j);
  assertTrue(j < k);
  assertTrue(k < l);
  assertTrue(l < m);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMasterText2() throws Exception {
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  try (InputStream stream=OOXMLParserTest.class.getResourceAsStream("/test-documents/testPPT_masterText2.pptx")){
    new AutoDetectParser().parse(stream,handler,metadata,new ParseContext());
  }
   String content=handler.toString();
  assertContains("Text that I added to the master slide",content);
}

</code></pre>

<pre class="type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the plain text output of the Word converter
 * @throws Exception
 */
@Test public void testWord() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  try (InputStream input=getTestDocument("testWORD.docx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.wordprocessingml.document",metadata.get(Metadata.CONTENT_TYPE));
    assertEquals("Sample Word Document",metadata.get(TikaCoreProperties.TITLE));
    assertEquals("Keith Bennett",metadata.get(TikaCoreProperties.CREATOR));
    assertEquals("Keith Bennett",metadata.get(Metadata.AUTHOR));
    assertTrue(handler.toString().contains("Sample Word Document"));
  }
 }

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMasterFooter() throws Exception {
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  try (InputStream stream=OOXMLParserTest.class.getResourceAsStream("/test-documents/testPPT_masterFooter.pptx")){
    new AutoDetectParser().parse(stream,handler,metadata,new ParseContext());
  }
   String content=handler.toString();
  assertContains("Master footer is here",content);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCommentPPTX() throws Exception {
  XMLResult r=getXML("testPPT_comment.pptx");
  assertContains("<p class=\"slide-comment\"><b>Allison, Timothy B. (ATB)",r.xml);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExcelTextBox() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  InputStream input=getTestDocument("testEXCEL_textbox.xlsx");
  parser.parse(input,handler,metadata,context);
  String content=handler.toString();
  assertContains("some autoshape",content);
}

</code></pre>

<pre class="type-4 type-5 type-2 type-10 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that the word converter is able to generate the
 * correct HTML for the document
 */
@Test public void testWordHTML() throws Exception {
  XMLResult result=getXML("testWORD.docx");
  String xml=result.xml;
  Metadata metadata=result.metadata;
  assertEquals("application/vnd.openxmlformats-officedocument.wordprocessingml.document",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("Sample Word Document",metadata.get(TikaCoreProperties.TITLE));
  assertEquals("Keith Bennett",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Keith Bennett",metadata.get(Metadata.AUTHOR));
  assertTrue(xml.contains("Sample Word Document"));
  assertTrue(xml.contains("<h1 class=\"title\">"));
  assertTrue(xml.contains("<h1>Heading Level 1</h1>"));
  assertTrue(xml.contains("<h2>Heading Level 2</h2>"));
  assertTrue(xml.contains("<h3><a name=\"OnLevel3\" />Heading Level 3</h3>"));
  assertTrue(xml.contains("<b>BOLD</b>"));
  assertTrue(xml.contains("<i>ITALIC</i>"));
  assertTrue(xml.contains("<table>"));
  assertTrue(xml.contains("<td>"));
  assertTrue(xml.contains("<a href=\"http://tika.apache.org/\">Tika</a>"));
  assertTrue(xml.contains("<a href=\"#OnMainHeading\">The Main Heading Bookmark</a>"));
  assertTrue(xml.contains("<p class=\"signature\">This one"));
  result=getXML("testWORD_3imgs.docx");
  xml=result.xml;
  assertTrue("Image not found in:\n" + xml,xml.contains("<img src=\"embedded:image2.png\" alt=\"A description...\" />"));
  assertTrue("Image not found in:\n" + xml,xml.contains("<img src=\"embedded:image3.jpeg\" alt=\"A description...\" />"));
  assertTrue("Image not found in:\n" + xml,xml.contains("<img src=\"embedded:image4.png\" alt=\"A description...\" />"));
  assertTrue(xml.contains("<p>The end!</p>"));
  xml=getXML("testWORD_bold_character_runs.docx").xml;
  assertTrue("Bold text wasn't contiguous: " + xml,xml.contains("F<b>oob</b>a<b>r</b>"));
  xml=getXML("testWORD_bold_character_runs2.docx").xml;
  assertTrue("Bold text wasn't contiguous: " + xml,xml.contains("F<b>oob</b>a<b>r</b>"));
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEncrypted() throws Exception {
  Map<String,String> tests=new HashMap<String,String>();
  tests.put("testWORD_protected_passtika.docx","This is an encrypted Word 2007 File");
  tests.put("testPPT_protected_passtika.pptx","This is an encrypted PowerPoint 2007 slide.");
  tests.put("testEXCEL_protected_passtika.xlsx","This is an Encrypted Excel spreadsheet.");
  Parser parser=new AutoDetectParser();
  Metadata m=new Metadata();
  PasswordProvider passwordProvider=new PasswordProvider(){
    @Override public String getPassword(    Metadata metadata){
      return "tika";
    }
  }
;
  ParseContext passwordContext=new ParseContext();
  passwordContext.set(org.apache.tika.parser.PasswordProvider.class,passwordProvider);
  for (  Map.Entry<String,String> e : tests.entrySet()) {
    try (InputStream is=getTestDocument(e.getKey())){
      ContentHandler handler=new BodyContentHandler();
      parser.parse(is,handler,m,passwordContext);
      assertContains(e.getValue(),handler.toString());
    }
   }
  ParseContext context=new ParseContext();
  for (  Map.Entry<String,String> e : tests.entrySet()) {
    boolean exc=false;
    try (InputStream is=getTestDocument(e.getKey())){
      ContentHandler handler=new BodyContentHandler();
      parser.parse(is,handler,m,context);
    }
 catch (    EncryptedDocumentException ex) {
      exc=true;
    }
    assertTrue(exc);
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDOCXParagraphNumbering() throws Exception {
  String xml=getXML("testWORD_numbered_list.docx").xml;
  assertContains("1) This",xml);
  assertContains("a) Is",xml);
  assertContains("i) A multi",xml);
  assertContains("ii) Level",xml);
  assertContains("1. Within cell 1",xml);
  assertContains("b. Cell b",xml);
  assertContains("iii) List",xml);
  assertContains("2) foo",xml);
  assertContains("ii) baz",xml);
  assertContains("ii) foo",xml);
  assertContains("II. bar",xml);
  assertContains("6. six",xml);
  assertContains("7. seven",xml);
  assertContains("a. seven a",xml);
  assertContains("e. seven e",xml);
  assertContains("2. A ii 2",xml);
  assertContains("3. page break list 3",xml);
  assertContains("Some-1-CrazyFormat Greek numbering with crazy format - alpha",xml);
  assertContains("1.1.1. 1.1.1",xml);
  assertContains("1.1. 1.2-&gt;1.1  //set the value",xml);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWordNullStyle() throws Exception {
  String xml=getXML("testWORD_null_style.docx").xml;
  assertContains("Test av styrt dokument",xml);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWordCustomProperties() throws Exception {
  Metadata metadata=new Metadata();
  try (InputStream input=OOXMLParserTest.class.getResourceAsStream("/test-documents/testWORD_custom_props.docx")){
    ContentHandler handler=new BodyContentHandler(-1);
    ParseContext context=new ParseContext();
    context.set(Locale.class,Locale.US);
    new OOXMLParser().parse(input,handler,metadata,context);
  }
   assertEquals("application/vnd.openxmlformats-officedocument.wordprocessingml.document",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("EJ04325S",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Etienne Jouvin",metadata.get(TikaCoreProperties.MODIFIER));
  assertEquals("Etienne Jouvin",metadata.get(Metadata.LAST_AUTHOR));
  assertEquals("2011-07-29T16:52:00Z",metadata.get(TikaCoreProperties.CREATED));
  assertEquals("2011-07-29T16:52:00Z",metadata.get(Metadata.CREATION_DATE));
  assertEquals("2012-01-03T22:14:00Z",metadata.get(TikaCoreProperties.MODIFIED));
  assertEquals("2012-01-03T22:14:00Z",metadata.get(Metadata.DATE));
  assertEquals("Microsoft Office Word",metadata.get(Metadata.APPLICATION_NAME));
  assertEquals("Microsoft Office Word",metadata.get(OfficeOpenXMLExtended.APPLICATION));
  assertEquals("1",metadata.get(Office.PAGE_COUNT));
  assertEquals("2",metadata.get(Office.WORD_COUNT));
  assertEquals("My Title",metadata.get(TikaCoreProperties.TITLE));
  assertEquals("My Keyword",metadata.get(TikaCoreProperties.KEYWORDS));
  assertEquals("Normal.dotm",metadata.get(Metadata.TEMPLATE));
  assertEquals("Normal.dotm",metadata.get(OfficeOpenXMLExtended.TEMPLATE));
  assertEquals("My subject",metadata.get(Metadata.SUBJECT));
  assertEquals("My subject",metadata.get(OfficeOpenXMLCore.SUBJECT));
  assertEquals("EDF-DIT",metadata.get(TikaCoreProperties.PUBLISHER));
  assertEquals("true",metadata.get("custom:myCustomBoolean"));
  assertEquals("3",metadata.get("custom:myCustomNumber"));
  assertEquals("MyStringValue",metadata.get("custom:MyCustomString"));
  assertEquals("2010-12-30T23:00:00Z",metadata.get("custom:MyCustomDate"));
  assertEquals("2010-12-29T22:00:00Z",metadata.get("custom:myCustomSecondDate"));
}

</code></pre>

<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testXLSXThumbnail() throws Exception {
  String xml=getXML("testXLSX_Thumbnail.xlsx").xml;
  int a=xml.indexOf("This file contains an embedded thumbnail by default");
  int b=xml.indexOf("<div class=\"embedded\" id=\"/docProps/thumbnail.wmf\" />");
  assertTrue(a != -1);
  assertTrue(b != -1);
  assertTrue(a < b);
}

</code></pre>

<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDOCXThumbnail() throws Exception {
  String xml=getXML("testDOCX_Thumbnail.docx").xml;
  int a=xml.indexOf("This file contains a thumbnail");
  int b=xml.indexOf("<div class=\"embedded\" id=\"/docProps/thumbnail.emf\" />");
  assertTrue(a != -1);
  assertTrue(b != -1);
  assertTrue(a < b);
}

</code></pre>

<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that we can extract image from docx header
 */
@Test public void testWordPicturesInHeader() throws Exception {
  Metadata metadata=new Metadata();
  ParseContext context=new ParseContext();
  StringWriter sw=new StringWriter();
  SAXTransformerFactory factory=(SAXTransformerFactory)SAXTransformerFactory.newInstance();
  TransformerHandler handler=factory.newTransformerHandler();
  handler.getTransformer().setOutputProperty(OutputKeys.METHOD,"xml");
  handler.getTransformer().setOutputProperty(OutputKeys.INDENT,"yes");
  handler.setResult(new StreamResult(sw));
  try (InputStream input=getTestDocument("headerPic.docx")){
    parser.parse(input,handler,metadata,context);
    String xml=sw.toString();
    assertEquals("application/vnd.openxmlformats-officedocument.wordprocessingml.document",metadata.get(Metadata.CONTENT_TYPE));
    assertTrue(xml.contains("<img"));
  }
 }

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensures that custom OOXML properties are extracted
 */
@Test public void testExcelCustomProperties() throws Exception {
  Metadata metadata=new Metadata();
  try (InputStream input=OOXMLParserTest.class.getResourceAsStream("/test-documents/testEXCEL_custom_props.xlsx")){
    ContentHandler handler=new BodyContentHandler(-1);
    ParseContext context=new ParseContext();
    context.set(Locale.class,Locale.US);
    new OOXMLParser().parse(input,handler,metadata,context);
  }
   assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals(null,metadata.get(TikaCoreProperties.CREATOR));
  assertEquals(null,metadata.get(TikaCoreProperties.MODIFIER));
  assertEquals("2006-09-12T15:06:44Z",metadata.get(TikaCoreProperties.CREATED));
  assertEquals("2006-09-12T15:06:44Z",metadata.get(Metadata.CREATION_DATE));
  assertEquals("2011-08-22T14:24:38Z",metadata.get(Metadata.LAST_MODIFIED));
  assertEquals("2011-08-22T14:24:38Z",metadata.get(TikaCoreProperties.MODIFIED));
  assertEquals("2011-08-22T14:24:38Z",metadata.get(Metadata.DATE));
  assertEquals("Microsoft Excel",metadata.get(Metadata.APPLICATION_NAME));
  assertEquals("Microsoft Excel",metadata.get(OfficeOpenXMLExtended.APPLICATION));
  assertEquals("true",metadata.get("custom:myCustomBoolean"));
  assertEquals("3",metadata.get("custom:myCustomNumber"));
  assertEquals("MyStringValue",metadata.get("custom:MyCustomString"));
  assertEquals("2010-12-30T22:00:00Z",metadata.get("custom:MyCustomDate"));
  assertEquals("2010-12-29T22:00:00Z",metadata.get("custom:myCustomSecondDate"));
}

</code></pre>

<pre class="type-9 type-7 type-14 type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * We have a number of different powerpoint files,
 * such as presentation, macro-enabled etc
 */
@Test public void testPowerPoint() throws Exception {
  String[] extensions=new String[]{"pptx","pptm","ppsm","ppsx","potm"};
  String[] mimeTypes=new String[]{"application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint.presentation.macroenabled.12","application/vnd.ms-powerpoint.slideshow.macroenabled.12","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.template.macroenabled.12"};
  for (int i=0; i < extensions.length; i++) {
    String extension=extensions[i];
    String filename="testPPT." + extension;
    Parser parser=new AutoDetectParser();
    Metadata metadata=new Metadata();
    ContentHandler handler=new BodyContentHandler();
    ParseContext context=new ParseContext();
    try (InputStream input=getTestDocument(filename)){
      parser.parse(input,handler,metadata,context);
      assertEquals("Mime-type checking for " + filename,mimeTypes[i],metadata.get(Metadata.CONTENT_TYPE));
      assertEquals("Attachment Test",metadata.get(TikaCoreProperties.TITLE));
      assertEquals("Rajiv",metadata.get(TikaCoreProperties.CREATOR));
      assertEquals("Rajiv",metadata.get(Metadata.AUTHOR));
      String content=handler.toString();
      if (extension.equals("thmx")) {
        assertEquals("",content);
      }
 else {
        assertTrue("Text missing for " + filename + "\n"+ content,content.contains("Attachment Test"));
        assertTrue("Text missing for " + filename + "\n"+ content,content.contains("This is a test file data with the same content"));
        assertTrue("Text missing for " + filename + "\n"+ content,content.contains("content parsing"));
        assertTrue("Text missing for " + filename + "\n"+ content,content.contains("Different words to test against"));
        assertTrue("Text missing for " + filename + "\n"+ content,content.contains("Mystery"));
      }
    }
   }
}

</code></pre>

<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testMultiAuthorsManagers() throws Exception {
  XMLResult r=getXML("testWORD_multi_authors.docx");
  String[] authors=r.metadata.getValues(TikaCoreProperties.CREATOR);
  assertEquals(3,authors.length);
  assertEquals("author2",authors[1]);
  String[] managers=r.metadata.getValues(OfficeOpenXMLExtended.MANAGER);
  assertEquals(2,managers.length);
  assertEquals("manager1",managers[0]);
  assertEquals("manager2",managers[1]);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * TIKA-712 Master Slide Text from PPT and PPTX files
 * should be extracted too
 */
@Test public void testMasterText() throws Exception {
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  try (InputStream stream=OOXMLParserTest.class.getResourceAsStream("/test-documents/testPPT_masterText.pptx")){
    new AutoDetectParser().parse(stream,handler,metadata,new ParseContext());
  }
   String content=handler.toString();
  assertContains("Text that I added to the master slide",content);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that the metadata is already extracted when the body is processed.
 * See TIKA-1109
 */
@Test public void testPowerPointMetadataEarly() throws Exception {
  String[] extensions=new String[]{"pptx","pptm","ppsm","ppsx","potm"};
  final String[] mimeTypes=new String[]{"application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint.presentation.macroenabled.12","application/vnd.ms-powerpoint.slideshow.macroenabled.12","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.template.macroenabled.12"};
  for (int i=0; i < extensions.length; i++) {
    String extension=extensions[i];
    final String filename="testPPT." + extension;
    Parser parser=new AutoDetectParser();
    final Metadata metadata=new Metadata();
    final int currentI=i;
    ContentHandler handler=new BodyContentHandler(){
      public void startDocument(){
        assertEquals("Mime-type checking for " + filename,mimeTypes[currentI],metadata.get(Metadata.CONTENT_TYPE));
        assertEquals("Attachment Test",metadata.get(TikaCoreProperties.TITLE));
        assertEquals("Rajiv",metadata.get(TikaCoreProperties.CREATOR));
        assertEquals("Rajiv",metadata.get(Metadata.AUTHOR));
      }
    }
;
    ParseContext context=new ParseContext();
    try (InputStream input=getTestDocument(filename)){
      parser.parse(input,handler,metadata,context);
    }
   }
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVariousPPTX() throws Exception {
  Metadata metadata=new Metadata();
  String xml=getXML("testPPT_various.pptx",metadata).xml;
  assertContains("<p>Footnote appears here",xml);
  assertContains("<p>[1] This is a footnote.",xml);
  assertContains("<p>This is the header text.</p>",xml);
  assertContains("<p>This is the footer text.</p>",xml);
  assertContains("<p>Here is a text box</p>",xml);
  assertContains("<p>Bold",xml);
  assertContains("italic underline superscript subscript",xml);
  assertContains("<p>Here is a citation:",xml);
  assertContains("Figure 1 This is a caption for Figure 1",xml);
  assertContains("(Kramer)",xml);
  assertContains("<table><tr>\t<td>Row 1 Col 1</td>",xml);
  assertContains("<td>Row 2 Col 2</td>\t<td>Row 2 Col 3</td></tr>",xml);
  assertContains("<p>Row 1 column 1</p>",xml);
  assertContains("<p>Row 2 column 2</p>",xml);
  assertContains("<p>This is a hyperlink",xml);
  assertContains("<p>Here is a list:",xml);
  for (int row=1; row <= 3; row++) {
    assertContains("<p>Bullet " + row,xml);
  }
  assertContains("Here is a numbered list:",xml);
  for (int row=1; row <= 3; row++) {
    assertContains("<p>Number bullet " + row,xml);
  }
  for (int row=1; row <= 2; row++) {
    for (int col=1; col <= 3; col++) {
      assertContains("Row " + row + " Col "+ col,xml);
    }
  }
  assertContains("Keyword1 Keyword2",xml);
  assertEquals("Keyword1 Keyword2",metadata.get(Metadata.KEYWORDS));
  assertContains("Subject is here",xml);
  assertEquals("Subject is here",metadata.get(Metadata.SUBJECT));
  assertEquals("Subject is here",metadata.get(OfficeOpenXMLCore.SUBJECT));
  assertContains("Suddenly some Japanese text:",xml);
  assertContains("\uff08\uff27\uff28\uff31\uff09",xml);
  assertContains("\u30be\u30eb\u30b2\u3068\u5c3e\u5d0e\u3001\u6de1\u3005\u3068\u6700\u671f",xml);
  assertContains("And then some Gothic text:",xml);
  assertContains("\uD800\uDF32\uD800\uDF3f\uD800\uDF44\uD800\uDF39\uD800\uDF43\uD800\uDF3A",xml);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExcel() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  context.set(Locale.class,Locale.US);
  try (InputStream input=getTestDocument("testEXCEL.xlsx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata.get(Metadata.CONTENT_TYPE));
    assertEquals("Simple Excel document",metadata.get(TikaCoreProperties.TITLE));
    assertEquals("Keith Bennett",metadata.get(TikaCoreProperties.CREATOR));
    assertEquals("Keith Bennett",metadata.get(Metadata.AUTHOR));
    String content=handler.toString();
    assertContains("Sample Excel Worksheet",content);
    assertContains("Numbers and their Squares",content);
    assertContains("9",content);
    assertNotContained("9.0",content);
    assertContains("196",content);
    assertNotContained("196.0",content);
    assertEquals("false",metadata.get(TikaMetadataKeys.PROTECTED));
  }
 }

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDOCXOverrideParagraphNumbering() throws Exception {
  String xml=getXML("testWORD_override_list_numbering.docx").xml;
  assertContains("<p>1.1.1.1...1 1.1.1.1...1</p>",xml);
  assertContains("1st.2.3someText 1st.2.3someText",xml);
  assertContains("1st.2.2someOtherText.1 1st.2.2someOtherText.1",xml);
  assertContains("5th 5th",xml);
  assertContains("1.a.I 1.a.I",xml);
  assertContains("<p>1.b.III 1.b.III</p>",xml);
  assertContains("2.a.I 2.a.I",xml);
  assertContains("<p>2.b 2.b</p>",xml);
  assertContains("(1)) (1))",xml);
  assertContains("2.17 2.17",xml);
  assertContains("2.18.2.1 2.18.2.1",xml);
  assertContains("<p>2 2</p>",xml);
  assertContains("<p>1 1</p>",xml);
  assertContains("<p>A A</p>",xml);
  assertContains("<p>B B</p>",xml);
  assertContains("<p>C C</p>",xml);
  assertContains("<p>4 4</p>",xml);
  assertContains(">00 00",xml);
  assertContains(">01 01",xml);
  assertContains(">01. 01.",xml);
  assertContains(">01..1 01..1",xml);
  assertContains(">02 02",xml);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * An excel document which is password protected.
 * See TIKA-437.
 */
@Test public void testProtectedExcelFile() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  try (InputStream input=getTestDocument("protectedFile.xlsx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata.get(Metadata.CONTENT_TYPE));
    assertEquals("true",metadata.get(TikaMetadataKeys.PROTECTED));
    String content=handler.toString();
    assertContains("Office",content);
  }
 }

</code></pre>

<pre class="type-4 type-2 type-17 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore("OOXML-Strict not currently supported by POI, see #57699") public void testExcelStrict() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  context.set(Locale.class,Locale.US);
  try (InputStream input=getTestDocument("testEXCEL.strict.xlsx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata.get(Metadata.CONTENT_TYPE));
    assertEquals("Sample Spreadsheet",metadata.get(TikaCoreProperties.TITLE));
    assertEquals("Nick Burch",metadata.get(TikaCoreProperties.CREATOR));
    assertEquals("Spreadsheet for testing",metadata.get(TikaCoreProperties.DESCRIPTION));
    String content=handler.toString();
    assertContains("Test spreadsheet",content);
    assertContains("This one is red",content);
    assertContains("cb=10",content);
    assertNotContained("10.0",content);
    assertContains("cb=sum",content);
    assertNotContained("13.0",content);
    assertEquals("false",metadata.get(TikaMetadataKeys.PROTECTED));
  }
 }

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmbeddedPPTXTwoSlides() throws Exception {
  String xml=getXML("testPPT_embedded_two_slides.pptx").xml;
  assertContains("<div class=\"embedded\" id=\"slide1_rId7\" />",xml);
  assertContains("<div class=\"embedded\" id=\"slide2_rId7\" />",xml);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPPTXAutodate() throws Exception {
  XMLResult result=getXML("testPPT_autodate.pptx");
  assertContains("<p>Now</p>\n" + "<p>2011-12-19 10:20:04 AM</p>\n",result.xml);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWordArt() throws Exception {
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  try (InputStream stream=OOXMLParserTest.class.getResourceAsStream("/test-documents/testWordArt.pptx")){
    new AutoDetectParser().parse(stream,handler,metadata,new ParseContext());
  }
   String content=handler.toString();
  assertContains("Here is some red word Art",content);
}

</code></pre>

<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEmbeddedZipInPPTX() throws Exception {
  String xml=getXML("test_embedded_zip.pptx").xml;
  int h=xml.indexOf("<div class=\"embedded\" id=\"slide1_rId3\" />");
  int i=xml.indexOf("Send me a note");
  int j=xml.indexOf("<div class=\"embedded\" id=\"slide2_rId4\" />");
  int k=xml.indexOf("<p>No title</p>");
  assertTrue(h != -1);
  assertTrue(i != -1);
  assertTrue(j != -1);
  assertTrue(k != -1);
  assertTrue(h < i);
  assertTrue(i < j);
  assertTrue(j < k);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test for missing text described in
 * <a href="https://issues.apache.org/jira/browse/TIKA-1130">TIKA-1130</a>.
 * and TIKA-1317
 */
@Test public void testMissingText() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  try (InputStream input=getTestDocument("testWORD_missing_text.docx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.wordprocessingml.document",metadata.get(Metadata.CONTENT_TYPE));
    assertContains("BigCompany",handler.toString());
    assertContains("Seasoned",handler.toString());
    assertContains("Rich_text_in_cell",handler.toString());
  }
 }

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPowerPointCustomProperties() throws Exception {
  Metadata metadata=new Metadata();
  try (InputStream input=OOXMLParserTest.class.getResourceAsStream("/test-documents/testPPT_custom_props.pptx")){
    ContentHandler handler=new BodyContentHandler(-1);
    ParseContext context=new ParseContext();
    context.set(Locale.class,Locale.US);
    new OOXMLParser().parse(input,handler,metadata,context);
  }
   assertEquals("application/vnd.openxmlformats-officedocument.presentationml.presentation",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("JOUVIN ETIENNE",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("EJ04325S",metadata.get(TikaCoreProperties.MODIFIER));
  assertEquals("EJ04325S",metadata.get(Metadata.LAST_AUTHOR));
  assertEquals("2011-08-22T13:30:53Z",metadata.get(TikaCoreProperties.CREATED));
  assertEquals("2011-08-22T13:30:53Z",metadata.get(Metadata.CREATION_DATE));
  assertEquals("2011-08-22T13:32:49Z",metadata.get(TikaCoreProperties.MODIFIED));
  assertEquals("2011-08-22T13:32:49Z",metadata.get(Metadata.DATE));
  assertEquals("1",metadata.get(Office.SLIDE_COUNT));
  assertEquals("3",metadata.get(Office.WORD_COUNT));
  assertEquals("Test extraction properties pptx",metadata.get(TikaCoreProperties.TITLE));
  assertEquals("true",metadata.get("custom:myCustomBoolean"));
  assertEquals("3",metadata.get("custom:myCustomNumber"));
  assertEquals("MyStringValue",metadata.get("custom:MyCustomString"));
  assertEquals("2010-12-30T22:00:00Z",metadata.get("custom:MyCustomDate"));
  assertEquals("2010-12-29T22:00:00Z",metadata.get("custom:myCustomSecondDate"));
}

</code></pre>

<pre class="type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the plain text output of the Word converter
 * @throws Exception
 */
@Test public void testWordFootnote() throws Exception {
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler();
  ParseContext context=new ParseContext();
  try (InputStream input=getTestDocument("footnotes.docx")){
    parser.parse(input,handler,metadata,context);
    assertEquals("application/vnd.openxmlformats-officedocument.wordprocessingml.document",metadata.get(Metadata.CONTENT_TYPE));
    assertTrue(handler.toString().contains("snoska"));
  }
 }

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * TIKA-1044 - Handle word documents where parts of the
 * text have no formatting or styles applied to them
 */
@Test public void testNoFormat() throws Exception {
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  try (InputStream stream=WordParserTest.class.getResourceAsStream("/test-documents/testWORD_no_format.docx")){
    new OOXMLParser().parse(stream,handler,metadata,new ParseContext());
  }
   String content=handler.toString();
  assertContains("This is a piece of text that causes an exception",content);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
