<h3 style="margin:0px">Class: org.apache.tika.parser.pdf.PDFParserTest (35 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(19)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(12)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDuplicateOverlappingText() throws Exception {
  PDFParser parser=new PDFParser();
  InputStream stream=getResourceAsStream("/test-documents/testOverlappingText.pdf");
  String content=getText(stream,parser);
  assertContains("Text the first timeText the second time",content);
  parser.getPDFParserConfig().setSuppressDuplicateOverlappingText(true);
  stream=getResourceAsStream("/test-documents/testOverlappingText.pdf");
  content=getText(stream,parser);
  assertContains("Text the first timesecond time",content);
  Parser autoParser=new AutoDetectParser();
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  context.set(PDFParserConfig.class,config);
  stream=getResourceAsStream("/test-documents/testOverlappingText.pdf");
  content=getText(stream,autoParser,context);
  assertContains("Text the first timeText the second time",content);
  config.setSuppressDuplicateOverlappingText(true);
  stream=getResourceAsStream("/test-documents/testOverlappingText.pdf");
  content=getText(stream,autoParser,context);
  assertContains("Text the first timesecond time",content);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTwoTextBoxes() throws Exception {
  Parser parser=new AutoDetectParser();
  InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDFTwoTextBoxes.pdf");
  String content=getText(stream,parser);
  content=content.replaceAll("\\s+"," ");
  assertContains("Left column line 1 Left column line 2 Right column line 1 Right column line 2",content);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPDFEncodedStringsInXMP() throws Exception {
  XMLResult r=getXML("testPDF_PDFEncodedStringInXMP.pdf");
  assertEquals("Microsoft",r.metadata.get(TikaCoreProperties.TITLE));
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEmbeddedFilesInAnnotations() throws Exception {
  String xml=getXML("/testPDFFileEmbInAnnotation.pdf").xml;
  assertTrue(xml.contains("This is a Excel"));
}

</code></pre>

<pre class="type-9 type-4 type-5 type-2 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmbeddedPDFEmbeddingAnotherDocument() throws Exception {
  Parser parser=new AutoDetectParser();
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  ParseContext context=new ParseContext();
  String content="";
  InputStream stream=null;
  try {
    context.set(org.apache.tika.parser.Parser.class,parser);
    stream=getResourceAsStream("/test-documents/testPDFEmbeddingAndEmbedded.docx");
    parser.parse(stream,handler,metadata,context);
    content=handler.toString();
  }
  finally {
    stream.close();
  }
  int outerHaystack=content.indexOf("Outer_haystack");
  int pdfHaystack=content.indexOf("pdf_haystack");
  int needle=content.indexOf("Needle");
  assertTrue(outerHaystack > -1);
  assertTrue(pdfHaystack > -1);
  assertTrue(needle > -1);
  assertTrue(needle > pdfHaystack && pdfHaystack > outerHaystack);
  TrackingHandler tracker=new TrackingHandler();
  TikaInputStream tis;
  ContainerExtractor ex=new ParserContainerExtractor();
  try {
    tis=TikaInputStream.get(getResourceAsStream("/test-documents/testPDFEmbeddingAndEmbedded.docx"));
    ex.extract(tis,ex,tracker);
  }
  finally {
    stream.close();
  }
  assertEquals(true,ex.isSupported(tis));
  assertEquals(3,tracker.filenames.size());
  assertEquals(3,tracker.mediaTypes.size());
  assertEquals("image1.emf",tracker.filenames.get(0));
  assertNull(tracker.filenames.get(1));
  assertEquals("Test.docx",tracker.filenames.get(2));
  assertEquals(TYPE_EMF,tracker.mediaTypes.get(0));
  assertEquals(TYPE_PDF,tracker.mediaTypes.get(1));
  assertEquals(TYPE_DOCX,tracker.mediaTypes.get(2));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccessCheckingUserPassword() throws Exception {
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  config.setAccessChecker(new AccessChecker(false));
  PasswordProvider passwordProvider=new PasswordProvider(){
    @Override public String getPassword(    Metadata metadata){
      return "user";
    }
  }
;
  context.set(PasswordProvider.class,passwordProvider);
  context.set(PDFParserConfig.class,config);
  Parser parser=new AutoDetectParser();
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_empty.pdf","testPDF_no_extract_yes_accessibility_owner_empty.pdf"}) {
    assertException("/test-documents/" + path,parser,context,EncryptedDocumentException.class);
  }
  config.setAccessChecker(new AccessChecker(true));
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_empty.pdf","testPDF_no_extract_yes_accessibility_owner_empty.pdf"}) {
    assertException("/test-documents/" + path,parser,context,EncryptedDocumentException.class);
  }
  assertException("/test-documents/" + "testPDF_no_extract_no_accessibility_owner_user.pdf",parser,context,AccessPermissionException.class);
  InputStream is=null;
  try {
    is=getResourceAsStream("/test-documents/" + "testPDF_no_extract_yes_accessibility_owner_user.pdf");
    assertContains("Hello World",getText(is,parser,context));
  }
  finally {
    IOUtils.closeQuietly(is);
  }
  config.setAccessChecker(new AccessChecker(false));
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_user.pdf","testPDF_no_extract_yes_accessibility_owner_user.pdf"}) {
    assertException("/test-documents/" + path,parser,context,AccessPermissionException.class);
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPageNumber() throws Exception {
  final XMLResult result=getXML("testPageNumber.pdf");
  final String content=result.xml.replaceAll("\\s+","");
  assertContains("<p>1</p>",content);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPopupAnnotation() throws Exception {
  Parser parser=new AutoDetectParser();
  InputStream stream=getResourceAsStream("/test-documents/testPopupAnnotation.pdf");
  String content=getText(stream,parser);
  assertContains("this is the note",content);
  assertContains("igalsh",content);
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSignatureInAcroForm() throws Exception {
  String xml=getXML("/testPDF_acroform3.pdf").xml;
  assertTrue("found",(xml.contains("<li>aTextField: TIKA-1226</li>")));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleTitles() throws Exception {
  InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/testPDFTripleLangTitle.pdf");
  Parser p=new AutoDetectParser();
  Metadata m=new Metadata();
  ParseContext c=new ParseContext();
  ContentHandler h=new BodyContentHandler();
  p.parse(is,h,m,c);
  is.close();
  assertEquals("Hello World",m.get("dc:title"));
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOSSpecificEmbeddedFileExtraction() throws Exception {
  InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF_multiFormatEmbFiles.pdf");
  RecursiveParserWrapper p=new RecursiveParserWrapper(new AutoDetectParser(),new BasicContentHandlerFactory(BasicContentHandlerFactory.HANDLER_TYPE.TEXT,-1));
  Metadata m=new Metadata();
  ParseContext c=new ParseContext();
  c.set(org.apache.tika.parser.Parser.class,p);
  ContentHandler h=new BodyContentHandler();
  p.parse(is,h,m,c);
  is.close();
  List<Metadata> metadatas=p.getMetadata();
  assertEquals("metadata size",5,metadatas.size());
  assertEquals("file name","Test.txt",metadatas.get(1).get(Metadata.RESOURCE_NAME_KEY));
  assertContains("os specific",metadatas.get(1).get(RecursiveParserWrapper.TIKA_CONTENT));
  assertEquals("file name","TestMac.txt",metadatas.get(2).get(Metadata.RESOURCE_NAME_KEY));
  assertContains("mac embedded",metadatas.get(2).get(RecursiveParserWrapper.TIKA_CONTENT));
  assertEquals("file name","TestDos.txt",metadatas.get(3).get(Metadata.RESOURCE_NAME_KEY));
  assertContains("dos embedded",metadatas.get(3).get(RecursiveParserWrapper.TIKA_CONTENT));
  assertEquals("file name","TestUnix.txt",metadatas.get(4).get(Metadata.RESOURCE_NAME_KEY));
  assertContains("unix embedded",metadatas.get(4).get(RecursiveParserWrapper.TIKA_CONTENT));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSingleCloseDoc() throws Exception {
  InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/testPDFTripleLangTitle.pdf");
  Parser p=new AutoDetectParser();
  Metadata m=new Metadata();
  ParseContext c=new ParseContext();
  ContentHandler h=new EventCountingHandler();
  p.parse(is,h,m,c);
  assertEquals(1,((EventCountingHandler)h).getEndDocument());
}

</code></pre>

<pre class="type-9 type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * PDFs can be "protected" with the default password. This means
 * they're encrypted (potentially both text and metadata),
 * but we can decrypt them easily.
 */
@Test public void testProtectedPDF() throws Exception {
  Parser parser=new AutoDetectParser();
  ContentHandler handler=new BodyContentHandler();
  Metadata metadata=new Metadata();
  ParseContext context=new ParseContext();
  try (InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF_protected.pdf")){
    parser.parse(stream,handler,metadata,context);
  }
   assertEquals("true",metadata.get("pdf:encrypted"));
  assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("The Bank of England",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("The Bank of England",metadata.get(Metadata.AUTHOR));
  assertEquals("Speeches by Andrew G Haldane",metadata.get(OfficeOpenXMLCore.SUBJECT));
  assertEquals("Speeches by Andrew G Haldane",metadata.get(Metadata.SUBJECT));
  assertEquals("Rethinking the Financial Network, Speech by Andrew G Haldane, Executive Director, Financial Stability delivered at the Financial Student Association, Amsterdam on 28 April 2009",metadata.get(TikaCoreProperties.TITLE));
  String content=handler.toString();
  assertContains("RETHINKING THE FINANCIAL NETWORK",content);
  assertContains("On 16 November 2002",content);
  assertContains("In many important respects",content);
  handler=new BodyContentHandler();
  metadata=new Metadata();
  context=new ParseContext();
  context.set(PasswordProvider.class,new PasswordProvider(){
    public String getPassword(    Metadata metadata){
      return "";
    }
  }
);
  try (InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF_protected.pdf")){
    parser.parse(stream,handler,metadata,context);
  }
   assertEquals("true",metadata.get("pdf:encrypted"));
  assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("The Bank of England",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Speeches by Andrew G Haldane",metadata.get(OfficeOpenXMLCore.SUBJECT));
  assertEquals("Speeches by Andrew G Haldane",metadata.get(Metadata.SUBJECT));
  assertEquals("Rethinking the Financial Network, Speech by Andrew G Haldane, Executive Director, Financial Stability delivered at the Financial Student Association, Amsterdam on 28 April 2009",metadata.get(TikaCoreProperties.TITLE));
  assertContains("RETHINKING THE FINANCIAL NETWORK",content);
  assertContains("On 16 November 2002",content);
  assertContains("In many important respects",content);
  handler=new BodyContentHandler();
  metadata=new Metadata();
  context=new ParseContext();
  context.set(PasswordProvider.class,new PasswordProvider(){
    public String getPassword(    Metadata metadata){
      return "WRONG!!!!";
    }
  }
);
  boolean ex=false;
  try (InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF_protected.pdf")){
    parser.parse(stream,handler,metadata,context);
  }
 catch (  EncryptedDocumentException e) {
    ex=true;
  }
  content=handler.toString();
  assertTrue("encryption exception",ex);
  assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("true",metadata.get("pdf:encrypted"));
  assertEquals("very little metadata should be parsed",3,metadata.names().length);
  assertEquals(0,content.length());
  handler=new BodyContentHandler();
  metadata=new Metadata();
  context=new ParseContext();
  context.set(PasswordProvider.class,new PasswordProvider(){
    public String getPassword(    Metadata metadata){
      return "WRONG!!!!";
    }
  }
);
  PDFParserConfig config=new PDFParserConfig();
  config.setUseNonSequentialParser(true);
  context.set(PDFParserConfig.class,config);
  ;
  ex=false;
  try (InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF_protected.pdf")){
    parser.parse(stream,handler,metadata,context);
  }
 catch (  EncryptedDocumentException e) {
    ex=true;
  }
  content=handler.toString();
  assertTrue("encryption exception",ex);
  assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("true",metadata.get("pdf:encrypted"));
  assertEquals("very little metadata should be parsed",3,metadata.names().length);
  assertEquals(0,content.length());
}

</code></pre>

<pre class="type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleAuthors() throws Exception {
  String fName="testPDF_twoAuthors.pdf";
  InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/" + fName);
  Parser p=new AutoDetectParser();
  Metadata m=new Metadata();
  ParseContext c=new ParseContext();
  ContentHandler h=new BodyContentHandler();
  p.parse(is,h,m,c);
  is.close();
  String[] keys=new String[]{"dc:creator","meta:author","creator","Author"};
  for (  String k : keys) {
    String[] vals=m.getValues(k);
    assertEquals("number of authors == 2 for key: " + k,2,vals.length);
    Set<String> set=new HashSet<String>();
    set.add(vals[0]);
    set.add(vals[1]);
    assertTrue("Sample Author 1",set.contains("Sample Author 1"));
    assertTrue("Sample Author 2",set.contains("Sample Author 2"));
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccessCheckingOwnerPassword() throws Exception {
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  config.setAccessChecker(new AccessChecker(true));
  PasswordProvider passwordProvider=new PasswordProvider(){
    @Override public String getPassword(    Metadata metadata){
      return "owner";
    }
  }
;
  context.set(PasswordProvider.class,passwordProvider);
  context.set(PDFParserConfig.class,config);
  Parser parser=new AutoDetectParser();
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_user.pdf","testPDF_no_extract_yes_accessibility_owner_user.pdf","testPDF_no_extract_no_accessibility_owner_empty.pdf","testPDF_no_extract_yes_accessibility_owner_empty.pdf"}) {
    InputStream is=null;
    try {
      is=getResourceAsStream("/test-documents/" + "testPDF_no_extract_yes_accessibility_owner_user.pdf");
      assertContains("Hello World",getText(is,parser,context));
    }
  finally {
      IOUtils.closeQuietly(is);
    }
  }
  config.setAccessChecker(new AccessChecker(false));
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_user.pdf","testPDF_no_extract_yes_accessibility_owner_user.pdf","testPDF_no_extract_no_accessibility_owner_empty.pdf","testPDF_no_extract_yes_accessibility_owner_empty.pdf"}) {
    InputStream is=null;
    try {
      is=getResourceAsStream("/test-documents/" + "testPDF_no_extract_yes_accessibility_owner_user.pdf");
      assertContains("Hello World",getText(is,parser,context));
    }
  finally {
      IOUtils.closeQuietly(is);
    }
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortByPosition() throws Exception {
  PDFParser parser=new PDFParser();
  parser.getPDFParserConfig().setEnableAutoSpace(false);
  InputStream stream=getResourceAsStream("/test-documents/testPDFTwoTextBoxes.pdf");
  String content=getText(stream,parser);
  content=content.replaceAll("\\s+"," ");
  assertContains("Left column line 1 Left column line 2 Right column line 1 Right column line 2",content);
  parser.getPDFParserConfig().setSortByPosition(true);
  stream=getResourceAsStream("/test-documents/testPDFTwoTextBoxes.pdf");
  content=getText(stream,parser);
  content=content.replaceAll("\\s+"," ");
  assertContains("Left column line 1 Right column line 1 Left colu mn line 2 Right column line 2",content);
  AutoDetectParser autoParser=new AutoDetectParser();
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  context.set(PDFParserConfig.class,config);
  stream=getResourceAsStream("/test-documents/testPDFTwoTextBoxes.pdf");
  content=getText(stream,autoParser,context);
  content=content.replaceAll("\\s+"," ");
  assertContains("Left column line 1 Left column line 2 Right column line 1 Right column line 2",content);
  config.setSortByPosition(true);
  context.set(PDFParserConfig.class,config);
  stream=getResourceAsStream("/test-documents/testPDFTwoTextBoxes.pdf");
  content=getText(stream,parser);
  content=content.replaceAll("\\s+"," ");
  assertContains("Left column line 1 Right column line 1 Left colu mn line 2 Right column line 2",content);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmbeddedPDFs() throws Exception {
  String xml=getXML("testPDFPackage.pdf").xml;
  assertContains("PDF1",xml);
  assertContains("PDF2",xml);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVarious() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDFVarious.pdf");
  String content=getText(stream,parser,metadata);
  assertContains("Footnote appears here",content);
  assertContains("This is a footnote.",content);
  assertContains("This is the header text.",content);
  assertContains("This is the footer text.",content);
  assertContains("Here is a text box",content);
  assertContains("Bold",content);
  assertContains("italic",content);
  assertContains("underline",content);
  assertContains("superscript",content);
  assertContains("subscript",content);
  assertContains("Here is a citation:",content);
  assertContains("Figure 1 This is a caption for Figure 1",content);
  assertContains("(Kramer)",content);
  assertContains("Row 1 Col 1 Row 1 Col 2 Row 1 Col 3 Row 2 Col 1 Row 2 Col 2 Row 2 Col 3",content.replaceAll("\\s+"," "));
  assertContains("Row 1 column 1 Row 2 column 1 Row 1 column 2 Row 2 column 2",content.replaceAll("\\s+"," "));
  assertContains("This is a hyperlink",content);
  assertContains("Here is a list:",content);
  for (int row=1; row <= 3; row++) {
    assertContains("Bullet " + row,content);
  }
  assertContains("Here is a numbered list:",content);
  for (int row=1; row <= 3; row++) {
    assertContains(row + ") Number bullet " + row,content);
  }
  for (int row=1; row <= 2; row++) {
    for (int col=1; col <= 3; col++) {
      assertContains("Row " + row + " Col "+ col,content);
    }
  }
  assertContains("Keyword1 Keyword2",content);
  assertEquals("Keyword1 Keyword2",metadata.get(Metadata.KEYWORDS));
  assertContains("Subject is here",content);
  assertEquals("Subject is here",metadata.get(OfficeOpenXMLCore.SUBJECT));
  assertEquals("Subject is here",metadata.get(Metadata.SUBJECT));
  assertContains("Suddenly some Japanese text:",content);
  assertContains("\uff08\uff27\uff28\uff31\uff09",content);
  assertContains("\u30be\u30eb\u30b2\u3068\u5c3e\u5d0e\u3001\u6de1\u3005\u3068\u6700\u671f",content);
  assertContains("And then some Gothic text:",content);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLegacyAccessChecking() throws Exception {
  for (  String file : new String[]{"testPDF_no_extract_no_accessibility_owner_empty.pdf","testPDF_no_extract_yes_accessibility_owner_empty.pdf"}) {
    String xml=getXML(file).xml;
    assertContains("Hello World",xml);
  }
  PasswordProvider provider=new PasswordProvider(){
    @Override public String getPassword(    Metadata metadata){
      return "user";
    }
  }
;
  ParseContext context=new ParseContext();
  context.set(PasswordProvider.class,provider);
  Parser parser=new AutoDetectParser();
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_user.pdf","testPDF_no_extract_yes_accessibility_owner_user.pdf"}) {
    InputStream stream=null;
    try {
      stream=TikaInputStream.get(this.getClass().getResource("/test-documents/" + path));
      String text=getText(stream,parser,context);
      assertContains("Hello World",text);
    }
  finally {
      IOUtils.closeQuietly(stream);
    }
  }
}

</code></pre>

<pre class="type-9 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDisableAutoSpace() throws Exception {
  PDFParser parser=new PDFParser();
  parser.getPDFParserConfig().setEnableAutoSpace(false);
  InputStream stream=getResourceAsStream("/test-documents/testExtraSpaces.pdf");
  String content=getText(stream,parser);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertContains("Here is some formatted text",content);
  parser.getPDFParserConfig().setEnableAutoSpace(true);
  stream=getResourceAsStream("/test-documents/testExtraSpaces.pdf");
  content=getText(stream,parser);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertEquals(-1,content.indexOf("Here is some formatted text"));
  Parser autoParser=new AutoDetectParser();
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  context.set(PDFParserConfig.class,config);
  stream=getResourceAsStream("/test-documents/testExtraSpaces.pdf");
  content=getText(stream,autoParser,context);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertEquals(-1,content.indexOf("Here is some formatted text"));
  config.setEnableAutoSpace(false);
  stream=getResourceAsStream("/test-documents/testExtraSpaces.pdf");
  content=getText(stream,parser,context);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertContains("Here is some formatted text",content);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPdfParsingMetadataOnly() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  try (InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF.pdf")){
    parser.parse(stream,null,metadata,new ParseContext());
  }
   assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("Bertrand Delacr\u00e9taz",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Firefox",metadata.get(TikaCoreProperties.CREATOR_TOOL));
  assertEquals("Apache Tika - Apache Tika",metadata.get(TikaCoreProperties.TITLE));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAccessCheckingEmptyPassword() throws Exception {
  PDFParserConfig config=new PDFParserConfig();
  config.setAccessChecker(new AccessChecker(false));
  Parser parser=new AutoDetectParser();
  ParseContext context=new ParseContext();
  context.set(PDFParserConfig.class,config);
  for (  String path : new String[]{"testPDF_no_extract_no_accessibility_owner_empty.pdf","testPDF_no_extract_yes_accessibility_owner_empty.pdf"}) {
    assertException("/test-documents/" + path,parser,context,AccessPermissionException.class);
  }
  config.setAccessChecker(new AccessChecker(true));
  assertException("/test-documents/" + "testPDF_no_extract_no_accessibility_owner_empty.pdf",parser,context,AccessPermissionException.class);
  InputStream is=null;
  try {
    is=getResourceAsStream("/test-documents/" + "testPDF_no_extract_yes_accessibility_owner_empty.pdf");
    assertContains("Hello World",getText(is,parser,context));
  }
  finally {
    IOUtils.closeQuietly(is);
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmbeddedFileMarkup() throws Exception {
  Parser parser=new AutoDetectParser();
  ParseContext context=new ParseContext();
  context.set(org.apache.tika.parser.Parser.class,parser);
  PDFParserConfig config=new PDFParserConfig();
  config.setExtractInlineImages(true);
  config.setExtractUniqueInlineImagesOnly(false);
  context.set(org.apache.tika.parser.pdf.PDFParserConfig.class,config);
  Metadata metadata=new Metadata();
  ContentHandler handler=new ToXMLContentHandler();
  String path="/test-documents/testPDF_childAttachments.pdf";
  InputStream stream=null;
  try {
    stream=TikaInputStream.get(this.getClass().getResource(path));
    parser.parse(stream,handler,metadata,context);
  }
  finally {
    IOUtils.closeQuietly(stream);
  }
  String xml=handler.toString();
  assertContains("<div class=\"embedded\" id=\"Unit10.doc\" />",xml);
  assertContains("<img src=\"embedded:image1.tif\" alt=\"image1.tif\" />",xml);
  xml=getXML("testPDFFileEmbInAnnotation.pdf").xml;
  assertContains("<div class=\"embedded\" id=\"Excel.xlsx\" />",xml);
}

</code></pre>

<pre class="type-4 type-5 type-2 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmbeddedFilesInChildren() throws Exception {
  String xml=getXML("/testPDF_childAttachments.pdf").xml;
  assertTrue(xml.contains("regressiveness"));
  RecursiveParserWrapper p=new RecursiveParserWrapper(new AutoDetectParser(),new BasicContentHandlerFactory(BasicContentHandlerFactory.HANDLER_TYPE.IGNORE,-1));
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  config.setExtractInlineImages(true);
  config.setExtractUniqueInlineImagesOnly(false);
  context.set(org.apache.tika.parser.pdf.PDFParserConfig.class,config);
  context.set(org.apache.tika.parser.Parser.class,p);
  try (TikaInputStream tis=TikaInputStream.get(getResourceAsStream("/test-documents/testPDF_childAttachments.pdf"))){
    p.parse(tis,new BodyContentHandler(-1),new Metadata(),context);
  }
   List<Metadata> metadatas=p.getMetadata();
  assertEquals(5,metadatas.size());
  assertNull(metadatas.get(0).get(Metadata.RESOURCE_NAME_KEY));
  assertEquals("image0.jpg",metadatas.get(1).get(Metadata.RESOURCE_NAME_KEY));
  assertEquals("Press Quality(1).joboptions",metadatas.get(3).get(Metadata.RESOURCE_NAME_KEY));
  assertEquals("Unit10.doc",metadatas.get(4).get(Metadata.RESOURCE_NAME_KEY));
  assertEquals(MediaType.image("jpeg").toString(),metadatas.get(1).get(Metadata.CONTENT_TYPE));
  assertEquals(MediaType.image("tiff").toString(),metadatas.get(2).get(Metadata.CONTENT_TYPE));
  assertEquals("text/plain; charset=ISO-8859-1",metadatas.get(3).get(Metadata.CONTENT_TYPE));
  assertEquals(TYPE_DOC.toString(),metadatas.get(4).get(Metadata.CONTENT_TYPE));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test to ensure that Links are extracted from the text
 * <p/>
 * Note - the PDF contains the text "This is a hyperlink" which
 * a hyperlink annotation, linking to the tika site, on it. This
 * test will need updating when we're able to apply the annotation
 * to the text itself, rather than following on afterwards as now
 */
@Test public void testLinks() throws Exception {
  final XMLResult result=getXML("testPDFVarious.pdf");
  assertContains("<div class=\"annotation\"><a href=\"http://tika.apache.org/\" /></div>",result.xml);
}

</code></pre>

<pre class="type-9 type-14 type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVersions() throws Exception {
  Map<String,String> dcFormat=new HashMap<String,String>();
  dcFormat.put("4.x","application/pdf; version=1.3");
  dcFormat.put("5.x","application/pdf; version=1.4");
  dcFormat.put("6.x","application/pdf; version=1.5");
  dcFormat.put("7.x","application/pdf; version=1.6");
  dcFormat.put("8.x","application/pdf; version=1.7");
  dcFormat.put("9.x","application/pdf; version=1.7");
  dcFormat.put("10.x","application/pdf; version=1.7");
  dcFormat.put("11.x.PDFA-1b","application/pdf; version=1.7");
  Map<String,String> pdfVersions=new HashMap<String,String>();
  pdfVersions.put("4.x","1.3");
  pdfVersions.put("5.x","1.4");
  pdfVersions.put("6.x","1.5");
  pdfVersions.put("7.x","1.6");
  pdfVersions.put("8.x","1.7");
  pdfVersions.put("9.x","1.7");
  pdfVersions.put("10.x","1.7");
  pdfVersions.put("11.x.PDFA-1b","1.7");
  Map<String,String> pdfExtensionVersions=new HashMap<String,String>();
  pdfExtensionVersions.put("9.x","1.7 Adobe Extension Level 3");
  pdfExtensionVersions.put("10.x","1.7 Adobe Extension Level 8");
  pdfExtensionVersions.put("11.x.PDFA-1b","1.7 Adobe Extension Level 8");
  Parser p=new AutoDetectParser();
  for (  Map.Entry<String,String> e : dcFormat.entrySet()) {
    String fName="testPDF_Version." + e.getKey() + ".pdf";
    InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/" + fName);
    Metadata m=new Metadata();
    ContentHandler h=new BodyContentHandler();
    ParseContext c=new ParseContext();
    p.parse(is,h,m,c);
    is.close();
    boolean foundDC=false;
    String[] vals=m.getValues("dc:format");
    for (    String v : vals) {
      if (v.equals(e.getValue())) {
        foundDC=true;
      }
    }
    assertTrue("dc:format ::" + e.getValue(),foundDC);
    String extensionVersionTruth=pdfExtensionVersions.get(e.getKey());
    if (extensionVersionTruth != null) {
      assertEquals("pdf:PDFExtensionVersion :: " + extensionVersionTruth,extensionVersionTruth,m.get("pdf:PDFExtensionVersion"));
    }
    assertEquals("pdf:PDFVersion",pdfVersions.get(e.getKey()),m.get("pdf:PDFVersion"));
  }
  String fName="testPDF_Version.11.x.PDFA-1b.pdf";
  InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/" + fName);
  Metadata m=new Metadata();
  ParseContext c=new ParseContext();
  ContentHandler h=new BodyContentHandler();
  p.parse(is,h,m,c);
  is.close();
  Set<String> versions=new HashSet<String>();
  for (  String fmt : m.getValues("dc:format")) {
    versions.add(fmt);
  }
  for (  String hit : new String[]{"application/pdf; version=1.7","application/pdf; version=\"A-1b\"","application/pdf; version=\"1.7 Adobe Extension Level 8\""}) {
    assertTrue(hit,versions.contains(hit));
  }
  assertEquals("pdfaid:conformance",m.get("pdfaid:conformance"),"B");
  assertEquals("pdfaid:part",m.get("pdfaid:part"),"1");
}

</code></pre>

<pre class="type-9 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmbeddedFileNameExtraction() throws Exception {
  InputStream is=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF_multiFormatEmbFiles.pdf");
  RecursiveParserWrapper p=new RecursiveParserWrapper(new AutoDetectParser(),new BasicContentHandlerFactory(BasicContentHandlerFactory.HANDLER_TYPE.IGNORE,-1));
  Metadata m=new Metadata();
  ParseContext c=new ParseContext();
  c.set(org.apache.tika.parser.Parser.class,p);
  ContentHandler h=new BodyContentHandler();
  p.parse(is,h,m,c);
  is.close();
  List<Metadata> metadatas=p.getMetadata();
  assertEquals("metadata size",5,metadatas.size());
  Metadata firstAttachment=metadatas.get(1);
  assertEquals("attachment file name","Test.txt",firstAttachment.get(Metadata.RESOURCE_NAME_KEY));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInlineConfig() throws Exception {
  Parser defaultParser=new AutoDetectParser();
  RecursiveParserWrapper p=new RecursiveParserWrapper(defaultParser,new BasicContentHandlerFactory(BasicContentHandlerFactory.HANDLER_TYPE.IGNORE,-1));
  ParseContext context=new ParseContext();
  context.set(org.apache.tika.parser.Parser.class,p);
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler(-1);
  String path="/test-documents/testPDF_childAttachments.pdf";
  InputStream stream=TikaInputStream.get(this.getClass().getResource(path));
  p.parse(stream,handler,metadata,context);
  List<Metadata> metadatas=p.getMetadata();
  int inline=0;
  int attach=0;
  for (  Metadata m : metadatas) {
    String v=m.get(TikaCoreProperties.EMBEDDED_RESOURCE_TYPE);
    if (v != null) {
      if (v.equals(TikaCoreProperties.EmbeddedResourceType.INLINE.toString())) {
        inline++;
      }
 else       if (v.equals(TikaCoreProperties.EmbeddedResourceType.ATTACHMENT.toString())) {
        attach++;
      }
    }
  }
  assertEquals(0,inline);
  assertEquals(2,attach);
  stream.close();
  p.reset();
  stream=TikaInputStream.get(this.getClass().getResource(path));
  PDFParserConfig config=new PDFParserConfig();
  config.setExtractInlineImages(true);
  config.setExtractUniqueInlineImagesOnly(false);
  context.set(org.apache.tika.parser.pdf.PDFParserConfig.class,config);
  inline=0;
  attach=0;
  handler=new BodyContentHandler(-1);
  metadata=new Metadata();
  p.parse(stream,handler,metadata,context);
  metadatas=p.getMetadata();
  for (  Metadata m : metadatas) {
    String v=m.get(TikaCoreProperties.EMBEDDED_RESOURCE_TYPE);
    if (v != null) {
      if (v.equals(TikaCoreProperties.EmbeddedResourceType.INLINE.toString())) {
        inline++;
      }
 else       if (v.equals(TikaCoreProperties.EmbeddedResourceType.ATTACHMENT.toString())) {
        attach++;
      }
    }
  }
  assertEquals(2,inline);
  assertEquals(2,attach);
}

</code></pre>

<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testBookmarks() throws Exception {
  String xml=getXML("testPDF_bookmarks.pdf").xml;
  int i=xml.indexOf("Denmark bookmark is here");
  int j=xml.indexOf("</body>");
  assertTrue(i != -1);
  assertTrue(j != -1);
  assertTrue(i < j);
}

</code></pre>

<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void tearDown(){
  Logger.getLogger("org.apache.pdfbox").setLevel(PDFBOX_LOG_LEVEL);
}

</code></pre>

<pre class="type-9 type-14 type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tests for equality between traditional sequential parser
 * and newer nonsequential parser.
 * <p/>
 * TODO: more testing
 */
@Test public void testSequentialParser() throws Exception {
  Parser sequentialParser=new AutoDetectParser();
  Parser nonSequentialParser=new AutoDetectParser();
  ParseContext seqContext=new ParseContext();
  PDFParserConfig seqConfig=new PDFParserConfig();
  seqConfig.setUseNonSequentialParser(false);
  seqContext.set(PDFParserConfig.class,seqConfig);
  ParseContext nonSeqContext=new ParseContext();
  PDFParserConfig nonSeqConfig=new PDFParserConfig();
  nonSeqConfig.setUseNonSequentialParser(true);
  nonSeqContext.set(PDFParserConfig.class,nonSeqConfig);
  File testDocs=new File(this.getClass().getResource("/test-documents").toURI());
  int pdfs=0;
  Set<String> knownMetadataDiffs=new HashSet<String>();
  Set<String> knownContentDiffs=new HashSet<String>();
  for (  File f : testDocs.listFiles()) {
    if (!f.getName().toLowerCase(Locale.ROOT).endsWith(".pdf")) {
      continue;
    }
    String sequentialContent=null;
    Metadata sequentialMetadata=new Metadata();
    try {
      sequentialContent=getText(new FileInputStream(f),sequentialParser,seqContext,sequentialMetadata);
    }
 catch (    EncryptedDocumentException e) {
      continue;
    }
catch (    Exception e) {
      throw new TikaException("Sequential Parser failed on test file " + f,e);
    }
    pdfs++;
    String nonSequentialContent=null;
    Metadata nonSequentialMetadata=new Metadata();
    try {
      nonSequentialContent=getText(new FileInputStream(f),nonSequentialParser,nonSeqContext,nonSequentialMetadata);
    }
 catch (    Exception e) {
      throw new TikaException("Non-Sequential Parser failed on test file " + f,e);
    }
    if (knownContentDiffs.contains(f.getName())) {
      assertFalse(f.getName(),sequentialContent.equals(nonSequentialContent));
    }
 else {
      assertEquals(f.getName(),sequentialContent,nonSequentialContent);
    }
    if (knownMetadataDiffs.contains(f.getName())) {
      assertFalse(f.getName(),sequentialMetadata.equals(nonSequentialMetadata));
    }
 else {
      assertEquals(f.getName(),sequentialMetadata,nonSequentialMetadata);
    }
  }
  boolean ge15=(pdfs >= 15);
  assertTrue("Number of pdf files tested >= 15 in non-sequential parser test",ge15);
}

</code></pre>

<pre class="type-9 type-4 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPdfParsing() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF.pdf");
  String content=getText(stream,parser,metadata);
  assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("Bertrand Delacr\u00e9taz",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Bertrand Delacr\u00e9taz",metadata.get(Metadata.AUTHOR));
  assertEquals("Firefox",metadata.get(TikaCoreProperties.CREATOR_TOOL));
  assertEquals("Apache Tika - Apache Tika",metadata.get(TikaCoreProperties.TITLE));
  assertContains("Apache Tika",content);
  assertContains("Tika - Content Analysis Toolkit",content);
  assertContains("incubator",content);
  assertContains("Apache Software Foundation",content);
  assertTrue("should have word boundary after headline",!content.contains("ToolkitApache"));
  assertTrue("should have word boundary between paragraphs",!content.contains("libraries.Apache"));
}

</code></pre>

<pre class="type-9 type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAnnotations() throws Exception {
  Parser parser=new AutoDetectParser();
  InputStream stream=getResourceAsStream("/test-documents/testAnnotations.pdf");
  String content=getText(stream,parser);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertContains("Here is some text",content);
  assertContains("Here is a comment",content);
  PDFParser pdfParser=new PDFParser();
  pdfParser.getPDFParserConfig().setExtractAnnotationText(false);
  stream=getResourceAsStream("/test-documents/testAnnotations.pdf");
  content=getText(stream,pdfParser);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertContains("Here is some text",content);
  assertEquals(-1,content.indexOf("Here is a comment"));
  ParseContext context=new ParseContext();
  PDFParserConfig config=new PDFParserConfig();
  config.setExtractAnnotationText(false);
  context.set(PDFParserConfig.class,config);
  stream=getResourceAsStream("/test-documents/testAnnotations.pdf");
  content=getText(stream,parser,context);
  content=content.replaceAll("[\\s\u00a0]+"," ");
  assertContains("Here is some text",content);
  assertEquals(-1,content.indexOf("Here is a comment"));
  String xml=getXML("testAnnotations.pdf").xml;
  assertEquals(substringCount("<p>",xml),substringCount("</p>",xml));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInlineSelector() throws Exception {
  PDFParserConfig config=new PDFParserConfig();
  config.setExtractInlineImages(true);
  config.setExtractUniqueInlineImagesOnly(false);
  Parser defaultParser=new AutoDetectParser();
  RecursiveParserWrapper p=new RecursiveParserWrapper(defaultParser,new BasicContentHandlerFactory(BasicContentHandlerFactory.HANDLER_TYPE.IGNORE,-1));
  ParseContext context=new ParseContext();
  context.set(org.apache.tika.parser.pdf.PDFParserConfig.class,config);
  context.set(org.apache.tika.parser.Parser.class,p);
  Metadata metadata=new Metadata();
  ContentHandler handler=new BodyContentHandler(-1);
  String path="/test-documents/testPDF_childAttachments.pdf";
  InputStream stream=TikaInputStream.get(this.getClass().getResource(path));
  p.parse(stream,handler,metadata,context);
  List<Metadata> metadatas=p.getMetadata();
  int inline=0;
  int attach=0;
  for (  Metadata m : metadatas) {
    String v=m.get(TikaCoreProperties.EMBEDDED_RESOURCE_TYPE);
    if (v != null) {
      if (v.equals(TikaCoreProperties.EmbeddedResourceType.INLINE.toString())) {
        inline++;
      }
 else       if (v.equals(TikaCoreProperties.EmbeddedResourceType.ATTACHMENT.toString())) {
        attach++;
      }
    }
  }
  assertEquals(2,inline);
  assertEquals(2,attach);
  stream.close();
  p.reset();
  stream=TikaInputStream.get(this.getClass().getResource(path));
  context.set(org.apache.tika.extractor.DocumentSelector.class,new AvoidInlineSelector());
  inline=0;
  attach=0;
  handler=new BodyContentHandler(-1);
  metadata=new Metadata();
  p.parse(stream,handler,metadata,context);
  metadatas=p.getMetadata();
  for (  Metadata m : metadatas) {
    String v=m.get(TikaCoreProperties.EMBEDDED_RESOURCE_TYPE);
    if (v != null) {
      if (v.equals(TikaCoreProperties.EmbeddedResourceType.INLINE.toString())) {
        inline++;
      }
 else       if (v.equals(TikaCoreProperties.EmbeddedResourceType.ATTACHMENT.toString())) {
        attach++;
      }
    }
  }
  assertEquals(0,inline);
  assertEquals(2,attach);
}

</code></pre>

<pre class="type-4 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCustomMetadata() throws Exception {
  Parser parser=new AutoDetectParser();
  Metadata metadata=new Metadata();
  InputStream stream=PDFParserTest.class.getResourceAsStream("/test-documents/testPDF-custommetadata.pdf");
  String content=getText(stream,parser,metadata);
  assertEquals("application/pdf",metadata.get(Metadata.CONTENT_TYPE));
  assertEquals("Document author",metadata.get(TikaCoreProperties.CREATOR));
  assertEquals("Document author",metadata.get(Metadata.AUTHOR));
  assertEquals("Document title",metadata.get(TikaCoreProperties.TITLE));
  assertEquals("Custom Value",metadata.get("Custom Property"));
  assertEquals("Array Entry 1",metadata.get("Custom Array"));
  assertEquals(2,metadata.getValues("Custom Array").length);
  assertEquals("Array Entry 1",metadata.getValues("Custom Array")[0]);
  assertEquals("Array Entry 2",metadata.getValues("Custom Array")[1]);
  assertContains("Hello World!",content);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
