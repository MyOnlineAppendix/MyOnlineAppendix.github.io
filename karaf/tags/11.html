<h3><span class=" glyphicon glyphicon-tag"/>&nbspIdentityVerifier</h3><kbd>Verifies whether two objects/variables are the same</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.FeaturesServiceImplTest </h4><pre class="type-4 type-11 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFeatureStripVersion() throws Exception {
  final FeaturesServiceImpl impl=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,this.resolver,null,"",null,null,null,null,null,0,0,0,null){
    protected Map<String,Map<String,Feature>> getFeatures() throws Exception {
      return features(feature("transaction","1.0.0"));
    }
  }
;
  Feature[] features=impl.getFeatures("transaction","  1.0.0  ");
  assertEquals(1,features.length);
  Feature feature=features[0];
  assertNotNull(feature);
  assertSame("transaction",feature.getName());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-11 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFeature() throws Exception {
  Feature transactionFeature=feature("transaction","1.0.0");
  final Map<String,Map<String,Feature>> features=features(transactionFeature);
  final FeaturesServiceImpl impl=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,this.resolver,null,"",null,null,null,null,null,0,0,0,null){
    protected Map<String,Map<String,Feature>> getFeatures() throws Exception {
      return features;
    }
  }
;
  assertNotNull(impl.getFeatures("transaction",org.apache.karaf.features.internal.model.Feature.DEFAULT_VERSION));
  assertSame(transactionFeature,impl.getFeatures("transaction",org.apache.karaf.features.internal.model.Feature.DEFAULT_VERSION)[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.service.guard.impl.GuardProxyCatalogTest </h4><pre class="type-6 type-4 type-11 type-5 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"unchecked","rawtypes"}) public void testServiceFactoryBehaviour() throws Exception {
  final Map<ServiceReference,Object> serviceMap=new HashMap<ServiceReference,Object>();
  TestServiceAPI testService=new TestService();
  BundleContext bc=mockConfigAdminBundleContext();
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  long serviceID=117L;
  final Hashtable<String,Object> serviceProps=new Hashtable<String,Object>();
  serviceProps.put(Constants.OBJECTCLASS,new String[]{TestServiceAPI.class.getName()});
  serviceProps.put(Constants.SERVICE_ID,serviceID);
  serviceProps.put("bar",42L);
  BundleContext providerBC=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(providerBC.registerService(EasyMock.isA(String[].class),EasyMock.anyObject(),EasyMock.isA(Dictionary.class))).andAnswer(new IAnswer(){
    @Override public ServiceRegistration answer() throws Throwable {
      Dictionary<String,Object> props=(Dictionary<String,Object>)EasyMock.getCurrentArguments()[2];
      ServiceRegistration reg=EasyMock.createMock(ServiceRegistration.class);
      ServiceReference sr=mockServiceReference(props);
      EasyMock.expect(reg.getReference()).andReturn(sr).anyTimes();
      EasyMock.replay(reg);
      serviceMap.put(sr,EasyMock.getCurrentArguments()[1]);
      return reg;
    }
  }
).once();
  EasyMock.expect(providerBC.getService(EasyMock.isA(ServiceReference.class))).andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      return serviceMap.get(EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  EasyMock.replay(providerBC);
  BundleWiring bw=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(bw.getClassLoader()).andReturn(getClass().getClassLoader()).anyTimes();
  EasyMock.replay(bw);
  Bundle providerBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(providerBundle.getBundleContext()).andReturn(providerBC).anyTimes();
  EasyMock.expect(providerBundle.adapt(BundleWiring.class)).andReturn(bw).anyTimes();
  EasyMock.replay(providerBundle);
  ServiceReference sr=mockServiceReference(providerBundle,serviceProps);
  BundleContext clientBC=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(clientBC.getService(sr)).andReturn(testService).anyTimes();
  EasyMock.replay(clientBC);
  Bundle clientBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(clientBundle.getBundleContext()).andReturn(clientBC).anyTimes();
  EasyMock.replay(clientBundle);
  gpc.proxyIfNotAlreadyProxied(sr);
  GuardProxyCatalog.ServiceRegistrationHolder holder=gpc.proxyMap.get(serviceID);
  GuardProxyCatalog.CreateProxyRunnable runnable=gpc.createProxyQueue.take();
  assertEquals(117L,runnable.getOriginalServiceID());
  ProxyManager pm=getProxyManager();
  runnable.run(pm);
  ServiceReference<?> proxySR=holder.registration.getReference();
  EasyMock.verify(providerBC);
  ServiceFactory proxyServiceSF=(ServiceFactory)serviceMap.get(proxySR);
  TestServiceAPI proxyService=(TestServiceAPI)proxyServiceSF.getService(clientBundle,null);
  assertNotSame("The proxy should not be the same object as the original service",testService,proxyService);
  assertEquals("Doing it",proxyService.doit());
  EasyMock.reset(clientBC);
  EasyMock.expect(clientBC.ungetService(sr)).andReturn(true).once();
  EasyMock.replay(clientBC);
  proxyServiceSF.ungetService(clientBundle,null,proxyService);
  EasyMock.verify(clientBC);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.impl.jline.ConsoleImplTest </h4><pre class="type-3 type-4 type-11 type-5 type-7 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConsoleImpl() throws Exception {
  ServiceReference<?> cmRef=EasyMock.createMock(ServiceReference.class);
  EasyMock.expect(cmRef.getProperty(CommandProcessor.COMMAND_SCOPE)).andReturn("myscope").anyTimes();
  EasyMock.expect(cmRef.getProperty(CommandProcessor.COMMAND_FUNCTION)).andReturn("myfunction").anyTimes();
  EasyMock.replay(cmRef);
  ServiceReference<?>[] cmRefs=new ServiceReference[]{cmRef};
  BundleContext bc=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(bc.getServiceReference((Class<?>)EasyMock.anyObject())).andReturn(null).anyTimes();
  EasyMock.expect(bc.getService((ServiceReference<?>)EasyMock.anyObject())).andReturn(null).anyTimes();
  bc.addServiceListener(EasyMock.isA(ServiceListener.class),EasyMock.isA(String.class));
  EasyMock.expectLastCall().anyTimes();
  EasyMock.expect(bc.getServiceReferences((String)null,"(&(osgi.command.scope=*)(osgi.command.function=*)" + "(|(org.apache.karaf.service.guard.roles=myrole)(!(org.apache.karaf.service.guard.roles=*))))")).andReturn(cmRefs).anyTimes();
  EasyMock.expect(bc.getServiceReferences(Converter.class.getName(),null)).andReturn(null).anyTimes();
  EasyMock.expect(bc.getServiceReferences(CommandSessionListener.class.getName(),null)).andReturn(null).anyTimes();
  EasyMock.expect(bc.createFilter(EasyMock.isA(String.class))).andAnswer(new IAnswer<Filter>(){
    @Override public Filter answer() throws Throwable {
      return FrameworkUtil.createFilter((String)EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  EasyMock.replay(bc);
  final ConsoleImpl console=new ConsoleImpl(null,new ThreadIOImpl(),System.in,System.out,System.err,null,"UTF-8",null,bc,true);
  assertTrue(console.session instanceof DelegateSession);
  console.session.put("foo","bar");
  final DelegateSession ds=(DelegateSession)console.session;
  assertNull("Precondition",ds.delegate);
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("myrole"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      SecuredCommandProcessorImpl secCP=console.createSecuredCommandProcessor();
      assertNotNull(ds.delegate);
      assertEquals("Attributes set before the delegate was set should have been transferred","bar",ds.get("foo"));
      assertEquals("Attributes set before the delegate was set should have been transferred","bar",ds.delegate.get("foo"));
      assertSame(System.out,ds.delegate.getConsole());
      assertSame(System.out,ds.getConsole());
      assertTrue(secCP.getCommands().contains("myscope:myfunction"));
      return null;
    }
  }
);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
