<h3><span class=" glyphicon glyphicon-tag"/>&nbspEqualityVerifier</h3><kbd>Verifies whether objects/variable are equal to an expected value </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.karaf.bundle.command.bundletree.TreeTest </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writeTreeWithOneChild() throws IOException {
  Tree<String> tree=new Tree<String>("root");
  tree.addChild("child");
  BufferedReader reader=read(tree);
  assertEquals("root",reader.readLine());
  assertEquals("+- child",reader.readLine());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writeTreeWithChildAndGrandChild() throws IOException {
  Tree<String> tree=new Tree<String>("root");
  Node<String> node=tree.addChild("child");
  node.addChild("grandchild");
  BufferedReader reader=read(tree);
  assertEquals("root",reader.readLine());
  assertEquals("+- child",reader.readLine());
  assertEquals("   +- grandchild",reader.readLine());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void flattenTree() throws IOException {
  Tree<String> tree=new Tree<String>("root");
  Node<String> child1=tree.addChild("child1");
  child1.addChild("grandchild");
  Node child2=tree.addChild("child2");
  child2.addChild("grandchild");
  Set<String> elements=tree.flatten();
  assertNotNull(elements);
  assertEquals(4,elements.size());
  assertTrue(elements.contains("root"));
  assertTrue(elements.contains("child1"));
  assertTrue(elements.contains("child2"));
  assertTrue(elements.contains("grandchild"));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writeTreeWithTwoChildrenAndOneGrandchild() throws IOException {
  Tree<String> tree=new Tree<String>("root");
  Node<String> child=tree.addChild("child1");
  child.addChild("grandchild");
  tree.addChild("child2");
  BufferedReader reader=read(tree);
  assertEquals("root",reader.readLine());
  assertEquals("+- child1",reader.readLine());
  assertEquals("|  +- grandchild",reader.readLine());
  assertEquals("+- child2",reader.readLine());
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writeTreeWithOneChildAndNodeConverter() throws IOException {
  Tree<String> tree=new Tree<String>("root");
  tree.addChild("child");
  StringWriter writer=new StringWriter();
  tree.write(new PrintWriter(writer),new Tree.Converter<String>(){
    public String toString(    Node<String> node){
      return "my " + node.getValue();
    }
  }
);
  BufferedReader reader=new BufferedReader(new StringReader(writer.getBuffer().toString()));
  assertEquals("my root",reader.readLine());
  assertEquals("+- my child",reader.readLine());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.bundle.core.internal.MavenConfigServiceTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocalRepoFromSettings() throws Exception {
  Hashtable<String,Object> config=new Hashtable<String,Object>();
  config.put("org.ops4j.pax.url.mvn.settings",getClass().getResource("/settings.xml").getPath());
  assertEquals("foo/bar",MavenConfigService.getLocalRepoFromConfig(config));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocalRepoExplicit() throws Exception {
  Hashtable<String,Object> config=new Hashtable<String,Object>();
  config.put("org.ops4j.pax.url.mvn.localRepository","foo/bar");
  assertEquals("foo/bar",MavenConfigService.getLocalRepoFromConfig(config));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocalRepoEmpty() throws Exception {
  Hashtable<String,Object> config=new Hashtable<String,Object>();
  assertEquals(null,MavenConfigService.getLocalRepoFromConfig(config));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocalRepoFromSettingsNs() throws Exception {
  Hashtable<String,Object> config=new Hashtable<String,Object>();
  config.put("org.ops4j.pax.url.mvn.settings",getClass().getResource("/settings2.xml").getPath());
  assertEquals("foo/bar",MavenConfigService.getLocalRepoFromConfig(config));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.FeaturesServiceTest </h4><pre class="type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test checks feature service behavior with old, non namespaced descriptor.
 */
@Test public void testLoadOldFeatureFile() throws Exception {
  URI uri=createTempRepo("<features name='test' xmlns='http://karaf.apache.org/xmlns/features/v1.0.0'>" + "  <feature name='f1'><bundle>file:bundle1</bundle><bundle>file:bundle2</bundle></feature>" + "</features>");
  FeaturesServiceImpl svc=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,resolver,null,null,null,null,null,null,null,0,0,0,null);
  svc.addRepository(uri);
  Feature[] features=svc.getFeatures("f1");
  Assert.assertEquals(1,features.length);
  Feature feature=features[0];
  Assert.assertNotNull("No feature named fi found",feature);
  List<BundleInfo> bundles=feature.getBundles();
  Assert.assertEquals(2,bundles.size());
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetFeaturesShouldHandleDifferentVersionPatterns() throws Exception {
  URI uri=createTempRepo("<features name='test' xmlns='http://karaf.apache.org/xmlns/features/v1.0.0'>" + "  <feature name='f1' version='0.1'><feature version='[0.1,0.3)'>f2</feature></feature>" + "  <feature name='f2' version='0.1'><bundle>bundle1</bundle></feature>"+ "  <feature name='f2' version='0.2'><bundle>bundle2</bundle></feature>"+ "</features>");
  FeaturesServiceImpl svc=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,resolver,null,null,null,null,null,null,null,0,0,0,null);
  svc.addRepository(uri);
  assertEquals(feature("f2","0.2"),svc.getFeatures("f2","[0.1,0.3)")[0]);
  assertEquals(feature("f2","0.2"),svc.getFeatures("f2","0.0.0")[0]);
  assertEquals(feature("f2","0.2"),svc.getFeatures("f2","0.2")[0]);
  assertEquals(0,svc.getFeatures("f2","0.3").length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.BlacklistTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBlacklistFeatureWithVersion(){
  URL url=getClass().getResource("f02.xml");
  Features features=JaxbUtil.unmarshal(url.toExternalForm(),true);
  List<String> blacklist=new ArrayList<>();
  blacklist.add("spring;range=2.5.6.SEC02");
  Blacklist.blacklist(features,blacklist);
  for (  Feature feature : features.getFeature()) {
    assertNotEquals("spring/2.5.6.SEC02",feature.getId());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBlacklistFeatureWithRange(){
  URL url=getClass().getResource("f02.xml");
  Features features=JaxbUtil.unmarshal(url.toExternalForm(),true);
  List<String> blacklist=new ArrayList<>();
  blacklist.add("spring;range=\"[2,3)\"");
  Blacklist.blacklist(features,blacklist);
  for (  Feature feature : features.getFeature()) {
    assertNotEquals("spring/2.5.6.SEC02",feature.getId());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBlacklistBundle(){
  URL url=getClass().getResource("f02.xml");
  Features features=JaxbUtil.unmarshal(url.toExternalForm(),true);
  List<String> blacklist=new ArrayList<>();
  blacklist.add("mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jasypt/1.7_1");
  Blacklist.blacklist(features,blacklist);
  for (  Feature feature : features.getFeature()) {
    for (    Bundle bundle : feature.getBundle()) {
      assertNotEquals("mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jasypt/1.7_1",bundle.getLocation());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.BootFeaturesInstallerTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @SuppressWarnings("unchecked") public void testParser(){
  BootFeaturesInstaller installer=new BootFeaturesInstaller(null,null,"","",false);
  Assert.assertEquals(asList(setOf("test1","test2"),setOf("test3")),installer.parseBootFeatures(" ( test1 , test2 ) , test3 "));
  Assert.assertEquals(asList(setOf("test1","test2","test3")),installer.parseBootFeatures(" test1 , test2, test3"));
  Assert.assertEquals(asList(setOf("test1"),setOf("test2"),setOf("test3")),installer.parseBootFeatures("(test1), (test2), test3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.FeaturesServiceImplTest </h4><pre class="type-4 type-11 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFeatureStripVersion() throws Exception {
  final FeaturesServiceImpl impl=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,this.resolver,null,"",null,null,null,null,null,0,0,0,null){
    protected Map<String,Map<String,Feature>> getFeatures() throws Exception {
      return features(feature("transaction","1.0.0"));
    }
  }
;
  Feature[] features=impl.getFeatures("transaction","  1.0.0  ");
  assertEquals(1,features.length);
  Feature feature=features[0];
  assertNotNull(feature);
  assertSame("transaction",feature.getName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFeatureHighestAvailable() throws Exception {
  final Map<String,Map<String,Feature>> features=features(feature("transaction","1.0.0"),feature("transaction","2.0.0"));
  final FeaturesServiceImpl impl=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,this.resolver,null,"",null,null,null,null,null,0,0,0,null){
    protected Map<String,Map<String,Feature>> getFeatures() throws Exception {
      return features;
    }
  }
;
  assertNotNull(impl.getFeatures("transaction",org.apache.karaf.features.internal.model.Feature.DEFAULT_VERSION));
  assertEquals("2.0.0",impl.getFeatures("transaction",org.apache.karaf.features.internal.model.Feature.DEFAULT_VERSION)[0].getVersion());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetFeatureNotAvailable() throws Exception {
  final FeaturesServiceImpl impl=new FeaturesServiceImpl(null,null,new Storage(),null,null,null,this.resolver,null,"",null,null,null,null,null,0,0,0,null){
    protected Map<String,Map<String,Feature>> getFeatures() throws Exception {
      return features(feature("transaction","1.0.0"));
    }
  }
;
  assertEquals(0,impl.getFeatures("activemq",org.apache.karaf.features.internal.model.Feature.DEFAULT_VERSION).length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.FeaturesValidationTest </h4><pre class="type-6 type-3 type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNs13Unmarshall() throws Exception {
  URL url=getClass().getResource("f07.xml");
  Features features=JaxbUtil.unmarshal(url.toExternalForm(),true);
  assertNotNull(features);
  assertEquals("2.5.6.SEC02",features.getFeature().get(0).getVersion());
  assertTrue(features.getFeature().get(1).isHidden());
  assertNotNull(features.getFeature().get(1).getLibraries());
  assertEquals(1,features.getFeature().get(0).getLibraries().size());
  assertEquals("my-library",features.getFeature().get(0).getLibraries().get(0).getLocation());
  assertEquals(Library.TYPE_ENDORSED,features.getFeature().get(0).getLibraries().get(0).getType());
  assertFalse(features.getFeature().get(0).getLibraries().get(0).isExport());
  assertTrue(features.getFeature().get(0).getLibraries().get(0).isDelegate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.OverridesTest </h4><pre class="type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadOverrides(){
  Set<String> overrides=Overrides.loadOverrides(getClass().getResource("overrides.properties").toExternalForm());
  assertEquals(2,overrides.size());
  Clause karafAdminCommand=null;
  Clause karafAdminCore=null;
  for (  Clause clause : Parser.parseClauses(overrides.toArray(new String[overrides.size()]))) {
    if (clause.getName().equals("mvn:org.apache.karaf.admin/org.apache.karaf.admin.command/2.3.0.redhat-61033X")) {
      karafAdminCommand=clause;
    }
    if (clause.getName().equals("mvn:org.apache.karaf.admin/org.apache.karaf.admin.core/2.3.0.redhat-61033X")) {
      karafAdminCore=clause;
    }
  }
  assertNotNull("Missing admin.command bundle override",karafAdminCommand);
  assertNotNull("Missing admin.core bundle override",karafAdminCore);
  assertNotNull("Missing range on admin.core override",karafAdminCore.getAttribute(Overrides.OVERRIDE_RANGE));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNotMatching() throws IOException {
  Map<String,Resource> map=asResourceMap(b100,b110);
  assertEquals(b100,map.get(getUri(b100)));
  Overrides.override(map,Arrays.asList(getUri(b110)));
  assertEquals(b100,map.get(getUri(b100)));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDifferentVendors() throws IOException {
  Map<String,Resource> map=asResourceMap(c100,c101,c110);
  assertEquals(c100,map.get(getUri(c100)));
  Overrides.override(map,Arrays.asList(getUri(c101),getUri(c110)));
  assertEquals(c101,map.get(getUri(c100)));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMatching102() throws IOException {
  Map<String,Resource> map=asResourceMap(b100,b101,b102,b110);
  assertEquals(b100,map.get(getUri(b100)));
  Overrides.override(map,Arrays.asList(getUri(b101),getUri(b102),getUri(b110)));
  assertEquals(b102,map.get(getUri(b100)));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMatching101() throws IOException {
  Map<String,Resource> map=asResourceMap(b100,b101,b110);
  assertEquals(b100,map.get(getUri(b100)));
  Overrides.override(map,Arrays.asList(getUri(b101),getUri(b110)));
  assertEquals(b101,map.get(getUri(b100)));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMatchingRange() throws IOException {
  Map<String,Resource> map=asResourceMap(b100,b101,b110);
  assertEquals(b100,map.get(getUri(b100)));
  Overrides.override(map,Arrays.asList(getUri(b101),getUri(b110) + ";range=\"[1.0, 2.0)\""));
  assertEquals(b110,map.get(getUri(b100)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.features.internal.service.StateStorageTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStoreLoad() throws Exception {
  State oldState=new State();
  oldState.bootDone.set(true);
  oldState.bundleChecksums.put(4l,32794l);
  oldState.requirements.put("bar",Collections.singleton("f1"));
  oldState.managedBundles.put("reg",Collections.singleton(32l));
  oldState.managedBundles.put("reg2",new HashSet<Long>(Arrays.asList(24l,43l)));
  oldState.repositories.add("repo");
  TestStorage storage=new TestStorage();
  storage.save(oldState);
  System.out.println(storage.baos.toString());
  State newState=new State();
  storage.load(newState);
  assertEquals(oldState.bootDone.get(),newState.bootDone.get());
  assertEquals(oldState.bundleChecksums,newState.bundleChecksums);
  assertEquals(oldState.requirements,newState.requirements);
  assertEquals(oldState.managedBundles,newState.managedBundles);
  assertEquals(oldState.repositories,newState.repositories);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.instance.core.internal.InstanceServiceImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHandleFeatures() throws Exception {
  InstanceServiceImpl as=new InstanceServiceImpl();
  File f=tempFolder.newFile(getName() + ".test");
  Properties p=new Properties();
  p.put("featuresBoot","abc,def ");
  p.put("featuresRepositories","somescheme://xyz");
  OutputStream os=new FileOutputStream(f);
  try {
    p.store(os,"Test comment");
  }
  finally {
    os.close();
  }
  InstanceSettings s=new InstanceSettings(8122,1122,44444,null,null,null,Arrays.asList("test"));
  as.addFeaturesFromSettings(f,s);
  Properties p2=new Properties();
  InputStream is=new FileInputStream(f);
  try {
    p2.load(is);
  }
  finally {
    is.close();
  }
  assertEquals(2,p2.size());
  assertEquals("abc,def,test",p2.get("featuresBoot"));
  assertEquals("somescheme://xyz",p2.get("featuresRepositories"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.ConfigManagedServiceFactoryTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createNewFactoryConfig() throws Exception {
  executeCommand("config:edit --factory myconfig2\n" + "config:property-set test1 data1\n" + "config:update",new RolePrincipal("manager"));
  Configuration config=configAdmin.listConfigurations("(service.factorypid=myconfig2)")[0];
  assertEquals("data1",config.getProperties().get("test1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.InstanceTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createDestroyViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=instance,name=root");
  int oldNum=getInstancesNum(mbeanServer,name);
  mbeanServer.invoke(name,"createInstance",new Object[]{"itest2",0,0,0,null,null,null,null},new String[]{"java.lang.String","int","int","int","java.lang.String","java.lang.String","java.lang.String","java.lang.String"});
  Assert.assertEquals(oldNum + 1,getInstancesNum(mbeanServer,name));
  mbeanServer.invoke(name,"destroyInstance",new Object[]{"itest2"},new String[]{"java.lang.String"});
  Assert.assertEquals(oldNum,getInstancesNum(mbeanServer,name));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void cloneViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=instance,name=root");
  int oldNum=getInstancesNum(mbeanServer,name);
  mbeanServer.invoke(name,"cloneInstance",new Object[]{"root","itest4",0,0,0,null,null},new String[]{"java.lang.String","java.lang.String","int","int","int","java.lang.String","java.lang.String"});
  Assert.assertEquals(oldNum + 1,getInstancesNum(mbeanServer,name));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.JMXSecurityTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJMXSecurityAsViewer() throws Exception {
  String suffix="_" + counter.incrementAndGet();
  String managerUser="managerUser" + System.currentTimeMillis() + suffix;
  String managerGroup="managerGroup" + System.currentTimeMillis() + suffix;
  String viewerUser="viewerUser" + System.currentTimeMillis() + suffix;
  System.out.println(executeCommand("jaas:realm-manage --realm karaf" + ";jaas:user-add " + managerUser + " "+ managerUser+ ";jaas:group-add "+ managerUser+ " "+ managerGroup+ ";jaas:group-role-add "+ managerGroup+ " viewer"+ ";jaas:group-role-add "+ managerGroup+ " manager"+ ";jaas:user-add "+ viewerUser+ " "+ viewerUser+ ";jaas:role-add "+ viewerUser+ " viewer"+ ";jaas:update"+ ";jaas:realm-manage --realm karaf"+ ";jaas:user-list",new RolePrincipal("admin")));
  ConfigurationAdmin configurationAdmin=getOsgiService(ConfigurationAdmin.class,30000);
  org.osgi.service.cm.Configuration configuration=configurationAdmin.getConfiguration("org.apache.karaf.management",null);
  if (configuration == null) {
  }
  JMXConnector connector=getJMXConnector(viewerUser,viewerUser);
  MBeanServerConnection connection=connector.getMBeanServerConnection();
  ObjectName systemMBean=new ObjectName("org.apache.karaf:type=system,name=root");
  assertEquals(100,connection.getAttribute(systemMBean,"StartLevel"));
  assertSetAttributeSecEx(connection,systemMBean,new Attribute("StartLevel",101));
  assertEquals("Changing the start level should have no effect for a viewer",100,connection.getAttribute(systemMBean,"StartLevel"));
  assertInvokeSecEx(connection,systemMBean,"halt");
  ObjectName memoryMBean=new ObjectName("java.lang:type=Memory");
  assertEquals(false,connection.getAttribute(memoryMBean,"Verbose"));
  assertSetAttributeSecEx(connection,memoryMBean,new Attribute("Verbose",true));
  assertEquals("Changing the verbosity should have no effect for a viewer",false,connection.getAttribute(memoryMBean,"Verbose"));
  assertInvokeSecEx(connection,memoryMBean,"gc");
  testJMXSecurityMBean(connection,false,false);
  testKarafConfigAdminMBean(connection,false,false);
  testOSGiConfigAdminMBean(connection,false,false);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJMXSecurityAsManager() throws Exception {
  String suffix="_" + counter.incrementAndGet();
  String managerUser="managerUser" + System.currentTimeMillis() + suffix;
  String managerGroup="managerGroup" + System.currentTimeMillis() + suffix;
  String viewerUser="viewerUser" + System.currentTimeMillis() + suffix;
  System.out.println(executeCommand("jaas:realm-manage --realm karaf" + ";jaas:user-add " + managerUser + " "+ managerUser+ ";jaas:group-add "+ managerUser+ " "+ managerGroup+ ";jaas:group-role-add "+ managerGroup+ " viewer"+ ";jaas:group-role-add "+ managerGroup+ " manager"+ ";jaas:user-add "+ viewerUser+ " "+ viewerUser+ ";jaas:role-add "+ viewerUser+ " viewer"+ ";jaas:update"+ ";jaas:realm-manage --realm karaf"+ ";jaas:user-list",new RolePrincipal("admin")));
  JMXConnector connector=getJMXConnector(managerUser,managerUser);
  MBeanServerConnection connection=connector.getMBeanServerConnection();
  ObjectName systemMBean=new ObjectName("org.apache.karaf:type=system,name=root");
  assertEquals(100,connection.getAttribute(systemMBean,"StartLevel"));
  assertSetAttributeSecEx(connection,systemMBean,new Attribute("StartLevel",101));
  assertEquals("Changing the start level should have no effect for a viewer",100,connection.getAttribute(systemMBean,"StartLevel"));
  assertInvokeSecEx(connection,systemMBean,"halt");
  ObjectName memoryMBean=new ObjectName("java.lang:type=Memory");
  assertEquals(false,connection.getAttribute(memoryMBean,"Verbose"));
  assertSetAttributeSecEx(connection,memoryMBean,new Attribute("Verbose",true));
  assertEquals("Changing the verbosity should have no effect for a viewer",false,connection.getAttribute(memoryMBean,"Verbose"));
  connection.invoke(memoryMBean,"gc",new Object[]{},new String[]{});
  testJMXSecurityMBean(connection,true,false);
  testKarafConfigAdminMBean(connection,true,false);
  testOSGiConfigAdminMBean(connection,true,false);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testJMXSecurityAsAdmin() throws Exception {
  JMXConnector connector=getJMXConnector();
  MBeanServerConnection connection=connector.getMBeanServerConnection();
  ObjectName systemMBean=new ObjectName("org.apache.karaf:type=system,name=root");
  assertEquals(100,connection.getAttribute(systemMBean,"StartLevel"));
  try {
    connection.setAttribute(systemMBean,new Attribute("StartLevel",101));
    assertGetAttributeRetry("Start level should have been changed",101,connection,systemMBean,"StartLevel");
  }
  finally {
    connection.setAttribute(systemMBean,new Attribute("StartLevel",100));
  }
  assertGetAttributeRetry("Start level should be changed back now",100,connection,systemMBean,"StartLevel");
  ObjectName memoryMBean=new ObjectName("java.lang:type=Memory");
  assertEquals(false,connection.getAttribute(memoryMBean,"Verbose"));
  try {
    connection.setAttribute(memoryMBean,new Attribute("Verbose",true));
    assertEquals(true,connection.getAttribute(memoryMBean,"Verbose"));
  }
  finally {
    connection.setAttribute(memoryMBean,new Attribute("Verbose",false));
  }
  assertEquals("Verbosity should be changed back to false",false,connection.getAttribute(memoryMBean,"Verbose"));
  connection.invoke(memoryMBean,"gc",new Object[]{},new String[]{});
  testJMXSecurityMBean(connection,true,true);
  testKarafConfigAdminMBean(connection,true,true);
  testOSGiConfigAdminMBean(connection,true,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.JaasTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoginSingleReg() throws Exception {
  for (int i=0; i < 10; i++) {
    doLogin();
  }
  assertEquals(2,bundleContext.getServiceReferences(ArtifactInstaller.class.getName(),null).length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.JmsTest </h4><pre class="type-6 type-3 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=120000) public void testMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=jms,name=root");
  System.out.println("JMS MBean create operation invocation");
  mbeanServer.invoke(name,"create",new String[]{"testMBean","activemq","tcp://localhost:61616","karaf","karaf"},new String[]{"java.lang.String","java.lang.String","java.lang.String","java.lang.String","java.lang.String"});
  getOsgiService(ConnectionFactory.class,"name=testMBean",30000);
  List<String> connectionFactories=(List<String>)mbeanServer.getAttribute(name,"Connectionfactories");
  assertEquals(true,connectionFactories.size() >= 1);
  System.out.println("JMS MBean send operation invocation");
  mbeanServer.invoke(name,"send",new String[]{"testMBean","queueMBean","message",null,"karaf","karaf"},new String[]{"java.lang.String","java.lang.String","java.lang.String","java.lang.String","java.lang.String","java.lang.String"});
  System.out.println("JMS MBean count operation invocation");
  Integer count=(Integer)mbeanServer.invoke(name,"count",new String[]{"testMBean","queueMBean","karaf","karaf"},new String[]{"java.lang.String","java.lang.String","java.lang.String","java.lang.String"});
  assertEquals(1,count.intValue());
  System.out.print("JMS MBean queues operation invocation: ");
  List<String> queues=(List<String>)mbeanServer.invoke(name,"queues",new String[]{"testMBean","karaf","karaf"},new String[]{"java.lang.String","java.lang.String","java.lang.String"});
  System.out.println(queues);
  assertTrue(queues.size() >= 1);
  System.out.println("JMS MBean delete operation invocation");
  mbeanServer.invoke(name,"delete",new String[]{"testMBean"},new String[]{"java.lang.String"});
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.KarTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=kar,name=root");
  @SuppressWarnings("unchecked") List<String> kars=(List<String>)mbeanServer.getAttribute(name,"Kars");
  assertEquals(0,kars.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.LogTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void setDebugViaMBean() throws Exception {
  assertSetLevel("INFO");
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=log,name=root");
  Attribute attribute=new Attribute("Level","DEBUG");
  mbeanServer.setAttribute(name,attribute);
  String logLevel=(String)mbeanServer.getAttribute(name,"Level");
  assertEquals("DEBUG",logLevel);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.ObrTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listsViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=obr,name=root");
  @SuppressWarnings("unchecked") List<String> urls=(List<String>)mbeanServer.getAttribute(name,"Urls");
  assertEquals(0,urls.size());
  TabularData bundles=(TabularData)mbeanServer.getAttribute(name,"Bundles");
  assertEquals(0,bundles.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.PackageTest </h4><pre class="type-6 type-14 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void duplicatePackageTest() throws Exception {
  Map<String,Integer> expectedDups=new HashMap<String,Integer>();
  List<PackageVersion> packageVersionMap=packageService.getExports();
  for (  PackageVersion pVer : packageVersionMap) {
    if (pVer.getBundles().size() > 1) {
      String packageName=pVer.getPackageName();
      int expectedNum=expectedDups.containsKey(packageName) ? expectedDups.get(packageName) : 0;
      Assert.assertEquals("Expecting number of duplicates for package " + packageName,expectedNum,pVer.getBundles().size());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.SystemTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void nameViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=system,name=root");
  String currentName=(String)mbeanServer.getAttribute(name,"Name");
  assertEquals("root",currentName);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void frameworkViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=system,name=root");
  String framework=(String)mbeanServer.getAttribute(name,"Framework");
  assertEquals("felix",framework);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void startLevelViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=system,name=root");
  int startLevel=(Integer)mbeanServer.getAttribute(name,"StartLevel");
  assertEquals(100,startLevel);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void nameCommand() throws Exception {
  String nameOutput=executeCommand("system:name");
  System.out.println(nameOutput);
  assertEquals("root",nameOutput.trim());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.itests.WebTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listViaMBean() throws Exception {
  MBeanServer mbeanServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName name=new ObjectName("org.apache.karaf:type=web,name=root");
  TabularData webBundles=(TabularData)mbeanServer.getAttribute(name,"WebBundles");
  assertEquals(0,webBundles.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.blueprint.jasypt.handler.EncryptableConfigAdminPropertyPlaceholderTest </h4><pre class="type-16 type-6 type-14 type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncryptConfigProperty() throws Exception {
  for (  Bundle bundle : bundleContext.getBundles()) {
    System.out.println(bundle.getSymbolicName() + " / " + bundle.getVersion());
  }
  configAdmin=getOsgiService(ConfigurationAdmin.class);
  assertNotNull(configAdmin);
  Configuration config=configAdmin.createFactoryConfiguration("encrypt.config",null);
  Dictionary props=new Properties();
  encryptedValue=enc.encrypt("bar");
  props.put("foo",encryptedValue);
  config.update(props);
  Configuration[] configs=configAdmin.listConfigurations(null);
  for (  Configuration conf : configs) {
    String pid=conf.getPid();
    Dictionary<String,?> dict=conf.getProperties();
    for (Enumeration e=dict.keys(); e.hasMoreElements(); ) {
      String key=(String)e.nextElement();
      Object value=dict.get(key);
      if (key.equals("foo")) {
        String val=(String)value;
        assertEquals(encryptedValue,val);
        String decrypt=enc.decrypt(val);
        assertEquals("bar",decrypt);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.blueprint.jasypt.handler.EncryptablePropertyPlaceholderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPlaceholder() throws Exception {
  for (  Bundle bundle : bundleContext.getBundles()) {
    System.out.println(bundle.getSymbolicName() + " / " + bundle.getVersion());
  }
  Bean encoded=getOsgiService(Bean.class,"(encoded=*)");
  assertEquals("bar",encoded.getString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.modules.jdbc.JdbcLoginModuleTest </h4><pre class="type-3 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoginModule() throws Exception {
  JDBCBackingEngine engine=new JDBCBackingEngine(dataSource);
  engine.addUser("abc","xyz");
  engine.addRole("abc","role1");
  JDBCLoginModule module=new JDBCLoginModule();
  Subject subject=new Subject();
  module.initialize(subject,getCallbackHandler("abc","xyz"),null,options);
  module.login();
  module.commit();
  assertFalse(subject.getPrincipals(UserPrincipal.class).isEmpty());
  assertEquals("abc",subject.getPrincipals(UserPrincipal.class).iterator().next().getName());
  assertFalse(subject.getPrincipals(RolePrincipal.class).isEmpty());
  assertEquals("role1",subject.getPrincipals(RolePrincipal.class).iterator().next().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.modules.ldap.LdapCacheTest </h4><pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdminLogin() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(2,subject.getPrincipals().size());
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal pr : subject.getPrincipals()) {
    if (pr instanceof UserPrincipal) {
      assertEquals("admin",pr.getName());
      foundUser=true;
    }
 else     if (pr instanceof RolePrincipal) {
      assertEquals("admin",pr.getName());
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertTrue(foundRole);
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
  DirContext context=new LDAPCache(new LDAPOptions(options)).open();
  Attributes entry=new BasicAttributes();
  entry.put(new BasicAttribute("cn","another"));
  Attribute oc=new BasicAttribute("objectClass");
  oc.add("top");
  oc.add("groupOfNames");
  entry.put(oc);
  Attribute mb=new BasicAttribute("member");
  mb.add("cn=admin,ou=people,dc=example,dc=com");
  entry.put(mb);
  context.createSubcontext("cn=another,ou=groups,dc=example,dc=com",entry);
  Thread.sleep(100);
  module=new LDAPLoginModule();
  subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals("Postcondition",3,subject.getPrincipals().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.modules.ldap.LdapCaseInsensitiveDNTest </h4><pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCaseInsensitiveDN() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(2,subject.getPrincipals().size());
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal pr : subject.getPrincipals()) {
    if (pr instanceof UserPrincipal) {
      assertEquals("admin",pr.getName());
      foundUser=true;
    }
 else     if (pr instanceof RolePrincipal) {
      assertEquals("admin",pr.getName());
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertTrue(foundRole);
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.modules.ldap.LdapLoginModuleTest </h4><pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonAdminLogin() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("cheese");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("foodie".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(1,subject.getPrincipals().size());
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal pr : subject.getPrincipals()) {
    if (pr instanceof UserPrincipal) {
      assertEquals("cheese",pr.getName());
      foundUser=true;
    }
 else     if (pr instanceof RolePrincipal) {
      assertEquals("admin",pr.getName());
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertFalse(foundRole);
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
}

</code></pre>

<br>
<pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdminLogin() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(2,subject.getPrincipals().size());
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal pr : subject.getPrincipals()) {
    if (pr instanceof UserPrincipal) {
      assertEquals("admin",pr.getName());
      foundUser=true;
    }
 else     if (pr instanceof RolePrincipal) {
      assertEquals("admin",pr.getName());
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertTrue(foundRole);
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
}

</code></pre>

<br>
<pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoleMappingAdvanced() throws Exception {
  Properties options=ldapLoginModuleOptions();
  options.put(LDAPOptions.ROLE_MAPPING,"admin=karaf,test;admin=another");
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(4,subject.getPrincipals().size());
  final List<String> roles=new ArrayList<String>(Arrays.asList("karaf","test","another"));
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal principal : subject.getPrincipals()) {
    if (principal instanceof UserPrincipal) {
      assertEquals("admin",principal.getName());
      foundUser=true;
    }
 else     if (principal instanceof RolePrincipal) {
      assertTrue(roles.remove(principal.getName()));
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertTrue(foundRole);
  assertTrue(roles.isEmpty());
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
}

</code></pre>

<br>
<pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoleMappingSimple() throws Exception {
  Properties options=ldapLoginModuleOptions();
  options.put(LDAPOptions.ROLE_MAPPING,"admin=karaf");
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    @Override public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(2,subject.getPrincipals().size());
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal principal : subject.getPrincipals()) {
    if (principal instanceof UserPrincipal) {
      assertEquals("admin",principal.getName());
      foundUser=true;
    }
 else     if (principal instanceof RolePrincipal) {
      assertEquals("karaf",principal.getName());
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertTrue(foundRole);
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadPassword() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("blahblah".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertFalse(module.login());
}

</code></pre>

<br>
<pre class="type-14 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRoleMappingParsing() throws Exception {
  Properties options=ldapLoginModuleOptions();
  options.put(LDAPOptions.ROLE_MAPPING,"admin = karaf, test; admin = another");
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("admin");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertTrue(module.login());
  assertTrue(module.commit());
  assertEquals(4,subject.getPrincipals().size());
  final List<String> roles=new ArrayList<String>(Arrays.asList("karaf","test","another"));
  boolean foundUser=false;
  boolean foundRole=false;
  for (  Principal pr : subject.getPrincipals()) {
    if (pr instanceof UserPrincipal) {
      assertEquals("admin",pr.getName());
      foundUser=true;
    }
 else     if (pr instanceof RolePrincipal) {
      assertTrue(roles.remove(pr.getName()));
      foundRole=true;
    }
  }
  assertTrue(foundUser);
  assertTrue(foundRole);
  assertTrue(roles.isEmpty());
  assertTrue(module.logout());
  assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserNotFound() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("imnothere");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("admin123".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  assertFalse(module.login());
}

</code></pre>

<br>
<pre class="type-10 type-3 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyPassword() throws Exception {
  Properties options=ldapLoginModuleOptions();
  LDAPLoginModule module=new LDAPLoginModule();
  CallbackHandler cb=new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      for (      Callback cb : callbacks) {
        if (cb instanceof NameCallback) {
          ((NameCallback)cb).setName("imnothere");
        }
 else         if (cb instanceof PasswordCallback) {
          ((PasswordCallback)cb).setPassword("".toCharArray());
        }
      }
    }
  }
;
  Subject subject=new Subject();
  module.initialize(subject,cb,null,options);
  assertEquals("Precondition",0,subject.getPrincipals().size());
  try {
    module.login();
    fail("Should have failed");
  }
 catch (  LoginException e) {
    assertTrue(e.getMessage().equals("Empty passwords not allowed"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.modules.properties.PropertiesLoginModuleTest </h4><pre class="type-14 type-10 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoginWithGroups() throws Exception {
  File f=File.createTempFile(getClass().getName(),".tmp");
  try {
    Properties p=new Properties(f);
    PropertiesBackingEngine pbe=new PropertiesBackingEngine(p);
    pbe.addUser("abc","xyz");
    pbe.addRole("abc","myrole");
    pbe.addUser("pqr","abc");
    pbe.addGroup("pqr","group1");
    pbe.addGroupRole("group1","r1");
    PropertiesLoginModule module=new PropertiesLoginModule();
    Map<String,String> options=new HashMap<String,String>();
    options.put(PropertiesLoginModule.USER_FILE,f.getAbsolutePath());
    CallbackHandler cb=new CallbackHandler(){
      @Override public void handle(      Callback[] callbacks) throws IOException, UnsupportedCallbackException {
        for (        Callback cb : callbacks) {
          if (cb instanceof NameCallback) {
            ((NameCallback)cb).setName("pqr");
          }
 else           if (cb instanceof PasswordCallback) {
            ((PasswordCallback)cb).setPassword("abc".toCharArray());
          }
        }
      }
    }
;
    Subject subject=new Subject();
    module.initialize(subject,cb,null,options);
    Assert.assertEquals("Precondition",0,subject.getPrincipals().size());
    Assert.assertTrue(module.login());
    Assert.assertTrue(module.commit());
    Assert.assertEquals(3,subject.getPrincipals().size());
    boolean foundUser=false;
    boolean foundRole=false;
    boolean foundGroup=false;
    for (    Principal pr : subject.getPrincipals()) {
      if (pr instanceof UserPrincipal) {
        Assert.assertEquals("pqr",pr.getName());
        foundUser=true;
      }
 else       if (pr instanceof GroupPrincipal) {
        Assert.assertEquals("group1",pr.getName());
        foundGroup=true;
      }
 else       if (pr instanceof RolePrincipal) {
        Assert.assertEquals("r1",pr.getName());
        foundRole=true;
      }
    }
    Assert.assertTrue(foundUser);
    Assert.assertTrue(foundGroup);
    Assert.assertTrue(foundRole);
  }
  finally {
    if (!f.delete()) {
      Assert.fail("Could not delete temporary file: " + f);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullPassword() throws Exception {
  PropertiesLoginModule module=new PropertiesLoginModule();
  Subject subject=new Subject();
  CallbackHandler handler=new NullHandler();
  Map<String,String> options=new HashMap<String,String>();
  options.put(PropertiesLoginModule.USER_FILE,getTestUsersFile());
  module.initialize(subject,handler,null,options);
  try {
    module.login();
    Assert.fail("LoginException expected");
  }
 catch (  LoginException e) {
    Assert.assertEquals("Password can not be null",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-10 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullCallbackHandler(){
  PropertiesLoginModule module=new PropertiesLoginModule();
  Subject subject=new Subject();
  Map<String,String> options=new HashMap<String,String>();
  options.put(PropertiesLoginModule.USER_FILE,getTestUsersFile());
  module.initialize(subject,null,null,options);
  try {
    module.login();
    Assert.fail("LoginException expected");
  }
 catch (  LoginException e) {
    Assert.assertEquals("Username can not be null",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-14 type-10 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicLogin() throws Exception {
  File f=File.createTempFile(getClass().getName(),".tmp");
  try {
    Properties p=new Properties(f);
    PropertiesBackingEngine pbe=new PropertiesBackingEngine(p);
    pbe.addUser("abc","xyz");
    pbe.addRole("abc","myrole");
    pbe.addUser("pqr","abc");
    PropertiesLoginModule module=new PropertiesLoginModule();
    Map<String,String> options=new HashMap<String,String>();
    options.put(PropertiesLoginModule.USER_FILE,f.getAbsolutePath());
    CallbackHandler cb=new CallbackHandler(){
      @Override public void handle(      Callback[] callbacks) throws IOException, UnsupportedCallbackException {
        for (        Callback cb : callbacks) {
          if (cb instanceof NameCallback) {
            ((NameCallback)cb).setName("abc");
          }
 else           if (cb instanceof PasswordCallback) {
            ((PasswordCallback)cb).setPassword("xyz".toCharArray());
          }
        }
      }
    }
;
    Subject subject=new Subject();
    module.initialize(subject,cb,null,options);
    Assert.assertEquals("Precondition",0,subject.getPrincipals().size());
    Assert.assertTrue(module.login());
    Assert.assertTrue(module.commit());
    Assert.assertEquals(2,subject.getPrincipals().size());
    boolean foundUser=false;
    boolean foundRole=false;
    for (    Principal pr : subject.getPrincipals()) {
      if (pr instanceof UserPrincipal) {
        Assert.assertEquals("abc",pr.getName());
        foundUser=true;
      }
 else       if (pr instanceof RolePrincipal) {
        Assert.assertEquals("myrole",pr.getName());
        foundRole=true;
      }
    }
    Assert.assertTrue(foundUser);
    Assert.assertTrue(foundRole);
    Assert.assertTrue(module.logout());
    Assert.assertEquals("Principals should be gone as the user has logged out",0,subject.getPrincipals().size());
  }
  finally {
    if (!f.delete()) {
      Assert.fail("Could not delete temporary file: " + f);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullUsersFile(){
  try {
    testWithUsersFile(null);
    Assert.fail("LoginException expected");
  }
 catch (  LoginException e) {
    Assert.assertEquals("The property users may not be null",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonExistantPropertiesFile() throws LoginException, IOException, UnsupportedCallbackException {
  try {
    testWithUsersFile(File.separator + "test" + File.separator+ "users.properties");
  }
 catch (  LoginException e) {
    Assert.assertEquals("Users file not found at " + File.separator + "test"+ File.separator+ "users.properties",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.jaas.modules.syncope.SyncopeLoginModuleTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRolesExtraction() throws Exception {
  String syncopeResponse="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" + "<user>\n" + "    <attributes>\n"+ "        <attribute>\n"+ "            <readonly>false</readonly>\n"+ "            <schema>cool</schema>\n"+ "            <value>false</value>\n"+ "        </attribute>\n"+ "        <attribute>\n"+ "            <readonly>false</readonly>\n"+ "            <schema>email</schema>\n"+ "            <value>karaf@example.net</value>\n"+ "        </attribute>\n"+ "        <attribute>\n"+ "            <readonly>false</readonly>\n"+ "            <schema>fullname</schema>\n"+ "            <value>karaf</value>\n"+ "        </attribute>\n"+ "        <attribute>\n"+ "            <readonly>false</readonly>\n"+ "            <schema>gender</schema>\n"+ "            <value>M</value>\n"+ "        </attribute>\n"+ "        <attribute>\n"+ "            <readonly>false</readonly>\n"+ "            <schema>surname</schema>\n"+ "            <value>karaf</value>\n"+ "        </attribute>\n"+ "        <attribute>\n"+ "            <readonly>false</readonly>\n"+ "            <schema>userId</schema>\n"+ "            <value>karaf@example.net</value>\n"+ "        </attribute>\n"+ "    </attributes>\n"+ "    <derivedAttributes/>\n"+ "    <id>100</id>\n"+ "    <propagationStatuses/>\n"+ "    <resources/>\n"+ "    <virtualAttributes/>\n"+ "    <creationDate>2014-08-12T18:37:09.202+02:00</creationDate>\n"+ "    <failedLogins>0</failedLogins>\n"+ "    <lastLoginDate>2014-08-13T09:38:02.204+02:00</lastLoginDate>\n"+ "    <memberships>\n"+ "        <membership>\n"+ "            <attributes/>\n"+ "            <derivedAttributes/>\n"+ "            <id>100</id>\n"+ "            <propagationStatuses/>\n"+ "            <resources/>\n"+ "            <virtualAttributes/>\n"+ "            <resources/>\n"+ "            <roleId>100</roleId>\n"+ "            <roleName>admin</roleName>\n"+ "        </membership>\n"+ "        <membership>\n"+ "            <attributes/>\n"+ "            <derivedAttributes/>\n"+ "            <id>101</id>\n"+ "            <propagationStatuses/>\n"+ "            <resources/>\n"+ "            <virtualAttributes/>\n"+ "            <resources/>\n"+ "            <roleId>101</roleId>\n"+ "            <roleName>another</roleName>\n"+ "        </membership>\n"+ "    </memberships>\n"+ "    <password>36460D3A3C1E27C0DB2AF23344475EE712DD3C9D</password>\n"+ "    <status>active</status>\n"+ "    <username>karaf</username>\n"+ "</user>\n";
  SyncopeLoginModule syncopeLoginModule=new SyncopeLoginModule();
  List<String> roles=syncopeLoginModule.extractingRoles(syncopeResponse);
  Assert.assertEquals(2,roles.size());
  Assert.assertEquals("admin",roles.get(0));
  Assert.assertEquals("another",roles.get(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.MainLockingTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLostMasterLock() throws Exception {
  File basedir=new File(getClass().getClassLoader().getResource("foo").getPath()).getParentFile();
  File home=new File(basedir,"test-karaf-home");
  File data=new File(home,"data");
  Utils.deleteDirectory(data);
  String[] args=new String[0];
  System.setProperty("karaf.home",home.toString());
  System.setProperty("karaf.data",data.toString());
  System.setProperty("karaf.framework.factory","org.apache.felix.framework.FrameworkFactory");
  System.setProperty("karaf.lock","true");
  System.setProperty("karaf.lock.delay","1000");
  System.setProperty("karaf.lock.class","org.apache.karaf.main.MockLock");
  Main main=new Main(args);
  main.launch();
  Framework framework=main.getFramework();
  String activatorName=TimeoutShutdownActivator.class.getName().replace('.','/') + ".class";
  Bundle bundle=framework.getBundleContext().installBundle("foo",TinyBundles.bundle().set(Constants.BUNDLE_ACTIVATOR,TimeoutShutdownActivator.class.getName()).add(activatorName,getClass().getClassLoader().getResourceAsStream(activatorName)).build(withBnd()));
  bundle.start();
  Thread.sleep(2000);
  FrameworkStartLevel sl=framework.adapt(FrameworkStartLevel.class);
  MockLock lock=(MockLock)main.getLock();
  Assert.assertEquals(100,sl.getStartLevel());
  lock.setIsAlive(false);
  lock.setLock(false);
  lock.waitForLock();
  Assert.assertEquals(1,sl.getStartLevel());
  Thread.sleep(1000);
  lock.setIsAlive(true);
  lock.setLock(true);
  Thread.sleep(1000);
  main.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.MainStartTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAutoStart() throws Exception {
  File basedir=new File(getClass().getClassLoader().getResource("foo").getPath()).getParentFile();
  File home=new File(basedir,"test-karaf-home");
  File data=new File(home,"data" + System.currentTimeMillis());
  String[] args=new String[0];
  System.setProperty("karaf.home",home.toString());
  System.setProperty("karaf.data",data.toString());
  main=new Main(args);
  main.launch();
  Framework framework=main.getFramework();
  Bundle[] bundles=framework.getBundleContext().getBundles();
  Assert.assertEquals(3,bundles.length);
  Thread.sleep(1000);
  Bundle bundle1=framework.getBundleContext().getBundle("mvn:org.apache.aries.blueprint/org.apache.aries.blueprint.api/1.0.0");
  Assert.assertEquals(Bundle.ACTIVE,bundle1.getState());
  Bundle bundle2=framework.getBundleContext().getBundle("pax-url-mvn.jar");
  Assert.assertEquals(Bundle.ACTIVE,bundle2.getState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.lock.BaseJDBCLockIntegrationTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void initShouldNotCreateTheSchemaIfItAlreadyExists() throws Exception {
  executeStatement("CREATE TABLE " + tableName + " (MOMENT "+ momentDatatype+ ", NODE "+ nodeDatatype+ ")");
  executeStatement("INSERT INTO " + tableName + " (MOMENT, NODE) VALUES (1, '"+ clustername+ "')");
  lock=createLock(props);
  long moment=queryDatabaseSingleResult("SELECT MOMENT FROM " + tableName);
  assertEquals(1,moment);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.lock.DefaultJDBCLockTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createConnectionShouldConcatinateOptionsCorrect(){
  props.put("karaf.lock.jdbc.url",this.url + ";dataEncryption=false");
  lock=new DefaultJDBCLock(props){
    @Override Connection doCreateConnection(    String driver,    String url,    String username,    String password){
      assertEquals(this.driver,driver);
      assertEquals(this.url + ";create=true",url);
      assertEquals(this.user,username);
      assertEquals(this.password,password);
      return connection;
    }
    @Override long getCurrentTimeMillis(){
      return 1;
    }
  }
;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.lock.DerbyJDBCLockTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createConnectionShouldConcatinateOptionsCorrect(){
  props.put("karaf.lock.jdbc.url",this.url + ";dataEncryption=false");
  lock=new DerbyJDBCLock(props){
    @Override Connection doCreateConnection(    String driver,    String url,    String username,    String password){
      assertEquals(this.driver,driver);
      assertEquals(this.url + ";create=true",url);
      assertEquals(this.user,username);
      assertEquals(this.password,password);
      return connection;
    }
    @Override long getCurrentTimeMillis(){
      return 1;
    }
  }
;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.lock.MySQLJDBCLockTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createConnectionShouldConcatinateOptionsCorrect(){
  props.put("karaf.lock.jdbc.url",this.url + "?connectTimeout=10000");
  lock=new MySQLJDBCLock(props){
    @Override Connection doCreateConnection(    String driver,    String url,    String username,    String password){
      assertEquals(this.driver,driver);
      assertEquals(this.url + "&createDatabaseIfNotExist=true",url);
      assertEquals(this.user,username);
      assertEquals(this.password,password);
      return connection;
    }
    @Override long getCurrentTimeMillis(){
      return 1;
    }
  }
;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.lock.PostgreSQLJDBCLockTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createConnectionShouldConcatinateOptionsCorrect(){
  props.put("karaf.lock.jdbc.url",this.url + ";dataEncryption=false");
  lock=new PostgreSQLJDBCLock(props){
    @Override Connection doCreateConnection(    String driver,    String url,    String username,    String password){
      assertEquals(this.driver,driver);
      assertEquals(this.url,url);
      assertEquals(this.user,username);
      assertEquals(this.password,password);
      return connection;
    }
    @Override long getCurrentTimeMillis(){
      return 1;
    }
  }
;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.lock.StatementsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getDefaultLockCreateStatement(){
  assertEquals("SELECT * FROM KARAF_LOCK FOR UPDATE",statements.getLockCreateStatement());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getCustomLockCreateSchemaStatements(){
  customizeStatements();
  String[] expectedCreateSchemaStmts=new String[]{"CREATE TABLE test.LOCK_TABLE (MOMENT NUMBER(20), NODE VARCHAR2(30))","INSERT INTO test.LOCK_TABLE (MOMENT, NODE) VALUES (2, 'node_1')"};
  assertArrayEquals(expectedCreateSchemaStmts,statements.getLockCreateSchemaStatements(2));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getCustomLockCreateStatement(){
  customizeStatements();
  assertEquals("SELECT * FROM test.LOCK_TABLE FOR UPDATE",statements.getLockCreateStatement());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getDefaultLockUpdateStatement(){
  assertEquals("UPDATE KARAF_LOCK SET MOMENT = 1",statements.getLockUpdateStatement(1));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getCustomLockUpdateStatement(){
  customizeStatements();
  assertEquals("UPDATE test.LOCK_TABLE SET MOMENT = 2",statements.getLockUpdateStatement(2));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getDefaultLockCreateSchemaStatements(){
  assertArrayEquals(new String[]{DEFAULT_CREATE_TABLE_STMT,DEFAULT_POPULATE_TABLE_STMT},statements.getLockCreateSchemaStatements(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.util.BootstrapLogManagerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetLogManagerNoProperties(){
  BootstrapLogManager.setProperties(getConfigProperties());
  try {
    BootstrapLogManager.getDefaultHandler();
  }
 catch (  IllegalStateException e) {
    Assert.assertEquals("Properties must be set before calling getDefaultHandler",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.main.util.SimpleMavenResolverTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void mavenToPath() throws MalformedURLException {
  String resolvedPath=Parser.pathFromMaven(ARTIFACT_COORDS);
  Assert.assertEquals("org/apache/karaf/features/framework/1.0.0/framework-1.0.0-features.xml",resolvedPath);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.packages.core.internal.ImportDetailsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPackageName(){
  String filter="(&(osgi.wiring.package=org.mypackage)(version>=1.9.0)(!(version>=2.0.0)))";
  ImportDetails details=new ImportDetails(filter);
  Assert.assertEquals("org.mypackage",details.name);
  Assert.assertEquals("1.9.0",details.minVersion);
  Assert.assertEquals("2.0.0",details.maxVersion);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.packages.core.internal.filter.ExpressionTokenizerTest </h4><pre class="type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokens(){
  ExprTokenizer tokenizer=new ExprTokenizer("(a>=b)");
  Assert.assertEquals("(",tokenizer.nextToken());
  Assert.assertEquals("a",tokenizer.nextToken());
  Assert.assertEquals(">=",tokenizer.nextToken());
  Assert.assertEquals("b",tokenizer.nextToken());
  Assert.assertEquals(")",tokenizer.nextToken());
  Assert.assertNull(tokenizer.nextToken());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.packages.core.internal.filter.FilterParserTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPackageImport(){
  AndExpression expr=(AndExpression)new FilterParser().parse("(&(osgi.wiring.package=org.mypackage)(version>=1.9.0)(!(version>=2.0.0)))");
  Assert.assertEquals(3,expr.expressions.length);
  checkItem(expr.expressions[0],"osgi.wiring.package",FilterType.equal,"org.mypackage");
  checkItem(expr.expressions[1],"version",FilterType.gt,"1.9.0");
  NotExpression notVersion=(NotExpression)expr.expressions[2];
  checkItem(notVersion.expression,"version",FilterType.gt,"2.0.0");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.profile.impl.ProfilesTest </h4><pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProfilePlaceholderResolver(){
  Profile profile=ProfileBuilder.Factory.create("test").addConfiguration("pid1","foo","b${profile:pid2/bar}").addConfiguration("pid2","bar","a${rep}").addConfiguration("pid2","rep","h").getProfile();
  Profile effective=Profiles.getEffective(profile);
  assertEquals("bah",effective.getConfiguration("pid1").get("foo"));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProfilesOverlayComments(){
  String pid1="# My comment\nfoo = bar\n";
  Profile parent=ProfileBuilder.Factory.create("parent").addFileConfiguration("pid1.cfg",pid1.getBytes()).getProfile();
  Profile profile=ProfileBuilder.Factory.create("test").addConfiguration("pid1","foo","bar2").addParent("parent").getProfile();
  Map<String,Profile> profiles=new HashMap<>();
  profiles.put(parent.getId(),parent);
  profiles.put(profile.getId(),profile);
  Profile overlay=Profiles.getOverlay(profile,profiles);
  String outPid1=new String(overlay.getFileConfiguration("pid1.cfg"));
  assertEquals(String.format("%1$s%n%2$s%n","# My comment","foo = bar2"),outPid1);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonSubstitution(){
  Profile profile=ProfileBuilder.Factory.create("test").addConfiguration("pid1","key","${foo}/${bar}").getProfile();
  Profile effective=Profiles.getEffective(profile,false);
  assertEquals("${foo}/${bar}",effective.getConfiguration("pid1").get("key"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.service.command.ObjectClassMatcherTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetShortName(){
  Assert.assertEquals("TestClass",ObjectClassMatcher.getShortName("org.apache.TestClass"));
  Assert.assertEquals("",ObjectClassMatcher.getShortName("test."));
  Assert.assertEquals("TestClass",ObjectClassMatcher.getShortName("TestClass"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.service.guard.impl.GuardProxyCatalogTest </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testHandleServiceUnregistering() throws Exception {
  BundleContext clientBC=openStrictMockBundleContext(mockBundle(12345L));
  BundleContext client2BC=openStrictMockBundleContext(mockBundle(6L));
  EasyMock.replay(clientBC);
  EasyMock.replay(client2BC);
  Hashtable<String,Object> props=new Hashtable<String,Object>();
  long originalServiceID=12345678901234L;
  props.put(Constants.SERVICE_ID,new Long(originalServiceID));
  props.put("foo","bar");
  ServiceReference<?> originalRef=mockServiceReference(props);
  Hashtable<String,Object> props2=new Hashtable<String,Object>();
  long anotherServiceID=5123456789012345L;
  props2.put(Constants.SERVICE_ID,anotherServiceID);
  ServiceReference<?> anotherRef=mockServiceReference(props2);
  GuardProxyCatalog gpc=new GuardProxyCatalog(mockBundleContext());
  ServiceRegistration<?> proxyReg=EasyMock.createMock(ServiceRegistration.class);
  EasyMock.expect(proxyReg.getReference()).andReturn((ServiceReference)mockServiceReference(props)).anyTimes();
  proxyReg.unregister();
  EasyMock.expectLastCall().once();
  EasyMock.replay(proxyReg);
  ServiceRegistrationHolder srh=new GuardProxyCatalog.ServiceRegistrationHolder();
  srh.registration=proxyReg;
  ServiceRegistration<?> proxy2Reg=EasyMock.createMock(ServiceRegistration.class);
  EasyMock.replay(proxy2Reg);
  ServiceRegistrationHolder srh2=new GuardProxyCatalog.ServiceRegistrationHolder();
  srh2.registration=proxy2Reg;
  gpc.proxyMap.put(originalServiceID,srh);
  gpc.proxyMap.put(anotherServiceID,srh2);
  assertEquals("Precondition",2,gpc.proxyMap.size());
  gpc.createProxyQueue.put(new MockCreateProxyRunnable(originalServiceID));
  gpc.createProxyQueue.put(new MockCreateProxyRunnable(777));
  assertEquals("Precondition",2,gpc.createProxyQueue.size());
  gpc.serviceChanged(new ServiceEvent(ServiceEvent.REGISTERED,originalRef));
  assertEquals("Registered events should be ignored",2,gpc.proxyMap.size());
  assertEquals("Registered events should be ignored",2,gpc.createProxyQueue.size());
  Hashtable<String,Object> proxyProps=new Hashtable<String,Object>(props);
  proxyProps.put(GuardProxyCatalog.PROXY_SERVICE_KEY,Boolean.TRUE);
  ServiceReference<?> proxyRef=mockServiceReference(proxyProps);
  gpc.serviceChanged(new ServiceEvent(ServiceEvent.UNREGISTERING,proxyRef));
  assertEquals("Unregistering the proxy should be ignored by the listener",2,gpc.proxyMap.size());
  assertEquals("Unregistering the proxy should be ignored by the listener",2,gpc.createProxyQueue.size());
  gpc.serviceChanged(new ServiceEvent(ServiceEvent.UNREGISTERING,originalRef));
  assertEquals("The proxy for this service should have been removed",1,gpc.proxyMap.size());
  assertEquals(anotherRef.getProperty(Constants.SERVICE_ID),gpc.proxyMap.keySet().iterator().next());
  assertEquals("The create proxy job for this service should have been removed",1,gpc.createProxyQueue.size());
  assertEquals(777,gpc.createProxyQueue.iterator().next().getOriginalServiceID());
  EasyMock.verify(proxyReg);
  EasyMock.verify(proxy2Reg);
}

</code></pre>

<br>
<pre class="type-6 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testHandleProxificationForHook() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put(Constants.SERVICE_PID,GuardProxyCatalog.SERVICE_ACL_PREFIX + "foo");
  config.put(GuardProxyCatalog.SERVICE_GUARD_KEY,"(a>=5)");
  BundleContext bc=mockConfigAdminBundleContext(config);
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(Constants.SERVICE_ID,13L);
  props.put("a","6");
  props.put(GuardProxyCatalog.PROXY_SERVICE_KEY,Boolean.TRUE);
  ServiceReference<?> sref2=mockServiceReference(props);
  assertFalse("Should not hide an existing proxy for this client",gpc.handleProxificationForHook(sref2));
  assertEquals("No proxy should have been created",0,gpc.proxyMap.size());
  Dictionary<String,Object> props4=new Hashtable<String,Object>();
  props4.put(Constants.SERVICE_ID,15L);
  props4.put("a","7");
  ServiceReference<?> sref4=mockServiceReference(props4);
  assertTrue("Should hide a service that needs to be proxied",gpc.handleProxificationForHook(sref4));
  assertEquals("Should trigger proxy creation",1,gpc.proxyMap.size());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-11 type-5 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings({"unchecked","rawtypes"}) public void testServiceFactoryBehaviour() throws Exception {
  final Map<ServiceReference,Object> serviceMap=new HashMap<ServiceReference,Object>();
  TestServiceAPI testService=new TestService();
  BundleContext bc=mockConfigAdminBundleContext();
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  long serviceID=117L;
  final Hashtable<String,Object> serviceProps=new Hashtable<String,Object>();
  serviceProps.put(Constants.OBJECTCLASS,new String[]{TestServiceAPI.class.getName()});
  serviceProps.put(Constants.SERVICE_ID,serviceID);
  serviceProps.put("bar",42L);
  BundleContext providerBC=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(providerBC.registerService(EasyMock.isA(String[].class),EasyMock.anyObject(),EasyMock.isA(Dictionary.class))).andAnswer(new IAnswer(){
    @Override public ServiceRegistration answer() throws Throwable {
      Dictionary<String,Object> props=(Dictionary<String,Object>)EasyMock.getCurrentArguments()[2];
      ServiceRegistration reg=EasyMock.createMock(ServiceRegistration.class);
      ServiceReference sr=mockServiceReference(props);
      EasyMock.expect(reg.getReference()).andReturn(sr).anyTimes();
      EasyMock.replay(reg);
      serviceMap.put(sr,EasyMock.getCurrentArguments()[1]);
      return reg;
    }
  }
).once();
  EasyMock.expect(providerBC.getService(EasyMock.isA(ServiceReference.class))).andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      return serviceMap.get(EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  EasyMock.replay(providerBC);
  BundleWiring bw=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(bw.getClassLoader()).andReturn(getClass().getClassLoader()).anyTimes();
  EasyMock.replay(bw);
  Bundle providerBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(providerBundle.getBundleContext()).andReturn(providerBC).anyTimes();
  EasyMock.expect(providerBundle.adapt(BundleWiring.class)).andReturn(bw).anyTimes();
  EasyMock.replay(providerBundle);
  ServiceReference sr=mockServiceReference(providerBundle,serviceProps);
  BundleContext clientBC=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(clientBC.getService(sr)).andReturn(testService).anyTimes();
  EasyMock.replay(clientBC);
  Bundle clientBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(clientBundle.getBundleContext()).andReturn(clientBC).anyTimes();
  EasyMock.replay(clientBundle);
  gpc.proxyIfNotAlreadyProxied(sr);
  GuardProxyCatalog.ServiceRegistrationHolder holder=gpc.proxyMap.get(serviceID);
  GuardProxyCatalog.CreateProxyRunnable runnable=gpc.createProxyQueue.take();
  assertEquals(117L,runnable.getOriginalServiceID());
  ProxyManager pm=getProxyManager();
  runnable.run(pm);
  ServiceReference<?> proxySR=holder.registration.getReference();
  EasyMock.verify(providerBC);
  ServiceFactory proxyServiceSF=(ServiceFactory)serviceMap.get(proxySR);
  TestServiceAPI proxyService=(TestServiceAPI)proxyServiceSF.getService(clientBundle,null);
  assertNotSame("The proxy should not be the same object as the original service",testService,proxyService);
  assertEquals("Doing it",proxyService.doit());
  EasyMock.reset(clientBC);
  EasyMock.expect(clientBC.ungetService(sr)).andReturn(true).once();
  EasyMock.replay(clientBC);
  proxyServiceSF.ungetService(clientBundle,null,proxyService);
  EasyMock.verify(clientBC);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testAssignRoles4() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put(Constants.SERVICE_PID,"foobar");
  config.put("service.guard","(objectClass=" + TestServiceAPI.class.getName() + ")");
  config.put("somemethod","b");
  config.put("someOtherMethod","b");
  config.put("somethingelse","*");
  BundleContext bc=mockConfigAdminBundleContext(config);
  Dictionary<String,Object> proxyProps=testCreateProxy(bc,TestServiceAPI.class,new TestService());
  Collection<String> result=(Collection<String>)proxyProps.get(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY);
  assertEquals(1,result.size());
  assertEquals("b",result.iterator().next());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testAssignRoles3() throws Exception {
abstract class MyAbstractClass implements TestServiceAPI, TestServiceAPI2 {
  }
  ;
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put(Constants.SERVICE_PID,"foobar");
  config.put("service.guard","(objectClass=" + TestServiceAPI2.class.getName() + ")");
  config.put("doit","X");
  BundleContext bc=mockConfigAdminBundleContext(config);
  Map<ServiceReference,Object> serviceMap=new HashMap<ServiceReference,Object>();
  testCreateProxy(bc,new Class[]{TestServiceAPI.class,TestServiceAPI2.class},new MyAbstractClass(){
    @Override public String doit(){
      return null;
    }
    @Override public String doit(    String s){
      return null;
    }
  }
,serviceMap);
  assertEquals(1,serviceMap.size());
  assertEquals(Collections.singleton("X"),serviceMap.keySet().iterator().next().getProperty(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY));
}

</code></pre>

<br>
<pre class="type-6 type-14 type-4 type-5 type-19 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testHandleServiceModified() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put(Constants.SERVICE_PID,"test.1.2.3");
  config.put("service.guard","(objectClass=" + TestServiceAPI.class.getName() + ")");
  config.put("doit","role.1");
  Dictionary<String,Object> config2=new Hashtable<String,Object>();
  config2.put(Constants.SERVICE_PID,"test.1.2.4");
  config2.put("service.guard","(objectClass=" + TestServiceAPI2.class.getName() + ")");
  config2.put("doit","role.2");
  BundleContext bc=mockConfigAdminBundleContext(config,config2);
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  long serviceID=1L;
  final Hashtable<String,Object> serviceProps=new Hashtable<String,Object>();
  serviceProps.put(Constants.OBJECTCLASS,new String[]{TestServiceAPI.class.getName(),TestServiceAPI2.class.getName()});
  serviceProps.put(Constants.SERVICE_ID,serviceID);
  serviceProps.put(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY,Arrays.asList("someone"));
  Object myObject=new Object();
  serviceProps.put("foo.bar",myObject);
  BundleContext providerBC=EasyMock.createNiceMock(BundleContext.class);
  EasyMock.expect(providerBC.registerService(EasyMock.aryEq(new String[]{TestServiceAPI.class.getName(),TestServiceAPI2.class.getName()}),EasyMock.anyObject(),EasyMock.anyObject(Dictionary.class))).andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      final Dictionary props=(Dictionary)EasyMock.getCurrentArguments()[2];
      assertEquals(Boolean.TRUE,props.get(GuardProxyCatalog.PROXY_SERVICE_KEY));
      ServiceRegistration reg=EasyMock.createMock(ServiceRegistration.class);
      ServiceReference sr=mockServiceReference(props);
      EasyMock.expect(reg.getReference()).andReturn(sr).anyTimes();
      reg.setProperties(EasyMock.isA(Dictionary.class));
      EasyMock.expectLastCall().andAnswer(new IAnswer(){
        @Override public Object answer() throws Throwable {
          ArrayList<String> oldKeys=Collections.list(props.keys());
          for (          String key : oldKeys) {
            props.remove(key);
          }
          Dictionary<String,Object> newProps=(Dictionary<String,Object>)EasyMock.getCurrentArguments()[0];
          for (          String key : Collections.list(newProps.keys())) {
            props.put(key,newProps.get(key));
          }
          return null;
        }
      }
).once();
      EasyMock.replay(reg);
      return reg;
    }
  }
).anyTimes();
  EasyMock.replay(providerBC);
  BundleWiring bw=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(bw.getClassLoader()).andReturn(getClass().getClassLoader()).anyTimes();
  EasyMock.replay(bw);
  Bundle providerBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(providerBundle.getBundleContext()).andReturn(providerBC).anyTimes();
  EasyMock.expect(providerBundle.adapt(BundleWiring.class)).andReturn(bw).anyTimes();
  EasyMock.replay(providerBundle);
  ServiceReference sr=mockServiceReference(providerBundle,serviceProps);
  gpc.proxyIfNotAlreadyProxied(sr);
  GuardProxyCatalog.CreateProxyRunnable runnable=gpc.createProxyQueue.take();
  runnable.run(getProxyManager());
  ServiceRegistrationHolder holder=gpc.proxyMap.get(serviceID);
  ServiceRegistration<?> reg=holder.registration;
  for (  String key : serviceProps.keySet()) {
    if (GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY.equals(key)) {
      assertEquals(new HashSet(Arrays.asList("role.1","role.2")),reg.getReference().getProperty(key));
    }
 else {
      assertEquals(serviceProps.get(key),reg.getReference().getProperty(key));
    }
  }
  assertEquals(Boolean.TRUE,reg.getReference().getProperty(GuardProxyCatalog.PROXY_SERVICE_KEY));
  serviceProps.put("test","property");
  assertEquals("Precondition, the mocked reference should have picked up this change","property",sr.getProperty("test"));
  gpc.serviceChanged(new ServiceEvent(ServiceEvent.MODIFIED,sr));
  assertEquals("Changing the service should not change the number of proxies",1,gpc.proxyMap.size());
  for (  String key : serviceProps.keySet()) {
    if (GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY.equals(key)) {
      assertEquals(new HashSet(Arrays.asList("role.1","role.2")),reg.getReference().getProperty(key));
    }
 else {
      assertEquals(serviceProps.get(key),reg.getReference().getProperty(key));
    }
  }
  assertEquals("property",reg.getReference().getProperty("test"));
  assertEquals(Boolean.TRUE,reg.getReference().getProperty(GuardProxyCatalog.PROXY_SERVICE_KEY));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testAssignRoles() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put(Constants.SERVICE_PID,"foobar");
  config.put("service.guard","(objectClass=" + TestServiceAPI.class.getName() + ")");
  config.put("somemethod","a,b");
  config.put("someOtherMethod(int)","c");
  config.put("someOtherMethod(int)[/12/]","d");
  config.put("someOtherMethod(int)[\"42\"]","e");
  config.put("someOtherMethod[/.*[x][y][z].*/]","f");
  config.put("someFoo*","g");
  BundleContext bc=mockConfigAdminBundleContext(config);
  Dictionary<String,Object> proxyProps=testCreateProxy(bc,TestServiceAPI.class,new TestService());
  assertEquals(new HashSet<String>(Arrays.asList("a","b","c","d","e","f","g")),new HashSet<String>((Collection<String>)proxyProps.get(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY)));
}

</code></pre>

<br>
<pre class="type-6 type-14 type-10 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInvocationBlocking2() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put(Constants.SERVICE_PID,"barfoobar");
  config.put("service.guard","(objectClass=" + TestObjectWithoutInterface.class.getName() + ")");
  config.put("compute(long)[\"42\"]","b");
  config.put("compute(long)","c");
  BundleContext bc=mockConfigAdminBundleContext(config);
  final Object proxy=testCreateProxy(bc,new Class[]{TestServiceAPI.class,TestObjectWithoutInterface.class},new CombinedTestService());
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("b"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      if (!runningUnderCoverage) {
        assertEquals(-42L,((TestObjectWithoutInterface)proxy).compute(42L));
        try {
          ((TestObjectWithoutInterface)proxy).compute(44L);
          fail("Should have been blocked");
        }
 catch (        SecurityException se) {
        }
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-3 type-4 type-5 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testHandleServiceModified2() throws Exception {
  BundleContext bc=mockConfigAdminBundleContext();
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  long serviceID=1L;
  final Hashtable<String,Object> serviceProps=new Hashtable<String,Object>();
  serviceProps.put(Constants.OBJECTCLASS,new String[]{TestServiceAPI.class.getName()});
  serviceProps.put(Constants.SERVICE_ID,serviceID);
  BundleContext providerBC=EasyMock.createNiceMock(BundleContext.class);
  EasyMock.expect(providerBC.registerService(EasyMock.aryEq(new String[]{TestServiceAPI.class.getName()}),EasyMock.anyObject(),EasyMock.anyObject(Dictionary.class))).andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      final Dictionary props=(Dictionary)EasyMock.getCurrentArguments()[2];
      assertEquals(Boolean.TRUE,props.get(GuardProxyCatalog.PROXY_SERVICE_KEY));
      ServiceRegistration reg=EasyMock.createMock(ServiceRegistration.class);
      ServiceReference sr=mockServiceReference(props);
      EasyMock.expect(reg.getReference()).andReturn(sr).anyTimes();
      reg.setProperties(EasyMock.isA(Dictionary.class));
      EasyMock.expectLastCall().andAnswer(new IAnswer(){
        @Override public Object answer() throws Throwable {
          ArrayList<String> oldKeys=Collections.list(props.keys());
          for (          String key : oldKeys) {
            props.remove(key);
          }
          Dictionary<String,Object> newProps=(Dictionary<String,Object>)EasyMock.getCurrentArguments()[0];
          for (          String key : Collections.list(newProps.keys())) {
            props.put(key,newProps.get(key));
          }
          return null;
        }
      }
).once();
      EasyMock.replay(reg);
      return reg;
    }
  }
).anyTimes();
  EasyMock.replay(providerBC);
  BundleWiring bw=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(bw.getClassLoader()).andReturn(getClass().getClassLoader()).anyTimes();
  EasyMock.replay(bw);
  Bundle providerBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(providerBundle.getBundleContext()).andReturn(providerBC).anyTimes();
  EasyMock.expect(providerBundle.adapt(BundleWiring.class)).andReturn(bw).anyTimes();
  EasyMock.replay(providerBundle);
  ServiceReference sr=mockServiceReference(providerBundle,serviceProps);
  gpc.proxyIfNotAlreadyProxied(sr);
  GuardProxyCatalog.CreateProxyRunnable runnable=gpc.createProxyQueue.take();
  runnable.run(getProxyManager());
  ServiceRegistrationHolder holder=gpc.proxyMap.get(serviceID);
  ServiceRegistration<?> reg=holder.registration;
  assertFalse("No roles defined for this service using configuration, so roles property should not be set",Arrays.asList(reg.getReference().getPropertyKeys()).contains(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY));
  for (  String key : serviceProps.keySet()) {
    assertEquals(serviceProps.get(key),reg.getReference().getProperty(key));
  }
  assertEquals(Boolean.TRUE,reg.getReference().getProperty(GuardProxyCatalog.PROXY_SERVICE_KEY));
  serviceProps.put(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY,"foobar");
  assertEquals("Precondition, the mocked reference should have picked up this change","foobar",sr.getProperty(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY));
  gpc.serviceChanged(new ServiceEvent(ServiceEvent.MODIFIED,sr));
  assertEquals("Changing the service should not change the number of proxies",1,gpc.proxyMap.size());
  assertFalse("The roles property set on the modified service should have been removed",Arrays.asList(reg.getReference().getPropertyKeys()).contains(GuardProxyCatalog.SERVICE_GUARD_ROLES_PROPERTY));
  assertEquals(Boolean.TRUE,reg.getReference().getProperty(GuardProxyCatalog.PROXY_SERVICE_KEY));
}

</code></pre>

<br>
<pre class="type-6 type-10 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInvocationBlocking3() throws Exception {
class MyService implements TestServiceAPI, TestServiceAPI2 {
    public String doit(    String s){
      return new StringBuilder(s).reverse().toString();
    }
    public String doit(){
      return "Doing it";
    }
  }
  ;
  Dictionary<String,Object> c1=new Hashtable<String,Object>();
  c1.put(Constants.SERVICE_PID,"foobar");
  c1.put("service.guard","(objectClass=" + TestServiceAPI.class.getName() + ")");
  c1.put("do*","c");
  Dictionary<String,Object> c2=new Hashtable<String,Object>();
  c2.put(Constants.SERVICE_PID,"foobar2");
  c2.put("service.guard","(objectClass=" + TestServiceAPI2.class.getName() + ")");
  c2.put("doit(java.lang.String)[/[tT][a]+/]","b,d # a regex rule");
  c2.put("doit(java.lang.String)","a");
  BundleContext bc=mockConfigAdminBundleContext(c1,c2);
  final Object proxy=testCreateProxy(bc,new Class[]{TestServiceAPI.class,TestServiceAPI2.class},new MyService());
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("c"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      assertEquals("Doing it",((TestServiceAPI)proxy).doit());
      return null;
    }
  }
);
  Subject subject2=new Subject();
  subject2.getPrincipals().add(new RolePrincipal("b"));
  subject2.getPrincipals().add(new RolePrincipal("f"));
  Subject.doAs(subject2,new PrivilegedAction(){
    @Override public Object run(){
      try {
        assertEquals("Doing it",((TestServiceAPI)proxy).doit());
        fail("Should have been blocked");
      }
 catch (      SecurityException se) {
      }
      assertEquals("aaT",((TestServiceAPI2)proxy).doit("Taa"));
      try {
        ((TestServiceAPI2)proxy).doit("t");
        fail("Should have been blocked");
      }
 catch (      SecurityException se) {
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-14 type-10 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInvocationBlocking1() throws Exception {
  Dictionary<String,Object> c1=new Hashtable<String,Object>();
  c1.put(Constants.SERVICE_PID,"foobar");
  c1.put("service.guard","(objectClass=" + TestServiceAPI.class.getName() + ")");
  c1.put("doit","a,b");
  Dictionary<String,Object> c2=new Hashtable<String,Object>();
  c2.put(Constants.SERVICE_PID,"barfoobar");
  c2.put("service.guard","(objectClass=" + TestObjectWithoutInterface.class.getName() + ")");
  c2.put("compute","c");
  BundleContext bc=mockConfigAdminBundleContext(c1,c2);
  final Object proxy=testCreateProxy(bc,new Class[]{TestServiceAPI.class,TestObjectWithoutInterface.class},new CombinedTestService());
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("b"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      assertEquals("Doing it",((TestServiceAPI)proxy).doit());
      if (!runningUnderCoverage) {
        try {
          ((TestObjectWithoutInterface)proxy).compute(44L);
          fail("Should have been blocked");
        }
 catch (        SecurityException se) {
        }
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-14 type-3 type-4 type-5 type-7 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testProxyCreationThread() throws Exception {
  ProxyManager proxyManager=getProxyManager();
  ConfigurationAdmin ca=EasyMock.createMock(ConfigurationAdmin.class);
  EasyMock.expect(ca.listConfigurations(EasyMock.anyObject(String.class))).andReturn(null).anyTimes();
  EasyMock.replay(ca);
  ServiceReference pmSref=EasyMock.createMock(ServiceReference.class);
  EasyMock.replay(pmSref);
  ServiceReference pmSref2=EasyMock.createMock(ServiceReference.class);
  EasyMock.replay(pmSref2);
  ServiceReference cmSref=EasyMock.createMock(ServiceReference.class);
  EasyMock.replay(cmSref);
  Bundle b=EasyMock.createMock(Bundle.class);
  EasyMock.expect(b.getBundleId()).andReturn(23992734L).anyTimes();
  EasyMock.replay(b);
  BundleContext bc=EasyMock.createNiceMock(BundleContext.class);
  EasyMock.expect(bc.getBundle()).andReturn(b).anyTimes();
  EasyMock.expect(bc.createFilter(EasyMock.isA(String.class))).andAnswer(new IAnswer<Filter>(){
    @Override public Filter answer() throws Throwable {
      return FrameworkUtil.createFilter((String)EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  final ServiceListener[] pmListenerHolder=new ServiceListener[1];
  String pmFilter="(&(objectClass=" + ProxyManager.class.getName() + ")"+ "(!("+ GuardProxyCatalog.PROXY_SERVICE_KEY+ "=*)))";
  bc.addServiceListener(EasyMock.isA(ServiceListener.class),EasyMock.eq(pmFilter));
  EasyMock.expectLastCall().andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      pmListenerHolder[0]=(ServiceListener)EasyMock.getCurrentArguments()[0];
      return null;
    }
  }
).anyTimes();
  EasyMock.expect(bc.getServiceReferences(EasyMock.anyObject(String.class),EasyMock.contains(ConfigurationAdmin.class.getName()))).andReturn(new ServiceReference[]{cmSref}).anyTimes();
  EasyMock.expect(bc.getService(pmSref)).andReturn(proxyManager).anyTimes();
  EasyMock.expect(bc.getService(pmSref2)).andReturn(proxyManager).anyTimes();
  EasyMock.expect(bc.getService(cmSref)).andReturn(ca).anyTimes();
  EasyMock.replay(bc);
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  final Hashtable<String,Object> serviceProps=new Hashtable<String,Object>();
  serviceProps.put(Constants.OBJECTCLASS,new String[]{TestServiceAPI.class.getName()});
  serviceProps.put(Constants.SERVICE_ID,162L);
  final Map<ServiceReference<?>,Object> serviceMap=new HashMap<ServiceReference<?>,Object>();
  BundleContext providerBC=EasyMock.createMock(BundleContext.class);
  final Hashtable<String,Object> expectedProxyProps=new Hashtable<String,Object>(serviceProps);
  expectedProxyProps.put(GuardProxyCatalog.PROXY_SERVICE_KEY,Boolean.TRUE);
  EasyMock.expect(providerBC.registerService(EasyMock.isA(String[].class),EasyMock.anyObject(),EasyMock.isA(Dictionary.class))).andAnswer(new IAnswer(){
    @Override public ServiceRegistration answer() throws Throwable {
      Dictionary<String,Object> props=(Dictionary<String,Object>)EasyMock.getCurrentArguments()[2];
      ServiceRegistration reg=EasyMock.createMock(ServiceRegistration.class);
      ServiceReference sr=mockServiceReference(props);
      EasyMock.expect(reg.getReference()).andReturn(sr).anyTimes();
      reg.unregister();
      EasyMock.expectLastCall().once();
      EasyMock.replay(reg);
      serviceMap.put(sr,EasyMock.getCurrentArguments()[1]);
      return reg;
    }
  }
).once();
  EasyMock.expect(providerBC.getService(EasyMock.isA(ServiceReference.class))).andAnswer(new IAnswer(){
    @Override public Object answer() throws Throwable {
      return serviceMap.get(EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  EasyMock.replay(providerBC);
  BundleWiring bw=EasyMock.createMock(BundleWiring.class);
  EasyMock.expect(bw.getClassLoader()).andReturn(getClass().getClassLoader()).anyTimes();
  EasyMock.replay(bw);
  Bundle providerBundle=EasyMock.createNiceMock(Bundle.class);
  EasyMock.expect(providerBundle.getBundleContext()).andReturn(providerBC).anyTimes();
  EasyMock.expect(providerBundle.adapt(BundleWiring.class)).andReturn(bw).anyTimes();
  EasyMock.replay(providerBundle);
  ServiceReference sr=mockServiceReference(providerBundle,serviceProps);
  assertEquals("Precondition",0,gpc.proxyMap.size());
  assertEquals("Precondition",0,gpc.createProxyQueue.size());
  gpc.proxyIfNotAlreadyProxied(sr);
  assertEquals(1,gpc.proxyMap.size());
  assertEquals(1,gpc.createProxyQueue.size());
  GuardProxyCatalog.ServiceRegistrationHolder holder=gpc.proxyMap.get(162L);
  assertNull("The registration shouldn't have happened yet",holder.registration);
  assertEquals(1,gpc.createProxyQueue.size());
  Thread[] tarray=new Thread[Thread.activeCount()];
  Thread.enumerate(tarray);
  for (  Thread t : tarray) {
    if (t != null) {
      assertTrue(!GuardProxyCatalog.PROXY_CREATOR_THREAD_NAME.equals(t.getName()));
    }
  }
  pmListenerHolder[0].serviceChanged(new ServiceEvent(ServiceEvent.REGISTERED,pmSref));
  Thread.sleep(400);
  Thread ourThread=null;
  Thread[] tarray2=new Thread[Thread.activeCount()];
  Thread.enumerate(tarray2);
  for (  Thread t : tarray2) {
    if (t != null) {
      if (t.getName().equals(GuardProxyCatalog.PROXY_CREATOR_THREAD_NAME)) {
        ourThread=t;
      }
    }
  }
  assertNotNull(ourThread);
  assertTrue(ourThread.isDaemon());
  assertTrue(ourThread.isAlive());
  assertNotNull(holder.registration);
  assertEquals(0,gpc.createProxyQueue.size());
  int numProxyThreads=0;
  pmListenerHolder[0].serviceChanged(new ServiceEvent(ServiceEvent.REGISTERED,pmSref2));
  Thread.sleep(300);
  Thread[] tarray3=new Thread[Thread.activeCount()];
  Thread.enumerate(tarray3);
  for (  Thread t : tarray3) {
    if (t != null) {
      if (t.getName().equals(GuardProxyCatalog.PROXY_CREATOR_THREAD_NAME)) {
        numProxyThreads++;
      }
    }
  }
  assertEquals("Maximum 1 proxy thread, even if there is more than 1 proxy service",1,numProxyThreads);
  pmListenerHolder[0].serviceChanged(new ServiceEvent(ServiceEvent.UNREGISTERING,pmSref));
  Thread.sleep(300);
  Thread[] tarray4=new Thread[Thread.activeCount()];
  Thread.enumerate(tarray4);
  for (  Thread t : tarray4) {
    if (t != null) {
      assertTrue(!GuardProxyCatalog.PROXY_CREATOR_THREAD_NAME.equals(t.getName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-10 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInvocationBlocking7() throws Exception {
  Dictionary<String,Object> c1=new Hashtable<String,Object>();
  c1.put(Constants.SERVICE_PID,"foobar");
  c1.put("service.guard","(objectClass=" + TestServiceAPI3.class.getName() + ")");
  c1.put("foo()","a");
  c1.put("bar","b");
  c1.put("*","*");
  BundleContext bc=mockConfigAdminBundleContext(c1);
  final Object proxy=testCreateProxy(bc,new Class[]{TestServiceAPI3.class},new TestService3());
  Subject s1=new Subject();
  Subject.doAs(s1,new PrivilegedAction(){
    @Override public Object run(){
      TestServiceAPI3 obj=(TestServiceAPI3)proxy;
      assertEquals("Should have allowed this invocation for any (or no) role",-7,obj.foo(7));
      try {
        obj.foo();
        fail("Should have been blocked");
      }
 catch (      SecurityException se) {
      }
      try {
        obj.bar();
        fail("Should have been blocked");
      }
 catch (      SecurityException se) {
      }
      return null;
    }
  }
);
  Subject s2=new Subject();
  s2.getPrincipals().add(new RolePrincipal("a"));
  s2.getPrincipals().add(new RolePrincipal("b"));
  s2.getPrincipals().add(new RolePrincipal("d"));
  Subject.doAs(s2,new PrivilegedAction(){
    @Override public Object run(){
      TestServiceAPI3 obj=(TestServiceAPI3)proxy;
      assertEquals(42,obj.foo());
      assertEquals(99,obj.bar());
      assertEquals(-32767,obj.foo(32767));
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGuardProxyCatalog() throws Exception {
  Bundle b=EasyMock.createMock(Bundle.class);
  EasyMock.expect(b.getBundleId()).andReturn(9823L).anyTimes();
  EasyMock.replay(b);
  BundleContext bc=EasyMock.createNiceMock(BundleContext.class);
  EasyMock.expect(bc.getBundle()).andReturn(b).anyTimes();
  bc.addServiceListener(EasyMock.isA(ServiceListener.class));
  EasyMock.expectLastCall().once();
  String caFilter="(&(objectClass=org.osgi.service.cm.ConfigurationAdmin)" + "(!(" + GuardProxyCatalog.PROXY_SERVICE_KEY + "=*)))";
  EasyMock.expect(bc.createFilter(caFilter)).andReturn(FrameworkUtil.createFilter(caFilter)).anyTimes();
  String pmFilter="(&(objectClass=org.apache.aries.proxy.ProxyManager)" + "(!(" + GuardProxyCatalog.PROXY_SERVICE_KEY + "=*)))";
  EasyMock.expect(bc.createFilter(pmFilter)).andReturn(FrameworkUtil.createFilter(pmFilter)).anyTimes();
  EasyMock.replay(bc);
  GuardProxyCatalog gpc=new GuardProxyCatalog(bc);
  assertTrue("Service Tracker for ConfigAdmin should be opened",gpc.configAdminTracker.getTrackingCount() != -1);
  assertTrue("Service Tracker for ProxyManager should be opened",gpc.proxyManagerTracker.getTrackingCount() != -1);
  EasyMock.verify(bc);
  EasyMock.reset(bc);
  bc.removeServiceListener(EasyMock.isA(ServiceListener.class));
  EasyMock.expectLastCall().once();
  EasyMock.replay(bc);
  gpc.close();
  assertEquals("Service Tracker for ConfigAdmin should be closed",-1,gpc.configAdminTracker.getTrackingCount());
  assertEquals("Service Tracker for ProxyManager should be closed",-1,gpc.proxyManagerTracker.getTrackingCount());
  EasyMock.verify(bc);
}

</code></pre>

<br>
<pre class="type-6 type-14 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInvocationBlocking4() throws Exception {
  BundleContext bc=mockConfigAdminBundleContext();
  final Object proxy=testCreateProxy(bc,new Class[]{TestServiceAPI.class,TestObjectWithoutInterface.class},new CombinedTestService());
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("b"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      assertEquals("Doing it",((TestServiceAPI)proxy).doit());
      if (!runningUnderCoverage) {
        assertEquals(42L,((TestObjectWithoutInterface)proxy).compute(-42L));
        assertEquals(-44L,((TestObjectWithoutInterface)proxy).compute(44L));
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testInvocationBlocking5() throws Exception {
  Dictionary<String,Object> c1=new Hashtable<String,Object>();
  c1.put(Constants.SERVICE_PID,"foobar");
  c1.put("service.guard","(objectClass=" + TestServiceAPI.class.getName() + ")");
  c1.put("doit","a,b");
  BundleContext bc=mockConfigAdminBundleContext(c1);
  final Object proxy=testCreateProxy(bc,new Class[]{TestServiceAPI2.class},new TestServiceAPI2(){
    @Override public String doit(    String s){
      return s.toUpperCase();
    }
  }
);
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("c"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      assertEquals("The invocation under role 'c' should be ok, as there are no rules specified " + "for this service at all.","HELLO",((TestServiceAPI2)proxy).doit("hello"));
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.service.guard.impl.GuardingEventHookTest </h4><pre class="type-6 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testEventHookEvents() throws Exception {
  BundleContext frameworkBC=mockBundleContext(0L);
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put("service.guard","(service.id=*)");
  BundleContext hookBC=mockConfigAdminBundleContext(config);
  GuardProxyCatalog gpc=new GuardProxyCatalog(hookBC);
  Filter serviceFilter=FrameworkUtil.createFilter("(foo=bar)");
  GuardingEventHook geh=new GuardingEventHook(hookBC,gpc,serviceFilter);
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(Constants.SERVICE_ID,13L);
  ServiceReference<?> sref=mockServiceReference(props);
  BundleContext client1BC=mockBundleContext(123L);
  Map<BundleContext,Collection<ListenerInfo>> listeners=new HashMap<BundleContext,Collection<ListenerInfo>>();
  listeners.put(client1BC,Collections.<ListenerInfo>emptyList());
  assertEquals("Precondition",0,gpc.proxyMap.size());
  geh.event(new ServiceEvent(ServiceEvent.REGISTERED,sref),listeners);
  assertEquals("No proxy should have been created because the service doesn't match the filter",0,gpc.proxyMap.size());
  assertEquals("Nothing should have been removed from the listeners",1,listeners.size());
  long service2ID=887L;
  Dictionary<String,Object> props2=new Hashtable<String,Object>();
  props2.put(Constants.SERVICE_ID,service2ID);
  props2.put("a","b");
  props2.put("foo","bar");
  ServiceReference<?> sref2=mockServiceReference(props2);
  ServiceEvent se2=new ServiceEvent(ServiceEvent.REGISTERED,sref2);
  Map<BundleContext,Collection<ListenerInfo>> listeners2=new Hashtable<BundleContext,Collection<ListenerInfo>>();
  listeners2.put(frameworkBC,Collections.<ListenerInfo>emptyList());
  listeners2.put(hookBC,Collections.<ListenerInfo>emptyList());
  geh.event(se2,listeners2);
  assertEquals("No proxies to be created for the hook bundle or the system bundle",0,gpc.proxyMap.size());
  assertEquals("Nothing should have been removed from the listeners",2,listeners2.size());
  Map<BundleContext,Collection<ListenerInfo>> listeners3=new HashMap<BundleContext,Collection<ListenerInfo>>();
  listeners3.put(client1BC,Collections.<ListenerInfo>emptyList());
  geh.event(se2,listeners3);
  assertEquals("The service should be hidden from these listeners",0,listeners3.size());
  assertEquals("Proxy should have been created for this client",1,gpc.proxyMap.size());
  assertEquals(new Long(service2ID),gpc.proxyMap.keySet().iterator().next());
  props2.put("a","c");
  Map<BundleContext,Collection<ListenerInfo>> listeners4=new HashMap<BundleContext,Collection<ListenerInfo>>();
  BundleContext client2BC=mockBundleContext(11);
  listeners4.put(client2BC,Collections.<ListenerInfo>emptyList());
  listeners4.put(client1BC,Collections.<ListenerInfo>emptyList());
  geh.event(new ServiceEvent(ServiceEvent.MODIFIED,sref2),listeners4);
  assertEquals("The service should be hidden from these listeners",0,listeners4.size());
  assertEquals("There should not be an additional proxy for client 2",1,gpc.proxyMap.size());
  assertNotNull(gpc.proxyMap.get(service2ID));
  long service3ID=1L;
  Dictionary<String,Object> props3=new Hashtable<String,Object>();
  props3.put(Constants.SERVICE_ID,service3ID);
  props3.put("foo","bar");
  ServiceReference<?> sref3=mockServiceReference(props3);
  Map<BundleContext,Collection<ListenerInfo>> listeners5=new HashMap<BundleContext,Collection<ListenerInfo>>();
  listeners5.put(client1BC,Collections.<ListenerInfo>emptyList());
  listeners5.put(client1BC,Collections.<ListenerInfo>emptyList());
  geh.event(new ServiceEvent(ServiceEvent.REGISTERED,sref3),listeners5);
  assertEquals("There should be an additional procy for client1 to the new service",2,gpc.proxyMap.size());
  assertEquals("The service should be hidden from these listeners",0,listeners5.size());
  assertNotNull(gpc.proxyMap.get(service2ID));
  assertNotNull(gpc.proxyMap.get(service3ID));
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testEventHookProxyEvents() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put("service.guard","(service.id=*)");
  BundleContext hookBC=mockConfigAdminBundleContext(config);
  GuardProxyCatalog gpc=new GuardProxyCatalog(hookBC);
  Filter serviceFilter=FrameworkUtil.createFilter("(service.id=*)");
  GuardingEventHook geh=new GuardingEventHook(hookBC,gpc,serviceFilter);
  BundleContext client1BC=mockBundleContext(123L);
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(Constants.SERVICE_ID,13L);
  props.put(GuardProxyCatalog.PROXY_SERVICE_KEY,Boolean.TRUE);
  ServiceReference<?> sref=mockServiceReference(props);
  Map<BundleContext,Collection<ListenerInfo>> listeners=new HashMap<BundleContext,Collection<ListenerInfo>>();
  listeners.put(client1BC,Collections.<ListenerInfo>emptyList());
  assertEquals("Precondition",0,gpc.proxyMap.size());
  geh.event(new ServiceEvent(ServiceEvent.REGISTERED,sref),listeners);
  assertEquals("No changes expected for the proxy map.",0,gpc.proxyMap.size());
  assertEquals("The event should be delivered to the client",1,listeners.size());
  Map<BundleContext,Collection<ListenerInfo>> listeners2=new HashMap<BundleContext,Collection<ListenerInfo>>();
  listeners2.put(mockBundleContext(51L),Collections.<ListenerInfo>emptyList());
  geh.event(new ServiceEvent(ServiceEvent.REGISTERED,sref),listeners2);
  assertEquals("No changes expected for the proxy map.",0,gpc.proxyMap.size());
  assertEquals("The event should be delivered to the client",1,listeners2.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.service.guard.impl.GuardingFindHookTest </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testFindHook() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put("service.guard","(|(moo=foo)(foo=*))");
  BundleContext hookBC=mockConfigAdminBundleContext(config);
  GuardProxyCatalog gpc=new GuardProxyCatalog(hookBC);
  Filter serviceFilter=FrameworkUtil.createFilter("(foo=*)");
  GuardingFindHook gfh=new GuardingFindHook(hookBC,gpc,serviceFilter);
  BundleContext clientBC=mockBundleContext(31L);
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(Constants.SERVICE_ID,16L);
  props.put("moo","foo");
  ServiceReference<?> sref=mockServiceReference(props);
  Collection<ServiceReference<?>> refs=new ArrayList<ServiceReference<?>>();
  refs.add(sref);
  assertEquals("Precondition",0,gpc.proxyMap.size());
  gfh.find(clientBC,null,null,true,refs);
  assertEquals("The service doesn't match the filter so should have no effect",0,gpc.proxyMap.size());
  assertEquals("The service doesn't match the filter so should be presented to the client",Collections.singletonList(sref),refs);
  long service2ID=17L;
  Dictionary<String,Object> props2=new Hashtable<String,Object>();
  props2.put(Constants.SERVICE_ID,service2ID);
  props2.put("foo",new Object());
  ServiceReference<?> sref2=mockServiceReference(props2);
  Collection<ServiceReference<?>> refs2=new ArrayList<ServiceReference<?>>();
  refs2.add(sref2);
  gfh.find(clientBC,null,null,true,refs2);
  assertEquals("The service should be hidden from the client",0,refs2.size());
  assertEquals("The service should have caused a proxy creation",1,gpc.proxyMap.size());
  assertEquals("A proxy creation job should have been created",1,gpc.createProxyQueue.size());
  assertEquals(sref2.getProperty(Constants.SERVICE_ID),gpc.proxyMap.keySet().iterator().next());
  Collection<ServiceReference<?>> refs3=new ArrayList<ServiceReference<?>>();
  refs3.add(sref2);
  gfh.find(hookBC,null,null,true,refs3);
  assertEquals("The service should not be hidden from the hook bundle",Collections.singletonList(sref2),refs3);
  assertEquals("No proxy creation caused in this case",1,gpc.proxyMap.size());
  assertEquals("No change expected",sref2.getProperty(Constants.SERVICE_ID),gpc.proxyMap.keySet().iterator().next());
  gfh.find(mockBundleContext(0L),null,null,true,refs3);
  assertEquals("The service should not be hidden from the framework bundle",Collections.singletonList(sref2),refs3);
  assertEquals("No proxy creation caused in this case",1,gpc.proxyMap.size());
  assertEquals("No change expected",sref2.getProperty(Constants.SERVICE_ID),gpc.proxyMap.keySet().iterator().next());
  gpc.createProxyQueue.clear();
  gfh.find(clientBC,null,null,true,refs3);
  assertEquals("The service should be hidden from the client",0,refs3.size());
  assertEquals("There is already a proxy for this client, no need for an additional one",1,gpc.proxyMap.size());
  assertEquals("No additional jobs should have been scheduled",0,gpc.createProxyQueue.size());
  assertEquals("No change expected",sref2.getProperty(Constants.SERVICE_ID),gpc.proxyMap.keySet().iterator().next());
  Collection<ServiceReference<?>> refs4=new ArrayList<ServiceReference<?>>();
  refs4.add(sref2);
  BundleContext client2BC=mockBundleContext(32768L);
  gfh.find(client2BC,null,null,true,refs4);
  assertEquals("The service should be hidden for this new client",0,refs4.size());
  assertEquals("No proxy creation job should have been created",0,gpc.createProxyQueue.size());
  assertEquals("No proxy creation caused in this case",1,gpc.proxyMap.size());
  assertEquals("No change expected",sref2.getProperty(Constants.SERVICE_ID),gpc.proxyMap.keySet().iterator().next());
}

</code></pre>

<br>
<pre class="type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("unchecked") @Test public void testFindHookProxyServices() throws Exception {
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put("service.guard","(service.id=*)");
  BundleContext hookBC=mockConfigAdminBundleContext(config);
  GuardProxyCatalog gpc=new GuardProxyCatalog(hookBC);
  Filter serviceFilter=FrameworkUtil.createFilter("(service.id=*)");
  GuardingFindHook gfh=new GuardingFindHook(hookBC,gpc,serviceFilter);
  BundleContext clientBC=mockBundleContext(31L);
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put(Constants.SERVICE_ID,16L);
  props.put(GuardProxyCatalog.PROXY_SERVICE_KEY,Boolean.TRUE);
  ServiceReference<?> sref=mockServiceReference(props);
  Collection<ServiceReference<?>> refs=new ArrayList<ServiceReference<?>>();
  refs.add(sref);
  gfh.find(clientBC,null,null,false,refs);
  assertEquals("No proxy should have been created for the proxy find",0,gpc.proxyMap.size());
  assertEquals("As the proxy is for this bundle is should be visible and remain on the list",Collections.singletonList(sref),refs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.service.guard.tools.ACLConfigurationParserTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseRoles(){
  assertEquals(Arrays.asList("some_role"),ACLConfigurationParser.parseRoles(" some_role   "));
  assertEquals(Arrays.asList("a","b","C"),ACLConfigurationParser.parseRoles("a,b,C"));
  assertEquals(Collections.emptyList(),ACLConfigurationParser.parseRoles("# test comment"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRolesForInvocation(){
  Dictionary<String,Object> config=new Hashtable<String,Object>();
  config.put("foo","r1, r2");
  config.put("bar(java.lang.String, int)[/aa/,/42/]","ra");
  config.put("bar(java.lang.String, int)[/bb/,/42/]","rb");
  config.put("bar(java.lang.String, int)[\"cc\", \"17\"]","rc");
  config.put("bar(java.lang.String, int)","rd");
  config.put("bar(java.lang.String)","re");
  config.put("bar","rf");
  config.put("ba*","rg #Wildcard");
  List<String> roles1=new ArrayList<String>();
  assertEquals(Specificity.NAME_MATCH,ACLConfigurationParser.getRolesForInvocation("foo",new Object[]{},new String[]{},config,roles1));
  assertEquals(Arrays.asList("r1","r2"),roles1);
  List<String> roles2=new ArrayList<String>();
  assertEquals(Specificity.NAME_MATCH,ACLConfigurationParser.getRolesForInvocation("foo",new Object[]{"test"},new String[]{"java.lang.String"},config,roles2));
  assertEquals(Arrays.asList("r1","r2"),roles2);
  List<String> roles3=new ArrayList<String>();
  assertEquals(Specificity.NO_MATCH,ACLConfigurationParser.getRolesForInvocation("test",new Object[]{},new String[]{},config,roles3));
  assertEquals(0,roles3.size());
  List<String> roles4=new ArrayList<String>();
  assertEquals(Specificity.ARGUMENT_MATCH,ACLConfigurationParser.getRolesForInvocation("bar",new Object[]{"aa",42},new String[]{"java.lang.String","int"},config,roles4));
  assertEquals(Arrays.asList("ra"),roles4);
  List<String> roles5=new ArrayList<String>();
  assertEquals(Specificity.ARGUMENT_MATCH,ACLConfigurationParser.getRolesForInvocation("bar",new Object[]{"bb",42},new String[]{"java.lang.String","int"},config,roles5));
  assertEquals(Arrays.asList("rb"),roles5);
  List<String> roles6=new ArrayList<String>();
  assertEquals(Specificity.ARGUMENT_MATCH,ACLConfigurationParser.getRolesForInvocation("bar",new Object[]{"cc",17},new String[]{"java.lang.String","int"},config,roles6));
  assertEquals(Arrays.asList("rc"),roles6);
  List<String> roles7=new ArrayList<String>();
  assertEquals(Specificity.SIGNATURE_MATCH,ACLConfigurationParser.getRolesForInvocation("bar",new Object[]{"aaa",42},new String[]{"java.lang.String","int"},config,roles7));
  assertEquals(Arrays.asList("rd"),roles7);
  List<String> roles8=new ArrayList<String>();
  assertEquals(Specificity.SIGNATURE_MATCH,ACLConfigurationParser.getRolesForInvocation("bar",new Object[]{"aa"},new String[]{"java.lang.String"},config,roles8));
  assertEquals(Arrays.asList("re"),roles8);
  List<String> roles9=new ArrayList<String>();
  assertEquals(Specificity.NAME_MATCH,ACLConfigurationParser.getRolesForInvocation("bar",new Object[]{42},new String[]{"int"},config,roles9));
  assertEquals(Arrays.asList("rf"),roles9);
  List<String> roles10=new ArrayList<String>();
  assertEquals(Specificity.WILDCARD_MATCH,ACLConfigurationParser.getRolesForInvocation("barr",new Object[]{42},new String[]{"int"},config,roles10));
  assertEquals(Arrays.asList("rg"),roles10);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.completer.ArgumentCompleterTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompleteOptions() throws Exception {
  CommandSession session=new DummyCommandSession();
  Completer comp=new ArgumentCompleter(session,new MyFunction(),"my:action");
  assertEquals(Arrays.asList("--check","--foo","--help","--integer","--string","-c","-f","-i","-s"),complete(comp,"action -"));
  assertEquals(Arrays.asList(),complete(comp,"action --foo "));
  assertEquals(Arrays.asList("action "),complete(comp,"acti"));
  assertEquals(Arrays.asList("my:action "),complete(comp,"my:ac"));
  assertEquals(Arrays.asList("--foo "),complete(comp,"action --f"));
  assertEquals(Arrays.asList("--help "),complete(comp,"action --h"));
  assertEquals(Arrays.asList("-c "),complete(comp,"action -c"));
  assertEquals(Arrays.asList("--check "),complete(comp,"action -f 2 --c"));
  assertEquals(Arrays.asList("foo1 "),complete(comp,"action -f 2 --check foo1"));
  assertEquals(Arrays.asList("bar1","bar2"),complete(comp,"action -f 2 --check foo1 "));
  assertEquals(Arrays.asList("one","two"),complete(comp,"action -s "));
  assertEquals(Arrays.asList("one","two"),complete(comp,"action --string "));
  assertEquals(Arrays.asList("two "),complete(comp,"action -s t"));
  assertEquals(Arrays.asList("1","2"),complete(comp,"action -i "));
  assertEquals(Arrays.asList("1","2"),complete(comp,"action --integer "));
  assertEquals(Arrays.asList("2 "),complete(comp,"action -i 2"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParser5() throws Exception {
  Parser parser=new Parser("echo foo ; cat bar | ta reta",24);
  List<List<List<String>>> p=parser.program();
  assertEquals(1,parser.c0);
  assertEquals(1,parser.c1);
  assertEquals(1,parser.c2);
  assertEquals(0,parser.c3);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParser3() throws Exception {
  Parser parser=new Parser("echo foo ; cat bar | ta",22);
  List<List<List<String>>> p=parser.program();
  assertEquals(1,parser.c0);
  assertEquals(1,parser.c1);
  assertEquals(0,parser.c2);
  assertEquals(1,parser.c3);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParser4() throws Exception {
  Parser parser=new Parser("echo foo ; cat bar | ta reta",27);
  List<List<List<String>>> p=parser.program();
  assertEquals(1,parser.c0);
  assertEquals(1,parser.c1);
  assertEquals(1,parser.c2);
  assertEquals(3,parser.c3);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParser1() throws Exception {
  Parser parser=new Parser("echo foo | cat bar ; ta",23);
  List<List<List<String>>> p=parser.program();
  assertEquals(1,parser.c0);
  assertEquals(0,parser.c1);
  assertEquals(0,parser.c2);
  assertEquals(2,parser.c3);
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParser2() throws Exception {
  Parser parser=new Parser("echo foo ; cat bar | ta",23);
  List<List<List<String>>> p=parser.program();
  assertEquals(1,parser.c0);
  assertEquals(1,parser.c1);
  assertEquals(0,parser.c2);
  assertEquals(2,parser.c3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.completer.BooleanCompleterTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompleteArgumnets() throws Exception {
  CommandSession session=new DummyCommandSession();
  Completer comp=new ArgumentCompleter(session,new SimpleCommand(MyAction.class),"my:action");
  assertEquals(Arrays.asList("true "),complete(comp,"action t"));
  assertEquals(Arrays.asList("false "),complete(comp,"action f"));
  assertEquals(Arrays.asList("true "),complete(comp,"action false t"));
  assertEquals(Arrays.asList("false "),complete(comp,"action true f"));
  assertEquals(Arrays.asList(),complete(comp,"action c"));
  assertEquals(Arrays.asList(),complete(comp,"action true true a"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.completer.CompleterValuesTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompleteArgumnets() throws Exception {
  CommandSession session=new DummyCommandSession();
  Completer comp=new ArgumentCompleter(session,new SimpleCommand(MyAction.class),"my:action");
  assertEquals(Arrays.asList("a1","a2","a3"),complete(comp,"action a"));
  assertEquals(Arrays.asList("b4","b5"),complete(comp,"action b"));
  assertEquals(Arrays.asList("c2","c3"),complete(comp,"action a1 c"));
  assertEquals(Arrays.asList("d5","d6","d7"),complete(comp,"action b4 d"));
  assertEquals(Arrays.asList(),complete(comp,"action c"));
  assertEquals(Arrays.asList(),complete(comp,"action a1 d5 a"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.completer.CompletionTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSubShellCompletion() throws Exception {
  Context context=new Context();
  context.set("SCOPE","*");
  context.set(SessionProperties.COMPLETION_MODE,"subshell");
  CommandSessionHolder.setSession(context.getSession());
  context.addCommand("*",new SimpleSubShell("foo"),"foo");
  context.addCommand("*",new SimpleCommand(ExitAction.class),"exit");
  context.addCommand("foo",new SimpleCommand(MyAction.class),"my-action");
  context.addCommand("foo",new SimpleCommand(MyActionTwoArguments.class),"one-action");
  context.addCommand("bar",new SimpleCommand(MyAction.class),"one-action");
  context.addCommand("bar",new SimpleCommand(MyActionTwoArguments.class),"another");
  Completer comp=new CommandsCompleter(context.getSession());
  context.execute("foo");
  assertEquals(Arrays.asList("my-action "),complete(comp,"my"));
  assertEquals(Arrays.asList("exit ","my-action ","one-action "),complete(comp,""));
  assertEquals(Arrays.asList(),complete(comp,"an"));
  assertEquals(Arrays.asList("--check","--foo","--help","--integer","--string"),complete(comp,"my-action --"));
  assertEquals(Arrays.asList("--dummy","--help"),complete(comp,"one-action --"));
  context.execute("exit");
  assertEquals(Arrays.asList(),complete(comp,"my"));
  assertEquals(Arrays.asList("exit ","foo "),complete(comp,""));
  assertEquals(Arrays.asList(),complete(comp,"an"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGlobalCompletion() throws Exception {
  Context context=new Context();
  context.set("SCOPE","*");
  context.set(SessionProperties.COMPLETION_MODE,"global");
  CommandSessionHolder.setSession(context.getSession());
  context.addCommand("*",new SimpleSubShell("foo"),"foo");
  context.addCommand("*",new SimpleCommand(ExitAction.class),"exit");
  context.addCommand("foo",new SimpleCommand(MyAction.class),"my-action");
  context.addCommand("foo",new SimpleCommand(MyActionTwoArguments.class),"one-action");
  context.addCommand("bar",new SimpleCommand(MyAction.class),"one-action");
  context.addCommand("bar",new SimpleCommand(MyActionTwoArguments.class),"another");
  Completer comp=new CommandsCompleter(context.getSession());
  context.execute("foo");
  assertEquals(Arrays.asList("my-action "),complete(comp,"my"));
  assertEquals(Arrays.asList("*:exit","*:foo","another","bar:another","bar:one-action","exit","foo","foo:my-action","foo:one-action","my-action","one-action","one-action"),complete(comp,""));
  assertEquals(Arrays.asList("another "),complete(comp,"an"));
  assertEquals(Arrays.asList("--check","--foo","--help","--integer","--string"),complete(comp,"my-action --"));
  assertEquals(Arrays.asList("--dummy","--help"),complete(comp,"one-action --"));
  context.execute("exit");
  assertEquals(Arrays.asList("my-action "),complete(comp,"my"));
  assertEquals(Arrays.asList("*:exit","*:foo","another","bar:another","bar:one-action","exit","foo","foo:my-action","foo:one-action","my-action","one-action","one-action"),complete(comp,""));
  assertEquals(Arrays.asList("another "),complete(comp,"an"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFirstCompletion() throws Exception {
  Context context=new Context();
  context.set("SCOPE","*");
  context.set(SessionProperties.COMPLETION_MODE,"first");
  CommandSessionHolder.setSession(context.getSession());
  context.addCommand("*",new SimpleSubShell("foo"),"foo");
  context.addCommand("*",new SimpleCommand(ExitAction.class),"exit");
  context.addCommand("foo",new SimpleCommand(MyAction.class),"my-action");
  context.addCommand("foo",new SimpleCommand(MyActionTwoArguments.class),"one-action");
  context.addCommand("bar",new SimpleCommand(MyAction.class),"one-action");
  context.addCommand("bar",new SimpleCommand(MyActionTwoArguments.class),"another");
  Completer comp=new CommandsCompleter(context.getSession());
  context.execute("foo");
  assertEquals(Arrays.asList("my-action "),complete(comp,"my"));
  assertEquals(Arrays.asList("my-action ","one-action "),complete(comp,""));
  assertEquals(Arrays.asList("another "),complete(comp,"an"));
  assertEquals(Arrays.asList("--check","--foo","--help","--integer","--string"),complete(comp,"my-action --"));
  assertEquals(Arrays.asList("--dummy","--help"),complete(comp,"one-action --"));
  context.execute("exit");
  assertEquals(Arrays.asList("my-action "),complete(comp,"my"));
  assertEquals(Arrays.asList("*:exit","*:foo","another","bar:another","bar:one-action","exit","foo","foo:my-action","foo:one-action","my-action","one-action","one-action"),complete(comp,""));
  assertEquals(Arrays.asList("another "),complete(comp,"an"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.completer.FileCompleterTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompleteArgumnets() throws Exception {
  CommandSession session=new DummyCommandSession();
  Completer comp=new ArgumentCompleter(session,new SimpleCommand(MyAction.class),"my:action");
  assertEquals(Arrays.asList("src" + File.separator),complete(comp,"action s"));
  assertEquals(Arrays.asList("main" + File.separator),complete(comp,"action src/m"));
  assertEquals(Arrays.asList("java" + File.separator),complete(comp,"action src/main/j"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.console.impl.jline.ConsoleImplTest </h4><pre class="type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegateSession() throws Exception {
  DelegateSession ds=new DelegateSession();
  ds.put("a","b");
  assertEquals("b",ds.get("a"));
  TestSession ts=new TestSession();
  assertNull("Precondition",ts.lastInvoked);
  ds.setDelegate(ts);
  assertEquals("put(a,b)",ts.lastInvoked);
  ds.put("c","d");
  assertEquals("put(c,d)",ts.lastInvoked);
  ds.execute("hello 1234");
  assertEquals("execute(hello 1234)",ts.lastInvoked);
  ds.close();
  assertEquals("close",ts.lastInvoked);
  ds.getKeyboard();
  assertEquals("getKeyboard",ts.lastInvoked);
  ds.getConsole();
  assertEquals("getConsole",ts.lastInvoked);
  ds.get("xyz");
  assertEquals("get(xyz)",ts.lastInvoked);
  ds.format("foo",12);
  assertEquals("format(foo,12)",ts.lastInvoked);
  ds.convert(TestSession.class,"a string");
  assertEquals("convert(TestSession,a string)",ts.lastInvoked);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-11 type-5 type-7 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConsoleImpl() throws Exception {
  ServiceReference<?> cmRef=EasyMock.createMock(ServiceReference.class);
  EasyMock.expect(cmRef.getProperty(CommandProcessor.COMMAND_SCOPE)).andReturn("myscope").anyTimes();
  EasyMock.expect(cmRef.getProperty(CommandProcessor.COMMAND_FUNCTION)).andReturn("myfunction").anyTimes();
  EasyMock.replay(cmRef);
  ServiceReference<?>[] cmRefs=new ServiceReference[]{cmRef};
  BundleContext bc=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(bc.getServiceReference((Class<?>)EasyMock.anyObject())).andReturn(null).anyTimes();
  EasyMock.expect(bc.getService((ServiceReference<?>)EasyMock.anyObject())).andReturn(null).anyTimes();
  bc.addServiceListener(EasyMock.isA(ServiceListener.class),EasyMock.isA(String.class));
  EasyMock.expectLastCall().anyTimes();
  EasyMock.expect(bc.getServiceReferences((String)null,"(&(osgi.command.scope=*)(osgi.command.function=*)" + "(|(org.apache.karaf.service.guard.roles=myrole)(!(org.apache.karaf.service.guard.roles=*))))")).andReturn(cmRefs).anyTimes();
  EasyMock.expect(bc.getServiceReferences(Converter.class.getName(),null)).andReturn(null).anyTimes();
  EasyMock.expect(bc.getServiceReferences(CommandSessionListener.class.getName(),null)).andReturn(null).anyTimes();
  EasyMock.expect(bc.createFilter(EasyMock.isA(String.class))).andAnswer(new IAnswer<Filter>(){
    @Override public Filter answer() throws Throwable {
      return FrameworkUtil.createFilter((String)EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  EasyMock.replay(bc);
  final ConsoleImpl console=new ConsoleImpl(null,new ThreadIOImpl(),System.in,System.out,System.err,null,"UTF-8",null,bc,true);
  assertTrue(console.session instanceof DelegateSession);
  console.session.put("foo","bar");
  final DelegateSession ds=(DelegateSession)console.session;
  assertNull("Precondition",ds.delegate);
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("myrole"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      SecuredCommandProcessorImpl secCP=console.createSecuredCommandProcessor();
      assertNotNull(ds.delegate);
      assertEquals("Attributes set before the delegate was set should have been transferred","bar",ds.get("foo"));
      assertEquals("Attributes set before the delegate was set should have been transferred","bar",ds.delegate.get("foo"));
      assertSame(System.out,ds.delegate.getConsole());
      assertSame(System.out,ds.getConsole());
      assertTrue(secCP.getCommands().contains("myscope:myfunction"));
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.impl.console.parsing.ParsingTest </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultParser(){
  String command=" foo  bar (a +  b) ; another command ";
  String subCmd=" foo  bar (a +  b) ";
  DefaultParser parser=new DefaultParser();
  CommandLine line=parser.parse(null,command,command.length());
  assertEquals(3,line.getArguments().length);
  assertEquals("foo",line.getArguments()[0]);
  assertEquals("bar",line.getArguments()[1]);
  assertEquals("(a +  b)",line.getArguments()[2]);
  assertEquals(subCmd,line.getBuffer());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCommandLineParserMultiLine(){
  SessionFactoryImpl sessionFactory=new SessionFactoryImpl(new ThreadIOImpl());
  ManagerImpl manager=new ManagerImpl(sessionFactory,sessionFactory);
  sessionFactory.getRegistry().register(new ActionCommand(manager,FooCommand.class));
  sessionFactory.getRegistry().register(new ActionCommand(manager,AnotherCommand.class));
  sessionFactory.getRegistry().register(new CustomParser());
  Session session=new HeadlessSessionImpl(sessionFactory,sessionFactory.getCommandProcessor(),new ByteArrayInputStream(new byte[0]),new PrintStream(new ByteArrayOutputStream()),new PrintStream(new ByteArrayOutputStream()));
  String parsed=CommandLineParser.parse(session,"echo a\necho b");
  assertEquals("echo a\necho b",parsed);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCommandLineParser(){
  SessionFactoryImpl sessionFactory=new SessionFactoryImpl(new ThreadIOImpl());
  ManagerImpl manager=new ManagerImpl(sessionFactory,sessionFactory);
  sessionFactory.getRegistry().register(new ActionCommand(manager,FooCommand.class));
  sessionFactory.getRegistry().register(new ActionCommand(manager,AnotherCommand.class));
  sessionFactory.getRegistry().register(new CustomParser());
  Session session=new HeadlessSessionImpl(sessionFactory,sessionFactory.getCommandProcessor(),new ByteArrayInputStream(new byte[0]),new PrintStream(new ByteArrayOutputStream()),new PrintStream(new ByteArrayOutputStream()));
  String parsed=CommandLineParser.parse(session," foo bar (a + b); another   command with spaces ");
  assertEquals("foo bar (a + b) ; another \"command with spaces\"",parsed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.security.impl.SecuredCommandConfigTransformerTest </h4><pre class="type-14 type-10 type-3 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransformation() throws Exception {
  Dictionary<String,Object> props=new Hashtable<String,Object>();
  props.put("foo","a,b,c");
  props.put("bar[/.*[a]+*/]","d");
  props.put("bar","e");
  props.put("zar[/.*HiThere*/]","f");
  props.put("service.pid",SecuredCommandConfigTransformer.PROXY_COMMAND_ACL_PID_PREFIX + "abc");
  Configuration commandConfig=mockConfiguration(props);
  Dictionary<String,Object> props2=new Hashtable<String,Object>();
  props2.put("xxx","yyy");
  props2.put("service.pid",SecuredCommandConfigTransformer.PROXY_COMMAND_ACL_PID_PREFIX + "xyz.123");
  Configuration commandConfig2=mockConfiguration(props2);
  Dictionary<String,Object> props3=new Hashtable<String,Object>();
  props3.put("test","toast");
  props3.put("service.pid","xyz.123");
  Configuration otherConfig=mockConfiguration(props3);
  final Map<String,Configuration> configurations=new HashMap<String,Configuration>();
  ConfigurationAdmin ca=EasyMock.createMock(ConfigurationAdmin.class);
  EasyMock.expect(ca.listConfigurations("(service.pid=" + SecuredCommandConfigTransformer.PROXY_COMMAND_ACL_PID_PREFIX + "*)")).andReturn(new Configuration[]{commandConfig,commandConfig2,otherConfig}).anyTimes();
  EasyMock.expect(ca.getConfiguration(EasyMock.isA(String.class),EasyMock.anyString())).andAnswer(new IAnswer<Configuration>(){
    @Override public Configuration answer() throws Throwable {
      String pid=(String)EasyMock.getCurrentArguments()[0];
      Configuration c=configurations.get(pid);
      if (c == null) {
        c=EasyMock.createMock(Configuration.class);
        Dictionary<String,Object> m=new Hashtable<String,Object>();
        if ("org.apache.karaf.service.acl.command.abc.foo".equals(pid)) {
          m.put("service.guard","(&(osgi.command.scope=abc)(osgi.command.function=foo))");
          m.put("execute","a,b,c");
          m.put("foo","a,b,c");
        }
 else         if ("org.apache.karaf.service.acl.command.abc.bar".equals(pid)) {
          m.put("service.guard","(&(osgi.command.scope=abc)(osgi.command.function=bar))");
          m.put("execute[/.*/,/.*[a]+*/]","d");
          m.put("execute","e");
          m.put("bar[/.*[a]+*/]","d");
          m.put("bar","e");
        }
 else         if ("org.apache.karaf.service.acl.command.abc.zar".equals(pid)) {
          m.put("service.guard","(&(osgi.command.scope=abc)(osgi.command.function=zar))");
          m.put("execute[/.*/,/.*HiThere*/]","f");
          m.put("zar[/.*HiThere*/]","f");
        }
 else {
          fail("Unexpected PID: " + pid);
        }
        m.put("*","*");
        c.update(m);
        EasyMock.expectLastCall().once();
        EasyMock.replay(c);
        configurations.put(pid,c);
      }
      return c;
    }
  }
).anyTimes();
  EasyMock.replay(ca);
  SecuredCommandConfigTransformer scct=new SecuredCommandConfigTransformer();
  scct.setConfigAdmin(ca);
  scct.init();
  assertEquals(3,configurations.size());
  boolean foundFoo=false;
  boolean foundBar=false;
  boolean foundZar=false;
  for (  Map.Entry<String,Configuration> entry : configurations.entrySet()) {
    Configuration c=entry.getValue();
    EasyMock.verify(c);
    if ("org.apache.karaf.service.acl.command.abc.foo".equals(entry.getKey())) {
      foundFoo=true;
    }
 else     if ("org.apache.karaf.service.acl.command.abc.bar".equals(entry.getKey())) {
      foundBar=true;
    }
 else     if ("org.apache.karaf.service.acl.command.abc.zar".equals(entry.getKey())) {
      foundZar=true;
    }
  }
  assertTrue(foundFoo);
  assertTrue(foundBar);
  assertTrue(foundZar);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConfigurationEventAdded() throws Exception {
  String testPid=SecuredCommandConfigTransformer.PROXY_COMMAND_ACL_PID_PREFIX + "test123";
  Configuration conf=EasyMock.createMock(Configuration.class);
  EasyMock.expect(conf.getPid()).andReturn(testPid).anyTimes();
  EasyMock.replay(conf);
  ConfigurationAdmin cm=EasyMock.createMock(ConfigurationAdmin.class);
  EasyMock.expect(cm.listConfigurations(EasyMock.isA(String.class))).andReturn(null).anyTimes();
  EasyMock.expect(cm.getConfiguration(testPid,null)).andReturn(conf).anyTimes();
  EasyMock.replay(cm);
  final List<String> generateCalled=new ArrayList<String>();
  SecuredCommandConfigTransformer scct=new SecuredCommandConfigTransformer(){
    @Override void generateServiceGuardConfig(    Configuration config) throws IOException {
      generateCalled.add(config.getPid());
    }
  }
;
  scct.setConfigAdmin(cm);
  scct.init();
  @SuppressWarnings("unchecked") ServiceReference<ConfigurationAdmin> cmRef=EasyMock.createMock(ServiceReference.class);
  EasyMock.expect(cmRef.getBundle()).andReturn(null).anyTimes();
  EasyMock.replay(cmRef);
  ConfigurationEvent event=new ConfigurationEvent(cmRef,ConfigurationEvent.CM_UPDATED,null,testPid);
  assertEquals("Precondition",0,generateCalled.size());
  scct.configurationEvent(event);
  assertEquals(1,generateCalled.size());
  assertEquals(testPid,generateCalled.iterator().next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.security.impl.SecuredCommandProcessorImplTest </h4><pre class="type-6 type-3 type-4 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommandProcessor() throws Exception {
  ThreadIO tio=EasyMock.createMock(ThreadIO.class);
  EasyMock.replay(tio);
  @SuppressWarnings("unchecked") ServiceReference<ThreadIO> tioRef=EasyMock.createMock(ServiceReference.class);
  EasyMock.replay(tioRef);
  final BundleContext bc=EasyMock.createMock(BundleContext.class);
  EasyMock.expect(bc.getServiceReference(ThreadIO.class)).andReturn(tioRef).anyTimes();
  EasyMock.expect(bc.getService(tioRef)).andReturn(tio).anyTimes();
  EasyMock.expect(bc.createFilter(EasyMock.isA(String.class))).andAnswer(new IAnswer<Filter>(){
    @Override public Filter answer() throws Throwable {
      return FrameworkUtil.createFilter((String)EasyMock.getCurrentArguments()[0]);
    }
  }
).anyTimes();
  EasyMock.expect(bc.getServiceReferences((String)EasyMock.anyObject(),(String)EasyMock.anyObject())).andReturn(null).anyTimes();
  final Map<String,ServiceListener> listeners=new HashMap<String,ServiceListener>();
  final String commandFilter="(&(osgi.command.scope=*)(osgi.command.function=*)" + "(|(org.apache.karaf.service.guard.roles=aaabbbccc)(!(org.apache.karaf.service.guard.roles=*))))";
  expectServiceTracker(bc,commandFilter,listeners);
  expectServiceTracker(bc,"(objectClass=" + Converter.class.getName() + ")",listeners);
  expectServiceTracker(bc,"(objectClass=" + CommandSessionListener.class.getName() + ")",listeners);
  EasyMock.replay(bc);
  Subject subject=new Subject();
  subject.getPrincipals().add(new RolePrincipal("aaabbbccc"));
  Subject.doAs(subject,new PrivilegedAction(){
    @Override public Object run(){
      MySecuredCommandProcessorImpl scp=new MySecuredCommandProcessorImpl(bc){
      }
;
      assertEquals(3,scp.getCommands().size());
      assertTrue(scp.getCommands().contains("osgi:addcommand"));
      assertTrue(scp.getCommands().contains("osgi:removecommand"));
      assertTrue(scp.getCommands().contains("osgi:eval"));
      assertEquals(1,scp.getConstants().size());
      assertEquals(bc,scp.getConstants().get(".context"));
      ServiceListener commandListener=listeners.get(commandFilter);
      ServiceReference<?> cdRef=EasyMock.createMock(ServiceReference.class);
      EasyMock.expect(cdRef.getProperty(CommandProcessor.COMMAND_SCOPE)).andReturn("foo");
      EasyMock.expect(cdRef.getProperty(CommandProcessor.COMMAND_FUNCTION)).andReturn("bar");
      EasyMock.replay(cdRef);
      ServiceEvent event=new ServiceEvent(ServiceEvent.REGISTERED,cdRef);
      commandListener.serviceChanged(event);
      assertEquals(4,scp.getCommands().size());
      assertTrue(scp.getCommands().contains("foo:bar"));
      ServiceReference<?> cd2Ref=EasyMock.createMock(ServiceReference.class);
      EasyMock.expect(cd2Ref.getProperty(CommandProcessor.COMMAND_SCOPE)).andReturn("xxx");
      EasyMock.expect(cd2Ref.getProperty(CommandProcessor.COMMAND_FUNCTION)).andReturn(new String[]{"aaa","bbb"});
      EasyMock.replay(cd2Ref);
      ServiceEvent event2=new ServiceEvent(ServiceEvent.REGISTERED,cd2Ref);
      commandListener.serviceChanged(event2);
      assertEquals(6,scp.getCommands().size());
      assertTrue(scp.getCommands().contains("xxx:aaa"));
      assertTrue(scp.getCommands().contains("xxx:bbb"));
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.ssh.KnownHostsManagerTest </h4><pre class="type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreAndRetrieve() throws IOException, NoSuchAlgorithmException, InvalidKeySpecException {
  SocketAddress address=new InetSocketAddress("localhost",1001);
  File hostsFile=File.createTempFile("hosts","");
  KnownHostsManager manager=new KnownHostsManager(hostsFile);
  PublicKey foundKey1=manager.getKnownKey(address,ALGORITHM);
  Assert.assertNull(foundKey1);
  PublicKey serverKey=createPubKey();
  manager.storeKeyForHost(address,serverKey);
  PublicKey foundKey2=manager.getKnownKey(address,ALGORITHM);
  Assert.assertEquals(serverKey,foundKey2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.support.ShellUtilTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetValueStringWithCustomCollection(){
  List<Integer> data=new AbstractList<Integer>(){
    int[] values=new int[15];
    int size=0;
    @Override public boolean add(    Integer e){
      values[size]=e;
      size++;
      return true;
    }
    @Override public Integer get(    int index){
      if (index >= size)       throw new IndexOutOfBoundsException();
      return values[index];
    }
    @Override public int size(){
      return size;
    }
    @Override public String toString(){
      return "Custom" + super.toString();
    }
  }
;
  data.add(5);
  assertEquals("[5]",ShellUtil.getValueString(data));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetValueString(){
  Object data;
  data="Hello World";
  assertEquals("Hello World",ShellUtil.getValueString(data));
  data=new int[]{1,2,3,5,7,9};
  assertEquals("[1, 2, 3, 5, 7, 9]",ShellUtil.getValueString(data));
  data=new short[]{1,2,3,5,7,9};
  assertEquals("[1, 2, 3, 5, 7, 9]",ShellUtil.getValueString(data));
  data=new long[]{1,2,3,5,7,9};
  assertEquals("[1, 2, 3, 5, 7, 9]",ShellUtil.getValueString(data));
  data=new byte[]{1,2,3,5,7,9};
  assertEquals("[1, 2, 3, 5, 7, 9]",ShellUtil.getValueString(data));
  data=new float[]{1,2,3,5,7,9};
  assertEquals("[1.0, 2.0, 3.0, 5.0, 7.0, 9.0]",ShellUtil.getValueString(data));
  data=new double[]{1,2,3,5,7,9};
  assertEquals("[1.0, 2.0, 3.0, 5.0, 7.0, 9.0]",ShellUtil.getValueString(data));
  data=new boolean[]{true,true,false};
  assertEquals("[true, true, false]",ShellUtil.getValueString(data));
  data=new char[]{'a','c','e'};
  assertEquals("[a, c, e]",ShellUtil.getValueString(data));
  data=new Object[]{new int[]{1,2,3,5,8},new char[]{'h','e','l','l','o'},"World"};
  assertEquals("[[1, 2, 3, 5, 8], [h, e, l, l, o], World]",ShellUtil.getValueString(data));
  data=Arrays.asList(5,10,15,25);
  assertEquals("[5, 10, 15, 25]",ShellUtil.getValueString(data));
  data=new LinkedHashSet<>(Arrays.asList(5,10,15,25));
  assertEquals("[5, 10, 15, 25]",ShellUtil.getValueString(data));
  data=new int[][]{{1,2,3},{5,7,9}};
  assertEquals("[[1, 2, 3], [5, 7, 9]]",ShellUtil.getValueString(data));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.support.ansi.AnsiSplitterTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindow() throws IOException {
  String text="\u001B[1mThis is bold.\u001B[22m";
  assertEquals("\u001B[1mis\u001B[22m",AnsiSplitter.substring(text,5,7,4));
  assertEquals(13,AnsiSplitter.length(text,4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.support.table.ShellTableTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongValueFull(){
  ShellTable table=new ShellTable();
  table.separator("|");
  table.column("col1");
  table.column("col2").maxSize(-1);
  table.addRow().addContent("my first column value","my second column value is quite long");
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  table.print(new PrintStream(baos),false);
  assertEquals(String.format("%s%n","my first column value|my second column value is quite long"),baos.toString());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongValueMultiline(){
  ShellTable table=new ShellTable();
  table.separator("|");
  table.column("col1");
  table.column("col2").maxSize(-1).wrap();
  table.addRow().addContent("my first column value","my second column value is quite long");
  table.size(50);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  table.print(new PrintStream(baos),false);
  assertEquals(String.format("%1$s\n%2$s%n","my first column value|my second column value is","                     |quite long"),baos.toString());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongValueCut(){
  ShellTable table=new ShellTable();
  table.separator("|");
  table.column("col1");
  table.column("col2").maxSize(-1);
  table.addRow().addContent("my first column value","my second column value is quite long");
  table.size(50);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  table.print(new PrintStream(baos),false);
  assertEquals(String.format("%s%n","my first column value|my second column value is q"),baos.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.shell.tabletest.ShellTableTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrow(){
  ShellTable table=new ShellTable().size(10);
  table.column(new Col("1"));
  table.column(new Col("2"));
  table.addRow().addContent("1","2");
  StringWriter writer=new StringWriter();
  PrintStream out=new PrintStream(new WriterOutputStream(writer));
  table.print(out,true);
  out.flush();
  String expected="1      | 2\n" + "----------\n" + "1      | 2\n";
  Assert.assertEquals(expected,getString(writer));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShrink(){
  ShellTable table=new ShellTable().size(10);
  table.column(new Col("1").maxSize(5));
  table.column(new Col("2").alignRight());
  table.addRow().addContent("quite long","and here an even longer text");
  StringWriter writer=new StringWriter();
  PrintStream out=new PrintStream(new WriterOutputStream(writer));
  table.print(out,true);
  out.flush();
  String expected="1     |  2\n" + "----------\n" + "quite |  a\n";
  Assert.assertEquals(expected,getString(writer));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoFormatWithCustomSeparator(){
  ShellTable table=new ShellTable();
  table.separator(";");
  table.column(new Col("first"));
  table.column(new Col("second"));
  table.addRow().addContent("first column","second column");
  StringWriter writer=new StringWriter();
  PrintStream out=new PrintStream(new WriterOutputStream(writer));
  table.print(out,false);
  out.flush();
  String expected="first column;second column\n";
  Assert.assertEquals(expected,getString(writer));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoFormat(){
  ShellTable table=new ShellTable();
  table.column(new Col("first"));
  table.column(new Col("second"));
  table.addRow().addContent("first column","second column");
  StringWriter writer=new StringWriter();
  PrintStream out=new PrintStream(new WriterOutputStream(writer));
  table.print(out,false);
  out.flush();
  String expected="first column\tsecond column\n";
  Assert.assertEquals(expected,getString(writer));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTable(){
  ShellTable table=new ShellTable();
  table.column(new Col("id").alignRight().maxSize(5));
  table.column(new Col("Name").maxSize(20));
  table.column(new Col("Centered").alignCenter());
  table.addRow().addContent(1,"Test","Description");
  table.addRow().addContent(20,"My name","Description");
  Row row=table.addRow();
  row.addContent(123456789);
  row.addContent("A very long text that should be cut");
  row.addContent("A very long text that should not be cut");
  StringWriter writer=new StringWriter();
  PrintStream out=new PrintStream(new WriterOutputStream(writer));
  table.print(out,true);
  out.flush();
  String expected="   id | Name                 |                Centered                \n" + "----------------------------------------------------------------------\n" + "    1 | Test                 |               Description              \n"+ "   20 | My name              |               Description              \n"+ "12345 | A very long text tha | A very long text that should not be cut\n";
  Assert.assertEquals(expected,getString(writer));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooSmall(){
  ShellTable table=new ShellTable().size(2);
  table.column(new Col("1").maxSize(5));
  table.column(new Col("2").alignRight());
  table.addRow().addContent("quite long","and here an even longer text");
  StringWriter writer=new StringWriter();
  PrintStream out=new PrintStream(new WriterOutputStream(writer));
  table.print(out,true);
  out.flush();
  String expected="1     | \n" + "--------\n" + "quite | \n";
  Assert.assertEquals(expected,getString(writer));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.system.internal.SystemServiceImplTest </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetName() throws URISyntaxException, IOException {
  SystemServiceImpl system=new SystemServiceImpl();
  BundleContext bundleContext=EasyMock.createMock(BundleContext.class);
  URL propUrl=this.getClass().getClassLoader().getResource("etc/system.properties");
  File propfile=new File(propUrl.toURI());
  EasyMock.expect(bundleContext.getProperty("karaf.etc")).andReturn(propfile.getParentFile().getParent() + "/etc");
  EasyMock.replay(bundleContext);
  system.setBundleContext(bundleContext);
  system.setName(NEW_NAME);
  EasyMock.verify(bundleContext);
  Properties props=new Properties(propfile);
  String nameAfter=props.getProperty("karaf.name");
  Assert.assertEquals(NEW_NAME,nameAfter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.tooling.features.GenerateDescriptorMojoTest </h4><pre class="type-6 type-3 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadXml100() throws JAXBException, SAXException, ParserConfigurationException, XMLStreamException {
  URL url=getClass().getClassLoader().getResource("input-features-1.0.0.xml");
  Features featuresRoot=JaxbUtil.unmarshal(url.toExternalForm(),false);
  assertEquals(featuresRoot.getRepository().size(),1);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JaxbUtil.marshal(featuresRoot,baos);
  String text=new String(baos.toByteArray());
  assertTrue(text.contains("repository"));
  assertTrue(text.contains(FeaturesNamespaces.URI_CURRENT));
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadXml1() throws Exception {
  URL url=getClass().getClassLoader().getResource("input-features-1.1.0.xml");
  Features featuresRoot=JaxbUtil.unmarshal(url.toExternalForm(),false);
  List<Feature> featuresList=featuresRoot.getFeature();
  assertEquals(featuresList.size(),1);
  Feature feature=featuresList.get(0);
  assertEquals(feature.getInstall(),"auto");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.tooling.features.MavenUtilTest </h4><pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSonatypeArtifactToMvn() throws Exception {
  Dependency30Helper helper=new Dependency30Helper(null,null,null);
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT",helper.artifactToMvn(new org.sonatype.aether.util.artifact.DefaultArtifact("org.foo:org.foo.bar:1.0-SNAPSHOT")));
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar",helper.artifactToMvn(new org.sonatype.aether.util.artifact.DefaultArtifact("org.foo:org.foo.bar:kar:1.0-SNAPSHOT")));
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features",helper.artifactToMvn(new org.sonatype.aether.util.artifact.DefaultArtifact("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT")));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-13 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore("Will work with org.apache.maven:maven-core:3.1.0+") public void testPathFromAetherEclipse() throws Exception {
  Dependency31Helper helper=new Dependency31Helper(null,null,null);
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.jar",helper.pathFromAether("org.foo:org.foo.bar:1.0-SNAPSHOT"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.kar",helper.pathFromAether("org.foo:org.foo.bar:kar:1.0-SNAPSHOT"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT-features.xml",helper.pathFromAether("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPathFromMvnSonatype() throws Exception {
  Dependency30Helper helper=new Dependency30Helper(null,null,null);
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.jar",helper.pathFromMaven("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.kar",helper.pathFromMaven("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT-features.xml",helper.pathFromMaven("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-13 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore("Will work with org.apache.maven:maven-core:3.1.0+") public void testPathFromMvnEclipse() throws Exception {
  Dependency31Helper helper=new Dependency31Helper(null,null,null);
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.jar",helper.pathFromMaven("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.kar",helper.pathFromMaven("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT-features.xml",helper.pathFromMaven("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAetherToMvn() throws Exception {
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT",aetherToMvn("org.foo:org.foo.bar:1.0-SNAPSHOT"));
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar",aetherToMvn("org.foo:org.foo.bar:kar:1.0-SNAPSHOT"));
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features",aetherToMvn("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPathFromAetherSonatype() throws Exception {
  Dependency30Helper helper=new Dependency30Helper(null,null,null);
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.jar",helper.pathFromAether("org.foo:org.foo.bar:1.0-SNAPSHOT"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT.kar",helper.pathFromAether("org.foo:org.foo.bar:kar:1.0-SNAPSHOT"));
  assertEquals("org/foo/org.foo.bar/1.0-SNAPSHOT/org.foo.bar-1.0-SNAPSHOT-features.xml",helper.pathFromAether("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT"));
}

</code></pre>

<br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEclipseArtifactToMvn() throws Exception {
  Dependency31Helper helper=new Dependency31Helper(null,null,null);
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT",helper.artifactToMvn(new org.eclipse.aether.artifact.DefaultArtifact("org.foo:org.foo.bar:1.0-SNAPSHOT")));
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar",helper.artifactToMvn(new org.eclipse.aether.artifact.DefaultArtifact("org.foo:org.foo.bar:kar:1.0-SNAPSHOT")));
  assertEquals("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features",helper.artifactToMvn(new org.eclipse.aether.artifact.DefaultArtifact("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT")));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMvnToAether() throws Exception {
  assertEquals("org.foo:org.foo.bar:1.0-SNAPSHOT",mvnToAether("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT"));
  assertEquals("org.foo:org.foo.bar:kar:1.0-SNAPSHOT",mvnToAether("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar"));
  assertEquals("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT",mvnToAether("mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features"));
  assertEquals("org.foo:org.foo.bar:1.0-SNAPSHOT",mvnToAether("wrap:mvn:org.foo/org.foo.bar/1.0-SNAPSHOT"));
  assertEquals("org.foo:org.foo.bar:kar:1.0-SNAPSHOT",mvnToAether("wrap:mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/kar"));
  assertEquals("org.foo:org.foo.bar:xml:features:1.0-SNAPSHOT",mvnToAether("wrap:mvn:org.foo/org.foo.bar/1.0-SNAPSHOT/xml/features"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.tools.utils.KarafPropertiesEditorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void onceOver() throws Exception {
  KarafPropertyInstructionsModelStaxReader kipmsr=new KarafPropertyInstructionsModelStaxReader();
  URL editsUrl=Resources.getResource(KarafPropertiesEditorTest.class,"test-edits.xml");
  KarafPropertyEdits edits;
  try (InputStream editsStream=Resources.asByteSource(editsUrl).openStream()){
    edits=kipmsr.read(editsStream,true);
  }
   Path path=FileSystems.getDefault().getPath("target");
  Path outputEtc=Files.createTempDirectory(path,"test-etc");
  outputEtc.toFile().deleteOnExit();
  KarafPropertiesEditor editor=new KarafPropertiesEditor();
  editor.setInputEtc(new File(ETC_TO_START_WITH)).setOutputEtc(outputEtc.toFile()).setEdits(edits);
  editor.run();
  File resultConfigProps=new File(outputEtc.toFile(),"config.properties");
  Properties properties=new Properties();
  try (InputStream resultInputStream=new FileInputStream(resultConfigProps)){
    properties.load(resultInputStream);
  }
   assertEquals("equinox",properties.getProperty("karaf.framework"));
  assertEquals("prepended,root,toor",properties.getProperty("karaf.name"));
  resultConfigProps=new File(outputEtc.toFile(),"jre.properties");
  try (InputStream resultInputStream=new FileInputStream(resultConfigProps)){
    properties.load(resultInputStream);
  }
   assertEquals("This is the cereal: shot from guns",properties.getProperty("test-add-one"));
  assertEquals("This is the gun that shoots cereal",properties.getProperty("test-add-two"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.karaf.util.ParserTest </h4><pre class="type-6 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parserTest() throws Exception {
  Map parts=new HashMap();
  String uri=Parser.pathToMaven(PATH_WITH_CLASSIFIER,parts);
  Assert.assertEquals("mvn:org.apache.karaf/test/1.0-SNAPSHOT/xml/feature",uri);
  Assert.assertEquals("feature",parts.get("classifier"));
  uri=Parser.pathToMaven(PATH_WITHOUT_CLASSIFIER,parts);
  Assert.assertEquals("mvn:org.apache.karaf/test/1.0-SNAPSHOT/xml",uri);
  Assert.assertNull(parts.get("classifier"));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
