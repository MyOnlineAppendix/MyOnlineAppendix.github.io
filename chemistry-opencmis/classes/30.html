<h3 style="margin:0px">Class: org.apache.chemistry.opencmis.inmemory.AclPermissionsTest (10 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="16"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('16')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-16"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Override @Before public void setUp(){
  super.setTypeCreatorClass(UnitTestTypeSystemCreator.class.getName());
  super.setUp();
  fCreator=new ObjectCreator(fFactory,fObjSvc,fRepositoryId);
  List<String> principalIds=new ArrayList<String>(3);
  principalIds.add("TestAdmin");
  principalIds.add("Writer");
  principalIds.add("Reader");
  principalIds.add("TestUser");
  addACEs=new ArrayList<Ace>(4);
  addACEs.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  addACEs.add(createAce("Writer",EnumBasicPermissions.CMIS_WRITE));
  addACEs.add(createAce("TestUser",EnumBasicPermissions.CMIS_WRITE));
  addACEs.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  addAcl=fFactory.createAccessControlList(addACEs);
  standardACEs=new ArrayList<Ace>(3);
  standardACEs.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  standardACEs.add(createAce("Writer",EnumBasicPermissions.CMIS_WRITE));
  standardACEs.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  standardAcl=fFactory.createAccessControlList(standardACEs);
  noReadACEs=new ArrayList<Ace>(2);
  noReadACEs.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  noReadACEs.add(createAce("Writer",EnumBasicPermissions.CMIS_WRITE));
  noReadAcl=fFactory.createAccessControlList(noReadACEs);
  readACEs=new ArrayList<Ace>(1);
  readACEs.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  readAcl=fFactory.createAccessControlList(readACEs);
  readWriteACEs=new ArrayList<Ace>(2);
  readWriteACEs.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  readWriteACEs.add(createAce("Writer",EnumBasicPermissions.CMIS_WRITE));
  readWriteAcl=fFactory.createAccessControlList(readWriteACEs);
  testUserACEs=new ArrayList<Ace>(1);
  testUserACEs.add(createAce("TestUser",EnumBasicPermissions.CMIS_WRITE));
  testUserAcl=fFactory.createAccessControlList(testUserACEs);
  writerReadACEs=new ArrayList<Ace>(1);
  writerReadACEs.add(createAce("Writer",EnumBasicPermissions.CMIS_READ));
  writerReadAcl=fFactory.createAccessControlList(writerReadACEs);
  adminACEs=new ArrayList<Ace>(1);
  adminACEs.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  adminAcl=fFactory.createAccessControlList(adminACEs);
  List<Ace> defaultACEs=new ArrayList<Ace>(1);
  defaultACEs.add(createAce(InMemoryAce.getAnyoneUser(),EnumBasicPermissions.CMIS_ALL));
  defaultAcl=fFactory.createAccessControlList(defaultACEs);
}

</code></pre>

<pre class="type-16 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiFilingServiceGeneralAccess(){
  switchCallContext("TestAdmin");
  String docId=createDocumentWithAcls("doc",fRootFolderId,"ComplexType",standardAcl,defaultAcl);
  String folderId=createFolderWithAcls("folder",fRootFolderId,"cmis:folder",addAcl,defaultAcl);
  String noReadFolderId=createFolderWithAcls("noReadFolder",folderId,"cmis:folder",null,readAcl);
  switchCallContext("TestUser");
  boolean exceptionThrown=false;
  try {
    fMultiSvc.addObjectToFolder(fRepositoryId,docId,folderId,true,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions at the document to add a parent");
  }
  exceptionThrown=false;
  switchCallContext("Reader");
  try {
    fMultiSvc.addObjectToFolder(fRepositoryId,docId,noReadFolderId,true,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permission at the folder to add a parent");
  }
  switchCallContext("TestAdmin");
  fMultiSvc.addObjectToFolder(fRepositoryId,docId,noReadFolderId,true,null);
  fMultiSvc.addObjectToFolder(fRepositoryId,docId,folderId,true,null);
  switchCallContext("Reader");
  try {
    fMultiSvc.removeObjectFromFolder(fRepositoryId,docId,noReadFolderId,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permission at the folder to remove a parent");
  }
  switchCallContext("TestUser");
  try {
    fMultiSvc.removeObjectFromFolder(fRepositoryId,docId,folderId,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permission at the object to remove a parent");
  }
}

</code></pre>

<pre class="type-8 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testQueryAccess(){
  createCustomPropertyDocuments();
  String queryStatement;
  List<ObjectData> objectDataList;
  ObjectList objectList;
  ObjectData first;
  switchCallContext("TestUser");
  queryStatement="select * from cmis:document";
  objectList=fDiscSvc.query(fRepositoryId,queryStatement,null,null,null,null,MINUS_ONE,MINUS_ONE,null);
  assertTrue(0L == objectList.getNumItems().longValue());
  switchCallContext("TestAdmin");
  String docId20=idMap.get("customDocId20");
  fAclSvc.applyAcl(fRepositoryId,idMap.get("customDocId20"),testUserAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  queryStatement="select * from ComplexType where IntProp <= 20";
  objectList=fDiscSvc.query(fRepositoryId,queryStatement,null,null,null,null,MINUS_ONE,MINUS_ONE,null);
  assertTrue(1L == objectList.getNumItems().longValue());
  objectDataList=objectList.getObjects();
  first=objectDataList.get(0);
  assertTrue(first.getBaseTypeId().equals(BaseTypeId.CMIS_DOCUMENT));
}

</code></pre>

<pre class="type-16 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void checkNavigationServiceGeneralAccess(){
  switchCallContext("TestAdmin");
  String docId=createDocumentWithAcls("doc",fRootFolderId,"ComplexType",standardAcl,defaultAcl);
  String folderId=createFolderWithAcls("folder",fRootFolderId,"cmis:folder",standardAcl,defaultAcl);
  String subFolderId=createFolderWithAcls("subFolder",folderId,"cmis:folder",standardAcl,null);
  switchCallContext("TestUser");
  boolean exceptionThrown=false;
  try {
    ObjectInFolderList list=fNavSvc.getChildren(fRepositoryId,folderId,null,null,false,IncludeRelationships.NONE,null,null,BigInteger.ZERO,BigInteger.ZERO,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("Reader");
  ObjectInFolderList list=fNavSvc.getChildren(fRepositoryId,folderId,null,null,false,IncludeRelationships.NONE,null,null,BigInteger.ZERO,BigInteger.ZERO,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    List<ObjectInFolderContainer> list2=fNavSvc.getDescendants(fRepositoryId,folderId,MINUS_ONE,null,null,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("Reader");
  List<ObjectInFolderContainer> list2=fNavSvc.getDescendants(fRepositoryId,folderId,MINUS_ONE,null,null,null,null,null,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    List<ObjectInFolderContainer> list3=fNavSvc.getFolderTree(fRepositoryId,folderId,BigInteger.ONE,null,null,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("Reader");
  List<ObjectInFolderContainer> list3=fNavSvc.getFolderTree(fRepositoryId,folderId,BigInteger.ONE,null,null,null,null,null,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    List<ObjectParentData> list4=fNavSvc.getObjectParents(fRepositoryId,folderId,null,null,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("Reader");
  List<ObjectParentData> list4=fNavSvc.getObjectParents(fRepositoryId,folderId,null,null,null,null,null,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    ObjectData list5=fNavSvc.getFolderParent(fRepositoryId,folderId,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("Reader");
  ObjectData list5=fNavSvc.getFolderParent(fRepositoryId,folderId,null,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    ObjectList list6=fNavSvc.getCheckedOutDocs(fRepositoryId,folderId,null,null,null,IncludeRelationships.NONE,null,MINUS_ONE,MINUS_ONE,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("Reader");
  ObjectList list6=fNavSvc.getCheckedOutDocs(fRepositoryId,folderId,null,null,null,IncludeRelationships.NONE,null,MINUS_ONE,MINUS_ONE,null);
}

</code></pre>

<pre class="type-8 type-16 type-12 type-3 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAclServiceGeneralAccess(){
  List<Ace> initialACEs=new ArrayList<Ace>(4);
  initialACEs.addAll(standardACEs);
  initialACEs.add(createAce("Admin2",EnumBasicPermissions.CMIS_ALL));
  Acl initialAcl=fFactory.createAccessControlList(initialACEs);
  List<Ace> expectedACEs=new ArrayList<Ace>(5);
  expectedACEs.addAll(initialACEs);
  expectedACEs.addAll(testUserACEs);
  Acl expectedAcl=fFactory.createAccessControlList(expectedACEs);
  List<Ace> removeACEs=new ArrayList<Ace>(1);
  removeACEs.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  Acl removeAcl=fFactory.createAccessControlList(removeACEs);
  List<Ace> removeACEs2=new ArrayList<Ace>(2);
  removeACEs2.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  removeACEs2.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  Acl removeAcl2=fFactory.createAccessControlList(removeACEs2);
  List<Ace> testUserACEs=new ArrayList<Ace>(1);
  testUserACEs.add(createAce("TestUser",EnumBasicPermissions.CMIS_WRITE));
  Acl testUserAcl=fFactory.createAccessControlList(testUserACEs);
  switchCallContext("TestAdmin");
  String docId=createDocumentWithAcls("doc",fRootFolderId,"ComplexType",initialAcl,defaultAcl);
  String folderId=createFolderWithAcls("folder",fRootFolderId,"cmis:folder",initialAcl,defaultAcl);
  String subFolderId=createFolderWithAcls("subFolder",folderId,"cmis:folder",initialAcl,defaultAcl);
  switchCallContext("TestUser");
  boolean exceptionThrown=false;
  try {
    Acl acl=fAclSvc.getAcl(fRepositoryId,folderId,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to get acl of folder");
  }
  switchCallContext("Reader");
  Acl acl=fAclSvc.getAcl(fRepositoryId,folderId,null,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    Acl docAcl=fAclSvc.getAcl(fRepositoryId,docId,true,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to get acl of doc)");
  }
  switchCallContext("Reader");
  Acl docAcl=fAclSvc.getAcl(fRepositoryId,docId,true,null);
  switchCallContext("Reader");
  exceptionThrown=false;
  try {
    Acl docAcl2=fAclSvc.applyAcl(fRepositoryId,docId,initialAcl,null,AclPropagation.OBJECTONLY,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions)");
  }
  switchCallContext("TestAdmin");
  Acl docAcl2=fAclSvc.applyAcl(fRepositoryId,docId,initialAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestAdmin");
  Acl docAcl4=fAclSvc.applyAcl(fRepositoryId,subFolderId,null,removeAcl,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestAdmin");
  Acl docAcl5=fAclSvc.applyAcl(fRepositoryId,folderId,testUserAcl,null,AclPropagation.PROPAGATE,null);
  switchCallContext("Admin");
  Acl docAcl6=fAclSvc.getAcl(fRepositoryId,folderId,true,null);
  assertTrue(aclEquals(expectedAcl,docAcl6));
  Acl docAcl7=fAclSvc.getAcl(fRepositoryId,subFolderId,true,null);
  assertTrue(aclEquals(standardAcl,docAcl7));
}

</code></pre>

<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVisibleObjects(){
  LOG.debug("start test checkVisibleObjects()...");
  switchCallContext("TestAdmin");
  String docId=createDocumentWithAcls("doc",fRootFolderId,UnitTestTypeSystemCreator.VERSIONED_TYPE,VersioningState.MAJOR,standardAcl,defaultAcl);
  String docId2=createDocumentWithAcls("doc2",fRootFolderId,UnitTestTypeSystemCreator.VERSIONED_TYPE,VersioningState.MAJOR,addAcl,defaultAcl);
  String folderId=createFolderWithAcls("folder",fRootFolderId,"cmis:folder",standardAcl,defaultAcl);
  String folderId2=createFolderWithAcls("folder2",fRootFolderId,"cmis:folder",addAcl,defaultAcl);
  LOG.debug("checkVisibleObjects(): folderId2 is: " + folderId2);
  String subFolderId=createFolderWithAcls("subFolder",folderId2,"cmis:folder",null,testUserAcl);
  LOG.debug("checkVisibleObjects(): subFolderId is: " + subFolderId);
  String subFolderId2=createFolderWithAcls("subFolder2",folderId2,"cmis:folder",addAcl,null);
  LOG.debug("checkVisibleObjects(): subFolderId2 is: " + subFolderId2);
  String subDocId=createDocumentWithAcls("subDoc",folderId2,UnitTestTypeSystemCreator.VERSIONED_TYPE,VersioningState.MAJOR,null,testUserAcl);
  LOG.debug("checkVisibleObjects(): subDocId is: " + subDocId);
  String subDocId2=createDocumentWithAcls("subDoc2",folderId2,UnitTestTypeSystemCreator.VERSIONED_TYPE,VersioningState.MAJOR,addAcl,null);
  LOG.debug("checkVisibleObjects(): subDocId2 is: " + subDocId2);
  String noAclDocId2=createDocumentWithAcls("noAclDoc2",fRootFolderId,"ComplexType",null,null);
  LOG.debug("checkVisibleObjects(): noAclDocId2 is: " + noAclDocId2);
  switchCallContext("TestUser");
  ObjectInFolderList list=fNavSvc.getChildren(fRepositoryId,folderId2,null,null,false,IncludeRelationships.NONE,null,null,null,null,null);
  List<ObjectInFolderData> objects=list.getObjects();
  assertObjectDataListIds(objects,subDocId2);
  assertObjectDataListIds(objects,subFolderId2);
  list=fNavSvc.getChildren(fRepositoryId,fRootFolderId,null,null,false,IncludeRelationships.NONE,null,null,null,null,null);
  objects=list.getObjects();
  assertObjectDataListIds(objects,docId2);
  assertObjectDataListIds(objects,folderId2);
  assertObjectDataListIds(objects,noAclDocId2);
  List<ObjectInFolderContainer> descList=fNavSvc.getDescendants(fRepositoryId,fRootFolderId,MINUS_ONE,null,false,IncludeRelationships.NONE,null,false,null);
  assertObjectInFolderContainerIds(descList,docId2);
  assertObjectInFolderContainerIds(descList,folderId2);
  assertObjectInFolderContainerIds(descList,noAclDocId2);
  List<ObjectInFolderContainer> folderList=fNavSvc.getFolderTree(fRepositoryId,fRootFolderId,MINUS_ONE,null,false,IncludeRelationships.NONE,null,false,null);
  assertObjectInFolderContainerIds(folderList,folderId2);
  assertObjectInFolderContainerIds(folderList,subFolderId2);
  switchCallContext("TestAdmin");
  Holder<String> holderDocId=new Holder<String>(docId);
  Holder<String> holderDocId2=new Holder<String>(docId2);
  Holder<String> holderSubDocId=new Holder<String>(subDocId);
  Holder<String> holderSubDocId2=new Holder<String>(subDocId2);
  fVerSvc.checkOut(fRepositoryId,holderDocId,null,null);
  fVerSvc.checkOut(fRepositoryId,holderDocId2,null,null);
  fVerSvc.checkOut(fRepositoryId,holderSubDocId,null,null);
  fVerSvc.checkOut(fRepositoryId,holderSubDocId2,null,null);
  switchCallContext("TestUser");
  ObjectList objectList=fNavSvc.getCheckedOutDocs(fRepositoryId,null,null,null,false,IncludeRelationships.NONE,null,MINUS_ONE,MINUS_ONE,null);
  assertObjectInObjectListIds(objectList,holderDocId2.getValue());
  assertObjectInObjectListIds(objectList,holderSubDocId2.getValue());
  ObjectList objectList2=fNavSvc.getCheckedOutDocs(fRepositoryId,fRootFolderId,null,null,false,IncludeRelationships.NONE,null,MINUS_ONE,MINUS_ONE,null);
  List<String> docIds2=new ArrayList<String>(1);
  docIds2.add(docId2);
  assertEquals(BigInteger.valueOf(1L),objectList2.getNumItems());
  switchCallContext("TestAdmin");
  String secFolderId=createFolderWithAcls("secondFolder",fRootFolderId,"cmis:folder",standardAcl,defaultAcl);
  String docId3=createDocumentWithAcls("thirdDoc",folderId2,"ComplexType",addAcl,null);
  fMultiSvc.addObjectToFolder(fRepositoryId,docId3,secFolderId,true,null);
  switchCallContext("TestUser");
  List<ObjectParentData> objectParentData=fNavSvc.getObjectParents(fRepositoryId,docId3,null,null,null,null,true,null);
  assertEquals(1,objectParentData.size());
  assertEquals(folderId2,objectParentData.get(0).getObject().getId());
  LOG.debug("...stop test checkVisibleObjects()");
}

</code></pre>

<pre class="type-16 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testVersioningServiceGeneralAccess(){
  switchCallContext("TestAdmin");
  String docId=createDocumentWithAcls("doc",fRootFolderId,UnitTestTypeSystemCreator.VERSIONED_TYPE,VersioningState.MAJOR,standardAcl,defaultAcl);
  switchCallContext("TestUser");
  boolean exceptionThrown=false;
  try {
    Holder<String> docIdHolder=new Holder<String>(docId);
    fVerSvc.checkOut(fRepositoryId,docIdHolder,null,new Holder<Boolean>(false));
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permission to checkout)");
  }
  switchCallContext("Reader");
  exceptionThrown=false;
  try {
    fVerSvc.checkOut(fRepositoryId,new Holder<String>(docId),null,new Holder<Boolean>(false));
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has not enough permission to checkout)");
  }
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,testUserAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  Holder<String> docIdHolder=new Holder<String>(docId);
  fVerSvc.checkOut(fRepositoryId,docIdHolder,null,new Holder<Boolean>(false));
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,null,testUserAcl,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    fVerSvc.cancelCheckOut(fRepositoryId,docId,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permission to cancelCheckOut)");
  }
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,testUserAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  fVerSvc.cancelCheckOut(fRepositoryId,docId,null);
  switchCallContext("Writer");
  fVerSvc.checkOut(fRepositoryId,new Holder<String>(docId),null,new Holder<Boolean>(false));
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,null,readWriteAcl,AclPropagation.OBJECTONLY,null);
  switchCallContext("Writer");
  exceptionThrown=false;
  try {
    fVerSvc.cancelCheckOut(fRepositoryId,docId,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has not enough permission to cancelCheckOut)");
  }
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,readWriteAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("Writer");
  fVerSvc.cancelCheckOut(fRepositoryId,docId,null);
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,testUserAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  fVerSvc.checkOut(fRepositoryId,new Holder<String>(docId),null,new Holder<Boolean>(false));
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,null,testUserAcl,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    fVerSvc.checkIn(fRepositoryId,new Holder<String>(docId),true,null,null,null,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permission to checkIn)");
  }
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,testUserAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("TestUser");
  fVerSvc.checkIn(fRepositoryId,new Holder<String>(docId),true,null,null,null,null,null,null,null);
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,null,testUserAcl,AclPropagation.OBJECTONLY,null);
  switchCallContext("Writer");
  fVerSvc.checkOut(fRepositoryId,new Holder<String>(docId),null,new Holder<Boolean>(false));
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,null,readWriteAcl,AclPropagation.OBJECTONLY,null);
  switchCallContext("Writer");
  exceptionThrown=false;
  try {
    fVerSvc.checkIn(fRepositoryId,new Holder<String>(docId),true,null,null,null,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Writer has not enough permission to checkIn)");
  }
  switchCallContext("TestAdmin");
  fAclSvc.applyAcl(fRepositoryId,docId,readWriteAcl,null,AclPropagation.OBJECTONLY,null);
  switchCallContext("Writer");
  fVerSvc.checkIn(fRepositoryId,new Holder<String>(docId),true,null,null,null,null,null,null,null);
  switchCallContext("TestUser");
  exceptionThrown=false;
  try {
    ObjectData objectData=fVerSvc.getObjectOfLatestVersion(fRepositoryId,docId,null,true,null,false,IncludeRelationships.NONE,null,false,false,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has not enough permission to getObjectOfLatestVersion)");
  }
  exceptionThrown=false;
  try {
    List<ObjectData> objectDataList=fVerSvc.getAllVersions(fRepositoryId,docId,docId,null,false,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has not enough permission to getAllVersions)");
  }
  exceptionThrown=false;
  try {
    Properties properties=fVerSvc.getPropertiesOfLatestVersion(fRepositoryId,docId,null,false,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has not enough permission to getAllVersions)");
  }
}

</code></pre>

<pre class="type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCreateObjectsWithAcl(){
  String docId=createDocumentWithAcls("complexDocument",fRootFolderId,UnitTestTypeSystemCreator.COMPLEX_TYPE,addAcl,defaultAcl);
  Acl acl1=fAclSvc.getAcl(fRepositoryId,docId,true,null);
  assertTrue(aclEquals(addAcl,acl1));
  String folderId=createFolderWithAcls("folderWithAcl",fRootFolderId,BaseTypeId.CMIS_FOLDER.value(),addAcl,defaultAcl);
  Acl acl2=fAclSvc.getAcl(fRepositoryId,folderId,true,null);
  assertTrue(aclEquals(addAcl,acl2));
  String docId2=createVersionedDocument("complexDocument2",fRootFolderId);
  Acl acl=fAclSvc.applyAcl(fRepositoryId,docId2,addAcl,defaultAcl,AclPropagation.OBJECTONLY,null);
  assertTrue(aclEquals(addAcl,acl));
  String folderId2=createFolder("folder2",fRootFolderId,"cmis:folder");
  acl2=fAclSvc.applyAcl(fRepositoryId,folderId2,addAcl,defaultAcl,AclPropagation.OBJECTONLY,null);
  assertTrue(aclEquals(addAcl,acl2));
  String subFolderId=createFolder("subFolder",folderId,BaseTypeId.CMIS_FOLDER.value());
  Acl subAcl=fAclSvc.getAcl(fRepositoryId,subFolderId,true,null);
  assertTrue(aclEquals(addAcl,subAcl));
  String subDocId=createVersionedDocument("subDoc",subFolderId);
  Acl subAclDoc=fAclSvc.getAcl(fRepositoryId,subDocId,true,null);
  assertTrue(aclEquals(addAcl,subAclDoc));
  Acl removeAcl=createAcl("TestUser",EnumBasicPermissions.CMIS_WRITE);
  Acl acl3=fAclSvc.applyAcl(fRepositoryId,docId2,null,removeAcl,AclPropagation.OBJECTONLY,null);
  List<Ace> compareRemoveACEs=new ArrayList<Ace>(3);
  compareRemoveACEs.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  compareRemoveACEs.add(createAce("Writer",EnumBasicPermissions.CMIS_WRITE));
  compareRemoveACEs.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  Acl compareRemoveAcl=fFactory.createAccessControlList(compareRemoveACEs);
  assertTrue(aclEquals(compareRemoveAcl,acl3));
  Acl addPropAcl=createAcl("TestUser",EnumBasicPermissions.CMIS_WRITE);
  Acl acl4=fAclSvc.applyAcl(fRepositoryId,subFolderId,addPropAcl,null,AclPropagation.OBJECTONLY,null);
  Acl subAclDoc2=fAclSvc.getAcl(fRepositoryId,subDocId,true,null);
  assertTrue(aclEquals(addAcl,subAclDoc2));
  List<Ace> compareRemoveACEs2=new ArrayList<Ace>(4);
  compareRemoveACEs2.add(createAce("TestAdmin",EnumBasicPermissions.CMIS_ALL));
  compareRemoveACEs2.add(createAce("Writer",EnumBasicPermissions.CMIS_WRITE));
  compareRemoveACEs2.add(createAce("TestUser",EnumBasicPermissions.CMIS_ALL));
  compareRemoveACEs2.add(createAce("Reader",EnumBasicPermissions.CMIS_READ));
  Acl compareRemoveAcl2=fFactory.createAccessControlList(compareRemoveACEs2);
  assertTrue(aclEquals(compareRemoveAcl2,acl4));
  Acl acl5=fAclSvc.applyAcl(fRepositoryId,subFolderId,addPropAcl,null,AclPropagation.PROPAGATE,null);
  Acl subAclDoc3=fAclSvc.getAcl(fRepositoryId,subDocId,true,null);
  assertTrue(aclEquals(compareRemoveAcl2,subAclDoc3));
  assertTrue(aclEquals(compareRemoveAcl2,acl5));
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@Override @After public void tearDown(){
  super.tearDown();
}

</code></pre>

<pre class="type-16 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testObjectServiceGeneralAccess(){
  switchCallContext("TestAdmin");
  String docId=createDocumentWithAcls("doc",fRootFolderId,"ComplexType",standardAcl,defaultAcl);
  String folderId=createFolderWithAcls("folder",fRootFolderId,"cmis:folder",standardAcl,defaultAcl);
  String subFolderId=createFolderWithAcls("subFolder",folderId,"cmis:folder",standardAcl,null);
  String noReadFolderId=createFolderWithAcls("noReadFolder",folderId,"cmis:folder",null,readAcl);
  String adminFolderId=createFolderWithAcls("adminFolder",folderId,"cmis:folder",null,readWriteAcl);
  switchCallContext("TestUser");
  boolean exceptionThrown=false;
  try {
    Properties properties=createDocumentProperties("doc","ComplexType");
    String id=fObjSvc.createDocument(fRepositoryId,properties,folderId,null,null,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to create a document");
  }
  exceptionThrown=false;
  try {
    String id=fObjSvc.createFolder(fRepositoryId,null,folderId,null,null,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to create a folder");
  }
  exceptionThrown=false;
  try {
    Properties props=fObjSvc.getProperties(fRepositoryId,folderId,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to get properties of the folder");
  }
  exceptionThrown=false;
  try {
    Properties props=fObjSvc.getProperties(fRepositoryId,docId,null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to get properties of the document");
  }
  exceptionThrown=false;
  try {
    List<RenditionData> renditions=fObjSvc.getRenditions(fRepositoryId,docId,null,BigInteger.valueOf(-1),BigInteger.valueOf(-1),null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to get renditions of the document");
  }
  exceptionThrown=false;
  try {
    ContentStream contentStream=fObjSvc.getContentStream(fRepositoryId,docId,null,BigInteger.valueOf(-1),BigInteger.valueOf(-1),null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("TestUser has no permissions to get contentStream of the document");
  }
  switchCallContext("Reader");
  exceptionThrown=false;
  Properties properties=createDocumentProperties("name","typeId");
  try {
    fObjSvc.updateProperties(fRepositoryId,new Holder<String>(docId),new Holder<String>("changeToken"),properties,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to update properties of the document");
  }
  exceptionThrown=false;
  properties=createDocumentProperties("name","typeId");
  try {
    fObjSvc.updateProperties(fRepositoryId,new Holder<String>(docId),new Holder<String>("changeToken"),properties,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to update properties of the document");
  }
  exceptionThrown=false;
  try {
    fObjSvc.moveObject(fRepositoryId,new Holder<String>(docId),subFolderId,fRootFolderId,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to move document");
  }
  switchCallContext("Writer");
  exceptionThrown=false;
  try {
    fObjSvc.moveObject(fRepositoryId,new Holder<String>(docId),adminFolderId,fRootFolderId,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Writer has no permissions to move document to admin folder");
  }
  switchCallContext("Reader");
  exceptionThrown=false;
  try {
    fObjSvc.deleteObject(fRepositoryId,docId,true,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to delete document ");
  }
  exceptionThrown=false;
  try {
    fObjSvc.deleteObject(fRepositoryId,adminFolderId,true,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to delete admin folder ");
  }
  exceptionThrown=false;
  try {
    fObjSvc.setContentStream(fRepositoryId,new Holder<String>(docId),true,new Holder<String>("changeToken"),null,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to set content ");
  }
  exceptionThrown=false;
  try {
    fObjSvc.deleteContentStream(fRepositoryId,new Holder<String>(docId),new Holder<String>("changeToken"),null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to delete content ");
  }
  exceptionThrown=false;
  try {
    fObjSvc.deleteTree(fRepositoryId,folderId,true,null,false,null);
  }
 catch (  CmisPermissionDeniedException e) {
    exceptionThrown=true;
  }
  if (!exceptionThrown) {
    fail("Reader has no permissions to delete tree ");
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
