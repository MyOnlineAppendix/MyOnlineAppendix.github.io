<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hcatalog.common.TestHCatUtil </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testValidateMorePermissive(){
  assertConsistentFsPermissionBehaviour(FsAction.ALL,true,true,true,true,true,true,true,true);
  assertConsistentFsPermissionBehaviour(FsAction.READ,false,true,false,true,false,false,false,false);
  assertConsistentFsPermissionBehaviour(FsAction.WRITE,false,true,false,false,true,false,false,false);
  assertConsistentFsPermissionBehaviour(FsAction.EXECUTE,false,true,true,false,false,false,false,false);
  assertConsistentFsPermissionBehaviour(FsAction.READ_EXECUTE,false,true,true,true,false,true,false,false);
  assertConsistentFsPermissionBehaviour(FsAction.READ_WRITE,false,true,false,true,true,false,true,false);
  assertConsistentFsPermissionBehaviour(FsAction.WRITE_EXECUTE,false,true,true,false,true,false,false,true);
  assertConsistentFsPermissionBehaviour(FsAction.NONE,false,true,false,false,false,false,false,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.data.TestReaderWriter </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test() throws MetaException, CommandNeedRetryException, IOException, ClassNotFoundException {
  driver.run("drop table mytbl");
  driver.run("create table mytbl (a string, b int)");
  Iterator<Entry<String,String>> itr=hiveConf.iterator();
  Map<String,String> map=new HashMap<String,String>();
  while (itr.hasNext()) {
    Entry<String,String> kv=itr.next();
    map.put(kv.getKey(),kv.getValue());
  }
  WriterContext cntxt=runsInMaster(map);
  File writeCntxtFile=File.createTempFile("hcat-write","temp");
  writeCntxtFile.deleteOnExit();
  ObjectOutputStream oos=new ObjectOutputStream(new FileOutputStream(writeCntxtFile));
  oos.writeObject(cntxt);
  oos.flush();
  oos.close();
  ObjectInputStream ois=new ObjectInputStream(new FileInputStream(writeCntxtFile));
  cntxt=(WriterContext)ois.readObject();
  ois.close();
  runsInSlave(cntxt);
  commit(map,true,cntxt);
  ReaderContext readCntxt=runsInMaster(map,false);
  File readCntxtFile=File.createTempFile("hcat-read","temp");
  readCntxtFile.deleteOnExit();
  oos=new ObjectOutputStream(new FileOutputStream(readCntxtFile));
  oos.writeObject(readCntxt);
  oos.flush();
  oos.close();
  ois=new ObjectInputStream(new FileInputStream(readCntxtFile));
  readCntxt=(ReaderContext)ois.readObject();
  ois.close();
  for (  InputSplit split : readCntxt.getSplits()) {
    runsInSlave(split,readCntxt.getConf());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.lock.WriteLockTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws Exception {
  runTest(3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.lock.ZNodeNameTest </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderWithSamePrefix() throws Exception {
  String[] names={"x-3","x-5","x-11","x-1"};
  String[] expected={"x-1","x-3","x-5","x-11"};
  assertOrderedNodeNames(names,expected);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOrderWithDifferentPrefixes() throws Exception {
  String[] names={"r-3","r-2","r-1","w-2","w-1"};
  String[] expected={"r-1","r-2","r-3","w-1","w-2"};
  assertOrderedNodeNames(names,expected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.listener.TestNotificationListener </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAMQListener() throws Exception {
  driver.run("create database mydb");
  driver.run("use mydb");
  driver.run("create table mytbl (a string) partitioned by (b string)");
  driver.run("alter table mytbl add partition(b='2011')");
  Map<String,String> kvs=new HashMap<String,String>(1);
  kvs.put("b","2011");
  client.markPartitionForEvent("mydb","mytbl",kvs,PartitionEventType.LOAD_DONE);
  driver.run("alter table mytbl drop partition(b='2011')");
  driver.run("drop table mytbl");
  driver.run("drop database mydb");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatDynamicPartitioned </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run the dynamic partitioning test but with multiple map task. See HCATALOG-490
 * @throws Exception
 */
@Test public void testHCatDynamicPartitionedTableMultipleTask() throws Exception {
  runHCatDynamicPartitionedTable(false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Run the dynamic partitioning test but with single map task
 * @throws Exception
 */
@Test public void testHCatDynamicPartitionedTable() throws Exception {
  runHCatDynamicPartitionedTable(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.pig.TestHCatLoaderComplexSchema </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * tests that unnecessary tuples are drop while converting schema
 * (Pig requires Tuples in Bags)
 * @throws Exception
 */
@Test public void testTupleInBagInTupleInBag() throws Exception {
  String pigSchema="a: { b : ( c: { d: (i : long) } ) }";
  String tableSchema="a array< array< bigint > >";
  List<Tuple> data=new ArrayList<Tuple>();
  data.add(t(b(t(b(t(100l),t(101l))),t(b(t(110l))))));
  data.add(t(b(t(b(t(200l))),t(b(t(210l))),t(b(t(220l))))));
  data.add(t(b(t(b(t(300l),t(301l))))));
  data.add(t(b(t(b(t(400l))),t(b(t(410l),t(411l),t(412l))))));
  verifyWriteRead("TupleInBagInTupleInBag1",pigSchema,tableSchema,data,true);
  verifyWriteRead("TupleInBagInTupleInBag2",pigSchema,tableSchema,data,false);
  String tableSchema2="a array< struct< c: array< struct< i: bigint > > > >";
  verifyWriteRead("TupleInBagInTupleInBag3",pigSchema,tableSchema2,data,true);
  verifyWriteRead("TupleInBagInTupleInBag4",pigSchema,tableSchema2,data,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMapWithComplexData() throws Exception {
  String pigSchema="a: long, b: map[]";
  String tableSchema="a bigint, b map<string, struct<aa:bigint, ab:string>>";
  List<Tuple> data=new ArrayList<Tuple>();
  for (int i=0; i < 10; i++) {
    Tuple t=t((long)i,new HashMap<String,Object>(){
{
        put("b test 1",t(1l,"test 1"));
        put("b test 2",t(2l,"test 2"));
      }
    }
);
    data.add(t);
  }
  verifyWriteRead("testMapWithComplexData",pigSchema,tableSchema,data,true);
  verifyWriteRead("testMapWithComplexData2",pigSchema,tableSchema,data,false);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * artificially complex nested schema to test nested schema conversion
 * @throws Exception
 */
@Test public void testSyntheticComplexSchema() throws Exception {
  String pigSchema="a: " + "(" + "aa: chararray, "+ "ab: long, "+ "ac: map[], "+ "ad: { t: (ada: long) }, "+ "ae: { t: (aea:long, aeb: ( aeba: chararray, aebb: long)) },"+ "af: (afa: chararray, afb: long) "+ "),"+ "b: chararray, "+ "c: long, "+ "d:  { t: (da:long, db: ( dba: chararray, dbb: long), dc: { t: (dca: long) } ) } ";
  String tableSchema="a struct<" + "aa: string, " + "ab: bigint, "+ "ac: map<string, string>, "+ "ad: array<struct<ada:bigint>>, "+ "ae: array<struct<aea:bigint, aeb: struct<aeba: string, aebb: bigint>>>,"+ "af: struct<afa: string, afb: bigint> "+ ">, "+ "b string, "+ "c bigint, "+ "d array<struct<da: bigint, db: struct<dba:string, dbb:bigint>, dc: array<struct<dca: bigint>>>>";
  String tableSchema2="a struct<" + "aa: string, " + "ab: bigint, "+ "ac: map<string, string>, "+ "ad: array<bigint>, "+ "ae: array<struct<aea:bigint, aeb: struct<aeba: string, aebb: bigint>>>,"+ "af: struct<afa: string, afb: bigint> "+ ">, "+ "b string, "+ "c bigint, "+ "d array<struct<da: bigint, db: struct<dba:string, dbb:bigint>, dc: array<bigint>>>";
  List<Tuple> data=new ArrayList<Tuple>();
  for (int i=0; i < 10; i++) {
    Tuple t=t(t("aa test",2l,new HashMap<String,String>(){
{
        put("ac test1","test 1");
        put("ac test2","test 2");
      }
    }
,b(t(3l),t(4l)),b(t(5l,t("aeba test",6l))),t("afa test",7l)),"b test",(long)i,b(t(8l,t("dba test",9l),b(t(10l)))));
    data.add(t);
  }
  verifyWriteRead("testSyntheticComplexSchema",pigSchema,tableSchema,data,true);
  verifyWriteRead("testSyntheticComplexSchema",pigSchema,tableSchema,data,false);
  verifyWriteRead("testSyntheticComplexSchema2",pigSchema,tableSchema2,data,true);
  verifyWriteRead("testSyntheticComplexSchema2",pigSchema,tableSchema2,data,false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.security.TestHdfsAuthorizationProvider </h4><pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableFail4() throws Exception {
  exec("CREATE DATABASE doo");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm500);
  execFail("CREATE EXTERNAL TABLE doo.foo5 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  execFail("CREATE EXTERNAL TABLE doo.foo6 (foo INT) STORED AS RCFILE LOCATION '%s/a/a/a/'",tablePath);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTableFail() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (boo STRING) STORED AS TEXTFILE");
  whFs.mkdirs(getTablePath("default","foo1"),perm500);
  execFail("ALTER TABLE foo1 SET TBLPROPERTIES ('foo'='bar')");
  execFail("ALTER TABLE foo1 SET SERDEPROPERTIES ('foo'='bar')");
  execFail("ALTER TABLE foo1 ADD COLUMNS (foo2 INT)");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateDatabaseFail2() throws Exception {
  Path dbPath=new Path(whPath,new Random().nextInt() + "/mydb");
  whFs.mkdirs(dbPath,perm700);
  whFs.setPermission(dbPath,perm500);
  execFail("CREATE DATABASE doo2 LOCATION '%s'",dbPath.toUri());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTablePartRelocateFail() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS RCFILE");
  Path oldLoc=new Path(whPath,new Random().nextInt() + "/mypart");
  Path newLoc=new Path(whPath,new Random().nextInt() + "/mypart2");
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-16') LOCATION '%s'",oldLoc);
  whFs.mkdirs(oldLoc,perm500);
  execFail("ALTER TABLE foo1 PARTITION (b='2010-10-16') SET LOCATION '%s'",newLoc.makeQualified(whFs));
  whFs.mkdirs(oldLoc,perm700);
  whFs.mkdirs(newLoc,perm500);
  execFail("ALTER TABLE foo1 PARTITION (b='2010-10-16') SET LOCATION '%s'",newLoc.makeQualified(whFs));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTablePartRelocate() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS RCFILE");
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-16')");
  Path partPath=new Path(whPath,new Random().nextInt() + "/mypart");
  exec("ALTER TABLE foo1 PARTITION (b='2010-10-16') SET LOCATION '%s'",partPath.makeQualified(whFs));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableFail3() throws Exception {
  exec("CREATE DATABASE doo");
  whFs.setPermission(getDbPath("doo"),perm500);
  execFail("CREATE TABLE doo.foo4 (foo INT) STORED AS RCFILE");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm700);
  exec("USE doo");
  execFail("CREATE EXTERNAL TABLE foo5 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropTableFail4() throws Exception {
  exec("CREATE DATABASE doo");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  exec("CREATE EXTERNAL TABLE doo.foo5 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  whFs.mkdirs(tablePath,perm500);
  exec("USE doo");
  execFail("DROP TABLE foo5");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDatabaseOps() throws Exception {
  exec("SHOW TABLES");
  exec("SHOW TABLE EXTENDED LIKE foo1");
  whFs.setPermission(whPath,perm700);
  exec("CREATE DATABASE doo");
  exec("DESCRIBE DATABASE doo");
  exec("USE doo");
  exec("SHOW TABLES");
  exec("SHOW TABLE EXTENDED LIKE foo1");
  exec("DROP DATABASE doo");
  Path dbPath=new Path(whPath,new Random().nextInt() + "/mydb");
  whFs.mkdirs(dbPath,perm700);
  exec("CREATE DATABASE doo2 LOCATION '%s'",dbPath.toUri());
  exec("DESCRIBE DATABASE doo2",dbPath.toUri());
  exec("USE doo2");
  exec("SHOW TABLES");
  exec("SHOW TABLE EXTENDED LIKE foo1");
  exec("DROP DATABASE doo2",dbPath.toUri());
  exec("CREATE DATABASE doo3 LOCATION '%s/subpath'",dbPath.toUri());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTableRelocate() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  exec("ALTER TABLE foo1 SET LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable2");
  exec("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable2");
  exec("ALTER TABLE foo3 SET LOCATION '%s'",tablePath.makeQualified(whFs));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTableRenameFail() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  whFs.mkdirs(getTablePath("default","foo1"),perm500);
  execFail("ALTER TABLE foo1 RENAME TO foo2");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  exec("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  whFs.mkdirs(tablePath,perm500);
  execFail("ALTER TABLE foo3 RENAME TO foo4");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropTableFail1() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  whFs.mkdirs(getTablePath("default","foo1"),perm500);
  execFail("DROP TABLE foo1");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTablePartRename() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS RCFILE");
  Path loc=new Path(whPath,new Random().nextInt() + "/mypart");
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-16') LOCATION '%s'",loc);
  exec("ALTER TABLE foo1 PARTITION (b='2010-10-16') RENAME TO PARTITION (b='2010-10-17')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropTableFail2() throws Exception {
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  exec("CREATE EXTERNAL TABLE foo2 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  whFs.mkdirs(tablePath,perm500);
  execFail("DROP TABLE foo2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTableRename() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  exec("ALTER TABLE foo1 RENAME TO foo2");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  exec("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  exec("ALTER TABLE foo3 RENAME TO foo4");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTable() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS TEXTFILE");
  exec("ALTER TABLE foo1 SET TBLPROPERTIES ('foo'='bar')");
  exec("ALTER TABLE foo1 SET SERDEPROPERTIES ('foo'='bar')");
  exec("ALTER TABLE foo1 ADD COLUMNS (foo2 INT)");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShowDatabases() throws Exception {
  exec("CREATE DATABASE doo");
  exec("SHOW DATABASES");
  whFs.setPermission(whPath,perm300);
  execFail("SHOW DATABASES");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShowTables() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (boo STRING) STORED AS TEXTFILE");
  exec("SHOW PARTITIONS foo1");
  whFs.mkdirs(getTablePath("default","foo1"),perm300);
  execFail("SHOW PARTITIONS foo1");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests whether the warehouse directory is writable by the current user (as defined by Hadoop)
 */
@Test public void testWarehouseIsWritable() throws Exception {
  Path top=new Path(whPath,"_foobarbaz12_");
  try {
    whFs.mkdirs(top);
  }
  finally {
    whFs.delete(top,true);
  }
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateDatabaseFail1() throws Exception {
  whFs.setPermission(whPath,perm500);
  execFail("CREATE DATABASE doo");
  whFs.setPermission(whPath,perm555);
  execFail("CREATE DATABASE doo2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDescSwitchDatabaseFail() throws Exception {
  whFs.setPermission(whPath,perm700);
  exec("CREATE DATABASE doo");
  whFs.setPermission(getDbPath("doo"),perm300);
  execFail("DESCRIBE DATABASE doo");
  execFail("USE doo");
  Path dbPath=new Path(whPath,new Random().nextInt() + "/mydb");
  whFs.mkdirs(dbPath,perm700);
  exec("CREATE DATABASE doo2 LOCATION '%s'",dbPath.toUri());
  whFs.mkdirs(dbPath,perm300);
  execFail("DESCRIBE DATABASE doo2",dbPath.toUri());
  execFail("USE doo2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropPartitionFail1() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS TEXTFILE");
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-10')");
  whFs.mkdirs(getPartPath("b=2010-10-10","default","foo1"),perm500);
  execFail("ALTER TABLE foo1 DROP PARTITION (b='2010-10-10')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropDatabaseFail1() throws Exception {
  whFs.setPermission(whPath,perm700);
  exec("CREATE DATABASE doo");
  whFs.setPermission(getDbPath("doo"),perm500);
  execFail("DROP DATABASE doo");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShowTablesFail() throws Exception {
  whFs.setPermission(whPath,perm700);
  exec("CREATE DATABASE doo");
  exec("USE doo");
  whFs.setPermission(getDbPath("doo"),perm300);
  execFail("SHOW TABLES");
  execFail("SHOW TABLE EXTENDED LIKE foo1");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddDropPartition() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS TEXTFILE");
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-10')");
  exec("ALTER TABLE foo1 ADD IF NOT EXISTS PARTITION (b='2010-10-10')");
  String relPath=new Random().nextInt() + "/mypart";
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-11') LOCATION '%s'",relPath);
  exec("ALTER TABLE foo1 PARTITION (b='2010-10-10') SET FILEFORMAT RCFILE");
  exec("ALTER TABLE foo1 PARTITION (b='2010-10-10') SET FILEFORMAT INPUTFORMAT " + "'org.apache.hadoop.hive.ql.io.RCFileInputFormat' OUTPUTFORMAT " + "'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' inputdriver "+ "'mydriver' outputdriver 'yourdriver'");
  exec("ALTER TABLE foo1 DROP PARTITION (b='2010-10-10')");
  exec("ALTER TABLE foo1 DROP PARTITION (b='2010-10-11')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropDatabaseFail2() throws Exception {
  Path dbPath=new Path(whPath,new Random().nextInt() + "/mydb");
  whFs.mkdirs(dbPath,perm700);
  exec("CREATE DATABASE doo2 LOCATION '%s'",dbPath.toUri());
  whFs.setPermission(dbPath,perm500);
  execFail("DROP DATABASE doo2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTableOps() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  exec("DESCRIBE foo1");
  exec("DROP TABLE foo1");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm700);
  exec("CREATE EXTERNAL TABLE foo2 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  exec("DESCRIBE foo2");
  exec("DROP TABLE foo2");
  exec("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s/subpath'",tablePath);
  exec("DESCRIBE foo3");
  exec("DROP TABLE foo3");
  exec("CREATE DATABASE doo");
  exec("USE doo");
  exec("CREATE TABLE foo4 (foo INT) STORED AS RCFILE");
  exec("DESCRIBE foo4");
  exec("DROP TABLE foo4");
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm700);
  exec("CREATE EXTERNAL TABLE foo5 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  exec("DESCRIBE foo5");
  exec("DROP TABLE foo5");
  exec("CREATE EXTERNAL TABLE foo6 (foo INT) STORED AS RCFILE LOCATION '%s/subpath'",tablePath);
  exec("DESCRIBE foo6");
  exec("DROP TABLE foo6");
  exec("DROP TABLE IF EXISTS foo_non_exists");
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  exec("DESCRIBE EXTENDED foo1");
  exec("DESCRIBE FORMATTED foo1");
  exec("DESCRIBE foo1.foo");
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm700);
  exec("CREATE EXTERNAL TABLE foo2 (foo INT) STORED AS RCFILE LOCATION '%s/a/a/a/'",tablePath);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddPartitionFail2() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS TEXTFILE");
  String relPath=new Random().nextInt() + "/mypart";
  Path partPath=new Path(getTablePath("default","foo1"),relPath);
  whFs.mkdirs(partPath,perm500);
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-10') LOCATION '%s'",partPath);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableFail2() throws Exception {
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm500);
  execFail("CREATE EXTERNAL TABLE foo2 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  execFail("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s/subpath'",tablePath);
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTableRelocateFail() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm500);
  execFail("ALTER TABLE foo1 SET LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable2");
  exec("CREATE EXTERNAL TABLE foo3 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable2");
  whFs.mkdirs(tablePath,perm500);
  execFail("ALTER TABLE foo3 SET LOCATION '%s'",tablePath.makeQualified(whFs));
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable3");
  exec("CREATE EXTERNAL TABLE foo4 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath.makeQualified(whFs));
  whFs.mkdirs(tablePath,perm500);
  tablePath=new Path(whPath,new Random().nextInt() + "/mytable3");
  execFail("ALTER TABLE foo4 SET LOCATION '%s'",tablePath.makeQualified(whFs));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddPartitionFail1() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS TEXTFILE");
  whFs.mkdirs(getTablePath("default","foo1"),perm500);
  execFail("ALTER TABLE foo1 ADD PARTITION (b='2010-10-10')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateTableFail1() throws Exception {
  whFs.mkdirs(whPath,perm500);
  execFail("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDescTableFail() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) STORED AS RCFILE");
  whFs.mkdirs(getTablePath("default","foo1"),perm300);
  execFail("DESCRIBE foo1");
  Path tablePath=new Path(whPath,new Random().nextInt() + "/mytable");
  whFs.mkdirs(tablePath,perm700);
  exec("CREATE EXTERNAL TABLE foo2 (foo INT) STORED AS RCFILE LOCATION '%s'",tablePath);
  whFs.mkdirs(tablePath,perm300);
  execFail("DESCRIBE foo2");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAlterTablePartRenameFail() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS RCFILE");
  Path loc=new Path(whPath,new Random().nextInt() + "/mypart");
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-16') LOCATION '%s'",loc);
  whFs.setPermission(loc,perm500);
  execFail("ALTER TABLE foo1 PARTITION (b='2010-10-16') RENAME TO PARTITION (b='2010-10-17')");
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDropPartitionFail2() throws Exception {
  exec("CREATE TABLE foo1 (foo INT) PARTITIONED BY (b STRING) STORED AS TEXTFILE");
  String relPath=new Random().nextInt() + "/mypart";
  Path partPath=new Path(getTablePath("default","foo1"),relPath);
  whFs.mkdirs(partPath,perm700);
  exec("ALTER TABLE foo1 ADD PARTITION (b='2010-10-10') LOCATION '%s'",partPath);
  whFs.mkdirs(partPath,perm500);
  execFail("ALTER TABLE foo1 DROP PARTITION (b='2010-10-10')");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
