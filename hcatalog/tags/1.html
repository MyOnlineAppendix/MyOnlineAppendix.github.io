<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hcatalog.api.TestHCatClient </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPartitionsHCatClientImpl() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String dbName="ptnDB";
  String tableName="pageView";
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(dbName).ifNotExists(true).build();
  client.createDatabase(dbDesc);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("userid",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("viewtime",Type.BIGINT,"view time columns"));
  cols.add(new HCatFieldSchema("pageurl",Type.STRING,""));
  cols.add(new HCatFieldSchema("ip",Type.STRING,"IP Address of the User"));
  ArrayList<HCatFieldSchema> ptnCols=new ArrayList<HCatFieldSchema>();
  ptnCols.add(new HCatFieldSchema("dt",Type.STRING,"date column"));
  ptnCols.add(new HCatFieldSchema("country",Type.STRING,"country column"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(dbName,tableName,cols).fileFormat("sequencefile").partCols(ptnCols).build();
  client.createTable(tableDesc);
  Map<String,String> firstPtn=new HashMap<String,String>();
  firstPtn.put("dt","04/30/2012");
  firstPtn.put("country","usa");
  HCatAddPartitionDesc addPtn=HCatAddPartitionDesc.create(dbName,tableName,null,firstPtn).build();
  client.addPartition(addPtn);
  Map<String,String> secondPtn=new HashMap<String,String>();
  secondPtn.put("dt","04/12/2012");
  secondPtn.put("country","brazil");
  HCatAddPartitionDesc addPtn2=HCatAddPartitionDesc.create(dbName,tableName,null,secondPtn).build();
  client.addPartition(addPtn2);
  Map<String,String> thirdPtn=new HashMap<String,String>();
  thirdPtn.put("dt","04/13/2012");
  thirdPtn.put("country","argentina");
  HCatAddPartitionDesc addPtn3=HCatAddPartitionDesc.create(dbName,tableName,null,thirdPtn).build();
  client.addPartition(addPtn3);
  List<HCatPartition> ptnList=client.listPartitionsByFilter(dbName,tableName,null);
  assertTrue(ptnList.size() == 3);
  HCatPartition ptn=client.getPartition(dbName,tableName,firstPtn);
  assertTrue(ptn != null);
  client.dropPartitions(dbName,tableName,firstPtn,true);
  ptnList=client.listPartitionsByFilter(dbName,tableName,null);
  assertTrue(ptnList.size() == 2);
  List<HCatPartition> ptnListTwo=client.listPartitionsByFilter(dbName,tableName,"country = \"argentina\"");
  assertTrue(ptnListTwo.size() == 1);
  client.markPartitionForEvent(dbName,tableName,thirdPtn,PartitionEventType.LOAD_DONE);
  boolean isMarked=client.isPartitionMarkedForEvent(dbName,tableName,thirdPtn,PartitionEventType.LOAD_DONE);
  assertTrue(isMarked);
  client.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateTableSchema() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="testUpdateTableSchema_DBName";
    final String tableName="testUpdateTableSchema_TableName";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> oldSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,oldSchema).build());
    List<HCatFieldSchema> newSchema=Arrays.asList(new HCatFieldSchema("completely",Type.DOUBLE,""),new HCatFieldSchema("new",Type.FLOAT,""),new HCatFieldSchema("fields",Type.STRING,""));
    client.updateTableSchema(dbName,tableName,newSchema);
    assertArrayEquals(newSchema.toArray(),client.getTable(dbName,tableName).getCols().toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception exception) {
    LOG.error("Unexpected exception.",exception);
    assertTrue("Unexpected exception: " + exception.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDatabaseLocation() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String dbName="locationDB";
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(dbName).ifNotExists(true).location("/tmp/" + dbName).build();
  client.createDatabase(dbDesc);
  HCatDatabase newDB=client.getDatabase(dbName);
  assertTrue(newDB.getLocation().equalsIgnoreCase("file:/tmp/" + dbName));
  client.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionSchema() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,columnSchema).partCols(partitionSchema).build());
    HCatTable table=client.getTable(dbName,tableName);
    List<HCatFieldSchema> partitionColumns=table.getPartCols();
    assertArrayEquals("Didn't get expected partition-schema back from the HCatTable.",partitionSchema.toArray(),partitionColumns.toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDropTableException() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String tableName="tableToBeDropped";
  boolean isExceptionCaught=false;
  client.dropTable(null,tableName,true);
  try {
    client.dropTable(null,tableName,false);
  }
 catch (  Exception exp) {
    isExceptionCaught=true;
    assertTrue(exp instanceof HCatException);
    LOG.info("Drop Table Exception: " + exp.getCause());
  }
 finally {
    client.close();
    assertTrue("The expected exception was never thrown.",isExceptionCaught);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testOtherFailure() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String tableName="Temptable";
  boolean isExceptionCaught=false;
  client.dropTable(null,tableName,true);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"id columns"));
  try {
    HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(null,tableName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc);
    client.getTable("foo",tableName);
  }
 catch (  Exception exp) {
    isExceptionCaught=true;
    assertTrue(exp instanceof HCatException);
    String newName="goodTable";
    client.dropTable(null,newName,true);
    HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(null,newName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc2);
    HCatTable newTable=client.getTable(null,newName);
    assertTrue(newTable != null);
    assertTrue(newTable.getTableName().equalsIgnoreCase(newName));
  }
 finally {
    client.close();
    assertTrue("The expected exception was never thrown.",isExceptionCaught);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCreateTableLike() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String tableName="tableone";
  String cloneTable="tabletwo";
  client.dropTable(null,tableName,true);
  client.dropTable(null,cloneTable,true);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"id columns"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(null,tableName,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  client.createTableLike(null,tableName,cloneTable,true,false,null);
  List<String> tables=client.listTableNamesByPattern(null,"table*");
  assertTrue(tables.size() == 2);
  client.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRenameTable() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  String tableName="temptable";
  String newName="mytable";
  client.dropTable(null,tableName,true);
  client.dropTable(null,newName,true);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"id columns"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(null,tableName,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  client.renameTable(null,tableName,newName);
  try {
    client.getTable(null,tableName);
  }
 catch (  HCatException exp) {
    assertTrue("Unexpected exception message: " + exp.getMessage(),exp.getMessage().contains("NoSuchObjectException while fetching table"));
  }
  HCatTable newTable=client.getTable(null,newName);
  assertTrue(newTable != null);
  assertTrue(newTable.getTableName().equals(newName));
  client.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropPartitionsWithPartialSpec() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,columnSchema).partCols(new ArrayList<HCatFieldSchema>(partitionSchema)).build());
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2011_12_31");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2012_01_01");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","OB");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","XB");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    Map<String,String> partialPartitionSpec=new HashMap<String,String>();
    partialPartitionSpec.put("dt","2012_01_01");
    client.dropPartitions(dbName,tableName,partialPartitionSpec,true);
    List<HCatPartition> partitions=client.getPartitions(dbName,tableName);
    assertEquals("Unexpected number of partitions.",1,partitions.size());
    assertArrayEquals("Mismatched partition.",new String[]{"2011_12_31","AB"},partitions.get(0).getValues().toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPartitionsWithPartialSpec() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,columnSchema).partCols(new ArrayList<HCatFieldSchema>(partitionSchema)).build());
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2011_12_31");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2012_01_01");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","OB");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","XB");
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    Map<String,String> partialPartitionSpec=new HashMap<String,String>();
    partialPartitionSpec.put("dt","2012_01_01");
    List<HCatPartition> partitions=client.getPartitions(dbName,tableName,partialPartitionSpec);
    assertEquals("Unexpected number of partitions.",3,partitions.size());
    assertArrayEquals("Mismatched partition.",new String[]{"2012_01_01","AB"},partitions.get(0).getValues().toArray());
    assertArrayEquals("Mismatched partition.",new String[]{"2012_01_01","OB"},partitions.get(1).getValues().toArray());
    assertArrayEquals("Mismatched partition.",new String[]{"2012_01_01","XB"},partitions.get(2).getValues().toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testObjectNotFoundException() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    String dbName="testObjectNotFoundException_DBName";
    String tableName="testObjectNotFoundException_TableName";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    try {
      client.getDatabase(dbName);
      assertTrue("Expected ObjectNotFoundException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected ObjectNotFoundException. Got:" + exception.getClass(),exception instanceof ObjectNotFoundException);
    }
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    try {
      client.getTable(dbName,tableName);
      assertTrue("Expected ObjectNotFoundException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected ObjectNotFoundException. Got:" + exception.getClass(),exception instanceof ObjectNotFoundException);
    }
    String partitionColumn="part";
    List<HCatFieldSchema> columns=Arrays.asList(new HCatFieldSchema("col",Type.STRING,""));
    ArrayList<HCatFieldSchema> partitionColumns=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema(partitionColumn,Type.STRING,"")));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,columns).partCols(partitionColumns).build());
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put(partitionColumn,"foobar");
    try {
      client.getPartition(dbName,tableName,partitionSpec);
      assertTrue("Expected ObjectNotFoundException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected ObjectNotFoundException. Got:" + exception.getClass(),exception instanceof ObjectNotFoundException);
    }
    client.addPartition(HCatAddPartitionDesc.create(dbName,tableName,"",partitionSpec).build());
    assertEquals("Expected empty set of partitions.",0,client.listPartitionsByFilter(dbName,tableName,partitionColumn + " < 'foobar'").size());
    try {
      partitionSpec.put("NonExistentKey","foobar");
      client.getPartition(dbName,tableName,partitionSpec);
      assertTrue("Expected HCatException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected HCatException. Got:" + exception.getClass(),exception instanceof HCatException);
      assertFalse("Did not expect ObjectNotFoundException.",exception instanceof ObjectNotFoundException);
    }
  }
 catch (  Throwable t) {
    LOG.error("Unexpected exception!",t);
    assertTrue("Unexpected exception! " + t.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransportFailure() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  boolean isExceptionCaught=false;
  final String tableName="Temptable" + new BigInteger(200,new Random()).toString(2);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"id columns"));
  try {
    HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(null,tableName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc);
  }
 catch (  Exception exp) {
    isExceptionCaught=true;
    assertEquals("Unexpected exception type.",HCatException.class,exp.getClass());
    client=HCatClient.create(new Configuration(hcatConf));
    String newName="goodTable";
    client.dropTable(null,newName,true);
    HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(null,newName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc2);
    HCatTable newTable=client.getTable(null,newName);
    assertTrue(newTable != null);
    assertTrue(newTable.getTableName().equalsIgnoreCase(newName));
  }
 finally {
    client.close();
    assertTrue("The expected exception was never thrown.",isExceptionCaught);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMessageBusTopicName() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    String dbName="testGetMessageBusTopicName_DBName";
    String tableName="testGetMessageBusTopicName_TableName";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    String messageBusTopicName="MY.topic.name";
    Map<String,String> tableProperties=new HashMap<String,String>(1);
    tableProperties.put(HCatConstants.HCAT_MSGBUS_TOPIC_NAME,messageBusTopicName);
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,Arrays.asList(new HCatFieldSchema("foo",Type.STRING,""))).tblProps(tableProperties).build());
    assertEquals("MessageBus topic-name doesn't match!",messageBusTopicName,client.getMessageBusTopicName(dbName,tableName));
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.close();
  }
 catch (  Exception exception) {
    LOG.error("Unexpected exception.",exception);
    assertTrue("Unexpected exception:" + exception.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBasicDDLCommands() throws Exception {
  String db="testdb";
  String tableOne="testTable1";
  String tableTwo="testTable2";
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  client.dropDatabase(db,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(db).ifNotExists(false).build();
  client.createDatabase(dbDesc);
  List<String> dbNames=client.listDatabaseNamesByPattern("*");
  assertTrue(dbNames.contains("default"));
  assertTrue(dbNames.contains(db));
  HCatDatabase testDb=client.getDatabase(db);
  assertTrue(testDb.getComment() == null);
  assertTrue(testDb.getProperties().size() == 0);
  String warehouseDir=System.getProperty(ConfVars.METASTOREWAREHOUSE.varname,"/user/hive/warehouse");
  assertTrue(testDb.getLocation().equals("file:" + warehouseDir + "/"+ db+ ".db"));
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id comment"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"value comment"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(db,tableOne,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  HCatTable table1=client.getTable(db,tableOne);
  assertTrue(table1.getInputFileFormat().equalsIgnoreCase(RCFileInputFormat.class.getName()));
  assertTrue(table1.getOutputFileFormat().equalsIgnoreCase(RCFileOutputFormat.class.getName()));
  assertTrue(table1.getSerdeLib().equalsIgnoreCase(ColumnarSerDe.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  try {
    client.createTable(tableDesc);
  }
 catch (  HCatException e) {
    assertTrue(e.getMessage().contains("AlreadyExistsException while creating table."));
  }
  client.dropTable(db,tableOne,true);
  HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(db,tableTwo,cols).build();
  client.createTable(tableDesc2);
  HCatTable table2=client.getTable(db,tableTwo);
  assertTrue(table2.getInputFileFormat().equalsIgnoreCase(TextInputFormat.class.getName()));
  assertTrue(table2.getOutputFileFormat().equalsIgnoreCase(IgnoreKeyTextOutputFormat.class.getName()));
  assertTrue(table2.getLocation().equalsIgnoreCase("file:" + warehouseDir + "/"+ db+ ".db/"+ tableTwo));
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.cli.TestSemanticAnalysis </h4><pre class="type-7 type-1 type-2 type-4 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTableIfNotExists() throws MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table " + TBL_NAME);
  hcatDriver.run("create table junit_sem_analysis (a int) stored as RCFILE");
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  List<FieldSchema> cols=tbl.getSd().getCols();
  assertEquals(1,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a","int",null)));
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  CommandProcessorResponse resp=hcatDriver.run("create table if not exists junit_sem_analysis (a int) stored as RCFILE");
  assertEquals(0,resp.getResponseCode());
  assertNull(resp.getErrorMessage());
  tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  cols=tbl.getSd().getCols();
  assertEquals(1,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a","int",null)));
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescDB() throws CommandNeedRetryException, IOException {
  hcatDriver.run("drop database mydb cascade");
  assertEquals(0,hcatDriver.run("create database mydb").getResponseCode());
  CommandProcessorResponse resp=hcatDriver.run("describe database mydb");
  assertEquals(0,resp.getResponseCode());
  ArrayList<String> result=new ArrayList<String>();
  hcatDriver.getResults(result);
  assertTrue(result.get(0).contains("mydb.db"));
  hcatDriver.run("drop database mydb cascade");
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-4 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddReplaceCols() throws IOException, MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  hcatDriver.run("create table junit_sem_analysis (a int, c string) partitioned by (b string) stored as RCFILE");
  CommandProcessorResponse response=hcatDriver.run("alter table junit_sem_analysis replace columns (a1 tinyint)");
  assertEquals(0,response.getResponseCode());
  response=hcatDriver.run("alter table junit_sem_analysis add columns (d tinyint)");
  assertEquals(0,response.getResponseCode());
  assertNull(response.getErrorMessage());
  response=hcatDriver.run("describe extended junit_sem_analysis");
  assertEquals(0,response.getResponseCode());
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  List<FieldSchema> cols=tbl.getSd().getCols();
  assertEquals(2,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a1","tinyint",null)));
  assertTrue(cols.get(1).equals(new FieldSchema("d","tinyint",null)));
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-9 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseOperations() throws MetaException, CommandNeedRetryException {
  List<String> dbs=client.getAllDatabases();
  String testDb1="testdatabaseoperatons1";
  String testDb2="testdatabaseoperatons2";
  if (dbs.contains(testDb1.toLowerCase())) {
    assertEquals(0,hcatDriver.run("drop database " + testDb1).getResponseCode());
  }
  if (dbs.contains(testDb2.toLowerCase())) {
    assertEquals(0,hcatDriver.run("drop database " + testDb2).getResponseCode());
  }
  assertEquals(0,hcatDriver.run("create database " + testDb1).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb1));
  assertEquals(0,hcatDriver.run("create database if not exists " + testDb1).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb1));
  assertEquals(0,hcatDriver.run("create database if not exists " + testDb2).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb2));
  assertEquals(0,hcatDriver.run("drop database " + testDb1).getResponseCode());
  assertEquals(0,hcatDriver.run("drop database " + testDb2).getResponseCode());
  assertFalse(client.getAllDatabases().contains(testDb1));
  assertFalse(client.getAllDatabases().contains(testDb2));
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCTAS() throws CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  query="create table junit_sem_analysis (a int) as select * from tbl2";
  CommandProcessorResponse response=hcatDriver.run(query);
  assertEquals(40000,response.getResponseCode());
  assertTrue(response.getErrorMessage().contains("FAILED: SemanticException Operation not supported. Create table as Select is not a valid operation."));
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.common.TestHCatUtil </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testExecutePermissionsCheck(){
  Assert.assertTrue(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.ALL));
  Assert.assertTrue(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.NONE));
  Assert.assertTrue(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.EXECUTE));
  Assert.assertTrue(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.READ_EXECUTE));
  Assert.assertTrue(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.WRITE_EXECUTE));
  Assert.assertFalse(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.READ));
  Assert.assertFalse(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.WRITE));
  Assert.assertFalse(HCatUtil.validateExecuteBitPresentIfReadOrWrite(FsAction.READ_WRITE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.common.TestHiveClientCache </h4><pre class="type-1 type-2 type-12 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that a new client is returned for the same configuration after the expiry time.
 * Also verify that the expiry time configuration is honoured
 */
@Test public void testCacheExpiry() throws IOException, MetaException, LoginException, InterruptedException {
  HiveClientCache cache=new HiveClientCache(1);
  HiveClientCache.CacheableHiveMetaStoreClient client=(HiveClientCache.CacheableHiveMetaStoreClient)cache.get(hiveConf);
  assertNotNull(client);
  Thread.sleep(2500);
  HiveMetaStoreClient client2=cache.get(hiveConf);
  client.close();
  assertTrue(client.isClosed());
  assertNotNull(client2);
  assertNotSame(client,client2);
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCloseAllClients() throws IOException, MetaException, LoginException {
  final HiveClientCache cache=new HiveClientCache(1000);
  HiveClientCache.CacheableHiveMetaStoreClient client1=(HiveClientCache.CacheableHiveMetaStoreClient)cache.get(hiveConf);
  hiveConf.setVar(HiveConf.ConfVars.METASTOREURIS," ");
  HiveClientCache.CacheableHiveMetaStoreClient client2=(HiveClientCache.CacheableHiveMetaStoreClient)cache.get(hiveConf);
  cache.closeAllClientsQuietly();
  assertTrue(client1.isClosed());
  assertTrue(client2.isClosed());
}

</code></pre>

<br>
<pre class="type-15 type-1 type-2 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Test that a long table name actually breaks the HMSC. Subsequently check that isOpen() reflects
 * and tells if the client is broken
 */
@Ignore("hangs indefinitely") @Test public void testHMSCBreakability() throws IOException, MetaException, LoginException, TException, AlreadyExistsException, InvalidObjectException, NoSuchObjectException, InterruptedException {
  LocalMetaServer metaServer=new LocalMetaServer();
  metaServer.start();
  final HiveClientCache cache=new HiveClientCache(1000);
  HiveClientCache.CacheableHiveMetaStoreClient client=(HiveClientCache.CacheableHiveMetaStoreClient)cache.get(metaServer.getHiveConf());
  assertTrue(client.isOpen());
  final String DB_NAME="test_db";
  final String LONG_TABLE_NAME="long_table_name_" + new BigInteger(200,new Random()).toString(2);
  try {
    client.dropTable(DB_NAME,LONG_TABLE_NAME);
  }
 catch (  Exception e) {
  }
  try {
    client.dropDatabase(DB_NAME);
  }
 catch (  Exception e) {
  }
  client.createDatabase(new Database(DB_NAME,"",null,null));
  List<FieldSchema> fields=new ArrayList<FieldSchema>();
  fields.add(new FieldSchema("colname",serdeConstants.STRING_TYPE_NAME,""));
  Table tbl=new Table();
  tbl.setDbName(DB_NAME);
  tbl.setTableName(LONG_TABLE_NAME);
  StorageDescriptor sd=new StorageDescriptor();
  sd.setCols(fields);
  tbl.setSd(sd);
  sd.setSerdeInfo(new SerDeInfo());
  try {
    client.createTable(tbl);
    fail("Exception was expected while creating table with long name");
  }
 catch (  Exception e) {
  }
  assertFalse(client.isOpen());
  metaServer.shutDown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.data.TestLazyHCatRecord </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testRemove() throws Exception {
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector());
  boolean sawException=false;
  try {
    r.remove(0);
  }
 catch (  UnsupportedOperationException uoe) {
    sawException=true;
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testCopy() throws Exception {
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector());
  boolean sawException=false;
  try {
    r.copy(null);
  }
 catch (  UnsupportedOperationException uoe) {
    sawException=true;
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSetWithName() throws Exception {
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector());
  boolean sawException=false;
  try {
    r.set("fred",null,"bob");
  }
 catch (  UnsupportedOperationException uoe) {
    sawException=true;
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testWrite() throws Exception {
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector());
  boolean sawException=false;
  try {
    r.write(null);
  }
 catch (  UnsupportedOperationException uoe) {
    sawException=true;
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSet() throws Exception {
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector());
  boolean sawException=false;
  try {
    r.set(3,"Mary had a little lamb");
  }
 catch (  UnsupportedOperationException uoe) {
    sawException=true;
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testReadFields() throws Exception {
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector());
  boolean sawException=false;
  try {
    r.readFields(null);
  }
 catch (  UnsupportedOperationException uoe) {
    sawException=true;
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.TestHBaseBulkOutputFormat </h4><pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importSequenceFileTest() throws IOException, ClassNotFoundException, InterruptedException {
  String testName="importSequenceFileTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  LOG.info("starting: " + testName);
  String tableName=newTableName(testName).toLowerCase();
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  Configuration conf=new Configuration(allConf);
  createTable(tableName,new String[]{familyName});
  String data[]={"1,english:one,spanish:uno","2,english:two,spanish:dos","3,english:three,spanish:tres"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile.txt"));
  for (  String line : data)   os.write(Bytes.toBytes(line + "\n"));
  os.close();
  Path interPath=new Path(methodTestDir,"inter");
  Path scratchPath=new Path(methodTestDir,"scratch");
  Job job=new Job(conf,testName);
  job.setWorkingDirectory(new Path(methodTestDir,"mr_work"));
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapWrite.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,inputPath);
  job.setOutputFormatClass(SequenceFileOutputFormat.class);
  SequenceFileOutputFormat.setOutputPath(job,interPath);
  job.setMapOutputKeyClass(ImmutableBytesWritable.class);
  job.setMapOutputValueClass(Put.class);
  job.setOutputKeyClass(ImmutableBytesWritable.class);
  job.setOutputValueClass(Put.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  job=new Job(new Configuration(allConf),testName + "_importer");
  assertTrue(ImportSequenceFile.runJob(job,tableName,interPath,scratchPath));
  HTable table=new HTable(conf,tableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int index=0;
  for (  Result result : scanner) {
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
    }
    index++;
  }
  assertEquals(data.length,index);
  assertFalse(FileSystem.get(job.getConfiguration()).exists(scratchPath));
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bulkModeHCatOutputFormatTest() throws Exception {
  String testName="bulkModeHCatOutputFormatTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  LOG.info("starting: " + testName);
  String databaseName=testName.toLowerCase();
  String dbDir=new Path(methodTestDir,"DB_" + testName).toString();
  String tableName=newTableName(testName).toLowerCase();
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  Configuration conf=new Configuration(allConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(allConf.getAllProperties()));
  String dbquery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ dbDir+ "'";
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, english string, spanish string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('"+ HBaseConstants.PROPERTY_BULK_OUTPUT_MODE_KEY+ "'='true',"+ "'hbase.columns.mapping'=':key,"+ familyName+ ":english,"+ familyName+ ":spanish')";
  assertEquals(0,hcatDriver.run(dbquery).getResponseCode());
  assertEquals(0,hcatDriver.run(tableQuery).getResponseCode());
  String data[]={"1,english:ONE,spanish:UNO","2,english:TWO,spanish:DOS","3,english:THREE,spanish:TRES"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  for (int i=0; i < data.length; i++) {
    FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile" + i + ".txt"));
    os.write(Bytes.toBytes(data[i] + "\n"));
    os.close();
  }
  Job job=new Job(conf,testName);
  job.setWorkingDirectory(new Path(methodTestDir,"mr_work"));
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapHCatWrite.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,inputPath);
  job.setOutputFormatClass(HCatOutputFormat.class);
  OutputJobInfo outputJobInfo=OutputJobInfo.create(databaseName,tableName,null);
  HCatOutputFormat.setOutput(job,outputJobInfo);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(HCatRecord.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(HCatRecord.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(conf);
  try {
    TableSnapshot snapshot=rm.createSnapshot(databaseName + "." + tableName);
    for (    String el : snapshot.getColumnFamilies()) {
      assertEquals(1,snapshot.getRevision(el));
    }
  }
  finally {
    rm.close();
  }
  HTable table=new HTable(conf,databaseName + "." + tableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int index=0;
  for (  Result result : scanner) {
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
      assertEquals(1l,result.getColumn(familyNameBytes,Bytes.toBytes(pair[0])).get(0).getTimestamp());
    }
    index++;
  }
  assertEquals(data.length,index);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void hbaseBulkOutputFormatTest() throws IOException, ClassNotFoundException, InterruptedException {
  String testName="hbaseBulkOutputFormatTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  LOG.info("starting: " + testName);
  String tableName=newTableName(testName).toLowerCase();
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  Configuration conf=new Configuration(allConf);
  conf.set(HBaseConstants.PROPERTY_OUTPUT_TABLE_NAME_KEY,tableName);
  conf.set("yarn.scheduler.capacity.root.queues","default");
  conf.set("yarn.scheduler.capacity.root.default.capacity","100");
  createTable(tableName,new String[]{familyName});
  String data[]={"1,english:one,spanish:uno","2,english:two,spanish:dos","3,english:three,spanish:tres"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile.txt"));
  for (  String line : data)   os.write(Bytes.toBytes(line + "\n"));
  os.close();
  Path interPath=new Path(methodTestDir,"inter");
  JobConf job=new JobConf(conf);
  job.setWorkingDirectory(new Path(methodTestDir,"mr_work"));
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapWriteOldMapper.class);
  job.setInputFormat(org.apache.hadoop.mapred.TextInputFormat.class);
  org.apache.hadoop.mapred.TextInputFormat.setInputPaths(job,inputPath);
  job.setOutputFormat(HBaseBulkOutputFormat.class);
  org.apache.hadoop.mapred.SequenceFileOutputFormat.setOutputPath(job,interPath);
  job.setOutputCommitter(HBaseBulkOutputCommitter.class);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(conf);
  try {
    OutputJobInfo outputJobInfo=OutputJobInfo.create("default",tableName,null);
    Transaction txn=rm.beginWriteTransaction(tableName,Arrays.asList(familyName));
    outputJobInfo.getProperties().setProperty(HBaseConstants.PROPERTY_WRITE_TXN_KEY,HCatUtil.serialize(txn));
    job.set(HCatConstants.HCAT_KEY_OUTPUT_INFO,HCatUtil.serialize(outputJobInfo));
  }
  finally {
    rm.close();
  }
  job.setMapOutputKeyClass(ImmutableBytesWritable.class);
  job.setMapOutputValueClass(HCatRecord.class);
  job.setOutputKeyClass(ImmutableBytesWritable.class);
  job.setOutputValueClass(HCatRecord.class);
  job.setNumReduceTasks(0);
  RunningJob runJob=JobClient.runJob(job);
  runJob.waitForCompletion();
  assertTrue(runJob.isSuccessful());
  HTable table=new HTable(conf,tableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int index=0;
  for (  Result result : scanner) {
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
    }
    index++;
  }
  assertEquals(data.length,index);
  assertFalse(FileSystem.get(job).exists(interPath));
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bulkModeHCatOutputFormatTestWithDefaultDB() throws Exception {
  String testName="bulkModeHCatOutputFormatTestWithDefaultDB";
  Path methodTestDir=new Path(getTestDir(),testName);
  String databaseName="default";
  String dbDir=new Path(methodTestDir,"DB_" + testName).toString();
  String tableName=newTableName(testName).toLowerCase();
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  Configuration conf=new Configuration(allConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(allConf.getAllProperties()));
  String dbquery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ dbDir+ "'";
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, english string, spanish string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('"+ HBaseConstants.PROPERTY_BULK_OUTPUT_MODE_KEY+ "'='true',"+ "'hbase.columns.mapping'=':key,"+ familyName+ ":english,"+ familyName+ ":spanish')";
  assertEquals(0,hcatDriver.run(dbquery).getResponseCode());
  assertEquals(0,hcatDriver.run(tableQuery).getResponseCode());
  String data[]={"1,english:ONE,spanish:UNO","2,english:TWO,spanish:DOS","3,english:THREE,spanish:TRES"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile.txt"));
  for (  String line : data)   os.write(Bytes.toBytes(line + "\n"));
  os.close();
  Job job=new Job(conf,testName);
  job.setWorkingDirectory(new Path(methodTestDir,"mr_work"));
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapHCatWrite.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,inputPath);
  job.setOutputFormatClass(HCatOutputFormat.class);
  OutputJobInfo outputJobInfo=OutputJobInfo.create(databaseName,tableName,null);
  HCatOutputFormat.setOutput(job,outputJobInfo);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(HCatRecord.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(HCatRecord.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  HTable table=new HTable(conf,tableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int index=0;
  for (  Result result : scanner) {
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
    }
    index++;
  }
  assertEquals(data.length,index);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void bulkModeAbortTest() throws Exception {
  String testName="bulkModeAbortTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  String databaseName=testName.toLowerCase();
  String dbDir=new Path(methodTestDir,"DB_" + testName).toString();
  String tableName=newTableName(testName).toLowerCase();
  String familyName="my_family";
  Configuration conf=new Configuration(allConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(allConf.getAllProperties()));
  String dbquery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ dbDir+ "'";
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, english string, spanish string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('"+ HBaseConstants.PROPERTY_BULK_OUTPUT_MODE_KEY+ "'='true',"+ "'hbase.columns.mapping'=':key,"+ familyName+ ":english,"+ familyName+ ":spanish')";
  assertEquals(0,hcatDriver.run(dbquery).getResponseCode());
  assertEquals(0,hcatDriver.run(tableQuery).getResponseCode());
  String data[]={"1,english:ONE,spanish:UNO","2,english:TWO,spanish:DOS","3,english:THREE,spanish:TRES"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  for (int i=0; i < data.length; i++) {
    FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile" + i + ".txt"));
    os.write(Bytes.toBytes(data[i] + "\n"));
    os.close();
  }
  Path workingDir=new Path(methodTestDir,"mr_abort");
  OutputJobInfo outputJobInfo=OutputJobInfo.create(databaseName,tableName,null);
  Job job=configureJob(testName,conf,workingDir,MapWriteAbortTransaction.class,outputJobInfo,inputPath);
  assertFalse(job.waitForCompletion(true));
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(conf);
  try {
    TableSnapshot snapshot=rm.createSnapshot(databaseName + "." + tableName);
    for (    String family : snapshot.getColumnFamilies()) {
      assertEquals(1,snapshot.getRevision(family));
      List<FamilyRevision> abortedWriteTransactions=rm.getAbortedWriteTransactions(databaseName + "." + tableName,family);
      assertEquals(1,abortedWriteTransactions.size());
      assertEquals(1,abortedWriteTransactions.get(0).getRevision());
    }
  }
  finally {
    rm.close();
  }
  HTable table=new HTable(conf,databaseName + "." + tableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes(familyName));
  ResultScanner scanner=table.getScanner(scan);
  assertFalse(scanner.iterator().hasNext());
  Path outputDir=new Path(getTestDir(),"mapred/testHBaseTableBulkIgnoreAbortedTransactions");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  job=new Job(conf,"hbase-bulk-aborted-transaction");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadAbortedTransaction.class);
  job.setInputFormatClass(HCatInputFormat.class);
  HCatInputFormat.setInput(job,databaseName,tableName);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.TestHBaseDirectOutputFormat </h4><pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void directOutputFormatTest() throws IOException, ClassNotFoundException, InterruptedException {
  String testName="directOutputFormatTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  String tableName=newTableName(testName).toLowerCase();
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  Configuration conf=new Configuration(allConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(allConf.getAllProperties()));
  createTable(tableName,new String[]{familyName});
  String data[]={"1,english:ONE,spanish:UNO","2,english:ONE,spanish:DOS","3,english:ONE,spanish:TRES"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile.txt"));
  for (  String line : data)   os.write(Bytes.toBytes(line + "\n"));
  os.close();
  JobConf job=new JobConf(conf);
  job.setJobName(testName);
  job.setWorkingDirectory(new Path(methodTestDir,"mr_work"));
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapWrite.class);
  job.setInputFormat(org.apache.hadoop.mapred.TextInputFormat.class);
  org.apache.hadoop.mapred.TextInputFormat.setInputPaths(job,inputPath);
  job.setOutputFormat(HBaseDirectOutputFormat.class);
  job.set(TableOutputFormat.OUTPUT_TABLE,tableName);
  job.set(HBaseConstants.PROPERTY_OUTPUT_TABLE_NAME_KEY,tableName);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(conf);
  try {
    OutputJobInfo outputJobInfo=OutputJobInfo.create("default",tableName,null);
    Transaction txn=rm.beginWriteTransaction(tableName,Arrays.asList(familyName));
    outputJobInfo.getProperties().setProperty(HBaseConstants.PROPERTY_WRITE_TXN_KEY,HCatUtil.serialize(txn));
    job.set(HCatConstants.HCAT_KEY_OUTPUT_INFO,HCatUtil.serialize(outputJobInfo));
  }
  finally {
    rm.close();
  }
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(HCatRecord.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(HCatRecord.class);
  job.setNumReduceTasks(0);
  RunningJob runJob=JobClient.runJob(job);
  runJob.waitForCompletion();
  assertTrue(runJob.isSuccessful());
  HTable table=new HTable(conf,tableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int index=0;
  for (  Result result : scanner) {
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
    }
    index++;
  }
  assertEquals(data.length,index);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void directHCatOutputFormatTest() throws Exception {
  String testName="directHCatOutputFormatTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  String databaseName=testName;
  String dbDir=new Path(methodTestDir,"DB_" + testName).toString();
  String tableName=newTableName(testName);
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  Configuration conf=new Configuration(allConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(allConf.getAllProperties()));
  String dbquery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ dbDir+ "'";
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, english string, spanish string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ("+ "'hbase.columns.mapping'=':key,"+ familyName+ ":english,"+ familyName+ ":spanish')";
  assertEquals(0,hcatDriver.run(dbquery).getResponseCode());
  assertEquals(0,hcatDriver.run(tableQuery).getResponseCode());
  String data[]={"1,english:ONE,spanish:UNO","2,english:ONE,spanish:DOS","3,english:ONE,spanish:TRES"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  for (int i=0; i < data.length; i++) {
    FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile" + i + ".txt"));
    os.write(Bytes.toBytes(data[i] + "\n"));
    os.close();
  }
  Path workingDir=new Path(methodTestDir,"mr_work");
  OutputJobInfo outputJobInfo=OutputJobInfo.create(databaseName,tableName,null);
  Job job=configureJob(testName,conf,workingDir,MapHCatWrite.class,outputJobInfo,inputPath);
  assertTrue(job.waitForCompletion(true));
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(conf);
  try {
    TableSnapshot snapshot=rm.createSnapshot(hbaseTableName);
    for (    String el : snapshot.getColumnFamilies()) {
      assertEquals(1,snapshot.getRevision(el));
    }
  }
  finally {
    rm.close();
  }
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int index=0;
  for (  Result result : scanner) {
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
      assertEquals(1l,result.getColumn(familyNameBytes,Bytes.toBytes(pair[0])).get(0).getTimestamp());
    }
    index++;
  }
  assertEquals(data.length,index);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-12 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void directModeAbortTest() throws Exception {
  String testName="directModeAbortTest";
  Path methodTestDir=new Path(getTestDir(),testName);
  String databaseName=testName;
  String dbDir=new Path(methodTestDir,"DB_" + testName).toString();
  String tableName=newTableName(testName);
  String familyName="my_family";
  byte[] familyNameBytes=Bytes.toBytes(familyName);
  String hbaseTableName=tableName;
  Configuration conf=new Configuration(allConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(allConf.getAllProperties()));
  String dbquery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ dbDir+ "'";
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, english string, spanish string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ("+ "'hbase.columns.mapping'=':key,"+ familyName+ ":english,"+ familyName+ ":spanish','hbase.table.name'='"+ hbaseTableName+ "')";
  assertEquals(0,hcatDriver.run(dbquery).getResponseCode());
  assertEquals(0,hcatDriver.run(tableQuery).getResponseCode());
  String data[]={"1,english:ONE,spanish:UNO","2,english:TWO,spanish:DOS","3,english:THREE,spanish:TRES"};
  Path inputPath=new Path(methodTestDir,"mr_input");
  getFileSystem().mkdirs(inputPath);
  for (int i=0; i < data.length; i++) {
    FSDataOutputStream os=getFileSystem().create(new Path(inputPath,"inputFile" + i + ".txt"));
    os.write(Bytes.toBytes(data[i] + "\n"));
    os.close();
  }
  Path workingDir=new Path(methodTestDir,"mr_abort");
  OutputJobInfo outputJobInfo=OutputJobInfo.create(databaseName,tableName,null);
  Job job=configureJob(testName,conf,workingDir,MapWriteAbortTransaction.class,outputJobInfo,inputPath);
  assertFalse(job.waitForCompletion(true));
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(conf);
  try {
    TableSnapshot snapshot=rm.createSnapshot(hbaseTableName);
    for (    String family : snapshot.getColumnFamilies()) {
      assertEquals(1,snapshot.getRevision(family));
      List<FamilyRevision> abortedWriteTransactions=rm.getAbortedWriteTransactions(hbaseTableName,family);
      assertEquals(1,abortedWriteTransactions.size());
      assertEquals(1,abortedWriteTransactions.get(0).getRevision());
    }
  }
  finally {
    rm.close();
  }
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(familyNameBytes);
  ResultScanner scanner=table.getScanner(scan);
  int count=0;
  for (  Result result : scanner) {
    String key=Bytes.toString(result.getRow());
    assertNotSame(MapWriteAbortTransaction.failedKey,key);
    int index=Integer.parseInt(key) - 1;
    String vals[]=data[index].toString().split(",");
    for (int i=1; i < vals.length; i++) {
      String pair[]=vals[i].split(":");
      assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes(pair[0])));
      assertEquals(pair[1],Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes(pair[0]))));
      assertEquals(1l,result.getColumn(familyNameBytes,Bytes.toBytes(pair[0])).get(0).getTimestamp());
    }
    count++;
  }
  assertEquals(data.length - 1,count);
  Path outputDir=new Path(getTestDir(),"mapred/testHBaseTableIgnoreAbortedTransactions");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  job=new Job(conf,"hbase-aborted-transaction");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadAbortedTransaction.class);
  job.setInputFormatClass(HCatInputFormat.class);
  HCatInputFormat.setInput(job,databaseName,tableName);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.TestHBaseHCatStorageHandler </h4><pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableCreateExternal() throws Exception {
  String tableName="testTable";
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  HTableDescriptor tableDesc=new HTableDescriptor(tableName);
  tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes("key")));
  tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes("familyone")));
  tableDesc.addFamily(new HColumnDescriptor(Bytes.toBytes("familytwo")));
  hAdmin.createTable(tableDesc);
  boolean doesTableExist=hAdmin.tableExists(tableName);
  assertTrue(doesTableExist);
  hcatDriver.run("drop table mytabletwo");
  CommandProcessorResponse response=hcatDriver.run("create external table mytabletwo(key int, valueone string, valuetwo string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,familyone:val,familytwo:val',"+ "'hbase.table.name'='testTable')");
  assertEquals(0,response.getResponseCode());
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableCreateDropCaseSensitive() throws Exception {
  Initialize();
  hcatDriver.run("drop table test_Table");
  CommandProcessorResponse response=hcatDriver.run("create table test_Table(key int, value string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val',"+ " 'hbase.table.name'='CaseSensitiveTable')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("CaseSensitiveTable");
  assertTrue(doesTableExist);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hcatConf);
  rm.open();
  rm.getAbortedWriteTransactions("CaseSensitiveTable","cf1");
  hcatDriver.run("drop table test_table");
  doesTableExist=hAdmin.tableExists("CaseSensitiveTable");
  assertTrue(doesTableExist == false);
  try {
    rm.getAbortedWriteTransactions("CaseSensitiveTable","cf1");
  }
 catch (  Exception e) {
    assertTrue(e.getCause() instanceof NoNodeException);
  }
  rm.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableDropNonExistent() throws Exception {
  Initialize();
  hcatDriver.run("drop table mytable");
  CommandProcessorResponse response=hcatDriver.run("create table mytable(key int, value string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("mytable");
  assertTrue(doesTableExist);
  if (hAdmin.isTableEnabled("mytable")) {
    hAdmin.disableTable("mytable");
  }
  hAdmin.deleteTable("mytable");
  doesTableExist=hAdmin.tableExists("mytable");
  assertTrue(doesTableExist == false);
  CommandProcessorResponse responseTwo=hcatDriver.run("drop table mytable");
  assertTrue(responseTwo.getResponseCode() == 0);
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableCreateDropDifferentCase() throws Exception {
  Initialize();
  hcatDriver.run("drop table test_Table");
  CommandProcessorResponse response=hcatDriver.run("create table test_Table(key int, value string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hcatConf);
  rm.open();
  rm.getAbortedWriteTransactions("test_table","cf1");
  hcatDriver.run("drop table test_table");
  doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist == false);
  try {
    rm.getAbortedWriteTransactions("test_table","cf1");
  }
 catch (  Exception e) {
    assertTrue(e.getCause() instanceof NoNodeException);
  }
  rm.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableCreateDrop() throws Exception {
  Initialize();
  hcatDriver.run("drop table test_table");
  CommandProcessorResponse response=hcatDriver.run("create table test_table(key int, value string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist);
  RevisionManager rm=HBaseRevisionManagerUtil.getOpenedRevisionManager(hcatConf);
  rm.open();
  rm.getAbortedWriteTransactions("test_table","cf1");
  hcatDriver.run("drop table test_table");
  doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist == false);
  try {
    rm.getAbortedWriteTransactions("test_table","cf1");
  }
 catch (  Exception e) {
    assertTrue(e.getCause() instanceof NoNodeException);
  }
  rm.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.TestHBaseInputFormat </h4><pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void TestHBaseTableProjectionReadMR() throws Exception {
  String tableName=newTableName("MyTable");
  String hbaseTableName="MyDB_" + tableName;
  String tableQuery="CREATE TABLE " + tableName + "(key string, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('hbase.columns.mapping'="+ "':key,testFamily:testQualifier1,testFamily:testQualifier2',"+ "'hbase.table.name'='"+ hbaseTableName+ "')";
  CommandProcessorResponse responseTwo=hcatDriver.run(tableQuery);
  assertEquals(0,responseTwo.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  populateHBaseTable(hbaseTableName,5);
  Configuration conf=new Configuration(hcatConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(getHiveConf().getAllProperties()));
  Path outputDir=new Path(getTestDir(),"mapred/testHBaseTableProjectionReadMR");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  Job job=new Job(conf,"hbase-column-projection");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadProjHTable.class);
  job.setInputFormatClass(HCatInputFormat.class);
  HCatInputFormat.setOutputSchema(job,getProjectionSchema());
  HCatInputFormat.setInput(job,MetaStoreUtils.DEFAULT_DATABASE_NAME,tableName);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  assertFalse(MapReadProjHTable.error);
  assertEquals(MapReadProjHTable.count,1);
  String dropTableQuery="DROP TABLE " + tableName;
  CommandProcessorResponse responseThree=hcatDriver.run(dropTableQuery);
  assertEquals(0,responseThree.getResponseCode());
  boolean isHbaseTableThere=hAdmin.tableExists(hbaseTableName);
  assertFalse(isHbaseTableThere);
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void TestHBaseTableIgnoreAbortedAndRunningTransactions() throws Exception {
  String tableName=newTableName("mytable");
  String tableQuery="CREATE TABLE " + tableName + "(key string, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('hbase.columns.mapping'=':key,"+ "testFamily:testQualifier1,testFamily:testQualifier2')";
  CommandProcessorResponse responseTwo=hcatDriver.run(tableQuery);
  assertEquals(0,responseTwo.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(tableName);
  assertTrue(doesTableExist);
  populateHBaseTable(tableName,2);
  populateHBaseTableQualifier1(tableName,3,Boolean.TRUE);
  populateHBaseTableQualifier1(tableName,4,null);
  populateHBaseTableQualifier1(tableName,5,Boolean.FALSE);
  populateHBaseTableQualifier1(tableName,6,Boolean.TRUE);
  populateHBaseTableQualifier1(tableName,7,null);
  populateHBaseTableQualifier1(tableName,8,Boolean.FALSE);
  Configuration conf=new Configuration(hcatConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(getHiveConf().getAllProperties()));
  Path outputDir=new Path(getTestDir(),"mapred/testHBaseTableIgnoreAbortedTransactions");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  Job job=new Job(conf,"hbase-running-aborted-transaction");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadHTableRunningAbort.class);
  job.setInputFormatClass(HCatInputFormat.class);
  HCatInputFormat.setInput(job,MetaStoreUtils.DEFAULT_DATABASE_NAME,tableName);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  assertFalse(MapReadHTableRunningAbort.error);
  assertEquals(1,MapReadHTableRunningAbort.count);
  String dropTableQuery="DROP TABLE " + tableName;
  CommandProcessorResponse responseThree=hcatDriver.run(dropTableQuery);
  assertEquals(0,responseThree.getResponseCode());
  boolean isHbaseTableThere=hAdmin.tableExists(tableName);
  assertFalse(isHbaseTableThere);
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void TestHBaseTableIgnoreAbortedTransactions() throws Exception {
  String tableName=newTableName("mytable");
  String tableQuery="CREATE TABLE " + tableName + "(key string, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('hbase.columns.mapping'=':key,"+ "testFamily:testQualifier1,testFamily:testQualifier2')";
  CommandProcessorResponse responseTwo=hcatDriver.run(tableQuery);
  assertEquals(0,responseTwo.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(tableName);
  assertTrue(doesTableExist);
  populateHBaseTable(tableName,5);
  populateHBaseTableQualifier1(tableName,6,false);
  populateHBaseTableQualifier1(tableName,7,false);
  Configuration conf=new Configuration(hcatConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(getHiveConf().getAllProperties()));
  Path outputDir=new Path(getTestDir(),"mapred/testHBaseTableIgnoreAbortedTransactions");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  Job job=new Job(conf,"hbase-aborted-transaction");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadHTable.class);
  MapReadHTable.resetCounters();
  job.setInputFormatClass(HCatInputFormat.class);
  HCatInputFormat.setInput(job,MetaStoreUtils.DEFAULT_DATABASE_NAME,tableName);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  assertFalse(MapReadHTable.error);
  assertEquals(1,MapReadHTable.count);
  String dropTableQuery="DROP TABLE " + tableName;
  CommandProcessorResponse responseThree=hcatDriver.run(dropTableQuery);
  assertEquals(0,responseThree.getResponseCode());
  boolean isHbaseTableThere=hAdmin.tableExists(tableName);
  assertFalse(isHbaseTableThere);
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void TestHBaseInputFormatProjectionReadMR() throws Exception {
  String tableName=newTableName("mytable");
  String tableQuery="CREATE TABLE " + tableName + "(key string, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('hbase.columns.mapping'=':key,"+ "testFamily:testQualifier1,testFamily:testQualifier2')";
  CommandProcessorResponse responseTwo=hcatDriver.run(tableQuery);
  assertEquals(0,responseTwo.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(tableName);
  assertTrue(doesTableExist);
  populateHBaseTable(tableName,5);
  Configuration conf=new Configuration(hcatConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(getHiveConf().getAllProperties()));
  Path outputDir=new Path(getTestDir(),"mapred/testHBaseTableProjectionReadMR");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  JobConf job=new JobConf(conf);
  job.setJobName("hbase-scan-column");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadProjectionHTable.class);
  job.setInputFormat(HBaseInputFormat.class);
  job.set(HCatConstants.HCAT_KEY_OUTPUT_SCHEMA,HCatUtil.serialize(getProjectionSchema()));
  Job newJob=new Job(job);
  HCatInputFormat.setInput(newJob,MetaStoreUtils.DEFAULT_DATABASE_NAME,tableName);
  String inputJobString=newJob.getConfiguration().get(HCatConstants.HCAT_KEY_JOB_INFO);
  InputJobInfo info=(InputJobInfo)HCatUtil.deserialize(inputJobString);
  job.set(HCatConstants.HCAT_KEY_JOB_INFO,inputJobString);
  for (  PartInfo partinfo : info.getPartitions()) {
    for (    Entry<String,String> entry : partinfo.getJobProperties().entrySet())     job.set(entry.getKey(),entry.getValue());
  }
  assertEquals("testFamily:testQualifier1",job.get(TableInputFormat.SCAN_COLUMNS));
  job.setOutputFormat(org.apache.hadoop.mapred.TextOutputFormat.class);
  org.apache.hadoop.mapred.TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  RunningJob runJob=JobClient.runJob(job);
  runJob.waitForCompletion();
  assertTrue(runJob.isSuccessful());
  assertFalse(MapReadProjHTable.error);
  assertEquals(MapReadProjHTable.count,1);
  String dropTableQuery="DROP TABLE " + tableName;
  CommandProcessorResponse responseThree=hcatDriver.run(dropTableQuery);
  assertEquals(0,responseThree.getResponseCode());
  boolean isHbaseTableThere=hAdmin.tableExists(tableName);
  assertFalse(isHbaseTableThere);
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void TestHBaseTableReadMR() throws Exception {
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=getTestDir() + "/hbasedb";
  String dbquery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key string, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'"+ "TBLPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')";
  CommandProcessorResponse responseOne=hcatDriver.run(dbquery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=hcatDriver.run(tableQuery);
  assertEquals(0,responseTwo.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  populateHBaseTable(hbaseTableName,5);
  Configuration conf=new Configuration(hcatConf);
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(getHiveConf().getAllProperties()));
  Path outputDir=new Path(getTestDir(),"mapred/testHbaseTableMRRead");
  FileSystem fs=getFileSystem();
  if (fs.exists(outputDir)) {
    fs.delete(outputDir,true);
  }
  Job job=new Job(conf,"hbase-mr-read-test");
  job.setJarByClass(this.getClass());
  job.setMapperClass(MapReadHTable.class);
  MapReadHTable.resetCounters();
  job.setInputFormatClass(HCatInputFormat.class);
  HCatInputFormat.setInput(job.getConfiguration(),databaseName,tableName);
  job.setOutputFormatClass(TextOutputFormat.class);
  TextOutputFormat.setOutputPath(job,outputDir);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  assertFalse(MapReadHTable.error);
  assertEquals(MapReadHTable.count,1);
  String dropTableQuery="DROP TABLE " + hbaseTableName;
  CommandProcessorResponse responseThree=hcatDriver.run(dropTableQuery);
  assertEquals(0,responseThree.getResponseCode());
  boolean isHbaseTableThere=hAdmin.tableExists(hbaseTableName);
  assertFalse(isHbaseTableThere);
  String dropDB="DROP DATABASE " + databaseName;
  CommandProcessorResponse responseFour=hcatDriver.run(dropDB);
  assertEquals(0,responseFour.getResponseCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.TestIDGenerator </h4><pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMultipleClients() throws InterruptedException {
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  ArrayList<IDGenClient> clients=new ArrayList<IDGenClient>();
  for (int i=0; i < 5; i++) {
    IDGenClient idClient=new IDGenClient(sb.toString(),"/rm_base",10,"testTable");
    clients.add(idClient);
  }
  for (  IDGenClient idClient : clients) {
    idClient.run();
  }
  for (  IDGenClient idClient : clients) {
    idClient.join();
  }
  HashMap<Long,Long> idMap=new HashMap<Long,Long>();
  for (  IDGenClient idClient : clients) {
    idMap.putAll(idClient.getIdMap());
  }
  ArrayList<Long> keys=new ArrayList<Long>(idMap.keySet());
  Collections.sort(keys);
  int startId=1;
  for (  Long key : keys) {
    Long id=idMap.get(key);
    System.out.println("Key: " + key + " Value "+ id);
    assertTrue(id == startId);
    startId++;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.TestRevisionManager </h4><pre class="type-7 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testBasicZNodeCreation() throws IOException, KeeperException, InterruptedException {
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  ZKUtil zkutil=new ZKUtil(sb.toString(),"/rm_base");
  String tableName=newTableName("testTable");
  List<String> columnFamilies=Arrays.asList("cf001","cf002","cf003");
  zkutil.createRootZNodes();
  ZooKeeper zk=zkutil.getSession();
  Stat tempTwo=zk.exists("/rm_base" + PathUtil.DATA_DIR,false);
  assertTrue(tempTwo != null);
  Stat tempThree=zk.exists("/rm_base" + PathUtil.CLOCK_NODE,false);
  assertTrue(tempThree != null);
  zkutil.setUpZnodesForTable(tableName,columnFamilies);
  String transactionDataTablePath="/rm_base" + PathUtil.DATA_DIR + "/"+ tableName;
  Stat result=zk.exists(transactionDataTablePath,false);
  assertTrue(result != null);
  for (  String colFamiliy : columnFamilies) {
    String cfPath=transactionDataTablePath + "/" + colFamiliy;
    Stat resultTwo=zk.exists(cfPath,false);
    assertTrue(resultTwo != null);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortTransaction() throws IOException {
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String host=getHbaseConf().get("hbase.zookeeper.quorum");
  Configuration conf=RevisionManagerConfiguration.create(getHbaseConf());
  conf.set(RMConstants.ZOOKEEPER_DATADIR,"/rm_base");
  ZKBasedRevisionManager manager=new ZKBasedRevisionManager();
  manager.initialize(conf);
  manager.open();
  ZKUtil zkutil=new ZKUtil(host + ':' + port,"/rm_base");
  String tableName=newTableName("testTable");
  List<String> columnFamilies=Arrays.asList("cf1","cf2","cf3");
  Transaction txn=manager.beginWriteTransaction(tableName,columnFamilies);
  List<String> cfs=zkutil.getColumnFamiliesOfTable(tableName);
  assertTrue(cfs.size() == columnFamilies.size());
  for (  String cf : cfs) {
    assertTrue(columnFamilies.contains(cf));
  }
  for (  String colFamiliy : columnFamilies) {
    String path=PathUtil.getRunningTxnInfoPath("/rm_base",tableName,colFamiliy);
    byte[] data=zkutil.getRawData(path,null);
    StoreFamilyRevisionList list=new StoreFamilyRevisionList();
    ZKUtil.deserialize(list,data);
    assertEquals(list.getRevisionListSize(),1);
    StoreFamilyRevision lightTxn=list.getRevisionList().get(0);
    assertEquals(lightTxn.timestamp,txn.getTransactionExpireTimeStamp());
    assertEquals(lightTxn.revision,txn.getRevisionNumber());
  }
  manager.abortWriteTransaction(txn);
  for (  String colFamiliy : columnFamilies) {
    String path=PathUtil.getRunningTxnInfoPath("/rm_base",tableName,colFamiliy);
    byte[] data=zkutil.getRawData(path,null);
    StoreFamilyRevisionList list=new StoreFamilyRevisionList();
    ZKUtil.deserialize(list,data);
    assertEquals(list.getRevisionListSize(),0);
  }
  for (  String colFamiliy : columnFamilies) {
    String path=PathUtil.getAbortInformationPath("/rm_base",tableName,colFamiliy);
    byte[] data=zkutil.getRawData(path,null);
    StoreFamilyRevisionList list=new StoreFamilyRevisionList();
    ZKUtil.deserialize(list,data);
    assertEquals(list.getRevisionListSize(),1);
    StoreFamilyRevision abortedTxn=list.getRevisionList().get(0);
    assertEquals(abortedTxn.getRevision(),txn.getRevisionNumber());
  }
  manager.close();
}

</code></pre>

<br>
<pre class="type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeepAliveTransaction() throws InterruptedException, IOException {
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  Configuration conf=RevisionManagerConfiguration.create(getHbaseConf());
  conf.set(RMConstants.ZOOKEEPER_DATADIR,"/rm_base");
  ZKBasedRevisionManager manager=new ZKBasedRevisionManager();
  manager.initialize(conf);
  manager.open();
  String tableName=newTableName("testTable");
  List<String> columnFamilies=Arrays.asList("cf1","cf2");
  Transaction txn=manager.beginWriteTransaction(tableName,columnFamilies,40);
  Thread.sleep(100);
  try {
    manager.commitWriteTransaction(txn);
  }
 catch (  Exception e) {
    assertTrue(e instanceof IOException);
    assertEquals(e.getMessage(),"The transaction to be removed not found in the data.");
  }
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitTransaction() throws IOException {
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  Configuration conf=RevisionManagerConfiguration.create(getHbaseConf());
  conf.set(RMConstants.ZOOKEEPER_DATADIR,"/rm_base");
  ZKBasedRevisionManager manager=new ZKBasedRevisionManager();
  manager.initialize(conf);
  manager.open();
  ZKUtil zkutil=new ZKUtil(sb.toString(),"/rm_base");
  String tableName=newTableName("testTable");
  List<String> columnFamilies=Arrays.asList("cf1","cf2","cf3");
  Transaction txn=manager.beginWriteTransaction(tableName,columnFamilies);
  List<String> cfs=zkutil.getColumnFamiliesOfTable(tableName);
  assertTrue(cfs.size() == columnFamilies.size());
  for (  String cf : cfs) {
    assertTrue(columnFamilies.contains(cf));
  }
  for (  String colFamily : columnFamilies) {
    String path=PathUtil.getRunningTxnInfoPath("/rm_base",tableName,colFamily);
    byte[] data=zkutil.getRawData(path,null);
    StoreFamilyRevisionList list=new StoreFamilyRevisionList();
    ZKUtil.deserialize(list,data);
    assertEquals(list.getRevisionListSize(),1);
    StoreFamilyRevision lightTxn=list.getRevisionList().get(0);
    assertEquals(lightTxn.timestamp,txn.getTransactionExpireTimeStamp());
    assertEquals(lightTxn.revision,txn.getRevisionNumber());
  }
  manager.commitWriteTransaction(txn);
  for (  String colFamiliy : columnFamilies) {
    String path=PathUtil.getRunningTxnInfoPath("/rm_base",tableName,colFamiliy);
    byte[] data=zkutil.getRawData(path,null);
    StoreFamilyRevisionList list=new StoreFamilyRevisionList();
    ZKUtil.deserialize(list,data);
    assertEquals(list.getRevisionListSize(),0);
  }
  manager.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.TestRevisionManagerEndpoint </h4><pre class="type-1 type-2 type-4 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevisionManagerProtocol() throws Throwable {
  Configuration conf=getHbaseConf();
  RevisionManager rm=RevisionManagerFactory.getOpenedRevisionManager(RevisionManagerEndpointClient.class.getName(),conf);
  MockRM mockImpl=MockRM.INSTANCES.get(MockRM.DEFAULT_INSTANCE);
  Assert.assertNotNull(mockImpl);
  Assert.assertTrue(mockImpl.isOpen);
  Transaction t=new Transaction("t1",Arrays.asList("f1","f2"),0,0);
  MockRM.Invocation call=new MockRM.Invocation("keepAlive",null,t);
  rm.keepAlive(t);
  Assert.assertEquals(call.methodName,call,mockImpl.lastCall);
  t=new Transaction("t2",Arrays.asList("f21","f22"),0,0);
  call=new MockRM.Invocation("beginWriteTransaction",null,t.getTableName(),t.getColumnFamilies());
  call.ret=rm.beginWriteTransaction(t.getTableName(),t.getColumnFamilies());
  Assert.assertEquals(call.methodName,call,mockImpl.lastCall);
  call=new MockRM.Invocation("createSnapshot",null,"t3",1L);
  call.ret=rm.createSnapshot("t3",1);
  Assert.assertEquals(call.methodName,call,mockImpl.lastCall);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.TestThriftSerialization </h4><pre class="type-7 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testWriteTransactionList(){
  List<StoreFamilyRevision> txnList=new ArrayList<StoreFamilyRevision>();
  long version;
  long timestamp;
  for (int i=0; i < 10; i++) {
    version=i;
    timestamp=1000 + i;
    StoreFamilyRevision wtx=new StoreFamilyRevision(version,timestamp);
    txnList.add(wtx);
  }
  StoreFamilyRevisionList wList=new StoreFamilyRevisionList(txnList);
  try {
    byte[] data=ZKUtil.serialize(wList);
    StoreFamilyRevisionList newList=new StoreFamilyRevisionList();
    ZKUtil.deserialize(newList,data);
    assertTrue(newList.getRevisionListSize() == wList.getRevisionListSize());
    Iterator<StoreFamilyRevision> itr=newList.getRevisionListIterator();
    int i=0;
    while (itr.hasNext()) {
      StoreFamilyRevision txn=itr.next();
      assertTrue(txn.getRevision() == i);
      assertTrue(txn.getTimestamp() == (i + 1000));
      i++;
    }
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLightWeightTransaction(){
  StoreFamilyRevision trxn=new StoreFamilyRevision(0,1000);
  try {
    byte[] data=ZKUtil.serialize(trxn);
    StoreFamilyRevision newWtx=new StoreFamilyRevision();
    ZKUtil.deserialize(newWtx,data);
    assertTrue(newWtx.getRevision() == trxn.getRevision());
    assertTrue(newWtx.getTimestamp() == trxn.getTimestamp());
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.hbase.snapshot.TestZNodeSetUp </h4><pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicZNodeCreation() throws Exception {
  Initialize();
  int port=getHbaseConf().getInt("hbase.zookeeper.property.clientPort",2181);
  String servers=getHbaseConf().get("hbase.zookeeper.quorum");
  String[] splits=servers.split(",");
  StringBuffer sb=new StringBuffer();
  for (  String split : splits) {
    sb.append(split);
    sb.append(':');
    sb.append(port);
  }
  hcatDriver.run("drop table test_table");
  CommandProcessorResponse response=hcatDriver.run("create table test_table(key int, value string) STORED BY " + "'org.apache.hcatalog.hbase.HBaseHCatStorageHandler'" + "TBLPROPERTIES ('hbase.columns.mapping'=':key,cf1:val')");
  assertEquals(0,response.getResponseCode());
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists("test_table");
  assertTrue(doesTableExist);
  ZKUtil zkutil=new ZKUtil(sb.toString(),"/rm_base");
  ZooKeeper zk=zkutil.getSession();
  String tablePath=PathUtil.getTxnDataPath("/rm_base","test_table");
  Stat tempTwo=zk.exists(tablePath,false);
  assertTrue(tempTwo != null);
  String cfPath=PathUtil.getTxnDataPath("/rm_base","test_table") + "/cf1";
  Stat tempThree=zk.exists(cfPath,false);
  assertTrue(tempThree != null);
  hcatDriver.run("drop table test_table");
  System.out.println("Table path : " + tablePath);
  Stat tempFour=zk.exists(tablePath,false);
  assertTrue(tempFour == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatHiveCompatibility </h4><pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnpartedReadWrite() throws Exception {
  driver.run("drop table if exists junit_unparted_noisd");
  String createTable="create table junit_unparted_noisd(a int) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_unparted_noisd' using org.apache.hcatalog.pig.HCatStorer();");
  logAndRegister(server,"B = load 'default.junit_unparted_noisd' using org.apache.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(1,t.size());
    Assert.assertEquals(t.get(0),i);
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartedRead() throws Exception {
  driver.run("drop table if exists junit_parted_noisd");
  String createTable="create table junit_parted_noisd(a int) partitioned by (b string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_parted_noisd' using org.apache.hcatalog.pig.HCatStorer('b=42');");
  logAndRegister(server,"B = load 'default.junit_parted_noisd' using org.apache.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(2,t.size());
    Assert.assertEquals(t.get(0),i);
    Assert.assertEquals(t.get(1),"42");
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  Partition ptn=client.getPartition("default","junit_parted_noisd",Arrays.asList("42"));
  Assert.assertNotNull(ptn);
  Assert.assertTrue(ptn.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatHiveThriftCompatibility </h4><pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a table with no explicit schema and ensure its correctly
 * discovered from the thrift struct.
 */
@Test public void testDynamicCols() throws Exception {
  Assert.assertEquals(0,driver.run("drop table if exists test_thrift").getResponseCode());
  Assert.assertEquals(0,driver.run("create external table test_thrift " + "partitioned by (year string) " + "row format serde 'org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer' "+ "with serdeproperties ( "+ "  'serialization.class'='org.apache.hadoop.hive.serde2.thrift.test.IntString', "+ "  'serialization.format'='org.apache.thrift.protocol.TBinaryProtocol') "+ "stored as"+ "  inputformat 'org.apache.hadoop.mapred.SequenceFileInputFormat'"+ "  outputformat 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'").getResponseCode());
  Assert.assertEquals(0,driver.run("alter table test_thrift add partition (year = '2012') location '" + intStringSeq.getParent() + "'").getResponseCode());
  PigServer pigServer=new PigServer(ExecType.LOCAL);
  pigServer.registerQuery("A = load 'test_thrift' using org.apache.hcatalog.pig.HCatLoader();");
  Schema expectedSchema=new Schema();
  expectedSchema.add(new Schema.FieldSchema("myint",DataType.INTEGER));
  expectedSchema.add(new Schema.FieldSchema("mystring",DataType.CHARARRAY));
  expectedSchema.add(new Schema.FieldSchema("underscore_int",DataType.INTEGER));
  expectedSchema.add(new Schema.FieldSchema("year",DataType.CHARARRAY));
  Assert.assertEquals(expectedSchema,pigServer.dumpSchema("A"));
  Iterator<Tuple> iterator=pigServer.openIterator("A");
  Tuple t=iterator.next();
  Assert.assertEquals(1,t.get(0));
  Assert.assertEquals("one",t.get(1));
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals("2012",t.get(3));
  Assert.assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatInputFormat </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBadRecordHandlingFails() throws Exception {
  Assert.assertFalse(runJob(0.01f));
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBadRecordHandlingPasses() throws Exception {
  Assert.assertTrue(runJob(0.1f));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatMultiOutputFormat </h4><pre class="type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test case.
 * <ol>
 * <li>Submits a mapred job which writes out one fixed line to each of the tables</li>
 * <li>uses hive fetch task to read the data and see if it matches what was written</li>
 * </ol>
 * @throws Exception if any error occurs
 */
@Test public void testOutputFormat() throws Throwable {
  HashMap<String,String> partitionValues=new HashMap<String,String>();
  partitionValues.put("ds","1");
  partitionValues.put("cluster","ag");
  ArrayList<OutputJobInfo> infoList=new ArrayList<OutputJobInfo>();
  infoList.add(OutputJobInfo.create("default",tableNames[0],partitionValues));
  infoList.add(OutputJobInfo.create("default",tableNames[1],partitionValues));
  infoList.add(OutputJobInfo.create("default",tableNames[2],partitionValues));
  Job job=new Job(hiveConf,"SampleJob");
  job.setMapperClass(MyMapper.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  for (int i=0; i < tableNames.length; i++) {
    configurer.addOutputFormat(tableNames[i],HCatOutputFormat.class,BytesWritable.class,HCatRecord.class);
    HCatOutputFormat.setOutput(configurer.getJob(tableNames[i]),infoList.get(i));
    HCatOutputFormat.setSchema(configurer.getJob(tableNames[i]),schemaMap.get(tableNames[i]));
  }
  configurer.configure();
  Path filePath=createInputFile();
  FileInputFormat.addInputPath(job,filePath);
  Assert.assertTrue(job.waitForCompletion(true));
  ArrayList<String> outputs=new ArrayList<String>();
  for (  String tbl : tableNames) {
    outputs.add(getTableData(tbl,"default").get(0));
  }
  Assert.assertEquals("Comparing output of table " + tableNames[0] + " is not correct",outputs.get(0),"a,a,1,ag");
  Assert.assertEquals("Comparing output of table " + tableNames[1] + " is not correct",outputs.get(1),"a,1,ag");
  Assert.assertEquals("Comparing output of table " + tableNames[2] + " is not correct",outputs.get(2),"a,a,extra,1,ag");
  for (int i=0; i < tableNames.length; i++) {
    Path partitionFile=new Path(warehousedir + "/" + tableNames[i]+ "/ds=1/cluster=ag/part-m-00000");
    FileSystem fs=partitionFile.getFileSystem(mrConf);
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile).getPermission(),new FsPermission(tablePerms[i]));
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile.getParent()).getPermission(),new FsPermission(tablePerms[i]));
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile.getParent().getParent()).getPermission(),new FsPermission(tablePerms[i]));
  }
  LOG.info("File permissions verified");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatNonPartitioned </h4><pre class="type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatNonPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  runMRCreate(null,partitionColumns,writeRecords,10,true);
  IOException exc=null;
  try {
    runMRCreate(null,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_NON_EMPTY_TABLE,((HCatException)exc).getErrorType());
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  runMRRead(10);
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatPartitionPublish </h4><pre class="type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionPublish() throws Exception {
  String dbName="default";
  String tableName="testHCatPartitionedTable";
  createTable(null,tableName);
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","p0value1");
  ArrayList<HCatFieldSchema> hcatTableColumns=new ArrayList<HCatFieldSchema>();
  for (  FieldSchema fs : getTableColumns()) {
    hcatTableColumns.add(HCatSchemaUtils.getHCatFieldSchema(fs));
  }
  runMRCreateFail(dbName,tableName,partitionMap,hcatTableColumns);
  List<String> ptns=msc.listPartitionNames(dbName,tableName,(short)10);
  Assert.assertEquals(0,ptns.size());
  Table table=msc.getTable(dbName,tableName);
  Assert.assertTrue(table != null);
  Assert.assertFalse(fs.exists(new Path(table.getSd().getLocation() + "/part1=p1value1/part0=p0value1")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestHCatPartitioned </h4><pre class="type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","p0value1");
  runMRCreate(partitionMap,partitionColumns,writeRecords,10,true);
  partitionMap.clear();
  partitionMap.put("PART1","p1value2");
  partitionMap.put("PART0","p0value2");
  runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  IOException exc=null;
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_DUPLICATE_PARTITION,((HCatException)exc).getErrorType());
  exc=null;
  partitionMap.clear();
  partitionMap.put("px1","p1value2");
  partitionMap.put("px0","p0value2");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_MISSING_PARTITION_KEY,((HCatException)exc).getErrorType());
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc != null);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  exc=null;
  try {
    runMRCreate(null,partitionColumns,writeRecords,20,false);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc == null);
  runMRRead(30);
  runMRRead(10,"part1 = \"p1value1\"");
  runMRRead(20,"part1 = \"p1value2\"");
  runMRRead(30,"part1 = \"p1value1\" or part1 = \"p1value2\"");
  runMRRead(10,"part0 = \"p0value1\"");
  runMRRead(20,"part0 = \"p0value2\"");
  runMRRead(30,"part0 = \"p0value1\" or part0 = \"p0value2\"");
  tableSchemaTest();
  columnOrderChangeTest();
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestMultiOutputFormat </h4><pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A test job that reads a input file and outputs each word and the index of
 * the word encountered to a text file and sequence file with different key
 * values.
 */
@Test public void testMultiOutputFormatWithoutReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutNoReduce");
  job.setMapperClass(MultiOutWordIndexMapper.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  String fileContent="Hello World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  DistributedCache.addFileToClassPath(new Path(inputFile),job.getConfiguration(),fs);
  String dummyFile=createInputFile("dummy file");
  DistributedCache.addFileToClassPath(new Path(dummyFile),configurer.getJob("out1").getConfiguration(),fs);
  DistributedCache.addFileToClassPath(new Path(inputFile),configurer.getJob("out2").getConfiguration(),fs);
  configurer.configure();
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(job.getConfiguration());
  List<Path> fileClassPathsList=Arrays.asList(fileClassPaths);
  Assert.assertTrue(fileClassPathsList.contains(new Path(inputFile)));
  Assert.assertTrue(fileClassPathsList.contains(new Path(dummyFile)));
  URI[] cacheFiles=DistributedCache.getCacheFiles(job.getConfiguration());
  List<URI> cacheFilesList=Arrays.asList(cacheFiles);
  Assert.assertTrue(cacheFilesList.contains(new Path(inputFile).makeQualified(fs).toUri()));
  Assert.assertTrue(cacheFilesList.contains(new Path(dummyFile).makeQualified(fs).toUri()));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-m-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-m-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words=fileContent.split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  LOG.info("Verifying file contents");
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 1) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 1),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word count test job that reads a input file and outputs the count of
 * words to a text file and sequence file with different key values.
 */
@Test public void testMultiOutputFormatWithReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutWithReduce");
  job.setMapperClass(WordCountMapper.class);
  job.setReducerClass(MultiOutWordCountReducer.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(IntWritable.class);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  configurer.addOutputFormat("out3",NullOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  configurer.configure();
  String fileContent="Hello World Hello World World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-r-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-r-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words="Hello World".split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 2) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 2),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestPassProperties </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSequenceTableWriteReadMR() throws Exception {
  Initialize();
  String createTable="CREATE TABLE bad_props_table(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table bad_props_table");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  boolean caughtException=false;
  try {
    Configuration conf=new Configuration();
    conf.set("hive.metastore.uris","thrift://no.such.machine:10888");
    conf.set("hive.metastore.local","false");
    Job job=new Job(conf,"Write-hcat-seq-table");
    job.setJarByClass(TestSequenceFileReadWrite.class);
    job.setMapperClass(Map.class);
    job.setOutputKeyClass(NullWritable.class);
    job.setOutputValueClass(DefaultHCatRecord.class);
    job.setInputFormatClass(TextInputFormat.class);
    TextInputFormat.setInputPaths(job,INPUT_FILE_NAME);
    HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"bad_props_table",null));
    job.setOutputFormatClass(HCatOutputFormat.class);
    HCatOutputFormat.setSchema(job,getSchema());
    job.setNumReduceTasks(0);
    assertTrue(job.waitForCompletion(true));
    new FileOutputCommitterContainer(job,null).cleanupJob(job);
  }
 catch (  Exception e) {
    caughtException=true;
    assertTrue(e.getMessage().contains("Could not connect to meta store using any of the URIs provided"));
  }
  assertTrue(caughtException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.mapreduce.TestSequenceFileReadWrite </h4><pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteRead() throws Exception {
  Initialize();
  String createTable="CREATE TABLE demo_table(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table' using org.apache.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table' using org.apache.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteRead() throws Exception {
  Initialize();
  String createTable="CREATE TABLE demo_table_1(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_1");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table_1' using org.apache.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table_1' using org.apache.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteReadMR() throws Exception {
  Initialize();
  String createTable="CREATE TABLE demo_table_3(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_3");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-text-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setNumReduceTasks(0);
  TextInputFormat.setInputPaths(job,INPUT_FILE_NAME);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_3",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("D = load 'default.demo_table_3' using org.apache.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("D");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteReadMR() throws Exception {
  Initialize();
  String createTable="CREATE TABLE demo_table_2(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table_2");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-seq-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,INPUT_FILE_NAME);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_2",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("C = load 'default.demo_table_2' using org.apache.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("C");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.pig.TestHCatLoaderStorer </h4><pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure Pig can read/write tinyint/smallint columns.
 */
@Test public void testSmallTinyInt() throws Exception {
  String readTblName="test_small_tiny_int";
  File dataDir=new File(TEST_DATA_DIR + "/testSmallTinyIntData");
  File dataFile=new File(dataDir,"testSmallTinyInt.tsv");
  String writeTblName="test_small_tiny_int_write";
  File writeDataFile=new File(TEST_DATA_DIR,writeTblName + ".tsv");
  FileUtil.fullyDelete(dataDir);
  Assert.assertTrue(dataDir.mkdir());
  HcatTestUtils.createTestDataFile(dataFile.getAbsolutePath(),new String[]{String.format("%d\t%d",Short.MIN_VALUE,Byte.MIN_VALUE),String.format("%d\t%d",Short.MAX_VALUE,Byte.MAX_VALUE)});
  Assert.assertEquals(0,driver.run("drop table if exists " + readTblName).getResponseCode());
  Assert.assertEquals(0,driver.run("create external table " + readTblName + " (my_small_int smallint, my_tiny_int tinyint)"+ " row format delimited fields terminated by '\t' stored as textfile").getResponseCode());
  Assert.assertEquals(0,driver.run("load data local inpath '" + dataDir.getAbsolutePath() + "' into table "+ readTblName).getResponseCode());
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("data = load '" + readTblName + "' using org.apache.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  Assert.assertEquals(2,schema.getFields().size());
  Assert.assertEquals("my_small_int",schema.getField(0).alias);
  Assert.assertEquals(DataType.INTEGER,schema.getField(0).type);
  Assert.assertEquals("my_tiny_int",schema.getField(1).alias);
  Assert.assertEquals(DataType.INTEGER,schema.getField(1).type);
  Iterator<Tuple> it=server.openIterator("data");
  Tuple t=it.next();
  Assert.assertEquals(new Integer(Short.MIN_VALUE),t.get(0));
  Assert.assertEquals(new Integer(Byte.MIN_VALUE),t.get(1));
  t=it.next();
  Assert.assertEquals(new Integer(Short.MAX_VALUE),t.get(0));
  Assert.assertEquals(new Integer(Byte.MAX_VALUE),t.get(1));
  Assert.assertFalse(it.hasNext());
  Assert.assertEquals(0,driver.run("drop table if exists " + writeTblName).getResponseCode());
  Assert.assertEquals(0,driver.run("create table " + writeTblName + " (my_small_int smallint, my_tiny_int tinyint) stored as rcfile").getResponseCode());
  HcatTestUtils.createTestDataFile(writeDataFile.getAbsolutePath(),new String[]{String.format("%d\t%d",Short.MIN_VALUE,Byte.MIN_VALUE),String.format("%d\t%d",Short.MAX_VALUE,Byte.MAX_VALUE)});
  smallTinyIntBoundsCheckHelper(writeDataFile.getAbsolutePath(),ExecJob.JOB_STATUS.COMPLETED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/shortTooSmall.tsv",new String[]{String.format("%d\t%d",Short.MIN_VALUE - 1,0)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/shortTooSmall.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/shortTooBig.tsv",new String[]{String.format("%d\t%d",Short.MAX_VALUE + 1,0)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/shortTooBig.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/byteTooSmall.tsv",new String[]{String.format("%d\t%d",0,Byte.MIN_VALUE - 1)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/byteTooSmall.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/byteTooBig.tsv",new String[]{String.format("%d\t%d",0,Byte.MAX_VALUE + 1)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/byteTooBig.tsv",ExecJob.JOB_STATUS.FAILED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.pig.TestHCatStorer </h4><pre class="type-7 type-11 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoSchema() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    Assert.assertEquals(input[i],itr.next());
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartColsInData() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "\t1";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(2,t.size());
    Assert.assertEquals(t.get(0),i);
    Assert.assertEquals(t.get(1),"1");
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
}

</code></pre>

<br>
<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEmptyStore() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a > 100;");
  server.registerQuery("store B into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagNStruct() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(b string,a struct<a1:int>,  arr_of_struct array<string>, " + "arr_of_struct2 array<struct<s1:string,s2:string>>,  arr_of_struct3 array<struct<s3:string>>) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData=new String[]{"zookeeper\t(2)\t{(pig)}\t{(pnuts,hdfs)}\t{(hadoop),(hcat)}","chubby\t(2)\t{(sawzall)}\t{(bigtable,gfs)}\t{(mapreduce),(hcat)}"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (b:chararray, a:tuple(a1:int), arr_of_struct:bag{mytup:tuple(s1:chararray)}, arr_of_struct2:bag{mytup:tuple(s1:chararray,s2:chararray)}, arr_of_struct3:bag{t3:tuple(s3:chararray)});");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','b:chararray, a:tuple(a1:int),"+ " arr_of_struct:bag{mytup:tuple(s1:chararray)}, arr_of_struct2:bag{mytup:tuple(s1:chararray,s2:chararray)}, arr_of_struct3:bag{t3:tuple(s3:chararray)}');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  Assert.assertEquals("zookeeper\t{\"a1\":2}\t[\"pig\"]\t[{\"s1\":\"pnuts\",\"s2\":\"hdfs\"}]\t[{\"s3\":\"hadoop\"},{\"s3\":\"hcat\"}]",itr.next());
  Assert.assertEquals("chubby\t{\"a1\":2}\t[\"sawzall\"]\t[{\"s1\":\"bigtable\",\"s2\":\"gfs\"}]\t[{\"s3\":\"mapreduce\"},{\"s3\":\"hcat\"}]",itr.next());
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncSimple() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      Assert.assertEquals(si + "\t" + j,itr.next());
    }
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoCtorArgs() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    Assert.assertEquals(input[i],itr.next());
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-11 type-9 type-1 type-2 type-4 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncAllSimpleTypes() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b float, c double, d bigint, e string, f binary, g binary) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int i=0;
  String[] input=new String[3];
  input[i++]="0\t\t\t\t\t\t";
  input[i++]="\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\tbinary-data";
  input[i++]=i + "\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\tbinary-data";
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:float, c:double, d:long, e:chararray, f:bytearray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int, b:float, c:double, d:long, e:chararray,f:bytearray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  Iterator<String> itr=res.iterator();
  Assert.assertEquals("0\tNULL\tNULL\tNULL\tNULL\tnull\tnull",itr.next());
  Assert.assertEquals("NULL\t4.2\t2.2\t4\tlets hcat\tbinary-data\tnull",itr.next());
  Assert.assertEquals("3\t6.2999997\t3.3000000000000003\t6\tlets hcat\tbinary-data\tnull",itr.next());
  Assert.assertFalse(itr.hasNext());
  server.registerQuery("B = load 'junit_unparted' using " + HCatLoader.class.getName() + ";");
  Iterator<Tuple> iter=server.openIterator("B");
  int count=0;
  int num5nulls=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    if (t.get(5) == null) {
      num5nulls++;
    }
 else {
      Assert.assertTrue(t.get(5) instanceof DataByteArray);
    }
    Assert.assertNull(t.get(6));
    count++;
  }
  Assert.assertEquals(3,count);
  Assert.assertEquals(1,num5nulls);
  driver.run("drop table junit_unparted");
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreInPartiitonedTbl() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(2,t.size());
    Assert.assertEquals(t.get(0),i);
    Assert.assertEquals(t.get(1),"1");
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
}

</code></pre>

<br>
<pre class="type-7 type-11 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreMultiTables() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  driver.run("drop table junit_unparted2");
  createTable="create table junit_unparted2(a int, b string) stored as RCFILE";
  retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a < 2;");
  server.registerQuery("store B into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.registerQuery("C = filter A by a >= 2;");
  server.registerQuery("store C into 'junit_unparted2' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("select * from junit_unparted2");
  ArrayList<String> res2=new ArrayList<String>();
  driver.getResults(res2);
  res.addAll(res2);
  driver.run("drop table junit_unparted");
  driver.run("drop table junit_unparted2");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    Assert.assertEquals(input[i],itr.next());
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-2 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoAlias() throws IOException, CommandNeedRetryException {
  driver.run("drop table junit_parted");
  String createTable="create table junit_parted(a int, b string) partitioned by (ds string) stored as RCFILE";
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  PigServer server=new PigServer(ExecType.LOCAL);
  boolean errCaught=false;
  try {
    server.setBatchOn();
    server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
    server.registerQuery("B = foreach A generate a+10, b;");
    server.registerQuery("store B into 'junit_parted' using " + HCatStorer.class.getName() + "('ds=20100101');");
    server.executeBatch();
  }
 catch (  PigException fe) {
    PigException pe=LogUtils.getPigException(fe);
    Assert.assertTrue(pe instanceof FrontendException);
    Assert.assertEquals(PigHCatUtil.PIG_EXCEPTION_CODE,pe.getErrorCode());
    Assert.assertTrue(pe.getMessage().contains("Column name for a field is not specified. Please provide the full schema as an argument to HCatStorer."));
    errCaught=true;
  }
  Assert.assertTrue(errCaught);
  errCaught=false;
  try {
    server.setBatchOn();
    server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, B:chararray);");
    server.registerQuery("B = foreach A generate a, B;");
    server.registerQuery("store B into 'junit_parted' using " + HCatStorer.class.getName() + "('ds=20100101');");
    server.executeBatch();
  }
 catch (  PigException fe) {
    PigException pe=LogUtils.getPigException(fe);
    Assert.assertTrue(pe instanceof FrontendException);
    Assert.assertEquals(PigHCatUtil.PIG_EXCEPTION_CODE,pe.getErrorCode());
    Assert.assertTrue(pe.getMessage().contains("Column names should all be in lowercase. Invalid name found: B"));
    errCaught=true;
  }
  driver.run("drop table junit_parted");
  Assert.assertTrue(errCaught);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.pig.TestHCatStorerWrapper </h4><pre class="type-7 type-11 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreExternalTableWithExternalDir() throws IOException, CommandNeedRetryException {
  File tmpExternalDir=new File(SystemUtils.getJavaIoTmpDir(),UUID.randomUUID().toString());
  tmpExternalDir.deleteOnExit();
  String part_val="100";
  driver.run("drop table junit_external");
  String createTable="create external table junit_external(a int, b string) partitioned by (c string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  logAndRegister(server,"store A into 'default.junit_external' using " + HCatStorerWrapper.class.getName() + "('c="+ part_val+ "','"+ tmpExternalDir.getAbsolutePath()+ "');");
  server.executeBatch();
  Assert.assertTrue(tmpExternalDir.exists());
  Assert.assertTrue(new File(tmpExternalDir.getAbsoluteFile() + "/" + "part-m-00000").exists());
  driver.run("select * from junit_external");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_external");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      Assert.assertEquals(si + "\t" + j+ "\t"+ part_val,itr.next());
    }
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hcatalog.templeton.tool.TestTempletonUtils </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIssetString(){
  Assert.assertFalse(TempletonUtils.isset((String)null));
  Assert.assertFalse(TempletonUtils.isset(""));
  Assert.assertTrue(TempletonUtils.isset("hello"));
}

</code></pre>

<br>
<pre class="type-7 type-11 type-15 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecodeArray(){
  Assert.assertTrue(TempletonUtils.encodeArray((String[])null) == null);
  String[] tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  String[] tmp2=TempletonUtils.decodeArray(TempletonUtils.encodeArray(tmp));
  try {
    for (int i=0; i < tmp.length; i++) {
      Assert.assertEquals((String)tmp[i],(String)tmp2[i]);
    }
  }
 catch (  Exception e) {
    Assert.fail("Arrays were not equal" + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIssetTArray(){
  Assert.assertFalse(TempletonUtils.isset((Long[])null));
  Assert.assertFalse(TempletonUtils.isset(new String[0]));
  String[] parts=new String("hello.world").split("\\.");
  Assert.assertTrue(TempletonUtils.isset(parts));
}

</code></pre>

<br>
<pre class="type-15 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsListAsString(){
  try {
    Assert.assertTrue(TempletonUtils.hadoopFsListAsString(null,null,null) == null);
    Assert.assertTrue(TempletonUtils.hadoopFsListAsString("/tmp,/usr",null,null) == null);
    Assert.assertEquals("file:/tmp,file:/usr",TempletonUtils.hadoopFsListAsString("/tmp,/usr",new Configuration(),null));
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for /tmp");
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsListAsString("/scoobydoo/teddybear,joe",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-15 type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsListAsArray(){
  try {
    Assert.assertTrue(TempletonUtils.hadoopFsListAsArray(null,null,null) == null);
    Assert.assertTrue(TempletonUtils.hadoopFsListAsArray("/tmp, /usr",null,null) == null);
    String[] tmp2=TempletonUtils.hadoopFsListAsArray("/tmp,/usr",new Configuration(),null);
    Assert.assertEquals("file:/tmp",tmp2[0]);
    Assert.assertEquals("file:/usr",tmp2[1]);
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for /tmp");
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsListAsArray("/scoobydoo/teddybear,joe",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-1 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncodeArray(){
  Assert.assertEquals(null,TempletonUtils.encodeArray((String[])null));
  String[] tmp=new String[0];
  Assert.assertTrue(TempletonUtils.encodeArray(new String[0]).length() == 0);
  tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  Assert.assertEquals("fred,,peter" + StringUtils.ESCAPE_CHAR + ",lisa"+ StringUtils.ESCAPE_CHAR+ ","+ StringUtils.ESCAPE_CHAR+ ", barney",TempletonUtils.encodeArray(tmp));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
