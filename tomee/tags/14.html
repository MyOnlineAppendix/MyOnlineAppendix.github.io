<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.openejb.arquillian.openejb.LifecycleTest </h4><pre class="type-6 type-14 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void after(){
  if (afterNb > 0) {
    fail();
  }
  checkCl();
  assertNotNull(foo);
  afterNb++;
}

</code></pre>

<br>
<pre class="type-14 type-5 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void before(){
  if (beforeNb > 0) {
    fail();
  }
  checkCl();
  assertNotNull(foo);
  beforeNb++;
}

</code></pre>

<br>
<pre class="type-6 type-14 type-8 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@AfterClass public static void afterClass(){
  if (afterClassNb > 0) {
    fail();
  }
  checkCl();
  afterClassNb++;
  assertEquals(1,beforeClassNb);
  assertEquals(1,beforeNb);
  assertEquals(1,afterNb);
  assertEquals(1,afterClassNb);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.config.AutoDeployerTest </h4><pre class="type-6 type-9 type-14 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@AfterClass public static void afterClass() throws InterruptedException {
  SystemInstance.reset();
  Thread.sleep(3000);
  for (  final File file : files) {
    if (file.exists()) {
      final File[] exists=file.listFiles();
      assertTrue("Application files still exist in: " + file.getAbsolutePath(),(null == exists || exists.length == 0));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.config.DeploymentsElementTest </h4><pre class="type-9 type-14 type-7 type-4 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidDir_notReadable() throws Exception {
  if (!System.getProperty("os.name","unknown").toLowerCase().startsWith("win") && !"root".equals(System.getProperty("user.name","openejb"))) {
    exceptions.expect(RuntimeException.class);
    exceptions.expectMessage("Deployments dir=");
    exceptions.expectMessage("Not readable");
    exceptions.expectMessage("myapps");
    final Server server=new Server();
    final File dir=server.deploymentsDir("myapps");
    assertTrue(dir.setReadable(false));
    final OpenEjbConfiguration configuration=server.init();
    assertEquals(0,configuration.containerSystem.applications.size());
  }
}

</code></pre>

<br>
<pre class="type-9 type-14 type-7 type-4 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidFile_notReadable() throws Exception {
  if (!System.getProperty("os.name","unknown").toLowerCase().startsWith("win") && !"root".equals(System.getProperty("user.name","openejb"))) {
    exceptions.expect(RuntimeException.class);
    exceptions.expectMessage("Deployments file=");
    exceptions.expectMessage("Not readable");
    exceptions.expectMessage("myapp.jar");
    final Server server=new Server();
    final File file=server.deploymentsFile("myapp.jar");
    assertTrue(file.createNewFile());
    assertTrue(file.setReadable(false));
    final OpenEjbConfiguration configuration=server.init();
    assertEquals(0,configuration.containerSystem.applications.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.config.JMXDataSourceTest </h4><pre class="type-14 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkNumActiveAndNumIdle() throws MalformedObjectNameException, IntrospectionException, InstanceNotFoundException, ReflectionException, AttributeNotFoundException, MBeanException {
  final Map<String,Object> map=getDatasourceJmxMap();
  assertNotNull(map.get("numActive"));
  assertNotNull(map.get("numIdle"));
  assertAttributeValue("numActive",((Integer)0));
  assertAttributeValue("numIdle",((Integer)0));
  assertNotNull(dataSource);
  Connection connection=null;
  try {
    connection=dataSource.getConnection();
    assertAttributeValue("numActive",((Integer)1));
  }
 catch (  final SQLException e) {
    fail();
  }
 finally {
    if (connection != null)     try {
      connection.close();
    }
 catch (    final SQLException e) {
      fail();
    }
  }
  assertAttributeValue("numActive",((Integer)0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.config.MBeanDeployerTest </h4><pre class="type-9 type-14 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void mbeans() throws Exception {
  final Set<String> parsed=new HashSet<String>();
  for (  final Object name : appInfo.jmx.values()) {
    final ObjectName on=new ObjectName((String)name);
    final String cn=on.getCanonicalName();
    if (cn.contains("name=Empty")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(server.isRegistered(on));
      parsed.add(cn);
    }
 else     if (cn.contains("name=Reader")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(server.isRegistered(on));
      assertEquals(2,server.getAttribute(on,"value"));
      parsed.add(cn);
    }
 else     if (cn.contains("name=ReaderWriter")) {
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(server.isRegistered(on));
      assertEquals(2,server.getAttribute(on,"value"));
      server.setAttribute(on,new Attribute("value",5));
      assertEquals(5,server.getAttribute(on,"value"));
      parsed.add(cn);
    }
 else     if (cn.contains("name=Inheritance")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(server.isRegistered(on));
      assertEquals(2,server.getAttribute(on,"value"));
      server.setAttribute(on,new Attribute("value",5));
      assertEquals(5,server.getAttribute(on,"value"));
      assertEquals("yes - no",server.invoke(on,"returnValue",null,null));
      parsed.add(cn);
    }
 else     if (cn.contains("name=MBeanDescription")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(server.isRegistered(on));
      assertEquals("descr ;)",server.getMBeanInfo(on).getDescription());
      parsed.add(cn);
    }
 else     if (cn.contains("name=Operation")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      final MBeanInfo info=server.getMBeanInfo(on);
      if ("desc".equals(info.getOperations()[0].getName())) {
        assertEquals("param",info.getOperations()[0].getSignature()[0].getDescription());
      }
 else {
        assertEquals("param",info.getOperations()[1].getSignature()[0].getDescription());
      }
      assertTrue(server.isRegistered(on));
      assertEquals("yes - no",server.invoke(on,"returnValue",null,null));
      parsed.add(cn);
    }
 else     if (cn.contains("name=ReaderDescription")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(cn.contains("name=ReaderDescription"));
      assertTrue(server.isRegistered(on));
      assertEquals(1,server.getMBeanInfo(on).getAttributes().length);
      assertEquals("just a value",server.getMBeanInfo(on).getAttributes()[0].getDescription());
      parsed.add(cn);
    }
 else     if (cn.contains("name=OperationDescription")) {
      assertTrue(cn.startsWith("openejb.user.mbeans"));
      assertTrue(cn.contains("group=org.apache.openejb.mbeans"));
      assertTrue(cn.contains("application=mbeans") || cn.contains("application=EjbModule"));
      assertTrue(server.isRegistered(on));
      assertEquals(1,server.getMBeanInfo(on).getOperations().length);
      assertEquals("just an op",server.getMBeanInfo(on).getOperations()[0].getDescription());
      parsed.add(cn);
    }
  }
  assertEquals(8,parsed.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.itest.failover.StickyConnectionStrategyTest </h4><pre class="type-9 type-14 type-8 type-7 type-4 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  System.setProperty("version",OpenEjbVersion.get().getVersion());
  final File zip=Repository.getArtifact("org.apache.tomee","openejb-standalone","zip");
  final File app=Repository.getArtifact("org.apache.openejb.itests","failover-ejb","jar");
  final File dir=Files.tmpdir();
  final StandaloneServer root;
{
    final StandaloneServer root1;
    final String name="root";
    final File home=new File(dir,name);
    Files.mkdir(home);
    Zips.unzip(zip,home,true);
    root1=new StandaloneServer(home,home);
    root1.killOnExit();
    root1.ignoreOut();
    root1.getJvmOpts().add("-Dopenejb.classloader.forced-load=org.apache.openejb");
    root1.setProperty("name",name);
    root1.setProperty("openejb.extract.configuration","false");
    final StandaloneServer.ServerService multipoint=root1.getServerService("multipoint");
    multipoint.setBind("localhost");
    multipoint.setPort(getAvailablePort());
    multipoint.setDisabled(false);
    multipoint.set("discoveryName",name);
    root=root1;
    logger.info("Starting Root server");
    root.start();
  }
  final Map<String,StandaloneServer> servers=new HashMap<String,StandaloneServer>();
  for (  final String name : new String[]{"red","green","blue"}) {
    final File home=new File(dir,name);
    Files.mkdir(home);
    Zips.unzip(zip,home,true);
    final StandaloneServer server=new StandaloneServer(home,home);
    server.killOnExit();
    server.ignoreOut();
    server.getJvmOpts().add("-Dopenejb.classloader.forced-load=org.apache.openejb");
    server.setProperty("name",name);
    server.setProperty("openejb.extract.configuration","false");
    IO.copy(app,Files.path(home,"apps","itest.jar"));
    IO.copy(IO.read("<openejb><Deployments dir=\"apps/\"/></openejb>"),Files.path(home,"conf","openejb.xml"));
    final StandaloneServer.ServerService ejbd=server.getServerService("ejbd");
    ejbd.setBind("localhost");
    ejbd.setDisabled(false);
    ejbd.setPort(getAvailablePort());
    ejbd.setThreads(5);
    ejbd.set("discovery","ejb:ejbd://{bind}:{port}/" + name);
    final StandaloneServer.ServerService multipoint=server.getServerService("multipoint");
    multipoint.setPort(getAvailablePort());
    multipoint.setDisabled(false);
    multipoint.set("discoveryName",name);
    multipoint.set("initialServers","localhost:" + root.getServerService("multipoint").getPort());
    servers.put(name,server);
    logger.info(String.format("Starting %s server",name));
    server.start(1,TimeUnit.MINUTES);
    invoke(name,server);
  }
  System.setProperty("openejb.client.requestretry","true");
  logger.info("Beginning Test");
  final Properties environment=new Properties();
  environment.put(Context.INITIAL_CONTEXT_FACTORY,RemoteInitialContextFactory.class.getName());
  environment.put(Context.PROVIDER_URL,"ejbd://localhost:" + servers.values().iterator().next().getServerService("ejbd").getPort() + "/provider");
  final InitialContext context=new InitialContext(environment);
  final Calculator bean=(Calculator)context.lookup("CalculatorBeanRemote");
  String previous=null;
  for (  final StandaloneServer ignored : servers.values()) {
    logger.info("Looping");
    final String name=bean.name();
    logger.info("Sticky request to " + name);
    assertFalse("root".equals(name));
    if (previous != null)     assertFalse(name.equals(previous));
    previous=name;
    final int i=1000;
    logger.info(String.format("Performing %s invocations, expecting %s to be used for each invocation.",i,name));
    invoke(bean,i,name);
    logger.info("Shutting down " + name);
    servers.get(name).kill();
  }
  logger.info("All Servers Shutdown");
  try {
    logger.info("Making one last request, expecting complete failover");
    final String name=bean.name();
    Assert.fail("Server should be destroyed: " + name);
  }
 catch (  final EJBException e) {
    logger.info(String.format("Pass.  Request resulted in %s: %s",e.getCause().getClass().getSimpleName(),e.getMessage()));
  }
  final Iterator<StandaloneServer> iterator=servers.values().iterator();
  iterator.next();
  final StandaloneServer server=iterator.next();
  logger.info(String.format("Starting %s server",server.getProperties().get("name")));
  server.start(1,TimeUnit.MINUTES);
  logger.info("Performing one more invocation");
  assertEquals(5,bean.sum(2,3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.jee.cdi.BeansTest </h4><pre class="type-9 type-15 type-14 type-4 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void read11() throws Exception {
  final Beans b=read("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<beans xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\" version=\"1.1\">\n" + "    <scan>\n"+ "        <exclude name=\"com.acme.swing.**\" />\n"+ "        <exclude name=\"com.acme.gwt.**\">\n"+ "            <if-class-not-available name=\"com.google.GWT\"/>\n"+ "        </exclude>\n"+ "        <exclude name=\"com.acme.verbose.*\">\n"+ "            <if-system-property name=\"verbosity\" value=\"low\"/>\n"+ "        </exclude>\n"+ "        <exclude name=\"com.acme.jsf.**\">\n"+ "            <if-class-available name=\"org.apache.wicket.Wicket\"/>\n"+ "            <if-system-property name=\"viewlayer\"/>\n"+ "        </exclude>\n"+ "    </scan>\n"+ "</beans>");
  assertNotNull(b);
  assertEquals("1.1",b.getVersion());
  assertNotNull(b.getScan());
  final List<Beans.Scan.Exclude> excludeList=b.getScan().getExclude();
  assertNotNull(excludeList);
  assertEquals(4,excludeList.size());
  for (int i=0; i < 4; i++) {
    final Beans.Scan.Exclude exclude=excludeList.get(i);
switch (i) {
case 0:
      assertEquals("com.acme.swing.**",exclude.getName());
    assertEquals(0,exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().size());
  break;
case 1:
assertEquals("com.acme.gwt.**",exclude.getName());
assertEquals(1,exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().size());
assertEquals("com.google.GWT",Beans.Scan.Exclude.IfNotAvailableClassCondition.class.cast(exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().iterator().next()).getName());
break;
case 2:
assertEquals("com.acme.verbose.*",exclude.getName());
assertEquals(1,exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().size());
final Beans.Scan.Exclude.IfSystemProperty systemProperty=Beans.Scan.Exclude.IfSystemProperty.class.cast(exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().iterator().next());
assertEquals("verbosity",systemProperty.getName());
assertEquals("low",systemProperty.getValue());
break;
case 3:
assertEquals("com.acme.jsf.**",exclude.getName());
assertEquals(2,exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().size());
final Iterator iterator=exclude.getIfClassAvailableOrIfClassNotAvailableOrIfSystemProperty().iterator();
assertEquals("org.apache.wicket.Wicket",Beans.Scan.Exclude.IfAvailableClassCondition.class.cast(iterator.next()).getName());
final Beans.Scan.Exclude.IfSystemProperty ifSystemProperty=Beans.Scan.Exclude.IfSystemProperty.class.cast(iterator.next());
assertEquals("viewlayer",ifSystemProperty.getName());
assertNull(ifSystemProperty.getValue());
break;
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.maven.plugin.test.JAXRSReloadTest </h4><pre class="type-15 type-14 type-7 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleStart() throws Exception {
  assertThat(slurp(new URL(url + "/app-jaxrs/ping")).trim(),is("pong"));
  long lastTime=0;
  for (int i=0; i < 10; i++) {
    sleep(100);
    mojo.reload();
    assertThat(slurp(new URL(url + "/app-jaxrs/ping")).trim(),is("pong"));
    final long time=Long.parseLong(slurp(new URL(url + "/app-jaxrs/ping/time")).trim());
    if (i > 0) {
      assertTrue(time >= lastTime);
    }
    lastTime=time;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.persistence.DataSourceInitialSizeAdjustingTest </h4><pre class="type-14 type-8 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkNonJtaPoolSizeWasCorrected(){
  final String prefix=getClass().getSimpleName();
  for (  final ResourceInfo info : SystemInstance.get().getComponent(OpenEjbConfiguration.class).facilities.resources) {
    if ((prefix + "NonJta").equals(info.id)) {
      assertEquals("5",info.properties.getProperty("InitialSize"));
      return;
    }
  }
  fail("DataSource not found");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.resource.jdbc.JTADataSourceWrapperFactoryTest </h4><pre class="type-14 type-7 type-2 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws SQLException {
  assertNotNull(raw);
  assertNotNull(jta);
  assertThat(jta,instanceOf(ManagedDataSource.class));
  boolean found=false;
  for (  final ResourceInfo ri : SystemInstance.get().getComponent(OpenEjbConfiguration.class).facilities.resources) {
    if (ri.id.equals("jta")) {
      found=true;
      assertTrue(ri.types.contains("DataSource"));
      break;
    }
  }
  assertTrue(found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.server.ejbd.MultithreadTest </h4><pre class="type-14 type-8 type-7 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("ThrowableResultOfMethodCallIgnored") @Test public void testStatelessBeanTimeout() throws Exception {
  final CountDownLatch timeouts=new CountDownLatch(10);
  startPistol=new CountDownLatch(1);
  startingLine=new CountDownLatch(10);
  final AtomicReference<Throwable> error=new AtomicReference<Throwable>();
  final Runnable r=new Runnable(){
    @Override public void run(){
      try {
        counter.race();
      }
 catch (      ConcurrentAccessException ex) {
        comment("Leap Start");
        timeouts.countDown();
        assertEquals("No instances available in Stateless Session Bean pool.  Waited 100 MILLISECONDS",ex.getMessage());
      }
catch (      Throwable t) {
        error.set(t);
        fail("Unexpected exception" + t.getClass().getName() + " "+ t.getMessage());
      }
    }
  }
;
  comment("On your mark!");
  final Collection<Thread> threads=new ArrayList<>(20);
  for (int i=0; i < 20; i++) {
    final Thread t=new Thread(r);
    threads.add(t);
    t.start();
  }
  assertTrue("expected 10 invocations",startingLine.await(3000,TimeUnit.MILLISECONDS));
  comment("Get Set!");
  assertTrue("expected 10 timeouts",timeouts.await(300000,TimeUnit.MILLISECONDS));
  if (error.get() != null) {
    error.get().printStackTrace();
    fail(error.get().getMessage());
  }
  assertEquals(10,CounterBean.instances.get());
  comment("Go!");
  startPistol.countDown();
  for (  final Thread t : threads) {
    t.join(1000);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.openejb.server.ejbd.ZEjbdTest </h4><pre class="type-14 type-7 type-4 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkZipIsOn() throws Exception {
  int checked=0;
  for (  final ServerService daemon : SimpleServiceManager.class.cast(ServiceManager.get()).getDaemons()) {
    if (ServiceDaemon.class.isInstance(daemon) && daemon.getName().equals("ejbd")) {
      assertTrue(EjbDaemon.class.cast(Reflections.get(Reflections.get(Reflections.get(Reflections.get(Reflections.get(Reflections.get(Reflections.get(daemon,"next"),"service"),"service"),"service"),"service"),"service"),"server")).isGzip());
      checked++;
    }
  }
  assertEquals(1,checked);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomee.RemoteTomEEEJBContainerIT </h4><pre class="type-14 type-8 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void run() throws IOException {
  final File app=new File("target/mock/webapp");
  Files.mkdirs(app);
  final FileWriter writer=new FileWriter(new File(app,"index.html"));
  writer.write("Hello");
  writer.close();
  File work=new File("target/webprofile-work-dir/").getAbsoluteFile();
  if (!work.exists()) {
    work=new File("apache-tomee/target/webprofile-work-dir/").getAbsoluteFile();
  }
  final File[] files=work.listFiles(new FileFilter(){
    @Override public boolean accept(    final File pathname){
      return pathname.isDirectory() && pathname.getName().startsWith("apache-tomcat-");
    }
  }
);
  final File tomee=(null != files ? files[0] : null);
  if (tomee == null) {
    fail("Failed to find Tomcat directory required for this test - Ensure you have run at least the maven phase: mvn process-resources");
  }
  final FileWriter serverXml=new FileWriter(new File(tomee,"conf/server.xml"));
  final int http=NetworkUtil.getNextAvailablePort();
  serverXml.write("<?xml version='1.0' encoding='utf-8'?>\n" + "<Server port=\"" + NetworkUtil.getNextAvailablePort() + "\" shutdown=\"SHUTDOWN\">\n"+ "  <!-- TomEE plugin for Tomcat -->\n"+ "  <Listener className=\"org.apache.tomee.catalina.ServerListener\" />\n"+ "  <Service name=\"Catalina\">\n"+ "    <Connector port=\""+ http+ "\" protocol=\"HTTP/1.1\" xpoweredBy=\"false\" server=\"Apache TomEE\" />\n"+ "    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n"+ "      <Host name=\"localhost\"  appBase=\"webapps\"\n"+ "            unpackWARs=\"true\" autoDeploy=\"true\">\n"+ "      </Host>\n"+ "    </Engine>\n"+ "  </Service>\n"+ "</Server>\n");
  serverXml.close();
  EJBContainer container=null;
  try {
    container=EJBContainer.createEJBContainer(new HashMap<Object,Object>(){
{
        put(EJBContainer.PROVIDER,"tomee-remote");
        put(EJBContainer.MODULES,app.getAbsolutePath());
        put("openejb.home",tomee.getAbsolutePath());
      }
    }
);
    final URL url=new URL("http://localhost:" + http + "/webapp/index.html");
    assertEquals("Hello",IO.slurp(url));
  }
  finally {
    if (container != null) {
      container.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomee.jul.handler.rotating.ArchivingTest </h4><pre class="type-9 type-14 type-7 type-2 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void logAndRotate() throws IOException, NoSuchMethodException {
  clean("target/ArchivingTest-" + format + "/logs");
  final AtomicReference<String> today=new AtomicReference<>();
  final Map<String,String> config=new HashMap<>();
  today.set("2015-09-01");
  config.put("filenamePattern","target/ArchivingTest-" + format + "/logs/test.%s.%d.log");
  config.put("archiveDirectory","target/ArchivingTest-" + format + "/logs/archives");
  config.put("archiveFormat",format);
  config.put("archiveOlderThan","1 s");
  config.put("limit","10 kilobytes");
  config.put("level","INFO");
  config.put("dateCheckInterval","1 second");
  final LocalFileHandler handler=new LocalFileHandler(){
    @Override protected String currentDate(){
      return today.get();
    }
    @Override protected String getProperty(    final String name,    final String defaultValue){
      final String s=config.get(name.substring(name.lastIndexOf('.') + 1));
      return s != null ? s : defaultValue;
    }
  }
;
  final String string10chars="abcdefghij";
  final int iterations=950;
  for (int i=0; i < iterations; i++) {
    handler.publish(new LogRecord(Level.INFO,string10chars));
  }
  today.set("2015-09-02");
  try {
    Thread.sleep(1500);
  }
 catch (  final InterruptedException e) {
    Thread.interrupted();
  }
  handler.publish(new LogRecord(Level.INFO,string10chars));
  handler.close();
  final File logGzip=new File("target/ArchivingTest-" + format + "/logs/archives/test.2015-09-01.0.log."+ format);
  withRetry(5,1,new Runnable(){
    @Override public void run(){
      assertTrue(logGzip.getAbsolutePath(),logGzip.isFile());
    }
  }
);
  if ("gzip".equals(format)) {
    try (final GZIPInputStream gis=new GZIPInputStream(new FileInputStream("target/ArchivingTest-gzip/logs/archives/test.2015-09-01.0.log.gzip"))){
      final String content=IOUtils.toString(gis);
      assertTrue(content.contains("INFO: abcdefghij" + System.lineSeparator()));
      assertTrue(content.length() > 10000);
    }
   }
 else {
    try (final ZipInputStream zis=new ZipInputStream(new FileInputStream("target/ArchivingTest-zip/logs/archives/test.2015-09-01.0.log.zip"))){
      assertEquals("test.2015-09-01.0.log",zis.getNextEntry().getName());
      final String content=IOUtils.toString(zis);
      assertTrue(content.contains("INFO: abcdefghij" + System.lineSeparator()));
      assertTrue(content.length() > 10000);
      assertNull(zis.getNextEntry());
    }
   }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
