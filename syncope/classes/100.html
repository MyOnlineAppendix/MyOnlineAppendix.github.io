<h3 style="margin:0px">Class: org.apache.syncope.fit.core.VirAttrITCase (10 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(5)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-5 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void issueSYNCOPE436(){
  UserTO userTO=UserITCase.getUniqueSampleTO("syncope436@syncope.apache.org");
  userTO.getMemberships().clear();
  userTO.getResources().clear();
  userTO.getResources().add(RESOURCE_NAME_LDAP);
  userTO.getVirAttrs().add(attrTO("virtualReadOnly","readOnly"));
  userTO=createUser(userTO).getAny();
  assertTrue(userTO.getVirAttrMap().get("virtualReadOnly").getValues().isEmpty());
}

</code></pre>

<pre class="type-5 type-6 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void issueSYNCOPE459(){
  UserTO userTO=UserITCase.getUniqueSampleTO("syncope459@apache.org");
  userTO.getResources().clear();
  userTO.getResources().add(RESOURCE_NAME_LDAP);
  userTO.getMemberships().clear();
  userTO.getVirAttrs().clear();
  userTO=createUser(userTO).getAny();
  assertNotNull(userTO.getVirAttrMap().get("virtualReadOnly"));
}

</code></pre>

<pre class="type-5 type-1 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE501(){
  UserTO userTO=UserITCase.getUniqueSampleTO("syncope501@apache.org");
  userTO.getResources().clear();
  userTO.getMemberships().clear();
  userTO.getVirAttrs().clear();
  userTO.getResources().add(RESOURCE_NAME_DBVIRATTR);
  userTO.getVirAttrs().add(attrTO("virtualdata","syncope501@apache.org"));
  userTO=createUser(userTO).getAny();
  assertNotNull(userTO.getVirAttrMap().get("virtualdata"));
  assertEquals("syncope501@apache.org",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
  UserPatch userPatch=new UserPatch();
  userPatch.setKey(userTO.getKey());
  userPatch.getVirAttrs().add(attrTO("virtualdata","syncope501_updated@apache.org"));
  userTO=updateUser(userPatch).getAny();
  assertNotNull(userTO);
  assertFalse(userTO.getVirAttrMap().get("virtualdata").getValues().isEmpty());
  assertEquals("syncope501_updated@apache.org",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
}

</code></pre>

<pre class="type-5 type-1 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE260(){
  ResourceTO ws2=resourceService.read(RESOURCE_NAME_WS2);
  ProvisionTO provision=ws2.getProvision(AnyTypeKind.USER.name());
  assertNotNull(provision);
  VirSchemaTO virSchema=new VirSchemaTO();
  virSchema.setKey("syncope260" + getUUIDString());
  virSchema.setExtAttrName("companyName");
  virSchema.setProvision(provision.getKey());
  virSchema=createSchema(SchemaType.VIRTUAL,virSchema);
  assertNotNull(virSchema);
  AnyTypeClassTO newClass=new AnyTypeClassTO();
  newClass.setKey("syncope260" + getUUIDString());
  newClass.getVirSchemas().add(virSchema.getKey());
  Response response=anyTypeClassService.create(newClass);
  assertEquals(Response.Status.CREATED.getStatusCode(),response.getStatusInfo().getStatusCode());
  newClass=getObject(response.getLocation(),AnyTypeClassService.class,AnyTypeClassTO.class);
  UserTO userTO=UserITCase.getUniqueSampleTO("260@a.com");
  userTO.getAuxClasses().add(newClass.getKey());
  userTO.getVirAttrs().add(attrTO(virSchema.getKey(),"virtualvalue"));
  userTO.getResources().add(RESOURCE_NAME_WS2);
  ProvisioningResult<UserTO> result=createUser(userTO);
  assertNotNull(result);
  assertFalse(result.getPropagationStatuses().isEmpty());
  assertEquals(RESOURCE_NAME_WS2,result.getPropagationStatuses().get(0).getResource());
  assertEquals(PropagationTaskExecStatus.SUCCESS,result.getPropagationStatuses().get(0).getStatus());
  userTO=result.getAny();
  ConnObjectTO connObjectTO=resourceService.readConnObject(RESOURCE_NAME_WS2,AnyTypeKind.USER.name(),userTO.getKey());
  assertEquals("virtualvalue",connObjectTO.getPlainAttrMap().get("COMPANYNAME").getValues().get(0));
  UserPatch userPatch=new UserPatch();
  userPatch.setKey(userTO.getKey());
  userPatch.getVirAttrs().add(attrTO(virSchema.getKey(),"virtualvalue2"));
  result=updateUser(userPatch);
  assertNotNull(result);
  assertFalse(result.getPropagationStatuses().isEmpty());
  assertEquals(RESOURCE_NAME_WS2,result.getPropagationStatuses().get(0).getResource());
  assertEquals(PropagationTaskExecStatus.SUCCESS,result.getPropagationStatuses().get(0).getStatus());
  userTO=result.getAny();
  connObjectTO=resourceService.readConnObject(RESOURCE_NAME_WS2,AnyTypeKind.USER.name(),userTO.getKey());
  assertEquals("virtualvalue2",connObjectTO.getPlainAttrMap().get("COMPANYNAME").getValues().get(0));
  StatusPatch statusPatch=new StatusPatch();
  statusPatch.setKey(userTO.getKey());
  statusPatch.setType(StatusPatchType.SUSPEND);
  userTO=userService.status(statusPatch).readEntity(new GenericType<ProvisioningResult<UserTO>>(){
  }
).getAny();
  assertEquals("suspended",userTO.getStatus());
  connObjectTO=resourceService.readConnObject(RESOURCE_NAME_WS2,AnyTypeKind.USER.name(),userTO.getKey());
  assertEquals("virtualvalue2",connObjectTO.getPlainAttrMap().get("COMPANYNAME").getValues().get(0));
  statusPatch=new StatusPatch();
  statusPatch.setKey(userTO.getKey());
  statusPatch.setType(StatusPatchType.REACTIVATE);
  userTO=userService.status(statusPatch).readEntity(new GenericType<ProvisioningResult<UserTO>>(){
  }
).getAny();
  assertEquals("active",userTO.getStatus());
  connObjectTO=resourceService.readConnObject(RESOURCE_NAME_WS2,AnyTypeKind.USER.name(),userTO.getKey());
  assertEquals("virtualvalue2",connObjectTO.getPlainAttrMap().get("COMPANYNAME").getValues().get(0));
  userPatch=new UserPatch();
  userPatch.setKey(userTO.getKey());
  userPatch.getPlainAttrs().add(attrAddReplacePatch("surname","Surname2"));
  result=updateUser(userPatch);
  assertNotNull(result);
  assertFalse(result.getPropagationStatuses().isEmpty());
  assertEquals(RESOURCE_NAME_WS2,result.getPropagationStatuses().get(0).getResource());
  assertEquals(PropagationTaskExecStatus.SUCCESS,result.getPropagationStatuses().get(0).getStatus());
  userTO=result.getAny();
  connObjectTO=resourceService.readConnObject(RESOURCE_NAME_WS2,AnyTypeKind.USER.name(),userTO.getKey());
  assertEquals("Surname2",connObjectTO.getPlainAttrMap().get("SURNAME").getValues().get(0));
  assertFalse(connObjectTO.getPlainAttrMap().get("COMPANYNAME").getValues().isEmpty());
  assertEquals("virtualvalue2",connObjectTO.getPlainAttrMap().get("COMPANYNAME").getValues().get(0));
}

</code></pre>

<pre class="type-5 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE16(){
  UserTO userTO=UserITCase.getUniqueSampleTO("issue16@apache.org");
  userTO.getVirAttrs().add(attrTO("virtualdata","virtualvalue"));
  userTO.getResources().add(RESOURCE_NAME_DBVIRATTR);
  userTO.getMemberships().add(new MembershipTO.Builder().group(8L).build());
  userTO=createUser(userTO).getAny();
  assertNotNull(userTO);
  userTO=userService.read(userTO.getKey());
  assertNotNull(userTO);
  assertEquals("virtualvalue",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
  UserPatch userPatch=new UserPatch();
  userPatch.setKey(userTO.getKey());
  userPatch.getVirAttrs().add(attrTO("virtualdata","virtualupdated"));
  userTO=updateUser(userPatch).getAny();
  assertNotNull(userTO);
  userTO=userService.read(userTO.getKey());
  assertNotNull(userTO);
  assertEquals("virtualupdated",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
}

</code></pre>

<pre class="type-5 type-1 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE397(){
  ResourceTO csv=resourceService.read(RESOURCE_NAME_CSV);
  MappingTO origMapping=SerializationUtils.clone(csv.getProvisions().get(0).getMapping());
  try {
    CollectionUtils.filterInverse(csv.getProvisions().get(0).getMapping().getItems(),new Predicate<MappingItemTO>(){
      @Override public boolean evaluate(      final MappingItemTO item){
        return "email".equals(item.getIntAttrName());
      }
    }
);
    resourceService.update(csv);
    csv=resourceService.read(RESOURCE_NAME_CSV);
    assertNotNull(csv.getProvisions().get(0).getMapping());
    ProvisionTO provision=csv.getProvision(AnyTypeKind.USER.name());
    assertNotNull(provision);
    VirSchemaTO virSchema=new VirSchemaTO();
    virSchema.setKey("syncope397" + getUUIDString());
    virSchema.setExtAttrName("email");
    virSchema.setProvision(provision.getKey());
    virSchema=createSchema(SchemaType.VIRTUAL,virSchema);
    assertNotNull(virSchema);
    AnyTypeClassTO newClass=new AnyTypeClassTO();
    newClass.setKey("syncope397" + getUUIDString());
    newClass.getVirSchemas().add(virSchema.getKey());
    Response response=anyTypeClassService.create(newClass);
    assertEquals(Response.Status.CREATED.getStatusCode(),response.getStatusInfo().getStatusCode());
    newClass=getObject(response.getLocation(),AnyTypeClassService.class,AnyTypeClassTO.class);
    UserTO userTO=UserITCase.getUniqueSampleTO("397@syncope.apache.org");
    userTO.getAuxClasses().add("csv");
    userTO.getAuxClasses().add(newClass.getKey());
    userTO.getResources().clear();
    userTO.getMemberships().clear();
    userTO.getDerAttrs().clear();
    userTO.getVirAttrs().clear();
    userTO.getDerAttrs().add(attrTO("csvuserid",null));
    userTO.getDerAttrs().add(attrTO("cn",null));
    userTO.getVirAttrs().add(attrTO(virSchema.getKey(),"test@testone.org"));
    userTO.getResources().add(RESOURCE_NAME_CSV);
    userTO=createUser(userTO).getAny();
    assertNotNull(userTO);
    assertTrue(RESOURCE_NAME_CSV.equals(userTO.getResources().iterator().next()));
    assertEquals("test@testone.org",userTO.getVirAttrs().iterator().next().getValues().get(0));
    UserTO toBeUpdated=userService.read(userTO.getKey());
    UserPatch userPatch=new UserPatch();
    userPatch.setKey(toBeUpdated.getKey());
    userPatch.setPassword(new PasswordPatch.Builder().value("password234").build());
    userPatch.getResources().add(new StringPatchItem.Builder().operation(PatchOperation.ADD_REPLACE).value(RESOURCE_NAME_WS2).build());
    userPatch.getVirAttrs().add(attrTO(virSchema.getKey(),"test@testoneone.com"));
    userPatch.setPassword(new PasswordPatch.Builder().value("password234").onSyncope(true).resource(RESOURCE_NAME_WS2).build());
    ProvisioningResult<UserTO> result=updateUser(userPatch);
    assertNotNull(result);
    toBeUpdated=result.getAny();
    assertTrue(toBeUpdated.getVirAttrs().iterator().next().getValues().contains("test@testoneone.com"));
    assertEquals(2,result.getPropagationStatuses().size());
  }
  finally {
    csv.getProvisions().get(0).setMapping(origMapping);
    resourceService.update(csv);
  }
}

</code></pre>

<pre class="type-5 type-1 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE691(){
  ResourceTO ldap=resourceService.read(RESOURCE_NAME_LDAP);
  try {
    ProvisionTO provision=ldap.getProvision(AnyTypeKind.USER.name());
    assertNotNull(provision);
    CollectionUtils.filterInverse(provision.getMapping().getItems(),new Predicate<MappingItemTO>(){
      @Override public boolean evaluate(      final MappingItemTO item){
        return "mail".equals(item.getExtAttrName());
      }
    }
);
    provision.getVirSchemas().clear();
    ldap.setKey(RESOURCE_NAME_LDAP + "691" + getUUIDString());
    resourceService.create(ldap);
    ldap=resourceService.read(ldap.getKey());
    provision=ldap.getProvision(AnyTypeKind.USER.name());
    assertNotNull(provision);
    VirSchemaTO virSchema=new VirSchemaTO();
    virSchema.setKey("syncope691" + getUUIDString());
    virSchema.setExtAttrName("mail");
    virSchema.setProvision(provision.getKey());
    virSchema=createSchema(SchemaType.VIRTUAL,virSchema);
    assertNotNull(virSchema);
    AnyTypeClassTO newClass=new AnyTypeClassTO();
    newClass.setKey("syncope691" + getUUIDString());
    newClass.getVirSchemas().add(virSchema.getKey());
    Response response=anyTypeClassService.create(newClass);
    assertEquals(Response.Status.CREATED.getStatusCode(),response.getStatusInfo().getStatusCode());
    newClass=getObject(response.getLocation(),AnyTypeClassService.class,AnyTypeClassTO.class);
    UserTO userTO=UserITCase.getUniqueSampleTO("syncope691@syncope.apache.org");
    userTO.getAuxClasses().add(newClass.getKey());
    userTO.getResources().clear();
    userTO.getMemberships().clear();
    userTO.getDerAttrs().clear();
    userTO.getVirAttrs().clear();
    AttrTO emailTO=new AttrTO();
    emailTO.setSchema(virSchema.getKey());
    emailTO.getValues().add("test@issue691.dom1.org");
    emailTO.getValues().add("test@issue691.dom2.org");
    userTO.getVirAttrs().add(emailTO);
    userTO.getResources().add(ldap.getKey());
    userTO=createUser(userTO).getAny();
    assertNotNull(userTO);
    assertTrue(ldap.getKey().equals(userTO.getResources().iterator().next()));
    assertEquals(2,userTO.getVirAttrs().iterator().next().getValues().size(),0);
    assertTrue(userTO.getVirAttrs().iterator().next().getValues().contains("test@issue691.dom1.org"));
    assertTrue(userTO.getVirAttrs().iterator().next().getValues().contains("test@issue691.dom2.org"));
    UserPatch userPatch=new UserPatch();
    userPatch.setKey(userTO.getKey());
    userPatch.getVirAttrs().add(new AttrTO.Builder().schema(virSchema.getKey()).value("test@issue691.dom3.org").value("test@issue691.dom4.org").build());
    UserTO updated=updateUser(userPatch).getAny();
    assertNotNull(updated);
    assertEquals(2,updated.getVirAttrs().iterator().next().getValues().size(),0);
    assertTrue(updated.getVirAttrs().iterator().next().getValues().contains("test@issue691.dom3.org"));
    assertTrue(updated.getVirAttrs().iterator().next().getValues().contains("test@issue691.dom4.org"));
  }
  finally {
    try {
      resourceService.delete(ldap.getKey());
    }
 catch (    Exception ignore) {
    }
  }
}

</code></pre>

<pre class="type-5 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE453(){
  final String resourceName="issueSYNCOPE453-Res-" + getUUIDString();
  final String groupName="issueSYNCOPE453-Group-" + getUUIDString();
  ResourceTO resourceTO=new ResourceTO();
  resourceTO.setKey(resourceName);
  resourceTO.setConnector(107L);
  ProvisionTO provisionTO=new ProvisionTO();
  provisionTO.setAnyType(AnyTypeKind.USER.name());
  provisionTO.setObjectClass(ObjectClass.ACCOUNT_NAME);
  resourceTO.getProvisions().add(provisionTO);
  MappingTO mapping=new MappingTO();
  provisionTO.setMapping(mapping);
  MappingItemTO item=new MappingItemTO();
  item.setIntAttrName("aLong");
  item.setIntMappingType(IntMappingType.UserPlainSchema);
  item.setExtAttrName("ID");
  item.setPurpose(MappingPurpose.PROPAGATION);
  item.setConnObjectKey(true);
  mapping.setConnObjectKeyItem(item);
  item=new MappingItemTO();
  item.setExtAttrName("USERNAME");
  item.setIntAttrName("username");
  item.setIntMappingType(IntMappingType.Username);
  item.setPurpose(MappingPurpose.PROPAGATION);
  mapping.getItems().add(item);
  item=new MappingItemTO();
  item.setExtAttrName("EMAIL");
  item.setIntAttrName("rvirtualdata");
  item.setIntMappingType(IntMappingType.GroupVirtualSchema);
  item.setPurpose(MappingPurpose.PROPAGATION);
  mapping.getItems().add(item);
  assertNotNull(getObject(resourceService.create(resourceTO).getLocation(),ResourceService.class,ResourceTO.class));
  GroupTO groupTO=new GroupTO();
  groupTO.setName(groupName);
  groupTO.setRealm("/");
  groupTO.getVirAttrs().add(attrTO("rvirtualdata","ml@group.it"));
  groupTO.getResources().add(RESOURCE_NAME_LDAP);
  groupTO=createGroup(groupTO).getAny();
  assertEquals(1,groupTO.getVirAttrs().size());
  assertEquals("ml@group.it",groupTO.getVirAttrs().iterator().next().getValues().get(0));
  UserTO userTO=UserITCase.getUniqueSampleTO("syncope453@syncope.apache.org");
  userTO.getPlainAttrs().add(attrTO("aLong","123"));
  userTO.getResources().clear();
  userTO.getResources().add(resourceName);
  userTO.getVirAttrs().clear();
  userTO.getDerAttrs().clear();
  userTO.getMemberships().clear();
  userTO.getMemberships().add(new MembershipTO.Builder().group(groupTO.getKey()).build());
  ProvisioningResult<UserTO> result=createUser(userTO);
  assertEquals(2,result.getPropagationStatuses().size());
  assertEquals(PropagationTaskExecStatus.SUCCESS,result.getPropagationStatuses().get(0).getStatus());
  assertEquals(PropagationTaskExecStatus.SUCCESS,result.getPropagationStatuses().get(1).getStatus());
  userTO=result.getAny();
  JdbcTemplate jdbcTemplate=new JdbcTemplate(testDataSource);
  final Map<String,Object> actuals=jdbcTemplate.queryForMap("SELECT id, surname, email FROM testsync WHERE id=?",new Object[]{Integer.parseInt(userTO.getPlainAttrMap().get("aLong").getValues().get(0))});
  assertEquals(userTO.getPlainAttrMap().get("aLong").getValues().get(0),actuals.get("id").toString());
  assertEquals("ml@group.it",actuals.get("email"));
  resourceService.delete(resourceName);
  groupService.delete(groupTO.getKey());
}

</code></pre>

<pre class="type-5 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void issueSYNCOPE442(){
  UserTO userTO=UserITCase.getUniqueSampleTO("syncope442@apache.org");
  userTO.getVirAttrs().clear();
  AttrTO virAttrTO=new AttrTO();
  virAttrTO.setSchema("virtualdata");
  virAttrTO.getValues().add("virattrcache");
  userTO.getVirAttrs().add(virAttrTO);
  userTO.getMemberships().clear();
  userTO.getResources().clear();
  userTO.getResources().add(RESOURCE_NAME_DBVIRATTR);
  userTO=createUser(userTO).getAny();
  assertNotNull(userTO);
  userTO=userService.read(userTO.getKey());
  assertEquals("virattrcache",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
  String jdbcURL=null;
  ConnInstanceTO connInstanceTO=connectorService.readByResource(RESOURCE_NAME_DBVIRATTR,Locale.ENGLISH.getLanguage());
  for (  ConnConfProperty prop : connInstanceTO.getConf()) {
    if ("jdbcUrlTemplate".equals(prop.getSchema().getName())) {
      jdbcURL=prop.getValues().iterator().next().toString();
      prop.getValues().clear();
      prop.getValues().add("jdbc:h2:tcp://localhost:9092/xxx");
    }
  }
  connectorService.update(connInstanceTO);
  JdbcTemplate jdbcTemplate=new JdbcTemplate(testDataSource);
  String value=jdbcTemplate.queryForObject("SELECT USERNAME FROM testsync WHERE ID=?",String.class,userTO.getKey());
  assertEquals("virattrcache",value);
  jdbcTemplate.update("UPDATE testsync set USERNAME='virattrcache2' WHERE ID=?",userTO.getKey());
  value=jdbcTemplate.queryForObject("SELECT USERNAME FROM testsync WHERE ID=?",String.class,userTO.getKey());
  assertEquals("virattrcache2",value);
  userTO=userService.read(userTO.getKey());
  assertEquals("virattrcache",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
  for (  ConnConfProperty prop : connInstanceTO.getConf()) {
    if ("jdbcUrlTemplate".equals(prop.getSchema().getName())) {
      prop.getValues().clear();
      prop.getValues().add(jdbcURL);
    }
  }
  connectorService.update(connInstanceTO);
  userTO=userService.read(userTO.getKey());
  assertEquals("virattrcache",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
  UserPatch userPatch=new UserPatch();
  userPatch.setKey(userTO.getKey());
  userPatch.getResources().add(new StringPatchItem.Builder().operation(PatchOperation.ADD_REPLACE).value(RESOURCE_NAME_WS2).build());
  userTO=updateUser(userPatch).getAny();
  assertNotNull(userTO);
  userTO=userService.read(userTO.getKey());
  assertEquals("virattrcache2",userTO.getVirAttrMap().get("virtualdata").getValues().get(0));
}

</code></pre>

<pre class="type-5 type-6 type-2 type-10 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void virAttrCache(){
  UserTO userTO=UserITCase.getUniqueSampleTO("virattrcache@apache.org");
  userTO.getVirAttrs().clear();
  AttrTO virAttrTO=new AttrTO();
  virAttrTO.setSchema("virtualdata");
  virAttrTO.getValues().add("virattrcache");
  userTO.getVirAttrs().add(virAttrTO);
  userTO.getMemberships().clear();
  userTO.getResources().clear();
  userTO.getResources().add(RESOURCE_NAME_DBVIRATTR);
  UserTO actual=createUser(userTO).getAny();
  assertNotNull(actual);
  actual=userService.read(actual.getKey());
  assertEquals("virattrcache",actual.getVirAttrMap().get("virtualdata").getValues().get(0));
  JdbcTemplate jdbcTemplate=new JdbcTemplate(testDataSource);
  String value=jdbcTemplate.queryForObject("SELECT USERNAME FROM testsync WHERE ID=?",String.class,actual.getKey());
  assertEquals("virattrcache",value);
  jdbcTemplate.update("UPDATE testsync set USERNAME='virattrcache2' WHERE ID=?",actual.getKey());
  value=jdbcTemplate.queryForObject("SELECT USERNAME FROM testsync WHERE ID=?",String.class,actual.getKey());
  assertEquals("virattrcache2",value);
  actual=userService.read(actual.getKey());
  assertEquals("virattrcache",actual.getVirAttrMap().get("virtualdata").getValues().get(0));
  UserPatch userPatch=new UserPatch();
  userPatch.setKey(actual.getKey());
  userPatch.getVirAttrs().add(attrTO("virtualdata","virtualupdated"));
  actual=updateUser(userPatch).getAny();
  assertNotNull(actual);
  actual=userService.read(actual.getKey());
  assertNotNull(actual);
  assertEquals("virtualupdated",actual.getVirAttrMap().get("virtualdata").getValues().get(0));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
