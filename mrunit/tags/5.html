<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestDistributedCache </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveWithInvalidExtension() throws IOException {
  mapDriver.withCacheArchive("testarchive.tar.abc").withOutput(new Text("testarchive.tar.abc"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToMapReduceUsingDriverMethod() throws IOException {
  mapReduceDriver.setMapper(mapper);
  mapReduceDriver.setReducer(new IdentityReducer<Text,Text>());
  mapReduceDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToReducerUsingDriverMethod() throws IOException {
  reduceDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToMapperUsingDriverMethod() throws IOException {
  mapDriver.withCacheFile("testfile").withOutput(new Text("testfile"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToMapReduceUsingDriverMethod2() throws IOException {
  mapReduceDriver.setMapper(new IdentityMapper<Text,Text>());
  mapReduceDriver.setReducer(reducer);
  mapReduceDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToReducerUsingDriverMethod() throws IOException {
  reduceDriver.withCacheFile("testfile").withOutput(new Text("testfile"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToReducerUsingStaticMethod() throws Exception {
  Configuration conf=new Configuration();
  DistributedCache.addCacheFile(new File("README.txt").toURI(),conf);
  reduceDriver.withConfiguration(conf).withOutput(new Text("README.txt"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToMapperUsingStaticMethod() throws Exception {
  Configuration conf=new Configuration();
  DistributedCache.addCacheFile(new File("README.txt").toURI(),conf);
  mapDriver.withConfiguration(conf).withOutput(new Text("README.txt"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToMapperUsingDriverMethod() throws IOException {
  mapDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestExample </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIdentityMapper() throws IOException {
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestMapDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun1() throws IOException {
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.TestMapDriver.MapperWithCounters.Counters.X has value 1 instead of expected 4, " + "Counter with category category and name name has value 1 instead of expected 4)");
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,4).withCounter("category","name",4).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withOutputFormat(SequenceFileOutputFormat.class,SequenceFileInputFormat.class);
  driver.withInput(new Text("a"),new Text("1"));
  driver.withOutput(new Text("a"),new Text("1"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnexpectedOutputMultiple() throws IOException {
  thrown.expectAssertionErrorMessage("3 Error(s): (Received unexpected output (foo, bar) at position 1., " + "Received unexpected output (foo, bar) at position 2., " + "Received unexpected output (foo, bar) at position 3.)");
  driver.withMapper(new DuplicatingMapper(4)).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonTextWritableKeyWithOutputFromString() throws IOException {
  final MapDriver<Text,Text,LongWritable,Text> driver=MapDriver.newMapDriver(new NonTextWritableOutputKey());
  driver.withInputFromString("a\tb");
  driver.withOutputFromString("1\ta");
  thrown.expectAssertionErrorMessage("2 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (1, a) at position 0, got (1, a).");
  thrown.expectAssertionErrorMessage("Mismatch in key class: expected:" + " class org.apache.hadoop.io.Text actual: class org.apache.hadoop.io.LongWritable");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, somethingelse)" + " at position 0, got (foo, bar).)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("somethingelse")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterUsingRunMethodExplicitIgnoreCounterChecking() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,999).withCounter("INVALIDCOUNTER","NOTSET",999).run(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters");
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter("category","name",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterUsingRunMethodPerformingCounterChecking() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,1).withCounter("category","name",1).run(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Object k=new UncomparableWritable(1);
  Object v=new UncomparableWritable(2);
  MapDriver.newMapDriver(new IdentityMapper<Object,Object>()).withInput(k,v).withOutput(k,v).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bonusfoo, bar) at position 1.)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("bonusfoo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnexpectedOutputMultipleComparator() throws IOException {
  Comparator<Text> comparatorAlwaysEqual=new Comparator<Text>(){
    @Override public int compare(    Text o1,    Text o2){
      return 0;
    }
  }
;
  driver.setKeyComparator(comparatorAlwaysEqual);
  driver.setValueComparator(comparatorAlwaysEqual);
  thrown.expectAssertionErrorMessage("3 Error(s)");
  thrown.expectAssertionErrorMessage("Received unexpected output (foo, bar) at position 1.");
  thrown.expectAssertionErrorMessage("Received unexpected output (foo, bar) at position 2.");
  thrown.expectAssertionErrorMessage("Received unexpected output (foo, bar) at position 3.");
  driver.withMapper(new DuplicatingMapper(4)).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6Comparator() throws IOException {
  Comparator<Text> keyComparator=new Comparator<Text>(){
    @Override public int compare(    Text o1,    Text o2){
      if (o2.toString().equals("foo") && o1.toString().equals("someotherkey")) {
        return 0;
      }
      if (o2.toString().equals("someotherkey") && o1.toString().equals("foo")) {
        return 0;
      }
      return o1.compareTo(o2);
    }
  }
;
  driver.setKeyComparator(keyComparator);
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun8OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("3 Error(s): (Missing expected output (foo, bar), " + "Missing expected output (foo, bar), " + "Missing expected output (foo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, bar) at position 1.)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnexpectedOutputMultipleOrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("3 Error(s): (Received unexpected output (foo, bar), " + "Received unexpected output (foo, bar), " + "Received unexpected output (foo, bar))");
  driver.withMapper(new DuplicatingMapper(4)).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Expected no output; got 1 output(s).)");
  driver.withInput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonTextWritableWithInputFromString() throws IOException {
  final MapDriver<LongWritable,LongWritable,Text,Text> driver=MapDriver.newMapDriver(new NonTextWritableInput());
  driver.withInputFromString("a\tb");
  thrown.expectMessage(ClassCastException.class,"org.apache.hadoop.io.Text cannot be cast to org.apache.hadoop.io.LongWritable");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnexpectedOutput() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Received unexpected output (foo, bar) at position 1.)");
  driver.withMapper(new DuplicatingMapper()).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  final List<Pair<Text,Text>> outputs=new ArrayList<Pair<Text,Text>>();
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  driver.withAll(inputs).withAllOutput(outputs).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopy() throws IOException {
  driver=MapDriver.newMapDriver(new DuplicatingMapper());
  final Text input=new Text("a");
  driver.withInputKey(input);
  input.set("b");
  driver.withInputValue(input);
  input.set("c");
  final Text output=new Text("a");
  driver.withOutput(output,new Text("b"));
  output.set("b");
  driver.withOutput(new Text("a"),output);
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(MapperWithCounters.Counters.X,1).withCounter("category","name",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterUsingRunMethodImplicitIgnoreCounterChecking() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,999).withCounter("INVALIDCOUNTER","NOTSET",999).run();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleWithInput() throws IOException {
  driver.withInput(new Text("foo"),new Text("bar")).withInput(new Text("bar"),new Text("baz")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("bar"),new Text("baz")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(MapperWithCounters.Counters.X,1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (someotherkey, bar)" + " at position 0, got (foo, bar)., Missing expected output (foo, bar) at position 1.)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (someotherkey, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (someotherkey, bar), " + "Received unexpected output (foo, bar)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  final List<Pair<Text,Text>> outputs=new ArrayList<Pair<Text,Text>>();
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  driver.withAll(inputs).withAllOutput(outputs).runTest();
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.withAll(inputs).withAllOutput(outputs).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (someotherkey, bar)" + " at position 0, got (foo, bar).)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnexpectedOutputOrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Received unexpected output (foo, bar))");
  driver.withMapper(new DuplicatingMapper()).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNonTextWritableValueWithOutputFromString() throws IOException {
  final MapDriver<Text,Text,Text,LongWritable> driver=MapDriver.newMapDriver(new NonTextWritableOutputValue());
  driver.withInputFromString("a\tb");
  driver.withOutputFromString("a\t1");
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (a, 1)" + " at position 0, got (a, 1)., Mismatch in value class:" + " expected: class org.apache.hadoop.io.Text"+ " actual: class org.apache.hadoop.io.LongWritable)");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5Comparator() throws IOException {
  Comparator<Text> valueComparator=new Comparator<Text>(){
    @Override public int compare(    Text o1,    Text o2){
      return 0;
    }
  }
;
  driver.setValueComparator(valueComparator);
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("somethingelse")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  driver=MapDriver.newMapDriver();
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final MapDriver<Integer,IntWritable,Integer,IntWritable> driver=MapDriver.newMapDriver(new IdentityMapper<Integer,IntWritable>()).withConfiguration(conf);
  driver.setInput(1,new IntWritable(2));
  driver.addOutput(1,new IntWritable(2));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bonusfoo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("bonusfoo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  @SuppressWarnings({"rawtypes","unchecked"}) final MapDriver<Text,Text,LongWritable,Text> driver=MapDriver.newMapDriver(new IdentityMapper());
  driver.withOutputFormat(TextOutputFormat.class,TextInputFormat.class);
  driver.withInput(new Text("a"),new Text("1"));
  driver.withOutput(new LongWritable(),new Text("a\t1"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetInputNull(){
  thrown.expect(NullPointerException.class);
  driver.setInput((Pair<Text,Text>)null);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,1).withCounter("category","name",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,Text>> out=driver.withInput(new Text("foo"),new Text("bar")).run();
  final List<Pair<Text,Text>> expected=new ArrayList<Pair<Text,Text>>();
  expected.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  assertListEquals(out,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (foo, somethingelse), " + "Received unexpected output (foo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("somethingelse")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  driver=MapDriver.newMapDriver();
  thrown.expectMessage(IllegalStateException.class,"No Mapper class was provided");
  driver.withInput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestMapOutputShuffler </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleShuffle(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  final List<Pair<Text,List<Text>>> outputs=shuffler.shuffle(inputs);
  final List<Pair<Text,List<Text>>> expected=new ArrayList<Pair<Text,List<Text>>>();
  final List<Text> sublist=new ArrayList<Text>();
  sublist.add(new Text("b"));
  expected.add(new Pair<Text,List<Text>>(new Text("a"),sublist));
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiShuffle2(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("z")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  final List<Pair<Text,List<Text>>> outputs=shuffler.shuffle(inputs);
  final List<Pair<Text,List<Text>>> expected=new ArrayList<Pair<Text,List<Text>>>();
  final List<Text> sublist1=new ArrayList<Text>();
  sublist1.add(new Text("x"));
  sublist1.add(new Text("y"));
  expected.add(new Pair<Text,List<Text>>(new Text("a"),sublist1));
  final List<Text> sublist2=new ArrayList<Text>();
  sublist2.add(new Text("z"));
  sublist2.add(new Text("w"));
  expected.add(new Pair<Text,List<Text>>(new Text("b"),sublist2));
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiShuffle1(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("z")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  final List<Pair<Text,List<Text>>> outputs=shuffler.shuffle(inputs);
  final List<Pair<Text,List<Text>>> expected=new ArrayList<Pair<Text,List<Text>>>();
  final List<Text> sublist1=new ArrayList<Text>();
  sublist1.add(new Text("x"));
  sublist1.add(new Text("y"));
  expected.add(new Pair<Text,List<Text>>(new Text("a"),sublist1));
  final List<Text> sublist2=new ArrayList<Text>();
  sublist2.add(new Text("z"));
  sublist2.add(new Text("w"));
  expected.add(new Pair<Text,List<Text>>(new Text("b"),sublist2));
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testShuffleOneKey(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("c")));
  final List<Pair<Text,List<Text>>> outputs=shuffler.shuffle(inputs);
  final List<Pair<Text,List<Text>>> expected=new ArrayList<Pair<Text,List<Text>>>();
  final List<Text> sublist=new ArrayList<Text>();
  sublist.add(new Text("b"));
  sublist.add(new Text("c"));
  expected.add(new Pair<Text,List<Text>>(new Text("a"),sublist));
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestMapReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2() throws IOException {
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombiner() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun1() throws IOException {
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIdentityCombiner() throws IOException {
  driver.withCombiner(new IdentityReducer<Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter("category","name",1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 52) at position 0, got (bar, 12).");
  thrown.expectAssertionErrorMessage("Missing expected output (bar, 12) at position 1, got (foo, 52).");
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopy() throws IOException {
  final Text key=new Text("a");
  final LongWritable value=new LongWritable(1);
  driver.addInput(key,value);
  key.set("b");
  value.set(2);
  driver.addInput(key,value);
  key.set("a");
  value.set(1);
  driver.addOutput(key,value);
  key.set("b");
  value.set(2);
  driver.addOutput(key,value);
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters");
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter("category","name",1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3OrderInsensitive() throws IOException {
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,LongWritable>> out=driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).run();
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  assertListEquals(out,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.TestMapDriver.MapperWithCounters.Counters.X has value 1 instead of expected 20, " + "Counter with category category and name name has value 1 instead of expected 20)");
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,20).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter("category","name",20).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorBehaviour1() throws IOException {
  driver.withInput(new Text("A1"),new LongWritable(1L)).withInput(new Text("A2"),new LongWritable(1L)).withInput(new Text("B1"),new LongWritable(1L)).withInput(new Text("B2"),new LongWritable(1L)).withInput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("A1"),new LongWritable(2L)).withOutput(new Text("B1"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withKeyGroupingComparator(new FirstCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withOutputFormat(SequenceFileOutputFormat.class,SequenceFileInputFormat.class);
  driver.withInput(new Text("a"),new LongWritable(1));
  driver.withInput(new Text("a"),new LongWritable(2));
  driver.withOutput(new Text("a"),new LongWritable(3));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<Pair<Text,LongWritable>> inputs=new ArrayList<Pair<Text,LongWritable>>();
  inputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_A)));
  inputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_B)));
  inputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  final List<Pair<Text,LongWritable>> outputs=new ArrayList<Pair<Text,LongWritable>>();
  outputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  outputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  driver.withAll(inputs).withAllOutput(outputs).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  final MapReduceDriver driver=this.driver;
  driver.withOutputFormat(TextOutputFormat.class,TextInputFormat.class);
  driver.withInput(new Text("a"),new LongWritable(1));
  driver.withInput(new Text("a"),new LongWritable(2));
  driver.withOutput(new LongWritable(),new Text("a\t3"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  driver=MapReduceDriver.newMapReduceDriver();
  driver.withReducer(reducer).withInput(new Text("a"),new LongWritable(0));
  thrown.expectMessage(IllegalStateException.class,"No Mapper class was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorBehaviour2() throws IOException {
  driver.withInput(new Text("1A"),new LongWritable(1L)).withInput(new Text("2A"),new LongWritable(1L)).withInput(new Text("1B"),new LongWritable(1L)).withInput(new Text("2B"),new LongWritable(1L)).withInput(new Text("1C"),new LongWritable(1L)).withOutput(new Text("1A"),new LongWritable(1L)).withOutput(new Text("2A"),new LongWritable(1L)).withOutput(new Text("1B"),new LongWritable(1L)).withOutput(new Text("2B"),new LongWritable(1L)).withOutput(new Text("1C"),new LongWritable(1L)).withKeyGroupingComparator(new SecondCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  driver=MapReduceDriver.newMapReduceDriver();
  driver.withMapper(mapper).withInput(new Text("a"),new LongWritable(0));
  thrown.expectMessage(IllegalStateException.class,"No Reducer class was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter("category","name",1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  driver.withCombiner(new IdentityReducer<Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombinerAndIdentityReduce() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withReducer(new IdentityReducer<Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComparators() throws IOException {
  driver.withReducer(new Reducer<Text,LongWritable,Text,LongWritable>(){
    @Override public void reduce(    final Text key,    final Iterator<LongWritable> values,    final OutputCollector<Text,LongWritable> output,    final Reporter reporter) throws IOException {
      long outputValue=0;
      int count=0;
      while (values.hasNext()) {
        outputValue|=(values.next().get() << (count++ * 8));
      }
      output.collect(key,new LongWritable(outputValue));
    }
    @Override public void configure(    final JobConf job){
    }
    @Override public void close() throws IOException {
    }
  }
);
  driver.withKeyGroupingComparator(new FirstCharComparator());
  driver.withKeyOrderComparator(new SecondCharComparator());
  driver.addInput(new Text("a1"),new LongWritable(1));
  driver.addInput(new Text("b1"),new LongWritable(1));
  driver.addInput(new Text("a3"),new LongWritable(3));
  driver.addInput(new Text("a2"),new LongWritable(2));
  driver.addOutput(new Text("a1"),new LongWritable(0x1));
  driver.addOutput(new Text("b1"),new LongWritable(0x1));
  driver.addOutput(new Text("a2"),new LongWritable(0x2 | (0x3 << 8)));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUseOfWritableRegisteredComparator() throws IOException {
  MapReduceDriver<TestWritable,Text,TestWritable,Text,TestWritable,Text> driver=MapReduceDriver.newMapReduceDriver(new IdentityMapper<TestWritable,Text>(),new IdentityReducer<TestWritable,Text>());
  driver.withInput(new TestWritable("A1"),new Text("A1")).withInput(new TestWritable("A2"),new Text("A2")).withInput(new TestWritable("A3"),new Text("A3")).withKeyGroupingComparator(new TestWritable.SingleGroupComparator()).withOutput(new TestWritable("A3"),new Text("A3")).withOutput(new TestWritable("A3"),new Text("A2")).withOutput(new TestWritable("A3"),new Text("A1")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final MapReduceDriver<Integer,IntWritable,Integer,IntWritable,Integer,IntWritable> driver=MapReduceDriver.newMapReduceDriver(new IdentityMapper<Integer,IntWritable>(),new IdentityReducer<Integer,IntWritable>()).withConfiguration(conf);
  driver.withKeyOrderComparator(new JavaSerializationComparator<Integer>());
  driver.withKeyGroupingComparator(INTEGER_COMPARATOR);
  driver.withInput(1,new IntWritable(2)).withInput(2,new IntWritable(3));
  driver.withOutput(1,new IntWritable(2)).withOutput(2,new IntWritable(3));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDuplicateOutputOrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Received unexpected output (foo, bar))");
  driver2.withMapper(new IdentityMapper<Text,Text>()).withReducer(new IdentityReducer<Text,Text>());
  driver2.withInput(new Text("foo"),new Text("bar")).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorSpecifiedByConf() throws IOException {
  JobConf conf=new JobConf(new Configuration());
  conf.setOutputValueGroupingComparator(FirstCharComparator.class);
  driver.withInput(new Text("A1"),new LongWritable(1L)).withInput(new Text("A2"),new LongWritable(1L)).withInput(new Text("B1"),new LongWritable(1L)).withInput(new Text("B2"),new LongWritable(1L)).withInput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("A1"),new LongWritable(2L)).withOutput(new Text("B1"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withConfiguration(conf).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Text k=new Text("test");
  Object v=new UncomparableWritable(2);
  MapReduceDriver.newMapReduceDriver(new IdentityMapper<Text,Object>(),new IdentityReducer<Text,Object>()).withInput(k,v).withOutput(k,v).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestMultipleInputsMapReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  thrown.expectAssertionErrorMessage("2 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters, Actual counter ("+ "\"org.apache.hadoop.mrunit.TestMultipleInputsMapReduceDriver$TokenMapperWithCounters$Counters\",\"Y\")"+ " was not found in expected counters");
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withOutput(new Text("hie"),new Text("Hi")).withOutput(new Text("bie"),new Text("Goodbye")).withOutput(new Text("bie"),new Text("Bye")).withStrictCounterChecking().withCounter("category","name",3).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,3).withCounter("category","count",2).withCounter("category","sum",3).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  thrown.expectMessage(IllegalStateException.class,"No input was provided for mapper");
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombiner() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComparators() throws IOException {
  driver.withReducer(new Reducer<Text,LongWritable,Text,LongWritable>(){
    @Override public void reduce(    final Text key,    final Iterator<LongWritable> values,    final OutputCollector<Text,LongWritable> output,    final Reporter reporter) throws IOException {
      long outputValue=0;
      int count=0;
      while (values.hasNext()) {
        outputValue|=(values.next().get() << (count++ * 8));
      }
      output.collect(key,new LongWritable(outputValue));
    }
    @Override public void configure(    final JobConf job){
    }
    @Override public void close() throws IOException {
    }
  }
);
  driver.withKeyGroupingComparator(new TestMapReduceDriver.FirstCharComparator());
  driver.withKeyOrderComparator(new TestMapReduceDriver.SecondCharComparator());
  driver.addInput(mapper,new Text("a1"),new LongWritable(1));
  driver.addInput(mapper,new Text("b1"),new LongWritable(1));
  driver.addInput(mapper,new Text("a3"),new LongWritable(3));
  driver.addInput(mapper,new Text("a2"),new LongWritable(2));
  driver.addInput(tokenMapper,new LongWritable(1),new Text("c1 d1"));
  driver.addOutput(new Text("a1"),new LongWritable(0x1));
  driver.addOutput(new Text("b1"),new LongWritable(0x1));
  driver.addOutput(new Text("a2"),new LongWritable(0x2 | (0x3 << 8)));
  driver.addOutput(new Text("c1"),new LongWritable(0x1));
  driver.addOutput(new Text("d1"),new LongWritable(0x1));
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  thrown.expectAssertionErrorMessage("3 Error(s): (" + "Counter org.apache.hadoop.mrunit.TestMapDriver.MapperWithCounters.Counters.X has value 1 instead of expected 20, " + "Counter org.apache.hadoop.mrunit.TestMultipleInputsMapReduceDriver.TokenMapperWithCounters.Counters.Y has value 2 instead of expected 30, "+ "Counter with category category and name name has value 3 instead of expected 20)");
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withOutput(new Text("hie"),new Text("Hi")).withOutput(new Text("bie"),new Text("Goodbye")).withOutput(new Text("bie"),new Text("Bye")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,20).withCounter(TokenMapperWithCounters.Counters.Y,30).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter("category","name",20).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withOutput(new Text("hie"),new Text("Hi")).withOutput(new Text("bie"),new Text("Goodbye")).withOutput(new Text("bie"),new Text("Bye")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter(TokenMapperWithCounters.Counters.Y,2).withCounter("category","name",3).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,3).withCounter("category","count",2).withCounter("category","sum",3).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun() throws IOException {
  driver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void testUseOfWritableRegisteredComparator() throws IOException {
  MultipleInputsMapReduceDriver<TestWritable,Text,TestWritable,Text> testDriver=new MultipleInputsMapReduceDriver<TestWritable,Text,TestWritable,Text>(new IdentityReducer<TestWritable,Text>());
  IdentityMapper<TestWritable,Text> identityMapper=new IdentityMapper<TestWritable,Text>();
  IdentityMapper<TestWritable,Text> anotherIdentityMapper=new IdentityMapper<TestWritable,Text>();
  testDriver.addMapper(identityMapper);
  testDriver.addMapper(anotherIdentityMapper);
  testDriver.withInput(identityMapper,new TestWritable("A1"),new Text("A1")).withInput(identityMapper,new TestWritable("A2"),new Text("A2")).withInput(identityMapper,new TestWritable("A3"),new Text("A3")).withInput(anotherIdentityMapper,new TestWritable("B1"),new Text("B1")).withInput(anotherIdentityMapper,new TestWritable("B2"),new Text("B2")).withKeyGroupingComparator(new TestWritable.SingleGroupComparator()).withOutput(new TestWritable("B2"),new Text("B2")).withOutput(new TestWritable("B2"),new Text("B1")).withOutput(new TestWritable("B2"),new Text("A3")).withOutput(new TestWritable("B2"),new Text("A2")).withOutput(new TestWritable("B2"),new Text("A1")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIdentityCombiner() throws IOException {
  driver.withCombiner(new IdentityReducer<Text,LongWritable>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withInputFormat(SequenceFileInputFormat.class);
  driver.withOutputFormat(SequenceFileOutputFormat.class);
  driver.withInput(mapper,new Text("a"),new LongWritable(1));
  driver.withInput(mapper,new Text("a"),new LongWritable(2));
  driver.withInput(tokenMapper,new LongWritable(3),new Text("a b"));
  driver.withOutput(new Text("a"),new LongWritable(6));
  driver.withOutput(new Text("b"),new LongWritable(3));
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<Pair<Text,LongWritable>> mapperInputs=new ArrayList<Pair<Text,LongWritable>>();
  mapperInputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_A)));
  mapperInputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_B)));
  mapperInputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  final List<Pair<LongWritable,Text>> tokenMapperInputs=new ArrayList<Pair<LongWritable,Text>>();
  tokenMapperInputs.add(new Pair<LongWritable,Text>(new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)));
  tokenMapperInputs.add(new Pair<LongWritable,Text>(new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)));
  final List<Pair<Text,LongWritable>> outputs=new ArrayList<Pair<Text,LongWritable>>();
  outputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_OUT)));
  outputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  driver.withAll(mapper,mapperInputs).withAll(tokenMapper,tokenMapperInputs).withAllOutput(outputs).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable> testDriver=new MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable>();
  testDriver.addMapper(mapper);
  testDriver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A));
  thrown.expectMessage(IllegalStateException.class,"No reducer class was provided");
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  driver.withCombiner(new IdentityReducer<Text,LongWritable>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final MultipleInputsMapReduceDriver<Integer,IntWritable,Integer,IntWritable> testDriver=MultipleInputsMapReduceDriver.newMultipleInputMapReduceDriver(new IdentityReducer<Integer,IntWritable>()).withConfiguration(conf);
  Mapper<Integer,IntWritable,Integer,IntWritable> identityMapper=new IdentityMapper<Integer,IntWritable>();
  Mapper<Integer,IntWritable,Integer,IntWritable> anotherIdentityMapper=new IdentityMapper<Integer,IntWritable>();
  testDriver.addMapper(identityMapper);
  testDriver.withInput(identityMapper,1,new IntWritable(2)).withInput(identityMapper,2,new IntWritable(3));
  testDriver.addMapper(anotherIdentityMapper);
  testDriver.withInput(anotherIdentityMapper,3,new IntWritable(4)).withInput(anotherIdentityMapper,4,new IntWritable(5));
  testDriver.withKeyOrderComparator(new JavaSerializationComparator<Integer>());
  testDriver.withKeyGroupingComparator(TestMapReduceDriver.INTEGER_COMPARATOR);
  testDriver.withOutput(1,new IntWritable(2)).withOutput(2,new IntWritable(3)).withOutput(3,new IntWritable(4)).withOutput(4,new IntWritable(5));
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorSpecifiedByConf() throws IOException {
  JobConf conf=new JobConf(new Configuration());
  conf.setOutputValueGroupingComparator(TestMapReduceDriver.FirstCharComparator.class);
  driver.withInput(mapper,new Text("A1"),new LongWritable(1L)).withInput(mapper,new Text("A2"),new LongWritable(1L)).withInput(mapper,new Text("B1"),new LongWritable(1L)).withInput(mapper,new Text("B2"),new LongWritable(1L)).withInput(mapper,new Text("C1"),new LongWritable(1L)).withInput(tokenMapper,new LongWritable(3L),new Text("D1 D2 E1")).withOutput(new Text("A1"),new LongWritable(2L)).withOutput(new Text("B1"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("D1"),new LongWritable(6L)).withOutput(new Text("E1"),new LongWritable(3L)).withConfiguration(conf).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupComparatorBehaviorFirst() throws IOException {
  driver.withInput(mapper,new Text("A1"),new LongWritable(1L)).withInput(mapper,new Text("A2"),new LongWritable(1L)).withInput(mapper,new Text("B1"),new LongWritable(1L)).withInput(mapper,new Text("B2"),new LongWritable(1L)).withInput(mapper,new Text("C1"),new LongWritable(1L)).withInput(tokenMapper,new LongWritable(3L),new Text("D1 D2 E1")).withOutput(new Text("A1"),new LongWritable(2L)).withOutput(new Text("B1"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("D1"),new LongWritable(6L)).withOutput(new Text("E1"),new LongWritable(3L)).withKeyGroupingComparator(new TestMapReduceDriver.FirstCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  final MultipleInputsMapReduceDriver testDriver=this.driver;
  testDriver.withInputFormat(TextInputFormat.class);
  testDriver.withOutputFormat(TextOutputFormat.class);
  testDriver.withInput(mapper,new Text("a"),new LongWritable(1));
  testDriver.withInput(mapper,new Text("a"),new LongWritable(2));
  testDriver.withInput(tokenMapper,new LongWritable(3),new Text("a b"));
  testDriver.withOutput(new LongWritable(0),new Text("a\t6"));
  testDriver.withOutput(new LongWritable(4),new Text("b\t3"));
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  MultipleInputsMapReduceDriver<Text,Object,Text,Object> testDriver=MultipleInputsMapReduceDriver.newMultipleInputMapReduceDriver(new IdentityReducer<Text,Object>());
  Mapper<Text,Object,Text,Object> identity=new IdentityMapper<Text,Object>();
  testDriver.addMapper(identity);
  Text k1=new Text("foo");
  Object v1=new UncomparableWritable(1);
  testDriver.withInput(identity,k1,v1);
  ReverseIdentityMapper<Object,Text> reverse=new ReverseIdentityMapper<Object,Text>();
  testDriver.addMapper(reverse);
  Text k2=new Text("bar");
  Object v2=new UncomparableWritable(2);
  testDriver.withInput(reverse,v2,k2);
  testDriver.withOutput(k1,v1).withOutput(k2,v2);
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withOutput(new Text("hie"),new Text("Hi")).withOutput(new Text("bie"),new Text("Goodbye")).withOutput(new Text("bie"),new Text("Bye")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter(TokenMapperWithCounters.Counters.Y,2).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,3).withCounter("category","count",2).withCounter("category","sum",3).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,LongWritable>> out=driver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).run();
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_OUT)));
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  assertListEquals(expected,out);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopy() throws IOException {
  final Text key=new Text("a");
  final LongWritable value=new LongWritable(1);
  driver.addInput(mapper,key,value);
  key.set("b");
  value.set(2);
  driver.addInput(mapper,key,value);
  key.set("a");
  value.set(1);
  driver.addOutput(key,value);
  key.set("b");
  value.set(2);
  driver.addOutput(key,value);
  final LongWritable longKey=new LongWritable(3);
  final Text textValue=new Text("c d");
  driver.addInput(tokenMapper,longKey,textValue);
  longKey.set(4);
  textValue.set("e f g");
  driver.addInput(tokenMapper,longKey,textValue);
  key.set("c");
  value.set(3);
  driver.addOutput(key,value);
  key.set("d");
  value.set(3);
  driver.addOutput(key,value);
  key.set("e");
  value.set(4);
  driver.addOutput(key,value);
  key.set("f");
  value.set(4);
  driver.addOutput(key,value);
  key.set("g");
  value.set(4);
  driver.addOutput(key,value);
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInputForMapper() throws IOException {
  MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable> testDriver=new MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable>();
  testDriver.addMapper(mapper);
  testDriver.addMapper(tokenMapper);
  testDriver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A));
  thrown.expectMessage(IllegalStateException.class,String.format("No input was provided for mapper %s",tokenMapper));
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable> testDriver=new MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable>();
  testDriver.withReducer(reducer);
  thrown.expectMessage(IllegalStateException.class,"No mappers were provided");
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombinerAndIdentityReducer() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withReducer(new IdentityReducer<Text,LongWritable>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupComparatorBehaviorSecond() throws IOException {
  driver.withInput(mapper,new Text("1A"),new LongWritable(1L)).withInput(mapper,new Text("2A"),new LongWritable(1L)).withInput(mapper,new Text("1B"),new LongWritable(1L)).withInput(mapper,new Text("2B"),new LongWritable(1L)).withInput(mapper,new Text("1C"),new LongWritable(1L)).withInput(tokenMapper,new LongWritable(2L),new Text("1D 2D 1E")).withOutput(new Text("1A"),new LongWritable(1L)).withOutput(new Text("2A"),new LongWritable(1L)).withOutput(new Text("1B"),new LongWritable(1L)).withOutput(new Text("2B"),new LongWritable(1L)).withOutput(new Text("1C"),new LongWritable(1L)).withOutput(new Text("1D"),new LongWritable(2L)).withOutput(new Text("2D"),new LongWritable(2L)).withOutput(new Text("1E"),new LongWritable(2L)).withKeyGroupingComparator(new TestMapReduceDriver.SecondCharComparator()).runTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestPipelineMapReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  final List<Pair<Mapper,Reducer>> pipeline=new ArrayList<Pair<Mapper,Reducer>>();
  pipeline.add(new Pair<Mapper,Reducer>(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>()));
  pipeline.add(null);
  pipeline.add(new Pair<Mapper,Reducer>(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>()));
  thrown.expectMessage(NullPointerException.class,"entry 1 in list is null");
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver(pipeline);
  driver.addInput(new Text("a"),new Text("b"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyPipeline() throws IOException {
  thrown.expectMessage(IllegalStateException.class,"No Mappers or Reducers in pipeline");
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withInput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSumInMiddle() throws IOException {
  final PipelineMapReduceDriver<Text,LongWritable,Text,LongWritable> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withMapReduce(new IdentityMapper<Text,LongWritable>(),new IdentityReducer<Text,LongWritable>()).withMapReduce(new IdentityMapper<Text,LongWritable>(),new LongSumReducer<Text>()).withMapReduce(new IdentityMapper<Text,LongWritable>(),new IdentityReducer<Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,2).withCounter("category","name",2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Text k=new Text("test");
  Object v=new UncomparableWritable(2);
  PipelineMapReduceDriver.newPipelineMapReduceDriver().withMapReduce(new IdentityMapper<Text,Object>(),new IdentityReducer<Text,Object>()).withInput(k,v).withOutput(k,v).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final JobConf conf=new JobConf();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  conf.setOutputKeyComparatorClass(JavaSerializationComparator.class);
  conf.setOutputValueGroupingComparator(TestMapReduceDriver.INTEGER_COMPARATOR.getClass());
  final PipelineMapReduceDriver<Integer,IntWritable,Integer,IntWritable> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.addMapReduce(new IdentityMapper<Integer,IntWritable>(),new IdentityReducer<Integer,IntWritable>());
  driver.addMapReduce(new IdentityMapper<Integer,IntWritable>(),new IdentityReducer<Integer,IntWritable>());
  driver.withConfiguration(conf);
  driver.withInput(1,new IntWritable(2)).withInput(2,new IntWritable(3));
  driver.withOutput(1,new IntWritable(2)).withOutput(2,new IntWritable(3));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSumAtEndWithInputAddAll() throws IOException {
  final List<Pair<Text,LongWritable>> inputs=new ArrayList<Pair<Text,LongWritable>>();
  inputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_A)));
  inputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  inputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_B)));
  final PipelineMapReduceDriver<Text,LongWritable,Text,LongWritable> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withMapReduce(new IdentityMapper<Text,LongWritable>(),new IdentityReducer<Text,LongWritable>()).withMapReduce(new IdentityMapper<Text,LongWritable>(),new IdentityReducer<Text,LongWritable>()).withMapReduce(new IdentityMapper<Text,LongWritable>(),new LongSumReducer<Text>()).withAll(inputs).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,2).withCounter("category","name",2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultipleIdentities() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withMapReduce(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>()).withMapReduce(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>()).withMapReduce(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>()).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  thrown.expect(NullPointerException.class);
  driver.addMapReduce(null,new IdentityReducer<Text,Text>());
  driver.addInput(new Text("a"),new Text("b"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters");
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter("category","name",2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopy() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withMapReduce(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>());
  final Text key=new Text("a");
  final Text value=new Text("b");
  driver.addInput(key,value);
  key.set("c");
  value.set("d");
  driver.addInput(key,value);
  key.set("a");
  value.set("b");
  driver.addOutput(key,value);
  key.set("c");
  value.set("d");
  driver.addOutput(key,value);
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  driver.addMapReduce(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>(),new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>());
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.TestMapDriver.MapperWithCounters.Counters.X has value 2 instead of expected 20, " + "Counter with category category and name name has value 2 instead of expected 20)");
  driver.withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,20).withCounter("category","name",20).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleIdentity() throws IOException {
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withMapReduce(new IdentityMapper<Text,Text>(),new IdentityReducer<Text,Text>()).withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  final PipelineMapReduceDriver<Text,Text,Text,Text> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSumAtEnd() throws IOException {
  final PipelineMapReduceDriver<Text,LongWritable,Text,LongWritable> driver=PipelineMapReduceDriver.newPipelineMapReduceDriver();
  driver.withMapReduce(new IdentityMapper<Text,LongWritable>(),new IdentityReducer<Text,LongWritable>()).withMapReduce(new IdentityMapper<Text,LongWritable>(),new IdentityReducer<Text,LongWritable>()).withMapReduce(new IdentityMapper<Text,LongWritable>(),new LongSumReducer<Text>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.TestReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 12)" + " at position 0, got (foo, 10).)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(INCORRECT_OUT)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopy() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver(new IdentityReducer<Text,Text>());
  final Text input=new Text("a");
  driver.withInputKey(input);
  input.set("b");
  driver.withInputValue(input);
  input.set("c");
  driver.withInputValue(input);
  final Text output=new Text("a");
  driver.withOutput(output,new Text("b"));
  output.set("c");
  driver.withOutput(new Text("a"),output);
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("3 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 4)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 6)");
  thrown.expectAssertionErrorMessage("Received unexpected output (foo, 10)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).withOutput(new Text("foo"),new LongWritable(IN_B)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Object k=new UncomparableWritable(1);
  Object v=new UncomparableWritable(2);
  ReduceDriver.newReduceDriver(new IdentityReducer<Object,Object>()).withInput(k,Lists.newArrayList(v)).withOutput(k,v).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 4)" + " at position 0, got (foo, 10).)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun8OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (foo, 12), " + "Received unexpected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(INCORRECT_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  driver=ReduceDriver.newReduceDriver();
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 4) at position 0, got (foo, 10).");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 6) at position 1.");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).withOutput(new Text("foo"),new LongWritable(IN_B)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  final ReduceDriver driver=ReduceDriver.newReduceDriver(reducer);
  driver.withOutputFormat(TextOutputFormat.class,TextInputFormat.class);
  driver.withInputKey(new Text("a"));
  driver.withInputValue(new LongWritable(1)).withInputValue(new LongWritable(2));
  driver.withOutput(new LongWritable(),new Text("a\t3"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withOutputFormat(SequenceFileOutputFormat.class,SequenceFileInputFormat.class);
  driver.withInputKey(new Text("a"));
  driver.withInputValue(new LongWritable(1)).withInputValue(new LongWritable(2));
  driver.withOutput(new Text("a"),new LongWritable(3));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 10) at position 1.)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (bar, 10), " + "Received unexpected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDuplicateOutputOrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Received unexpected output (foo, bar))");
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver(new IdentityReducer<Text,Text>());
  driver.withInputKey(new Text("foo")).withInputValue(new Text("bar")).withInputValue(new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),values).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withCounter(ReducerWithCounters.Counters.COUNT,1).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",1).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),values).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.COUNT,1).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",1).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissingMultipleInput() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.TestReduceDriver$ReducerWithCounters$Counters\",\"COUNT\")" + " was not found in expected counters");
  final LinkedList<Text> valuesAlpha=new LinkedList<Text>();
  valuesAlpha.add(new Text("a"));
  final LinkedList<Text> valuesBeta=new LinkedList<Text>();
  valuesBeta.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),valuesAlpha).withInput(new Text("hie"),valuesBeta).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissingMultipleInput() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"count\")" + " was not found in expected counters");
  final LinkedList<Text> valuesAlpha=new LinkedList<Text>();
  valuesAlpha.add(new Text("a"));
  final LinkedList<Text> valuesBeta=new LinkedList<Text>();
  valuesBeta.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),valuesAlpha).withInput(new Text("hie"),valuesBeta).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.COUNT,2).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleIteration() throws IOException {
  reducer=new DoubleIterReducer<Text,LongWritable>();
  driver=ReduceDriver.newReduceDriver(reducer);
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(1)).withInputValue(new LongWritable(1)).withInputValue(new LongWritable(1)).withInputValue(new LongWritable(1)).withOutput(new Text("foo"),new LongWritable(4)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedEnumCounter() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  final LinkedList<Text> inputValues=new LinkedList<Text>();
  inputValues.add(new Text("Hi"));
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.TestReduceDriver.ReducerWithCounters.Counters.SUM has value 1 instead of expected 4, " + "Counter with category category and name sum has value 1 instead of expected 4)");
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),inputValues).withOutput(new Text("hie"),new Text("Hi")).withCounter(ReducerWithCounters.Counters.SUM,4).withCounter("category","sum",4).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  driver=ReduceDriver.newReduceDriver();
  thrown.expectMessage(IllegalStateException.class,"No Reducer class was provided");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissingMultipleInput() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  final LinkedList<Text> valuesAlpha=new LinkedList<Text>();
  valuesAlpha.add(new Text("a"));
  final LinkedList<Text> valuesBeta=new LinkedList<Text>();
  valuesBeta.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),valuesAlpha).withInput(new Text("hie"),valuesBeta).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.COUNT,2).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun1() throws IOException {
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10) at position 0, got (foo, 10).)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (foo, 4), " + "Received unexpected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3ComparatorFail() throws IOException {
  Comparator<LongWritable> toleranceComparator=new Comparator<LongWritable>(){
    @Override public int compare(    LongWritable o1,    LongWritable o2){
      if (Math.abs(o1.get() - o2.get()) < 2) {
        return 0;
      }
      return o1.compareTo(o2);
    }
  }
;
  driver.setValueComparator(toleranceComparator);
  thrown.expectAssertionErrorMessage("1 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 12) at position 0, got (foo, 10).");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(INCORRECT_OUT)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3ComparatorOK() throws IOException {
  Comparator<LongWritable> toleranceComparator=new Comparator<LongWritable>(){
    @Override public int compare(    LongWritable o1,    LongWritable o2){
      if (Math.abs(o1.get() - o2.get()) < 5) {
        return 0;
      }
      return o1.compareTo(o2);
    }
  }
;
  driver.setValueComparator(toleranceComparator);
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(INCORRECT_OUT)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (bar, 10)" + " at position 0, got (foo, 10)., Missing expected output (foo, 10) at position 1.)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.TestReduceDriver$ReducerWithCounters$Counters\",\"COUNT\")" + " was not found in expected counters");
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),values).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",1).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,LongWritable>> out=driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).run();
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  assertListEquals(out,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun8() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10) at position 1.)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterMultipleInput() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  final LinkedList<Text> valuesAlpha=new LinkedList<Text>();
  valuesAlpha.add(new Text("a"));
  final LinkedList<Text> valuesBeta=new LinkedList<Text>();
  valuesBeta.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),valuesAlpha).withInput(new Text("hie"),valuesBeta).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withCounter(ReducerWithCounters.Counters.COUNT,2).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final ReduceDriver<Integer,Integer,Integer,Integer> driver=ReduceDriver.newReduceDriver(new IdentityReducer<Integer,Integer>()).withConfiguration(conf);
  driver.withInputKey(1).withInputValue(2).withOutput(1,2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  final List<LongWritable> vals=new ArrayList<LongWritable>();
  vals.add(new LongWritable(IN_A));
  vals.add(new LongWritable(IN_B));
  final List<Pair<Text,List<LongWritable>>> inputs=new ArrayList<Pair<Text,List<LongWritable>>>();
  inputs.add(new Pair<Text,List<LongWritable>>(new Text("foo"),vals));
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  driver.withAll(inputs).withAllOutput(expected).runTest();
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.withAll(inputs).withAllOutput(expected).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"count\")" + " was not found in expected counters");
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),values).withOutput(new Text("hie"),new Text("a")).withOutput(new Text("hie"),new Text("b")).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.COUNT,1).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<LongWritable> vals=new ArrayList<LongWritable>();
  vals.add(new LongWritable(IN_A));
  vals.add(new LongWritable(IN_B));
  final List<Pair<Text,List<LongWritable>>> inputs=new ArrayList<Pair<Text,List<LongWritable>>>();
  inputs.add(new Pair<Text,List<LongWritable>>(new Text("foo"),vals));
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  driver.withAll(inputs).withAllOutput(expected).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.internal.io.TestSerialization </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalStateException.class) public void testCopyExceptionIfNoSerializer(){
  final Configuration conf=new Configuration();
  Serialization serialization=new Serialization(conf);
  serialization.copy(1,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.internal.mapred.TestMockOutputCollector </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatedObjectUse() throws IOException {
  final Mapper<Text,Text,Text,Text> mapper=new RepeatMapper();
  final MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver(mapper);
  driver.withInput(new Text("inK"),new Text("inV")).withOutput(new Text("1"),new Text("a")).withOutput(new Text("2"),new Text("b")).withOutput(new Text("3"),new Text("c")).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.internal.mapred.TestMockReporter </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetInputSplitForReducer(){
  thrown.expectMessage(UnsupportedOperationException.class,"Reducer cannot call getInputSplit()");
  new MockReporter(MockReporter.ReporterType.Reducer,null,null).getInputSplit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.internal.util.TestErrors </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldBuildAssertionErrorMessageWithRecordedErrors(){
  thrown.expectMessage("2 Error(s): (this is a first error, this is a second error)");
  errors.record("this is a %s error","first");
  errors.record("this is a %s error","second");
  errors.assertNone();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldContinueAfterAssertIfNoErrors(){
  errors.assertNone();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldUseLiteralMessageWhenNoArguments(){
  thrown.expectMessage("2 Error(s): (this is a %s error, this is a %d error)");
  errors.record("this is a %s error");
  errors.record("this is a %d error");
  errors.assertNone();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldLogRecordedError(){
  errors.record("this is an %s","error");
  verify(log).error("this is an error");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AssertionError.class) public void shouldThrowExceptionOnAssertWhenAnyRecordedError(){
  errors.record("an error");
  errors.assertNone();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.internal.util.TestStringUtils </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList9(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,,bar");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text(""));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList7(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,bar, baz");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  verify.add(new Text("baz"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList8(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,bar,");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList10(){
  final List<Text> out=StringUtils.parseCommaDelimitedList(",foo,bar");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text(""));
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList5(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("   foo,bar");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList6(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,bar   ");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList3(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo   ,bar");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList4(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,   bar");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test method for{@link StringUtils#parseCommaDelimitedList(java.lang.String)}.
 */
@Test public void testParseCommaDelimList1(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList8a(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,bar,,");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  verify.add(new Text(""));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testParseCommaDelimList2(){
  final List<Text> out=StringUtils.parseCommaDelimitedList("foo,bar");
  final ArrayList<Text> verify=new ArrayList<Text>();
  verify.add(new Text("foo"));
  verify.add(new Text("bar"));
  assertListEquals(out,verify);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestDistributedCache </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToMapReduceUsingDriverMethod() throws IOException {
  mapReduceDriver.setMapper(mapper);
  mapReduceDriver.setReducer(new Reducer<Text,Text,Text,Text>());
  mapReduceDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToMapperUsingStaticMethod() throws Exception {
  Configuration conf=new Configuration();
  DistributedCache.addCacheFile(new File("README.txt").toURI(),conf);
  mapDriver.withConfiguration(conf).withOutput(new Text("README.txt"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToReducerUsingDriverMethod() throws IOException {
  reduceDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToMapReduceUsingDriverMethod2() throws IOException {
  mapReduceDriver.setMapper(new Mapper<Text,Text,Text,Text>());
  mapReduceDriver.setReducer(reducer);
  mapReduceDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToMapperUsingDriverMethod() throws IOException {
  mapDriver.withCacheFile("testfile").withOutput(new Text("testfile"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToReducerUsingDriverMethod() throws IOException {
  reduceDriver.withCacheFile("testfile").withOutput(new Text("testfile"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveWithInvalidExtension() throws IOException {
  mapDriver.withCacheArchive("testarchive.tar.abc").withOutput(new Text("testarchive.tar.abc"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheFileToReducerUsingStaticMethod() throws Exception {
  Configuration conf=new Configuration();
  DistributedCache.addCacheFile(new File("README.txt").toURI(),conf);
  reduceDriver.withConfiguration(conf).withOutput(new Text("README.txt"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddCacheArchiveToMapperUsingDriverMethod() throws IOException {
  mapDriver.withCacheArchive("testarchive.tar").withOutput(new Text("testarchive.tar"),new Text("dir")).withOutput(new Text("testarchive.tar/a"),new Text("file")).withOutput(new Text("testarchive.tar/b"),new Text("file")).withOutput(new Text("testarchive.tar/c"),new Text("file")).withOutput(new Text("testarchive.tar/d"),new Text("file")).runTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestMapDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(MapperWithCounters.Counters.X,1).withCounter("category","name",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  driver=MapDriver.newMapDriver();
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withOutputFormat(SequenceFileOutputFormat.class,SequenceFileInputFormat.class);
  driver.withInput(new Text("a"),new Text("1"));
  driver.withOutput(new Text("a"),new Text("1"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,1).withCounter("category","name",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (someotherkey, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (someotherkey, bar)" + " at position 0, got (foo, bar)., Missing expected output (foo, bar) at position 1.)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (foo, somethingelse), " + "Received unexpected output (foo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("somethingelse")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  final List<Pair<Text,Text>> outputs=new ArrayList<Pair<Text,Text>>();
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  driver.withAll(inputs).withAllOutput(outputs).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.mapreduce.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters");
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter("category","name",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetInputNull(){
  thrown.expect(NullPointerException.class);
  driver.setInput((Pair<Text,Text>)null);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void textMockContext() throws IOException, InterruptedException {
  thrown.expectMessage(RuntimeException.class,"Injected!");
  Mapper<Text,Text,Text,Text>.Context context=driver.getContext();
  doThrow(new RuntimeException("Injected!")).when(context).write(any(Text.class),any(Text.class));
  driver.withInput(new Text("a"),new Text("1"));
  driver.withOutput(new Text("a"),new Text("1"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (someotherkey, bar), " + "Received unexpected output (foo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bonusfoo, bar) at position 1.)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("bonusfoo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final MapDriver<Integer,IntWritable,IntWritable,Integer> driver=MapDriver.newMapDriver(new InverseMapper<Integer,IntWritable>()).withConfiguration(conf);
  driver.setInput(1,new IntWritable(2));
  driver.addOutput(new IntWritable(2),1);
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  driver=MapDriver.newMapDriver();
  thrown.expectMessage(IllegalStateException.class,"No Mapper class was provided");
  driver.withInput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, bar) at position 1.)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  inputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  final List<Pair<Text,Text>> outputs=new ArrayList<Pair<Text,Text>>();
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  outputs.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  driver.withAll(inputs).withAllOutput(outputs).runTest();
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.withAll(inputs).withAllOutput(outputs).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithTaskAttemptUse() throws IOException {
  final MapDriver<Text,NullWritable,Text,NullWritable> driver=MapDriver.newMapDriver(new TaskAttemptMapper());
  driver.withInput(new Text("anything"),NullWritable.get()).withOutput(new Text("attempt__0000_m_000000_0"),NullWritable.get()).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,Text>> out=driver.withInput(new Text("foo"),new Text("bar")).run();
  final List<Pair<Text,Text>> expected=new ArrayList<Pair<Text,Text>>();
  expected.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  assertListEquals(out,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (someotherkey, bar)" + " at position 0, got (foo, bar).)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("someotherkey"),new Text("bar")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testInputSplitDetails() throws IOException {
  final MapDriver<NullWritable,NullWritable,Text,LongWritable> driver=MapDriver.newMapDriver(new InputSplitDetailMapper());
  driver.withInput(NullWritable.get(),NullWritable.get()).withOutput(new Text("somefile"),new LongWritable(0L)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  @SuppressWarnings({"rawtypes","unchecked"}) final MapDriver<Text,Text,LongWritable,Text> driver=MapDriver.newMapDriver(new Mapper());
  driver.withOutputFormat(TextOutputFormat.class,TextInputFormat.class);
  driver.withInput(new Text("a"),new Text("1"));
  driver.withOutput(new LongWritable(),new Text("a\t1"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bonusfoo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("bonusfoo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, somethingelse)" + " at position 0, got (foo, bar).)");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("somethingelse")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCountingOutputFormat() throws IOException {
  driver.withOutputFormat(CountingOutputFormat.class,KeyValueTextInputFormat.class);
  driver.withInput(new Text("a"),new Text("1"));
  driver.withOutput(new Text("a"),new Text("1"));
  driver.withCounter(RecordCounter.NUM_RECORDS,1);
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Object k=new UncomparableWritable(1);
  Object v=new UncomparableWritable(2);
  MapDriver.newMapDriver(new Mapper<Object,Object,Object,Object>()).withInput(k,v).withOutput(k,v).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, bar))");
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Expected no output; got 1 output(s).)");
  driver.withInput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(MapperWithCounters.Counters.X,1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun1() throws IOException {
  driver.withInput(new Text("foo"),new Text("bar")).withOutput(new Text("foo"),new Text("bar")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  MapDriver<Text,Text,Text,Text> driver=MapDriver.newMapDriver();
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.mapreduce.TestMapDriver.MapperWithCounters.Counters.X has value 1 instead of expected 4, " + "Counter with category category and name name has value 1 instead of expected 4)");
  driver.withMapper(new MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withOutput(new Text("hie"),new Text("Hi")).withCounter(MapperWithCounters.Counters.X,4).withCounter("category","name",4).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestMapReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorBehaviour1() throws IOException {
  driver.withInput(new Text("A1"),new LongWritable(1L)).withInput(new Text("A2"),new LongWritable(1L)).withInput(new Text("B1"),new LongWritable(1L)).withInput(new Text("B2"),new LongWritable(1L)).withInput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("A2"),new LongWritable(2L)).withOutput(new Text("B2"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withKeyGroupingComparator(new FirstCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,LongWritable>> out=driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).run();
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  assertListEquals(out,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Text k=new Text("test");
  Object v=new UncomparableWritable(2);
  MapReduceDriver.newMapReduceDriver(new Mapper<Text,Object,Text,Object>(),new Reducer<Text,Object,Text,Object>()).withInput(k,v).withOutput(k,v).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  driver=MapReduceDriver.newMapReduceDriver();
  driver.withReducer(reducer).withInput(new Text("a"),new LongWritable(0));
  thrown.expectMessage(IllegalStateException.class,"No Mapper class was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter("category","name",1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorBehaviour2() throws IOException {
  driver.withInput(new Text("1A"),new LongWritable(1L)).withInput(new Text("2A"),new LongWritable(1L)).withInput(new Text("1B"),new LongWritable(1L)).withInput(new Text("2B"),new LongWritable(1L)).withInput(new Text("1C"),new LongWritable(1L)).withOutput(new Text("1A"),new LongWritable(1L)).withOutput(new Text("2A"),new LongWritable(1L)).withOutput(new Text("1B"),new LongWritable(1L)).withOutput(new Text("2B"),new LongWritable(1L)).withOutput(new Text("1C"),new LongWritable(1L)).withKeyGroupingComparator(new SecondCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final MapReduceDriver<IntWritable,Integer,Integer,IntWritable,Integer,IntWritable> driver=MapReduceDriver.newMapReduceDriver(new InverseMapper<IntWritable,Integer>(),new IntSumReducer<Integer>()).withConfiguration(conf);
  driver.setKeyGroupingComparator(org.apache.hadoop.mrunit.TestMapReduceDriver.INTEGER_COMPARATOR);
  driver.setKeyOrderComparator(new JavaSerializationComparator<Integer>());
  driver.withInput(new IntWritable(1),2).withInput(new IntWritable(2),3);
  driver.withOutput(2,new IntWritable(1)).withOutput(3,new IntWritable(2)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withOutputFormat(SequenceFileOutputFormat.class,SequenceFileInputFormat.class);
  driver.withInput(new Text("a"),new LongWritable(1));
  driver.withInput(new Text("a"),new LongWritable(2));
  driver.withOutput(new Text("a"),new LongWritable(3));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombinerAndIdentityReduce() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withReducer(new Reducer<Text,LongWritable,Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortAndGroupOneKey(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("c")));
  final List<KeyValueReuseList<Text,Text>> outputs=driver2.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver2.getConfiguration());
  sublist.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  sublist.add(new Pair<Text,Text>(new Text("a"),new Text("c")));
  expected.add(sublist);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.mapreduce.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters");
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter("category","name",1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter("category","name",1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  final MapReduceDriver driver=this.driver;
  driver.withOutputFormat(TextOutputFormat.class,TextInputFormat.class);
  driver.withInput(new Text("a"),new LongWritable(1));
  driver.withInput(new Text("a"),new LongWritable(2));
  driver.withOutput(new LongWritable(),new Text("a\t3"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleSortAndGroup(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  final List<KeyValueReuseList<Text,Text>> outputs=driver2.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver2.getConfiguration());
  sublist.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  expected.add(sublist);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.mapreduce.TestMapDriver.MapperWithCounters.Counters.X has value 1 instead of expected 20, " + "Counter with category category and name name has value 1 instead of expected 20)");
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,20).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter("category","name",20).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiSortAndGroup2(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("z")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  final List<KeyValueReuseList<Text,Text>> outputs=driver2.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist1=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver2.getConfiguration());
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  expected.add(sublist1);
  final KeyValueReuseList<Text,Text> sublist2=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver2.getConfiguration());
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("z")));
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  expected.add(sublist2);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  MapReduceDriver<Text,Text,Text,Text,Text,Text> driver=MapReduceDriver.newMapReduceDriver();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  driver.withMapper(new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>()).withInput(new Text("hie"),new Text("Hi")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,1).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,1).withCounter("category","count",1).withCounter("category","sum",1).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3OrderInsensitive() throws IOException {
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComparators() throws IOException {
  driver.withReducer(new Reducer<Text,LongWritable,Text,LongWritable>(){
    @Override protected void reduce(    final Text key,    final Iterable<LongWritable> values,    final Context context) throws IOException, InterruptedException {
      Text outKey=new Text(key);
      long outputValue=0;
      int count=0;
      for (      final LongWritable value : values) {
        outputValue|=(value.get() << (count++ * 8));
      }
      context.write(outKey,new LongWritable(outputValue));
    }
  }
);
  driver.withKeyGroupingComparator(new FirstCharComparator());
  driver.withKeyOrderComparator(new SecondCharComparator());
  driver.addInput(new Text("a1"),new LongWritable(1));
  driver.addInput(new Text("b1"),new LongWritable(1));
  driver.addInput(new Text("a3"),new LongWritable(3));
  driver.addInput(new Text("a2"),new LongWritable(2));
  driver.addOutput(new Text("a1"),new LongWritable(0x1));
  driver.addOutput(new Text("b1"),new LongWritable(0x1));
  driver.addOutput(new Text("a2"),new LongWritable(0x2 | (0x3 << 8)));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiSortAndGroup1(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("z")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  final List<KeyValueReuseList<Text,Text>> outputs=driver2.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist1=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver2.getConfiguration());
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  expected.add(sublist1);
  final KeyValueReuseList<Text,Text> sublist2=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver2.getConfiguration());
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("z")));
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  expected.add(sublist2);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  driver.withCombiner(new Reducer<Text,LongWritable,Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombiner() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  driver=MapReduceDriver.newMapReduceDriver();
  driver.withMapper(mapper).withInput(new Text("a"),new LongWritable(0));
  thrown.expectMessage(IllegalStateException.class,"No Reducer class was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 52) at position 0, got (bar, 12).");
  thrown.expectAssertionErrorMessage("Missing expected output (bar, 12) at position 1, got (foo, 52).");
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIdentityCombiner() throws IOException {
  driver.withCombiner(new Reducer<Text,LongWritable,Text,LongWritable>()).withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2() throws IOException {
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<Pair<Text,LongWritable>> inputs=new ArrayList<Pair<Text,LongWritable>>();
  inputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_A)));
  inputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_B)));
  inputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  final List<Pair<Text,LongWritable>> outputs=new ArrayList<Pair<Text,LongWritable>>();
  outputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  outputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  driver.withAll(inputs).withAllOutput(outputs).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUseOfWritableRegisteredComparator() throws IOException {
  MapReduceDriver<TestWritable,Text,TestWritable,Text,TestWritable,Text> driver=MapReduceDriver.newMapReduceDriver(new Mapper(),new Reducer());
  driver.withInput(new TestWritable("A1"),new Text("A1")).withInput(new TestWritable("A2"),new Text("A2")).withInput(new TestWritable("A3"),new Text("A3")).withKeyGroupingComparator(new TestWritable.SingleGroupComparator()).withOutput(new TestWritable("A3"),new Text("A3")).withOutput(new TestWritable("A2"),new Text("A2")).withOutput(new TestWritable("A1"),new Text("A1")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun1() throws IOException {
  driver.withInput(new Text("foo"),new LongWritable(FOO_IN_A)).withInput(new Text("foo"),new LongWritable(FOO_IN_B)).withInput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("bar"),new LongWritable(BAR_IN)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestMultipleInputsMapReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombiner() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,LongWritable>> out=driver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).run();
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_OUT)));
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  assertListEquals(expected,out);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoMapper() throws IOException {
  MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable> testDriver=new MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable>();
  testDriver.withReducer(reducer);
  thrown.expectMessage(IllegalStateException.class,"No mappers were provided");
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInputForMapper() throws IOException {
  MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable> testDriver=new MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable>();
  testDriver.addMapper(mapper);
  testDriver.addMapper(tokenMapper);
  testDriver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A));
  thrown.expectMessage(IllegalStateException.class,String.format("No input was provided for mapper %s",tokenMapper));
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withInputFormat(SequenceFileInputFormat.class);
  driver.withOutputFormat(SequenceFileOutputFormat.class);
  driver.withInput(mapper,new Text("a"),new LongWritable(1));
  driver.withInput(mapper,new Text("a"),new LongWritable(2));
  driver.withInput(tokenMapper,new LongWritable(3),new Text("a b"));
  driver.withOutput(new Text("a"),new LongWritable(6));
  driver.withOutput(new Text("b"),new LongWritable(3));
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter(TokenMapperWithCounters.Counters.Y,2).withCounter("category","name",3).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,3).withCounter("category","count",2).withCounter("category","sum",3).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLongSumCombinerAndIdentityReducer() throws IOException {
  driver.withCombiner(new LongSumReducer<Text>()).withReducer(new Reducer<Text,LongWritable,Text,LongWritable>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"name\")" + " was not found in expected counters");
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withStrictCounterChecking().withCounter(TestMapDriver.MapperWithCounters.Counters.X,1).withCounter(TokenMapperWithCounters.Counters.Y,2).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,3).withCounter("category","count",2).withCounter("category","sum",3).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun() throws IOException {
  driver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<Pair<Text,LongWritable>> mapperInputs=new ArrayList<Pair<Text,LongWritable>>();
  mapperInputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_A)));
  mapperInputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_IN_B)));
  mapperInputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_IN)));
  final List<Pair<LongWritable,Text>> tokenMapperInputs=new ArrayList<Pair<LongWritable,Text>>();
  tokenMapperInputs.add(new Pair<LongWritable,Text>(new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)));
  tokenMapperInputs.add(new Pair<LongWritable,Text>(new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)));
  final List<Pair<Text,LongWritable>> outputs=new ArrayList<Pair<Text,LongWritable>>();
  outputs.add(new Pair<Text,LongWritable>(new Text("bar"),new LongWritable(BAR_OUT)));
  outputs.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(FOO_OUT)));
  driver.withAll(mapper,mapperInputs).withAll(tokenMapper,tokenMapperInputs).withAllOutput(outputs).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final MultipleInputsMapReduceDriver<Integer,IntWritable,Integer,IntWritable> testDriver=MultipleInputsMapReduceDriver.newMultipleInputMapReduceDriver(new Reducer<Integer,IntWritable,Integer,IntWritable>()).withConfiguration(conf);
  Mapper<Integer,IntWritable,Integer,IntWritable> identityMapper=new Mapper<Integer,IntWritable,Integer,IntWritable>();
  Mapper<Integer,IntWritable,Integer,IntWritable> anotherIdentityMapper=new Mapper<Integer,IntWritable,Integer,IntWritable>();
  testDriver.addMapper(identityMapper);
  testDriver.withInput(identityMapper,1,new IntWritable(2)).withInput(identityMapper,2,new IntWritable(3));
  testDriver.addMapper(anotherIdentityMapper);
  testDriver.withInput(anotherIdentityMapper,3,new IntWritable(4)).withInput(anotherIdentityMapper,4,new IntWritable(5));
  testDriver.withKeyOrderComparator(new JavaSerializationComparator<Integer>());
  testDriver.withKeyGroupingComparator(org.apache.hadoop.mrunit.TestMapReduceDriver.INTEGER_COMPARATOR);
  testDriver.withOutput(1,new IntWritable(2)).withOutput(2,new IntWritable(3)).withOutput(3,new IntWritable(4)).withOutput(4,new IntWritable(5));
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  driver.withCombiner(new Reducer<Text,LongWritable,Text,LongWritable>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  thrown.expectAssertionErrorMessage("2 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.mapreduce.TestMapDriver$MapperWithCounters$Counters\",\"X\")" + " was not found in expected counters, Actual counter ("+ "\"org.apache.hadoop.mrunit.mapreduce.TestMultipleInputsMapReduceDriver$TokenMapperWithCounters$Counters\",\"Y\")"+ " was not found in expected counters");
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withStrictCounterChecking().withCounter("category","name",3).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter(TestReduceDriver.ReducerWithCounters.Counters.COUNT,2).withCounter(TestReduceDriver.ReducerWithCounters.Counters.SUM,3).withCounter("category","count",2).withCounter("category","sum",3).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  thrown.expectMessage(IllegalStateException.class,"No input was provided for mapper");
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testComparators() throws IOException {
  driver.withReducer(new Reducer<Text,LongWritable,Text,LongWritable>(){
    @Override protected void reduce(    Text key,    Iterable<LongWritable> values,    Context context) throws IOException, InterruptedException {
      Text outKey=new Text(key);
      long outputValue=0;
      int count=0;
      for (      LongWritable value : values) {
        outputValue|=(value.get() << (count++ * 8));
      }
      context.write(outKey,new LongWritable(outputValue));
    }
  }
);
  driver.withKeyGroupingComparator(new org.apache.hadoop.mrunit.TestMapReduceDriver.FirstCharComparator());
  driver.withKeyOrderComparator(new org.apache.hadoop.mrunit.TestMapReduceDriver.SecondCharComparator());
  driver.addInput(mapper,new Text("a1"),new LongWritable(1));
  driver.addInput(mapper,new Text("b1"),new LongWritable(1));
  driver.addInput(mapper,new Text("a3"),new LongWritable(3));
  driver.addInput(mapper,new Text("a2"),new LongWritable(2));
  driver.addInput(tokenMapper,new LongWritable(1),new Text("c1 d1"));
  driver.addOutput(new Text("a1"),new LongWritable(0x1));
  driver.addOutput(new Text("b1"),new LongWritable(0x1));
  driver.addOutput(new Text("a2"),new LongWritable(0x2 | (0x3 << 8)));
  driver.addOutput(new Text("c1"),new LongWritable(0x1));
  driver.addOutput(new Text("d1"),new LongWritable(0x1));
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupComparatorBehaviorFirst() throws IOException {
  driver.withInput(mapper,new Text("A1"),new LongWritable(1L)).withInput(mapper,new Text("A2"),new LongWritable(1L)).withInput(mapper,new Text("B1"),new LongWritable(1L)).withInput(mapper,new Text("B2"),new LongWritable(1L)).withInput(mapper,new Text("C1"),new LongWritable(1L)).withInput(tokenMapper,new LongWritable(3L),new Text("D1 D2 E1")).withOutput(new Text("A2"),new LongWritable(2L)).withOutput(new Text("B2"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("D2"),new LongWritable(6L)).withOutput(new Text("E1"),new LongWritable(3L)).withKeyGroupingComparator(new org.apache.hadoop.mrunit.TestMapReduceDriver.FirstCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testIdentityCombiner() throws IOException {
  driver.withCombiner(new Reducer<Text,LongWritable,Text,LongWritable>()).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A)).withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_B)).withInput(mapper,new Text("bar"),new LongWritable(BAR_IN)).withInput(tokenMapper,new LongWritable(TOKEN_IN_A),new Text(TOKEN_A)).withInput(tokenMapper,new LongWritable(TOKEN_IN_B),new Text(TOKEN_B)).withOutput(new Text("foo"),new LongWritable(FOO_OUT)).withOutput(new Text("bar"),new LongWritable(BAR_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupComparatorBehaviorSecond() throws IOException {
  driver.withInput(mapper,new Text("1A"),new LongWritable(1L)).withInput(mapper,new Text("2A"),new LongWritable(1L)).withInput(mapper,new Text("1B"),new LongWritable(1L)).withInput(mapper,new Text("2B"),new LongWritable(1L)).withInput(mapper,new Text("1C"),new LongWritable(1L)).withInput(tokenMapper,new LongWritable(2L),new Text("1D 2D 1E")).withOutput(new Text("1A"),new LongWritable(1L)).withOutput(new Text("2A"),new LongWritable(1L)).withOutput(new Text("1B"),new LongWritable(1L)).withOutput(new Text("2B"),new LongWritable(1L)).withOutput(new Text("1C"),new LongWritable(1L)).withOutput(new Text("1D"),new LongWritable(2L)).withOutput(new Text("2D"),new LongWritable(2L)).withOutput(new Text("1E"),new LongWritable(2L)).withKeyGroupingComparator(new org.apache.hadoop.mrunit.TestMapReduceDriver.SecondCharComparator()).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGroupingComparatorSpecifiedByConf() throws IOException {
  JobConf conf=new JobConf(new Configuration());
  conf.setOutputValueGroupingComparator(TestMapReduceDriver.FirstCharComparator.class);
  driver.withInput(mapper,new Text("A1"),new LongWritable(1L)).withInput(mapper,new Text("A2"),new LongWritable(1L)).withInput(mapper,new Text("B1"),new LongWritable(1L)).withInput(mapper,new Text("B2"),new LongWritable(1L)).withInput(mapper,new Text("C1"),new LongWritable(1L)).withInput(tokenMapper,new LongWritable(3L),new Text("D1 D2 E1")).withOutput(new Text("A2"),new LongWritable(2L)).withOutput(new Text("B2"),new LongWritable(2L)).withOutput(new Text("C1"),new LongWritable(1L)).withOutput(new Text("D2"),new LongWritable(6L)).withOutput(new Text("E1"),new LongWritable(3L)).withConfiguration(conf).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCopy() throws IOException {
  final Text key=new Text("a");
  final LongWritable value=new LongWritable(1);
  driver.addInput(mapper,key,value);
  key.set("b");
  value.set(2);
  driver.addInput(mapper,key,value);
  key.set("a");
  value.set(1);
  driver.addOutput(key,value);
  key.set("b");
  value.set(2);
  driver.addOutput(key,value);
  final LongWritable longKey=new LongWritable(3);
  final Text textValue=new Text("c d");
  driver.addInput(tokenMapper,longKey,textValue);
  longKey.set(4);
  textValue.set("e f g");
  driver.addInput(tokenMapper,longKey,textValue);
  key.set("c");
  value.set(3);
  driver.addOutput(key,value);
  key.set("d");
  value.set(3);
  driver.addOutput(key,value);
  key.set("e");
  value.set(4);
  driver.addOutput(key,value);
  key.set("f");
  value.set(4);
  driver.addOutput(key,value);
  key.set("g");
  value.set(4);
  driver.addOutput(key,value);
  driver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings("unchecked") @Test public void testUseOfWritableRegisteredComparator() throws IOException {
  MultipleInputsMapReduceDriver<TestWritable,Text,TestWritable,Text> testDriver=new MultipleInputsMapReduceDriver<TestWritable,Text,TestWritable,Text>(new Reducer<TestWritable,Text,TestWritable,Text>());
  Mapper<TestWritable,Text,TestWritable,Text> identityMapper=new Mapper<TestWritable,Text,TestWritable,Text>();
  Mapper<TestWritable,Text,TestWritable,Text> anotherIdentityMapper=new Mapper<TestWritable,Text,TestWritable,Text>();
  testDriver.addMapper(identityMapper);
  testDriver.addMapper(anotherIdentityMapper);
  testDriver.withInput(identityMapper,new TestWritable("A1"),new Text("A1")).withInput(identityMapper,new TestWritable("A2"),new Text("A2")).withInput(identityMapper,new TestWritable("A3"),new Text("A3")).withInput(anotherIdentityMapper,new TestWritable("B1"),new Text("B1")).withInput(anotherIdentityMapper,new TestWritable("B2"),new Text("B2")).withKeyGroupingComparator(new TestWritable.SingleGroupComparator()).withOutput(new TestWritable("B2"),new Text("B2")).withOutput(new TestWritable("B1"),new Text("B1")).withOutput(new TestWritable("A3"),new Text("A3")).withOutput(new TestWritable("A2"),new Text("A2")).withOutput(new TestWritable("A1"),new Text("A1")).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable> testDriver=new MultipleInputsMapReduceDriver<Text,LongWritable,Text,LongWritable>();
  testDriver.addMapper(mapper);
  testDriver.withInput(mapper,new Text("foo"),new LongWritable(FOO_IN_A));
  thrown.expectMessage(IllegalStateException.class,"No reducer class was provided");
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  MultipleInputsMapReduceDriver<Text,Text,Text,Text> testDriver=new MultipleInputsMapReduceDriver<Text,Text,Text,Text>();
  thrown.expectAssertionErrorMessage("3 Error(s): (" + "Counter org.apache.hadoop.mrunit.mapreduce.TestMapDriver.MapperWithCounters.Counters.X has value 1 instead of expected 20, " + "Counter org.apache.hadoop.mrunit.mapreduce.TestMultipleInputsMapReduceDriver.TokenMapperWithCounters.Counters.Y has value 2 instead of expected 30, "+ "Counter with category category and name name has value 3 instead of expected 20)");
  Mapper<Text,Text,Text,Text> mapperWithCounters=new TestMapDriver.MapperWithCounters<Text,Text,Text,Text>();
  Mapper<Text,Text,Text,Text> tokenMapperWithCounters=new TokenMapperWithCounters();
  testDriver.withMapper(mapperWithCounters).withInput(mapperWithCounters,new Text("hie"),new Text("Hi")).withMapper(tokenMapperWithCounters).withInput(tokenMapperWithCounters,new Text("bie"),new Text("Goodbye Bye")).withCounter(TestMapDriver.MapperWithCounters.Counters.X,20).withCounter(TokenMapperWithCounters.Counters.Y,30).withReducer(new TestReduceDriver.ReducerWithCounters<Text,Text,Text,Text>()).withCounter("category","name",20).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  final MultipleInputsMapReduceDriver testDriver=this.driver;
  testDriver.withInputFormat(TextInputFormat.class);
  testDriver.withOutputFormat(TextOutputFormat.class);
  testDriver.withInput(mapper,new Text("a"),new LongWritable(1));
  testDriver.withInput(mapper,new Text("a"),new LongWritable(2));
  testDriver.withInput(tokenMapper,new LongWritable(3),new Text("a b"));
  testDriver.withOutput(new LongWritable(0),new Text("a\t6"));
  testDriver.withOutput(new LongWritable(4),new Text("b\t3"));
  testDriver.runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  MultipleInputsMapReduceDriver<Text,Object,Text,Object> testDriver=MultipleInputsMapReduceDriver.newMultipleInputMapReduceDriver(new Reducer<Text,Object,Text,Object>());
  Mapper<Text,Object,Text,Object> identity=new Mapper<Text,Object,Text,Object>();
  testDriver.addMapper(identity);
  Text k1=new Text("foo");
  Object v1=new UncomparableWritable(1);
  testDriver.withInput(identity,k1,v1);
  ReverseMapper<Object,Text> reverse=new ReverseMapper<Object,Text>();
  testDriver.addMapper(reverse);
  Text k2=new Text("bar");
  Object v2=new UncomparableWritable(2);
  testDriver.withInput(reverse,v2,k2);
  testDriver.withOutput(k1,v1).withOutput(k2,v2);
  testDriver.runTest(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestMultipleOutput </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriverWithPathOutput() throws IOException {
  mapDriver=MapDriver.newMapDriver(new PathOutputMapper("path1","path2"));
  mapDriver.withInput(new LongWritable(0),new Text("first")).withInput(new LongWritable(0),new Text("second")).withInput(new LongWritable(0),new Text("third")).withOutput(new Text("first"),new IntWritable(1)).withOutput(new Text("second"),new IntWritable(1)).withOutput(new Text("third"),new IntWritable(1)).withPathOutput(new Text("first"),new IntWritable(1),"path1").withPathOutput(new Text("second"),new IntWritable(1),"path1").withPathOutput(new Text("third"),new IntWritable(1),"path1").withPathOutput(new Text("first"),new IntWritable(1),"path2").withPathOutput(new Text("second"),new IntWritable(1),"path2").withPathOutput(new Text("third"),new IntWritable(1),"path2").runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestReduceDriverWithPathOutput() throws IOException {
  reduceDriver=ReduceDriver.newReduceDriver(new PathOutputReducer("path"));
  List<IntWritable> inputs=new ArrayList<IntWritable>();
  inputs.add(new IntWritable(1));
  inputs.add(new IntWritable(2));
  reduceDriver.withInput(new Text("abc"),inputs).withOutput(new Text("hello"),new IntWritable(1)).withPathOutput(new Text("key"),new IntWritable(2),"path").runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriverMissingExpectedOutput() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected outputs for namedOutput 'mo2'");
  thrown.expectAssertionErrorMessage("Missing expected output ((null), message in multiOutput) for namedOutput 'mo2'");
  mapDriver=MapDriver.newMapDriver(new NullKeyMap());
  mapDriver.withInput(new LongWritable(0),new Text("this")).withOutput(new Text("this"),new IntWritable(1)).withMultiOutput("mo",NullWritable.get(),new Text("message in multiOutput")).withMultiOutput("mo",NullWritable.get(),new Text("second message same key")).withMultiOutput("mo2",NullWritable.get(),new Text("message in multiOutput")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestReduceDriver() throws IOException {
  reduceDriver=ReduceDriver.newReduceDriver(new MyReduce());
  List<IntWritable> inputs=new ArrayList<IntWritable>();
  inputs.add(new IntWritable(1));
  inputs.add(new IntWritable(2));
  reduceDriver.withInput(new Text("abc"),inputs).withOutput(new Text("hello"),new IntWritable(1)).withMultiOutput("test",new Text("key"),new IntWritable(2)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestObjectReuese() throws IOException {
  mapDriver=MapDriver.newMapDriver(new ValueReuseMapper());
  mapDriver.withInput(new LongWritable(0),new Text("first")).withInput(new LongWritable(1),new Text("second")).withInput(new LongWritable(2),new Text("third")).withMultiOutput("test",new Text("first"),new IntWritable(2)).withMultiOutput("test",new Text("second"),new IntWritable(3)).withMultiOutput("test",new Text("third"),new IntWritable(4)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriverUnexpectOutputValue() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s)");
  thrown.expectAssertionErrorMessage("Received unexpected output ((null), second message same key) for namedOutput 'mo' at position 1");
  mapDriver=MapDriver.newMapDriver(new NullKeyMap());
  mapDriver.withInput(new LongWritable(0),new Text("this")).withOutput(new Text("this"),new IntWritable(1)).withMultiOutput("mo",NullWritable.get(),new Text("message in multiOutput")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriverUnexpectOutput() throws IOException {
  thrown.expectAssertionErrorMessage("3 Error(s)");
  thrown.expectMessage("Expected no multiple outputs");
  thrown.expectAssertionErrorMessage("Received unexpected output ((null), message in multiOutput) for unexpected namedOutput 'mo'");
  thrown.expectAssertionErrorMessage("Received unexpected output ((null), second message same key) for unexpected namedOutput 'mo'");
  mapDriver=MapDriver.newMapDriver(new NullKeyMap());
  mapDriver.withInput(new LongWritable(0),new Text("this")).withOutput(new Text("this"),new IntWritable(1)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriverNullKey() throws IOException {
  mapDriver=MapDriver.newMapDriver(new NullKeyMap());
  mapDriver.withInput(new LongWritable(0),new Text("this")).withOutput(new Text("this"),new IntWritable(1)).withMultiOutput("mo",NullWritable.get(),new Text("message in multiOutput")).withMultiOutput("mo",NullWritable.get(),new Text("second message same key")).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriver() throws IOException {
  mapDriver=MapDriver.newMapDriver(new MyMap());
  mapDriver.withInput(new LongWritable(0),new Text("this has 4 words")).withInput(new LongWritable(0),new Text("name1-first named output")).withInput(new LongWritable(0),new Text("name1- still first named output")).withInput(new LongWritable(0),new Text("name2- second")).withOutput(new Text("this"),new IntWritable(1)).withOutput(new Text("has"),new IntWritable(1)).withOutput(new Text("4"),new IntWritable(1)).withOutput(new Text("words"),new IntWritable(1)).withMultiOutput("name1",new Text("first named output"),new IntWritable(3)).withMultiOutput("name1",new Text("still first named output"),new IntWritable(4)).withMultiOutput("name2",new Text("second"),new IntWritable(1)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void screwYou(){
  thrown.expect(java.lang.NullPointerException.class);
  throw new NullPointerException();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestReduceDriver </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoReducer() throws IOException {
  driver=ReduceDriver.newReduceDriver();
  thrown.expectMessage(IllegalStateException.class,"No Reducer class was provided");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 12) at position 0, got (foo, 10).)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(INCORRECT_OUT)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUncomparable() throws IOException {
  Object k=new UncomparableWritable(1);
  Object v=new UncomparableWritable(2);
  ReduceDriver.newReduceDriver(new Reducer<Object,Object,Object,Object>()).withInput(k,Lists.newArrayList(v)).withOutput(k,v).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10) at position 0, got (foo, 10).)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOutputFormat() throws IOException {
  driver.withOutputFormat(SequenceFileOutputFormat.class,SequenceFileInputFormat.class);
  driver.withInputKey(new Text("a"));
  driver.withInputValue(new LongWritable(1)).withInputValue(new LongWritable(2));
  driver.withOutput(new Text("a"),new LongWritable(3));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRepeatRun() throws IOException {
  final List<LongWritable> vals=new ArrayList<LongWritable>();
  vals.add(new LongWritable(IN_A));
  vals.add(new LongWritable(IN_B));
  final List<Pair<Text,List<LongWritable>>> inputs=new ArrayList<Pair<Text,List<LongWritable>>>();
  inputs.add(new Pair<Text,List<LongWritable>>(new Text("foo"),vals));
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  driver.withAll(inputs).withAllOutput(expected).runTest();
  thrown.expectMessage(IllegalStateException.class,"Driver reuse not allowed");
  driver.withAll(inputs).withAllOutput(expected).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun1() throws IOException {
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void textMockContext() throws IOException, InterruptedException {
  thrown.expectMessage(RuntimeException.class,"Injected!");
  Reducer<Text,LongWritable,Text,LongWritable>.Context context=driver.getContext();
  doThrow(new RuntimeException("Injected!")).when(context).write(any(Text.class),any(LongWritable.class));
  driver.withInputKey(new Text("a"));
  driver.withInputValue(new LongWritable(1)).withInputValue(new LongWritable(2));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testJavaSerialization() throws IOException {
  final Configuration conf=new Configuration();
  conf.setStrings("io.serializations",conf.get("io.serializations"),"org.apache.hadoop.io.serializer.JavaSerialization");
  final ReduceDriver<Integer,IntWritable,Integer,IntWritable> driver=ReduceDriver.newReduceDriver(new IntSumReducer<Integer>()).withConfiguration(conf);
  driver.withInputKey(1).withInputValue(new IntWritable(2)).withOutput(1,new IntWritable(2)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoubleIteration() throws IOException {
  reducer=new DoubleIterReducer<Text,LongWritable>();
  driver=ReduceDriver.newReduceDriver(reducer);
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(1)).withInputValue(new LongWritable(1)).withInputValue(new LongWritable(1)).withInputValue(new LongWritable(1)).withOutput(new Text("foo"),new LongWritable(4)).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoInput() throws IOException {
  driver=ReduceDriver.newReduceDriver();
  thrown.expectMessage(IllegalStateException.class,"No input was provided");
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithFailedCounter() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  thrown.expectAssertionErrorMessage("2 Error(s): (" + "Counter org.apache.hadoop.mrunit.mapreduce.TestReduceDriver.ReducerWithCounters.Counters.SUM has value 1 instead of expected 4, " + "Counter with category category and name sum has value 1 instead of expected 4)");
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInputKey(new Text("hie")).withInputValue(new Text("")).withCounter(ReducerWithCounters.Counters.SUM,4).withCounter("category","sum",4).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun8() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10) at position 1.)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAll() throws IOException {
  final List<LongWritable> vals=new ArrayList<LongWritable>();
  vals.add(new LongWritable(IN_A));
  vals.add(new LongWritable(IN_B));
  final List<Pair<Text,List<LongWritable>>> inputs=new ArrayList<Pair<Text,List<LongWritable>>>();
  inputs.add(new Pair<Text,List<LongWritable>>(new Text("foo"),vals));
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  driver.withAll(inputs).withAllOutput(expected).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (bar, 10)" + " at position 0, got (foo, 10)., Missing expected output (foo, 10) at position 1.)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 4) at position 0, got (foo, 10).");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 6) at position 1.");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).withOutput(new Text("foo"),new LongWritable(IN_B)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 10) at position 1.)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun2OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (bar, 10), " + "Received unexpected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndStringCounterMissing() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  ReduceFeeder<Text,Text> reduceFeeder=new ReduceFeeder<Text,Text>(driver.getConfiguration());
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"category\",\"count\")" + " was not found in expected counters");
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(reduceFeeder.updateInput(new Text("hie"),values)).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.COUNT,1).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddAllElements() throws IOException {
  final List<Pair<Text,LongWritable>> input=new ArrayList<Pair<Text,LongWritable>>();
  input.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(IN_A)));
  input.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(IN_B)));
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  driver.withAllElements(reduceFeeder.sortAndGroup(input)).withAllOutput(expected).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 4) at position 0, got (foo, 10).)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun5OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("3 Error(s)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 6)");
  thrown.expectAssertionErrorMessage("Missing expected output (foo, 4)");
  thrown.expectAssertionErrorMessage("Received unexpected output (foo, 10)");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).withOutput(new Text("foo"),new LongWritable(IN_B)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithTaskAttemptUse() throws IOException {
  final ReduceDriver<Text,NullWritable,Text,NullWritable> driver=ReduceDriver.newReduceDriver(new TaskAttemptReducer());
  ReduceFeeder<Text,NullWritable> reduceFeeder=new ReduceFeeder<Text,NullWritable>(driver.getConfiguration());
  driver.withInput(reduceFeeder.updateInput(new Text("anything"),Arrays.asList(NullWritable.get()))).withOutput(new Text("attempt__0000_r_000000_0"),NullWritable.get()).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun4OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (foo, 4), " + "Received unexpected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(IN_A)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun3OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("2 Error(s): (Missing expected output (foo, 12), " + "Received unexpected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(INCORRECT_OUT)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun8OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked","rawtypes"}) @Test public void testOutputFormatWithMismatchInOutputClasses() throws IOException {
  final ReduceDriver driver=ReduceDriver.newReduceDriver(reducer);
  driver.withOutputFormat(TextOutputFormat.class,TextInputFormat.class);
  driver.withInputKey(new Text("a"));
  driver.withInputValue(new LongWritable(1)).withInputValue(new LongWritable(2));
  driver.withOutput(new LongWritable(),new Text("a\t3"));
  driver.runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun6OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (foo, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTestRun7OrderInsensitive() throws IOException {
  thrown.expectAssertionErrorMessage("1 Error(s): (Missing expected output (bar, 10))");
  driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).withOutput(new Text("bar"),new LongWritable(OUT_VAL)).withOutput(new Text("foo"),new LongWritable(OUT_VAL)).runTest(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndEnumCounterMissing() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  ReduceFeeder<Text,Text> reduceFeeder=new ReduceFeeder<Text,Text>(driver.getConfiguration());
  thrown.expectAssertionErrorMessage("1 Error(s): (Actual counter (" + "\"org.apache.hadoop.mrunit.mapreduce.TestReduceDriver$ReducerWithCounters$Counters\",\"COUNT\")" + " was not found in expected counters");
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(reduceFeeder.updateInput(new Text("hie"),values)).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",1).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRun() throws IOException {
  final List<Pair<Text,LongWritable>> out=driver.withInputKey(new Text("foo")).withInputValue(new LongWritable(IN_A)).withInputValue(new LongWritable(IN_B)).run();
  final List<Pair<Text,LongWritable>> expected=new ArrayList<Pair<Text,LongWritable>>();
  expected.add(new Pair<Text,LongWritable>(new Text("foo"),new LongWritable(OUT_VAL)));
  assertListEquals(out,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounter() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  ReduceFeeder<Text,Text> reduceFeeder=new ReduceFeeder<Text,Text>(driver.getConfiguration());
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(reduceFeeder.updateInput(new Text("hie"),values)).withCounter(ReducerWithCounters.Counters.COUNT,1).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",1).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithCounterAndNoneMissing() throws IOException {
  final ReduceDriver<Text,Text,Text,Text> driver=ReduceDriver.newReduceDriver();
  ReduceFeeder<Text,Text> reduceFeeder=new ReduceFeeder<Text,Text>(driver.getConfiguration());
  final LinkedList<Text> values=new LinkedList<Text>();
  values.add(new Text("a"));
  values.add(new Text("b"));
  driver.withReducer(new ReducerWithCounters<Text,Text,Text,Text>()).withInput(reduceFeeder.updateInput(new Text("hie"),values)).withStrictCounterChecking().withCounter(ReducerWithCounters.Counters.COUNT,1).withCounter(ReducerWithCounters.Counters.SUM,2).withCounter("category","count",1).withCounter("category","sum",2).runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestReduceFeeder </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortAndGroupWithOneComparator(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a1"),new Text("v1")));
  inputs.add(new Pair<Text,Text>(new Text("a2"),new Text("v2")));
  inputs.add(new Pair<Text,Text>(new Text("c1"),new Text("v3")));
  inputs.add(new Pair<Text,Text>(new Text("a2"),new Text("v4")));
  final List<KeyValueReuseList<Text,Text>> outputs=feeder.sortAndGroup(inputs,secondCharComparator);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist1=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist1.add(new Pair<Text,Text>(new Text("a1"),new Text("v1")));
  sublist1.add(new Pair<Text,Text>(new Text("c1"),new Text("v3")));
  expected.add(sublist1);
  final KeyValueReuseList<Text,Text> sublist2=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist2.add(new Pair<Text,Text>(new Text("a2"),new Text("v2")));
  sublist2.add(new Pair<Text,Text>(new Text("a2"),new Text("v4")));
  expected.add(sublist2);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortAndGroupWithTwoComparators(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a1"),new Text("v1")));
  inputs.add(new Pair<Text,Text>(new Text("a2"),new Text("v5")));
  inputs.add(new Pair<Text,Text>(new Text("c1"),new Text("v3")));
  inputs.add(new Pair<Text,Text>(new Text("a2"),new Text("v2")));
  inputs.add(new Pair<Text,Text>(new Text("a3"),new Text("v4")));
  final List<KeyValueReuseList<Text,Text>> outputs=feeder.sortAndGroup(inputs,secondCharComparator,firstCharComparator);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist1=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist1.add(new Pair<Text,Text>(new Text("a1"),new Text("v1")));
  expected.add(sublist1);
  final KeyValueReuseList<Text,Text> sublist2=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist2.add(new Pair<Text,Text>(new Text("c1"),new Text("v3")));
  expected.add(sublist2);
  final KeyValueReuseList<Text,Text> sublist3=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist3.add(new Pair<Text,Text>(new Text("a2"),new Text("v5")));
  sublist3.add(new Pair<Text,Text>(new Text("a2"),new Text("v2")));
  sublist3.add(new Pair<Text,Text>(new Text("a3"),new Text("v4")));
  expected.add(sublist3);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiSortAndGroup1(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("v")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  final List<KeyValueReuseList<Text,Text>> outputs=feeder.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist1=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  expected.add(sublist1);
  final KeyValueReuseList<Text,Text> sublist2=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("v")));
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  expected.add(sublist2);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiSortAndGroup2(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("v")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  inputs.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  final List<KeyValueReuseList<Text,Text>> outputs=feeder.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist1=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("x")));
  sublist1.add(new Pair<Text,Text>(new Text("a"),new Text("y")));
  expected.add(sublist1);
  final KeyValueReuseList<Text,Text> sublist2=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("v")));
  sublist2.add(new Pair<Text,Text>(new Text("b"),new Text("w")));
  expected.add(sublist2);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateAll(){
  List<Text> values=new ArrayList<Text>();
  values.add(new Text("v1"));
  values.add(new Text("v2"));
  values.add(new Text("v3"));
  Text key=new Text("k");
  List<Pair<Text,List<Text>>> oldInputs=new ArrayList<Pair<Text,List<Text>>>();
  oldInputs.add(new Pair(key,values));
  List<KeyValueReuseList<Text,Text>> updated=feeder.updateAll(oldInputs);
  KeyValueReuseList<Text,Text> kvList=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  for (  Text value : values) {
    kvList.add(new Pair(key,value));
  }
  List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  expected.add(kvList);
  assertListEquals(expected,updated);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSingleSortAndGroup(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  final List<KeyValueReuseList<Text,Text>> outputs=feeder.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  expected.add(sublist);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSortAndGroupOneKey(){
  final List<Pair<Text,Text>> inputs=new ArrayList<Pair<Text,Text>>();
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  inputs.add(new Pair<Text,Text>(new Text("a"),new Text("c")));
  final List<KeyValueReuseList<Text,Text>> outputs=feeder.sortAndGroup(inputs);
  final List<KeyValueReuseList<Text,Text>> expected=new ArrayList<KeyValueReuseList<Text,Text>>();
  final KeyValueReuseList<Text,Text> sublist=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  sublist.add(new Pair<Text,Text>(new Text("a"),new Text("b")));
  sublist.add(new Pair<Text,Text>(new Text("a"),new Text("c")));
  expected.add(sublist);
  assertListEquals(expected,outputs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUpdateInput(){
  List<Text> values=new ArrayList<Text>();
  values.add(new Text("v1"));
  values.add(new Text("v2"));
  values.add(new Text("v3"));
  Text key=new Text("k");
  Pair<Text,List<Text>> oldInput=new Pair(key,values);
  KeyValueReuseList<Text,Text> updated=feeder.updateInput(oldInput);
  KeyValueReuseList<Text,Text> expected=new KeyValueReuseList<Text,Text>(new Text(),new Text(),driver.getConfiguration());
  for (  Text value : values) {
    expected.add(new Pair(key,value));
  }
  assertListEquals(expected,updated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestStatefulMapReduce </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testClosedFormMapReduce() throws IOException {
  MapReduceDriver<LongWritable,Text,Text,IntWritable,Text,IntWritable> mapReduceDriver=MapReduceDriver.newMapReduceDriver(new StatefulMapper(),new Reducer());
  mapReduceDriver.addInput(new LongWritable(1L),new Text("hello"));
  mapReduceDriver.addInput(new LongWritable(2L),new Text("schmo"));
  mapReduceDriver.withOutput(new Text("SomeKey"),new IntWritable(2));
  mapReduceDriver.runTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.mapreduce.TestWordCount </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestRun() throws IOException {
  final List<Pair<LongWritable,Text>> inputs=new ArrayList<Pair<LongWritable,Text>>();
  inputs.add(new Pair<LongWritable,Text>(new LongWritable(21),new Text(FILE01)));
  inputs.add(new Pair<LongWritable,Text>(new LongWritable(48),new Text(FILE02)));
  driver.withAll(inputs).withAllOutput(expectedOutput).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestMapDriver() throws IOException {
  final List<Pair<LongWritable,Text>> inputs=new ArrayList<Pair<LongWritable,Text>>();
  inputs.add(new Pair<LongWritable,Text>(new LongWritable(21),new Text(FILE01)));
  inputs.add(new Pair<LongWritable,Text>(new LongWritable(48),new Text(FILE02)));
  final List<Pair<Text,IntWritable>> outputs=new ArrayList<Pair<Text,IntWritable>>();
  outputs.add(new Pair<Text,IntWritable>(new Text("Hello"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("World"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("Bye"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("World"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("Hello"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("Hadoop"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("Goodbye"),new IntWritable(ONE)));
  outputs.add(new Pair<Text,IntWritable>(new Text("Hadoop"),new IntWritable(ONE)));
  mapDriver.withAll(inputs).withAllOutput(outputs).runTest(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void TestReduceDriver() throws IOException {
  final List<IntWritable> input1=new ArrayList<IntWritable>();
  input1.add(new IntWritable(ONE));
  final List<IntWritable> input2=new ArrayList<IntWritable>();
  input2.add(new IntWritable(ONE));
  input2.add(new IntWritable(ONE));
  final List<Pair<Text,List<IntWritable>>> inputs=new ArrayList<Pair<Text,List<IntWritable>>>();
  inputs.add(new Pair<Text,List<IntWritable>>(new Text("Bye"),input1));
  inputs.add(new Pair<Text,List<IntWritable>>(new Text("Goodbye"),input1));
  inputs.add(new Pair<Text,List<IntWritable>>(new Text("Hadoop"),input2));
  inputs.add(new Pair<Text,List<IntWritable>>(new Text("Hello"),input2));
  inputs.add(new Pair<Text,List<IntWritable>>(new Text("World"),input2));
  reduceDriver.withAll(inputs).withAllOutput(expectedOutput).runTest(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.mrunit.types.TestPair </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullIntSecond2(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(null,Integer.valueOf(VAL_A)).compareTo(new Pair<Integer,Integer>(null,null));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullIntFirst1(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(null,null).compareTo(new Pair<Integer,Integer>(Integer.valueOf(VAL_A),null));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullIntFirst0(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(Integer.valueOf(VAL_A),null).compareTo(new Pair<Integer,Integer>(Integer.valueOf(VAL_A),null));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullIntSecond0(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(null,Integer.valueOf(VAL_A)).compareTo(new Pair<Integer,Integer>(null,Integer.valueOf(VAL_A)));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullIntSecond1(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(null,null).compareTo(new Pair<Integer,Integer>(null,Integer.valueOf(VAL_A)));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullIntFirst2(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(Integer.valueOf(VAL_A),null).compareTo(new Pair<Integer,Integer>(null,null));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCompareToNullNull(){
  thrown.expect(NullPointerException.class);
  new Pair<Integer,Integer>(null,null).compareTo(new Pair<Integer,Integer>(null,null));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
