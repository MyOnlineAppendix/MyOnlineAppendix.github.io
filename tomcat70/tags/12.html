<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.catalina.comet.TestCometProcessor </h4><pre class="type-4 type-10 type-12 type-3 type-11 type-13 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionClose() throws Exception {
  Assume.assumeTrue("This test is skipped, because this connector does not support Comet.",isCometSupported());
  Tomcat tomcat=getTomcatInstance();
  Context root=tomcat.addContext("",null);
  Tomcat.addServlet(root,"comet",new ConnectionCloseServlet());
  root.addServletMapping("/comet","comet");
  Tomcat.addServlet(root,"hello",new HelloWorldServlet());
  root.addServletMapping("/hello","hello");
  tomcat.getConnector().setProperty("connectionTimeout","5000");
  tomcat.start();
  final Socket socket=SocketFactory.getDefault().createSocket("localhost",getPort());
  socket.setSoTimeout(5000);
  final OutputStream os=socket.getOutputStream();
  String requestLine="POST http://localhost:" + getPort() + "/comet HTTP/1.1\r\n";
  os.write(requestLine.getBytes());
  os.write("transfer-encoding: chunked\r\n".getBytes());
  os.write("\r\n".getBytes());
  os.write("0\r\n\r\n".getBytes());
  InputStream is=socket.getInputStream();
  ResponseReaderThread readThread=new ResponseReaderThread(is);
  readThread.start();
  int count=0;
  while (count < 10 && !readThread.getResponse().endsWith("OK")) {
    Thread.sleep(500);
    count++;
  }
  if (count == 10) {
    fail("Comet request did not complete");
  }
  Assert.assertFalse(readThread.isAlive());
  Assert.assertNull(readThread.getException());
  os.close();
  is.close();
}

</code></pre>

<br>
<pre class="type-4 type-10 type-12 type-3 type-11 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyncClose() throws Exception {
  Assume.assumeTrue("This test is skipped, because this connector does not support Comet.",isCometSupported());
  Tomcat tomcat=getTomcatInstance();
  Context root=tomcat.addContext("",null);
  Tomcat.addServlet(root,"comet",new CometCloseServlet());
  root.addServletMapping("/comet","comet");
  Tomcat.addServlet(root,"hello",new HelloWorldServlet());
  root.addServletMapping("/hello","hello");
  tomcat.getConnector().setProperty("connectionTimeout","5000");
  tomcat.start();
  final Socket socket=SocketFactory.getDefault().createSocket("localhost",getPort());
  socket.setSoTimeout(5000);
  final OutputStream os=socket.getOutputStream();
  String requestLine="POST http://localhost:" + getPort() + "/comet HTTP/1.1\r\n";
  os.write(requestLine.getBytes());
  os.write("transfer-encoding: chunked\r\n".getBytes());
  os.write("\r\n".getBytes());
  os.write("0\r\n\r\n".getBytes());
  InputStream is=socket.getInputStream();
  ResponseReaderThread readThread=new ResponseReaderThread(is);
  readThread.start();
  int count=0;
  while (count < 10 && !readThread.getResponse().endsWith("0\r\n\r\n")) {
    Thread.sleep(500);
    count++;
  }
  Assert.assertTrue(readThread.getResponse().contains("2\r\nOK"));
  if (count == 10) {
    fail("Comet request did not complete");
  }
  requestLine="GET http://localhost:" + getPort() + "/hello HTTP/1.1\r\n";
  os.write(requestLine.getBytes());
  os.write("connection: close\r\n".getBytes());
  os.write("\r\n".getBytes());
  count=0;
  while (count < 10 && !readThread.getResponse().contains(HelloWorldServlet.RESPONSE_TEXT)) {
    Thread.sleep(500);
    count++;
  }
  if (count == 10) {
    fail("Non-comet request did not complete");
  }
  readThread.join();
  os.close();
  is.close();
}

</code></pre>

<br>
<pre class="type-10 type-12 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAsyncClose() throws Exception {
  Assume.assumeTrue("This test is skipped, because this connector does not support Comet.",isCometSupported());
  Tomcat tomcat=getTomcatInstance();
  Context root=tomcat.addContext("",null);
  Tomcat.addServlet(root,"comet",new SimpleCometServlet());
  root.addServletMapping("/comet","comet");
  Tomcat.addServlet(root,"hello",new HelloWorldServlet());
  root.addServletMapping("/hello","hello");
  root.getPipeline().addValve(new AsyncCometCloseValve());
  tomcat.getConnector().setProperty("connectionTimeout","5000");
  tomcat.start();
  final Socket socket=SocketFactory.getDefault().createSocket("localhost",getPort());
  socket.setSoTimeout(5000);
  final OutputStream os=socket.getOutputStream();
  String requestLine="POST http://localhost:" + getPort() + "/comet HTTP/1.1\r\n";
  os.write(requestLine.getBytes());
  os.write("transfer-encoding: chunked\r\n".getBytes());
  os.write("\r\n".getBytes());
  InputStream is=socket.getInputStream();
  ResponseReaderThread readThread=new ResponseReaderThread(is);
  readThread.start();
  int count=0;
  while (count < 10 && !readThread.getResponse().endsWith("0\r\n\r\n")) {
    Thread.sleep(500);
    count++;
  }
  if (count == 10) {
    fail("Comet request did not complete");
  }
  requestLine="GET http://localhost:" + getPort() + "/hello HTTP/1.1\r\n";
  os.write(requestLine.getBytes());
  os.write("\r\n".getBytes());
  count=0;
  while (count < 10 && !readThread.getResponse().contains(HelloWorldServlet.RESPONSE_TEXT)) {
    Thread.sleep(500);
    count++;
  }
  if (count == 10) {
    fail("Non-comet request did not complete");
  }
  readThread.join();
  os.close();
  is.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.connector.TestCoyoteAdapter </h4><pre class="type-10 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPathParamsRedirect() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  File docBase=new File(getTemporaryDirectory(),"testCoyoteAdapter");
  addDeleteOnTearDown(docBase);
  if (!docBase.mkdirs() && !docBase.isDirectory()) {
    Assert.fail("Failed to create: [" + docBase.toString() + "]");
  }
  File foo=new File(docBase,"foo");
  addDeleteOnTearDown(foo);
  if (!foo.mkdirs() && !foo.isDirectory()) {
    Assert.fail("Unable to create foo directory in docBase");
  }
  Context ctx=tomcat.addContext("",docBase.getAbsolutePath());
  Tomcat.addServlet(ctx,"servlet",new PathParamServlet());
  ctx.addServletMapping("/","servlet");
  tomcat.start();
  testPath("/","none");
  testPath("/;jsessionid=1234","1234");
  testPath("/foo;jsessionid=1234","1234");
  testPath("/foo;jsessionid=1234;dummy","1234");
  testPath("/foo;jsessionid=1234;dummy=5678","1234");
  testPath("/foo;jsessionid=1234;=5678","1234");
  testPath("/foo;jsessionid=1234/bar","1234");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.connector.TestMapperListener </h4><pre class="type-8 type-4 type-10 type-12 type-3 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTomcatRestartListenerCount_Bug56717() throws IOException, LifecycleException {
  Tomcat tomcat=getTomcatInstance();
  File appDir=new File(getBuildDirectory(),"webapps/examples");
  tomcat.addWebapp(null,"/examples",appDir.getAbsolutePath());
  tomcat.start();
  ByteChunk res;
  String text;
  res=getUrl("http://localhost:" + getPort() + "/examples/servlets/servlet/HelloWorldExample");
  text=res.toString();
  Assert.assertTrue(text,text.contains("<h1>Hello World!</h1>"));
  List<ListenersInfo> listenersFirst=new ArrayList<ListenersInfo>();
  populateListenersInfo(listenersFirst,tomcat.getEngine());
  tomcat.stop();
  tomcat.start();
  res=getUrl("http://localhost:" + getPort() + "/examples/servlets/servlet/HelloWorldExample");
  text=res.toString();
  Assert.assertTrue(text,text.contains("<h1>Hello World!</h1>"));
  List<ListenersInfo> listenersSecond=new ArrayList<ListenersInfo>();
  populateListenersInfo(listenersSecond,tomcat.getEngine());
  Assert.assertEquals(listenersFirst.size(),listenersSecond.size());
  for (int i=0, len=listenersFirst.size(); i < len; i++) {
    ListenersInfo a=listenersFirst.get(i);
    ListenersInfo b=listenersSecond.get(i);
    boolean equal=a.container.getClass() == b.container.getClass() && a.containerListeners.length == b.containerListeners.length && a.lifecycleListeners.length == b.lifecycleListeners.length;
    if (!equal) {
      Assert.fail("The lists of listeners differ:\n" + a + "\n"+ b);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.connector.TestResponse </h4><pre class="type-4 type-10 type-12 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug49598() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  Context ctx=tomcat.addContext("",null);
  Tomcat.addServlet(ctx,"servlet",new Bug49598Servlet());
  ctx.addServletMapping("/","servlet");
  tomcat.start();
  Map<String,List<String>> headers=new HashMap<String,List<String>>();
  getUrl("http://localhost:" + getPort() + "/",new ByteChunk(),headers);
  for (  Map.Entry<String,List<String>> header : headers.entrySet()) {
    if (header.getKey() == null) {
      List<String> values=header.getValue();
      if (values.size() == 1 && values.get(0).startsWith("HTTP/1.1")) {
        continue;
      }
      fail("Null header name detected for value " + values);
    }
  }
  int count=0;
  for (  String headerName : headers.keySet()) {
    if ("Set-Cookie".equals(headerName)) {
      count++;
    }
  }
  assertEquals(1,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.core.TestApplicationContext </h4><pre class="type-10 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBug53257() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  File appDir=new File("test/webapp-3.0");
  tomcat.addWebapp(null,"/test",appDir.getAbsolutePath());
  tomcat.start();
  ByteChunk res=getUrl("http://localhost:" + getPort() + "/test/bug53257/index.jsp");
  String result=res.toString();
  String[] lines=result.split("\n");
  for (  String line : lines) {
    if (line.startsWith("FAIL")) {
      Assert.fail(line);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.core.TestStandardContext </h4><pre class="type-10 type-12 type-3 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug46243() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  File docBase=new File(tomcat.getHost().getAppBase(),"ROOT");
  if (!docBase.mkdirs() && !docBase.isDirectory()) {
    fail("Unable to create docBase");
  }
  Context root=tomcat.addContext("","ROOT");
  configureTest46243Context(root,true);
  tomcat.start();
  Bug46243Client client=new Bug46243Client(tomcat.getConnector().getLocalPort());
  client.setRequest(new String[]{REQUEST});
  client.connect();
  client.processRequest();
  assertTrue(client.isResponse404());
  assertEquals(LifecycleState.STOPPED,root.getState());
  configureTest46243Context(root,false);
  root.start();
  client.connect();
  client.processRequest();
  assertTrue(client.isResponse200());
  assertEquals(Bug46243Filter.class.getName() + HelloWorldServlet.RESPONSE_TEXT,client.getResponseBody());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWebappLoaderStartFail() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  tomcat.start();
  ((ContainerBase)tomcat.getHost()).setStartChildren(false);
  FailingWebappLoader loader=new FailingWebappLoader();
  File root=new File("test/webapp-3.0");
  Context context=tomcat.addWebapp("",root.getAbsolutePath());
  context.setLoader(loader);
  try {
    context.start();
    fail();
  }
 catch (  LifecycleException ex) {
  }
  assertEquals(LifecycleState.FAILED,context.getState());
  loader.setFail(false);
  context.start();
  assertEquals(LifecycleState.STARTED,context.getState());
  ByteChunk result=getUrl("http://localhost:" + getPort() + "/bug49922/target");
  assertEquals("Target",result.toString());
}

</code></pre>

<br>
<pre class="type-4 type-12 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWebappListenerConfigureFail() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  tomcat.start();
  ((ContainerBase)tomcat.getHost()).setStartChildren(false);
  FailingLifecycleListener listener=new FailingLifecycleListener();
  File root=new File("test/webapp-3.0");
  Context context=tomcat.addWebapp("",root.getAbsolutePath());
  context.addLifecycleListener(listener);
  try {
    context.start();
    fail();
  }
 catch (  LifecycleException ex) {
  }
  assertEquals(LifecycleState.FAILED,context.getState());
  listener.setFail(false);
  context.start();
  assertEquals(LifecycleState.STARTED,context.getState());
  ByteChunk result=getUrl("http://localhost:" + getPort() + "/bug49922/target");
  assertEquals("Target",result.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.deploy.TestSecurityConstraint </h4><pre class="type-8 type-4 type-10 type-12 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Uses the examples in SRV.13.4 as the basis for these tests
 */
@Test public void testCreateConstraints(){
  ServletSecurityElement element;
  SecurityConstraint[] result;
  Set<HttpMethodConstraintElement> hmces=new HashSet<HttpMethodConstraintElement>();
  element=new ServletSecurityElement();
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(0,result.length);
  element=new ServletSecurityElement(new HttpConstraintElement(ServletSecurity.TransportGuarantee.CONFIDENTIAL));
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(1,result.length);
  assertFalse(result[0].getAuthConstraint());
  assertTrue(result[0].findCollections()[0].findPattern(URL_PATTERN));
  assertEquals(0,result[0].findCollections()[0].findMethods().length);
  assertEquals(ServletSecurity.TransportGuarantee.CONFIDENTIAL.name(),result[0].getUserConstraint());
  element=new ServletSecurityElement(new HttpConstraintElement(EmptyRoleSemantic.DENY));
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(1,result.length);
  assertTrue(result[0].getAuthConstraint());
  assertTrue(result[0].findCollections()[0].findPattern(URL_PATTERN));
  assertEquals(0,result[0].findCollections()[0].findMethods().length);
  assertEquals(ServletSecurity.TransportGuarantee.NONE.name(),result[0].getUserConstraint());
  element=new ServletSecurityElement(new HttpConstraintElement(ServletSecurity.TransportGuarantee.NONE,ROLE1));
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(1,result.length);
  assertTrue(result[0].getAuthConstraint());
  assertEquals(1,result[0].findAuthRoles().length);
  assertTrue(result[0].findAuthRole(ROLE1));
  assertTrue(result[0].findCollections()[0].findPattern(URL_PATTERN));
  assertEquals(0,result[0].findCollections()[0].findMethods().length);
  assertEquals(ServletSecurity.TransportGuarantee.NONE.name(),result[0].getUserConstraint());
  hmces.clear();
  hmces.add(new HttpMethodConstraintElement("GET",new HttpConstraintElement(ServletSecurity.TransportGuarantee.NONE,ROLE1)));
  hmces.add(new HttpMethodConstraintElement("POST",new HttpConstraintElement(ServletSecurity.TransportGuarantee.CONFIDENTIAL,ROLE1)));
  element=new ServletSecurityElement(hmces);
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(2,result.length);
  for (int i=0; i < 2; i++) {
    assertTrue(result[i].getAuthConstraint());
    assertEquals(1,result[i].findAuthRoles().length);
    assertTrue(result[i].findAuthRole(ROLE1));
    assertTrue(result[i].findCollections()[0].findPattern(URL_PATTERN));
    assertEquals(1,result[i].findCollections()[0].findMethods().length);
    String method=result[i].findCollections()[0].findMethods()[0];
    if ("GET".equals(method)) {
      assertEquals(ServletSecurity.TransportGuarantee.NONE.name(),result[i].getUserConstraint());
    }
 else     if ("POST".equals(method)) {
      assertEquals(ServletSecurity.TransportGuarantee.CONFIDENTIAL.name(),result[i].getUserConstraint());
    }
 else {
      fail("Unexpected method :[" + method + "]");
    }
  }
  hmces.clear();
  hmces.add(new HttpMethodConstraintElement("GET"));
  element=new ServletSecurityElement(new HttpConstraintElement(ServletSecurity.TransportGuarantee.NONE,ROLE1),hmces);
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(2,result.length);
  for (int i=0; i < 2; i++) {
    assertTrue(result[i].findCollections()[0].findPattern(URL_PATTERN));
    if (result[i].findCollections()[0].findMethods().length == 1) {
      assertEquals("GET",result[i].findCollections()[0].findMethods()[0]);
      assertFalse(result[i].getAuthConstraint());
    }
 else     if (result[i].findCollections()[0].findOmittedMethods().length == 1) {
      assertEquals("GET",result[i].findCollections()[0].findOmittedMethods()[0]);
      assertTrue(result[i].getAuthConstraint());
      assertEquals(1,result[i].findAuthRoles().length);
      assertEquals(ROLE1,result[i].findAuthRoles()[0]);
    }
 else {
      fail("Unexpected number of methods defined");
    }
    assertEquals(ServletSecurity.TransportGuarantee.NONE.name(),result[i].getUserConstraint());
  }
  hmces.clear();
  hmces.add(new HttpMethodConstraintElement("TRACE",new HttpConstraintElement(EmptyRoleSemantic.DENY)));
  element=new ServletSecurityElement(new HttpConstraintElement(ServletSecurity.TransportGuarantee.NONE,ROLE1),hmces);
  result=SecurityConstraint.createConstraints(element,URL_PATTERN);
  assertEquals(2,result.length);
  for (int i=0; i < 2; i++) {
    assertTrue(result[i].findCollections()[0].findPattern(URL_PATTERN));
    if (result[i].findCollections()[0].findMethods().length == 1) {
      assertEquals("TRACE",result[i].findCollections()[0].findMethods()[0]);
      assertTrue(result[i].getAuthConstraint());
      assertEquals(0,result[i].findAuthRoles().length);
    }
 else     if (result[i].findCollections()[0].findOmittedMethods().length == 1) {
      assertEquals("TRACE",result[i].findCollections()[0].findOmittedMethods()[0]);
      assertTrue(result[i].getAuthConstraint());
      assertEquals(1,result[i].findAuthRoles().length);
      assertEquals(ROLE1,result[i].findAuthRoles()[0]);
    }
 else {
      fail("Unexpected number of methods defined");
    }
    assertEquals(ServletSecurity.TransportGuarantee.NONE.name(),result[i].getUserConstraint());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.ha.session.TestSerializablePrincipal </h4><pre class="type-8 type-4 type-10 type-12 type-11 type-14 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple serialization / de-serialization test for bug 43840.
 */
@SuppressWarnings("null") @Test public void testWriteReadPrincipal(){
  File tempDir=new File(System.getProperty("tomcat.test.temp","output/tmp"));
  if (!tempDir.mkdirs() && !tempDir.isDirectory()) {
    fail("Unable to create temporary directory for test");
  }
  List<String> roles=new ArrayList<String>();
  roles.add("RoleA");
  roles.add("RoleB");
  TesterPrincipal tpOriginal=new TesterPrincipal("inner");
  GenericPrincipal gpOriginal=new GenericPrincipal("usr","pwd",roles,tpOriginal);
  File file=null;
  try {
    file=File.createTempFile("ser",null,tempDir);
  }
 catch (  IOException e) {
    e.printStackTrace();
    fail("ioe creating temporary file");
  }
  GenericPrincipal gpNew=null;
  try {
    FileOutputStream fos=null;
    ObjectOutputStream oos=null;
    try {
      fos=new FileOutputStream(file);
      oos=new ObjectOutputStream(fos);
      SerializablePrincipal.writePrincipal(gpOriginal,oos);
    }
 catch (    FileNotFoundException e) {
      e.printStackTrace();
      fail("fnfe creating object output stream");
    }
catch (    IOException e) {
      e.printStackTrace();
      fail("ioe serializing principal");
    }
 finally {
      if (oos != null) {
        try {
          oos.close();
        }
 catch (        IOException ignored) {
        }
      }
      if (fos != null) {
        try {
          fos.close();
        }
 catch (        IOException ignored) {
        }
      }
    }
    FileInputStream fis=null;
    ObjectInputStream ois=null;
    try {
      fis=new FileInputStream(file);
      ois=new ObjectInputStream(fis);
      gpNew=SerializablePrincipal.readPrincipal(ois);
    }
 catch (    FileNotFoundException e) {
      e.printStackTrace();
      fail("fnfe reading object output stream");
    }
catch (    IOException e) {
      e.printStackTrace();
      fail("ioe de-serializing principal");
    }
catch (    ClassNotFoundException e) {
      e.printStackTrace();
      fail("cnfe de-serializing principal");
    }
 finally {
      if (ois != null) {
        try {
          ois.close();
        }
 catch (        IOException ignored) {
        }
      }
      if (fis != null) {
        try {
          fis.close();
        }
 catch (        IOException ignored) {
        }
      }
    }
  }
  finally {
    if (!file.delete()) {
      System.out.println("Failed to delete " + file);
    }
  }
  assertEquals("User names different",gpOriginal.getName(),gpNew.getName());
  assertEquals("Passwords different",gpOriginal.getPassword(),gpNew.getPassword());
  assertEquals("Number of roles different",gpOriginal.getRoles().length,gpNew.getRoles().length);
  for (int i=0; i < gpOriginal.getRoles().length; i++) {
    assertEquals("Role name index " + i + "different",gpOriginal.getRoles()[i],gpNew.getRoles()[i]);
  }
  assertNotSame("Inner principal not present",gpNew,gpNew.getUserPrincipal());
  assertEquals("Inner user names are different",tpOriginal.getName(),gpNew.getUserPrincipal().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.loader.TestParallelWebappClassLoader </h4><pre class="type-4 type-12 type-3 type-11 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParallelIncapableOnJre6(){
  if (JreCompat.isJre7Available()) {
    return;
  }
  try {
    Tomcat tomcat=getTomcatInstance();
    Context ctx=tomcat.addContext("",System.getProperty("java.io.tmpdir"));
    WebappLoader webappLoader=new WebappLoader();
    webappLoader.setLoaderClass(PARALLEL_CLASSLOADER);
    ctx.setLoader(webappLoader);
    tomcat.start();
    ClassLoader classloader=ctx.getLoader().getClassLoader();
    Assert.assertTrue(classloader instanceof ParallelWebappClassLoader);
    Method getClassLoadingLock=getDeclaredMethod(classloader.getClass(),"getClassLoadingLock",String.class);
    Assert.assertNull(getClassLoadingLock);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("testParallelIncapableOnJre6 fails.");
  }
}

</code></pre>

<br>
<pre class="type-4 type-12 type-3 type-11 type-1 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParallelCapableOnJre7(){
  if (!JreCompat.isJre7Available()) {
    return;
  }
  try {
    Tomcat tomcat=getTomcatInstance();
    Context ctx=tomcat.addContext("",null);
    WebappLoader webappLoader=new WebappLoader();
    webappLoader.setLoaderClass(PARALLEL_CLASSLOADER);
    ctx.setLoader(webappLoader);
    tomcat.start();
    ClassLoader classloader=ctx.getLoader().getClassLoader();
    Assert.assertTrue(classloader instanceof ParallelWebappClassLoader);
    Method getClassLoadingLock=getDeclaredMethod(classloader.getClass(),"getClassLoadingLock",String.class);
    Assert.assertNotNull(getClassLoadingLock);
    getClassLoadingLock.setAccessible(true);
    Object lock=getClassLoadingLock.invoke(classloader,DUMMY_SERVLET);
    Assert.assertNotEquals(lock,classloader);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("testParallelCapableOnJre7 fails.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.loader.TestWebappClassLoaderMemoryLeak </h4><pre class="type-10 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTimerThreadLeak() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  Context ctx=tomcat.addContext("",null);
  if (ctx instanceof StandardContext) {
    ((StandardContext)ctx).setClearReferencesStopTimerThreads(true);
  }
  Tomcat.addServlet(ctx,"taskServlet",new TaskServlet());
  ctx.addServletMapping("/","taskServlet");
  tomcat.start();
  getUrl("http://localhost:" + getPort() + "/");
  ctx.stop();
  Thread[] threads=getThreads();
  for (  Thread thread : threads) {
    if (thread != null && thread.isAlive() && TaskServlet.TIMER_THREAD_NAME.equals(thread.getName())) {
      thread.join(5000);
      if (thread.isAlive()) {
        fail("Timer thread still running");
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.loader.TestWebappClassLoaderWeaving </h4><pre class="type-12 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddingNullTransformerThrowsException() throws Exception {
  try {
    this.loader.addTransformer(null);
    fail("Expected exception IllegalArgumentException, got no exception.");
  }
 catch (  IllegalArgumentException ignore) {
  }
  String result=invokeDoMethodOnClass(this.loader,"TesterNeverWeavedClass");
  assertEquals("The first result is not correct.","This will never be weaved.",result);
  result=invokeDoMethodOnClass(this.loader,"TesterUnweavedClass");
  assertEquals("The second result is not correct.","Hello, Unweaved World!",result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.mbeans.TestRegistration </h4><pre class="type-4 type-10 type-12 type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test verifying that Tomcat correctly de-registers the MBeans it has
 * registered.
 * @author Marc Guillemot
 */
@Test public void testMBeanDeregistration() throws Exception {
  final MBeanServer mbeanServer=Registry.getRegistry(null,null).getMBeanServer();
  Set<ObjectName> onames=mbeanServer.queryNames(new ObjectName("Catalina:*"),null);
  log.info(MBeanDumper.dumpBeans(mbeanServer,onames));
  assertEquals("Unexpected: " + onames,0,onames.size());
  onames=mbeanServer.queryNames(new ObjectName("Tomcat:*"),null);
  log.info(MBeanDumper.dumpBeans(mbeanServer,onames));
  assertEquals("Unexpected: " + onames,0,onames.size());
  final Tomcat tomcat=getTomcatInstance();
  final File contextDir=new File(getTemporaryDirectory(),"webappFoo");
  addDeleteOnTearDown(contextDir);
  if (!contextDir.mkdirs() && !contextDir.isDirectory()) {
    fail("Failed to create: [" + contextDir.toString() + "]");
  }
  Context ctx=tomcat.addContext(contextName,contextDir.getAbsolutePath());
  CombinedRealm combinedRealm=new CombinedRealm();
  Realm nullRealm=new NullRealm();
  combinedRealm.addRealm(nullRealm);
  ctx.setRealm(combinedRealm);
  tomcat.getConnector().setAttribute("maxKeepAliveRequests",Integer.valueOf(1));
  tomcat.start();
  getUrl("http://localhost:" + getPort());
  onames=mbeanServer.queryNames(new ObjectName("Catalina:*"),null);
  log.info(MBeanDumper.dumpBeans(mbeanServer,onames));
  assertEquals("Found: " + onames,0,onames.size());
  onames=mbeanServer.queryNames(new ObjectName("Tomcat:*"),null);
  ArrayList<String> found=new ArrayList<String>(onames.size());
  for (  ObjectName on : onames) {
    found.add(on.toString());
  }
  String protocol=tomcat.getConnector().getProtocolHandlerClassName();
  if (protocol.indexOf("Nio") > 0) {
    protocol="nio";
  }
 else   if (protocol.indexOf("Apr") > 0) {
    protocol="apr";
  }
 else {
    protocol="bio";
  }
  String index=tomcat.getConnector().getProperty("nameIndex").toString();
  ArrayList<String> expected=new ArrayList<String>(Arrays.asList(basicMBeanNames()));
  expected.addAll(Arrays.asList(hostMBeanNames("localhost")));
  expected.addAll(Arrays.asList(contextMBeanNames("localhost",contextName)));
  expected.addAll(Arrays.asList(connectorMBeanNames("auto-" + index,protocol)));
  expected.addAll(Arrays.asList(optionalMBeanNames("localhost")));
  expected.addAll(Arrays.asList(requestMBeanNames("auto-" + index + "-"+ getPort(),protocol)));
  ArrayList<String> missing=new ArrayList<String>(expected);
  missing.removeAll(found);
  assertTrue("Missing Tomcat MBeans: " + missing,missing.isEmpty());
  List<String> additional=found;
  additional.removeAll(expected);
  assertTrue("Unexpected Tomcat MBeans: " + additional,additional.isEmpty());
  tomcat.stop();
  onames=mbeanServer.queryNames(new ObjectName("Tomcat:*"),null);
  assertTrue("No Tomcat MBeans",onames.size() > 0);
  StandardHost host=new StandardHost();
  host.setName("otherhost");
  tomcat.getEngine().addChild(host);
  final File contextDir2=new File(getTemporaryDirectory(),"webappFoo2");
  addDeleteOnTearDown(contextDir2);
  if (!contextDir2.mkdirs() && !contextDir2.isDirectory()) {
    fail("Failed to create: [" + contextDir2.toString() + "]");
  }
  tomcat.addContext(host,contextName + "2",contextDir2.getAbsolutePath());
  tomcat.start();
  tomcat.stop();
  tomcat.destroy();
  onames=mbeanServer.queryNames(new ObjectName("Catalina:*"),null);
  log.info(MBeanDumper.dumpBeans(mbeanServer,onames));
  assertEquals("Remaining: " + onames,0,onames.size());
  onames=mbeanServer.queryNames(new ObjectName("Tomcat:*"),null);
  log.info(MBeanDumper.dumpBeans(mbeanServer,onames));
  assertEquals("Remaining: " + onames,0,onames.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.servlets.TestDefaultServlet </h4><pre class="type-10 type-12 type-3 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test https://bz.apache.org/bugzilla/show_bug.cgi?id=50413 Serving a
 * custom error page
 */
@Test public void testCustomErrorPage() throws Exception {
  File appDir=new File(getTemporaryDirectory(),"MyApp");
  File webInf=new File(appDir,"WEB-INF");
  addDeleteOnTearDown(appDir);
  if (!webInf.mkdirs() && !webInf.isDirectory()) {
    fail("Unable to create directory [" + webInf + "]");
  }
  Writer w=new OutputStreamWriter(new FileOutputStream(new File(appDir,"WEB-INF/web.xml")),"UTF-8");
  try {
    w.write("<?xml version='1.0' encoding='UTF-8'?>\n" + "<web-app xmlns='http://java.sun.com/xml/ns/j2ee' " + " xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'"+ " xsi:schemaLocation='http://java.sun.com/xml/ns/j2ee "+ " http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd'"+ " version='2.4'>\n"+ "<error-page>\n<error-code>404</error-code>\n"+ "<location>/404.html</location>\n</error-page>\n"+ "</web-app>\n");
    w.flush();
  }
  finally {
    w.close();
  }
  w=new OutputStreamWriter(new FileOutputStream(new File(appDir,"404.html")),"ISO-8859-1");
  try {
    w.write("It is 404.html");
    w.flush();
  }
  finally {
    w.close();
  }
  Tomcat tomcat=getTomcatInstance();
  String contextPath="/MyApp";
  tomcat.addWebapp(null,contextPath,appDir.getAbsolutePath());
  tomcat.start();
  TestCustomErrorClient client=new TestCustomErrorClient(tomcat.getConnector().getLocalPort());
  client.reset();
  client.setRequest(new String[]{"GET /MyApp/missing HTTP/1.0" + CRLF + CRLF});
  client.connect();
  client.processRequest();
  assertTrue(client.isResponse404());
  assertEquals("It is 404.html",client.getResponseBody());
  SimpleDateFormat format=new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss zzz",Locale.US);
  format.setTimeZone(TimeZone.getTimeZone("GMT"));
  String tomorrow=format.format(new Date(System.currentTimeMillis() + 24 * 60 * 60* 1000));
  client.reset();
  client.setRequest(new String[]{"GET /MyApp/missing HTTP/1.1" + CRLF + "Host: localhost"+ CRLF+ "Connection: close"+ CRLF+ "If-Modified-Since: "+ tomorrow+ CRLF+ CRLF});
  client.connect();
  client.processRequest();
  assertTrue(client.isResponse404());
  assertEquals("It is 404.html",client.getResponseBody());
  client.reset();
  client.setRequest(new String[]{"GET /MyApp/missing HTTP/1.1" + CRLF + "Host: localhost"+ CRLF+ "Connection: close"+ CRLF+ "Range: bytes=0-100"+ CRLF+ CRLF});
  client.connect();
  client.processRequest();
  assertTrue(client.isResponse404());
  assertEquals("It is 404.html",client.getResponseBody());
}

</code></pre>

<br>
<pre class="type-10 type-12 type-3 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test what happens if a custom 404 page is configured,
 * but its file is actually missing.
 */
@Test public void testCustomErrorPageMissing() throws Exception {
  File appDir=new File(getTemporaryDirectory(),"MyApp");
  File webInf=new File(appDir,"WEB-INF");
  addDeleteOnTearDown(appDir);
  if (!webInf.mkdirs() && !webInf.isDirectory()) {
    fail("Unable to create directory [" + webInf + "]");
  }
  Writer w=new OutputStreamWriter(new FileOutputStream(new File(appDir,"WEB-INF/web.xml")),"UTF-8");
  try {
    w.write("<?xml version='1.0' encoding='UTF-8'?>\n" + "<web-app xmlns='http://java.sun.com/xml/ns/j2ee' " + " xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'"+ " xsi:schemaLocation='http://java.sun.com/xml/ns/j2ee "+ " http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd'"+ " version='2.4'>\n"+ "<error-page>\n<error-code>404</error-code>\n"+ "<location>/404-absent.html</location>\n</error-page>\n"+ "</web-app>\n");
    w.flush();
  }
  finally {
    w.close();
  }
  Tomcat tomcat=getTomcatInstance();
  String contextPath="/MyApp";
  tomcat.addWebapp(null,contextPath,appDir.getAbsolutePath());
  tomcat.start();
  TestCustomErrorClient client=new TestCustomErrorClient(tomcat.getConnector().getLocalPort());
  client.reset();
  client.setRequest(new String[]{"GET /MyApp/missing HTTP/1.0" + CRLF + CRLF});
  client.connect();
  client.processRequest();
  assertTrue(client.isResponse404());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.startup.LoggingBaseTest </h4><pre class="type-9 type-10 type-12 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  tempDir=new File(System.getProperty("tomcat.test.temp","output/tmp"));
  if (!tempDir.mkdirs() && !tempDir.isDirectory()) {
    fail("Unable to create temporary directory for test");
  }
  System.setProperty("catalina.base",tempDir.getAbsolutePath());
  System.setProperty("java.util.logging.manager","org.apache.juli.ClassLoaderLogManager");
  System.setProperty("java.util.logging.config.file",new File(getBuildDirectory(),"conf/logging.properties").toString());
  log=LogFactory.getLog(getClass());
  log.info("Starting test case [" + testName.getMethodName() + "]");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.startup.TestContextConfigAnnotation </h4><pre class="type-12 type-3 type-11 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateFilterMapping() throws Exception {
  WebXml webxml=new WebXml();
  ContextConfig config=new ContextConfig();
  File pFile=paramClassResource("org/apache/catalina/startup/DuplicateMappingParamFilter");
  assertTrue(pFile.exists());
  try {
    config.processAnnotationsFile(pFile,webxml,false);
    fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  FilterDef filterDef=webxml.getFilters().get("paramD");
  assertNull(filterDef);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-11 type-5 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateMapping() throws Exception {
  WebXml webxml=new WebXml();
  ContextConfig config=new ContextConfig();
  File pFile=paramClassResource("org/apache/catalina/startup/DuplicateMappingParamServlet");
  assertTrue(pFile.exists());
  try {
    config.processAnnotationsFile(pFile,webxml,false);
    fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  ServletDef servletDef=webxml.getServlets().get("param");
  assertNull(servletDef);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.startup.TestTomcat </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetBrokenContextPerAddContext(){
  Tomcat tomcat=getTomcatInstance();
  Host host=tomcat.getHost();
  if (host instanceof StandardHost) {
    ((StandardHost)host).setContextClass("InvalidContextClassName");
  }
  try {
    tomcat.addContext(null,"",null);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetBrokenContextPerAddWepapp(){
  Tomcat tomcat=getTomcatInstance();
  Host host=tomcat.getHost();
  if (host instanceof StandardHost) {
    ((StandardHost)host).setContextClass("InvalidContextClassName");
  }
  try {
    File appFile=new File("test/deployment/context.war");
    tomcat.addWebapp(null,"/test",appFile.getAbsolutePath());
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.startup.TomcatBaseTest </h4><pre class="type-9 type-10 type-12 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before @Override public void setUp() throws Exception {
  super.setUp();
  CatalinaProperties.getProperty("foo");
  File appBase=new File(getTemporaryDirectory(),"webapps");
  if (!appBase.exists() && !appBase.mkdir()) {
    fail("Unable to create appBase for test");
  }
  tomcat=new TomcatWithFastSessionIDs();
  String protocol=getProtocol();
  Connector connector=new Connector(protocol);
  connector.setAttribute("address",InetAddress.getByName("localhost").getHostAddress());
  connector.setPort(0);
  connector.setAttribute("connectionTimeout","3000");
  tomcat.getService().addConnector(connector);
  tomcat.setConnector(connector);
  if (protocol.contains("Apr")) {
    StandardServer server=(StandardServer)tomcat.getServer();
    AprLifecycleListener listener=new AprLifecycleListener();
    listener.setSSLRandomSeed("/dev/urandom");
    server.addLifecycleListener(listener);
    connector.setAttribute("pollerThreadCount",Integer.valueOf(1));
  }
  File catalinaBase=getTemporaryDirectory();
  tomcat.setBaseDir(catalinaBase.getAbsolutePath());
  tomcat.getHost().setAppBase(appBase.getAbsolutePath());
  accessLogEnabled=Boolean.parseBoolean(System.getProperty("tomcat.test.accesslog","false"));
  if (accessLogEnabled) {
    String accessLogDirectory=System.getProperty("tomcat.test.reports");
    if (accessLogDirectory == null) {
      accessLogDirectory=new File(getBuildDirectory(),"logs").toString();
    }
    AccessLogValve alv=new AccessLogValve();
    alv.setDirectory(accessLogDirectory);
    alv.setPattern("%h %l %u %t \"%r\" %s %b %I %D");
    tomcat.getHost().getPipeline().addValve(alv);
  }
  addDeleteOnTearDown(new File(catalinaBase,"webapps"));
  addDeleteOnTearDown(new File(catalinaBase,"work"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.tribes.group.interceptors.TestOrderInterceptor </h4><pre class="type-8 type-10 type-12 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrder2() throws Exception {
  final Member[] dest=channels[0].getMembers();
  final AtomicInteger value=new AtomicInteger(0);
  final Queue<Exception> exceptionQueue=new ConcurrentLinkedQueue<Exception>();
  Runnable run=new Runnable(){
    @Override public void run(){
      for (int i=0; i < 100; i++) {
        try {
synchronized (channels[0]) {
            channels[0].send(dest,Integer.valueOf(value.getAndAdd(1)),0);
          }
        }
 catch (        Exception x) {
          exceptionQueue.add(x);
        }
      }
    }
  }
;
  Thread[] threads=new Thread[5];
  for (int i=0; i < threads.length; i++) {
    threads[i]=new Thread(run);
  }
  for (int i=0; i < threads.length; i++) {
    threads[i].start();
  }
  for (int i=0; i < threads.length; i++) {
    threads[i].join();
  }
  if (!exceptionQueue.isEmpty()) {
    fail("Exception while sending in threads: " + exceptionQueue.remove().toString());
  }
  Thread.sleep(5000);
  for (int i=0; i < test.length; i++) {
    assertFalse(test[i].fail);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.tribes.group.interceptors.TestTcpFailureDetector </h4><pre class="type-12 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTcpMcastFail() throws Exception {
  System.out.println("testTcpMcastFail()");
  clear();
  channel1.start(Channel.DEFAULT);
  channel2.start(Channel.DEFAULT);
  assertEquals("Expecting member count to be equal",mbrlist1.members.size(),mbrlist2.members.size());
  channel2.stop(Channel.MBR_TX_SEQ);
  ByteMessage msg=new ByteMessage(new byte[1024]);
  try {
    Thread.sleep(5000);
    assertEquals("Expecting member count to be equal",mbrlist1.members.size(),mbrlist2.members.size());
    channel1.send(channel1.getMembers(),msg,0);
  }
 catch (  ChannelException x) {
    fail("Message send should have succeeded.");
  }
  channel1.stop(Channel.DEFAULT);
  channel2.stop(Channel.DEFAULT);
}

</code></pre>

<br>
<pre class="type-12 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTcpSendFailureMemberDrop() throws Exception {
  System.out.println("testTcpSendFailureMemberDrop()");
  clear();
  channel1.start(Channel.DEFAULT);
  channel2.start(Channel.DEFAULT);
  assertEquals("Expecting member count to be equal",mbrlist1.members.size(),mbrlist2.members.size());
  channel2.stop(Channel.SND_RX_SEQ);
  ByteMessage msg=new ByteMessage(new byte[1024]);
  try {
    channel1.send(channel1.getMembers(),msg,0);
    fail("Message send should have failed.");
  }
 catch (  ChannelException x) {
  }
  assertEquals("Expecting member count to not be equal",mbrlist1.members.size() + 1,mbrlist2.members.size());
  channel1.stop(Channel.DEFAULT);
  channel2.stop(Channel.DEFAULT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.catalina.tribes.test.channel.TestRemoteProcessException </h4><pre class="type-8 type-10 type-12 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataSendSYNCACK() throws Exception {
  System.err.println("Starting SYNC_ACK");
  int errC=0, nerrC=0;
  for (int i=0; i < msgCount; i++) {
    boolean error=Data.r.nextBoolean();
    try {
      channel1.send(channel1.getMembers(),Data.createRandomData(error),Channel.SEND_OPTIONS_SYNCHRONIZED_ACK | Channel.SEND_OPTIONS_USE_ACK);
      if (error) {
        fail("A ChannelException was expected");
      }
    }
 catch (    ChannelException e) {
      if (!error) {
        throw e;
      }
    }
    if (error)     errC++;
 else     nerrC++;
  }
  System.err.println("Finished SYNC_ACK");
  final int duplicate=2;
  assertEquals("Checking failure messages.",errC + duplicate,listener1.errCnt);
  assertEquals("Checking success messages.",nerrC,listener1.noErrCnt);
  assertEquals("Checking all messages.",msgCount + duplicate,listener1.noErrCnt + listener1.errCnt);
  System.out.println("Listener 1 stats:");
  listener1.printStats(System.out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.coyote.http11.TestAbstractHttp11Processor </h4><pre class="type-10 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBug55772() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  tomcat.getConnector().setProperty("processorCache","1");
  tomcat.getConnector().setProperty("maxThreads","1");
  Context ctxt=tomcat.addContext("",null);
  Tomcat.addServlet(ctxt,"async",new Bug55772Servlet());
  ctxt.addServletMapping("/*","async");
  tomcat.start();
  String request1="GET /async?1 HTTP/1.1\r\n" + "Host: localhost:" + getPort() + "\r\n"+ "Connection: keep-alive\r\n"+ "Cache-Control: max-age=0\r\n"+ "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"+ "User-Agent: Request1\r\n"+ "Accept-Encoding: gzip,deflate,sdch\r\n"+ "Accept-Language: en-US,en;q=0.8,fr;q=0.6,es;q=0.4\r\n"+ "Cookie: something.that.should.not.leak=true\r\n"+ "\r\n";
  String request2="GET /async?2 HTTP/1.1\r\n" + "Host: localhost:" + getPort() + "\r\n"+ "Connection: keep-alive\r\n"+ "Cache-Control: max-age=0\r\n"+ "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"+ "User-Agent: Request2\r\n"+ "Accept-Encoding: gzip,deflate,sdch\r\n"+ "Accept-Language: en-US,en;q=0.8,fr;q=0.6,es;q=0.4\r\n"+ "\r\n";
  Socket connection=null;
  try {
    connection=new Socket("localhost",getPort());
    connection.setSoLinger(true,0);
    Writer writer=new OutputStreamWriter(connection.getOutputStream(),B2CConverter.getCharset("US-ASCII"));
    writer.write(request1);
    writer.flush();
    bug55772Latch1.await();
    connection.close();
  }
  finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      IOException ioe) {
      }
    }
  }
  bug55772Latch2.await();
  bug55772IsSecondRequest=true;
  try {
    connection=new Socket("localhost",getPort());
    connection.setSoLinger(true,0);
    Writer writer=new OutputStreamWriter(connection.getOutputStream(),B2CConverter.getCharset("US-ASCII"));
    writer.write(request2);
    writer.flush();
    connection.getInputStream().read();
  }
  finally {
    if (connection != null) {
      try {
        connection.close();
      }
 catch (      IOException ioe) {
      }
    }
  }
  bug55772Latch3.await();
  if (bug55772RequestStateLeaked) {
    Assert.fail("State leaked between requests!");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.el.TestELEvaluation </h4><pre class="type-12 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testElSupportCompare(){
  compareBoth("Nulls should compare equal",0,null,null);
  compareBoth("Null should compare equal to \"\"",0,"",null);
  compareBoth("Null should be less than File()",-1,null,new File(""));
  compareBoth("Null should be less than Date()",-1,null,new Date());
  compareBoth("Date(0) should be less than Date(1)",-1,new Date(0),new Date(1));
  try {
    compareBoth("Should not compare",0,new Date(),new File(""));
    fail("Expecting ClassCastException");
  }
 catch (  ClassCastException expected) {
  }
  assertTrue(null == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jasper.compiler.TestGenerator </h4><pre class="type-12 type-3 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBug56581() throws LifecycleException {
  Tomcat tomcat=getTomcatInstance();
  File appDir=new File("test/webapp-3.0");
  tomcat.addWebapp(null,"/test",appDir.getAbsolutePath());
  tomcat.start();
  ByteChunk res=new ByteChunk();
  try {
    getUrl("http://localhost:" + getPort() + "/test/bug5nnnn/bug56581.jsp",res,null);
    Assert.fail("An IOException was expected.");
  }
 catch (  IOException expected) {
  }
  String result=res.toString();
  assertTrue(result.startsWith("0 Hello world!\n"));
  assertTrue(result.endsWith("999 Hello world!\n"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.naming.resources.TestProxyDirContext </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * lookup doesn't always throw the same exception.
 */
@Test public void testLookupException() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  StandardContext ctx=(StandardContext)tomcat.addContext("",null);
  ctx.setCacheTTL(500);
  tomcat.start();
  try {
    ctx.getResources().lookup("/WEB-INF/web.xml");
    fail();
  }
 catch (  final NameNotFoundException e) {
  }
  Thread.sleep(600);
  try {
    ctx.getResources().lookup("/WEB-INF/web.xml");
    fail();
  }
 catch (  final NameNotFoundException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.jdbc.test.TestSlowQueryComparator </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBug58489() throws Exception {
  long[] testData={0,0,0,1444225382010l,0,1444225382011l,0,1444225382012l,0,1444225382056l,0,1444225382014l,0,1444225382015l,0,1444225382016l,0,0,1444225382017l,0,1444225678350l,0,1444225680397l,0,1444225382018l,1444225382019l,1444225382020l,0,1444225382021l,0,1444225382022l,1444225382023l};
  List<QueryStats> stats=new ArrayList<QueryStats>();
  for (int i=0; i < testData.length; i++) {
    QueryStats qs=new QueryStats(String.valueOf(i));
    qs.add(0,testData[i]);
    stats.add(qs);
  }
  try {
    Collections.sort(stats,createComparator());
  }
 catch (  IllegalArgumentException e) {
    Assert.fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.util.buf.TestAscii </h4><pre class="type-4 type-12 type-6 type-18 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=NumberFormatException.class) public void testParseLong4(){
  BigInteger x=BigInteger.valueOf(5000000000L).shiftLeft(32);
  byte[] bytes=String.valueOf(x).getBytes();
  long result=Ascii.parseLong(bytes,0,bytes.length);
  Assert.fail("NumberFormatException expected, got: " + result);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-6 type-18 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=NumberFormatException.class) public void testParseLong3(){
  byte[] bytes="9223372036854775810".getBytes();
  long result=Ascii.parseLong(bytes,0,bytes.length);
  Assert.fail("NumberFormatException expected, got: " + result);
}

</code></pre>

<br>
<pre class="type-4 type-12 type-6 type-18 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=NumberFormatException.class) public void testParseLong2(){
  byte[] bytes="9223372036854775808".getBytes();
  long result=Ascii.parseLong(bytes,0,bytes.length);
  Assert.fail("NumberFormatException expected, got: " + result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.util.buf.TestUEncoder </h4><pre class="type-12 type-3 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncodeURLWithSlashInit() throws IOException {
  UEncoder urlEncoder=new UEncoder(SafeCharsSet.WITH_SLASH);
  String s="a+b/c/d+e.class";
  assertTrue(urlEncoder.encodeURL(s,0,s.length()).equals("a%2bb/c/d%2be.class"));
  assertTrue(urlEncoder.encodeURL(s,2,s.length() - 2).equals("b/c/d%2be.cla"));
  try {
    urlEncoder.addSafeCharacter('+');
    fail();
  }
 catch (  IllegalStateException e) {
  }
  s=new String(new char[]{0xD801,0xDC01});
  assertTrue(urlEncoder.encodeURL(s,0,s.length()).equals("%f0%90%90%81"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.util.net.TestSsl </h4><pre class="type-12 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenegotiateWorks() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  Assume.assumeTrue("SSL renegotiation has to be supported for this test",TesterSupport.isRenegotiationSupported(getTomcatInstance()));
  File appDir=new File(getBuildDirectory(),"webapps/examples");
  tomcat.addWebapp(null,"/examples",appDir.getAbsolutePath());
  TesterSupport.initSsl(tomcat);
  tomcat.start();
  SSLContext sslCtx=SSLContext.getInstance("TLS");
  sslCtx.init(null,TesterSupport.getTrustManagers(),null);
  SSLSocketFactory socketFactory=new TesterSupport.NoSSLv2SocketFactory(sslCtx.getSocketFactory());
  SSLSocket socket=(SSLSocket)socketFactory.createSocket("localhost",getPort());
  OutputStream os=socket.getOutputStream();
  os.write("GET /examples/servlets/servlet/HelloWorldExample HTTP/1.1\n".getBytes());
  os.flush();
  socket.startHandshake();
  try {
    os.write("Host: localhost\n\n".getBytes());
  }
 catch (  IOException ex) {
    ex.printStackTrace();
    fail("Re-negotiation failed");
  }
  InputStream is=socket.getInputStream();
  Reader r=new InputStreamReader(is);
  BufferedReader br=new BufferedReader(r);
  String line=br.readLine();
  while (line != null) {
    line=br.readLine();
  }
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRenegotiateFail() throws Exception {
  if (TesterSupport.RFC_5746_SUPPORTED) {
    return;
  }
  Tomcat tomcat=getTomcatInstance();
  File appDir=new File(getBuildDirectory(),"webapps/examples");
  tomcat.addWebapp(null,"/examples",appDir.getAbsolutePath());
  TesterSupport.initSsl(tomcat);
  tomcat.start();
  SSLContext sslCtx=SSLContext.getInstance("TLS");
  sslCtx.init(null,TesterSupport.getTrustManagers(),null);
  SSLSocketFactory socketFactory=sslCtx.getSocketFactory();
  SSLSocket socket=(SSLSocket)socketFactory.createSocket("localhost",getPort());
  socket.addHandshakeCompletedListener(new HandshakeCompletedListener(){
    @Override public void handshakeCompleted(    HandshakeCompletedEvent event){
      handshakeDone=true;
    }
  }
);
  OutputStream os=socket.getOutputStream();
  os.write("GET /examples/servlets/servlet/HelloWorldExample HTTP/1.0\n".getBytes());
  os.flush();
  InputStream is=socket.getInputStream();
  Thread.sleep(100);
  socket.startHandshake();
  os=socket.getOutputStream();
  try {
    os.write("Host: localhost\n\n".getBytes());
  }
 catch (  IOException ex) {
    ex.printStackTrace();
    fail("Re-negotiation failed");
  }
  Reader r=new InputStreamReader(is);
  BufferedReader br=new BufferedReader(r);
  String line=br.readLine();
  while (line != null) {
    line=br.readLine();
  }
  if (!handshakeDone) {
    return;
  }
  fail("Re-negotiation worked");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.websocket.TestWebSocketFrameClientSSL </h4><pre class="type-10 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBug56032() throws Exception {
  Assume.assumeFalse("Skip this test on BIO. TODO: investigate options to make it pass with HTTP BIO connector",getTomcatInstance().getConnector().getProtocolHandlerClassName().equals("org.apache.coyote.http11.Http11Protocol"));
  Tomcat tomcat=getTomcatInstance();
  Context ctx=tomcat.addContext("",null);
  ctx.addApplicationListener(TesterFirehoseServer.Config.class.getName());
  Tomcat.addServlet(ctx,"default",new DefaultServlet());
  ctx.addServletMapping("/","default");
  TesterSupport.initSsl(tomcat);
  tomcat.start();
  WebSocketContainer wsContainer=ContainerProvider.getWebSocketContainer();
  ClientEndpointConfig clientEndpointConfig=ClientEndpointConfig.Builder.create().build();
  clientEndpointConfig.getUserProperties().put(WsWebSocketContainer.SSL_TRUSTSTORE_PROPERTY,"test/org/apache/tomcat/util/net/ca.jks");
  Session wsSession=wsContainer.connectToServer(TesterProgrammaticEndpoint.class,clientEndpointConfig,new URI("wss://localhost:" + getPort() + TesterFirehoseServer.Config.PATH));
  MessageHandler handler=new SleepingText(5000);
  wsSession.addMessageHandler(handler);
  wsSession.getBasicRemote().sendText("Hello");
  int count=0;
  int limit=TesterFirehoseServer.WAIT_TIME_MILLIS / 100;
  System.err.println("Waiting for server to report an error");
  while (TesterFirehoseServer.Endpoint.getErrorCount() == 0 && count < limit) {
    Thread.sleep(100);
    count++;
  }
  if (TesterFirehoseServer.Endpoint.getErrorCount() == 0) {
    Assert.fail("No error reported by Endpoint when timeout was expected");
  }
  System.err.println("Waiting for connection to be closed");
  count=0;
  limit=(TesterFirehoseServer.SEND_TIME_OUT_MILLIS * 4) / 100;
  while (TesterFirehoseServer.Endpoint.getOpenConnectionCount() != 0 && count < limit) {
    Thread.sleep(100);
    count++;
  }
  int openConnectionCount=TesterFirehoseServer.Endpoint.getOpenConnectionCount();
  if (openConnectionCount != 0) {
    Assert.fail("There are [" + openConnectionCount + "] connections still open");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.websocket.TestWsWebSocketContainer </h4><pre class="type-4 type-10 type-12 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionExpiryContainer() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  Context ctx=tomcat.addContext("",null);
  ctx.addApplicationListener(TesterEchoServer.Config.class.getName());
  Tomcat.addServlet(ctx,"default",new DefaultServlet());
  ctx.addServletMapping("/","default");
  tomcat.start();
  WsWebSocketContainer wsContainer=(WsWebSocketContainer)ContainerProvider.getWebSocketContainer();
  wsContainer.setDefaultMaxSessionIdleTimeout(5000);
  wsContainer.setProcessPeriod(1);
  EndpointA endpointA=new EndpointA();
  connectToEchoServer(wsContainer,endpointA,TesterEchoServer.Config.PATH_BASIC);
  connectToEchoServer(wsContainer,endpointA,TesterEchoServer.Config.PATH_BASIC);
  Session s3a=connectToEchoServer(wsContainer,endpointA,TesterEchoServer.Config.PATH_BASIC);
  Set<Session> setA=s3a.getOpenSessions();
  Assert.assertEquals(3,setA.size());
  int count=0;
  boolean isOpen=true;
  while (isOpen && count < 8) {
    count++;
    Thread.sleep(1000);
    isOpen=false;
    for (    Session session : setA) {
      if (session.isOpen()) {
        isOpen=true;
        break;
      }
    }
  }
  if (isOpen) {
    for (    Session session : setA) {
      if (session.isOpen()) {
        System.err.println("Session with ID [" + session.getId() + "] is open");
      }
    }
    Assert.fail("There were open sessions");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.websocket.pojo.TestEncodingDecoding </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnsupportedObject() throws Exception {
  Tomcat tomcat=getTomcatInstance();
  Context ctx=tomcat.addContext("",null);
  ctx.addApplicationListener(ProgramaticServerEndpointConfig.class.getName());
  Tomcat.addServlet(ctx,"default",new DefaultServlet());
  ctx.addServletMapping("/","default");
  WebSocketContainer wsContainer=ContainerProvider.getWebSocketContainer();
  tomcat.start();
  Client client=new Client();
  URI uri=new URI("ws://localhost:" + getPort() + PATH_PROGRAMMATIC_EP);
  Session session=wsContainer.connectToServer(client,uri);
  Object msg1=new Object();
  try {
    session.getBasicRemote().sendObject(msg1);
    Assert.fail("No exception thrown ");
  }
 catch (  EncodeException e) {
  }
catch (  Throwable t) {
    Assert.fail("Wrong exception type");
  }
 finally {
    session.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.tomcat.websocket.pojo.TestPojoMethodMapping </h4><pre class="type-4 type-10 type-12 type-11 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Server server=new Server();
  SingletonConfigurator.setInstance(server);
  ServerConfigListener.setPojoClazz(Server.class);
  Tomcat tomcat=getTomcatInstance();
  Context ctx=tomcat.addContext("",null);
  ctx.addApplicationListener(ServerConfigListener.class.getName());
  Tomcat.addServlet(ctx,"default",new DefaultServlet());
  ctx.addServletMapping("/","default");
  WebSocketContainer wsContainer=ContainerProvider.getWebSocketContainer();
  tomcat.start();
  SimpleClient client=new SimpleClient();
  URI uri=new URI("ws://localhost:" + getPort() + "/"+ PARAM_ONE+ "/"+ PARAM_TWO+ "/"+ PARAM_THREE);
  Session session=wsContainer.connectToServer(client,uri);
  session.getBasicRemote().sendText("NO-OP");
  session.close();
  int count=0;
  while (count < 200) {
    if (server.isClosed()) {
      break;
    }
    count++;
    Thread.sleep(100);
  }
  if (count == 50) {
    Assert.fail("Server did not process an onClose event within 5 " + "seconds of the client sending a close message");
  }
  List<String> errors=server.getErrors();
  for (  String error : errors) {
    System.err.println(error);
  }
  Assert.assertEquals("Found errors",0,errors.size());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
