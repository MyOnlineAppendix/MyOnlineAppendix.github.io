<h3 style="margin:0px">Class: org.apache.catalina.realm.TestRealmBase (23 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(22)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints04() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE99);
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE2);
  applicationRoles.add(ROLE3);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints13() throws IOException {
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  constraintTwoRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE1);
  doRoleTest(null,null,constraintTwoRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDigestSHA() throws Exception {
  doTestDigestDigestPasswords(PWD,"SHA",PWD_SHA);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints03() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE3);
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE2);
  applicationRoles.add(ROLE1);
  applicationRoles.add(ROLE2);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-3 type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * This test case covers the special case in section 13.4.1 of the Servlet
 * 3.1 specification for {@link javax.servlet.annotation.HttpConstraint}.
 */
@Test public void testHttpConstraint() throws IOException {
  Class<TesterServletSecurity01> clazz=TesterServletSecurity01.class;
  ServletSecurity servletSecurity=clazz.getAnnotation(ServletSecurity.class);
  ServletSecurityElement servletSecurityElement=new ServletSecurityElement(servletSecurity);
  SecurityConstraint[] constraints=SecurityConstraint.createConstraints(servletSecurityElement,"/*");
  SecurityConstraint deleteConstraint=new SecurityConstraint();
  deleteConstraint.addAuthRole(ROLE1);
  SecurityCollection deleteCollection=new SecurityCollection();
  deleteCollection.addMethod("DELETE");
  deleteCollection.addPattern("/*");
  deleteConstraint.addCollection(deleteCollection);
  TesterMapRealm mapRealm=new TesterMapRealm();
  TesterRequest request=new TesterRequest();
  Response response=new TesterResponse();
  Context context=request.getContext();
  context.addSecurityRole(ROLE1);
  context.addSecurityRole(ROLE2);
  request.setContext(context);
  List<String> userRoles1=new ArrayList<String>();
  userRoles1.add(ROLE1);
  GenericPrincipal gp1=new GenericPrincipal(USER1,PWD,userRoles1);
  List<String> userRoles2=new ArrayList<String>();
  userRoles2.add(ROLE2);
  GenericPrincipal gp2=new GenericPrincipal(USER2,PWD,userRoles2);
  List<String> userRoles99=new ArrayList<String>();
  GenericPrincipal gp99=new GenericPrincipal(USER99,PWD,userRoles99);
  for (  SecurityConstraint constraint : constraints) {
    context.addConstraint(constraint);
  }
  context.addConstraint(deleteConstraint);
  request.setMethod("GET");
  SecurityConstraint[] constraintsGet=mapRealm.findSecurityConstraints(request,context);
  request.setUserPrincipal(null);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsGet,null));
  request.setUserPrincipal(gp1);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsGet,null));
  request.setUserPrincipal(gp2);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsGet,null));
  request.setUserPrincipal(gp99);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsGet,null));
  request.setMethod("POST");
  SecurityConstraint[] constraintsPost=mapRealm.findSecurityConstraints(request,context);
  request.setUserPrincipal(null);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsPost,null));
  request.setUserPrincipal(gp1);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsPost,null));
  request.setUserPrincipal(gp2);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsPost,null));
  request.setUserPrincipal(gp99);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsPost,null));
  request.setMethod("PUT");
  SecurityConstraint[] constraintsPut=mapRealm.findSecurityConstraints(request,context);
  request.setUserPrincipal(null);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsPut,null));
  request.setUserPrincipal(gp1);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsPut,null));
  request.setUserPrincipal(gp2);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsPut,null));
  request.setUserPrincipal(gp99);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsPut,null));
  request.setMethod("DELETE");
  SecurityConstraint[] constraintsDelete=mapRealm.findSecurityConstraints(request,context);
  request.setUserPrincipal(null);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsDelete,null));
  request.setUserPrincipal(gp1);
  Assert.assertTrue(mapRealm.hasResourcePermission(request,response,constraintsDelete,null));
  request.setUserPrincipal(gp2);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsDelete,null));
  request.setUserPrincipal(gp99);
  Assert.assertFalse(mapRealm.hasResourcePermission(request,response,constraintsDelete,null));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints16() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE1);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints12() throws IOException {
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  constraintTwoRoles.add(ROLE1);
  applicationRoles.add(ROLE1);
  doRoleTest(null,null,constraintTwoRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserWithoutNoRolesAndAllRoles() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  constraintRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE1);
  doRoleTest(userRoles,constraintRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints07() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE2);
  applicationRoles.add(ROLE3);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDigestSHAPrefix() throws Exception {
  doTestDigestDigestPasswords(PWD,"SHA",PWD_SHA_PREFIX);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints02() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE2);
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE2);
  applicationRoles.add(ROLE1);
  applicationRoles.add(ROLE2);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints15() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE1);
  applicationRoles.add(ROLE1);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoAuthConstraint() throws IOException {
  List<String> applicationRoles=new ArrayList<String>();
  doRoleTest(null,null,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDigestSSHAPrefix() throws Exception {
  doTestDigestDigestPasswords(PWD,"SHA",PWD_SSHA_PREFIX);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints06() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE2);
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE2);
  applicationRoles.add(ROLE3);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserWithSingleRoleAndAllRoles() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  applicationRoles.add(ROLE1);
  constraintRoles.add(ROLE_ALL_ROLES);
  doRoleTest(userRoles,constraintRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints05() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE_ALL_ROLES);
  applicationRoles.add(ROLE2);
  applicationRoles.add(ROLE3);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAllRolesWithNoAppRole() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  constraintRoles.add(ROLE_ALL_ROLES);
  doRoleTest(userRoles,constraintRoles,applicationRoles,false);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDigestMD5Prefix() throws Exception {
  doTestDigestDigestPasswords(PWD,"MD5",PWD_MD5_PREFIX);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCombineConstraints01() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintOneRoles=new ArrayList<String>();
  List<String> constraintTwoRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  constraintOneRoles.add(ROLE1);
  constraintTwoRoles.add(ROLE2);
  applicationRoles.add(ROLE1);
  applicationRoles.add(ROLE2);
  doRoleTest(userRoles,constraintOneRoles,constraintTwoRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserWithSingleRole() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  userRoles.add(ROLE1);
  constraintRoles.add(ROLE1);
  applicationRoles.add(ROLE1);
  doRoleTest(userRoles,constraintRoles,applicationRoles,true);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDigestMD5() throws Exception {
  doTestDigestDigestPasswords(PWD,"MD5",PWD_MD5);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserWithNoRoles() throws IOException {
  List<String> userRoles=new ArrayList<String>();
  List<String> constraintRoles=new ArrayList<String>();
  List<String> applicationRoles=new ArrayList<String>();
  constraintRoles.add(ROLE1);
  applicationRoles.add(ROLE1);
  doRoleTest(userRoles,constraintRoles,applicationRoles,false);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
