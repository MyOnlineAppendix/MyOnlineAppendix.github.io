<h3 style="margin:0px">Class: org.apache.sentry.provider.db.generic.service.persistent.TestPrivilegeOperatePersistence (17 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant all privilege to role r1 and revoke query privilege
 * there is update privilege related to role r1
 */
@Test public void testRevokePrivilegeWithAllPrivilegeExist() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject updatePrivilege=new Builder(allPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject queryPrivilege=new Builder(allPrivilege).setAction(SearchConstants.QUERY).build();
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevokeWithGrantOption() throws Exception {
  addGroupsToUser(GRANT_OPTION_USER,GRANT_OPTION_GROUP);
  addGroupsToUser(NO_GRANT_OPTION_USER,NO_GRANT_OPTION_GROUP);
  writePolicyFile();
  String roleName1="r1";
  String grantor="g1";
  sentryStore.createRole(SEARCH,roleName1,grantor);
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  sentryStore.alterRoleAddGroups(SEARCH,roleName1,Sets.newHashSet(GRANT_OPTION_GROUP),grantor);
  String roleName2="r2";
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,GRANT_OPTION_USER);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName2,queryPrivilege,GRANT_OPTION_USER);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<pre class="type-12 type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantRevokeCheckWithGrantOption() throws Exception {
  addGroupsToUser(GRANT_OPTION_USER,GRANT_OPTION_GROUP);
  addGroupsToUser(NO_GRANT_OPTION_USER,NO_GRANT_OPTION_GROUP);
  writePolicyFile();
  String roleName1="r1";
  String roleName2="r2";
  String grantor="g1";
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  PrivilegeObject queryPrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege1,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege1),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  PrivilegeObject queryPrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(false).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege2,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege2),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.alterRoleAddGroups(SEARCH,roleName1,Sets.newHashSet(GRANT_OPTION_GROUP),grantor);
  sentryStore.alterRoleAddGroups(SEARCH,roleName2,Sets.newHashSet(NO_GRANT_OPTION_GROUP),grantor);
  String roleName3="r3";
  sentryStore.createRole(SEARCH,roleName3,grantor);
  try {
    sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,queryPrivilege1,GRANT_OPTION_USER);
  }
 catch (  SentryGrantDeniedException e) {
    fail("SentryGrantDeniedException shouldn't have been thrown");
  }
  try {
    sentryStore.alterRoleRevokePrivilege(SEARCH,roleName3,queryPrivilege1,GRANT_OPTION_USER);
  }
 catch (  SentryGrantDeniedException e) {
    fail("SentryGrantDeniedException shouldn't have been thrown");
  }
  try {
    sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,queryPrivilege2,NO_GRANT_OPTION_USER);
    fail("SentryGrantDeniedException should have been thrown");
  }
 catch (  SentryGrantDeniedException e) {
  }
  try {
    sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,queryPrivilege2,NO_GRANT_OPTION_USER);
    fail("SentryGrantDeniedException should have been thrown");
  }
 catch (  SentryGrantDeniedException e) {
  }
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantWithGrantOption() throws Exception {
  addGroupsToUser(GRANT_OPTION_USER,GRANT_OPTION_GROUP);
  addGroupsToUser(NO_GRANT_OPTION_USER,NO_GRANT_OPTION_GROUP);
  writePolicyFile();
  String roleName1="r1";
  String grantor="g1";
  sentryStore.createRole(SEARCH,roleName1,grantor);
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,ADMIN_USER);
  sentryStore.alterRoleAddGroups(SEARCH,roleName1,Sets.newHashSet(GRANT_OPTION_GROUP),grantor);
  String roleName2="r2";
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,GRANT_OPTION_USER);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query privilege to role r1 and there is ALL privilege related this
 * collection existed
 */
@Test public void testGrantPrivilegeWithAllPrivilegeExist() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject queryPrivilege=new Builder(allPrivilege).setAction(SearchConstants.QUERY).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query and update privileges to role r1 and revoke query privilege
 * there is left update privilege related to role r1
 */
@Test public void testRevokePrivilege() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRenamePrivilege() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor=ADMIN_USER;
  List<? extends Authorizable> oldAuthoriables=Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME));
  List<? extends Authorizable> newAuthoriables=Arrays.asList(new Collection(COLLECTION_NAME),new Field(NOT_FIELD_NAME));
  PrivilegeObject oldQueryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(oldAuthoriables).build();
  PrivilegeObject oldUpdatePrivilege=new Builder(oldQueryPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject oldALLPrivilege=new Builder(oldQueryPrivilege).setAction(SearchConstants.ALL).build();
  PrivilegeObject newQueryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(newAuthoriables).build();
  PrivilegeObject newUpdatePrivilege=new Builder(newQueryPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject newALLPrivilege=new Builder(newQueryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,oldQueryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,oldUpdatePrivilege,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,oldALLPrivilege,grantor);
  assertEquals(Sets.newHashSet(oldQueryPrivilege,oldUpdatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(oldALLPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.renamePrivilege(SEARCH,SERVICE,oldAuthoriables,newAuthoriables,grantor);
  assertEquals(Sets.newHashSet(newQueryPrivilege,newUpdatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(newALLPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  List<? extends Authorizable> newAuthoriables1=Arrays.asList(new Collection(NOT_COLLECTION_NAME),new Field(NOT_FIELD_NAME));
  PrivilegeObject newQueryPrivilege1=new Builder(newQueryPrivilege).setAuthorizables(newAuthoriables1).build();
  PrivilegeObject newUpdatePrivilege1=new Builder(newUpdatePrivilege).setAuthorizables(newAuthoriables1).build();
  PrivilegeObject newALLPrivilege1=new Builder(newALLPrivilege).setAuthorizables(newAuthoriables1).build();
  sentryStore.renamePrivilege(SEARCH,SERVICE,Arrays.asList(new Collection(COLLECTION_NAME)),Arrays.asList(new Collection(NOT_COLLECTION_NAME)),grantor);
  assertEquals(Sets.newHashSet(newQueryPrivilege1,newUpdatePrivilege1),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(newALLPrivilege1),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesByRoleName() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor="g1";
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,ADMIN_USER);
  PrivilegeObject updatePrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,updatePrivilege,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1,roleName2)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesByProvider() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String roleName3="r3";
  String group="g3";
  String grantor=ADMIN_USER;
  String service1="service1";
  PrivilegeObject queryPrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  PrivilegeObject updatePrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.UPDATE).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject queryPrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  PrivilegeObject updatePrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.UPDATE).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.createRole(SEARCH,roleName3,grantor);
  sentryStore.alterRoleAddGroups(SEARCH,roleName3,Sets.newHashSet(group),grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,updatePrivilege2,grantor);
  assertEquals(Sets.newHashSet(updatePrivilege1,queryPrivilege1),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1),null,null));
  assertEquals(Sets.newHashSet(updatePrivilege1,queryPrivilege1,queryPrivilege2),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1,roleName2),null,null));
  assertEquals(Sets.newHashSet(updatePrivilege1,queryPrivilege1,queryPrivilege2,updatePrivilege2),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1,roleName2),Sets.newHashSet(group),null));
  List<? extends Authorizable> authorizables=Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME));
  assertEquals(Sets.newHashSet(updatePrivilege1,updatePrivilege2),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1,roleName2),Sets.newHashSet(group),authorizables));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query privilege to role r1
 */
@Test public void testGrantPrivilege() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(null).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject queryPrivilegeWithOption=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithOption,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,queryPrivilegeWithOption),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject queryPrivilegeWithNoOption=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(false).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithNoOption,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,queryPrivilegeWithOption,queryPrivilegeWithNoOption),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void configure() throws Exception {
  policyFile=new PolicyFile();
  addGroupsToUser(ADMIN_USER,getAdminGroups());
  writePolicyFile();
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query privilege to role r1 and there are query and update privileges
 * related this collection existed
 */
@Test public void testGrantALLPrivilegeWithOtherPrivilegesExist() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  PrivilegeObject allPrivilege=new Builder(queryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant update, query and all privilege to role r1
 * Revoke query privilege from role r1
 * there is update privilege related to role r1
 */
@Test public void testRevokePrivilegeWithAllPrivilegesGranted() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(allPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject queryPrivilege=new Builder(allPrivilege).setAction(SearchConstants.QUERY).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevokeParentPrivilegeWithChildsExist() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject updatePrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.UPDATE).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject queryPrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject queryPrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(NOT_COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege2,grantor);
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege2),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query and update privileges to role r1 and revoke all privilege,
 * there is no privilege related to role r1
 */
@Test public void testRevokeAllPrivilege() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject allPrivilege=new Builder(queryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropPrivilege() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.dropPrivilege(SEARCH,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  PrivilegeObject allPrivilege=new Builder(queryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.dropPrivilege(SEARCH,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege,grantor);
  PrivilegeObject parentPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.dropPrivilege(SEARCH,parentPrivilege,grantor);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantPrivilegeTwice() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  sentryStore.createRole(SEARCH,roleName,grantor);
  PrivilegeObject queryPrivilegeWithOption=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithOption,grantor);
  assertEquals(1,sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)).size());
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithOption,grantor);
  assertEquals(1,sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)).size());
  PrivilegeObject queryPrivilegeWithNoOption=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(false).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithNoOption,grantor);
  assertEquals(2,sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)).size());
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithNoOption,grantor);
  assertEquals(2,sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)).size());
  PrivilegeObject queryPrivilegeWithNullGrant=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(null).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithNullGrant,grantor);
  assertEquals(3,sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)).size());
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithNullGrant,grantor);
  assertEquals(3,sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)).size());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
