<h3 style="margin:0px">Class: org.apache.sentry.provider.db.service.thrift.TestSentryServiceIntegration (16 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListByAuthTab() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName1="role1";
      String roleName2="role2";
      String server="server1";
      String db="testDB";
      String db2="testDB2";
      String tab="testTab";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      client.grantDatabasePrivilege(requestorUserName,roleName1,server,db,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName1,server,db,tab,AccessConstants.ALL);
      TSentryPrivilege role1db2tab=client.grantTablePrivilege(requestorUserName,roleName1,server,db2,tab,AccessConstants.SELECT);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db,AccessConstants.ALL);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db2,AccessConstants.SELECT);
      TSentryPrivilege role2db2tab=client.grantTablePrivilege(requestorUserName,roleName2,server,db2,tab,AccessConstants.ALL);
      client.grantURIPrivilege(requestorUserName,roleName1,server,"hdfs:///fooUri");
      TSentryPrivilegeMap db1RoleToPrivMap=new TSentryPrivilegeMap(new TreeMap<String,Set<TSentryPrivilege>>());
      db1RoleToPrivMap.getPrivilegeMap().put(roleName1,Sets.newHashSet(role1db2tab));
      db1RoleToPrivMap.getPrivilegeMap().put(roleName2,Sets.newHashSet(role2db2tab));
      Map<TSentryAuthorizable,TSentryPrivilegeMap> expectedResults=Maps.newTreeMap();
      List<? extends Authorizable> db2TabAuthrizable=Lists.newArrayList(new Server(server),new Database(db2),new Table(tab));
      expectedResults.put(SentryPolicyServiceClientDefaultImpl.setupSentryAuthorizable(db2TabAuthrizable),db1RoleToPrivMap);
      Set<List<? extends Authorizable>> authorizableSet=Sets.newHashSet();
      authorizableSet.add(db2TabAuthrizable);
      Map<TSentryAuthorizable,TSentryPrivilegeMap> authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,null,null);
      assertEquals(expectedResults,authPrivMap);
    }
  }
);
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantRevokeWithGrantOption() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName="admin_r1";
      boolean grantOption=true;
      boolean withoutGrantOption=false;
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      client.grantTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL",grantOption);
      assertEquals(1,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
      client.revokeTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL",withoutGrantOption);
      assertEquals(1,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
      client.revokeTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL",grantOption);
      assertEquals(0,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
    }
  }
);
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantTwoPrivilegeDiffInGrantOption() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName="admin_r1";
      boolean grantOption=true;
      boolean withoutGrantOption=false;
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      client.grantTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL",grantOption);
      assertEquals(1,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
      client.grantTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL",withoutGrantOption);
      assertEquals(2,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
      client.revokeTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL",null);
      assertEquals(0,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowGrant() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName="admin_testdb";
      String server="server1";
      String db="testDB";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      Set<TSentryRole> roles=client.listRoles(requestorUserName);
      assertEquals("Incorrect number of roles",1,roles.size());
      client.grantDatabasePrivilege(requestorUserName,roleName,server,db,AccessConstants.ALL);
      Set<TSentryPrivilege> privileges=client.listAllPrivilegesByRoleName(requestorUserName,roleName);
      assertTrue(privileges.size() == 1);
      client.revokeDatabasePrivilege(requestorUserName,roleName,server,db,AccessConstants.ALL);
      client.dropRole(requestorUserName,roleName);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGranRevokePrivilegeOnColumnForRole() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName1="admin_r1";
      String roleName2="admin_r2";
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.grantColumnPrivilege(requestorUserName,roleName1,"server","db1","table1","col1","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName1,"server","db1","table1","col2","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName1,"server","db1","table2","col1","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName1,"server","db1","table2","col2","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName1,"server","db2","table1","col1","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName1,"server","db2","table2","col1","ALL");
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      client.grantColumnPrivilege(requestorUserName,roleName2,"server","db1","table1","col1","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName2,"server","db1","table1","col2","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName2,"server","db1","table2","col1","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName2,"server","db1","table2","col2","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName2,"server","db2","table1","col1","ALL");
      client.grantColumnPrivilege(requestorUserName,roleName2,"server","db2","table2","col1","ALL");
      Set<TSentryPrivilege> listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertEquals("Privilege not assigned to role1 !!",6,listPrivilegesByRoleName.size());
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertEquals("Privilege not assigned to role2 !!",6,listPrivilegesByRoleName.size());
      client.revokeColumnPrivilege(requestorUserName,roleName1,"server","db1","table1","col1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 5);
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 6);
      client.revokeTablePrivilege(requestorUserName,roleName2,"server","db1","table1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 4);
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 5);
      client.revokeDatabasePrivilege(requestorUserName,roleName1,"server","db1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 2);
      client.revokeColumnPrivilege(requestorUserName,roleName1,"server","db2","table1","col1","ALL");
      client.revokeColumnPrivilege(requestorUserName,roleName1,"server","db2","table2","col1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 0);
      client.revokeColumnPrivilege(requestorUserName,roleName2,"server","db1","table2","col1","ALL");
      client.revokeColumnPrivilege(requestorUserName,roleName2,"server","db1","table2","col2","ALL");
      client.revokeColumnPrivilege(requestorUserName,roleName2,"server","db2","table1","col1","ALL");
      client.revokeColumnPrivilege(requestorUserName,roleName2,"server","db2","table2","col1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 0);
    }
  }
);
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSameGrantTwice() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName="admin_r1";
      client.createRole(requestorUserName,roleName);
      client.grantTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL");
      client.grantTablePrivilege(requestorUserName,roleName,"server","db1","table1","ALL");
      assertEquals(1,client.listAllPrivilegesByRoleName(requestorUserName,roleName).size());
    }
  }
);
}

</code></pre>

<pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListByAuthDB() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName1="role1";
      String roleName2="role2";
      Set<String> testRoleSet=Sets.newHashSet(roleName1,roleName2);
      String group1="group1";
      String group2="group2";
      Set<String> testGroupSet=Sets.newHashSet(group1,group2);
      String server="server1";
      String db="testDB";
      String db2="testDB2";
      String tab="testTab";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      String group1user="group1user";
      setLocalGroupMapping(group1user,Sets.newHashSet(group1));
      String group2user="group2user";
      setLocalGroupMapping(group2user,Sets.newHashSet(group2));
      setLocalGroupMapping("random",Sets.newHashSet("foo"));
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      TSentryPrivilege role1db1=client.grantDatabasePrivilege(requestorUserName,roleName1,server,db,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName1,server,db,tab,AccessConstants.ALL);
      client.grantTablePrivilege(requestorUserName,roleName1,server,db2,tab,AccessConstants.SELECT);
      client.grantURIPrivilege(requestorUserName,roleName1,server,"hdfs:///fooUri");
      client.grantRoleToGroup(requestorUserName,group1,roleName1);
      TSentryPrivilege role2db1=client.grantDatabasePrivilege(requestorUserName,roleName2,server,db,AccessConstants.ALL);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db2,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName2,server,db2,tab,AccessConstants.ALL);
      client.grantRoleToGroup(requestorUserName,group2,roleName2);
      TSentryPrivilegeMap db1RoleToPrivMap=new TSentryPrivilegeMap(new TreeMap<String,Set<TSentryPrivilege>>());
      db1RoleToPrivMap.getPrivilegeMap().put(roleName1,Sets.newHashSet(role1db1));
      db1RoleToPrivMap.getPrivilegeMap().put(roleName2,Sets.newHashSet(role2db1));
      Map<TSentryAuthorizable,TSentryPrivilegeMap> expectedResults=Maps.newTreeMap();
      List<? extends Authorizable> db1Authrizable=Lists.newArrayList(new Server(server),new Database(db));
      expectedResults.put(SentryPolicyServiceClientDefaultImpl.setupSentryAuthorizable(db1Authrizable),db1RoleToPrivMap);
      Set<List<? extends Authorizable>> authorizableSet=Sets.newHashSet();
      authorizableSet.add(db1Authrizable);
      Map<TSentryAuthorizable,TSentryPrivilegeMap> authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,null,null);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,null,new ActiveRoleSet(testRoleSet));
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,null,ActiveRoleSet.ALL);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,testGroupSet,null);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,testGroupSet,new ActiveRoleSet(testRoleSet));
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,testGroupSet,ActiveRoleSet.ALL);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable("random",authorizableSet,new HashSet<String>(),ActiveRoleSet.ALL);
      expectedResults.clear();
      expectedResults.put(SentryPolicyServiceClientDefaultImpl.setupSentryAuthorizable(db1Authrizable),new TSentryPrivilegeMap(new HashMap<String,Set<TSentryPrivilege>>()));
      assertEquals(expectedResults,authPrivMap);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGranRevokePrivilegeOnTableForRole() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName1="admin_r1";
      String roleName2="admin_r2";
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.grantTablePrivilege(requestorUserName,roleName1,"server","db1","table1","ALL");
      client.grantTablePrivilege(requestorUserName,roleName1,"server","db1","table2","ALL");
      client.grantTablePrivilege(requestorUserName,roleName1,"server","db2","table3","ALL");
      client.grantTablePrivilege(requestorUserName,roleName1,"server","db2","table4","ALL");
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      client.grantTablePrivilege(requestorUserName,roleName2,"server","db1","table1","ALL");
      client.grantTablePrivilege(requestorUserName,roleName2,"server","db1","table2","ALL");
      client.grantTablePrivilege(requestorUserName,roleName2,"server","db2","table3","ALL");
      client.grantTablePrivilege(requestorUserName,roleName2,"server","db2","table4","ALL");
      Set<TSentryPrivilege> listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertEquals("Privilege not assigned to role1 !!",4,listPrivilegesByRoleName.size());
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertEquals("Privilege not assigned to role2 !!",4,listPrivilegesByRoleName.size());
      client.revokeTablePrivilege(requestorUserName,roleName1,"server","db1","table1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 3);
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 4);
      client.revokeTablePrivilege(requestorUserName,roleName2,"server","db1","table1","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 3);
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 3);
      client.revokeTablePrivilege(requestorUserName,roleName1,"server","db1","table2","ALL");
      client.revokeTablePrivilege(requestorUserName,roleName1,"server","db2","table3","ALL");
      client.revokeTablePrivilege(requestorUserName,roleName1,"server","db2","table4","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 0);
      client.revokeTablePrivilege(requestorUserName,roleName2,"server","db1","table2","ALL");
      client.revokeTablePrivilege(requestorUserName,roleName2,"server","db2","table3","ALL");
      client.revokeTablePrivilege(requestorUserName,roleName2,"server","db2","table4","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not correctly revoked !!",listPrivilegesByRoleName.size() == 0);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListByAuthUri() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName1="role1";
      String roleName2="role2";
      String server="server1";
      String db="testDB";
      String db2="testDB2";
      String tab="testTab";
      String uri1="hdfs:///fooUri";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      client.grantDatabasePrivilege(requestorUserName,roleName1,server,db,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName1,server,db,tab,AccessConstants.ALL);
      client.grantTablePrivilege(requestorUserName,roleName1,server,db2,tab,AccessConstants.SELECT);
      TSentryPrivilege role1uri1=client.grantURIPrivilege(requestorUserName,roleName1,server,uri1);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db,AccessConstants.ALL);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db2,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName2,server,db2,tab,AccessConstants.ALL);
      TSentryPrivilege role2uri2=client.grantURIPrivilege(requestorUserName,roleName2,server,uri1);
      TSentryPrivilegeMap db1RoleToPrivMap=new TSentryPrivilegeMap(new TreeMap<String,Set<TSentryPrivilege>>());
      db1RoleToPrivMap.getPrivilegeMap().put(roleName1,Sets.newHashSet(role1uri1));
      db1RoleToPrivMap.getPrivilegeMap().put(roleName2,Sets.newHashSet(role2uri2));
      Map<TSentryAuthorizable,TSentryPrivilegeMap> expectedResults=Maps.newTreeMap();
      List<? extends Authorizable> uri1Authrizable=Lists.newArrayList(new Server(server),new AccessURI(uri1));
      expectedResults.put(SentryPolicyServiceClientDefaultImpl.setupSentryAuthorizable(uri1Authrizable),db1RoleToPrivMap);
      Set<List<? extends Authorizable>> authorizableSet=Sets.newHashSet();
      authorizableSet.add(uri1Authrizable);
      Map<TSentryAuthorizable,TSentryPrivilegeMap> authPrivMap=client.listPrivilegsbyAuthorizable(requestorUserName,authorizableSet,null,null);
      assertEquals(expectedResults,authPrivMap);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUriWithEquals() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName="admin_testdb";
      String server="server1";
      String uri="file://u/w/h/t/partition=value/";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      Set<TSentryRole> roles=client.listRoles(requestorUserName);
      assertEquals("Incorrect number of roles",1,roles.size());
      client.grantURIPrivilege(requestorUserName,roleName,server,uri);
      Set<TSentryPrivilege> privileges=client.listAllPrivilegesByRoleName(requestorUserName,roleName);
      assertTrue(privileges.size() == 1);
      client.revokeURIPrivilege(requestorUserName,roleName,server,uri);
      privileges=client.listAllPrivilegesByRoleName(requestorUserName,roleName);
      assertTrue(privileges.size() == 0);
      client.dropRole(requestorUserName,roleName);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName="admin_testdb";
      String groupName="group1";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      Set<TSentryRole> roles=client.listRoles(requestorUserName);
      assertEquals("Incorrect number of roles",1,roles.size());
      client.grantRoleToGroup(requestorUserName,groupName,roleName);
      Set<TSentryRole> groupRoles=client.listRolesByGroupName(requestorUserName,groupName);
      assertTrue(groupRoles.size() == 1);
      for (      TSentryRole role : groupRoles) {
        assertTrue(role.getRoleName(),role.getRoleName().equalsIgnoreCase(roleName));
        assertTrue(role.getGroups().size() == 1);
        for (        TSentryGroup group : role.getGroups()) {
          assertTrue(group.getGroupName(),group.getGroupName().equalsIgnoreCase(groupName));
        }
      }
      client.dropRole(requestorUserName,roleName);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testMultipleRolesSamePrivilege() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName1="admin_r1";
      String roleName2="admin_r2";
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      client.grantTablePrivilege(requestorUserName,roleName1,"server","db","table","ALL");
      Set<TSentryPrivilege> listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not assigned to role1 !!",listPrivilegesByRoleName.size() == 1);
      client.grantTablePrivilege(requestorUserName,roleName2,"server","db","table","ALL");
      listPrivilegesByRoleName=client.listAllPrivilegesByRoleName(requestorUserName,roleName2);
      assertTrue("Privilege not assigned to role2 !!",listPrivilegesByRoleName.size() == 1);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateDropShowRole() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName="admin_r";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      Set<TSentryRole> roles=client.listRoles(requestorUserName);
      assertEquals("Incorrect number of roles",1,roles.size());
      for (      TSentryRole role : roles) {
        assertTrue(role.getRoleName(),role.getRoleName().equalsIgnoreCase(roleName));
      }
      client.dropRole(requestorUserName,roleName);
    }
  }
);
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetConfigVal() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String val;
      val=client.getConfigValue("sentry.service.admin.group","xxx");
      assertEquals(val,"admin_group");
      val=client.getConfigValue("sentry.this.is.not.defined","hello");
      assertEquals(val,"hello");
      val=client.getConfigValue("sentry.this.is.not.defined",null);
      assertEquals(val,null);
      val=client.getConfigValue("sentry.service.admin.group",null);
      assertEquals(val,"admin_group");
      checkBannedConfigVal("notsentry","xxx");
      checkBannedConfigVal("notsentry",null);
      checkBannedConfigVal("sentry.xxx.jdbc.xxx",null);
      checkBannedConfigVal("sentry.xxx.password",null);
      checkBannedConfigVal("sentry.service.server.keytab",null);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGranRevokePrivilegeOnServerForRole() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      String roleName1="admin_r1";
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.grantServerPrivilege(requestorUserName,roleName1,"server",false);
      Set<TSentryPrivilege> listPrivs=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege should be all:",listPrivs.iterator().next().getAction().equals("*"));
      client.revokeServerPrivilege(requestorUserName,roleName1,"server",false);
      listPrivs=client.listAllPrivilegesByRoleName(requestorUserName,roleName1);
      assertTrue("Privilege not correctly revoked !!",listPrivs.size() == 0);
    }
  }
);
}

</code></pre>

<pre class="type-12 type-5 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * List privileges by authorizables executed by non-admin user
 * Test various positive and negative cases for non-admin user
 * @throws Exception
 */
@Test public void testListByAuthTabForNonAdmin() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      String user1="user1";
      String group1="group1";
      String group2="group2";
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      Set<String> userGroupNames1=Sets.newHashSet(group1);
      Set<String> userGroupNames2=Sets.newHashSet(group2);
      String roleName1="role1";
      String roleName2="role2";
      String server="server1";
      String db="testDB";
      String db2="testDB2";
      String tab="testTab";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      setLocalGroupMapping(user1,userGroupNames1);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName1);
      client.createRole(requestorUserName,roleName1);
      client.dropRoleIfExists(requestorUserName,roleName2);
      client.createRole(requestorUserName,roleName2);
      client.grantDatabasePrivilege(requestorUserName,roleName1,server,db,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName1,server,db,tab,AccessConstants.ALL);
      TSentryPrivilege role1db2tab=client.grantTablePrivilege(requestorUserName,roleName1,server,db2,tab,AccessConstants.SELECT);
      client.grantRoleToGroup(requestorUserName,group1,roleName1);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db,AccessConstants.ALL);
      client.grantDatabasePrivilege(requestorUserName,roleName2,server,db2,AccessConstants.SELECT);
      client.grantTablePrivilege(requestorUserName,roleName2,server,db2,tab,AccessConstants.ALL);
      client.grantURIPrivilege(requestorUserName,roleName1,server,"hdfs:///fooUri");
      TSentryPrivilegeMap db1RoleToPrivMap=new TSentryPrivilegeMap(new TreeMap<String,Set<TSentryPrivilege>>());
      db1RoleToPrivMap.getPrivilegeMap().put(roleName1,Sets.newHashSet(role1db2tab));
      Map<TSentryAuthorizable,TSentryPrivilegeMap> expectedResults=Maps.newTreeMap();
      List<? extends Authorizable> db2TabAuthorizable=Lists.newArrayList(new Server(server),new Database(db2),new Table(tab));
      expectedResults.put(SentryPolicyServiceClientDefaultImpl.setupSentryAuthorizable(db2TabAuthorizable),db1RoleToPrivMap);
      Set<List<? extends Authorizable>> authorizableSet=Sets.newHashSet();
      authorizableSet.add(db2TabAuthorizable);
      Map<TSentryAuthorizable,TSentryPrivilegeMap> authPrivMap=client.listPrivilegsbyAuthorizable(user1,authorizableSet,null,null);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(user1,authorizableSet,new HashSet<String>(),null);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(user1,authorizableSet,null,new ActiveRoleSet(true));
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(user1,authorizableSet,userGroupNames1,null);
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(user1,authorizableSet,userGroupNames1,new ActiveRoleSet(true));
      assertEquals(expectedResults,authPrivMap);
      authPrivMap=client.listPrivilegsbyAuthorizable(user1,authorizableSet,null,new ActiveRoleSet(Sets.newHashSet(roleName1.toUpperCase())));
      assertEquals(expectedResults,authPrivMap);
      try {
        client.listPrivilegsbyAuthorizable(user1,authorizableSet,userGroupNames2,null);
        fail("listPrivilegsbyAuthorizable() should fail for user1 accessing " + group2);
      }
 catch (      SentryAccessDeniedException e) {
      }
      ActiveRoleSet roleSet2=new ActiveRoleSet(Sets.newHashSet(roleName2));
      try {
        client.listPrivilegsbyAuthorizable(user1,authorizableSet,null,roleSet2);
        fail("listPrivilegsbyAuthorizable() should fail for user1 accessing " + roleName2);
      }
 catch (      SentryAccessDeniedException e) {
      }
    }
  }
);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
