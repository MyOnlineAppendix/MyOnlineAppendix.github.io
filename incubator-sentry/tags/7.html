<h3><span class=" glyphicon glyphicon-tag"/>&nbspInternalCallVerifier</h3><kbd>Verifies values of objects/variables related to AUT calls</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.sentry.binding.hive.TestHiveAuthzConf </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test that deprecated configs do not override non-deprecated configs
 */
@Test public void testDeprecatedOverride(){
  try {
    for (    AuthzConfVars currentVar : currentProps) {
      authzDepConf.set(currentVar.getVar(),"current");
      Assert.assertEquals("current",authzDepConf.get(currentVar.getVar()));
    }
  }
  finally {
    for (    AuthzConfVars currentVar : currentProps) {
      authzDepConf.unset(currentVar.getVar());
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Check that the deprecated property values are used if the current properties
 * are not set.
 */
@Test public void testDeprecatedConfig(){
  for (  AuthzConfVars currentVar : currentProps) {
    Assert.assertEquals("deprecated",authzDepConf.get(currentVar.getVar()));
    Assert.assertEquals("deprecated",authzDepConf.get(currentVar.getVar(),"foobar"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.binding.hive.TestSentryHiveAuthorizationTaskFactory </h4><pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW GRANT ROLE ... ON TABLE ...
 */
@Test public void testShowGrantRoleOnTable() throws Exception {
  DDLWork work=analyze(parse("SHOW GRANT ROLE " + ROLE + " ON TABLE "+ TABLE));
  ShowGrantDesc grantDesc=work.getShowGrantDesc();
  Assert.assertNotNull("Show grant should not be null",grantDesc);
  Assert.assertEquals(PrincipalType.ROLE,grantDesc.getPrincipalDesc().getType());
  Assert.assertEquals(ROLE,grantDesc.getPrincipalDesc().getName());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
  Assert.assertEquals(TABLE,grantDesc.getHiveObj().getObject());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ... ON TABLE ... TO ROLE ... WITH GRANT OPTION
 */
@Test public void testGrantRoleTableWithGrantOption() throws Exception {
  DDLWork work=analyze(parse("GRANT " + ALL + " ON TABLE "+ TABLE+ " TO ROLE "+ ROLE+ " WITH GRANT OPTION"));
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipals())) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : assertSize(1,grantDesc.getPrivileges())) {
    Assert.assertEquals(Privilege.ALL,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertTrue("Expected grantOption is true",grantDesc.isGrantOption());
  Assert.assertEquals(TABLE,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * SHOW ROLES
 */
@Test public void testShowRoles() throws Exception {
  DDLWork work=analyze(parse("SHOW ROLES"));
  RoleDDLDesc roleDDLDesc=work.getRoleDDLDesc();
  Assert.assertEquals(RoleOperation.SHOW_ROLES,roleDDLDesc.getOperation());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * CREATE ROLE ...
 */
@Test public void testCreateRole() throws Exception {
  DDLWork work=analyze(parse("CREATE ROLE " + ROLE));
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.CREATE_ROLE,roleDesc.getOperation());
  Assert.assertFalse("Did not expect a group",roleDesc.getGroup());
  Assert.assertEquals(ROLE,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW ROLE GRANT GROUP ...
 */
@Test public void testShowRoleGrantGroup() throws Exception {
  DDLWork work=analyze(parse("SHOW ROLE GRANT GROUP " + GROUP));
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.SHOW_ROLE_GRANT,roleDesc.getOperation());
  Assert.assertEquals(PrincipalType.GROUP,roleDesc.getPrincipalType());
  Assert.assertEquals(GROUP,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ... ON TABLE ... FROM ROLE ...
 */
@Test public void testRevokeRoleTable() throws Exception {
  DDLWork work=analyze(parse("REVOKE " + ALL + " ON TABLE "+ TABLE+ " FROM ROLE "+ ROLE));
  RevokeDesc grantDesc=work.getRevokeDesc();
  Assert.assertNotNull("Revoke should not be null",grantDesc);
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipals())) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : assertSize(1,grantDesc.getPrivileges())) {
    Assert.assertEquals(Privilege.ALL,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantUri() throws Exception {
  String uriPath="/tmp";
  DDLWork work=analyze(parse("GRANT " + ALL + " ON URI '"+ uriPath+ "' TO ROLE "+ ROLE));
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipals())) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : assertSize(1,grantDesc.getPrivileges())) {
    Assert.assertEquals(Privilege.ALL,privilege.getPrivilege());
  }
  SentryHivePrivilegeObjectDesc privilegeDesc=(SentryHivePrivilegeObjectDesc)grantDesc.getPrivilegeSubjectDesc();
  Assert.assertTrue("Expected uri",privilegeDesc.getUri());
  Assert.assertEquals(uriPath,privilegeDesc.getObject());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ALL ON SERVER
 */
@Test public void testGrantServer() throws Exception {
  DDLWork work=analyze(parse("GRANT " + ALL + " ON SERVER "+ SERVER+ " TO ROLE "+ ROLE));
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipals())) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : assertSize(1,grantDesc.getPrivileges())) {
    Assert.assertEquals(Privilege.ALL,privilege.getPrivilege());
  }
  SentryHivePrivilegeObjectDesc privilegeDesc=(SentryHivePrivilegeObjectDesc)grantDesc.getPrivilegeSubjectDesc();
  Assert.assertTrue("Expected server",privilegeDesc.getServer());
  Assert.assertEquals(SERVER,privilegeDesc.getObject());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * DROP ROLE ...
 */
@Test public void testDropRole() throws Exception {
  DDLWork work=analyze(parse("DROP ROLE " + ROLE));
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.DROP_ROLE,roleDesc.getOperation());
  Assert.assertFalse("Did not expect a group",roleDesc.getGroup());
  Assert.assertEquals(ROLE,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ROLE ... TO GROUP ...
 */
@Test public void testGrantRoleGroup() throws Exception {
  DDLWork work=analyze(parse("GRANT ROLE " + ROLE + " TO GROUP "+ GROUP));
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertTrue("Expected grant ",grantDesc.getGrant());
  Assert.assertFalse("Grant option should be false",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : assertSize(1,grantDesc.getRoles())) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipalDesc())) {
    Assert.assertEquals(PrincipalType.GROUP,principal.getType());
    Assert.assertEquals(GROUP,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ... ON TABLE ... TO ROLE ...
 */
@Test public void testGrantRoleTable() throws Exception {
  DDLWork work=analyze(parse("GRANT " + ALL + " ON TABLE "+ TABLE+ " TO ROLE "+ ROLE));
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipals())) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : assertSize(1,grantDesc.getPrivileges())) {
    Assert.assertEquals(Privilege.ALL,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * SHOW CURRENT ROLE
 */
@Test public void testShowCurrentRole() throws Exception {
  DDLWork work=analyze(parse("SHOW CURRENT ROLES"));
  RoleDDLDesc roleDDLDesc=work.getRoleDDLDesc();
  Assert.assertEquals(PrincipalType.USER,roleDDLDesc.getPrincipalType());
  Assert.assertEquals(RoleOperation.SHOW_CURRENT_ROLE,roleDDLDesc.getOperation());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ROLE ... FROM GROUP ...
 */
@Test public void testRevokeRoleGroup() throws Exception {
  DDLWork work=analyze(parse("REVOKE ROLE " + ROLE + " FROM GROUP "+ GROUP));
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertFalse("Did not expect grant ",grantDesc.getGrant());
  Assert.assertFalse("Grant option is always true ",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : assertSize(1,grantDesc.getRoles())) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : assertSize(1,grantDesc.getPrincipalDesc())) {
    Assert.assertEquals(PrincipalType.GROUP,principal.getType());
    Assert.assertEquals(GROUP,principal.getName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.binding.hive.TestSentryIniPolicyFileFormatter </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImportExport() throws Exception {
  prepareTestData();
  File baseDir=Files.createTempDir();
  String resourcePath=(new File(baseDir,RESOURCE_PATH)).getAbsolutePath();
  HiveAuthzConf authzConf=new HiveAuthzConf(Resources.getResource("sentry-site.xml"));
  SentryIniPolicyFileFormatter iniFormatter=new SentryIniPolicyFileFormatter();
  iniFormatter.write(resourcePath,policyFileMappingData1);
  Map<String,Map<String,Set<String>>> parsedMappingData=iniFormatter.parse(resourcePath,authzConf);
  validateSentryMappingData(parsedMappingData,policyFileMappingData1);
  iniFormatter.write(resourcePath,policyFileMappingData2);
  parsedMappingData=iniFormatter.parse(resourcePath,authzConf);
  validateSentryMappingData(parsedMappingData,policyFileMappingData2);
  iniFormatter.write(resourcePath,policyFileMappingData3);
  parsedMappingData=iniFormatter.parse(resourcePath,authzConf);
  validateSentryMappingData(parsedMappingData,policyFileMappingData3);
  iniFormatter.write(resourcePath,policyFileMappingData4);
  parsedMappingData=iniFormatter.parse(resourcePath,authzConf);
  assertTrue(parsedMappingData.get(PolicyFileConstants.GROUPS).isEmpty());
  assertTrue(parsedMappingData.get(PolicyFileConstants.ROLES).isEmpty());
  iniFormatter.write(resourcePath,policyFileMappingData5);
  parsedMappingData=iniFormatter.parse(resourcePath,authzConf);
  assertTrue(parsedMappingData.get(PolicyFileConstants.GROUPS).isEmpty());
  assertTrue(parsedMappingData.get(PolicyFileConstants.ROLES).isEmpty());
  (new File(baseDir,RESOURCE_PATH)).delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.binding.solr.TestSolrAuthzBinding </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomGroupMapping() throws Exception {
  SolrAuthzConf solrAuthzConf=new SolrAuthzConf(Resources.getResource("sentry-site.xml"));
  setUsableAuthzConf(solrAuthzConf);
  solrAuthzConf.set(AuthzConfVars.AUTHZ_PROVIDER.getVar(),"org.apache.sentry.provider.common.HadoopGroupResourceAuthorizationProvider");
  solrAuthzConf.set("hadoop.security.group.mapping",FoobarGroupMappingServiceProvider.class.getName());
  SolrAuthzBinding binding=new SolrAuthzBinding(solrAuthzConf);
  final String user="userTestSolrAuthzBinding";
  assertEquals(1,binding.getGroups(user).size());
  assertTrue(binding.getGroups(user).contains("foobar"));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for group mapping
 */
@Test public void testGroupMapping() throws Exception {
  SolrAuthzConf solrAuthzConf=new SolrAuthzConf(Resources.getResource("sentry-site.xml"));
  setUsableAuthzConf(solrAuthzConf);
  SolrAuthzBinding binding=new SolrAuthzBinding(solrAuthzConf);
  Set<String> emptyList=Collections.emptySet();
  try {
    binding.getGroups(null);
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getGroups("nonExistantUser");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getGroups("corporal");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getGroups("sergeant");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getGroups("general");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getGroups("othergeneralgroup");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  assertEquals(binding.getGroups("corporal1"),Sets.newHashSet("corporal"));
  assertEquals(binding.getGroups("sergeant1"),Sets.newHashSet("sergeant"));
  assertEquals(binding.getGroups("general1"),Sets.newHashSet("general","othergeneralgroup"));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for role mapping
 */
@Test public void testGetRoles() throws Exception {
  SolrAuthzConf solrAuthzConf=new SolrAuthzConf(Resources.getResource("sentry-site.xml"));
  setUsableAuthzConf(solrAuthzConf);
  SolrAuthzBinding binding=new SolrAuthzBinding(solrAuthzConf);
  Set<String> emptySet=Collections.emptySet();
  assertEquals(binding.getRoles("undefinedGroupUser"),emptySet);
  assertEquals(binding.getRoles("undefinedRoleUser"),emptySet);
  try {
    binding.getRoles("corporal_role");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getRoles("sergeant_role");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    binding.getRoles("general_role");
    Assert.fail("Expected SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  assertEquals(binding.getRoles("corporal1"),Sets.newHashSet("corporal_role"));
  assertEquals(binding.getRoles("sergeant1"),Sets.newHashSet("corporal_role","sergeant_role"));
  assertEquals(binding.getRoles("general1"),Sets.newHashSet("corporal_role","sergeant_role","general_role"));
  assertEquals(binding.getRoles("overlappingUser"),Sets.newHashSet("corporal_role","sergeant_role","general_role"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.core.indexer.TestIndexer </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIndexerAuthzType(){
  Indexer indexer1=new Indexer("indexer1");
  Indexer indexer2=new Indexer("indexer2");
  Assert.assertEquals(indexer1.getAuthzType(),indexer2.getAuthzType());
  Assert.assertEquals(indexer1.getTypeName(),indexer2.getTypeName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.core.indexer.TestIndexerBitFieldAction </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetActionByName() throws Exception {
  IndexerBitFieldAction writeAction=(IndexerBitFieldAction)actionFactory.getActionByName(IndexerConstants.WRITE);
  IndexerBitFieldAction readAction=(IndexerBitFieldAction)actionFactory.getActionByName(IndexerConstants.READ);
  IndexerBitFieldAction allAction=(IndexerBitFieldAction)actionFactory.getActionByName(IndexerConstants.ALL);
  assertTrue(writeAction.equals(new IndexerBitFieldAction(IndexerAction.WRITE)));
  assertTrue(readAction.equals(new IndexerBitFieldAction(IndexerAction.READ)));
  assertTrue(allAction.equals(new IndexerBitFieldAction(IndexerAction.ALL)));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetActionsByCode() throws Exception {
  IndexerBitFieldAction writeAction=new IndexerBitFieldAction(IndexerAction.WRITE);
  IndexerBitFieldAction readAction=new IndexerBitFieldAction(IndexerAction.READ);
  assertEquals(Lists.newArrayList(writeAction,readAction),actionFactory.getActionsByCode(IndexerAction.ALL.getCode()));
  assertEquals(Lists.newArrayList(writeAction),actionFactory.getActionsByCode(IndexerAction.WRITE.getCode()));
  assertEquals(Lists.newArrayList(readAction),actionFactory.getActionsByCode(IndexerAction.READ.getCode()));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesAction(){
  IndexerBitFieldAction writeAction=new IndexerBitFieldAction(IndexerAction.WRITE);
  IndexerBitFieldAction readAction=new IndexerBitFieldAction(IndexerAction.READ);
  IndexerBitFieldAction allAction=new IndexerBitFieldAction(IndexerAction.ALL);
  assertTrue(allAction.implies(readAction));
  assertTrue(allAction.implies(writeAction));
  assertTrue(allAction.implies(allAction));
  assertTrue(writeAction.implies(writeAction));
  assertTrue(readAction.implies(readAction));
  assertFalse(readAction.implies(writeAction));
  assertFalse(readAction.implies(allAction));
  assertFalse(writeAction.implies(readAction));
  assertFalse(writeAction.implies(allAction));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.core.model.sqoop.TestSqoopAction </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetActionsByCode() throws Exception {
  SqoopAction readAction=new SqoopAction(SqoopActionConstant.READ);
  SqoopAction writeAction=new SqoopAction(SqoopActionConstant.WRITE);
  SqoopAction allAction=new SqoopAction(SqoopActionConstant.ALL);
  assertEquals(Lists.newArrayList(readAction,writeAction),factory.getActionsByCode(allAction.getActionCode()));
  assertEquals(Lists.newArrayList(readAction),factory.getActionsByCode(readAction.getActionCode()));
  assertEquals(Lists.newArrayList(writeAction),factory.getActionsByCode(writeAction.getActionCode()));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesAction(){
  SqoopAction readAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.READ);
  SqoopAction writeAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.WRITE);
  SqoopAction allAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.ALL);
  SqoopAction allNameAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.ALL_NAME);
  assertTrue(allAction.implies(readAction));
  assertTrue(allAction.implies(writeAction));
  assertTrue(allAction.implies(allAction));
  assertTrue(readAction.implies(readAction));
  assertFalse(readAction.implies(writeAction));
  assertFalse(readAction.implies(allAction));
  assertTrue(writeAction.implies(writeAction));
  assertFalse(writeAction.implies(readAction));
  assertFalse(writeAction.implies(allAction));
  assertTrue(allNameAction.implies(readAction));
  assertTrue(allNameAction.implies(writeAction));
  assertTrue(allNameAction.implies(allAction));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetActionByName() throws Exception {
  SqoopAction readAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.READ);
  SqoopAction writeAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.WRITE);
  SqoopAction allAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.ALL);
  SqoopAction allNameAction=(SqoopAction)factory.getActionByName(SqoopActionConstant.ALL_NAME);
  assertTrue(readAction.equals(new SqoopAction(SqoopActionConstant.READ)));
  assertTrue(writeAction.equals(new SqoopAction(SqoopActionConstant.WRITE)));
  assertTrue(allAction.equals(new SqoopAction(SqoopActionConstant.ALL)));
  assertTrue(allNameAction.equals(new SqoopAction(SqoopActionConstant.ALL)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.core.search.TestCollection </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCollectionAuthzType(){
  Collection collection1=new Collection("collection1");
  Collection collection2=new Collection("collection2");
  Assert.assertEquals(collection1.getAuthzType(),collection2.getAuthzType());
  Assert.assertEquals(collection1.getTypeName(),collection2.getTypeName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.core.search.TestSearchBitFieldAction </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesAction(){
  SearchBitFieldAction updateAction=new SearchBitFieldAction(SearchAction.UPDATE);
  SearchBitFieldAction queryAction=new SearchBitFieldAction(SearchAction.QUERY);
  SearchBitFieldAction allAction=new SearchBitFieldAction(SearchAction.ALL);
  assertTrue(allAction.implies(queryAction));
  assertTrue(allAction.implies(updateAction));
  assertTrue(allAction.implies(allAction));
  assertTrue(updateAction.implies(updateAction));
  assertTrue(queryAction.implies(queryAction));
  assertFalse(queryAction.implies(updateAction));
  assertFalse(queryAction.implies(allAction));
  assertFalse(updateAction.implies(queryAction));
  assertFalse(updateAction.implies(allAction));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetActionsByCode() throws Exception {
  SearchBitFieldAction updateAction=new SearchBitFieldAction(SearchAction.UPDATE);
  SearchBitFieldAction queryAction=new SearchBitFieldAction(SearchAction.QUERY);
  assertEquals(Lists.newArrayList(updateAction,queryAction),actionFactory.getActionsByCode(SearchAction.ALL.getCode()));
  assertEquals(Lists.newArrayList(updateAction),actionFactory.getActionsByCode(SearchAction.UPDATE.getCode()));
  assertEquals(Lists.newArrayList(queryAction),actionFactory.getActionsByCode(SearchAction.QUERY.getCode()));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGetActionByName() throws Exception {
  SearchBitFieldAction updateAction=(SearchBitFieldAction)actionFactory.getActionByName(SearchConstants.UPDATE);
  SearchBitFieldAction queryAction=(SearchBitFieldAction)actionFactory.getActionByName(SearchConstants.QUERY);
  SearchBitFieldAction allAction=(SearchBitFieldAction)actionFactory.getActionByName(SearchConstants.ALL);
  assertTrue(updateAction.equals(new SearchBitFieldAction(SearchAction.UPDATE)));
  assertTrue(queryAction.equals(new SearchBitFieldAction(SearchAction.QUERY)));
  assertTrue(allAction.equals(new SearchBitFieldAction(SearchAction.ALL)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestHMSPaths </h4><pre class="type-5 type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRootEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  root.toString();
  Assert.assertNull(root.getParent());
  Assert.assertEquals(HMSPaths.EntryType.DIR,root.getType());
  Assert.assertTrue(root.getAuthzObjs().size() == 0);
  Assert.assertEquals(Path.SEPARATOR,root.getFullPath());
  Assert.assertTrue(root.getChildren().isEmpty());
  root.delete();
  try {
    root.find(null,true);
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  try {
    root.find(new String[0],true);
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  try {
    root.find(null,false);
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  try {
    root.find(new String[0],false);
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  Assert.assertNull(root.find(new String[]{"a"},true));
  Assert.assertNull(root.find(new String[]{"a"},false));
  Assert.assertNull(root.findPrefixEntry(Lists.newArrayList("a")));
  root.delete();
}

</code></pre>

<br>
<pre class="type-7 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleAuthzEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  HMSPaths.Entry prefix=root.createPrefix(Lists.newArrayList("a","b"));
  HMSPaths.Entry e1=root.createAuthzObjPath(Lists.newArrayList("a","b","t","p1"),"A");
  HMSPaths.Entry e2=root.createAuthzObjPath(Lists.newArrayList("a","b","t","p2"),"A");
  Assert.assertEquals(e1,root.find(new String[]{"a","b","t","p1"},true));
  Assert.assertEquals(e1,root.find(new String[]{"a","b","t","p1"},false));
  Assert.assertEquals(e1,root.find(new String[]{"a","b","t","p1","c"},true));
  Assert.assertNull(root.find(new String[]{"a","b","t","p1","c"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p1")));
  Assert.assertEquals(e2,root.find(new String[]{"a","b","t","p2"},true));
  Assert.assertEquals(e2,root.find(new String[]{"a","b","t","p2"},false));
  Assert.assertEquals(e2,root.find(new String[]{"a","b","t","p2","c"},true));
  Assert.assertNull(root.find(new String[]{"a","b","t","p2","c"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p2")));
  root.find(new String[]{"a","b","t","p1"},true).delete();
  Assert.assertNull(root.find(new String[]{"a","b","t","p1"},false));
  root.find(new String[]{"a","b","t","p2"},true).delete();
  Assert.assertNull(root.find(new String[]{"a","b","t","p2"},false));
  Assert.assertNull(root.find(new String[]{"a","b","t"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p3")));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFurtherAuthzEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  HMSPaths.Entry prefix=root.createPrefix(Lists.newArrayList("a","b"));
  HMSPaths.Entry entry=root.createAuthzObjPath(Lists.newArrayList("a","b","t","p1"),"A");
  Assert.assertEquals(prefix,entry.getParent().getParent());
  Assert.assertEquals(HMSPaths.EntryType.AUTHZ_OBJECT,entry.getType());
  Assert.assertEquals("p1",entry.getPathElement());
  Assert.assertTrue(entry.getAuthzObjs().contains("A"));
  Assert.assertEquals(Path.SEPARATOR + "a" + Path.SEPARATOR+ "b"+ Path.SEPARATOR+ "t"+ Path.SEPARATOR+ "p1",entry.getFullPath());
  try {
    root.createPrefix(Lists.newArrayList("a","b","p1","t","c"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  HMSPaths.Entry ep2=root.createAuthzObjPath(Lists.newArrayList("a","b","t","p1","p2"),"A");
  Assert.assertEquals(HMSPaths.EntryType.AUTHZ_OBJECT,entry.getType());
  Assert.assertEquals("p1",entry.getPathElement());
  Assert.assertTrue(entry.getAuthzObjs().contains("A"));
  Assert.assertEquals(HMSPaths.EntryType.AUTHZ_OBJECT,ep2.getType());
  Assert.assertEquals("p2",ep2.getPathElement());
  Assert.assertTrue(entry.getAuthzObjs().contains("A"));
  Assert.assertEquals(entry,root.find(new String[]{"a","b","t","p1"},true));
  Assert.assertEquals(entry,root.find(new String[]{"a","b","t","p1"},false));
  Assert.assertEquals(entry,root.find(new String[]{"a","b","t","p1","c"},true));
  Assert.assertNull(root.find(new String[]{"a","b","t","p1","c"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p1")));
  Assert.assertEquals(ep2,root.find(new String[]{"a","b","t","p1","p2"},true));
  Assert.assertEquals(ep2,root.find(new String[]{"a","b","t","p1","p2"},false));
  Assert.assertEquals(ep2,root.find(new String[]{"a","b","t","p1","p2","c"},true));
  Assert.assertNull(root.find(new String[]{"a","b","t","p1","p2","c"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p1","p2")));
  root.find(new String[]{"a","b","t","p1"},false).delete();
  Assert.assertNull(root.find(new String[]{"a","b","t","p1"},true));
  Assert.assertEquals(HMSPaths.EntryType.DIR,entry.getType());
  Assert.assertEquals(entry.getAuthzObjs().size(),0);
  Assert.assertNull(root.find(new String[]{"a","b","t","p1"},false));
  Assert.assertNull(root.find(new String[]{"a","b","t"},false));
  Assert.assertNull(root.find(new String[]{"a","b"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p1")));
  Assert.assertNotNull(root.find(new String[]{"a","b","t","p1","p2"},false));
  root.find(new String[]{"a","b","t","p1","p2"},false).delete();
  Assert.assertNull(root.find(new String[]{"a","b","t","p1"},false));
  Assert.assertNull(root.find(new String[]{"a","b","t"},false));
  Assert.assertNull(root.find(new String[]{"a","b"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","t","p1")));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImmediateAuthzEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  HMSPaths.Entry prefix=root.createPrefix(Lists.newArrayList("a","b"));
  HMSPaths.Entry entry=root.createAuthzObjPath(Lists.newArrayList("a","b","p1"),"A");
  Assert.assertEquals(prefix,entry.getParent());
  Assert.assertEquals(HMSPaths.EntryType.AUTHZ_OBJECT,entry.getType());
  Assert.assertEquals("p1",entry.getPathElement());
  Assert.assertTrue(entry.getAuthzObjs().contains("A"));
  Assert.assertEquals(Path.SEPARATOR + "a" + Path.SEPARATOR+ "b"+ Path.SEPARATOR+ "p1",entry.getFullPath());
  try {
    root.createPrefix(Lists.newArrayList("a","b","p1","c"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  Assert.assertEquals(entry,root.find(new String[]{"a","b","p1"},true));
  Assert.assertEquals(entry,root.find(new String[]{"a","b","p1"},false));
  Assert.assertEquals(entry,root.find(new String[]{"a","b","p1","c"},true));
  Assert.assertNull(root.find(new String[]{"a","b","p1","c"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","p1")));
  root.find(new String[]{"a","b","p1"},true).delete();
  Assert.assertNull(root.find(new String[]{"a","b","p1"},false));
  Assert.assertNull(root.find(new String[]{"a","b"},false));
  Assert.assertEquals(prefix,root.findPrefixEntry(Lists.newArrayList("a","b","p1")));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImmediatePrefixEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  HMSPaths.Entry entry=root.createPrefix(Lists.newArrayList("a"));
  entry.toString();
  Assert.assertEquals(1,root.getChildren().size());
  Assert.assertEquals(root,entry.getParent());
  Assert.assertEquals(HMSPaths.EntryType.PREFIX,entry.getType());
  Assert.assertEquals("a",entry.getPathElement());
  Assert.assertEquals(0,entry.getAuthzObjs().size());
  Assert.assertEquals(Path.SEPARATOR + "a",entry.getFullPath());
  Assert.assertTrue(entry.getChildren().isEmpty());
  Assert.assertEquals(entry,root.findPrefixEntry(Lists.newArrayList("a")));
  Assert.assertEquals(entry,root.findPrefixEntry(Lists.newArrayList("a","b")));
  Assert.assertNull(root.find(new String[]{"a","b"},false));
  Assert.assertNull(root.find(new String[]{"b"},false));
  Assert.assertNull(root.findPrefixEntry(Lists.newArrayList("b")));
  try {
    root.createPrefix(Lists.newArrayList("a","b"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  try {
    root.createPrefix(Lists.newArrayList("a","b","c"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  entry.delete();
  Assert.assertTrue(root.getChildren().isEmpty());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFurtherPrefixEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  HMSPaths.Entry entry=root.createPrefix(Lists.newArrayList("a","b"));
  entry.toString();
  Assert.assertEquals(1,root.getChildren().size());
  Assert.assertEquals(root,entry.getParent().getParent());
  Assert.assertEquals(HMSPaths.EntryType.PREFIX,entry.getType());
  Assert.assertEquals(HMSPaths.EntryType.DIR,entry.getParent().getType());
  Assert.assertEquals("b",entry.getPathElement());
  Assert.assertEquals("a",entry.getParent().getPathElement());
  Assert.assertTrue(entry.getAuthzObjs().size() == 0);
  Assert.assertTrue(entry.getParent().getAuthzObjs().size() == 0);
  Assert.assertEquals(Path.SEPARATOR + "a" + Path.SEPARATOR+ "b",entry.getFullPath());
  Assert.assertEquals(Path.SEPARATOR + "a",entry.getParent().getFullPath());
  Assert.assertTrue(entry.getChildren().isEmpty());
  Assert.assertEquals(1,entry.getParent().getChildren().size());
  Assert.assertEquals(entry,root.findPrefixEntry(Lists.newArrayList("a","b")));
  Assert.assertNull(root.findPrefixEntry(Lists.newArrayList("a")));
  Assert.assertNull(root.find(new String[]{"a","b","c"},false));
  try {
    root.createPrefix(Lists.newArrayList("a","b"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  try {
    root.createPrefix(Lists.newArrayList("a","b","c"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
  entry.delete();
  Assert.assertTrue(root.getChildren().isEmpty());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRootPrefixEntry(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(true);
  root.toString();
  Assert.assertNull(root.find(new String[]{"a"},true));
  Assert.assertNull(root.find(new String[]{"a"},false));
  Assert.assertEquals(root,root.findPrefixEntry(Lists.newArrayList("a")));
  Assert.assertEquals(root,root.findPrefixEntry(Lists.newArrayList("a","b")));
  try {
    root.createPrefix(Lists.newArrayList("a"));
    Assert.fail();
  }
 catch (  IllegalArgumentException ex) {
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthzObjCaseInsensitive(){
  HMSPaths.Entry root=HMSPaths.Entry.createRoot(false);
  HMSPaths.Entry prefix=root.createPrefix(Lists.newArrayList("a","b"));
  HMSPaths.Entry entry=root.createAuthzObjPath(Lists.newArrayList("a","b","t","p1"),"A");
  Assert.assertEquals(prefix,entry.getParent().getParent());
  Assert.assertEquals(HMSPaths.EntryType.AUTHZ_OBJECT,entry.getType());
  Assert.assertTrue(entry.getAuthzObjs().contains("a"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestHMSPathsFullDump </h4><pre class="type-12 type-7 type-6 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDumpAndInitialize(){
  HMSPaths hmsPaths=new HMSPaths(new String[]{"/user/hive/warehouse","/user/hive/w2"});
  hmsPaths._addAuthzObject("default",Lists.newArrayList("/user/hive/warehouse"));
  hmsPaths._addAuthzObject("db1",Lists.newArrayList("/user/hive/warehouse/db1"));
  hmsPaths._addAuthzObject("db1.tbl11",Lists.newArrayList("/user/hive/warehouse/db1/tbl11"));
  hmsPaths._addPathsToAuthzObject("db1.tbl11",Lists.newArrayList("/user/hive/warehouse/db1/tbl11/part111","/user/hive/warehouse/db1/tbl11/part112","/user/hive/warehouse/db1/tbl11/p1=1/p2=x"));
  hmsPaths._addAuthzObject("db2",Lists.newArrayList("/user/hive/w2/db2"));
  hmsPaths._addAuthzObject("db2.tbl21",Lists.newArrayList("/user/hive/w2/db2/tbl21"));
  hmsPaths._addPathsToAuthzObject("db2.tbl21",Lists.newArrayList("/user/hive/w2/db2/tbl21/p1=1/p2=x"));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("default")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse","db1"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11","part111"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11","part112"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11","p1=1","p2=x"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11","p1=1"},true));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db2.tbl21")),hmsPaths.findAuthzObject(new String[]{"user","hive","w2","db2","tbl21","p1=1"},true));
  HMSPathsDumper serDe=hmsPaths.getPathsDump();
  TPathsDump pathsDump=serDe.createPathsDump();
  HMSPaths hmsPaths2=new HMSPaths(new String[]{"/user/hive/warehouse"}).getPathsDump().initializeFromDump(pathsDump);
  Assert.assertEquals(new HashSet<String>(Arrays.asList("default")),hmsPaths2.findAuthzObject(new String[]{"user","hive","warehouse"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1")),hmsPaths2.findAuthzObject(new String[]{"user","hive","warehouse","db1"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths2.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths2.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11","part111"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1.tbl11")),hmsPaths2.findAuthzObject(new String[]{"user","hive","warehouse","db1","tbl11","part112"},false));
  Assert.assertNull(hmsPaths2.findAuthzObject(new String[]{"user","hive","w2","db2","tbl21","p1=1"},true));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThrftSerialization() throws TException {
  HMSPathsDumper serDe=genHMSPathsDumper();
  long t1=System.currentTimeMillis();
  TPathsDump pathsDump=serDe.createPathsDump();
  TProtocolFactory protoFactory=useCompact ? new TCompactProtocol.Factory(ServiceConstants.ClientConfig.SENTRY_HDFS_THRIFT_MAX_MESSAGE_SIZE_DEFAULT,ServiceConstants.ClientConfig.SENTRY_HDFS_THRIFT_MAX_MESSAGE_SIZE_DEFAULT) : new TBinaryProtocol.Factory(true,true,ServiceConstants.ClientConfig.SENTRY_HDFS_THRIFT_MAX_MESSAGE_SIZE_DEFAULT,ServiceConstants.ClientConfig.SENTRY_HDFS_THRIFT_MAX_MESSAGE_SIZE_DEFAULT);
  byte[] ser=new TSerializer(protoFactory).serialize(pathsDump);
  long serTime=System.currentTimeMillis() - t1;
  System.out.println("Serialization Time: " + serTime + ", "+ ser.length);
  t1=System.currentTimeMillis();
  TPathsDump tPathsDump=new TPathsDump();
  new TDeserializer(protoFactory).deserialize(tPathsDump,ser);
  HMSPaths fromDump=serDe.initializeFromDump(tPathsDump);
  System.out.println("Deserialization Time: " + (System.currentTimeMillis() - t1));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db9.tbl999")),fromDump.findAuthzObject(new String[]{"user","hive","warehouse","db9","tbl999"},false));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db9.tbl999")),fromDump.findAuthzObject(new String[]{"user","hive","warehouse","db9","tbl999","part99"},false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestMetastoreCacheInitializer </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInitializer() throws Exception {
  Database db1=Mockito.mock(Database.class);
  Mockito.when(db1.getName()).thenReturn("db1");
  Mockito.when(db1.getLocationUri()).thenReturn("hdfs:///db1");
  Database db2=Mockito.mock(Database.class);
  Mockito.when(db2.getName()).thenReturn("db2");
  Mockito.when(db2.getLocationUri()).thenReturn("hdfs:///db2");
  Database db3=Mockito.mock(Database.class);
  Mockito.when(db3.getName()).thenReturn("db3");
  Mockito.when(db3.getLocationUri()).thenReturn("hdfs:///db3");
  Table tab21=Mockito.mock(Table.class);
  Mockito.when(tab21.getDbName()).thenReturn("db2");
  Mockito.when(tab21.getTableName()).thenReturn("tab21");
  StorageDescriptor sd21=Mockito.mock(StorageDescriptor.class);
  Mockito.when(sd21.getLocation()).thenReturn("hdfs:///db2/tab21");
  Mockito.when(tab21.getSd()).thenReturn(sd21);
  Table tab31=Mockito.mock(Table.class);
  Mockito.when(tab31.getDbName()).thenReturn("db3");
  Mockito.when(tab31.getTableName()).thenReturn("tab31");
  StorageDescriptor sd31=Mockito.mock(StorageDescriptor.class);
  Mockito.when(sd31.getLocation()).thenReturn("hdfs:///db3/tab31");
  Mockito.when(tab31.getSd()).thenReturn(sd31);
  Partition part311=Mockito.mock(Partition.class);
  StorageDescriptor sd311=Mockito.mock(StorageDescriptor.class);
  Mockito.when(sd311.getLocation()).thenReturn("hdfs:///db3/tab31/part311");
  Mockito.when(part311.getSd()).thenReturn(sd311);
  Partition part312=Mockito.mock(Partition.class);
  StorageDescriptor sd312=Mockito.mock(StorageDescriptor.class);
  Mockito.when(sd312.getLocation()).thenReturn("hdfs:///db3/tab31/part312");
  Mockito.when(part312.getSd()).thenReturn(sd312);
  IHMSHandler hmsHandler=Mockito.mock(IHMSHandler.class);
  Mockito.when(hmsHandler.get_all_databases()).thenReturn(Lists.newArrayList("db1","db2","db3"));
  Mockito.when(hmsHandler.get_database("db1")).thenReturn(db1);
  Mockito.when(hmsHandler.get_all_tables("db1")).thenReturn(new ArrayList<String>());
  Mockito.when(hmsHandler.get_database("db2")).thenReturn(db2);
  Mockito.when(hmsHandler.get_all_tables("db2")).thenReturn(Lists.newArrayList("tab21"));
  Mockito.when(hmsHandler.get_table_objects_by_name("db2",Lists.newArrayList("tab21"))).thenReturn(Lists.newArrayList(tab21));
  Mockito.when(hmsHandler.get_partition_names("db2","tab21",(short)-1)).thenReturn(new ArrayList<String>());
  Mockito.when(hmsHandler.get_database("db3")).thenReturn(db3);
  Mockito.when(hmsHandler.get_all_tables("db3")).thenReturn(Lists.newArrayList("tab31"));
  Mockito.when(hmsHandler.get_table_objects_by_name("db3",Lists.newArrayList("tab31"))).thenReturn(Lists.newArrayList(tab31));
  Mockito.when(hmsHandler.get_partition_names("db3","tab31",(short)-1)).thenReturn(Lists.newArrayList("part311","part312"));
  Mockito.when(hmsHandler.get_partitions_by_names("db3","tab31",Lists.newArrayList("part311"))).thenReturn(Lists.newArrayList(part311));
  Mockito.when(hmsHandler.get_partitions_by_names("db3","tab31",Lists.newArrayList("part312"))).thenReturn(Lists.newArrayList(part312));
  Configuration conf=new Configuration();
  conf.setInt(ServiceConstants.ServerConfig.SENTRY_HDFS_SYNC_METASTORE_CACHE_MAX_PART_PER_RPC,1);
  conf.setInt(ServiceConstants.ServerConfig.SENTRY_HDFS_SYNC_METASTORE_CACHE_MAX_TABLES_PER_RPC,1);
  conf.setInt(ServiceConstants.ServerConfig.SENTRY_HDFS_SYNC_METASTORE_CACHE_INIT_THREADS,1);
  MetastoreCacheInitializer cacheInitializer=new MetastoreCacheInitializer(hmsHandler,conf);
  UpdateableAuthzPaths update=cacheInitializer.createInitialUpdate();
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db1")),update.findAuthzObjectExactMatches(new String[]{"db1"}));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db2")),update.findAuthzObjectExactMatches(new String[]{"db2"}));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db2.tab21")),update.findAuthzObjectExactMatches(new String[]{"db2","tab21"}));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db3")),update.findAuthzObjectExactMatches(new String[]{"db3"}));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db3.tab31")),update.findAuthzObjectExactMatches(new String[]{"db3","tab31"}));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db3.tab31")),update.findAuthzObjectExactMatches(new String[]{"db3","tab31","part311"}));
  Assert.assertEquals(new HashSet<String>(Arrays.asList("db3.tab31")),update.findAuthzObjectExactMatches(new String[]{"db3","tab31","part312"}));
  cacheInitializer.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestPluginCacheSync </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Post a dummy update to PluginCacheSync. Verify that the update is received
 * by cache via ZK sync
 * @throws Exception
 */
@Test public void testCachePost() throws Exception {
  TestCacheListener cacheListener=new TestCacheListener();
  pluginCache=new PluginCacheSyncUtil(TEST_ZPATH,conf,cacheListener);
  DummyUpdate dummyUpdate=new DummyUpdate();
  dummyUpdate.setState("foo");
  pluginCache.handleCacheUpdate(dummyUpdate);
  int timeLeft=5000;
  while (!cacheListener.isRecievedEvent() && (timeLeft > 0)) {
    Thread.sleep(200);
    timeLeft-=200;
  }
  cacheListener.setRecievedEvent(false);
  DummyUpdate newUpdate=cacheListener.getDummyUpdate();
  assertEquals(dummyUpdate.getState(),newUpdate.getState());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void pluginCacheGC() throws Exception {
  pluginCache=new PluginCacheSyncUtil(TEST_ZPATH,conf,new TestCacheListener());
  for (int updCount=1; updCount <= PluginCacheSyncUtil.CACHE_GC_SIZE_THRESHOLD_HWM + 2; updCount++) {
    DummyUpdate dummyUpdate=new DummyUpdate();
    dummyUpdate.setSeqNum(updCount);
    dummyUpdate.setState("foo");
    pluginCache.handleCacheUpdate(dummyUpdate);
  }
  pluginCache.gcPluginCache(conf);
  HAContext haContext=HAContext.getHAContext(conf);
  List<String> znodeList=haContext.getCuratorFramework().getChildren().forPath(TEST_ZPATH + "/cache");
  assertFalse(znodeList.isEmpty());
  assertFalse(znodeList.contains(String.valueOf(PluginCacheSyncUtil.GC_COUNTER_INIT_VALUE)));
  assertFalse(znodeList.contains(String.valueOf(PluginCacheSyncUtil.GC_COUNTER_INIT_VALUE + 1)));
  assertTrue(znodeList.contains(String.valueOf(PluginCacheSyncUtil.CACHE_GC_SIZE_THRESHOLD_HWM)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestSentryAuthorizationProvider </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProvider() throws Exception {
  admin.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      String sysUser=UserGroupInformation.getCurrentUser().getShortUserName();
      FileSystem fs=FileSystem.get(miniDFS.getConfiguration(0));
      List<AclEntry> baseAclList=new ArrayList<AclEntry>();
      AclEntry.Builder builder=new AclEntry.Builder();
      baseAclList.add(builder.setType(AclEntryType.USER).setScope(AclEntryScope.ACCESS).build());
      baseAclList.add(builder.setType(AclEntryType.GROUP).setScope(AclEntryScope.ACCESS).build());
      baseAclList.add(builder.setType(AclEntryType.OTHER).setScope(AclEntryScope.ACCESS).build());
      Path path1=new Path("/user/authz/obj/xxx");
      fs.mkdirs(path1);
      fs.setAcl(path1,baseAclList);
      fs.mkdirs(new Path("/user/authz/xxx"));
      fs.mkdirs(new Path("/user/xxx"));
      Path path=new Path("/");
      Assert.assertEquals(sysUser,fs.getFileStatus(path).getOwner());
      Assert.assertEquals("supergroup",fs.getFileStatus(path).getGroup());
      Assert.assertEquals(new FsPermission((short)0755),fs.getFileStatus(path).getPermission());
      Assert.assertTrue(fs.getAclStatus(path).getEntries().isEmpty());
      path=new Path("/user");
      Assert.assertEquals(sysUser,fs.getFileStatus(path).getOwner());
      Assert.assertEquals("supergroup",fs.getFileStatus(path).getGroup());
      Assert.assertEquals(new FsPermission((short)0755),fs.getFileStatus(path).getPermission());
      Assert.assertTrue(fs.getAclStatus(path).getEntries().isEmpty());
      path=new Path("/user/authz");
      Assert.assertEquals(sysUser,fs.getFileStatus(path).getOwner());
      Assert.assertEquals("supergroup",fs.getFileStatus(path).getGroup());
      Assert.assertEquals(new FsPermission((short)0755),fs.getFileStatus(path).getPermission());
      Assert.assertTrue(fs.getAclStatus(path).getEntries().isEmpty());
      path=new Path("/user/authz/xxx");
      FileStatus status=fs.getFileStatus(path);
      Assert.assertEquals(sysUser,status.getOwner());
      Assert.assertEquals("supergroup",status.getGroup());
      Assert.assertEquals(new FsPermission((short)0755),status.getPermission());
      Assert.assertTrue(fs.getAclStatus(path).getEntries().isEmpty());
      path=new Path("/user/authz/obj");
      Assert.assertEquals("hive",fs.getFileStatus(path).getOwner());
      Assert.assertEquals("hive",fs.getFileStatus(path).getGroup());
      Assert.assertEquals(new FsPermission((short)0771),fs.getFileStatus(path).getPermission());
      Assert.assertFalse(fs.getAclStatus(path).getEntries().isEmpty());
      List<AclEntry> acls=new ArrayList<AclEntry>();
      acls.add(new AclEntry.Builder().setName(sysUser).setType(AclEntryType.USER).setScope(AclEntryScope.ACCESS).setPermission(FsAction.ALL).build());
      acls.add(new AclEntry.Builder().setName("supergroup").setType(AclEntryType.GROUP).setScope(AclEntryScope.ACCESS).setPermission(FsAction.READ_EXECUTE).build());
      acls.add(new AclEntry.Builder().setName("user-authz").setType(AclEntryType.USER).setScope(AclEntryScope.ACCESS).setPermission(FsAction.ALL).build());
      Assert.assertEquals(new LinkedHashSet<AclEntry>(acls),new LinkedHashSet<AclEntry>(fs.getAclStatus(path).getEntries()));
      path=new Path("/user/authz/obj/xxx");
      Assert.assertEquals("hive",fs.getFileStatus(path).getOwner());
      Assert.assertEquals("hive",fs.getFileStatus(path).getGroup());
      Assert.assertEquals(new FsPermission((short)0771),fs.getFileStatus(path).getPermission());
      Assert.assertFalse(fs.getAclStatus(path).getEntries().isEmpty());
      Path path2=new Path("/user/authz/obj/path2");
      fs.mkdirs(path2);
      fs.setAcl(path2,baseAclList);
      path=new Path("/user/xxx");
      Assert.assertEquals(sysUser,fs.getFileStatus(path).getOwner());
      Assert.assertEquals("supergroup",fs.getFileStatus(path).getGroup());
      Assert.assertEquals(new FsPermission((short)0755),fs.getFileStatus(path).getPermission());
      Assert.assertTrue(fs.getAclStatus(path).getEntries().isEmpty());
      System.setProperty("test.stale","true");
      path=new Path("/user/authz/xxx");
      status=fs.getFileStatus(path);
      Assert.assertEquals(sysUser,status.getOwner());
      Assert.assertEquals("supergroup",status.getGroup());
      Assert.assertEquals(new FsPermission((short)0755),status.getPermission());
      Assert.assertTrue(fs.getAclStatus(path).getEntries().isEmpty());
      Path pathOutside=new Path("/user/xxx");
      fs.setPermission(pathOutside,new FsPermission((short)0000));
      Assert.assertEquals(new FsPermission((short)0000),fs.getFileStatus(pathOutside).getPermission());
      fs.setOwner(pathOutside,sysUser,"supergroup");
      Assert.assertEquals(sysUser,fs.getFileStatus(pathOutside).getOwner());
      Assert.assertEquals("supergroup",fs.getFileStatus(pathOutside).getGroup());
      List<AclEntry> aclsOutside=new ArrayList<AclEntry>(baseAclList);
      List<AclEntry> acl=new ArrayList<AclEntry>();
      acl.add(new AclEntry.Builder().setName("supergroup").setType(AclEntryType.GROUP).setScope(AclEntryScope.ACCESS).setPermission(FsAction.READ_EXECUTE).build());
      aclsOutside.addAll(acl);
      fs.setAcl(pathOutside,aclsOutside);
      fs.removeAclEntries(pathOutside,acl);
      Assert.assertFalse(fs.getAclStatus(pathOutside).getEntries().containsAll(acl));
      Path pathInside=new Path("/user/authz/xxx");
      fs.setPermission(pathInside,new FsPermission((short)0000));
      Assert.assertEquals(new FsPermission((short)0000),fs.getFileStatus(pathInside).getPermission());
      fs.setOwner(pathInside,sysUser,"supergroup");
      Assert.assertEquals(sysUser,fs.getFileStatus(pathInside).getOwner());
      Assert.assertEquals("supergroup",fs.getFileStatus(pathInside).getGroup());
      Assert.assertTrue(fs.getAclStatus(pathInside).getEntries().isEmpty());
      fs.removeAclEntries(pathInside,acl);
      Assert.assertTrue(fs.getAclStatus(pathInside).getEntries().isEmpty());
      Path pathInsideAndHive=new Path("/user/authz/obj");
      fs.setPermission(pathInsideAndHive,new FsPermission((short)0000));
      Assert.assertEquals(new FsPermission((short)0771),fs.getFileStatus(pathInsideAndHive).getPermission());
      fs.setOwner(pathInsideAndHive,sysUser,"supergroup");
      Assert.assertEquals("hive",fs.getFileStatus(pathInsideAndHive).getOwner());
      Assert.assertEquals("hive",fs.getFileStatus(pathInsideAndHive).getGroup());
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestSentryPermissions </h4><pre class="type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testRoleInfoCaseInsensitive(){
  SentryPermissions perm=new SentryPermissions();
  SentryPermissions.RoleInfo roleInfo=new SentryPermissions.RoleInfo("Admin");
  perm.addRoleInfo(roleInfo);
  Assert.assertNotNull(perm.getRoleInfo("admin"));
  Assert.assertNull(perm.getRoleInfo("doesNotExist"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestUpdateForwarder </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetUpdates() throws Exception {
  DummyImageRetreiver imageRetreiver=new DummyImageRetreiver();
  imageRetreiver.setState("a,b,c");
  updateForwarder=UpdateForwarder.create(testConf,new DummyUpdatable(),new DummyUpdate(),imageRetreiver,5);
  updateForwarder.handleUpdateNotification(new DummyUpdate(5,false).setState("d"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(5,updateForwarder.getLastUpdatedSeqNum());
  List<DummyUpdate> allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(2,allUpdates.size());
  updateForwarder.handleUpdateNotification(new DummyUpdate(6,false).setState("e"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(7,false).setState("f"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(7,updateForwarder.getLastUpdatedSeqNum());
  allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(4,allUpdates.size());
  Assert.assertEquals("a,b,c",allUpdates.get(0).getState());
  Assert.assertEquals(4,allUpdates.get(0).getSeqNum());
  Assert.assertEquals("d",allUpdates.get(1).getState());
  Assert.assertEquals(5,allUpdates.get(1).getSeqNum());
  Assert.assertEquals("e",allUpdates.get(2).getState());
  Assert.assertEquals(6,allUpdates.get(2).getSeqNum());
  Assert.assertEquals("f",allUpdates.get(3).getState());
  Assert.assertEquals(7,allUpdates.get(3).getSeqNum());
  updateForwarder.handleUpdateNotification(new DummyUpdate(8,false).setState("g"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(8,updateForwarder.getLastUpdatedSeqNum());
  allUpdates=updateForwarder.getAllUpdatesFrom(8);
  Assert.assertEquals(1,allUpdates.size());
  Assert.assertEquals("g",allUpdates.get(0).getState());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-14 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateReceiveWithNullImageRetriver() throws Exception {
  Assume.assumeTrue(!testConf.getBoolean(ServerConfig.SENTRY_HA_ENABLED,false));
  updateForwarder=UpdateForwarder.create(testConf,new DummyUpdatable(),new DummyUpdate(),null,5);
  updateForwarder.handleUpdateNotification(new DummyUpdate(-1,true).setState("a"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  List<DummyUpdate> allUpdates=updateForwarder.getAllUpdatesFrom(1);
  Assert.assertEquals("a",allUpdates.get(0).getState());
  updateForwarder.handleUpdateNotification(new DummyUpdate(6,false).setState("b"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  updateForwarder.handleUpdateNotification(new DummyUpdate(7,false).setState("c"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(7,updateForwarder.getLastUpdatedSeqNum());
  allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(2,allUpdates.size());
  Assert.assertEquals("b",allUpdates.get(0).getState());
  Assert.assertEquals("c",allUpdates.get(1).getState());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateReceive() throws Exception {
  DummyImageRetreiver imageRetreiver=new DummyImageRetreiver();
  imageRetreiver.setState("a,b,c");
  updateForwarder=UpdateForwarder.create(testConf,new DummyUpdatable(),new DummyUpdate(),imageRetreiver,5);
  updateForwarder.handleUpdateNotification(new DummyUpdate(5,false).setState("d"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(5,updateForwarder.getLastUpdatedSeqNum());
  List<DummyUpdate> allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(2,allUpdates.size());
  Assert.assertEquals("a,b,c",allUpdates.get(0).getState());
  Assert.assertEquals("d",allUpdates.get(1).getState());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateLogCompression() throws Exception {
  DummyImageRetreiver imageRetreiver=new DummyImageRetreiver();
  imageRetreiver.setState("a,b,c");
  updateForwarder=UpdateForwarder.create(testConf,new DummyUpdatable(),new DummyUpdate(),imageRetreiver,5);
  updateForwarder.handleUpdateNotification(new DummyUpdate(5,false).setState("d"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(5,updateForwarder.getLastUpdatedSeqNum());
  List<DummyUpdate> allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(2,allUpdates.size());
  updateForwarder.handleUpdateNotification(new DummyUpdate(6,false).setState("e"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(7,false).setState("f"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(8,false).setState("g"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(9,false).setState("h"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(10,false).setState("i"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(11,false).setState("j"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(11,updateForwarder.getLastUpdatedSeqNum());
  allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(3,allUpdates.size());
  Assert.assertEquals("a,b,c,d,e,f,g,h",allUpdates.get(0).getState());
  Assert.assertEquals(9,allUpdates.get(0).getSeqNum());
  Assert.assertEquals("i",allUpdates.get(1).getState());
  Assert.assertEquals(10,allUpdates.get(1).getSeqNum());
  Assert.assertEquals("j",allUpdates.get(2).getState());
  Assert.assertEquals(11,allUpdates.get(2).getSeqNum());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInit() throws Exception {
  DummyImageRetreiver imageRetreiver=new DummyImageRetreiver();
  imageRetreiver.setState("a,b,c");
  updateForwarder=UpdateForwarder.create(testConf,new DummyUpdatable(),new DummyUpdate(),imageRetreiver,10);
  Assert.assertEquals(-2,updateForwarder.getLastUpdatedSeqNum());
  List<DummyUpdate> allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertTrue(allUpdates.size() == 1);
  Assert.assertEquals("a,b,c",allUpdates.get(0).getState());
  allUpdates=updateForwarder.getAllUpdatesFrom(100);
  Assert.assertTrue(allUpdates.size() == 1);
  Assert.assertEquals("a,b,c",allUpdates.get(0).getState());
  Assert.assertEquals(-2,allUpdates.get(0).getSeqNum());
  allUpdates=updateForwarder.getAllUpdatesFrom(-1);
  Assert.assertEquals(0,allUpdates.size());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-14 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUpdatesAfterExternalEntityReset() throws Exception {
  Assume.assumeTrue(!testConf.getBoolean(ServerConfig.SENTRY_HA_ENABLED,false));
  DummyImageRetreiver imageRetreiver=new DummyImageRetreiver();
  imageRetreiver.setState("a,b,c");
  updateForwarder=UpdateForwarder.create(testConf,new DummyUpdatable(),new DummyUpdate(),imageRetreiver,5);
  updateForwarder.handleUpdateNotification(new DummyUpdate(5,false).setState("d"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  updateForwarder.handleUpdateNotification(new DummyUpdate(6,false).setState("e"));
  updateForwarder.handleUpdateNotification(new DummyUpdate(7,false).setState("f"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(7,updateForwarder.getLastUpdatedSeqNum());
  List<DummyUpdate> allUpdates=updateForwarder.getAllUpdatesFrom(0);
  Assert.assertEquals(4,allUpdates.size());
  Assert.assertEquals("f",allUpdates.get(3).getState());
  Assert.assertEquals(7,allUpdates.get(3).getSeqNum());
  updateForwarder.handleUpdateNotification(new DummyUpdate(8,false).setState("g"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  Assert.assertEquals(8,updateForwarder.getLastUpdatedSeqNum());
  allUpdates=updateForwarder.getAllUpdatesFrom(8);
  Assert.assertEquals(1,allUpdates.size());
  Assert.assertEquals("g",allUpdates.get(0).getState());
  imageRetreiver.setState("a,b,c,d,e,f,g,h");
  updateForwarder.handleUpdateNotification(new DummyUpdate(1,false).setState("h"));
  while (!updateForwarder.areAllUpdatesCommited()) {
    Thread.sleep(100);
  }
  allUpdates=updateForwarder.getAllUpdatesFrom(9);
  Assert.assertEquals(1,allUpdates.size());
  Assert.assertEquals("a,b,c,d,e,f,g,h",allUpdates.get(0).getState());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.hdfs.TestUpdateableAuthzPaths </h4><pre class="type-7 type-10 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFullUpdate(){
  HMSPaths hmsPaths=createBaseHMSPaths(1,1);
  assertTrue(hmsPaths.findAuthzObjectExactMatches(new String[]{"db1"}).contains("db1"));
  assertTrue(hmsPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11"}).contains("db1.tbl11"));
  assertTrue(hmsPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part111"}).contains("db1.tbl11"));
  assertTrue(hmsPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part112"}).contains("db1.tbl11"));
  UpdateableAuthzPaths authzPaths=new UpdateableAuthzPaths(hmsPaths);
  PathsUpdate update=new PathsUpdate(1,true);
  update.toThrift().setPathsDump(authzPaths.getPathsDump().createPathsDump());
  UpdateableAuthzPaths authzPaths2=new UpdateableAuthzPaths(new String[]{"/"});
  UpdateableAuthzPaths pre=authzPaths2.updateFull(update);
  assertFalse(pre == authzPaths2);
  authzPaths2=pre;
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db1"}).contains("db1"));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db1","tbl11"}).contains("db1.tbl11"));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part111"}).contains("db1.tbl11"));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part112"}).contains("db1.tbl11"));
  UpdateableAuthzPaths authzPaths3=new UpdateableAuthzPaths(createBaseHMSPaths(2,1));
  update=new PathsUpdate(2,true);
  update.toThrift().setPathsDump(authzPaths3.getPathsDump().createPathsDump());
  pre=authzPaths2.updateFull(update);
  assertFalse(pre == authzPaths2);
  authzPaths2=pre;
  assertNull(authzPaths2.findAuthzObjectExactMatches(new String[]{"db1"}));
  assertNull(authzPaths2.findAuthzObjectExactMatches(new String[]{"db1","tbl11"}));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db2"}).contains("db2"));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db2","tbl21"}).contains("db2.tbl21"));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db2","tbl21","part211"}).contains("db2.tbl21"));
  assertTrue(authzPaths2.findAuthzObjectExactMatches(new String[]{"db2","tbl21","part212"}).contains("db2.tbl21"));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultDbPath(){
  HMSPaths hmsPaths=new HMSPaths(new String[]{"/user/hive/warehouse"});
  hmsPaths._addAuthzObject("default",Lists.newArrayList("/user/hive/warehouse"));
  assertTrue(hmsPaths.findAuthzObject(new String[]{"user","hive","warehouse"}).contains("default"));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialUpdateAddPath(){
  HMSPaths hmsPaths=createBaseHMSPaths(1,1);
  UpdateableAuthzPaths authzPaths=new UpdateableAuthzPaths(hmsPaths);
  ReentrantReadWriteLock lock=new ReentrantReadWriteLock();
  PathsUpdate update=new PathsUpdate(2,false);
  TPathChanges pathChange=update.newPathChange("db1.tbl12");
  pathChange.addToAddPaths(PathsUpdate.parsePath("hdfs:///db1/tbl12"));
  authzPaths.updatePartial(Lists.newArrayList(update),lock);
  update=new PathsUpdate(3,false);
  pathChange=update.newPathChange("db1.tbl12");
  pathChange.addToAddPaths(PathsUpdate.parsePath("hdfs:///db1/tbl12/part121"));
  authzPaths.updatePartial(Lists.newArrayList(update),lock);
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1"}).contains("db1"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11"}).contains("db1.tbl11"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part111"}).contains("db1.tbl11"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part112"}).contains("db1.tbl11"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl12"}).contains("db1.tbl12"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl12","part121"}).contains("db1.tbl12"));
  update=new PathsUpdate(4,false);
  update.newPathChange("db1.xtbl11").addToAddPaths(PathsUpdate.parsePath("hdfs:///db1/xtbl11"));
  update.newPathChange("db1.tbl11").addToDelPaths(PathsUpdate.parsePath("hdfs:///db1/tbl11"));
  authzPaths.updatePartial(Lists.newArrayList(update),lock);
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1"}).contains("db1"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","xtbl11"}).contains("db1.xtbl11"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part111"}).contains("db1.xtbl11"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part112"}).contains("db1.xtbl11"));
  assertNull(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","xtbl12"}));
  assertNull(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","xtbl12","part121"}));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl12"}).contains("db1.tbl12"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl12","part121"}).contains("db1.tbl12"));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialUpdateDelPath(){
  HMSPaths hmsPaths=createBaseHMSPaths(1,1);
  UpdateableAuthzPaths authzPaths=new UpdateableAuthzPaths(hmsPaths);
  ReentrantReadWriteLock lock=new ReentrantReadWriteLock();
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11"}).contains("db1.tbl11"));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part111"}).contains("db1.tbl11"));
  PathsUpdate update=new PathsUpdate(2,false);
  TPathChanges pathChange=update.newPathChange("db1.tbl11");
  pathChange.addToDelPaths(PathsUpdate.parsePath("hdfs:///db1/tbl11/part111"));
  authzPaths.updatePartial(Lists.newArrayList(update),lock);
  assertNull(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part111"}));
  assertTrue(authzPaths.findAuthzObjectExactMatches(new String[]{"db1","tbl11","part112"}).contains("db1.tbl11"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.common.TestKeyValue </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWithSeparators() throws Exception {
  KeyValue kv=new KeyValue("URI=/u/h/w/t/partition=value/");
  assertEquals("URI",kv.getKey());
  assertEquals("/u/h/w/t/partition=value/",kv.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.db.TestDBWildcardPrivilege </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testOther() throws Exception {
  assertFalse(ROLE_SERVER_ALL_DB_ALL.implies(REQUEST_SERVER1_OTHER));
  assertFalse(REQUEST_SERVER1_OTHER.implies(ROLE_SERVER_ALL_DB_ALL));
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnexpected() throws Exception {
  Privilege p=new Privilege(){
    @Override public boolean implies(    Privilege p){
      return false;
    }
  }
;
  assertFalse(ROLE_SERVER_SERVER1_DB_ALL.implies(null));
  assertFalse(ROLE_SERVER_SERVER1_DB_ALL.implies(p));
  assertFalse(ROLE_SERVER_SERVER1_DB_ALL.equals(null));
  assertFalse(ROLE_SERVER_SERVER1_DB_ALL.equals(p));
  assertEquals(ROLE_SERVER_SERVER1_DB_ALL.hashCode(),create(ROLE_SERVER_SERVER1_DB_ALL.toString()).hashCode());
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleShorterThanRequest() throws Exception {
  assertTrue(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER1_DB1));
  assertTrue(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER1_DB2));
  assertFalse(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER2_DB1));
  assertFalse(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER2_DB2));
  assertTrue(ROLE_SERVER_ALL_DB_ALL.implies(REQUEST_SERVER1));
  assertFalse(ROLE_SERVER_ALL_DB_DB1.implies(REQUEST_SERVER1));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRolesAndRequests() throws Exception {
  assertTrue(ROLE_SERVER_SERVER1_DB_ALL.implies(REQUEST_SERVER1_DB1));
  assertFalse(ROLE_SERVER_SERVER1_DB_ALL.implies(REQUEST_SERVER2_DB1));
  assertTrue(ROLE_SERVER_SERVER1_DB_ALL.implies(REQUEST_SERVER1_DB2));
  assertFalse(ROLE_SERVER_SERVER1_DB_ALL.implies(REQUEST_SERVER2_DB2));
  assertTrue(REQUEST_SERVER1_DB1.implies(ROLE_SERVER_SERVER1_DB_ALL));
  assertFalse(REQUEST_SERVER2_DB1.implies(ROLE_SERVER_SERVER1_DB_ALL));
  assertTrue(REQUEST_SERVER1_DB2.implies(ROLE_SERVER_SERVER1_DB_ALL));
  assertFalse(REQUEST_SERVER2_DB2.implies(ROLE_SERVER_SERVER1_DB_ALL));
  assertTrue(ROLE_SERVER_SERVER1_DB_DB1.implies(REQUEST_SERVER1_DB1));
  assertFalse(ROLE_SERVER_SERVER1_DB_DB1.implies(REQUEST_SERVER2_DB1));
  assertFalse(ROLE_SERVER_SERVER1_DB_DB1.implies(REQUEST_SERVER1_DB2));
  assertFalse(ROLE_SERVER_SERVER1_DB_DB1.implies(REQUEST_SERVER2_DB2));
  assertTrue(REQUEST_SERVER1_DB1.implies(ROLE_SERVER_SERVER1_DB_DB1));
  assertFalse(REQUEST_SERVER2_DB1.implies(ROLE_SERVER_SERVER1_DB_DB1));
  assertFalse(REQUEST_SERVER1_DB2.implies(ROLE_SERVER_SERVER1_DB_DB1));
  assertFalse(REQUEST_SERVER2_DB2.implies(ROLE_SERVER_SERVER1_DB_DB1));
  assertFalse(ROLE_SERVER_SERVER2_DB_ALL.implies(REQUEST_SERVER1_DB1));
  assertTrue(ROLE_SERVER_SERVER2_DB_ALL.implies(REQUEST_SERVER2_DB1));
  assertFalse(ROLE_SERVER_SERVER2_DB_ALL.implies(REQUEST_SERVER1_DB2));
  assertTrue(ROLE_SERVER_SERVER2_DB_ALL.implies(REQUEST_SERVER2_DB2));
  assertFalse(REQUEST_SERVER1_DB1.implies(ROLE_SERVER_SERVER2_DB_ALL));
  assertTrue(REQUEST_SERVER2_DB1.implies(ROLE_SERVER_SERVER2_DB_ALL));
  assertFalse(REQUEST_SERVER1_DB2.implies(ROLE_SERVER_SERVER2_DB_ALL));
  assertTrue(REQUEST_SERVER2_DB2.implies(ROLE_SERVER_SERVER2_DB_ALL));
  assertFalse(ROLE_SERVER_SERVER2_DB_DB1.implies(REQUEST_SERVER1_DB1));
  assertTrue(ROLE_SERVER_SERVER2_DB_DB1.implies(REQUEST_SERVER2_DB1));
  assertFalse(ROLE_SERVER_SERVER2_DB_DB1.implies(REQUEST_SERVER1_DB2));
  assertFalse(ROLE_SERVER_SERVER2_DB_DB1.implies(REQUEST_SERVER2_DB2));
  assertFalse(REQUEST_SERVER1_DB1.implies(ROLE_SERVER_SERVER2_DB_DB1));
  assertTrue(REQUEST_SERVER2_DB1.implies(ROLE_SERVER_SERVER2_DB_DB1));
  assertFalse(REQUEST_SERVER1_DB2.implies(ROLE_SERVER_SERVER2_DB_DB1));
  assertFalse(REQUEST_SERVER2_DB2.implies(ROLE_SERVER_SERVER2_DB_DB1));
  assertTrue(ROLE_SERVER_ALL_DB_ALL.implies(REQUEST_SERVER1_DB1));
  assertTrue(ROLE_SERVER_ALL_DB_ALL.implies(REQUEST_SERVER2_DB1));
  assertTrue(ROLE_SERVER_ALL_DB_ALL.implies(REQUEST_SERVER1_DB2));
  assertTrue(ROLE_SERVER_ALL_DB_ALL.implies(REQUEST_SERVER2_DB2));
  assertTrue(REQUEST_SERVER1_DB1.implies(ROLE_SERVER_ALL_DB_ALL));
  assertTrue(REQUEST_SERVER2_DB1.implies(ROLE_SERVER_ALL_DB_ALL));
  assertTrue(REQUEST_SERVER1_DB2.implies(ROLE_SERVER_ALL_DB_ALL));
  assertTrue(REQUEST_SERVER2_DB2.implies(ROLE_SERVER_ALL_DB_ALL));
  assertTrue(ROLE_SERVER_ALL_DB_DB1.implies(REQUEST_SERVER1_DB1));
  assertTrue(ROLE_SERVER_ALL_DB_DB1.implies(REQUEST_SERVER2_DB1));
  assertFalse(ROLE_SERVER_ALL_DB_DB1.implies(REQUEST_SERVER1_DB2));
  assertFalse(ROLE_SERVER_ALL_DB_DB1.implies(REQUEST_SERVER2_DB2));
  assertTrue(REQUEST_SERVER1_DB1.implies(ROLE_SERVER_ALL_DB_DB1));
  assertTrue(REQUEST_SERVER2_DB1.implies(ROLE_SERVER_ALL_DB_DB1));
  assertFalse(REQUEST_SERVER1_DB2.implies(ROLE_SERVER_ALL_DB_DB1));
  assertFalse(REQUEST_SERVER2_DB2.implies(ROLE_SERVER_ALL_DB_DB1));
  assertTrue(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER1_URI1));
  assertTrue(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER1_URI2));
  assertTrue(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER1_URI2));
  assertTrue(ROLE_SERVER_SERVER1_URI_ALL.implies(REQUEST_SERVER1_URI1));
  assertTrue(ROLE_SERVER_SERVER1_URI_ALL.implies(REQUEST_SERVER1_URI2));
  assertTrue(ROLE_SERVER_SERVER1.implies(REQUEST_SERVER1_URI2));
  assertTrue(ROLE_SERVER_SERVER1_URI_URI1.implies(REQUEST_SERVER1_URI1));
  assertFalse(ROLE_SERVER_SERVER1_URI_URI1.implies(REQUEST_SERVER1_URI2));
  assertTrue(ROLE_SERVER_SERVER1_URI_URI2.implies(REQUEST_SERVER1_URI2));
  assertFalse(ROLE_SERVER_SERVER1_URI_URI2.implies(REQUEST_SERVER1_URI1));
  assertFalse(REQUEST_SERVER2_DB2.implies(REQUEST_SERVER1_URI1));
  assertFalse(ROLE_SERVER_ALL_DB_DB1.implies(REQUEST_SERVER1_URI1));
  assertTrue(REQUEST_SERVER1_URI1.implies(ROLE_SERVER_SERVER1_URI_ALL));
  assertTrue(REQUEST_SERVER1_URI2.implies(ROLE_SERVER_SERVER1_URI_ALL));
  assertFalse(REQUEST_SERVER1_URI1.implies(ROLE_SERVER_SERVER1));
  assertFalse(REQUEST_SERVER1_URI1.implies(ROLE_SERVER_SERVER1_URI_URI1));
  assertFalse(REQUEST_SERVER1_URI2.implies(ROLE_SERVER_SERVER1_URI_URI1));
  assertFalse(REQUEST_SERVER1_URI2.implies(ROLE_SERVER_SERVER1_URI_URI2));
  assertFalse(REQUEST_SERVER1_URI1.implies(ROLE_SERVER_SERVER1_URI_URI2));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testActionHierarchy() throws Exception {
  String dbName="db1";
  DBWildcardPrivilege dbAll=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","ALL"));
  DBWildcardPrivilege dbSelect=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","SELECT"));
  DBWildcardPrivilege dbInsert=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","INSERT"));
  DBWildcardPrivilege dbAlter=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","ALTER"));
  DBWildcardPrivilege dbCreate=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","CREATE"));
  DBWildcardPrivilege dbDrop=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","DROP"));
  DBWildcardPrivilege dbIndex=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","INDEX"));
  DBWildcardPrivilege dbLock=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","LOCK"));
  assertTrue(dbAll.implies(dbSelect));
  assertTrue(dbAll.implies(dbInsert));
  assertTrue(dbAll.implies(dbAlter));
  assertTrue(dbAll.implies(dbCreate));
  assertTrue(dbAll.implies(dbDrop));
  assertTrue(dbAll.implies(dbIndex));
  assertTrue(dbAll.implies(dbLock));
  dbAll=create(new KeyValue("server","server1"),new KeyValue("db",dbName),new KeyValue("action","*"));
  assertTrue(dbAll.implies(dbSelect));
  assertTrue(dbAll.implies(dbInsert));
  assertTrue(dbAll.implies(dbAlter));
  assertTrue(dbAll.implies(dbCreate));
  assertTrue(dbAll.implies(dbDrop));
  assertTrue(dbAll.implies(dbIndex));
  assertTrue(dbAll.implies(dbLock));
  dbAll=create(new KeyValue("server","server1"),new KeyValue("db",dbName));
  assertTrue(dbAll.implies(dbSelect));
  assertTrue(dbAll.implies(dbInsert));
  assertTrue(dbAll.implies(dbAlter));
  assertTrue(dbAll.implies(dbCreate));
  assertTrue(dbAll.implies(dbDrop));
  assertTrue(dbAll.implies(dbIndex));
  assertTrue(dbAll.implies(dbLock));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.db.TestPolicyParsingNegative </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPerDbFileCannotContainUsersOrDatabases() throws Exception {
  PolicyEngine policy;
  ImmutableSet<String> permissions;
  PolicyFile policyFile;
  policyFile=PolicyFile.setAdminOnServer1("admin");
  policyFile.addGroupsToUser("admin1","admin");
  policyFile.write(globalPolicyFile);
  policyFile.write(otherPolicyFile);
  policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  permissions=policy.getAllPrivileges(Sets.newHashSet("admin"),ActiveRoleSet.ALL);
  Assert.assertEquals(permissions.toString(),"[server=server1]");
  policyFile.addDatabase("other",otherPolicyFile.getPath());
  policyFile.write(globalPolicyFile);
  policyFile.write(otherPolicyFile);
  policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  permissions=policy.getAllPrivileges(Sets.newHashSet("admin"),ActiveRoleSet.ALL);
  Assert.assertEquals(permissions.toString(),"[server=server1]");
  policyFile.removeGroupsFromUser("admin1","admin").write(otherPolicyFile);
  policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  permissions=policy.getAllPrivileges(Sets.newHashSet("admin"),ActiveRoleSet.ALL);
  Assert.assertEquals(permissions.toString(),"[server=server1]");
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAll() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = *",globalPolicyFile);
  PolicyEngine policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServerAll() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = server=*",globalPolicyFile);
  PolicyEngine policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDatabaseRequiredInRole() throws Exception {
  append("[databases]",globalPolicyFile);
  append("other_group_db = " + otherPolicyFile.getPath(),globalPolicyFile);
  append("[groups]",otherPolicyFile);
  append("other_group = malicious_role",otherPolicyFile);
  append("[roles]",otherPolicyFile);
  append("malicious_role = server=server1",otherPolicyFile);
  PolicyEngine policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("other_group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create policy file with multiple per db files.
 * Verify that a file with bad format is the only one that's ignored
 * @throws Exception
 */
@Test public void testMultiDbWithErrors() throws Exception {
  File db1PolicyFile=new File(baseDir,"db1.ini");
  File db2PolicyFile=new File(baseDir,"db2.ini");
  append("[databases]",globalPolicyFile);
  append("db1 = " + db1PolicyFile.getPath(),globalPolicyFile);
  append("db2 = " + db2PolicyFile.getPath(),globalPolicyFile);
  append("[groups]",globalPolicyFile);
  append("db3_group = db3_rule",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("db3_rule = server=server1->db=db3->table=sales->action=select",globalPolicyFile);
  append("[groups]",db1PolicyFile);
  append("db1_group = bad_rule",db1PolicyFile);
  append("[roles]",db1PolicyFile);
  append("bad_rule = server=server1->db=customers->=purchases->action=",db1PolicyFile);
  append("[groups]",db2PolicyFile);
  append("db2_group = db2_rule",db2PolicyFile);
  append("[roles]",db2PolicyFile);
  append("db2_rule = server=server1->db=db2->table=purchases->action=select",db2PolicyFile);
  PolicyEngine policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("db1_group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
  permissions=policy.getAllPrivileges(Sets.newHashSet("db2_group"),ActiveRoleSet.ALL);
  Assert.assertEquals(permissions.toString(),1,permissions.size());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServerIncorrect() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = server=server2",globalPolicyFile);
  PolicyEngine policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnauthorizedDbSpecifiedInDBPolicyFile() throws Exception {
  append("[databases]",globalPolicyFile);
  append("other_group_db = " + otherPolicyFile.getPath(),globalPolicyFile);
  append("[groups]",otherPolicyFile);
  append("other_group = malicious_role",otherPolicyFile);
  append("[roles]",otherPolicyFile);
  append("malicious_role = server=server1->db=customers->table=purchases->action=select",otherPolicyFile);
  PolicyEngine policy=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("other_group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.db.TestResourceAuthorizationProviderSpecialCases </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateEntries() throws Exception {
  Subject user1=new Subject("user1");
  Server server1=new Server("server1");
  AccessURI uri=new AccessURI("file:///path/to/");
  Set<? extends Action> actions=EnumSet.of(DBModelAction.ALL,DBModelAction.SELECT,DBModelAction.INSERT);
  policyFile.addGroupsToUser(user1.getName(),true,"group1","group1").addRolesToGroup("group1",true,"role1","role1").addPermissionsToRole("role1",true,"server=" + server1.getName() + "->uri="+ uri.getName(),"server=" + server1.getName() + "->uri="+ uri.getName());
  policyFile.write(iniFile);
  DBPolicyFileBackend policy=new DBPolicyFileBackend(server1.getName(),initResource);
  authzProvider=new LocalGroupResourceAuthorizationProvider(initResource,policy);
  List<? extends Authorizable> authorizableHierarchy=ImmutableList.of(server1,uri);
  Assert.assertTrue(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNonAbolutePath() throws Exception {
  Subject user1=new Subject("user1");
  Server server1=new Server("server1");
  AccessURI uri=new AccessURI("file:///path/to/");
  Set<? extends Action> actions=EnumSet.of(DBModelAction.ALL,DBModelAction.SELECT,DBModelAction.INSERT);
  policyFile.addGroupsToUser(user1.getName(),"group1").addRolesToGroup("group1","role1").addPermissionsToRole("role1","server=" + server1.getName() + "->uri="+ uri.getName());
  policyFile.write(iniFile);
  DBPolicyFileBackend policy=new DBPolicyFileBackend(server1.getName(),initResource);
  authzProvider=new LocalGroupResourceAuthorizationProvider(initResource,policy);
  List<? extends Authorizable> authorizableHierarchy=ImmutableList.of(server1,uri);
  Assert.assertTrue(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
  uri=new AccessURI("file:///path/to/./");
  authorizableHierarchy=ImmutableList.of(server1,uri);
  Assert.assertFalse(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
  uri=new AccessURI("file:///path/to/../");
  authorizableHierarchy=ImmutableList.of(server1,uri);
  Assert.assertFalse(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
  uri=new AccessURI("file:///path/to/../../");
  authorizableHierarchy=ImmutableList.of(server1,uri);
  Assert.assertFalse(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
  uri=new AccessURI("file:///path/to/dir/../../");
  authorizableHierarchy=ImmutableList.of(server1,uri);
  Assert.assertFalse(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.db.TestSimpleDBPolicyEngineDFS </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiFSPolicy() throws Exception {
  File globalPolicyFile=new File(Files.createTempDir(),"global-policy.ini");
  File dbPolicyFile=new File(Files.createTempDir(),"db11-policy.ini");
  PolicyFile dbPolicy=new PolicyFile().addPermissionsToRole("db11_role","server=server1->db=db11").addRolesToGroup("group1","db11_role");
  dbPolicy.write(dbPolicyFile);
  Path dbPolicyPath=new Path(etc,"db11-policy.ini");
  PolicyFile globalPolicy=new PolicyFile().addPermissionsToRole("admin_role","server=server1").addRolesToGroup("admin_group","admin_role").addGroupsToUser("db","admin_group");
  globalPolicy.addDatabase("db11",dbPolicyPath.toUri().toString());
  globalPolicy.write(globalPolicyFile);
  PolicyFiles.copyFilesToDir(fileSystem,etc,globalPolicyFile);
  PolicyFiles.copyFilesToDir(fileSystem,etc,dbPolicyFile);
  DBPolicyFileBackend multiFSEngine=new DBPolicyFileBackend("server1",globalPolicyFile.getPath());
  Set<String> dbGroups=Sets.newHashSet();
  dbGroups.add("group1");
  ImmutableSet<String> dbPerms=multiFSEngine.getAllPrivileges(dbGroups,ActiveRoleSet.ALL);
  Assert.assertEquals("No DB permissions found",1,dbPerms.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.indexer.TestIndexerAuthorizationProviderSpecialCases </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateEntries() throws Exception {
  Subject user1=new Subject("user1");
  Indexer indexer1=new Indexer("indexer1");
  Set<? extends Action> actions=EnumSet.allOf(IndexerModelAction.class);
  policyFile.addGroupsToUser(user1.getName(),true,"group1","group1").addRolesToGroup("group1",true,"role1","role1").addPermissionsToRole("role1",true,"indexer=" + indexer1.getName(),"indexer=" + indexer1.getName());
  policyFile.write(iniFile);
  IndexerPolicyFileBackend policy=new IndexerPolicyFileBackend(initResource);
  authzProvider=new LocalGroupResourceAuthorizationProvider(initResource,policy);
  List<? extends Authorizable> authorizableHierarchy=ImmutableList.of(indexer1);
  Assert.assertTrue(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.indexer.TestIndexerPolicyNegative </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIndexerRequiredInRole() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = some_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("some_role = action=read",globalPolicyFile);
  PolicyEngine policy=new IndexerPolicyFileBackend(globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGroupIncorrect() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = indexer=*",globalPolicyFile);
  PolicyEngine policy=new IndexerPolicyFileBackend(globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getPrivileges(Sets.newHashSet("incorrectGroup"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.indexer.TestIndexerWildcardPrivilege </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnexpected() throws Exception {
  Privilege p=new Privilege(){
    @Override public boolean implies(    Privilege p){
      return false;
    }
  }
;
  Privilege indexer1=create(new KeyValue("indexer","index1"));
  assertFalse(indexer1.implies(null));
  assertFalse(indexer1.implies(p));
  assertFalse(indexer1.equals(null));
  assertFalse(indexer1.equals(p));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testActionAll() throws Exception {
  Privilege ind1All=create(new KeyValue("indexer","index1"),new KeyValue("action",ALL));
  Privilege ind1Write=create(new KeyValue("indexer","index1"),new KeyValue("action","write"));
  Privilege ind1Read=create(new KeyValue("indexer","index1"),new KeyValue("action","read"));
  assertTrue(ind1All.implies(ind1All));
  assertTrue(ind1All.implies(ind1Write));
  assertTrue(ind1All.implies(ind1Read));
  assertFalse(ind1Write.implies(ind1All));
  assertFalse(ind1Read.implies(ind1All));
  Privilege ind1=create(new KeyValue("indexer","index1"));
  assertTrue(ind1All.implies(ind1));
  assertTrue(ind1.implies(ind1All));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAction() throws Exception {
  Privilege read=create(new KeyValue("indexer","ind1"),new KeyValue("action","read"));
  Privilege write=create(new KeyValue("indexer","ind1"),new KeyValue("action","write"));
  Privilege readCase=create(new KeyValue("indeXeR","iNd1"),new KeyValue("AcTiOn","ReAd"));
  assertTrue(read.implies(read));
  assertTrue(write.implies(write));
  assertTrue(read.implies(readCase));
  assertTrue(readCase.implies(read));
  assertFalse(read.implies(write));
  assertFalse(readCase.implies(write));
  assertFalse(write.implies(read));
  assertFalse(write.implies(readCase));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleShorterThanRequest() throws Exception {
  Privilege indexer1=create(new KeyValue("indexer","ind1"));
  Privilege read=create(new KeyValue("indexer","ind1"),new KeyValue("action","read"));
  Privilege write=create(new KeyValue("indexer","ind1"),new KeyValue("action","write"));
  Privilege all=create(new KeyValue("indexer","ind1"),new KeyValue("action",ALL));
  assertTrue(indexer1.implies(read));
  assertTrue(indexer1.implies(write));
  assertTrue(indexer1.implies(all));
  assertFalse(read.implies(indexer1));
  assertFalse(write.implies(indexer1));
  assertTrue(all.implies(indexer1));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIndexerAll() throws Exception {
  Privilege indexerAll=create(new KeyValue("indexer",ALL));
  Privilege indexer1=create(new KeyValue("indexer","ind1"));
  assertTrue(indexerAll.implies(indexer1));
  assertTrue(indexer1.implies(indexerAll));
  Privilege allWrite=create(new KeyValue("indexer",ALL),new KeyValue("action","write"));
  Privilege allRead=create(new KeyValue("indexer",ALL),new KeyValue("action","read"));
  Privilege ind1Write=create(new KeyValue("indexer","ind1"),new KeyValue("action","write"));
  Privilege ind1Read=create(new KeyValue("indexer","ind1"),new KeyValue("action","read"));
  assertTrue(allWrite.implies(ind1Write));
  assertTrue(allRead.implies(ind1Read));
  assertTrue(ind1Write.implies(allWrite));
  assertTrue(ind1Read.implies(allRead));
  assertFalse(allWrite.implies(ind1Read));
  assertFalse(ind1Write.implies(ind1Read));
  assertFalse(allRead.implies(ind1Write));
  assertFalse(ind1Read.implies(allWrite));
  assertFalse(allWrite.implies(allRead));
  assertFalse(allRead.implies(allWrite));
  assertFalse(ind1Write.implies(ind1Read));
  assertFalse(ind1Read.implies(ind1Write));
  assertTrue(indexerAll.implies(allWrite));
  assertTrue(indexerAll.implies(allRead));
  assertTrue(indexerAll.implies(ind1Write));
  assertTrue(indexerAll.implies(ind1Read));
  assertFalse(allWrite.implies(indexerAll));
  assertFalse(allRead.implies(indexerAll));
  assertFalse(ind1Write.implies(indexerAll));
  assertFalse(ind1Read.implies(indexerAll));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleNoAction() throws Exception {
  Privilege indexer1=create(new KeyValue("indexer","ind1"));
  Privilege indexer2=create(new KeyValue("indexer","ind2"));
  Privilege indexer1Case=create(new KeyValue("indeXeR","inD1"));
  assertTrue(indexer1.implies(indexer1));
  assertTrue(indexer2.implies(indexer2));
  assertTrue(indexer1.implies(indexer1Case));
  assertTrue(indexer1Case.implies(indexer1));
  assertFalse(indexer1.implies(indexer2));
  assertFalse(indexer1Case.implies(indexer2));
  assertFalse(indexer2.implies(indexer1));
  assertFalse(indexer2.implies(indexer1Case));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.search.TestSearchAuthorizationProviderSpecialCases </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateEntries() throws Exception {
  Subject user1=new Subject("user1");
  Collection collection1=new Collection("collection1");
  Set<? extends Action> actions=EnumSet.allOf(SearchModelAction.class);
  policyFile.addGroupsToUser(user1.getName(),true,"group1","group1").addRolesToGroup("group1",true,"role1","role1").addPermissionsToRole("role1",true,"collection=" + collection1.getName(),"collection=" + collection1.getName());
  policyFile.write(iniFile);
  SearchPolicyFileBackend policy=new SearchPolicyFileBackend(initResource);
  authzProvider=new LocalGroupResourceAuthorizationProvider(initResource,policy);
  List<? extends Authorizable> authorizableHierarchy=ImmutableList.of(collection1);
  Assert.assertTrue(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.search.TestSearchPolicyNegative </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCollectionRequiredInRole() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = some_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("some_role = action=query",globalPolicyFile);
  PolicyEngine policy=new SearchPolicyFileBackend(globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testGroupIncorrect() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = collection=*",globalPolicyFile);
  PolicyEngine policy=new SearchPolicyFileBackend(globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getPrivileges(Sets.newHashSet("incorrectGroup"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.search.TestSearchWildcardPrivilege </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleNoAction() throws Exception {
  Privilege collection1=create(new KeyValue("collection","coll1"));
  Privilege collection2=create(new KeyValue("collection","coll2"));
  Privilege collection1Case=create(new KeyValue("colleCtIon","coLl1"));
  assertTrue(collection1.implies(collection1));
  assertTrue(collection2.implies(collection2));
  assertTrue(collection1.implies(collection1Case));
  assertTrue(collection1Case.implies(collection1));
  assertFalse(collection1.implies(collection2));
  assertFalse(collection1Case.implies(collection2));
  assertFalse(collection2.implies(collection1));
  assertFalse(collection2.implies(collection1Case));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAction() throws Exception {
  Privilege query=create(new KeyValue("collection","coll1"),new KeyValue("action","query"));
  Privilege update=create(new KeyValue("collection","coll1"),new KeyValue("action","update"));
  Privilege queryCase=create(new KeyValue("colleCtIon","coLl1"),new KeyValue("AcTiOn","QuERy"));
  assertTrue(query.implies(query));
  assertTrue(update.implies(update));
  assertTrue(query.implies(queryCase));
  assertTrue(queryCase.implies(query));
  assertFalse(query.implies(update));
  assertFalse(queryCase.implies(update));
  assertFalse(update.implies(query));
  assertFalse(update.implies(queryCase));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testCollectionAll() throws Exception {
  Privilege collectionAll=create(new KeyValue("collection",ALL));
  Privilege collection1=create(new KeyValue("collection","coll1"));
  assertTrue(collectionAll.implies(collection1));
  assertTrue(collection1.implies(collectionAll));
  Privilege allUpdate=create(new KeyValue("collection",ALL),new KeyValue("action","update"));
  Privilege allQuery=create(new KeyValue("collection",ALL),new KeyValue("action","query"));
  Privilege coll1Update=create(new KeyValue("collection","coll1"),new KeyValue("action","update"));
  Privilege coll1Query=create(new KeyValue("collection","coll1"),new KeyValue("action","query"));
  assertTrue(allUpdate.implies(coll1Update));
  assertTrue(allQuery.implies(coll1Query));
  assertTrue(coll1Update.implies(allUpdate));
  assertTrue(coll1Query.implies(allQuery));
  assertFalse(allUpdate.implies(coll1Query));
  assertFalse(coll1Update.implies(coll1Query));
  assertFalse(allQuery.implies(coll1Update));
  assertFalse(coll1Query.implies(allUpdate));
  assertFalse(allUpdate.implies(allQuery));
  assertFalse(allQuery.implies(allUpdate));
  assertFalse(coll1Update.implies(coll1Query));
  assertFalse(coll1Query.implies(coll1Update));
  assertTrue(collectionAll.implies(allUpdate));
  assertTrue(collectionAll.implies(allQuery));
  assertTrue(collectionAll.implies(coll1Update));
  assertTrue(collectionAll.implies(coll1Query));
  assertFalse(allUpdate.implies(collectionAll));
  assertFalse(allQuery.implies(collectionAll));
  assertFalse(coll1Update.implies(collectionAll));
  assertFalse(coll1Query.implies(collectionAll));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleShorterThanRequest() throws Exception {
  Privilege collection1=create(new KeyValue("collection","coll1"));
  Privilege query=create(new KeyValue("collection","coll1"),new KeyValue("action","query"));
  Privilege update=create(new KeyValue("collection","coll1"),new KeyValue("action","update"));
  Privilege all=create(new KeyValue("collection","coll1"),new KeyValue("action",ALL));
  assertTrue(collection1.implies(query));
  assertTrue(collection1.implies(update));
  assertTrue(collection1.implies(all));
  assertFalse(query.implies(collection1));
  assertFalse(update.implies(collection1));
  assertTrue(all.implies(collection1));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnexpected() throws Exception {
  Privilege p=new Privilege(){
    @Override public boolean implies(    Privilege p){
      return false;
    }
  }
;
  Privilege collection1=create(new KeyValue("collection","coll1"));
  assertFalse(collection1.implies(null));
  assertFalse(collection1.implies(p));
  assertFalse(collection1.equals(null));
  assertFalse(collection1.equals(p));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testActionAll() throws Exception {
  Privilege coll1All=create(new KeyValue("collection","coll1"),new KeyValue("action",ALL));
  Privilege coll1Update=create(new KeyValue("collection","coll1"),new KeyValue("action","update"));
  Privilege coll1Query=create(new KeyValue("collection","coll1"),new KeyValue("action","query"));
  assertTrue(coll1All.implies(coll1All));
  assertTrue(coll1All.implies(coll1Update));
  assertTrue(coll1All.implies(coll1Query));
  assertFalse(coll1Update.implies(coll1All));
  assertFalse(coll1Query.implies(coll1All));
  Privilege coll1=create(new KeyValue("collection","coll1"));
  assertTrue(coll1All.implies(coll1));
  assertTrue(coll1.implies(coll1All));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.sqoop.TestSqoopAuthorizationProviderSpecialCases </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDuplicateEntries() throws Exception {
  Subject user1=new Subject("user1");
  Server server1=new Server("server1");
  Connector connector1=new Connector("c1");
  Set<? extends Action> actions=Sets.newHashSet(new SqoopAction(SqoopActionConstant.READ));
  policyFile.addGroupsToUser(user1.getName(),true,"group1","group1").addRolesToGroup("group1",true,"role1","role1").addPermissionsToRole("role1",true,"server=server1->connector=c1->action=read","server=server1->connector=c1->action=read");
  policyFile.write(iniFile);
  SqoopPolicyFileProviderBackend policy=new SqoopPolicyFileProviderBackend(server1.getName(),initResource);
  authzProvider=new LocalGroupResourceAuthorizationProvider(initResource,policy);
  List<? extends Authorizable> authorizableHierarchy=ImmutableList.of(server1,connector1);
  Assert.assertTrue(authorizableHierarchy.toString(),authzProvider.hasAccess(user1,authorizableHierarchy,actions,ActiveRoleSet.ALL));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.sqoop.TestSqoopPolicyNegative </h4><pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNoServerNameConfig() throws Exception {
  append("[groups]",globalPolicyFile);
  append("other_group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = connector=c1->action=read,link=l1->action=read",globalPolicyFile);
  PolicyEngine policy=new SqoopPolicyFileProviderBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("other_group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAll() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = *",globalPolicyFile);
  PolicyEngine policy=new SqoopPolicyFileProviderBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServerIncorrect() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = server=server2",globalPolicyFile);
  PolicyEngine policy=new SqoopPolicyFileProviderBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testauthorizedSqoopInPolicyFile() throws Exception {
  append("[groups]",globalPolicyFile);
  append("other_group = other_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("other_role = server=server1->connector=c1->action=read, server=server1->link=l1->action=read",globalPolicyFile);
  PolicyEngine policy=new SqoopPolicyFileProviderBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("malicious_group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
  permissions=policy.getAllPrivileges(Sets.newHashSet("other_group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.size() == 2);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testServerAllName() throws Exception {
  append("[groups]",globalPolicyFile);
  append("group = malicious_role",globalPolicyFile);
  append("[roles]",globalPolicyFile);
  append("malicious_role = server=*",globalPolicyFile);
  PolicyEngine policy=new SqoopPolicyFileProviderBackend("server1",globalPolicyFile.getPath());
  ImmutableSet<String> permissions=policy.getAllPrivileges(Sets.newHashSet("group"),ActiveRoleSet.ALL);
  Assert.assertTrue(permissions.toString(),permissions.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.policy.sqoop.TestSqoopWildcardPrivilege </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testActionAll() throws Exception {
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_READ));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_WRITE));
  assertTrue(SQOOP_SERVER1_JOB1_ALL.implies(SQOOP_SERVER1_JOB1_READ));
  assertTrue(SQOOP_SERVER1_JOB1_ALL.implies(SQOOP_SERVER1_JOB1_WRITE));
  assertTrue(SQOOP_SERVER1_LINK1_ALL.implies(SQOOP_SERVER1_LINK1_READ));
  assertTrue(SQOOP_SERVER1_LINK1_ALL.implies(SQOOP_SERVER1_LINK1_WRITE));
  assertTrue(SQOOP_SERVER1_CONNECTOR1_ALL.implies(SQOOP_SERVER1_CONNECTOR1_READ));
  assertTrue(SQOOP_SERVER1_CONNECTOR1_ALL.implies(SQOOP_SERVER1_CONNECTOR1_WRITE));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testUnexpected() throws Exception {
  Privilege p=new Privilege(){
    @Override public boolean implies(    Privilege p){
      return false;
    }
  }
;
  Privilege job1=create(new KeyValue("SERVER","server"),new KeyValue("JOB","job1"));
  assertFalse(job1.implies(null));
  assertFalse(job1.implies(p));
  assertFalse(job1.equals(null));
  assertFalse(job1.equals(p));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testShorterThanRequest() throws Exception {
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_JOB1_ALL));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_JOB1_READ));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_JOB1_WRITE));
  assertFalse(SQOOP_SERVER1_WRITE.implies(SQOOP_SERVER1_READ));
  assertTrue(SQOOP_SERVER1_READ.implies(SQOOP_SERVER1_JOB1_READ));
  assertTrue(SQOOP_SERVER1_WRITE.implies(SQOOP_SERVER1_JOB1_WRITE));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_LINK1_ALL));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_LINK1_READ));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_LINK1_WRITE));
  assertTrue(SQOOP_SERVER1_READ.implies(SQOOP_SERVER1_LINK1_READ));
  assertTrue(SQOOP_SERVER1_WRITE.implies(SQOOP_SERVER1_LINK1_WRITE));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_CONNECTOR1_ALL));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_CONNECTOR1_READ));
  assertTrue(SQOOP_SERVER1_ALL.implies(SQOOP_SERVER1_CONNECTOR1_WRITE));
  assertTrue(SQOOP_SERVER1_READ.implies(SQOOP_SERVER1_CONNECTOR1_READ));
  assertTrue(SQOOP_SERVER1_WRITE.implies(SQOOP_SERVER1_CONNECTOR1_WRITE));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSimpleAction() throws Exception {
  assertFalse(SQOOP_SERVER1_WRITE.implies(SQOOP_SERVER1_READ));
  assertFalse(SQOOP_SERVER1_READ.implies(SQOOP_SERVER1_WRITE));
  assertFalse(SQOOP_SERVER1_CONNECTOR1_WRITE.implies(SQOOP_SERVER1_CONNECTOR1_READ));
  assertFalse(SQOOP_SERVER1_CONNECTOR1_READ.implies(SQOOP_SERVER1_CONNECTOR1_WRITE));
  assertFalse(SQOOP_SERVER1_JOB1_READ.implies(SQOOP_SERVER1_JOB1_WRITE));
  assertFalse(SQOOP_SERVER1_JOB1_WRITE.implies(SQOOP_SERVER1_JOB1_READ));
  assertFalse(SQOOP_SERVER1_LINK1_READ.implies(SQOOP_SERVER1_LINK1_WRITE));
  assertFalse(SQOOP_SERVER1_LINK1_WRITE.implies(SQOOP_SERVER1_LINK1_READ));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.cache.TestCacheProvider </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetAllUnknownGroup(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet(),backend.getPrivileges(Sets.newHashSet("not-a-group"),ActiveRoleSet.ALL));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetOne(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet("server=server1->functions"),backend.getPrivileges(Sets.newHashSet("manager"),new ActiveRoleSet(Sets.newHashSet("functions"))));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetTwo(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet("server=server1->db=jranalyst1","server=server1->functions"),backend.getPrivileges(Sets.newHashSet("manager"),new ActiveRoleSet(Sets.newHashSet("junior_analyst_role","functions"))));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetNone(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet(),backend.getPrivileges(Sets.newHashSet("manager"),new ActiveRoleSet(new HashSet<String>())));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetAll(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet("server=server1->db=customers->table=purchases->select","server=server1->db=analyst1","server=server1->db=jranalyst1->table=*->select","server=server1->db=jranalyst1","server=server1->functions"),backend.getPrivileges(Sets.newHashSet("manager"),ActiveRoleSet.ALL));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.common.TestNoAuthorizationProvider </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoAuthorizationProvider(){
  NoAuthorizationProvider nap=new NoAuthorizationProvider();
  assertFalse(nap.hasAccess(null,null,null,null));
  GroupMappingService gms=nap.getGroupMapping();
  assertEquals(gms.getGroups(null).size(),0);
  assertEquals(gms.getGroups("").size(),0);
  assertEquals(gms.getGroups("a").size(),0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.generic.service.persistent.TestPrivilegeOperatePersistence </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant all privilege to role r1 and revoke query privilege
 * there is update privilege related to role r1
 */
@Test public void testRevokePrivilegeWithAllPrivilegeExist() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject updatePrivilege=new Builder(allPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject queryPrivilege=new Builder(allPrivilege).setAction(SearchConstants.QUERY).build();
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevokeWithGrantOption() throws Exception {
  addGroupsToUser(GRANT_OPTION_USER,GRANT_OPTION_GROUP);
  addGroupsToUser(NO_GRANT_OPTION_USER,NO_GRANT_OPTION_GROUP);
  writePolicyFile();
  String roleName1="r1";
  String grantor="g1";
  sentryStore.createRole(SEARCH,roleName1,grantor);
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  sentryStore.alterRoleAddGroups(SEARCH,roleName1,Sets.newHashSet(GRANT_OPTION_GROUP),grantor);
  String roleName2="r2";
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,GRANT_OPTION_USER);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName2,queryPrivilege,GRANT_OPTION_USER);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantRevokeCheckWithGrantOption() throws Exception {
  addGroupsToUser(GRANT_OPTION_USER,GRANT_OPTION_GROUP);
  addGroupsToUser(NO_GRANT_OPTION_USER,NO_GRANT_OPTION_GROUP);
  writePolicyFile();
  String roleName1="r1";
  String roleName2="r2";
  String grantor="g1";
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  PrivilegeObject queryPrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege1,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege1),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  PrivilegeObject queryPrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(false).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege2,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege2),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.alterRoleAddGroups(SEARCH,roleName1,Sets.newHashSet(GRANT_OPTION_GROUP),grantor);
  sentryStore.alterRoleAddGroups(SEARCH,roleName2,Sets.newHashSet(NO_GRANT_OPTION_GROUP),grantor);
  String roleName3="r3";
  sentryStore.createRole(SEARCH,roleName3,grantor);
  try {
    sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,queryPrivilege1,GRANT_OPTION_USER);
  }
 catch (  SentryGrantDeniedException e) {
    fail("SentryGrantDeniedException shouldn't have been thrown");
  }
  try {
    sentryStore.alterRoleRevokePrivilege(SEARCH,roleName3,queryPrivilege1,GRANT_OPTION_USER);
  }
 catch (  SentryGrantDeniedException e) {
    fail("SentryGrantDeniedException shouldn't have been thrown");
  }
  try {
    sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,queryPrivilege2,NO_GRANT_OPTION_USER);
    fail("SentryGrantDeniedException should have been thrown");
  }
 catch (  SentryGrantDeniedException e) {
  }
  try {
    sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,queryPrivilege2,NO_GRANT_OPTION_USER);
    fail("SentryGrantDeniedException should have been thrown");
  }
 catch (  SentryGrantDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantWithGrantOption() throws Exception {
  addGroupsToUser(GRANT_OPTION_USER,GRANT_OPTION_GROUP);
  addGroupsToUser(NO_GRANT_OPTION_USER,NO_GRANT_OPTION_GROUP);
  writePolicyFile();
  String roleName1="r1";
  String grantor="g1";
  sentryStore.createRole(SEARCH,roleName1,grantor);
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,ADMIN_USER);
  sentryStore.alterRoleAddGroups(SEARCH,roleName1,Sets.newHashSet(GRANT_OPTION_GROUP),grantor);
  String roleName2="r2";
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,GRANT_OPTION_USER);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query privilege to role r1 and there is ALL privilege related this
 * collection existed
 */
@Test public void testGrantPrivilegeWithAllPrivilegeExist() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject queryPrivilege=new Builder(allPrivilege).setAction(SearchConstants.QUERY).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query and update privileges to role r1 and revoke query privilege
 * there is left update privilege related to role r1
 */
@Test public void testRevokePrivilege() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRenamePrivilege() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor=ADMIN_USER;
  List<? extends Authorizable> oldAuthoriables=Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME));
  List<? extends Authorizable> newAuthoriables=Arrays.asList(new Collection(COLLECTION_NAME),new Field(NOT_FIELD_NAME));
  PrivilegeObject oldQueryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(oldAuthoriables).build();
  PrivilegeObject oldUpdatePrivilege=new Builder(oldQueryPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject oldALLPrivilege=new Builder(oldQueryPrivilege).setAction(SearchConstants.ALL).build();
  PrivilegeObject newQueryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(newAuthoriables).build();
  PrivilegeObject newUpdatePrivilege=new Builder(newQueryPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject newALLPrivilege=new Builder(newQueryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,oldQueryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,oldUpdatePrivilege,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,oldALLPrivilege,grantor);
  assertEquals(Sets.newHashSet(oldQueryPrivilege,oldUpdatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(oldALLPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.renamePrivilege(SEARCH,SERVICE,oldAuthoriables,newAuthoriables,grantor);
  assertEquals(Sets.newHashSet(newQueryPrivilege,newUpdatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(newALLPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  List<? extends Authorizable> newAuthoriables1=Arrays.asList(new Collection(NOT_COLLECTION_NAME),new Field(NOT_FIELD_NAME));
  PrivilegeObject newQueryPrivilege1=new Builder(newQueryPrivilege).setAuthorizables(newAuthoriables1).build();
  PrivilegeObject newUpdatePrivilege1=new Builder(newUpdatePrivilege).setAuthorizables(newAuthoriables1).build();
  PrivilegeObject newALLPrivilege1=new Builder(newALLPrivilege).setAuthorizables(newAuthoriables1).build();
  sentryStore.renamePrivilege(SEARCH,SERVICE,Arrays.asList(new Collection(COLLECTION_NAME)),Arrays.asList(new Collection(NOT_COLLECTION_NAME)),grantor);
  assertEquals(Sets.newHashSet(newQueryPrivilege1,newUpdatePrivilege1),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(newALLPrivilege1),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesByRoleName() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor="g1";
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,ADMIN_USER);
  PrivilegeObject updatePrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,updatePrivilege,ADMIN_USER);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1,roleName2)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesByProvider() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String roleName3="r3";
  String group="g3";
  String grantor=ADMIN_USER;
  String service1="service1";
  PrivilegeObject queryPrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  PrivilegeObject updatePrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.UPDATE).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject queryPrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  PrivilegeObject updatePrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.UPDATE).setService(service1).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.createRole(SEARCH,roleName3,grantor);
  sentryStore.alterRoleAddGroups(SEARCH,roleName3,Sets.newHashSet(group),grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName3,updatePrivilege2,grantor);
  assertEquals(Sets.newHashSet(updatePrivilege1,queryPrivilege1),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1),null,null));
  assertEquals(Sets.newHashSet(updatePrivilege1,queryPrivilege1,queryPrivilege2),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1,roleName2),null,null));
  assertEquals(Sets.newHashSet(updatePrivilege1,queryPrivilege1,queryPrivilege2,updatePrivilege2),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1,roleName2),Sets.newHashSet(group),null));
  List<? extends Authorizable> authorizables=Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME));
  assertEquals(Sets.newHashSet(updatePrivilege1,updatePrivilege2),sentryStore.getPrivilegesByProvider(SEARCH,service1,Sets.newHashSet(roleName1,roleName2),Sets.newHashSet(group),authorizables));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query privilege to role r1
 */
@Test public void testGrantPrivilege() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(null).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject queryPrivilegeWithOption=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(true).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithOption,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,queryPrivilegeWithOption),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject queryPrivilegeWithNoOption=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).withGrantOption(false).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilegeWithNoOption,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,queryPrivilegeWithOption,queryPrivilegeWithNoOption),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query privilege to role r1 and there are query and update privileges
 * related this collection existed
 */
@Test public void testGrantALLPrivilegeWithOtherPrivilegesExist() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  PrivilegeObject allPrivilege=new Builder(queryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant update, query and all privilege to role r1
 * Revoke query privilege from role r1
 * there is update privilege related to role r1
 */
@Test public void testRevokePrivilegeWithAllPrivilegesGranted() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(allPrivilege).setAction(SearchConstants.UPDATE).build();
  PrivilegeObject queryPrivilege=new Builder(allPrivilege).setAction(SearchConstants.QUERY).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(allPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevokeParentPrivilegeWithChildsExist() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject updatePrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.UPDATE).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject queryPrivilege1=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject queryPrivilege2=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(NOT_COLLECTION_NAME))).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege2,grantor);
  PrivilegeObject allPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege2),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Grant query and update privileges to role r1 and revoke all privilege,
 * there is no privilege related to role r1
 */
@Test public void testRevokeAllPrivilege() throws Exception {
  String roleName="r1";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
  PrivilegeObject allPrivilege=new Builder(queryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.alterRoleRevokePrivilege(SEARCH,roleName,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName)));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropPrivilege() throws Exception {
  String roleName1="r1";
  String roleName2="r2";
  String grantor=ADMIN_USER;
  PrivilegeObject queryPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.QUERY).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME),new Field(FIELD_NAME))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  sentryStore.createRole(SEARCH,roleName1,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege,grantor);
  sentryStore.createRole(SEARCH,roleName2,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName2,updatePrivilege,grantor);
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(queryPrivilege,updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.dropPrivilege(SEARCH,queryPrivilege,grantor);
  assertEquals(Sets.newHashSet(updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(updatePrivilege),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  PrivilegeObject allPrivilege=new Builder(queryPrivilege).setAction(SearchConstants.ALL).build();
  sentryStore.dropPrivilege(SEARCH,allPrivilege,grantor);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName2)));
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,queryPrivilege,grantor);
  sentryStore.alterRoleGrantPrivilege(SEARCH,roleName1,updatePrivilege,grantor);
  PrivilegeObject parentPrivilege=new Builder().setComponent(SEARCH).setAction(SearchConstants.ALL).setService(SERVICE).setAuthorizables(Arrays.asList(new Collection(COLLECTION_NAME))).build();
  sentryStore.dropPrivilege(SEARCH,parentPrivilege,grantor);
  assertEquals(Sets.newHashSet(),sentryStore.getPrivilegesByRole(SEARCH,Sets.newHashSet(roleName1)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.generic.service.persistent.TestSentryGMPrivilege </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSearchImpliesAction() throws Exception {
  MSentryGMPrivilege fieldPrivilege1=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1"),new Field("f2")),SearchConstants.QUERY,false);
  MSentryGMPrivilege fieldPrivilege2=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1"),new Field("f2")),SearchConstants.QUERY,false);
  assertTrue(fieldPrivilege1.implies(fieldPrivilege2));
  fieldPrivilege2.setAction(SearchConstants.UPDATE);
  assertFalse(fieldPrivilege1.implies(fieldPrivilege2));
  fieldPrivilege1.setAction(SearchConstants.ALL);
  assertTrue(fieldPrivilege1.implies(fieldPrivilege2));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesWithServerScope() throws Exception {
  MSentryGMPrivilege serverPrivilege=new MSentryGMPrivilege("solr","service1",null,SearchConstants.QUERY,false);
  MSentryGMPrivilege collectionPrivilege=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1")),SearchConstants.QUERY,false);
  assertTrue(serverPrivilege.implies(collectionPrivilege));
  MSentryGMPrivilege fieldPrivilege=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1"),new Field("f1")),SearchConstants.QUERY,false);
  assertTrue(serverPrivilege.implies(fieldPrivilege));
  assertTrue(collectionPrivilege.implies(fieldPrivilege));
  serverPrivilege.setAction(SearchConstants.UPDATE);
  assertFalse(serverPrivilege.implies(collectionPrivilege));
  assertFalse(serverPrivilege.implies(fieldPrivilege));
  serverPrivilege.setAction(SearchConstants.ALL);
  assertTrue(serverPrivilege.implies(collectionPrivilege));
  assertTrue(serverPrivilege.implies(fieldPrivilege));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * The requested privilege has the different authorizable size with the persistent privilege
 * @throws Exception
 */
@Test public void testImpliesDifferentAuthorizable() throws Exception {
  MSentryGMPrivilege serverPrivilege=new MSentryGMPrivilege("solr","service1",null,SearchConstants.QUERY,false);
  MSentryGMPrivilege collectionPrivilege=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1")),SearchConstants.QUERY,false);
  MSentryGMPrivilege fieldPrivilege=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1"),new Field("f1")),SearchConstants.QUERY,false);
  assertTrue(serverPrivilege.implies(collectionPrivilege));
  assertTrue(serverPrivilege.implies(fieldPrivilege));
  assertTrue(collectionPrivilege.implies(fieldPrivilege));
  assertFalse(fieldPrivilege.implies(collectionPrivilege));
  assertFalse(fieldPrivilege.implies(serverPrivilege));
  assertFalse(collectionPrivilege.implies(serverPrivilege));
  MSentryGMPrivilege fieldAllPrivilege=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1"),new Field(AccessConstants.ALL)),SearchConstants.QUERY,false);
  assertTrue(fieldAllPrivilege.implies(collectionPrivilege));
  MSentryGMPrivilege fieldPrivilege1=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c1"),new Field("f1")),SearchConstants.QUERY,false);
  MSentryGMPrivilege fieldPrivilege2=new MSentryGMPrivilege("solr","service1",Arrays.asList(new Collection("c2"),new Field("f2")),SearchConstants.QUERY,false);
  assertFalse(fieldPrivilege1.implies(fieldPrivilege2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.generic.service.persistent.TestSentryRole </h4><pre class="type-12 type-16 type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWantGrantPrivilegeTwice() throws Exception {
  String roleName="r1";
  MSentryPrivilege hivePrivilege=new MSentryPrivilege();
  hivePrivilege.setServerName("hive.server1");
  hivePrivilege.setDbName("db1");
  hivePrivilege.setTableName("tb1");
  hivePrivilege.setPrivilegeScope("table");
  hivePrivilege.setAction("select");
  hivePrivilege.setURI(SentryStore.NULL_COL);
  hivePrivilege.setColumnName(SentryStore.NULL_COL);
  hivePrivilege.setGrantOption(true);
  MSentryPrivilege hivePrivilege2=new MSentryPrivilege(hivePrivilege);
  MSentryGMPrivilege solrPrivilege=new MSentryGMPrivilege();
  solrPrivilege.setComponentName("solr");
  solrPrivilege.setServiceName("solr.server1");
  solrPrivilege.setAuthorizables(Arrays.asList(new Collection("c1")));
  solrPrivilege.setAction("query");
  solrPrivilege.setGrantOption(true);
  MSentryGMPrivilege solrPrivilege2=new MSentryGMPrivilege(solrPrivilege);
  PersistenceManager pm=null;
  pm=openTransaction();
  pm.makePersistent(new MSentryRole(roleName,System.currentTimeMillis()));
  commitTransaction(pm);
  pm=openTransaction();
  MSentryRole role=getMSentryRole(pm,roleName);
  solrPrivilege.appendRole(role);
  hivePrivilege.appendRole(role);
  pm.makePersistent(solrPrivilege);
  pm.makePersistent(hivePrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(1,role.getPrivileges().size());
  assertEquals(1,role.getGmPrivileges().size());
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  if (!role.getGmPrivileges().contains(solrPrivilege2)) {
    fail("unexpect happend: the MSentryGMPrivilege:" + solrPrivilege2 + " already be granted");
  }
  if (!role.getPrivileges().contains(hivePrivilege2)) {
    fail("unexpect happend: the MSentryPrivilege:" + hivePrivilege2 + " already be granted");
  }
  commitTransaction(pm);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletePrivilegeAndRole() throws Exception {
  String roleName="r1";
  MSentryPrivilege hivePrivilege=new MSentryPrivilege();
  hivePrivilege.setServerName("hive.server1");
  hivePrivilege.setDbName("db1");
  hivePrivilege.setTableName("tb1");
  hivePrivilege.setPrivilegeScope("table");
  hivePrivilege.setAction("select");
  hivePrivilege.setURI(SentryStore.NULL_COL);
  hivePrivilege.setColumnName(SentryStore.NULL_COL);
  hivePrivilege.setGrantOption(true);
  MSentryGMPrivilege solrPrivilege=new MSentryGMPrivilege();
  solrPrivilege.setComponentName("solr");
  solrPrivilege.setServiceName("solr.server1");
  solrPrivilege.setAuthorizables(Arrays.asList(new Collection("c1")));
  solrPrivilege.setAction("query");
  solrPrivilege.setGrantOption(true);
  PersistenceManager pm=null;
  pm=openTransaction();
  pm.makePersistent(new MSentryRole(roleName,System.currentTimeMillis()));
  commitTransaction(pm);
  pm=openTransaction();
  MSentryRole role=getMSentryRole(pm,roleName);
  hivePrivilege.appendRole(role);
  solrPrivilege.appendRole(role);
  pm.makePersistent(hivePrivilege);
  pm.makePersistent(solrPrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(1,role.getPrivileges().size());
  assertEquals(1,role.getGmPrivileges().size());
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  role.removeGMPrivileges();
  role.removePrivileges();
  pm.makePersistent(role);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(0,role.getPrivileges().size());
  assertEquals(0,role.getGmPrivileges().size());
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.deletePersistent(role);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  assertTrue(role == null);
  commitTransaction(pm);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void grantMixedPrivilegeTest() throws Exception {
  String roleName="r1";
  MSentryPrivilege hivePrivilege=new MSentryPrivilege();
  hivePrivilege.setServerName("hive.server1");
  hivePrivilege.setDbName("db1");
  hivePrivilege.setTableName("tb1");
  hivePrivilege.setPrivilegeScope("table");
  hivePrivilege.setAction("select");
  hivePrivilege.setGrantOption(true);
  MSentryGMPrivilege solrPrivilege=new MSentryGMPrivilege();
  solrPrivilege.setComponentName("solr");
  solrPrivilege.setServiceName("solr.server1");
  solrPrivilege.setAuthorizables(Arrays.asList(new Collection("c1")));
  solrPrivilege.setAction("query");
  solrPrivilege.setGrantOption(true);
  PersistenceManager pm=null;
  pm=openTransaction();
  pm.makePersistent(new MSentryRole(roleName,System.currentTimeMillis()));
  commitTransaction(pm);
  pm=openTransaction();
  MSentryRole role=getMSentryRole(pm,roleName);
  hivePrivilege.appendRole(role);
  pm.makePersistent(hivePrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(1,role.getPrivileges().size());
  assertEquals(0,role.getGmPrivileges().size());
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  solrPrivilege.appendRole(role);
  pm.makePersistent(solrPrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(1,role.getPrivileges().size());
  assertEquals(1,role.getGmPrivileges().size());
  commitTransaction(pm);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMixedRevokePrivilege() throws Exception {
  String roleName="r1";
  MSentryPrivilege hivePrivilege=new MSentryPrivilege();
  hivePrivilege.setServerName("hive.server1");
  hivePrivilege.setDbName("db1");
  hivePrivilege.setTableName("tb1");
  hivePrivilege.setPrivilegeScope("table");
  hivePrivilege.setAction("select");
  hivePrivilege.setURI(SentryStore.NULL_COL);
  hivePrivilege.setColumnName(SentryStore.NULL_COL);
  hivePrivilege.setGrantOption(true);
  MSentryGMPrivilege solrPrivilege=new MSentryGMPrivilege();
  solrPrivilege.setComponentName("solr");
  solrPrivilege.setServiceName("solr.server1");
  solrPrivilege.setAuthorizables(Arrays.asList(new Collection("c1")));
  solrPrivilege.setAction("query");
  solrPrivilege.setGrantOption(true);
  PersistenceManager pm=null;
  pm=openTransaction();
  pm.makePersistent(new MSentryRole(roleName,System.currentTimeMillis()));
  commitTransaction(pm);
  pm=openTransaction();
  MSentryRole role=getMSentryRole(pm,roleName);
  hivePrivilege.appendRole(role);
  solrPrivilege.appendRole(role);
  pm.makePersistent(hivePrivilege);
  pm.makePersistent(solrPrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(1,role.getPrivileges().size());
  assertEquals(1,role.getGmPrivileges().size());
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  solrPrivilege=(MSentryGMPrivilege)role.getGmPrivileges().toArray()[0];
  solrPrivilege.removeRole(role);
  pm.makePersistent(solrPrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(1,role.getPrivileges().size());
  assertEquals(0,role.getGmPrivileges().size());
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  hivePrivilege=(MSentryPrivilege)role.getPrivileges().toArray()[0];
  hivePrivilege.removeRole(role);
  pm.makePersistent(hivePrivilege);
  commitTransaction(pm);
  pm=openTransaction();
  role=getMSentryRole(pm,roleName);
  pm.retrieve(role);
  assertEquals(0,role.getPrivileges().size());
  assertEquals(0,role.getGmPrivileges().size());
  commitTransaction(pm);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.generic.service.thrift.TestSentryGenericPolicyProcessor </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOperationWithException() throws Exception {
  when(mockStore.createRole(anyString(),anyString(),anyString())).thenThrow(new SentryAlreadyExistsException("role already exists"));
  when(mockStore.dropRole(anyString(),anyString(),anyString())).thenThrow(new SentryNoSuchObjectException("role isn't exist"));
  when(mockStore.alterRoleAddGroups(anyString(),anyString(),anySetOf(String.class),anyString())).thenThrow(new SentryNoSuchObjectException("role isn't exist"));
  when(mockStore.alterRoleDeleteGroups(anyString(),anyString(),anySetOf(String.class),anyString())).thenThrow(new SentryNoSuchObjectException("role isn't exist"));
  when(mockStore.alterRoleGrantPrivilege(anyString(),anyString(),any(PrivilegeObject.class),anyString())).thenThrow(new SentryGrantDeniedException("has no grant"));
  when(mockStore.alterRoleRevokePrivilege(anyString(),anyString(),any(PrivilegeObject.class),anyString())).thenThrow(new SentryGrantDeniedException("has no grant"));
  when(mockStore.dropPrivilege(anyString(),any(PrivilegeObject.class),anyString())).thenThrow(new SentryInvalidInputException("nvalid input privilege object"));
  when(mockStore.renamePrivilege(anyString(),anyString(),anyListOf(Authorizable.class),anyListOf(Authorizable.class),anyString())).thenThrow(new RuntimeException("Unknown error"));
  setup();
  TCreateSentryRoleRequest createrequest=new TCreateSentryRoleRequest();
  createrequest.setRequestorUserName(ADMIN_USER);
  createrequest.setRoleName("r1");
  assertEquals(Status.ALREADY_EXISTS,fromTSentryStatus(processor.create_sentry_role(createrequest).getStatus()));
  TDropSentryRoleRequest dropRequest=new TDropSentryRoleRequest();
  dropRequest.setRequestorUserName(ADMIN_USER);
  dropRequest.setRoleName("r1");
  assertEquals(Status.NO_SUCH_OBJECT,fromTSentryStatus(processor.drop_sentry_role(dropRequest).getStatus()));
  TAlterSentryRoleAddGroupsRequest addRequest=new TAlterSentryRoleAddGroupsRequest();
  addRequest.setRequestorUserName(ADMIN_USER);
  addRequest.setRoleName("r1");
  addRequest.setGroups(Sets.newHashSet("g1"));
  assertEquals(Status.NO_SUCH_OBJECT,fromTSentryStatus(processor.alter_sentry_role_add_groups(addRequest).getStatus()));
  TAlterSentryRoleDeleteGroupsRequest delRequest=new TAlterSentryRoleDeleteGroupsRequest();
  delRequest.setRequestorUserName(ADMIN_USER);
  delRequest.setRoleName("r1");
  delRequest.setGroups(Sets.newHashSet("g1"));
  assertEquals(Status.NO_SUCH_OBJECT,fromTSentryStatus(processor.alter_sentry_role_delete_groups(delRequest).getStatus()));
  TDropPrivilegesRequest dropPrivRequest=new TDropPrivilegesRequest();
  dropPrivRequest.setRequestorUserName(ADMIN_USER);
  dropPrivRequest.setPrivilege(new TSentryPrivilege("test","test",new ArrayList<TAuthorizable>(),"test"));
  assertEquals(Status.INVALID_INPUT,fromTSentryStatus(processor.drop_sentry_privilege(dropPrivRequest).getStatus()));
  TRenamePrivilegesRequest renameRequest=new TRenamePrivilegesRequest();
  renameRequest.setRequestorUserName(ADMIN_USER);
  assertEquals(Status.RUNTIME_ERROR,fromTSentryStatus(processor.rename_sentry_privilege(renameRequest).getStatus()));
  TSentryPrivilege tprivilege=new TSentryPrivilege("test","test",new ArrayList<TAuthorizable>(),"test");
  tprivilege.setGrantOption(TSentryGrantOption.UNSET);
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=new TAlterSentryRoleGrantPrivilegeRequest();
  grantRequest.setRequestorUserName(ADMIN_USER);
  grantRequest.setRoleName("r1");
  grantRequest.setPrivilege(tprivilege);
  assertEquals(Status.ACCESS_DENIED,fromTSentryStatus(processor.alter_sentry_role_grant_privilege(grantRequest).getStatus()));
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=new TAlterSentryRoleRevokePrivilegeRequest();
  revokeRequest.setRequestorUserName(ADMIN_USER);
  revokeRequest.setRoleName("r1");
  revokeRequest.setPrivilege(tprivilege);
  assertEquals(Status.ACCESS_DENIED,fromTSentryStatus(processor.alter_sentry_role_revoke_privilege(revokeRequest).getStatus()));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantAndRevokePrivilege() throws Exception {
  when(mockStore.alterRoleGrantPrivilege(anyString(),anyString(),any(PrivilegeObject.class),anyString())).thenReturn(new CommitContext(SERVER_UUID,SEQ_ID + 6));
  when(mockStore.alterRoleRevokePrivilege(anyString(),anyString(),any(PrivilegeObject.class),anyString())).thenReturn(new CommitContext(SERVER_UUID,SEQ_ID + 7));
  setup();
  TSentryPrivilege tprivilege=new TSentryPrivilege("test","test",new ArrayList<TAuthorizable>(),"test");
  tprivilege.setGrantOption(TSentryGrantOption.UNSET);
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=new TAlterSentryRoleGrantPrivilegeRequest();
  grantRequest.setRequestorUserName(ADMIN_USER);
  grantRequest.setRoleName("r1");
  grantRequest.setPrivilege(tprivilege);
  assertEquals(Status.OK,fromTSentryStatus(processor.alter_sentry_role_grant_privilege(grantRequest).getStatus()));
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=new TAlterSentryRoleRevokePrivilegeRequest();
  revokeRequest.setRequestorUserName(ADMIN_USER);
  revokeRequest.setRoleName("r1");
  revokeRequest.setPrivilege(tprivilege);
  assertEquals(Status.OK,fromTSentryStatus(processor.alter_sentry_role_revoke_privilege(revokeRequest).getStatus()));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRolesAndPrivileges() throws Exception {
  String roleName="r1";
  String groupName="g1";
  PrivilegeObject queryPrivilege=new Builder().setComponent("SOLR").setAction(SearchConstants.QUERY).setService("service1").setAuthorizables(Arrays.asList(new Collection("c1"),new Field("f1"))).build();
  PrivilegeObject updatePrivilege=new Builder(queryPrivilege).setAction(SearchConstants.UPDATE).build();
  when(mockStore.getRolesByGroups(anyString(),anySetOf(String.class))).thenReturn(Sets.newHashSet(roleName));
  when(mockStore.getPrivilegesByProvider(anyString(),anyString(),anySetOf(String.class),anySetOf(String.class),anyListOf(Authorizable.class))).thenReturn(Sets.newHashSet(queryPrivilege,updatePrivilege));
  when(mockStore.getGroupsByRoles(anyString(),anySetOf(String.class))).thenReturn(Sets.newHashSet(groupName));
  TListSentryPrivilegesRequest request1=new TListSentryPrivilegesRequest();
  request1.setRoleName(roleName);
  request1.setRequestorUserName(ADMIN_USER);
  TListSentryPrivilegesResponse response1=processor.list_sentry_privileges_by_role(request1);
  assertEquals(Status.OK,fromTSentryStatus(response1.getStatus()));
  assertEquals(2,response1.getPrivileges().size());
  TListSentryRolesRequest request2=new TListSentryRolesRequest();
  request2.setRequestorUserName(ADMIN_USER);
  request2.setGroupName(groupName);
  TListSentryRolesResponse response2=processor.list_sentry_roles_by_group(request2);
  assertEquals(Status.OK,fromTSentryStatus(response2.getStatus()));
  assertEquals(1,response2.getRoles().size());
  TListSentryPrivilegesForProviderRequest request3=new TListSentryPrivilegesForProviderRequest();
  request3.setGroups(Sets.newHashSet(groupName));
  request3.setRoleSet(new TSentryActiveRoleSet(true,null));
  TListSentryPrivilegesForProviderResponse response3=processor.list_sentry_privileges_for_provider(request3);
  assertEquals(Status.OK,fromTSentryStatus(response3.getStatus()));
  assertEquals(2,response3.getPrivileges().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.generic.service.thrift.TestSentryGenericServiceIntegration </h4><pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDeleteRoleToGroup() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String testGroupName="g1";
      String roleName="admin_r";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      setLocalGroupMapping(requestorUserName,Sets.newHashSet(testGroupName));
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName,SOLR);
      client.createRole(requestorUserName,roleName,SOLR);
      client.addRoleToGroups(requestorUserName,roleName,SOLR,Sets.newHashSet(testGroupName));
      Set<TSentryRole> roles=client.listUserRoles(requestorUserName,SOLR);
      assertEquals("Incorrect number of roles",1,roles.size());
      for (      TSentryRole role : roles) {
        assertTrue(role.getRoleName(),role.getRoleName().equalsIgnoreCase(roleName));
        assertTrue(role.getGroups().size() == 1);
        for (        String group : role.getGroups()) {
          assertEquals(testGroupName,group);
        }
      }
      client.deleteRoleToGroups(requestorUserName,roleName,SOLR,Sets.newHashSet(testGroupName));
      roles=client.listUserRoles(requestorUserName,SOLR);
      assertEquals("Incorrect number of roles",0,roles.size());
      client.dropRole(requestorUserName,roleName,SOLR);
    }
  }
);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName="admin_r1";
      String groupName="group1";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      setLocalGroupMapping(requestorUserName,Sets.newHashSet(groupName));
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName,SOLR);
      client.createRole(requestorUserName,roleName,SOLR);
      client.addRoleToGroups(requestorUserName,roleName,SOLR,Sets.newHashSet(groupName));
      Set<TSentryRole> groupRoles=client.listRolesByGroupName(requestorUserName,groupName,SOLR);
      assertTrue(groupRoles.size() == 1);
      for (      TSentryRole role : groupRoles) {
        assertTrue(role.getRoleName(),role.getRoleName().equalsIgnoreCase(roleName));
        assertTrue(role.getGroups().size() == 1);
        for (        String group : role.getGroups()) {
          assertEquals(groupName,group);
        }
      }
      client.dropRole(requestorUserName,roleName,SOLR);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.log.entity.TestJsonLogEntityFactory </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevokeRole(){
  TAlterSentryRoleRevokePrivilegeRequest request=new TAlterSentryRoleRevokePrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeResponse response=new TAlterSentryRoleRevokePrivilegeResponse();
  request.setRequestorUserName(TEST_USER_NAME);
  request.setRoleName(TEST_ROLE_NAME);
  TSentryPrivilege privilege=getPrivilege(AccessConstants.ALL,PrivilegeScope.DATABASE.name(),TEST_DATABASE_NAME,null,null,null);
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  request.setPrivileges(privileges);
  response.setStatus(Status.OK());
  DBAuditMetadataLogEntity amle=new DBAuditMetadataLogEntity();
  Set<JsonLogEntity> amles=JsonLogEntityFactory.getInstance().createJsonLogEntitys(request,response,conf);
  assertEquals(amles.size(),1);
  for (  JsonLogEntity amle1 : amles) {
    amle=(DBAuditMetadataLogEntity)amle1;
    break;
  }
  assertCommon(amle,Constants.TRUE,Constants.OPERATION_REVOKE_PRIVILEGE,"REVOKE ALL ON DATABASE testDB FROM ROLE testRole",TEST_DATABASE_NAME,null,null,Constants.OBJECT_TYPE_PRINCIPAL);
  privilege=getPrivilege(AccessConstants.ALL,PrivilegeScope.TABLE.name(),null,TEST_TABLE_NAME,null,null);
  privileges=Sets.newHashSet();
  privileges.add(privilege);
  request.setPrivileges(privileges);
  response.setStatus(Status.InvalidInput("",null));
  amles=JsonLogEntityFactory.getInstance().createJsonLogEntitys(request,response,conf);
  assertEquals(amles.size(),1);
  for (  JsonLogEntity amle1 : amles) {
    amle=(DBAuditMetadataLogEntity)amle1;
    break;
  }
  assertCommon(amle,Constants.FALSE,Constants.OPERATION_REVOKE_PRIVILEGE,"REVOKE ALL ON TABLE testTable FROM ROLE testRole",null,TEST_TABLE_NAME,null,Constants.OBJECT_TYPE_PRINCIPAL);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantRole(){
  TAlterSentryRoleGrantPrivilegeRequest request=new TAlterSentryRoleGrantPrivilegeRequest();
  request.setRequestorUserName(TEST_USER_NAME);
  request.setRoleName(TEST_ROLE_NAME);
  TAlterSentryRoleGrantPrivilegeResponse response=new TAlterSentryRoleGrantPrivilegeResponse();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.ALL,PrivilegeScope.DATABASE.name(),TEST_DATABASE_NAME,null,null,null);
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  request.setPrivileges(privileges);
  response.setStatus(Status.OK());
  DBAuditMetadataLogEntity amle=new DBAuditMetadataLogEntity();
  Set<JsonLogEntity> amles=JsonLogEntityFactory.getInstance().createJsonLogEntitys(request,response,conf);
  assertEquals(amles.size(),1);
  for (  JsonLogEntity amle1 : amles) {
    amle=(DBAuditMetadataLogEntity)amle1;
    break;
  }
  assertCommon(amle,Constants.TRUE,Constants.OPERATION_GRANT_PRIVILEGE,"GRANT ALL ON DATABASE testDB TO ROLE testRole",TEST_DATABASE_NAME,null,null,Constants.OBJECT_TYPE_PRINCIPAL);
  privilege=getPrivilege(AccessConstants.ALL,PrivilegeScope.TABLE.name(),null,TEST_TABLE_NAME,null,null);
  privileges=Sets.newHashSet();
  privileges.add(privilege);
  request.setPrivileges(privileges);
  response.setStatus(Status.InvalidInput("",null));
  amles=JsonLogEntityFactory.getInstance().createJsonLogEntitys(request,response,conf);
  assertEquals(amles.size(),1);
  for (  JsonLogEntity amle1 : amles) {
    amle=(DBAuditMetadataLogEntity)amle1;
    break;
  }
  assertCommon(amle,Constants.FALSE,Constants.OPERATION_GRANT_PRIVILEGE,"GRANT ALL ON TABLE testTable TO ROLE testRole",null,TEST_TABLE_NAME,null,Constants.OBJECT_TYPE_PRINCIPAL);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.log.util.TestCommandUtil </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege7(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.SELECT,PrivilegeScope.URI.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT SELECT ON URI hdfs://namenode:port/path/to/dir TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE SELECT ON URI hdfs://namenode:port/path/to/dir FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege5(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.SELECT,PrivilegeScope.TABLE.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT SELECT ON TABLE tableTest TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE SELECT ON TABLE tableTest FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege3(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.SELECT,PrivilegeScope.DATABASE.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT SELECT ON DATABASE dbTest TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE SELECT ON DATABASE dbTest FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege1(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.ALL,PrivilegeScope.DATABASE.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT ALL ON DATABASE dbTest TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE ALL ON DATABASE dbTest FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokeGMPrivilege1(){
  org.apache.sentry.provider.db.generic.service.thrift.TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantGMPrivilegeRequest();
  org.apache.sentry.provider.db.generic.service.thrift.TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokeGMPrivilegeRequest();
  org.apache.sentry.provider.db.generic.service.thrift.TSentryPrivilege privilege=getGMPrivilege();
  grantRequest.setPrivilege(privilege);
  revokeRequest.setPrivilege(privilege);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantGMPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT ACTION ON resourceType1 resourceName1 resourceType2 resourceName2 TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokeGMPrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE ACTION ON resourceType1 resourceName1 resourceType2 resourceName2 FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege8(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.SELECT,PrivilegeScope.SERVER.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  privilege.setGrantOption(TSentryGrantOption.TRUE);
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT SELECT ON SERVER serverTest TO ROLE testRole WITH GRANT OPTION";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE SELECT ON SERVER serverTest FROM ROLE testRole WITH GRANT OPTION";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege6(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.SELECT,PrivilegeScope.SERVER.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT SELECT ON SERVER serverTest TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE SELECT ON SERVER serverTest FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege4(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(null,PrivilegeScope.DATABASE.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT null ON DATABASE dbTest TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE null ON DATABASE dbTest FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokePrivilege2(){
  TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantPrivilegeRequest();
  TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokePrivilegeRequest();
  TSentryPrivilege privilege=getPrivilege(AccessConstants.INSERT,PrivilegeScope.DATABASE.name(),"dbTest","tableTest","serverTest","hdfs://namenode:port/path/to/dir");
  Set<TSentryPrivilege> privileges=Sets.newHashSet();
  privileges.add(privilege);
  grantRequest.setPrivileges(privileges);
  revokeRequest.setPrivileges(privileges);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT INSERT ON DATABASE dbTest TO ROLE testRole";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokePrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE INSERT ON DATABASE dbTest FROM ROLE testRole";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCmdForGrantOrRevokeGMPrivilege2(){
  org.apache.sentry.provider.db.generic.service.thrift.TAlterSentryRoleGrantPrivilegeRequest grantRequest=getGrantGMPrivilegeRequest();
  org.apache.sentry.provider.db.generic.service.thrift.TAlterSentryRoleRevokePrivilegeRequest revokeRequest=getRevokeGMPrivilegeRequest();
  org.apache.sentry.provider.db.generic.service.thrift.TSentryPrivilege privilege=getGMPrivilege();
  privilege.setGrantOption(org.apache.sentry.provider.db.generic.service.thrift.TSentryGrantOption.TRUE);
  grantRequest.setPrivilege(privilege);
  revokeRequest.setPrivilege(privilege);
  String createGrantPrivilegeCmdResult=CommandUtil.createCmdForGrantGMPrivilege(grantRequest);
  String createGrantPrivilegeCmdExcepted="GRANT ACTION ON resourceType1 resourceName1 resourceType2 resourceName2 TO ROLE testRole WITH GRANT OPTION";
  String createRevokePrivilegeCmdResult=CommandUtil.createCmdForRevokeGMPrivilege(revokeRequest);
  String createRevokePrivilegeCmdExcepted="REVOKE ACTION ON resourceType1 resourceName1 resourceType2 resourceName2 FROM ROLE testRole WITH GRANT OPTION";
  assertEquals(createGrantPrivilegeCmdExcepted,createGrantPrivilegeCmdResult);
  assertEquals(createRevokePrivilegeCmdExcepted,createRevokePrivilegeCmdResult);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.persistent.TestSentryPrivilege </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesPrivilegePositiveWithColumn() throws Exception {
  MSentryPrivilege my=new MSentryPrivilege();
  MSentryPrivilege your=new MSentryPrivilege();
  my.setServerName("server1");
  my.setAction(AccessConstants.SELECT);
  your.setServerName("server1");
  your.setDbName("db1");
  your.setTableName("tb1");
  your.setColumnName("c1");
  your.setAction(AccessConstants.SELECT);
  assertTrue(my.implies(your));
  my.setDbName("db1");
  assertTrue(my.implies(your));
  my.setTableName("tb1");
  assertTrue(my.implies(your));
  my.setColumnName("c1");
  assertTrue(my.implies(your));
}

</code></pre>

<br>
<pre class="type-17 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesPrivilegePositive() throws Exception {
  MSentryPrivilege my=new MSentryPrivilege();
  MSentryPrivilege your=new MSentryPrivilege();
  my.setServerName("server1");
  my.setDbName("db1");
  my.setTableName("tb1");
  my.setAction(AccessConstants.SELECT);
  your.setServerName("server1");
  your.setDbName("db1");
  your.setTableName("tb1");
  your.setAction(AccessConstants.SELECT);
  assertTrue(my.implies(your));
  my.setAction(AccessConstants.ALL);
  assertTrue(my.implies(your));
  my.setTableName("");
  assertTrue(my.implies(your));
  my.setDbName("");
  assertTrue(my.implies(your));
  my.setAction(AccessConstants.ACTION_ALL);
  assertTrue(my.implies(your));
  my.setTableName("");
  assertTrue(my.implies(your));
  my.setDbName("");
  assertTrue(my.implies(your));
  String[][] actionMap=new String[][]{{AccessConstants.ALL,AccessConstants.ALL},{AccessConstants.ALL,AccessConstants.ACTION_ALL},{AccessConstants.ACTION_ALL,AccessConstants.ALL},{AccessConstants.ACTION_ALL,AccessConstants.ACTION_ALL}};
  for (int actions=0; actions < actionMap.length; actions++) {
    my=new MSentryPrivilege();
    your=new MSentryPrivilege();
    my.setServerName("server1");
    my.setAction(actionMap[actions][0]);
    your.setServerName("server1");
    your.setAction(actionMap[actions][1]);
    my.setURI("hdfs://namenode:9000/path");
    your.setURI("hdfs://namenode:9000/path");
    assertTrue(my.implies(your));
    my.setURI("hdfs://namenode:9000/path");
    your.setURI("hdfs://namenode:9000/path/to/some/dir");
    assertTrue(my.implies(your));
    my.setURI("file:///path");
    your.setURI("file:///path");
    assertTrue(my.implies(your));
    my.setURI("file:///path");
    your.setURI("file:///path/to/some/dir");
    assertTrue(my.implies(your));
    my.setURI("");
    your.setURI("file:///path");
    assertTrue(my.implies(your));
  }
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesPrivilegeNegativeWithColumn() throws Exception {
  MSentryPrivilege my=new MSentryPrivilege();
  MSentryPrivilege your=new MSentryPrivilege();
  my.setServerName("server1");
  my.setDbName("db1");
  my.setTableName("tb1");
  my.setColumnName("c1");
  my.setAction(AccessConstants.SELECT);
  your.setServerName("server1");
  your.setDbName("db1");
  your.setTableName("tb1");
  your.setColumnName("c2");
  your.setAction(AccessConstants.SELECT);
  assertFalse(my.implies(your));
  your.setColumnName("");
  assertFalse(my.implies(your));
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImpliesPrivilegeNegative() throws Exception {
  MSentryPrivilege my=new MSentryPrivilege();
  MSentryPrivilege your=new MSentryPrivilege();
  my.setServerName("server1");
  my.setDbName("db1");
  my.setTableName("tb1");
  my.setAction(AccessConstants.SELECT);
  your.setServerName("server1");
  your.setDbName("db1");
  your.setTableName("tb1");
  your.setAction(AccessConstants.INSERT);
  assertFalse(my.implies(your));
  your.setAction(AccessConstants.ALL);
  assertFalse(my.implies(your));
  your.setTableName("tb2");
  assertFalse(my.implies(your));
  your.setTableName("tb1");
  your.setDbName("db2");
  assertFalse(my.implies(your));
  your.setTableName("tb1");
  your.setDbName("db1");
  your.setServerName("server2");
  assertFalse(my.implies(your));
  my=new MSentryPrivilege();
  your=new MSentryPrivilege();
  my.setServerName("server1");
  my.setAction(AccessConstants.ALL);
  your.setServerName("server2");
  your.setAction(AccessConstants.ALL);
  my.setURI("hdfs://namenode:9000/path");
  your.setURI("hdfs://namenode:9000/path/to/../../other");
  assertFalse(my.implies(your));
  my.setURI("file:///path");
  your.setURI("file:///path/to/../../other");
  assertFalse(my.implies(your));
  my.setURI("blah");
  your.setURI("hdfs://namenode:9000/path/to/some/dir");
  assertFalse(my.implies(your));
  my.setURI("hdfs://namenode:9000/path/to/some/dir");
  your.setURI("blah");
  assertFalse(my.implies(your));
  my.setURI("hdfs://namenode:9000/path");
  your.setURI("file:///path/to/some/dir");
  assertFalse(my.implies(your));
  my.setURI("hdfs://namenode:9000/path");
  your.setURI("file://namenode:9000/path/to/some/dir");
  assertFalse(my.implies(your));
  my.setURI("hdfs://namenode1:9000/path");
  your.setURI("hdfs://namenode2:9000/path");
  assertFalse(my.implies(your));
  my.setURI("hdfs://namenode:9000/path");
  your.setURI("hdfs://namenode:9001/path");
  assertFalse(my.implies(your));
  my.setURI("hdfs://namenode:9000/path1");
  your.setURI("hdfs://namenode:9000/path2");
  assertFalse(my.implies(your));
  my.setURI("file:///path1");
  your.setURI("file:///path2");
  assertFalse(my.implies(your));
  your.setServerName("server2");
  my.setURI("hdfs://namenode:9000/path1");
  your.setURI("hdfs://namenode:9000/path1");
  assertFalse(my.implies(your));
  my.setServerName("server1");
  my.setURI("hdfs://namenode:9000/path1");
  your.setServerName("server1");
  your.setURI("");
  assertFalse(my.implies(your));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.persistent.TestSentryServiceDiscovery </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReportError() throws Exception {
  final String hostname1="localhost1";
  final Integer port1=123;
  ServiceRegister register1=new ServiceRegister(haContext);
  register1.regService(hostname1,port1);
  ServiceManager manager=new ServiceManager(haContext);
  ServiceInstance<Void> instance=manager.getServiceInstance();
  manager.reportError(instance);
  instance=manager.getServiceInstance();
  manager.reportError(instance);
  instance=manager.getServiceInstance();
  assertEquals("'instance' should be null.",null,instance);
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRegisterMultiService() throws Exception {
  final String hostname1="localhost1";
  final Integer port1=123;
  final String hostname2="localhost2";
  final Integer port2=456;
  final String hostname3="localhost3";
  final Integer port3=789;
  Map<String,Integer> servicesMap=new HashMap<String,Integer>();
  servicesMap.put(hostname1,port1);
  servicesMap.put(hostname2,port2);
  servicesMap.put(hostname3,port3);
  ServiceRegister register1=new ServiceRegister(haContext);
  register1.regService(hostname1,port1);
  ServiceRegister register2=new ServiceRegister(haContext);
  register2.regService(hostname2,port2);
  ServiceRegister register3=new ServiceRegister(haContext);
  register3.regService(hostname3,port3);
  ServiceManager manager=new ServiceManager(haContext);
  ServiceInstance<Void> instance=manager.getServiceInstance();
  assertEquals("'instance' doesn't match.",instance.getPort(),servicesMap.get(instance.getAddress()));
  instance=manager.getServiceInstance();
  assertEquals("'instance' doesn't match.",instance.getPort(),servicesMap.get(instance.getAddress()));
  instance=manager.getServiceInstance();
  assertEquals("'instance' doesn't match.",instance.getPort(),servicesMap.get(instance.getAddress()));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRegisterOneService() throws Exception {
  final String hostname="localhost1";
  final Integer port=123;
  ServiceRegister register=new ServiceRegister(haContext);
  register.regService(hostname,port);
  ServiceManager manager=new ServiceManager(haContext);
  ServiceInstance<Void> instance=manager.getServiceInstance();
  assertEquals("'hostname' doesn't match.",hostname,instance.getAddress());
  assertEquals("'port' doesn't match.",port,instance.getPort());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.persistent.TestSentryStore </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRenameTableWithColumn() throws Exception {
  String roleName1="role1", roleName2="role2";
  String grantor="g1";
  String table1="tbl1", table2="tbl2";
  sentryStore.createSentryRole(roleName1);
  sentryStore.createSentryRole(roleName2);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName(table1);
  privilege_tbl1.setAction(AccessConstants.SELECT);
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_c1=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_c1.setPrivilegeScope("COLUMN");
  privilege_tbl1_c1.setColumnName("c1");
  privilege_tbl1_c1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_c2=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_c2.setPrivilegeScope("COLUMN");
  privilege_tbl1_c2.setColumnName("c2");
  privilege_tbl1_c2.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_c3=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_c3.setPrivilegeScope("COLUMN");
  privilege_tbl1_c3.setColumnName("c3");
  privilege_tbl1_c3.setCreateTime(System.currentTimeMillis());
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_c1);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_c2);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege_tbl1_c3);
  Set<TSentryPrivilege> privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName1);
  assertEquals(2,privilegeSet.size());
  privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName2);
  assertEquals(1,privilegeSet.size());
  TSentryAuthorizable oldTable=toTSentryAuthorizable(privilege_tbl1);
  TSentryAuthorizable newTable=toTSentryAuthorizable(privilege_tbl1);
  newTable.setTable(table2);
  sentryStore.renamePrivilege(oldTable,newTable);
  privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName1);
  assertEquals(2,privilegeSet.size());
  for (  TSentryPrivilege privilege : privilegeSet) {
    assertTrue(table2.equalsIgnoreCase(privilege.getTableName()));
  }
  privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName2);
  assertEquals(1,privilegeSet.size());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeCheckWithGrantOption() throws Exception {
  String grantor="g1";
  String[] users={"user0","user1","user2"};
  String[] roles={"role0","role1","role2"};
  String[] groups={"group0","group1","group2"};
  for (int i=0; i < users.length; i++) {
    addGroupsToUser(users[i],groups[i]);
    sentryStore.createSentryRole(roles[i]);
    Set<TSentryGroup> tGroups=Sets.newHashSet();
    TSentryGroup tGroup=new TSentryGroup(groups[i]);
    tGroups.add(tGroup);
    sentryStore.alterSentryRoleAddGroups(grantor,roles[i],tGroups);
  }
  writePolicyFile();
  String server="server1";
  String db="db1";
  String table="tbl1";
  String roleName=roles[0];
  grantor="g1";
  TSentryPrivilege privilege1=new TSentryPrivilege();
  privilege1.setPrivilegeScope("DATABASE");
  privilege1.setServerName(server);
  privilege1.setDbName(db);
  privilege1.setAction(AccessConstants.SELECT);
  privilege1.setCreateTime(System.currentTimeMillis());
  privilege1.setGrantOption(TSentryGrantOption.TRUE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege1);
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  roleName=roles[1];
  grantor="g1";
  TSentryPrivilege privilege2=new TSentryPrivilege();
  privilege2.setPrivilegeScope("TABLE");
  privilege2.setServerName(server);
  privilege2.setDbName(db);
  privilege2.setTableName(table);
  privilege2.setAction(AccessConstants.ALL);
  privilege2.setCreateTime(System.currentTimeMillis());
  privilege2.setGrantOption(TSentryGrantOption.FALSE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege2);
  roleName=roles[2];
  grantor="g1";
  TSentryPrivilege privilege3=new TSentryPrivilege();
  privilege3.setPrivilegeScope("TABLE");
  privilege3.setServerName(server);
  privilege3.setDbName(db);
  privilege3.setTableName(table);
  privilege3.setAction(AccessConstants.SELECT);
  privilege3.setCreateTime(System.currentTimeMillis());
  privilege3.setGrantOption(TSentryGrantOption.FALSE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege3);
  roleName=roles[2];
  grantor=users[1];
  boolean isGrantOptionException=false;
  try {
    sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege3);
  }
 catch (  SentryGrantDeniedException e) {
    isGrantOptionException=true;
    System.err.println(e.getMessage());
  }
  assertTrue(isGrantOptionException);
  roleName=roles[1];
  grantor=users[0];
  try {
    sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege2);
  }
 catch (  SentryGrantDeniedException e) {
    isGrantOptionException=true;
    System.err.println(e.getMessage());
  }
  assertTrue(isGrantOptionException);
  roleName=roles[2];
  grantor=users[0];
  sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege3);
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(0,privileges.size());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantRevokePrivilege() throws Exception {
  String roleName="test-privilege";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table="tbl1";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setAction(AccessConstants.ALL);
  privilege.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  privilege.setAction(AccessConstants.SELECT);
  assertEquals(seqId + 2,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  MSentryPrivilege mPrivilege=Iterables.get(privileges,0);
  assertEquals(server,mPrivilege.getServerName());
  assertEquals(db,mPrivilege.getDbName());
  assertEquals(table,mPrivilege.getTableName());
  assertEquals(AccessConstants.INSERT,mPrivilege.getAction());
  assertFalse(mPrivilege.getGrantOption());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Regression test for SENTRY-550
 * Use case:
 * GRANT INSERT on TABLE tbl1 to ROLE role1
 * GRANT SELECT on TABLE tbl1 to ROLE role1
 * GRANT ALTER on TABLE tbl1 to ROLE role1
 * GRANT DROP on TABLE tbl1 to ROLE role1
 * RENAME TABLE tbl1 to tbl2
 * After rename tbl1 to tbl2, table name of all role1's privileges should be "tbl2"
 */
@Test public void testRenameTableWithMultiAction() throws Exception {
  String roleName1="role1";
  String grantor="g1";
  String table1="tbl1", table2="tbl2";
  sentryStore.createSentryRole(roleName1);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName(table1);
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_insert=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_insert.setAction(AccessConstants.INSERT);
  TSentryPrivilege privilege_tbl1_select=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_select.setAction(AccessConstants.SELECT);
  TSentryPrivilege privilege_tbl1_alter=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_alter.setAction(AccessConstants.ALTER);
  TSentryPrivilege privilege_tbl1_drop=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_drop.setAction(AccessConstants.DROP);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_insert);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_select);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_alter);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_drop);
  TSentryAuthorizable oldTable=toTSentryAuthorizable(privilege_tbl1);
  TSentryAuthorizable newTable=toTSentryAuthorizable(privilege_tbl1);
  newTable.setTable(table2);
  sentryStore.renamePrivilege(oldTable,newTable);
  Set<TSentryPrivilege> privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName1);
  assertEquals(4,privilegeSet.size());
  for (  TSentryPrivilege privilege : privilegeSet) {
    assertTrue(table2.equalsIgnoreCase(privilege.getTableName()));
  }
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropOverlappedPrivileges() throws Exception {
  String roleName1="list-privs-r1";
  String grantor="g1";
  sentryStore.createSentryRole(roleName1);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName("tbl1");
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_insert=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_insert.setAction("INSERT");
  TSentryPrivilege privilege_tbl1_all=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_all.setAction("*");
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_insert);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_all);
  sentryStore.dropPrivilege(toTSentryAuthorizable(privilege_tbl1));
  assertEquals(0,sentryStore.getAllTSentryPrivilegesByRoleName(roleName1).size());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropTableWithColumn() throws Exception {
  String roleName1="role1", roleName2="role2";
  String grantor="g1";
  String table1="tbl1";
  sentryStore.createSentryRole(roleName1);
  sentryStore.createSentryRole(roleName2);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName(table1);
  privilege_tbl1.setAction(AccessConstants.SELECT);
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_c1=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_c1.setPrivilegeScope("COLUMN");
  privilege_tbl1_c1.setColumnName("c1");
  privilege_tbl1_c1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_c2=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_c2.setPrivilegeScope("COLUMN");
  privilege_tbl1_c2.setColumnName("c2");
  privilege_tbl1_c2.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_c3=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_c3.setPrivilegeScope("COLUMN");
  privilege_tbl1_c3.setColumnName("c3");
  privilege_tbl1_c3.setCreateTime(System.currentTimeMillis());
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_c1);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_c2);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege_tbl1_c3);
  Set<TSentryPrivilege> privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName1);
  assertEquals(2,privilegeSet.size());
  privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName2);
  assertEquals(1,privilegeSet.size());
  TSentryAuthorizable tableAuthorizable=toTSentryAuthorizable(privilege_tbl1);
  sentryStore.dropPrivilege(tableAuthorizable);
  privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName1);
  assertEquals(0,privilegeSet.size());
  privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName2);
  assertEquals(0,privilegeSet.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCaseSensitiveScope() throws Exception {
  String roleName="role1";
  String grantor="g1";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege sentryPrivilege=new TSentryPrivilege("Database","server1","all");
  sentryPrivilege.setDbName("db1");
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,sentryPrivilege).getSequenceId());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevokeAllGrantOption() throws Exception {
  String grantor="g1";
  String[] users={"user0"};
  String[] roles={"role0"};
  String[] groups={"group0"};
  for (int i=0; i < users.length; i++) {
    addGroupsToUser(users[i],groups[i]);
    sentryStore.createSentryRole(roles[i]);
    Set<TSentryGroup> tGroups=Sets.newHashSet();
    TSentryGroup tGroup=new TSentryGroup(groups[i]);
    tGroups.add(tGroup);
    sentryStore.alterSentryRoleAddGroups(grantor,roles[i],tGroups);
  }
  writePolicyFile();
  String server="server1";
  String db="db1";
  String table="tbl1";
  String roleName=roles[0];
  grantor="g1";
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setAction(AccessConstants.SELECT);
  privilege.setCreateTime(System.currentTimeMillis());
  privilege.setGrantOption(TSentryGrantOption.TRUE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege);
  roleName=roles[0];
  grantor="g1";
  privilege.setGrantOption(TSentryGrantOption.FALSE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege);
  roleName=roles[0];
  grantor="g1";
  privilege.setGrantOption(TSentryGrantOption.UNSET);
  sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege);
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),0,privileges.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateDropRole() throws Exception {
  String roleName="test-drop-role";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  assertEquals(seqId + 1,sentryStore.dropSentryRole(roleName).getSequenceId());
}

</code></pre>

<br>
<pre class="type-7 type-6 type-9 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Create several privileges in the database, then delete the role that
 * created them.  This makes them all orphans.  Wait a bit to ensure the
 * cleanup thread runs, and expect them all to be gone from the database.
 * @throws Exception
 */
@Ignore("Disabled with SENTRY-545 following SENTRY-140 problems") @Test public void testPrivilegeCleanup() throws Exception {
  final String roleName="test-priv-cleanup";
  final String grantor="g1";
  final String server="server";
  final String dBase="db";
  final String table="table-";
  sentryStore.createSentryRole(roleName);
  for (int i=0; i < NUM_PRIVS; i++) {
    TSentryPrivilege priv=new TSentryPrivilege();
    priv.setPrivilegeScope("TABLE");
    priv.setServerName(server);
    priv.setAction(AccessConstants.ALL);
    priv.setCreateTime(System.currentTimeMillis());
    priv.setTableName(table + i);
    priv.setDbName(dBase);
    sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,priv);
  }
  assertEquals(sentryStore.countMSentryPrivileges(),NUM_PRIVS);
  sentryStore.dropSentryRole(roleName);
  verifyOrphanCleanup();
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Assign multiple table and SERVER privileges to roles
 * drop privilege for the object verify that it's removed correctl
 * @throws Exception
 */
@Test public void testDropDbObject() throws Exception {
  String roleName1="list-privs-r1", roleName2="list-privs-r2", roleName3="list-privs-r3";
  String grantor="g1";
  sentryStore.createSentryRole(roleName1);
  sentryStore.createSentryRole(roleName2);
  sentryStore.createSentryRole(roleName3);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName("tbl1");
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege1=new TSentryPrivilege(privilege_tbl1);
  privilege1.setAction("SELECT");
  TSentryPrivilege privilege2_1=new TSentryPrivilege(privilege_tbl1);
  privilege2_1.setAction("INSERT");
  TSentryPrivilege privilege3_1=new TSentryPrivilege(privilege_tbl1);
  privilege3_1.setAction("*");
  TSentryPrivilege privilege_server=new TSentryPrivilege();
  privilege_server.setPrivilegeScope("SERVER");
  privilege_server.setServerName("server1");
  privilege_server.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl2=new TSentryPrivilege();
  privilege_tbl2.setPrivilegeScope("TABLE");
  privilege_tbl2.setServerName("server1");
  privilege_tbl2.setDbName("db1");
  privilege_tbl2.setTableName("tbl2");
  privilege_tbl2.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege2_3=new TSentryPrivilege(privilege_tbl2);
  privilege2_3.setAction("SELECT");
  TSentryPrivilege privilege3_2=new TSentryPrivilege(privilege_tbl2);
  privilege3_2.setAction("INSERT");
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege1);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege2_1);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege_server);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege2_3);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName3,privilege3_1);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName3,privilege3_2);
  sentryStore.dropPrivilege(toTSentryAuthorizable(privilege_tbl1));
  assertEquals(0,sentryStore.getAllTSentryPrivilegesByRoleName(roleName1).size());
  assertEquals(2,sentryStore.getAllTSentryPrivilegesByRoleName(roleName2).size());
  assertEquals(1,sentryStore.getAllTSentryPrivilegesByRoleName(roleName3).size());
  sentryStore.dropPrivilege(toTSentryAuthorizable(privilege_tbl2));
  assertEquals(0,sentryStore.getAllTSentryPrivilegesByRoleName(roleName1).size());
  assertEquals(1,sentryStore.getAllTSentryPrivilegesByRoleName(roleName2).size());
  assertEquals(0,sentryStore.getAllTSentryPrivilegesByRoleName(roleName3).size());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSentryTablePrivilegeSome() throws Exception {
  String roleName="test-table-privilege-some";
  String grantor="g1";
  String dbName="db1";
  String table="tb1";
  sentryStore.createSentryRole(roleName);
  TSentryPrivilege tSentryPrivilege=new TSentryPrivilege("TABLE","server1","ALL");
  tSentryPrivilege.setDbName(dbName);
  tSentryPrivilege.setTableName(table);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,tSentryPrivilege);
  TSentryAuthorizable tSentryAuthorizable=new TSentryAuthorizable();
  tSentryAuthorizable.setDb(dbName);
  tSentryAuthorizable.setTable(AccessConstants.SOME);
  tSentryAuthorizable.setServer("server1");
  Set<TSentryPrivilege> privileges=sentryStore.getTSentryPrivileges(new HashSet<String>(Arrays.asList(roleName)),tSentryAuthorizable);
  assertTrue(privileges.size() == 1);
  Set<TSentryGroup> tSentryGroups=new HashSet<TSentryGroup>();
  tSentryGroups.add(new TSentryGroup("group1"));
  sentryStore.alterSentryRoleAddGroups(grantor,roleName,tSentryGroups);
  TSentryActiveRoleSet thriftRoleSet=new TSentryActiveRoleSet(true,new HashSet<String>(Arrays.asList(roleName)));
  Set<String> privs=sentryStore.listSentryPrivilegesForProvider(new HashSet<String>(Arrays.asList("group1")),thriftRoleSet,tSentryAuthorizable);
  assertTrue(privs.size() == 1);
  assertTrue(privs.contains("server=server1->db=" + dbName + "->table="+ table+ "->action=all"));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantRevokeMultiPrivileges() throws Exception {
  String roleName="test-privilege";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table="tbl1";
  String[] columns={"c1","c2","c3","c4"};
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  Set<TSentryPrivilege> tPrivileges=Sets.newHashSet();
  for (  String column : columns) {
    TSentryPrivilege privilege=new TSentryPrivilege();
    privilege.setPrivilegeScope("Column");
    privilege.setServerName(server);
    privilege.setDbName(db);
    privilege.setTableName(table);
    privilege.setColumnName(column);
    privilege.setAction(AccessConstants.SELECT);
    privilege.setCreateTime(System.currentTimeMillis());
    tPrivileges.add(privilege);
  }
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivileges(grantor,roleName,tPrivileges).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),4,privileges.size());
  tPrivileges=Sets.newHashSet();
  for (int i=0; i < 2; i++) {
    TSentryPrivilege privilege=new TSentryPrivilege();
    privilege.setPrivilegeScope("Column");
    privilege.setServerName(server);
    privilege.setDbName(db);
    privilege.setTableName(table);
    privilege.setColumnName(columns[i]);
    privilege.setAction(AccessConstants.SELECT);
    privilege.setCreateTime(System.currentTimeMillis());
    tPrivileges.add(privilege);
  }
  assertEquals(seqId + 2,sentryStore.alterSentryRoleRevokePrivileges(grantor,roleName,tPrivileges).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("Table");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setAction(AccessConstants.SELECT);
  privilege.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 3,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),0,privileges.size());
}

</code></pre>

<br>
<pre class="type-12 type-16 type-5 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Regression test for SENTRY-552
 */
@Test public void testGrantRevokeColumnPrivilegeDowngradeByDb() throws Exception {
  String roleName="test-column-db-downgrade-privilege";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table="tbl1";
  String column1="c1";
  String column2="c2";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege privilegeCol1=new TSentryPrivilege();
  privilegeCol1.setPrivilegeScope("COLUMN");
  privilegeCol1.setServerName(server);
  privilegeCol1.setDbName(db);
  privilegeCol1.setTableName(table);
  privilegeCol1.setColumnName(column1);
  privilegeCol1.setAction(AccessConstants.ALL);
  privilegeCol1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilegeCol2=privilegeCol1.deepCopy();
  ;
  privilegeCol2.setColumnName(column2);
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilegeCol1).getSequenceId());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilegeCol2).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  privilegeCol2.setAction(AccessConstants.SELECT);
  assertEquals(seqId + 3,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilegeCol2).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  for (  MSentryPrivilege mPrivilege : privileges) {
    assertEquals(server,mPrivilege.getServerName());
    assertEquals(db,mPrivilege.getDbName());
    assertEquals(table,mPrivilege.getTableName());
    assertFalse(mPrivilege.getGrantOption());
    if (mPrivilege.getColumnName().equals(column1)) {
      assertEquals(AccessConstants.ALL,mPrivilege.getAction());
    }
 else     if (mPrivilege.getColumnName().equals(column2)) {
      assertEquals(AccessConstants.INSERT,mPrivilege.getAction());
    }
 else {
      fail("Unexpected column name: " + mPrivilege.getColumnName());
    }
  }
  privilegeCol2.setAction(AccessConstants.INSERT);
  privilegeCol2.setPrivilegeScope("DATABASE");
  privilegeCol2.unsetTableName();
  privilegeCol2.unsetColumnName();
  assertEquals(seqId + 4,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilegeCol2).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  MSentryPrivilege mPrivilege=Iterables.get(privileges,0);
  assertEquals(server,mPrivilege.getServerName());
  assertEquals(db,mPrivilege.getDbName());
  assertEquals(table,mPrivilege.getTableName());
  assertEquals(column1,mPrivilege.getColumnName());
  assertEquals(AccessConstants.SELECT,mPrivilege.getAction());
  assertFalse(mPrivilege.getGrantOption());
}

</code></pre>

<br>
<pre class="type-12 type-16 type-5 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Regression test for SENTRY-552
 */
@Test public void testGrantRevokeTablePrivilegeDowngradeByDb() throws Exception {
  String roleName="test-table-db-downgrade-privilege";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table1="tbl1";
  String table2="tbl2";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege privilegeTable1=new TSentryPrivilege();
  privilegeTable1.setPrivilegeScope("TABLE");
  privilegeTable1.setServerName(server);
  privilegeTable1.setDbName(db);
  privilegeTable1.setTableName(table1);
  privilegeTable1.setAction(AccessConstants.ALL);
  privilegeTable1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilegeTable2=privilegeTable1.deepCopy();
  ;
  privilegeTable2.setTableName(table2);
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilegeTable1).getSequenceId());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilegeTable2).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  privilegeTable2.setAction(AccessConstants.SELECT);
  assertEquals(seqId + 3,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilegeTable2).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  for (  MSentryPrivilege mPrivilege : privileges) {
    assertEquals(server,mPrivilege.getServerName());
    assertEquals(db,mPrivilege.getDbName());
    assertFalse(mPrivilege.getGrantOption());
    if (mPrivilege.getTableName().equals(table1)) {
      assertEquals(AccessConstants.ALL,mPrivilege.getAction());
    }
 else     if (mPrivilege.getTableName().equals(table2)) {
      assertEquals(AccessConstants.INSERT,mPrivilege.getAction());
    }
 else {
      fail("Unexpected table name: " + mPrivilege.getTableName());
    }
  }
  privilegeTable2.setAction(AccessConstants.INSERT);
  privilegeTable2.setPrivilegeScope("DATABASE");
  privilegeTable2.unsetTableName();
  assertEquals(seqId + 4,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilegeTable2).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  MSentryPrivilege mPrivilege=Iterables.get(privileges,0);
  assertEquals(server,mPrivilege.getServerName());
  assertEquals(db,mPrivilege.getDbName());
  assertEquals(table1,mPrivilege.getTableName());
  assertEquals(AccessConstants.SELECT,mPrivilege.getAction());
  assertFalse(mPrivilege.getGrantOption());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListRole() throws Exception {
  String roleName1="role1", roleName2="role2", roleName3="role3";
  String group1="group1", group2="group2";
  String grantor="g1";
  sentryStore.createSentryRole(roleName1);
  sentryStore.createSentryRole(roleName2);
  sentryStore.createSentryRole(roleName3);
  sentryStore.alterSentryRoleAddGroups(grantor,roleName1,Sets.newHashSet(new TSentryGroup(group1)));
  sentryStore.alterSentryRoleAddGroups(grantor,roleName2,Sets.newHashSet(new TSentryGroup(group2)));
  sentryStore.alterSentryRoleAddGroups(grantor,roleName3,Sets.newHashSet(new TSentryGroup(group1),new TSentryGroup(group2)));
  assertEquals(2,sentryStore.getTSentryRolesByGroupName(Sets.newHashSet(group1),false).size());
  assertEquals(2,sentryStore.getTSentryRolesByGroupName(Sets.newHashSet(group2),false).size());
  assertEquals(3,sentryStore.getTSentryRolesByGroupName(Sets.newHashSet(group1,group2),false).size());
  assertEquals(0,sentryStore.getTSentryRolesByGroupName(Sets.newHashSet("foo"),true).size());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantCheckWithColumn() throws Exception {
  String grantor="g1";
  String[] users={"user0","user1"};
  String[] roles={"role0","role1"};
  String[] groups={"group0","group1"};
  for (int i=0; i < users.length; i++) {
    addGroupsToUser(users[i],groups[i]);
    sentryStore.createSentryRole(roles[i]);
    Set<TSentryGroup> tGroups=Sets.newHashSet();
    TSentryGroup tGroup=new TSentryGroup(groups[i]);
    tGroups.add(tGroup);
    sentryStore.alterSentryRoleAddGroups(grantor,roles[i],tGroups);
  }
  writePolicyFile();
  String server="server1";
  String db="db1";
  String table="tbl1";
  String roleName=roles[0];
  grantor="g1";
  TSentryPrivilege privilege1=new TSentryPrivilege();
  privilege1.setPrivilegeScope("TABLE");
  privilege1.setServerName(server);
  privilege1.setDbName(db);
  privilege1.setTableName(table);
  privilege1.setAction(AccessConstants.SELECT);
  privilege1.setCreateTime(System.currentTimeMillis());
  privilege1.setGrantOption(TSentryGrantOption.TRUE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege1);
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  roleName=roles[1];
  grantor=users[0];
  String column="c1";
  TSentryPrivilege privilege2=new TSentryPrivilege();
  privilege2.setPrivilegeScope("COLUMN");
  privilege2.setServerName(server);
  privilege2.setDbName(db);
  privilege2.setTableName(table);
  privilege2.setColumnName(column);
  privilege2.setAction(AccessConstants.SELECT);
  privilege2.setCreateTime(System.currentTimeMillis());
  privilege2.setGrantOption(TSentryGrantOption.TRUE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege2);
  roleName=roles[0];
  grantor=users[1];
  boolean isGrantOptionException=false;
  try {
    sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege1);
  }
 catch (  SentryGrantDeniedException e) {
    isGrantOptionException=true;
    System.err.println(e.getMessage());
  }
  assertTrue(isGrantOptionException);
  roleName=roles[1];
  grantor=users[0];
  sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege2);
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(0,privileges.size());
}

</code></pre>

<br>
<pre class="type-17 type-12 type-7 type-6 type-9 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Much like testPrivilegeCleanup, make a lot of privileges and make sure
 * they get cleaned up.  The difference here is that the privileges are
 * created by granting ALL and then removing SELECT - thus leaving INSERT.
 * This test exists because the revocation plays havoc with the orphan
 * cleanup thread.
 * @throws Exception
 */
@Ignore("Disabled with SENTRY-545 following SENTRY-140 problems") @Test public void testPrivilegeCleanup2() throws Exception {
  final String roleName="test-priv-cleanup";
  final String grantor="g1";
  final String server="server";
  final String dBase="db";
  final String table="table-";
  sentryStore.createSentryRole(roleName);
  for (int i=0; i < NUM_PRIVS; i++) {
    TSentryPrivilege priv=new TSentryPrivilege();
    priv.setPrivilegeScope("DATABASE");
    priv.setServerName(server);
    priv.setAction(AccessConstants.ALL);
    priv.setCreateTime(System.currentTimeMillis());
    priv.setTableName(table + i);
    priv.setDbName(dBase);
    priv.setGrantOption(TSentryGrantOption.TRUE);
    sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,priv);
    priv.setAction(AccessConstants.SELECT);
    priv.setGrantOption(TSentryGrantOption.UNSET);
    sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,priv);
    MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
    Set<MSentryPrivilege> privileges=role.getPrivileges();
    assertEquals(privileges.toString(),i + 1,privileges.size());
    MSentryPrivilege mPrivilege=Iterables.get(privileges,0);
    assertEquals(AccessConstants.INSERT,mPrivilege.getAction());
  }
  sentryStore.dropSentryRole(roleName);
  verifyOrphanCleanup();
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCaseInsensitiveRole() throws Exception {
  String roleName="newRole";
  String grantor="g1";
  Set<TSentryGroup> groups=Sets.newHashSet();
  TSentryGroup group=new TSentryGroup();
  group.setGroupName("test-groups-g1");
  groups.add(group);
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName("server1");
  privilege.setDbName("default");
  privilege.setTableName("table1");
  privilege.setAction(AccessConstants.ALL);
  privilege.setCreateTime(System.currentTimeMillis());
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  assertEquals(seqId + 1,sentryStore.alterSentryRoleAddGroups(grantor,roleName,groups).getSequenceId());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleDeleteGroups(roleName,groups).getSequenceId());
  assertEquals(seqId + 3,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  assertEquals(seqId + 4,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create roles and assign privileges for same table rename the privileges for
 * the table and verify the new privileges
 * @throws Exception
 */
@Test public void testRenameTable() throws Exception {
  String roleName1="role1", roleName2="role2", roleName3="role3";
  String grantor="g1";
  String table1="tbl1", table2="tbl2";
  sentryStore.createSentryRole(roleName1);
  sentryStore.createSentryRole(roleName2);
  sentryStore.createSentryRole(roleName3);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName(table1);
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_insert=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_insert.setAction(AccessConstants.INSERT);
  TSentryPrivilege privilege_tbl1_select=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_select.setAction(AccessConstants.SELECT);
  TSentryPrivilege privilege_tbl1_all=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_all.setAction(AccessConstants.ALL);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_insert);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege_tbl1_select);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName3,privilege_tbl1_all);
  TSentryAuthorizable oldTable=toTSentryAuthorizable(privilege_tbl1);
  TSentryAuthorizable newTable=toTSentryAuthorizable(privilege_tbl1);
  newTable.setTable(table2);
  sentryStore.renamePrivilege(oldTable,newTable);
  for (  String roleName : Sets.newHashSet(roleName1,roleName2,roleName3)) {
    Set<TSentryPrivilege> privilegeSet=sentryStore.getAllTSentryPrivilegesByRoleName(roleName);
    assertEquals(1,privilegeSet.size());
    for (    TSentryPrivilege privilege : privilegeSet) {
      assertTrue(table2.equalsIgnoreCase(privilege.getTableName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testSentryColumnPrivilegeSome() throws Exception {
  String roleName="test-column-privilege-some";
  String grantor="g1";
  String dbName="db1";
  String table="tb1";
  String column="col1";
  sentryStore.createSentryRole(roleName);
  TSentryPrivilege tSentryPrivilege=new TSentryPrivilege("TABLE","server1","ALL");
  tSentryPrivilege.setDbName(dbName);
  tSentryPrivilege.setTableName(table);
  tSentryPrivilege.setColumnName(column);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,tSentryPrivilege);
  TSentryAuthorizable tSentryAuthorizable=new TSentryAuthorizable();
  tSentryAuthorizable.setDb(dbName);
  tSentryAuthorizable.setTable(table);
  tSentryAuthorizable.setColumn(AccessConstants.SOME);
  tSentryAuthorizable.setServer("server1");
  Set<TSentryPrivilege> privileges=sentryStore.getTSentryPrivileges(new HashSet<String>(Arrays.asList(roleName)),tSentryAuthorizable);
  assertTrue(privileges.size() == 1);
  Set<TSentryGroup> tSentryGroups=new HashSet<TSentryGroup>();
  tSentryGroups.add(new TSentryGroup("group1"));
  sentryStore.alterSentryRoleAddGroups(grantor,roleName,tSentryGroups);
  TSentryActiveRoleSet thriftRoleSet=new TSentryActiveRoleSet(true,new HashSet<String>(Arrays.asList(roleName)));
  Set<String> privs=sentryStore.listSentryPrivilegesForProvider(new HashSet<String>(Arrays.asList("group1")),thriftRoleSet,tSentryAuthorizable);
  assertTrue(privs.size() == 1);
  assertTrue(privs.contains("server=server1->db=" + dbName + "->table="+ table+ "->column="+ column+ "->action=all"));
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testURI() throws Exception {
  String roleName="test-dup-role";
  String grantor="g1";
  String uri="file:///var/folders/dt/9zm44z9s6bjfxbrm4v36lzdc0000gp/T/1401860678102-0/data/kv1.dat";
  sentryStore.createSentryRole(roleName);
  TSentryPrivilege tSentryPrivilege=new TSentryPrivilege("URI","server1","ALL");
  tSentryPrivilege.setURI(uri);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,tSentryPrivilege);
  TSentryAuthorizable tSentryAuthorizable=new TSentryAuthorizable();
  tSentryAuthorizable.setUri(uri);
  tSentryAuthorizable.setServer("server1");
  Set<TSentryPrivilege> privileges=sentryStore.getTSentryPrivileges(new HashSet<String>(Arrays.asList(roleName)),tSentryAuthorizable);
  assertTrue(privileges.size() == 1);
  Set<TSentryGroup> tSentryGroups=new HashSet<TSentryGroup>();
  tSentryGroups.add(new TSentryGroup("group1"));
  sentryStore.alterSentryRoleAddGroups(grantor,roleName,tSentryGroups);
  TSentryActiveRoleSet thriftRoleSet=new TSentryActiveRoleSet(true,new HashSet<String>(Arrays.asList(roleName)));
  Set<String> privs=sentryStore.listSentryPrivilegesForProvider(new HashSet<String>(Arrays.asList("group1")),thriftRoleSet,tSentryAuthorizable);
  assertTrue(privs.size() == 1);
  assertTrue(privs.contains("server=server1->uri=" + uri + "->action=all"));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSentryPrivilegeSize() throws Exception {
  String role1="role1";
  String role2="role2";
  sentryStore.createSentryRole(role1);
  sentryStore.createSentryRole(role2);
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName("server1");
  privilege.setDbName("db1");
  privilege.setTableName("tb1");
  privilege.setCreateTime(System.currentTimeMillis());
  String grantor="g1";
  assertEquals(new Long(0),sentryStore.getPrivilegeCountGauge().getValue());
  sentryStore.alterSentryRoleGrantPrivilege(grantor,role1,privilege);
  assertEquals(new Long(1),sentryStore.getPrivilegeCountGauge().getValue());
  sentryStore.alterSentryRoleGrantPrivilege(grantor,role2,privilege);
  assertEquals(new Long(1),sentryStore.getPrivilegeCountGauge().getValue());
  privilege.setTableName("tb2");
  sentryStore.alterSentryRoleGrantPrivilege(grantor,role2,privilege);
  assertEquals(new Long(2),sentryStore.getPrivilegeCountGauge().getValue());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantCheckWithGrantOption() throws Exception {
  String grantor="g1";
  String[] users={"user0","user1","user2","user3","user4"};
  String[] roles={"role0","role1","role2","role3","role4"};
  String[] groups={"group0","group1","group2","group3","group4"};
  for (int i=0; i < users.length; i++) {
    addGroupsToUser(users[i],groups[i]);
    sentryStore.createSentryRole(roles[i]);
    Set<TSentryGroup> tGroups=Sets.newHashSet();
    TSentryGroup tGroup=new TSentryGroup(groups[i]);
    tGroups.add(tGroup);
    sentryStore.alterSentryRoleAddGroups(grantor,roles[i],tGroups);
  }
  writePolicyFile();
  String server="server1";
  String db="db1";
  String table="tbl1";
  String roleName=roles[0];
  grantor="g1";
  TSentryPrivilege privilege1=new TSentryPrivilege();
  privilege1.setPrivilegeScope("DATABASE");
  privilege1.setServerName(server);
  privilege1.setDbName(db);
  privilege1.setAction(AccessConstants.ALL);
  privilege1.setCreateTime(System.currentTimeMillis());
  privilege1.setGrantOption(TSentryGrantOption.TRUE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege1);
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  roleName=roles[1];
  grantor=users[0];
  TSentryPrivilege privilege2=new TSentryPrivilege();
  privilege2.setPrivilegeScope("DATABASE");
  privilege2.setServerName(server);
  privilege2.setDbName(db);
  privilege2.setAction(AccessConstants.SELECT);
  privilege2.setCreateTime(System.currentTimeMillis());
  privilege2.setGrantOption(TSentryGrantOption.TRUE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege2);
  roleName=roles[2];
  grantor=users[0];
  TSentryPrivilege privilege3=new TSentryPrivilege();
  privilege3.setPrivilegeScope("TABLE");
  privilege3.setServerName(server);
  privilege3.setDbName(db);
  privilege3.setTableName(table);
  privilege3.setAction(AccessConstants.ALL);
  privilege3.setCreateTime(System.currentTimeMillis());
  privilege3.setGrantOption(TSentryGrantOption.FALSE);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege3);
  roleName=roles[3];
  grantor=users[1];
  TSentryPrivilege privilege4=new TSentryPrivilege();
  privilege4.setPrivilegeScope("DATABASE");
  privilege4.setServerName(server);
  privilege4.setDbName(db);
  privilege4.setAction(AccessConstants.INSERT);
  privilege4.setCreateTime(System.currentTimeMillis());
  privilege4.setGrantOption(TSentryGrantOption.FALSE);
  boolean isGrantOptionException=false;
  try {
    sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege4);
  }
 catch (  SentryGrantDeniedException e) {
    isGrantOptionException=true;
    System.err.println(e.getMessage());
  }
  assertTrue(isGrantOptionException);
  roleName=roles[4];
  grantor=users[2];
  TSentryPrivilege privilege5=new TSentryPrivilege();
  privilege5.setPrivilegeScope("TABLE");
  privilege5.setServerName(server);
  privilege5.setDbName(db);
  privilege5.setTableName(table);
  privilege5.setAction(AccessConstants.INSERT);
  privilege5.setCreateTime(System.currentTimeMillis());
  privilege5.setGrantOption(TSentryGrantOption.FALSE);
  isGrantOptionException=false;
  try {
    sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege5);
  }
 catch (  SentryGrantDeniedException e) {
    isGrantOptionException=true;
    System.err.println(e.getMessage());
  }
  assertTrue(isGrantOptionException);
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testListSentryPrivilegesForProvider() throws Exception {
  String roleName1="list-privs-r1", roleName2="list-privs-r2";
  String groupName1="list-privs-g1", groupName2="list-privs-g2";
  String grantor="g1";
  long seqId=sentryStore.createSentryRole(roleName1).getSequenceId();
  assertEquals(seqId + 1,sentryStore.createSentryRole(roleName2).getSequenceId());
  TSentryPrivilege privilege1=new TSentryPrivilege();
  privilege1.setPrivilegeScope("TABLE");
  privilege1.setServerName("server1");
  privilege1.setDbName("db1");
  privilege1.setTableName("tbl1");
  privilege1.setAction("SELECT");
  privilege1.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege1).getSequenceId());
  assertEquals(seqId + 3,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege1).getSequenceId());
  TSentryPrivilege privilege2=new TSentryPrivilege();
  privilege2.setPrivilegeScope("SERVER");
  privilege2.setServerName("server1");
  privilege2.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 4,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName2,privilege2).getSequenceId());
  Set<TSentryGroup> groups=Sets.newHashSet();
  TSentryGroup group=new TSentryGroup();
  group.setGroupName(groupName1);
  groups.add(group);
  assertEquals(seqId + 5,sentryStore.alterSentryRoleAddGroups(grantor,roleName1,groups).getSequenceId());
  groups.clear();
  group=new TSentryGroup();
  group.setGroupName(groupName2);
  groups.add(group);
  assertEquals(seqId + 6,sentryStore.alterSentryRoleAddGroups(grantor,roleName1,groups).getSequenceId());
  assertEquals(seqId + 7,sentryStore.alterSentryRoleAddGroups(grantor,roleName2,groups).getSequenceId());
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1),new TSentryActiveRoleSet(true,new HashSet<String>()))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1),new TSentryActiveRoleSet(false,Sets.newHashSet(roleName1)))));
  assertEquals(Sets.newHashSet(),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1),new TSentryActiveRoleSet(false,Sets.newHashSet("not a role")))));
  assertEquals(Sets.newHashSet(),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1),new TSentryActiveRoleSet(false,new HashSet<String>()))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select","server=server1"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName2),new TSentryActiveRoleSet(true,new HashSet<String>()))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName2),new TSentryActiveRoleSet(false,Sets.newHashSet(roleName1)))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select","server=server1"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName2),new TSentryActiveRoleSet(false,Sets.newHashSet(roleName2)))));
  assertEquals(Sets.newHashSet(),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName2),new TSentryActiveRoleSet(false,Sets.newHashSet("not a role")))));
  assertEquals(Sets.newHashSet(),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName2),new TSentryActiveRoleSet(false,new HashSet<String>()))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select","server=server1"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1,groupName2),new TSentryActiveRoleSet(true,new HashSet<String>()))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1,groupName2),new TSentryActiveRoleSet(false,Sets.newHashSet(roleName1)))));
  assertEquals(Sets.newHashSet("server=server1->db=db1->table=tbl1->action=select","server=server1"),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1,groupName2),new TSentryActiveRoleSet(false,Sets.newHashSet(roleName2)))));
  assertEquals(Sets.newHashSet(),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1,groupName2),new TSentryActiveRoleSet(false,Sets.newHashSet("not a role")))));
  assertEquals(Sets.newHashSet(),SentryStore.toTrimedLower(sentryStore.listAllSentryPrivilegesForProvider(Sets.newHashSet(groupName1,groupName2),new TSentryActiveRoleSet(false,new HashSet<String>()))));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Regression test for SENTRY-547 and SENTRY-548
 * Use case:
 * GRANT INSERT on TABLE tbl1 to ROLE role1
 * GRANT SELECT on TABLE tbl1 to ROLE role1
 * GRANT ALTER on TABLE tbl1 to ROLE role1
 * GRANT DROP on TABLE tbl1 to ROLE role1
 * DROP TABLE tbl1
 * After drop tbl1, role1 should have 0 privileges
 */
@Test public void testDropTableWithMultiAction() throws Exception {
  String roleName1="role1";
  String grantor="g1";
  sentryStore.createSentryRole(roleName1);
  TSentryPrivilege privilege_tbl1=new TSentryPrivilege();
  privilege_tbl1.setPrivilegeScope("TABLE");
  privilege_tbl1.setServerName("server1");
  privilege_tbl1.setDbName("db1");
  privilege_tbl1.setTableName("tbl1");
  privilege_tbl1.setCreateTime(System.currentTimeMillis());
  TSentryPrivilege privilege_tbl1_insert=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_insert.setAction(AccessConstants.INSERT);
  TSentryPrivilege privilege_tbl1_select=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_select.setAction(AccessConstants.SELECT);
  TSentryPrivilege privilege_tbl1_alter=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_alter.setAction(AccessConstants.ALTER);
  TSentryPrivilege privilege_tbl1_drop=new TSentryPrivilege(privilege_tbl1);
  privilege_tbl1_drop.setAction(AccessConstants.DROP);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_insert);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_select);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_alter);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName1,privilege_tbl1_drop);
  assertEquals(4,sentryStore.getAllTSentryPrivilegesByRoleName(roleName1).size());
  sentryStore.dropPrivilege(toTSentryAuthorizable(privilege_tbl1));
  assertEquals(0,sentryStore.getAllTSentryPrivilegesByRoleName(roleName1).size());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantDuplicatePrivilege() throws Exception {
  String roleName="test-privilege";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table="tbl1";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setAction(AccessConstants.ALL);
  privilege.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  privilege.setServerName("Server1");
  privilege.setDbName("DB1");
  privilege.setTableName("TBL1");
  assertEquals(seqId + 3,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSentryGroupsSize() throws Exception {
  String role1="role1";
  String role2="role2";
  sentryStore.createSentryRole(role1);
  sentryStore.createSentryRole(role2);
  Set<TSentryGroup> groups=Sets.newHashSet();
  TSentryGroup group=new TSentryGroup();
  group.setGroupName("group1");
  groups.add(group);
  String grantor="g1";
  sentryStore.alterSentryRoleAddGroups(grantor,role1,groups);
  assertEquals(new Long(1),sentryStore.getGroupCountGauge().getValue());
  sentryStore.alterSentryRoleAddGroups(grantor,role2,groups);
  assertEquals(new Long(1),sentryStore.getGroupCountGauge().getValue());
  groups.add(new TSentryGroup("group2"));
  sentryStore.alterSentryRoleAddGroups(grantor,role2,groups);
  assertEquals(new Long(2),sentryStore.getGroupCountGauge().getValue());
}

</code></pre>

<br>
<pre class="type-16 type-5 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Regression test for SENTRY-74 and SENTRY-552
 */
@Test public void testGrantRevokePrivilegeWithColumn() throws Exception {
  String roleName="test-col-privilege";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table="tbl1";
  String column1="c1";
  String column2="c2";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("COLUMN");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setColumnName(column1);
  privilege.setAction(AccessConstants.ALL);
  privilege.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  privilege.setColumnName(column2);
  assertEquals(seqId + 2,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  privilege.setAction(AccessConstants.SELECT);
  assertEquals(seqId + 3,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),2,privileges.size());
  for (  MSentryPrivilege mPrivilege : privileges) {
    assertEquals(server,mPrivilege.getServerName());
    assertEquals(db,mPrivilege.getDbName());
    assertEquals(table,mPrivilege.getTableName());
    assertFalse(mPrivilege.getGrantOption());
    if (mPrivilege.getColumnName().equals(column1)) {
      assertEquals(AccessConstants.ALL,mPrivilege.getAction());
    }
 else     if (mPrivilege.getColumnName().equals(column2)) {
      assertEquals(AccessConstants.INSERT,mPrivilege.getAction());
    }
 else {
      fail("Unexpected column name: " + mPrivilege.getColumnName());
    }
  }
  privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setAction(AccessConstants.INSERT);
  privilege.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 4,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  assertEquals(column1,Iterables.get(privileges,0).getColumnName());
  assertEquals(AccessConstants.SELECT,Iterables.get(privileges,0).getAction());
  privilege.setAction(AccessConstants.ALL);
  privilege.setCreateTime(System.currentTimeMillis());
  assertEquals(seqId + 5,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),0,privileges.size());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGrantRevokePrivilegeWithGrantOption() throws Exception {
  String roleName="test-grantOption-table";
  String grantor="g1";
  String server="server1";
  String db="db1";
  String table="tbl1";
  TSentryGrantOption grantOption=TSentryGrantOption.TRUE;
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  TSentryPrivilege privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("TABLE");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setTableName(table);
  privilege.setAction(AccessConstants.ALL);
  privilege.setCreateTime(System.currentTimeMillis());
  privilege.setGrantOption(grantOption);
  assertEquals(seqId + 1,sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  Set<MSentryPrivilege> privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  assertEquals(Boolean.valueOf(privilege.getGrantOption().toString()),Iterables.get(privileges,0).getGrantOption());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege).getSequenceId());
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(0,privileges.size());
  roleName="test-grantOption-db";
  sentryStore.createSentryRole(roleName);
  privilege=new TSentryPrivilege();
  privilege.setPrivilegeScope("DATABASE");
  privilege.setServerName(server);
  privilege.setDbName(db);
  privilege.setAction(AccessConstants.ALL);
  privilege.setGrantOption(TSentryGrantOption.TRUE);
  privilege.setCreateTime(System.currentTimeMillis());
  privilege.setGrantOption(grantOption);
  sentryStore.alterSentryRoleGrantPrivilege(grantor,roleName,privilege);
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  privilege.setAction(AccessConstants.SELECT);
  privilege.setGrantOption(TSentryGrantOption.UNSET);
  sentryStore.alterSentryRoleRevokePrivilege(grantor,roleName,privilege);
  role=sentryStore.getMSentryRoleByName(roleName);
  privileges=role.getPrivileges();
  assertEquals(privileges.toString(),1,privileges.size());
  MSentryPrivilege mPrivilege=Iterables.get(privileges,0);
  assertEquals(server,mPrivilege.getServerName());
  assertEquals(db,mPrivilege.getDbName());
  assertEquals(AccessConstants.INSERT,mPrivilege.getAction());
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddDeleteGroups() throws Exception {
  String roleName="test-groups";
  String grantor="g1";
  long seqId=sentryStore.createSentryRole(roleName).getSequenceId();
  Set<TSentryGroup> groups=Sets.newHashSet();
  TSentryGroup group=new TSentryGroup();
  group.setGroupName("test-groups-g1");
  groups.add(group);
  group=new TSentryGroup();
  group.setGroupName("test-groups-g2");
  groups.add(group);
  assertEquals(seqId + 1,sentryStore.alterSentryRoleAddGroups(grantor,roleName,groups).getSequenceId());
  assertEquals(seqId + 2,sentryStore.alterSentryRoleDeleteGroups(roleName,groups).getSequenceId());
  MSentryRole role=sentryStore.getMSentryRoleByName(roleName);
  assertEquals(Collections.emptySet(),role.getGroups());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.persistent.TestSentryStoreImportExport </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImportExportPolicy6() throws Exception {
  TSentryMappingData tSentryMappingData1=new TSentryMappingData();
  Map<String,Set<String>> sentryGroupRolesMap1=Maps.newHashMap();
  Map<String,Set<TSentryPrivilege>> sentryRolePrivilegesMap1=Maps.newHashMap();
  sentryGroupRolesMap1.put("group1",Sets.newHashSet("role1","role2"));
  sentryGroupRolesMap1.put("group2",Sets.newHashSet("role2"));
  tSentryMappingData1.setGroupRolesMap(sentryGroupRolesMap1);
  tSentryMappingData1.setRolePrivilegesMap(sentryRolePrivilegesMap1);
  sentryStore.importSentryMetaData(tSentryMappingData1,false);
  sentryStore.dropSentryRole("role2");
  Map<String,MSentryRole> rolesMap=sentryStore.getRolesMap();
  Map<String,MSentryGroup> groupsMap=sentryStore.getGroupNameTGroupMap();
  List<MSentryPrivilege> privilegesList=sentryStore.getPrivilegesList();
  verifyRoles(rolesMap,Sets.newHashSet("role1"));
  verifyGroups(groupsMap,Sets.newHashSet("group1","group2"));
  assertTrue(privilegesList.isEmpty());
  Map<String,Set<String>> actualGroupRolesMap=sentryStore.getGroupNameRoleNamesMap();
  Map<String,Set<String>> exceptedGroupRolesMap=Maps.newHashMap();
  exceptedGroupRolesMap.put("group1",Sets.newHashSet("role1"));
  verifyGroupRolesMap(actualGroupRolesMap,exceptedGroupRolesMap);
  Map<String,Set<TSentryPrivilege>> actualRolePrivilegesMap=sentryStore.getRoleNameTPrivilegesMap();
  assertTrue(actualRolePrivilegesMap.isEmpty());
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testImportExportPolicy5() throws Exception {
  TSentryMappingData tSentryMappingData1=new TSentryMappingData();
  Map<String,Set<String>> sentryGroupRolesMap1=Maps.newHashMap();
  Map<String,Set<TSentryPrivilege>> sentryRolePrivilegesMap1=Maps.newHashMap();
  sentryGroupRolesMap1.put("group1",Sets.newHashSet("role1","role2"));
  tSentryMappingData1.setGroupRolesMap(sentryGroupRolesMap1);
  tSentryMappingData1.setRolePrivilegesMap(sentryRolePrivilegesMap1);
  sentryStore.importSentryMetaData(tSentryMappingData1,false);
  Map<String,MSentryRole> rolesMap=sentryStore.getRolesMap();
  Map<String,MSentryGroup> groupsMap=sentryStore.getGroupNameTGroupMap();
  List<MSentryPrivilege> privilegesList=sentryStore.getPrivilegesList();
  verifyRoles(rolesMap,Sets.newHashSet("role1","role2"));
  verifyGroups(groupsMap,Sets.newHashSet("group1"));
  assertTrue(privilegesList.isEmpty());
  Map<String,Set<String>> actualGroupRolesMap=sentryStore.getGroupNameRoleNamesMap();
  Map<String,Set<String>> exceptedGroupRolesMap=Maps.newHashMap();
  exceptedGroupRolesMap.put("group1",Sets.newHashSet("role1","role2"));
  verifyGroupRolesMap(actualGroupRolesMap,exceptedGroupRolesMap);
  Map<String,Set<TSentryPrivilege>> actualRolePrivilegesMap=sentryStore.getRoleNameTPrivilegesMap();
  assertTrue(actualRolePrivilegesMap.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.persistent.TestSentryVersion </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * With schema verification turned off, Sentry Store should autoCreate the
 * schema
 * @throws Exception
 */
@Test public void testSentryImplicitVersion() throws Exception {
  conf.set(ServerConfig.SENTRY_VERIFY_SCHEM_VERSION,"false");
  SentryStore sentryStore=new SentryStore(conf);
  assertEquals(SentryStoreSchemaInfo.getSentryVersion(),sentryStore.getSentryVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.thrift.TestSentryPolicyStoreProcessor </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConfigMultipleNotificationHandlers() throws Exception {
  conf.set(PolicyStoreServerConfig.NOTIFICATION_HANDLERS,NoopNotificationHandler.class.getName() + "," + NoopNotificationHandler.class.getName()+ " "+ NoopNotificationHandler.class.getName());
  Assert.assertEquals(3,SentryPolicyStoreProcessor.createHandlers(conf).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.thrift.TestSentryServiceIntegration </h4><pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      String requestorUserName=ADMIN_USER;
      Set<String> requestorUserGroupNames=Sets.newHashSet(ADMIN_GROUP);
      String roleName="admin_testdb";
      String groupName="group1";
      setLocalGroupMapping(requestorUserName,requestorUserGroupNames);
      writePolicyFile();
      client.dropRoleIfExists(requestorUserName,roleName);
      client.createRole(requestorUserName,roleName);
      Set<TSentryRole> roles=client.listRoles(requestorUserName);
      assertEquals("Incorrect number of roles",1,roles.size());
      client.grantRoleToGroup(requestorUserName,groupName,roleName);
      Set<TSentryRole> groupRoles=client.listRolesByGroupName(requestorUserName,groupName);
      assertTrue(groupRoles.size() == 1);
      for (      TSentryRole role : groupRoles) {
        assertTrue(role.getRoleName(),role.getRoleName().equalsIgnoreCase(roleName));
        assertTrue(role.getGroups().size() == 1);
        for (        TSentryGroup group : role.getGroups()) {
          assertTrue(group.getGroupName(),group.getGroupName().equalsIgnoreCase(groupName));
        }
      }
      client.dropRole(requestorUserName,roleName);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.thrift.TestSentryServiceWithInvalidMsgSize </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the case when the message size is larger than the client's thrift max message size.
 */
@Test public void testClientWithSmallMaxMsgSize() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      Configuration confWithSmallMaxMsgSize=new Configuration(conf);
      confWithSmallMaxMsgSize.setLong(ServiceConstants.ClientConfig.SENTRY_POLICY_CLIENT_THRIFT_MAX_MESSAGE_SIZE,20);
      SentryPolicyServiceClient clientWithSmallMaxMsgSize=SentryServiceClientFactory.create(confWithSmallMaxMsgSize);
      setLocalGroupMapping(ADMIN_USER,REQUESTER_USER_GROUP_NAMES);
      writePolicyFile();
      boolean exceptionThrown=false;
      try {
        clientWithSmallMaxMsgSize.listRoles(ADMIN_USER);
      }
 catch (      SentryUserException e) {
        exceptionThrown=true;
        Assert.assertTrue(e.getMessage().contains("Thrift exception occurred"));
        Assert.assertTrue(e.getCause().getMessage().contains("Length exceeded max allowed"));
      }
 finally {
        Assert.assertEquals(true,exceptionThrown);
        clientWithSmallMaxMsgSize.close();
      }
      client.dropRoleIfExists(ADMIN_USER,ROLE_NAME);
      client.listRoles(ADMIN_USER);
      client.createRole(ADMIN_USER,ROLE_NAME);
      client.listRoles(ADMIN_USER);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.db.service.thrift.TestSentryWebServerWithKerberos </h4><pre class="type-16 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPingWithUnauthorizedUser() throws Exception {
  String userPrinciple="user/" + SERVER_HOST;
  String userKerberosName=userPrinciple + "@" + REALM;
  Subject userSubject=new Subject(false,Sets.newHashSet(new KerberosPrincipal(userKerberosName)),new HashSet(),new HashSet());
  File userKeytab=new File(kdcWorkDir,"user.keytab");
  kdc.createPrincipal(userKeytab,userPrinciple);
  LoginContext userLoginContext=new LoginContext("",userSubject,null,KerberosConfiguration.createClientConfig(userKerberosName,userKeytab));
  userLoginContext.login();
  Subject.doAs(userLoginContext.getSubject(),new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      final URL url=new URL("http://" + SERVER_HOST + ":"+ webServerPort+ "/ping");
      try {
        new AuthenticatedURL(new KerberosAuthenticator()).openConnection(url,new AuthenticatedURL.Token());
        fail("Here should fail.");
      }
 catch (      AuthenticationException e) {
        String expectedError="status code: 403";
        if (!e.getMessage().contains(expectedError)) {
          LOG.error("UnexpectedError: " + e.getMessage(),e);
          fail("UnexpectedError: " + e.getMessage());
        }
      }
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPing() throws Exception {
  runTestAsSubject(new TestOperation(){
    @Override public void runTestAsSubject() throws Exception {
      final URL url=new URL("http://" + SERVER_HOST + ":"+ webServerPort+ "/ping");
      HttpURLConnection conn=new AuthenticatedURL(new KerberosAuthenticator()).openConnection(url,new AuthenticatedURL.Token());
      Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
      String response=IOUtils.toString(conn.getInputStream());
      Assert.assertEquals("pong\n",response);
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.file.TestLocalGroupMapping </h4><pre class="type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupMapping(){
  Set<String> fooGroupsFromResource=localGroupMapping.getGroups("foo");
  Assert.assertEquals(fooGroupsFromResource,fooGroups);
  Set<String> barGroupsFromResource=localGroupMapping.getGroups("bar");
  Assert.assertEquals(barGroupsFromResource,barGroups);
  try {
    localGroupMapping.getGroups("unknown");
    Assert.fail("SentryGroupNotFoundException should be thrown.");
  }
 catch (  SentryGroupNotFoundException sgnfe) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.provider.file.TestSimpleFileProvderBackend </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetTwo(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet("server=server1->db=jranalyst1","server=server1->functions"),backend.getPrivileges(Sets.newHashSet("manager"),new ActiveRoleSet(Sets.newHashSet("junior_analyst_role","functions"))));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetNone(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet(),backend.getPrivileges(Sets.newHashSet("manager"),new ActiveRoleSet(new HashSet<String>())));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetOne(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet("server=server1->functions"),backend.getPrivileges(Sets.newHashSet("manager"),new ActiveRoleSet(Sets.newHashSet("functions"))));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetAll(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet("server=server1->db=customers->table=purchases->select","server=server1->db=analyst1","server=server1->db=jranalyst1->table=*->select","server=server1->db=jranalyst1","server=server1->functions"),backend.getPrivileges(Sets.newHashSet("manager"),ActiveRoleSet.ALL));
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRoleSetAllUnknownGroup(){
  backend.initialize(context);
  assertEquals(Sets.newHashSet(),backend.getPrivileges(Sets.newHashSet("not-a-group"),ActiveRoleSet.ALL));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.sqoop.TestSqoopAuthConf </h4><pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPropertiesHaveConfigured(){
  Assert.assertEquals("org.apache.sentry.provider.common.HadoopGroupResourceAuthorizationProvider",authAllConf.get(AuthzConfVars.AUTHZ_PROVIDER.getVar()));
  Assert.assertEquals("classpath:test-authz-provider.ini",authAllConf.get(AuthzConfVars.AUTHZ_PROVIDER_RESOURCE.getVar()));
  Assert.assertEquals("org.apache.sentry.policy.sqoop.SimpleSqoopPolicyEngine",authAllConf.get(AuthzConfVars.AUTHZ_POLICY_ENGINE.getVar()));
  Assert.assertEquals("true",authAllConf.get(AuthzConfVars.AUTHZ_TESTING_MODE.getVar()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.dbprovider.TestConcurrentClients </h4><pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test when concurrent HS2 clients talking to server,
 * Privileges are correctly created and updated.
 * @throws Exception
 */
@Test public void testConccurentHS2Client() throws Exception {
  ExecutorService executor=Executors.newFixedThreadPool(NUM_OF_THREADS);
  final TestRuntimeState state=new TestRuntimeState();
  for (int i=0; i < NUM_OF_TASKS; i++) {
    executor.execute(new Runnable(){
      @Override public void run(){
        LOGGER.info("Starting tests: create role, show role, create db and tbl, and create partitions");
        if (state.failed)         return;
        try {
          Long startTime=System.currentTimeMillis();
          Long elapsedTime=0L;
          while (Long.compare(elapsedTime,HS2_CLIENT_TEST_DURATION_MS) <= 0) {
            String randStr=randomString(5);
            String test_role="test_role_" + randStr;
            String test_db="test_db_" + randStr;
            String test_tb="test_tb_" + randStr;
            LOGGER.info("Start to test sentry with hs2 client with role " + test_role);
            adminCreateRole(test_role);
            adminShowRole(test_role);
            createDbTb(ADMIN1,test_db,test_tb);
            adminGrant(test_db,test_tb,test_role,USERGROUP1);
            createPartition(USER1_1,test_db,test_tb);
            adminCleanUp(test_db,test_role);
            elapsedTime=System.currentTimeMillis() - startTime;
            LOGGER.info("elapsedTime = " + elapsedTime);
          }
          state.setNumSuccess();
        }
 catch (        Exception e) {
          LOGGER.error("Exception: " + e);
          state.setFirstException(e);
        }
      }
    }
);
  }
  executor.shutdown();
  while (!executor.isTerminated()) {
    Thread.sleep(1000);
  }
  Throwable ex=state.getFirstException();
  assertFalse(ex == null ? "Test failed" : ex.toString(),state.failed);
  assertEquals(NUM_OF_TASKS,state.getNumSuccess());
}

</code></pre>

<br>
<pre class="type-12 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test when concurrent sentry clients talking to sentry server, threads data are synchronized
 * @throws Exception
 */
@Test public void testConcurrentSentryClient() throws Exception {
  final String HIVE_KEYTAB_PATH=System.getProperty("sentry.e2etest.hive.policyOwnerKeytab");
  final SentryPolicyServiceClient client=getSentryClient("hive",HIVE_KEYTAB_PATH);
  ExecutorService executor=Executors.newFixedThreadPool(NUM_OF_THREADS);
  final TestRuntimeState state=new TestRuntimeState();
  for (int i=0; i < NUM_OF_TASKS; i++) {
    LOGGER.info("Start to test sentry client with task id [" + i + "]");
    executor.execute(new Runnable(){
      @Override public void run(){
        if (state.failed) {
          LOGGER.error("found one failed state, abort test from here.");
          return;
        }
        try {
          String randStr=randomString(5);
          String test_role="test_role_" + randStr;
          LOGGER.info("Start to test role: " + test_role);
          Long startTime=System.currentTimeMillis();
          Long elapsedTime=0L;
          while (Long.compare(elapsedTime,SENTRY_CLIENT_TEST_DURATION_MS) <= 0) {
            LOGGER.info("Test role " + test_role + " runs "+ elapsedTime+ " ms.");
            client.createRole(ADMIN1,test_role);
            client.listRoles(ADMIN1);
            client.grantServerPrivilege(ADMIN1,test_role,"server1",false);
            client.listAllPrivilegesByRoleName(ADMIN1,test_role);
            client.dropRole(ADMIN1,test_role);
            elapsedTime=System.currentTimeMillis() - startTime;
          }
          state.setNumSuccess();
        }
 catch (        Exception e) {
          LOGGER.error("Sentry Client Testing Exception: ",e);
          state.setFirstException(e);
        }
      }
    }
);
  }
  executor.shutdown();
  while (!executor.isTerminated()) {
    Thread.sleep(1000);
  }
  Throwable ex=state.getFirstException();
  assertFalse(ex == null ? "Test failed" : ex.toString(),state.failed);
  assertEquals(NUM_OF_TASKS,state.getNumSuccess());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.hdfs.TestHDFSIntegration </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testEnd2End() throws Throwable {
  tmpHDFSDir=new Path("/tmp/external");
  dbNames=new String[]{"db1"};
  roles=new String[]{"admin_role","db_role","tab_role","p1_admin"};
  admin="hive";
  Connection conn;
  Statement stmt;
  conn=hiveServer2.createConnection("hive","hive");
  stmt=conn.createStatement();
  stmt.execute("create role admin_role");
  stmt.execute("grant role admin_role to group hive");
  stmt.execute("grant all on server server1 to role admin_role");
  stmt.execute("create table p1 (s string) partitioned by (month int, day int)");
  stmt.execute("alter table p1 add partition (month=1, day=1)");
  stmt.execute("alter table p1 add partition (month=1, day=2)");
  stmt.execute("alter table p1 add partition (month=2, day=1)");
  stmt.execute("alter table p1 add partition (month=2, day=2)");
  stmt.execute("create database db5");
  stmt.execute("create role db_role");
  stmt.execute("create role tab_role");
  stmt.execute("grant role db_role to group hbase");
  stmt.execute("grant role tab_role to group flume");
  stmt.execute("create table db5.p2(id int)");
  stmt.execute("create role p1_admin");
  stmt.execute("grant role p1_admin to group hbase");
  verifyOnAllSubDirs("/user/hive/warehouse",null,"hbase",false);
  verifyOnAllSubDirs("/user/hive/warehouse/p1",null,"hbase",false);
  stmt.execute("grant all on database db5 to role db_role");
  stmt.execute("use db5");
  stmt.execute("grant all on table p2 to role tab_role");
  stmt.execute("use default");
  verifyOnAllSubDirs("/user/hive/warehouse/db5.db",FsAction.ALL,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db5.db/p2",FsAction.ALL,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db5.db/p2",FsAction.ALL,"flume",true);
  verifyOnPath("/user/hive/warehouse/db5.db",FsAction.ALL,"flume",false);
  loadData(stmt);
  verifyHDFSandMR(stmt);
  verifyOnPath("/user/hive/warehouse",null,"hbase",false);
  verifyOnAllSubDirs("/user/hive/warehouse/p1",FsAction.READ_EXECUTE,"hbase",true);
  adminUgi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      AclStatus existing=miniDFS.getFileSystem().getAclStatus(new Path("/user/hive/warehouse/p1"));
      ArrayList<AclEntry> newEntries=new ArrayList<AclEntry>(existing.getEntries());
      newEntries.add(AclEntry.parseAclEntry("user::---",true));
      newEntries.add(AclEntry.parseAclEntry("group:bla:rwx",true));
      newEntries.add(AclEntry.parseAclEntry("other::---",true));
      miniDFS.getFileSystem().setAcl(new Path("/user/hive/warehouse/p1"),newEntries);
      return null;
    }
  }
);
  stmt.execute("revoke select on table p1 from role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/p1",null,"hbase",false);
  stmt.execute("grant select on database default to role p1_admin");
  verifyOnPath("/user/hive/warehouse",FsAction.READ_EXECUTE,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/p1",FsAction.READ_EXECUTE,"hbase",true);
  stmt.execute("revoke select on database default from role p1_admin");
  verifyOnPath("/user/hive/warehouse",null,"hbase",false);
  verifyOnAllSubDirs("/user/hive/warehouse/p1",null,"hbase",false);
  stmt.execute("grant all on table p1 to role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/p1",FsAction.ALL,"hbase",true);
  stmt.execute("revoke select on table p1 from role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/p1",FsAction.WRITE_EXECUTE,"hbase",true);
  stmt.execute("alter table p1 rename to p3");
  verifyOnAllSubDirs("/user/hive/warehouse/p3",FsAction.WRITE_EXECUTE,"hbase",true);
  stmt.execute("alter table p3 partition (month=1, day=1) rename to partition (month=1, day=3)");
  verifyOnAllSubDirs("/user/hive/warehouse/p3",FsAction.WRITE_EXECUTE,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/p3/month=1/day=3",FsAction.WRITE_EXECUTE,"hbase",true);
  stmt.execute("create database extdb");
  stmt.execute("grant all on database ExtDb to role p1_admin");
  writeToPath("/tmp/external/ext100",5,"foo","bar");
  writeToPath("/tmp/external/ext101",5,"foo","bar");
  stmt.execute("use extdb");
  stmt.execute("create table ext100 (s string) location \'/tmp/external/ext100\'");
  verifyQuery(stmt,"ext100",5);
  verifyOnAllSubDirs("/tmp/external/ext100",FsAction.ALL,"hbase",true);
  stmt.execute("use default");
  stmt.execute("use EXTDB");
  stmt.execute("create table ext101 (s string) location \'/tmp/external/ext101\'");
  verifyQuery(stmt,"ext101",5);
  verifyOnAllSubDirs("/tmp/external/ext101",FsAction.ALL,"hbase",true);
  stmt.execute("grant all on table exT100 to role tab_role");
  verifyOnAllSubDirs("/tmp/external/ext100",FsAction.ALL,"flume",true);
  stmt.execute("use default");
  if (!testSentryHA) {
    long beforeStop=System.currentTimeMillis();
    sentryServer.stopAll();
    long timeTakenForStopMs=System.currentTimeMillis() - beforeStop;
    LOGGER.info("Time taken for Sentry server stop: " + timeTakenForStopMs);
    if (timeTakenForStopMs < STALE_THRESHOLD) {
      verifyOnAllSubDirs("/user/hive/warehouse/p3",FsAction.WRITE_EXECUTE,"hbase",true);
      Thread.sleep((STALE_THRESHOLD - timeTakenForStopMs));
    }
 else {
      LOGGER.warn("Sentry server stop took too long");
    }
    verifyOnAllSubDirs("/user/hive/warehouse/p3",null,"hbase",false);
    sentryServer.startAll();
  }
  verifyOnAllSubDirs("/user/hive/warehouse/p3",FsAction.WRITE_EXECUTE,"hbase",true);
  stmt.execute("create table p2 (s string) partitioned by (month int, day int)");
  stmt.execute("alter table p2 add partition (month=1, day=1)");
  stmt.execute("alter table p2 add partition (month=1, day=2)");
  stmt.execute("alter table p2 add partition (month=2, day=1)");
  stmt.execute("alter table p2 add partition (month=2, day=2)");
  verifyOnAllSubDirs("/user/hive/warehouse/p2",null,"hbase",false);
  stmt.execute("grant select on table p2 to role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/p2",FsAction.READ_EXECUTE,"hbase",true);
  stmt.execute("grant select on table p2 to role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/p2",FsAction.READ_EXECUTE,"hbase",true);
  writeToPath("/tmp/external/ext1",5,"foo","bar");
  stmt.execute("create table ext1 (s string) location \'/tmp/external/ext1\'");
  verifyQuery(stmt,"ext1",5);
  verifyOnAllSubDirs("/tmp/external/ext1",null,"bar",false);
  verifyOnAllSubDirs("/tmp/external/ext1",null,"hbase",false);
  stmt.execute("grant all on table ext1 to role p1_admin");
  verifyOnAllSubDirs("/tmp/external/ext1",FsAction.ALL,"hbase",true);
  stmt.execute("revoke select on table ext1 from role p1_admin");
  verifyOnAllSubDirs("/tmp/external/ext1",FsAction.WRITE_EXECUTE,"hbase",true);
  stmt.execute("create database db1");
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db",null,"hbase",false);
  stmt.execute("create table db1.tbl1 (s string)");
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl1",null,"hbase",false);
  stmt.execute("create table db1.tbl2 (s string)");
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl2",null,"hbase",false);
  stmt.execute("grant all on database default to role p1_admin");
  verifyOnPath("/user/hive/warehouse",FsAction.ALL,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db",null,"hbase",false);
  stmt.execute("create table q1 (s string)");
  verifyOnAllSubDirs("/user/hive/warehouse/q1",FsAction.ALL,"hbase",true);
  stmt.execute("alter table q1 rename to q2");
  verifyOnAllSubDirs("/user/hive/warehouse/q2",FsAction.ALL,"hbase",true);
  stmt.execute("grant select on table q2 to role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/q2",FsAction.ALL,"hbase",true);
  stmt.execute("create table q3 (s string)");
  verifyOnAllSubDirs("/user/hive/warehouse/q3",FsAction.ALL,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/q2",FsAction.ALL,"hbase",true);
  stmt.execute("grant select on database db1 to role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl1",FsAction.READ_EXECUTE,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl2",FsAction.READ_EXECUTE,"hbase",true);
  stmt.execute("revoke all on database default from role p1_admin");
  verifyOnPath("/user/hive/warehouse",null,"hbase",false);
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl1",FsAction.READ_EXECUTE,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl2",FsAction.READ_EXECUTE,"hbase",true);
  stmt.execute("use db1");
  stmt.execute("grant all on table tbl1 to role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl1",FsAction.ALL,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl2",FsAction.READ_EXECUTE,"hbase",true);
  stmt.execute("revoke select on database db1 from role p1_admin");
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl1",FsAction.WRITE_EXECUTE,"hbase",true);
  verifyOnAllSubDirs("/user/hive/warehouse/db1.db/tbl2",null,"hbase",false);
  stmt.execute("drop table tbl1");
  Assert.assertFalse(miniDFS.getFileSystem().exists(new Path("/user/hive/warehouse/db1.db/tbl1")));
  stmt.execute("drop table tbl2");
  Assert.assertFalse(miniDFS.getFileSystem().exists(new Path("/user/hive/warehouse/db1.db/tbl2")));
  stmt.execute("use default");
  stmt.execute("drop database db1");
  Assert.assertFalse(miniDFS.getFileSystem().exists(new Path("/user/hive/warehouse/db1.db")));
  writeToPath("/tmp/external/tables/ext2_before/i=1",5,"foo","bar");
  writeToPath("/tmp/external/tables/ext2_before/i=2",5,"foo","bar");
  stmt.execute("create external table ext2 (s string) partitioned by (i int) location \'/tmp/external/tables/ext2_before\'");
  stmt.execute("alter table ext2 add partition (i=1)");
  stmt.execute("alter table ext2 add partition (i=2)");
  verifyQuery(stmt,"ext2",10);
  verifyOnAllSubDirs("/tmp/external/tables/ext2_before",null,"hbase",false);
  stmt.execute("grant all on table ext2 to role p1_admin");
  verifyOnPath("/tmp/external/tables/ext2_before",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=1",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=2",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=1/stuff.txt",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=2/stuff.txt",FsAction.ALL,"hbase",true);
  writeToPath("/tmp/external/tables/ext2_after/i=1",6,"foo","bar");
  writeToPath("/tmp/external/tables/ext2_after/i=2",6,"foo","bar");
  stmt.execute("alter table ext2 set location \'hdfs:///tmp/external/tables/ext2_after\'");
  verifyQuery(stmt,"ext2",10);
  verifyOnPath("/tmp/external/tables/ext2_before",null,"hbase",false);
  verifyOnPath("/tmp/external/tables/ext2_before/i=1",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=2",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=1/stuff.txt",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_before/i=2/stuff.txt",FsAction.ALL,"hbase",true);
  stmt.execute("alter table ext2 partition (i=1) set location \'hdfs:///tmp/external/tables/ext2_after/i=1\'");
  stmt.execute("alter table ext2 partition (i=2) set location \'hdfs:///tmp/external/tables/ext2_after/i=2\'");
  verifyQuery(stmt,"ext2",12);
  verifyOnPath("/tmp/external/tables/ext2_before",null,"hbase",false);
  verifyOnPath("/tmp/external/tables/ext2_before/i=1",null,"hbase",false);
  verifyOnPath("/tmp/external/tables/ext2_before/i=2",null,"hbase",false);
  verifyOnPath("/tmp/external/tables/ext2_before/i=1/stuff.txt",null,"hbase",false);
  verifyOnPath("/tmp/external/tables/ext2_before/i=2/stuff.txt",null,"hbase",false);
  verifyOnPath("/tmp/external/tables/ext2_after",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_after/i=1",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_after/i=2",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_after/i=1/stuff.txt",FsAction.ALL,"hbase",true);
  verifyOnPath("/tmp/external/tables/ext2_after/i=2/stuff.txt",FsAction.ALL,"hbase",true);
  stmt.close();
  conn.close();
}

</code></pre>

<br>
<pre class="type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * SENTRY-1002:
 * Ensure the paths with no scheme will not cause NPE during paths update.
 */
@Test public void testMissingScheme() throws Throwable {
  boolean testConfOff=new Boolean(System.getProperty(EXTERNAL_SENTRY_SERVICE,"false"));
  if (!testConfOff) {
    PathsUpdate.getConfiguration().set("fs.defaultFS","hdfs:///");
  }
  tmpHDFSDir=new Path("/tmp/external");
  if (!miniDFS.getFileSystem().exists(tmpHDFSDir)) {
    miniDFS.getFileSystem().mkdirs(tmpHDFSDir);
  }
  Path partitionDir=new Path("/tmp/external/p1");
  if (!miniDFS.getFileSystem().exists(partitionDir)) {
    miniDFS.getFileSystem().mkdirs(partitionDir);
  }
  String dbName="db1";
  String tblName="tab1";
  dbNames=new String[]{dbName};
  roles=new String[]{"admin_role"};
  admin=StaticUserGroup.ADMIN1;
  Connection conn;
  Statement stmt;
  conn=hiveServer2.createConnection("hive","hive");
  stmt=conn.createStatement();
  stmt.execute("create role admin_role");
  stmt.execute("grant all on server server1 to role admin_role");
  stmt.execute("grant role admin_role to group " + StaticUserGroup.ADMINGROUP);
  stmt.close();
  conn.close();
  conn=hiveServer2.createConnection(StaticUserGroup.ADMIN1,StaticUserGroup.ADMIN1);
  stmt=conn.createStatement();
  stmt.execute("create database " + dbName);
  stmt.execute("create external table " + dbName + "."+ tblName+ "(s string) location '/tmp/external/p1'");
  Table tbCopy=hmsClient.getTable(dbName,tblName);
  StorageDescriptor sd=hmsClient.getTable(dbName,tblName).getSd();
  sd.setLocation("/tmp/external");
  tbCopy.setSd(sd);
  hmsClient.alter_table(dbName,"tab1",tbCopy);
  Assert.assertEquals(hmsClient.getTable(dbName,tblName).getSd().getLocation(),"/tmp/external");
  verifyOnPath("/tmp/external",FsAction.ALL,StaticUserGroup.HIVE,true);
  stmt.close();
  conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.hive.TestConfigTool </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Validate user permissions listing
 * @throws Exception
 */
@Test public void testUserPermissions() throws Exception {
  policyFile.addRolesToGroup(USERGROUP1,"select_tab1","insert_tab2").addRolesToGroup(USERGROUP2,"select_tab3").addRolesToGroup(USERGROUP3,"select_colA").addRolesToGroup(USERGROUP4,"select_colAB").addPermissionsToRole("select_tab1","server=server1->db=db1->table=tab1->action=select").addPermissionsToRole("insert_tab2","server=server1->db=db1->table=tab2->action=insert").addPermissionsToRole("select_tab3","server=server1->db=db1->table=tab3->action=select").addPermissionsToRole("select_colA","server=server1->db=db1->table=tab3->column=a->action=select").addPermissionsToRole("select_colAB","server=server1->db=db1->table=tab3->column=a->action=select").addPermissionsToRole("select_colAB","server=server1->db=db1->table=tab3->column=b->action=select").setUserGroupMapping(StaticUserGroup.getStaticMapping());
  policyFile.write(context.getPolicyFile());
  configTool.setPolicyFile(context.getPolicyFile().getPath());
  configTool.setupConfig();
  configTool.validatePolicy();
  Set<String> permList=configTool.getSentryProvider().listPrivilegesForSubject(new Subject(USER1_1));
  assertTrue(permList.contains("server=server1->db=db1->table=tab1->action=select"));
  assertTrue(permList.contains("server=server1->db=db1->table=tab2->action=insert"));
  permList=configTool.getSentryProvider().listPrivilegesForSubject(new Subject(USER2_1));
  assertTrue(permList.contains("server=server1->db=db1->table=tab3->action=select"));
  permList=configTool.getSentryProvider().listPrivilegesForSubject(new Subject(USER3_1));
  assertTrue(permList.contains("server=server1->db=db1->table=tab3->column=a->action=select"));
  permList=configTool.getSentryProvider().listPrivilegesForSubject(new Subject(USER4_1));
  assertTrue(permList.contains("server=server1->db=db1->table=tab3->column=a->action=select"));
  assertTrue(permList.contains("server=server1->db=db1->table=tab3->column=b->action=select"));
  permList=configTool.getSentryProvider().listPrivilegesForSubject(new Subject(ADMIN1));
  assertTrue(permList.contains("server=server1"));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify errors/warnings from malformed policy file
 * @throws Exception
 */
@Test public void testInvalidPolicy() throws Exception {
  policyFile.addRolesToGroup(USERGROUP1,"select_tab1","insert_tab2").addRolesToGroup(USERGROUP2,"select_tab3").addPermissionsToRole("select_tab1","server=server1->db=db1->table=tab1->action=select").setUserGroupMapping(StaticUserGroup.getStaticMapping());
  policyFile.write(context.getPolicyFile());
  configTool.setPolicyFile(context.getPolicyFile().getPath());
  configTool.setupConfig();
  try {
    configTool.getSentryProvider().validateResource(true);
    fail("Policy validation should fail for malformed policy");
  }
 catch (  SentryConfigurationException e) {
    assertTrue(e.getConfigWarnings().get(0).contains("Role select_tab3 for group " + USERGROUP2 + " does not exist"));
    assertTrue(e.getConfigWarnings().get(1).contains("Role insert_tab2 for group " + USERGROUP1 + " does not exist"));
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify errors/warnings from malformed policy file with per-DB policy
 * @throws Exception
 */
@Test public void testInvalidPerDbPolicy() throws Exception {
  PolicyFile db2PolicyFile=new PolicyFile();
  File db2PolicyFileHandle=new File(context.getPolicyFile().getParent(),DB2_POLICY_FILE);
  db2PolicyFile.addRolesToGroup(USERGROUP2,"select_tbl2","insert_db2_tab2").addPermissionsToRole("select_tbl2","server=server1->db=db2->table=tbl2->action=select").write(db2PolicyFileHandle);
  policyFile.addRolesToGroup(USERGROUP1,"select_tbl1").addRolesToGroup(USERGROUP2,"select_tbl3").addPermissionsToRole("select_tbl1","server=server1->db=db1->table=tbl1->action=select").addDatabase("db2",prefix + db2PolicyFileHandle.getName()).setUserGroupMapping(StaticUserGroup.getStaticMapping()).write(context.getPolicyFile());
  configTool.setPolicyFile(context.getPolicyFile().getPath());
  configTool.setupConfig();
  try {
    configTool.getSentryProvider().validateResource(true);
    fail("Policy validation should fail for malformed policy");
  }
 catch (  SentryConfigurationException e) {
    assertTrue(e.getConfigWarnings().get(0).contains("Role select_tbl3 for group " + USERGROUP2 + " does not exist"));
    assertTrue(e.getConfigWarnings().get(0).contains(context.getPolicyFile().getName()));
    assertTrue(e.getConfigWarnings().get(1).contains("Role insert_db2_tab2 for group " + USERGROUP2 + " does not exist"));
    assertTrue(e.getConfigWarnings().get(1).contains(db2PolicyFileHandle.getName()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.hive.TestViewPrivileges </h4><pre class="type-17 type-12 type-5 type-7 type-14 type-19 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitioned() throws Exception {
  File dataDir=context.getDataDir();
  File dataFile=new File(dataDir,SINGLE_TYPE_DATA_FILE_NAME);
  FileOutputStream to=new FileOutputStream(dataFile);
  Resources.copy(Resources.getResource(SINGLE_TYPE_DATA_FILE_NAME),to);
  to.close();
  String viewName="view1";
  String db="db1";
  String tabName="tab1";
  policyFile.addPermissionsToRole("view","server=server1->db=" + db + "->table="+ viewName).addRolesToGroup(USERGROUP1,"view").setUserGroupMapping(StaticUserGroup.getStaticMapping());
  policyFile.write(context.getPolicyFile());
  Connection conn=context.createConnection(ADMIN1);
  Statement stmt=context.createStatement(conn);
  stmt.execute("DROP DATABASE IF EXISTS " + db + " CASCADE");
  stmt.execute("CREATE DATABASE " + db);
  stmt.execute("use " + db);
  stmt.execute("create table " + tabName + " (id int) partitioned by (part string)");
  stmt.execute("load data local inpath '" + dataFile + "' into table "+ tabName+ " PARTITION (part=\"a\")");
  stmt.execute("load data local inpath '" + dataFile + "' into table "+ tabName+ " PARTITION (part=\"b\")");
  ResultSet res=stmt.executeQuery("select count(*) from " + tabName);
  org.junit.Assert.assertThat(res,notNullValue());
  while (res.next()) {
    Assume.assumeTrue(res.getInt(1) == new Integer(1000));
  }
  stmt.execute("create view " + viewName + " as select * from "+ tabName+ " where id<100");
  res=stmt.executeQuery("select count(*) from " + viewName);
  org.junit.Assert.assertThat(res,notNullValue());
  int rowsInView=0;
  while (res.next()) {
    rowsInView=res.getInt(1);
  }
  stmt.close();
  conn.close();
  Connection userConn=context.createConnection(USER1_1);
  Statement userStmt=context.createStatement(userConn);
  userStmt.execute("use " + db);
  res=userStmt.executeQuery("select count(*) from " + viewName);
  org.junit.Assert.assertThat(res,notNullValue());
  while (res.next()) {
    org.junit.Assert.assertThat(res.getInt(1),is(rowsInView));
  }
  userStmt.close();
  userConn.close();
  userConn=context.createConnection(USER2_1);
  userStmt=context.createStatement(userConn);
  try {
    userStmt.executeQuery("select count(*) from " + viewName);
    Assert.fail("Expected SQL exception");
  }
 catch (  SQLException e) {
  }
  userStmt.close();
  userConn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.metastore.TestAuthorizingObjectStore </h4><pre class="type-5 type-7 type-19 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The group of USER3_1 is USERGROUP3, and has no access to database and
 * table.
 * @throws Exception
 */
@Test public void testPrivilegesForNoAccess() throws Exception {
  HiveMetaStoreClient client=context.getMetaStoreClient(USER3_1);
  try {
    client.getDatabase(dbName1);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getDatabase(dbName2);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getAllDatabases().size(),equalTo(1));
  assertThat(client.getDatabases("*").size(),equalTo(1));
  try {
    client.getTable(dbName1,tabName1);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getTable(dbName1,tabName2);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getTable(dbName2,tabName3);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getTable(dbName2,tabName4);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName1,tabName1,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName1,tabName2,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName3,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName4,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartition(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartition(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartition(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartition(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getTables(dbName1,"tab*").size(),equalTo(0));
  assertThat(client.getTables(dbName2,"tab*").size(),equalTo(0));
  assertThat(client.getTableObjectsByName(dbName1,new ArrayList<String>(Arrays.asList(tabName1,tabName2))).size(),equalTo(0));
  assertThat(client.getTableObjectsByName(dbName2,new ArrayList<String>(Arrays.asList(tabName3,tabName4))).size(),equalTo(0));
  assertThat(client.getAllTables(dbName1).size(),equalTo(0));
  assertThat(client.getAllTables(dbName2).size(),equalTo(0));
  try {
    client.listPartitionNames(dbName1,tabName1,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName1,tabName2,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName2,tabName3,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName2,tabName4,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.listPartitionNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.getPartitionsByNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.getPartitionsByNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.getPartitionsByNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.getPartitionsByNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  TException noe) {
  }
  try {
    client.getIndex(dbName1,tabName1,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getIndex(dbName1,tabName2,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexes(dbName1,tabName1,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexes(dbName1,tabName2,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexes(dbName2,tabName3,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexes(dbName2,tabName4,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexNames(dbName1,tabName1,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexNames(dbName1,tabName2,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexNames(dbName2,tabName3,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexNames(dbName2,tabName4,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getPartitionWithAuthInfo(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionWithAuthInfo(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionWithAuthInfo(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionWithAuthInfo(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getTableColumnStatistics(dbName1,tabName1,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getTableColumnStatistics(dbName1,tabName2,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getTableColumnStatistics(dbName2,tabName3,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getTableColumnStatistics(dbName2,tabName4,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  client.close();
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-19 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * User accessAllMetaUser is configured as the value of
 * "sentry.metastore.service.users" and has all access to databases and
 * tables.
 * @throws Exception
 */
@Test public void testPrivilegesForUserWithoutAccess() throws Exception {
  HiveMetaStoreClient client=context.getMetaStoreClient(userWithoutAccess);
  assertThat(client.getDatabase(dbName1),notNullValue());
  assertThat(client.getDatabase(dbName2),notNullValue());
  assertThat(client.getAllDatabases().size(),equalTo(3));
  assertThat(client.getDatabases("*").size(),equalTo(3));
  assertThat(client.getTable(dbName1,tabName1),notNullValue());
  assertThat(client.getTable(dbName1,tabName2),notNullValue());
  assertThat(client.getTable(dbName2,tabName3),notNullValue());
  assertThat(client.getTable(dbName2,tabName4),notNullValue());
  assertThat(client.listPartitions(dbName1,tabName1,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName1,tabName2,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName3,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName4,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.getPartition(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getPartition(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getPartition(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getPartition(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getTables(dbName1,"tab*").size(),equalTo(2));
  assertThat(client.getTables(dbName2,"tab*").size(),equalTo(2));
  assertThat(client.getTableObjectsByName(dbName1,new ArrayList<String>(Arrays.asList(tabName1,tabName2))).size(),equalTo(2));
  assertThat(client.getTableObjectsByName(dbName2,new ArrayList<String>(Arrays.asList(tabName3,tabName4))).size(),equalTo(2));
  assertThat(client.getAllTables(dbName1).size(),equalTo(2));
  assertThat(client.getAllTables(dbName2).size(),equalTo(2));
  assertThat(client.listPartitionNames(dbName1,tabName1,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName1,tabName2,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName3,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName4,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.getPartitionsByNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  assertThat(client.getPartitionsByNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  assertThat(client.getPartitionsByNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  assertThat(client.getPartitionsByNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  try {
    client.getIndex(dbName1,tabName1,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName1,tabName2,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.listIndexes(dbName1,tabName1,(short)1).size(),equalTo(0));
  assertThat(client.listIndexes(dbName1,tabName2,(short)1).size(),equalTo(0));
  assertThat(client.listIndexes(dbName2,tabName3,(short)1).size(),equalTo(0));
  assertThat(client.listIndexes(dbName2,tabName4,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName1,tabName1,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName1,tabName2,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName2,tabName3,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName2,tabName4,(short)1).size(),equalTo(0));
  assertThat(client.getPartitionWithAuthInfo(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getPartitionWithAuthInfo(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getPartitionWithAuthInfo(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getPartitionWithAuthInfo(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getTableColumnStatistics(dbName1,tabName1,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  assertThat(client.getTableColumnStatistics(dbName1,tabName2,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  assertThat(client.getTableColumnStatistics(dbName2,tabName3,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  assertThat(client.getTableColumnStatistics(dbName2,tabName4,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  client.close();
}

</code></pre>

<br>
<pre class="type-5 type-7 type-19 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The group of USER2_1 is USERGROUP2, and has the access to db1 and t1.
 * @throws Exception
 */
@Test public void testPrivilegesForPartialAccess() throws Exception {
  HiveMetaStoreClient client=context.getMetaStoreClient(USER2_1);
  assertThat(client.getDatabase(dbName1),notNullValue());
  try {
    client.getDatabase(dbName2);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getAllDatabases().size(),equalTo(2));
  assertThat(client.getDatabases("*").size(),equalTo(2));
  assertThat(client.getTable(dbName1,tabName1),notNullValue());
  try {
    client.getTable(dbName1,tabName2);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getTable(dbName2,tabName3);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getTable(dbName2,tabName4);
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.listPartitions(dbName1,tabName1,(short)1).size(),equalTo(1));
  try {
    client.listPartitions(dbName1,tabName2,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName3,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName4,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.listPartitions(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  try {
    client.listPartitions(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitions(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getPartition(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  try {
    client.getPartition(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartition(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartition(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)));
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getTables(dbName1,"tab*").size(),equalTo(1));
  assertThat(client.getTables(dbName2,"tab*").size(),equalTo(0));
  assertThat(client.getTableObjectsByName(dbName1,new ArrayList<String>(Arrays.asList(tabName1,tabName2))).size(),equalTo(1));
  assertThat(client.getTableObjectsByName(dbName2,new ArrayList<String>(Arrays.asList(tabName3,tabName4))).size(),equalTo(0));
  assertThat(client.getAllTables(dbName1).size(),equalTo(1));
  assertThat(client.getAllTables(dbName2).size(),equalTo(0));
  assertThat(client.listPartitionNames(dbName1,tabName1,(short)2).size(),equalTo(1));
  try {
    client.listPartitionNames(dbName1,tabName2,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException te) {
  }
  try {
    client.listPartitionNames(dbName2,tabName3,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException te) {
  }
  try {
    client.listPartitionNames(dbName2,tabName4,(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  TException te) {
  }
  assertThat(client.listPartitionNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  try {
    client.listPartitionNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitionNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.listPartitionNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2);
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getPartitionsByNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  try {
    client.getPartitionsByNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionsByNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionsByNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList("")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName1,tabName1,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName1,tabName2,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  assertThat(client.listIndexes(dbName1,tabName1,(short)1).size(),equalTo(0));
  try {
    client.listIndexes(dbName1,tabName2,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexes(dbName2,tabName3,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexes(dbName2,tabName4,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  assertThat(client.listIndexNames(dbName1,tabName1,(short)1).size(),equalTo(0));
  try {
    client.listIndexNames(dbName1,tabName2,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexNames(dbName2,tabName3,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.listIndexNames(dbName2,tabName4,(short)1);
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  assertThat(client.getPartitionWithAuthInfo(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  try {
    client.getPartitionWithAuthInfo(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionWithAuthInfo(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getPartitionWithAuthInfo(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup")));
    fail("MetaException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.getTableColumnStatistics(dbName1,tabName1,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  try {
    client.getTableColumnStatistics(dbName1,tabName2,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getTableColumnStatistics(dbName2,tabName3,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  try {
    client.getTableColumnStatistics(dbName2,tabName4,new ArrayList<String>(Arrays.asList(colName1)));
    fail("MetaException should have been thrown");
  }
 catch (  MetaException noe) {
  }
  client.close();
}

</code></pre>

<br>
<pre class="type-5 type-7 type-19 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The group of USER1_1 is USERGROUP1, and has all access to databases and
 * tables.
 * @throws Exception
 */
@Test public void testPrivilegesForFullAccess() throws Exception {
  HiveMetaStoreClient client=context.getMetaStoreClient(USER1_1);
  assertThat(client.getDatabase(dbName1),notNullValue());
  assertThat(client.getDatabase(dbName2),notNullValue());
  assertThat(client.getAllDatabases().size(),equalTo(3));
  assertThat(client.getDatabases("*").size(),equalTo(3));
  assertThat(client.getTable(dbName1,tabName1),notNullValue());
  assertThat(client.getTable(dbName1,tabName2),notNullValue());
  assertThat(client.getTable(dbName2,tabName3),notNullValue());
  assertThat(client.getTable(dbName2,tabName4),notNullValue());
  assertThat(client.listPartitions(dbName1,tabName1,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName1,tabName2,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName3,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName4,(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.listPartitions(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)1).size(),equalTo(1));
  assertThat(client.getPartition(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getPartition(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getPartition(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getPartition(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal))),notNullValue());
  assertThat(client.getTables(dbName1,"tab*").size(),equalTo(2));
  assertThat(client.getTables(dbName2,"tab*").size(),equalTo(2));
  assertThat(client.getTableObjectsByName(dbName1,new ArrayList<String>(Arrays.asList(tabName1,tabName2))).size(),equalTo(2));
  assertThat(client.getTableObjectsByName(dbName2,new ArrayList<String>(Arrays.asList(tabName3,tabName4))).size(),equalTo(2));
  assertThat(client.getAllTables(dbName1).size(),equalTo(2));
  assertThat(client.getAllTables(dbName2).size(),equalTo(2));
  assertThat(client.listPartitionNames(dbName1,tabName1,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName1,tabName2,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName3,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName4,(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.listPartitionNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),(short)2).size(),equalTo(1));
  assertThat(client.getPartitionsByNames(dbName1,tabName1,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  assertThat(client.getPartitionsByNames(dbName1,tabName2,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  assertThat(client.getPartitionsByNames(dbName2,tabName3,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  assertThat(client.getPartitionsByNames(dbName2,tabName4,new ArrayList<String>(Arrays.asList(""))).size(),equalTo(0));
  try {
    client.getIndex(dbName1,tabName1,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName1,tabName2,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  try {
    client.getIndex(dbName2,tabName3,"empty");
    fail("NoSuchObjectException should have been thrown");
  }
 catch (  NoSuchObjectException noe) {
  }
  assertThat(client.listIndexes(dbName1,tabName1,(short)1).size(),equalTo(0));
  assertThat(client.listIndexes(dbName1,tabName2,(short)1).size(),equalTo(0));
  assertThat(client.listIndexes(dbName2,tabName3,(short)1).size(),equalTo(0));
  assertThat(client.listIndexes(dbName2,tabName4,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName1,tabName1,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName1,tabName2,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName2,tabName3,(short)1).size(),equalTo(0));
  assertThat(client.listIndexNames(dbName2,tabName4,(short)1).size(),equalTo(0));
  assertThat(client.getPartitionWithAuthInfo(dbName1,tabName1,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getPartitionWithAuthInfo(dbName1,tabName2,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getPartitionWithAuthInfo(dbName2,tabName3,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getPartitionWithAuthInfo(dbName2,tabName4,new ArrayList<String>(Arrays.asList(partitionVal)),"tempuser",new ArrayList<String>(Arrays.asList("tempgroup"))),notNullValue());
  assertThat(client.getTableColumnStatistics(dbName1,tabName1,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  assertThat(client.getTableColumnStatistics(dbName1,tabName2,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  assertThat(client.getTableColumnStatistics(dbName2,tabName3,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  assertThat(client.getTableColumnStatistics(dbName2,tabName4,new ArrayList<String>(Arrays.asList(colName1))).size(),equalTo(0));
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.metastore.TestMetaStoreWithPigHCat </h4><pre class="type-7 type-6 type-9 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
/** 
 * Verify add partition via Pig+HCatStore
 * *** Disabled due to HCat inputformat compatibility issue in Hive 1.1.0
 */
@Ignore @Test public void testPartionLoad() throws Exception {
  execHiveSQL("CREATE TABLE " + dbName + "."+ tabName1+ " (id int) PARTITIONED BY (part_col STRING)",ADMIN1);
  execHiveSQL("CREATE TABLE " + dbName + "."+ tabName2+ " (id int) PARTITIONED BY (part_col STRING)",ADMIN1);
  PigServer pigServer=context.getPigServer(USER1_1,ExecType.LOCAL);
  execPigLatin(USER1_1,pigServer,"A = load '" + dataFile.getPath() + "' as (id:int);");
  execPigLatin(USER1_1,pigServer,"store A into '" + dbName + "."+ tabName1+ "' using "+ HCatStorer.class.getName()+ " ('part_col=part1');");
  HiveMetaStoreClient client=context.getMetaStoreClient(ADMIN1);
  assertEquals(1,client.listPartitionNames(dbName,tabName1,(short)10).size());
  pigServer=context.getPigServer(USER2_1,ExecType.LOCAL);
  execPigLatin(USER2_1,pigServer,"A = load '" + dataFile.getPath() + "' as (id:int);");
  execPigLatin(USER2_1,pigServer,"store A into '" + dbName + "."+ tabName2+ "' using "+ HCatStorer.class.getName()+ " ('part_col=part2');");
  assertEquals(0,client.listPartitionNames(dbName,tabName2,(short)10).size());
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.metastore.TestMetastoreEndToEnd </h4><pre class="type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify alter table privileges
 * @throws Exception
 */
@Test public void testAlterTablePrivileges() throws Exception {
  HiveMetaStoreClient client=context.getMetaStoreClient(ADMIN1);
  createMetastoreTable(client,dbName,tabName1,Lists.newArrayList(new FieldSchema("col1","int","")));
  client.close();
  client=context.getMetaStoreClient(USER1_1);
  Table metaTable2=client.getTable(dbName,tabName1);
  metaTable2.getSd().setCols(Lists.newArrayList(new FieldSchema("col2","double","")));
  client.alter_table(dbName,tabName1,metaTable2);
  Table metaTable3=client.getTable(dbName,tabName1);
  assertEquals(metaTable2.getSd().getCols(),metaTable3.getSd().getCols());
  client=context.getMetaStoreClient(USER2_1);
  metaTable2=client.getTable(dbName,tabName1);
  metaTable2.getSd().setCols(Lists.newArrayList(new FieldSchema("col3","string","")));
  client.alter_table(dbName,tabName1,metaTable2);
  metaTable3=client.getTable(dbName,tabName1);
  assertEquals(metaTable2.getSd().getCols(),metaTable3.getSd().getCols());
  client=context.getMetaStoreClient(USER3_1);
  metaTable2=client.getTable(dbName,tabName1);
  metaTable2.getSd().setCols(Lists.newArrayList(new FieldSchema("col3","string","")));
  try {
    client.alter_table(dbName,tabName1,metaTable2);
    fail("alter table should have failed for non-privilege user");
  }
 catch (  MetaException e) {
    Context.verifyMetastoreAuthException(e);
  }
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.solr.TestDocLevelOperations </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the allRolesToken.  Make it a keyword in the query language ("OR")
 * to make sure it is treated literally rather than interpreted.
 */
@Test public void testAllRolesToken() throws Exception {
  String collectionName="allRolesCollection";
  setupCollectionWithDocSecurity(collectionName);
  try {
    String allRolesToken="OR";
    int junitFactor=2;
    int allRolesFactor=5;
    int totalJunitAdded=0;
    int totalAllRolesAdded=0;
    int totalOnlyAllRolesAdded=0;
    ArrayList<SolrInputDocument> docs=new ArrayList<SolrInputDocument>();
    for (int i=0; i < NUM_DOCS; ++i) {
      boolean addedViaJunit=false;
      SolrInputDocument doc=new SolrInputDocument();
      String iStr=Long.toString(i);
      doc.addField("id",iStr);
      doc.addField("description","description" + iStr);
      if (i % junitFactor == 0) {
        doc.addField(AUTH_FIELD,"junit_role");
        addedViaJunit=true;
        ++totalJunitAdded;
      }
      if (i % allRolesFactor == 0) {
        doc.addField(AUTH_FIELD,allRolesToken);
        ++totalAllRolesAdded;
        if (!addedViaJunit)         ++totalOnlyAllRolesAdded;
      }
      docs.add(doc);
    }
    assert (totalOnlyAllRolesAdded > 0);
    assert (totalJunitAdded > totalAllRolesAdded);
    CloudSolrServer server=getCloudSolrServer(collectionName);
    try {
      server.add(docs);
      server.commit(true,true);
      SolrQuery query=new SolrQuery();
      query.setQuery("*:*");
      setAuthenticationUser("admin");
      QueryResponse rsp=server.query(query);
      SolrDocumentList docList=rsp.getResults();
      assertEquals(totalAllRolesAdded,docList.getNumFound());
      for (      SolrDocument doc : docList) {
        String id=doc.getFieldValue("id").toString();
        assertEquals(0,Long.valueOf(id) % allRolesFactor);
      }
      setAuthenticationUser("junit");
      rsp=server.query(query);
      docList=rsp.getResults();
      assertEquals(totalJunitAdded + totalOnlyAllRolesAdded,docList.getNumFound());
      for (      SolrDocument doc : docList) {
        String id=doc.getFieldValue("id").toString();
        boolean addedJunit=(Long.valueOf(id) % junitFactor) == 0;
        boolean onlyAllRoles=!addedJunit && (Long.valueOf(id) % allRolesFactor) == 0;
        assertEquals(true,addedJunit || onlyAllRoles);
      }
    }
  finally {
      server.shutdown();
    }
  }
  finally {
    deleteCollection(collectionName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.solr.db.integration.TestSolrDocLevelOperations </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDocLevelOperations() throws Exception {
  setupCollectionWithDocSecurity(TEST_COLLECTION_NAME1);
  createDocument(TEST_COLLECTION_NAME1);
  CloudSolrServer server=getCloudSolrServer(TEST_COLLECTION_NAME1);
  try {
    SolrQuery query=new SolrQuery();
    query.setQuery("*:*");
    setAuthenticationUser(ADMIN_USER);
    QueryResponse rsp=server.query(query);
    SolrDocumentList docList=rsp.getResults();
    assertEquals(NUM_DOCS,docList.getNumFound());
    setAuthenticationUser("user0");
    grantCollectionPrivilege(TEST_COLLECTION_NAME1,ADMIN_USER,"role0",SearchConstants.QUERY);
    rsp=server.query(query);
    docList=rsp.getResults();
    assertEquals(NUM_DOCS / 4,rsp.getResults().getNumFound());
    setAuthenticationUser("user1");
    grantCollectionPrivilege(TEST_COLLECTION_NAME1,ADMIN_USER,"role1",SearchConstants.QUERY);
    rsp=server.query(query);
    docList=rsp.getResults();
    assertEquals(NUM_DOCS / 4,rsp.getResults().getNumFound());
    docList=rsp.getResults();
    assertEquals(NUM_DOCS / 4,rsp.getResults().getNumFound());
    setAuthenticationUser("user2");
    grantCollectionPrivilege(TEST_COLLECTION_NAME1,ADMIN_USER,"role2",SearchConstants.QUERY);
    rsp=server.query(query);
    docList=rsp.getResults();
    assertEquals(NUM_DOCS / 4,rsp.getResults().getNumFound());
    setAuthenticationUser("user3");
    grantCollectionPrivilege(TEST_COLLECTION_NAME1,ADMIN_USER,"role3",SearchConstants.QUERY);
    rsp=server.query(query);
    docList=rsp.getResults();
    assertEquals(NUM_DOCS / 4,rsp.getResults().getNumFound());
  }
  finally {
    server.shutdown();
  }
  deleteCollection(TEST_COLLECTION_NAME1);
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void updateDocsTest() throws Exception {
  setupCollectionWithDocSecurity(TEST_COLLECTION_NAME1);
  createDocument(TEST_COLLECTION_NAME1);
  CloudSolrServer server=getCloudSolrServer(TEST_COLLECTION_NAME1);
  try {
    setAuthenticationUser("user0");
    grantCollectionPrivilege(TEST_COLLECTION_NAME1,ADMIN_USER,"role0",SearchConstants.QUERY);
    String docIdStr=Long.toString(1);
    SolrQuery query=new SolrQuery();
    query.setQuery("id:" + docIdStr);
    QueryResponse rsp=server.query(query);
    assertEquals(0,rsp.getResults().getNumFound());
    setAuthenticationUser(ADMIN_USER);
    ArrayList<SolrInputDocument> docs=new ArrayList<SolrInputDocument>();
    SolrInputDocument doc=new SolrInputDocument();
    doc.addField("id",docIdStr);
    doc.addField("description","description" + docIdStr);
    doc.addField(AUTH_FIELD,"role0");
    docs.add(doc);
    server.add(docs);
    server.commit();
    setAuthenticationUser("user0");
    rsp=server.query(query);
    assertEquals(1,rsp.getResults().getNumFound());
  }
  finally {
    server.shutdown();
  }
  deleteCollection(TEST_COLLECTION_NAME1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestConnectorEndToEnd </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testShowSpecificConnector() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(USER1);
  assertTrue(client.getConnectors().size() == 0);
  client=sqoopServerRunner.getSqoopClient(USER2);
  assertTrue(client.getConnectors().size() == 0);
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MConnector hdfsConnector=client.getConnector(HDFS_CONNECTOR_NAME);
  MConnector jdbcConnector=client.getConnector(JDBC_CONNECTOR_NAME);
  MRole role1=new MRole(ROLE1);
  MPrincipal group1=new MPrincipal(GROUP1,MPrincipal.TYPE.GROUP);
  MPrivilege readHdfsPriv=new MPrivilege(new MResource(String.valueOf(hdfsConnector.getPersistenceId()),MResource.TYPE.CONNECTOR),SqoopActionConstant.READ,false);
  client.createRole(role1);
  client.grantRole(Lists.newArrayList(role1),Lists.newArrayList(group1));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role1.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readHdfsPriv));
  MRole role2=new MRole(ROLE2);
  MPrincipal group2=new MPrincipal(GROUP2,MPrincipal.TYPE.GROUP);
  MPrivilege readJdbcPriv=new MPrivilege(new MResource(String.valueOf(jdbcConnector.getPersistenceId()),MResource.TYPE.CONNECTOR),SqoopActionConstant.READ,false);
  client.createRole(role2);
  client.grantRole(Lists.newArrayList(role2),Lists.newArrayList(group2));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role2.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readJdbcPriv));
  client=sqoopServerRunner.getSqoopClient(USER1);
  assertTrue(client.getConnectors().size() == 1);
  assertTrue(client.getConnector(HDFS_CONNECTOR_NAME) != null);
  assertTrue(client.getConnector(JDBC_CONNECTOR_NAME) == null);
  client=sqoopServerRunner.getSqoopClient(USER2);
  assertTrue(client.getConnectors().size() == 1);
  assertTrue(client.getConnector(JDBC_CONNECTOR_NAME) != null);
  assertTrue(client.getConnector(HDFS_CONNECTOR_NAME) == null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestGrantPrivilege </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantALLPrivilegeWithOtherPrivilegesExist() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole role4=new MRole(ROLE4);
  MPrincipal group4Princ=new MPrincipal(GROUP4,MPrincipal.TYPE.GROUP);
  MPrincipal role4Princ=new MPrincipal(ROLE4,MPrincipal.TYPE.ROLE);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MPrivilege readPrivilege=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  client.createRole(role4);
  client.grantRole(Lists.newArrayList(role4),Lists.newArrayList(group4Princ));
  client.grantPrivilege(Lists.newArrayList(role4Princ),Lists.newArrayList(readPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER4);
  assertTrue(client.getPrivilegesByPrincipal(role4Princ,allConnector).size() == 1);
  MPrivilege user4Privilege=client.getPrivilegesByPrincipal(role4Princ,allConnector).get(0);
  assertEquals(user4Privilege.getAction().toLowerCase(),SqoopActionConstant.READ);
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MPrivilege writePrivilege=new MPrivilege(allConnector,SqoopActionConstant.WRITE,false);
  client.grantPrivilege(Lists.newArrayList(role4Princ),Lists.newArrayList(writePrivilege));
  client=sqoopServerRunner.getSqoopClient(USER4);
  assertTrue(client.getPrivilegesByPrincipal(role4Princ,allConnector).size() == 2);
  List<String> actions=Lists.newArrayList();
  for (  MPrivilege privilege : client.getPrivilegesByPrincipal(role4Princ,allConnector)) {
    actions.add(privilege.getAction().toLowerCase());
  }
  assertEquals(2,actions.size());
  assertTrue(actions.contains(SqoopActionConstant.READ));
  assertTrue(actions.contains(SqoopActionConstant.WRITE));
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MPrivilege allPrivilege=new MPrivilege(allConnector,SqoopActionConstant.ALL_NAME,false);
  client.grantPrivilege(Lists.newArrayList(role4Princ),Lists.newArrayList(allPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER4);
  assertTrue(client.getPrivilegesByPrincipal(role4Princ,allConnector).size() == 1);
  user4Privilege=client.getPrivilegesByPrincipal(role4Princ,allConnector).get(0);
  assertEquals(user4Privilege.getAction(),SqoopActionConstant.ALL_NAME);
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGrantPrivilegeWithAllPrivilegeExist() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole role3=new MRole(ROLE3);
  MPrincipal group3Princ=new MPrincipal(GROUP3,MPrincipal.TYPE.GROUP);
  MPrincipal role3Princ=new MPrincipal(ROLE3,MPrincipal.TYPE.ROLE);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MPrivilege allPrivilege=new MPrivilege(allConnector,SqoopActionConstant.ALL_NAME,false);
  client.createRole(role3);
  client.grantRole(Lists.newArrayList(role3),Lists.newArrayList(group3Princ));
  client.grantPrivilege(Lists.newArrayList(role3Princ),Lists.newArrayList(allPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER3);
  assertTrue(client.getPrivilegesByPrincipal(role3Princ,allConnector).size() == 1);
  MPrivilege user3Privilege=client.getPrivilegesByPrincipal(role3Princ,allConnector).get(0);
  assertEquals(user3Privilege.getAction(),SqoopActionConstant.ALL_NAME);
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MPrivilege readPrivilege=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  client.grantPrivilege(Lists.newArrayList(role3Princ),Lists.newArrayList(readPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER3);
  assertTrue(client.getPrivilegesByPrincipal(role3Princ,allConnector).size() == 1);
  user3Privilege=client.getPrivilegesByPrincipal(role3Princ,allConnector).get(0);
  assertEquals(user3Privilege.getAction(),SqoopActionConstant.ALL_NAME);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestJobEndToEnd </h4><pre class="type-5 type-7 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowJob() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MLink rdbmsLink=client.createLink("generic-jdbc-connector");
  sqoopServerRunner.fillRdbmsLinkConfig(rdbmsLink);
  sqoopServerRunner.saveLink(client,rdbmsLink);
  MLink hdfsLink=client.createLink("hdfs-connector");
  sqoopServerRunner.fillHdfsLink(hdfsLink);
  sqoopServerRunner.saveLink(client,hdfsLink);
  MJob job1=client.createJob(hdfsLink.getPersistenceId(),rdbmsLink.getPersistenceId());
  sqoopServerRunner.fillHdfsFromConfig(job1);
  sqoopServerRunner.fillRdbmsToConfig(job1);
  sqoopServerRunner.saveJob(client,job1);
  MRole role1=new MRole(ROLE1);
  MPrincipal group1=new MPrincipal(GROUP1,MPrincipal.TYPE.GROUP);
  MResource allJob=new MResource(SqoopActionConstant.ALL,MResource.TYPE.JOB);
  MPrivilege readAllPrivilege=new MPrivilege(allJob,SqoopActionConstant.READ,false);
  client.createRole(role1);
  client.grantRole(Lists.newArrayList(role1),Lists.newArrayList(group1));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role1.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readAllPrivilege));
  MRole role2=new MRole(ROLE2);
  MPrincipal group2=new MPrincipal(GROUP2,MPrincipal.TYPE.GROUP);
  MResource job1Resource=new MResource(String.valueOf(job1.getPersistenceId()),MResource.TYPE.JOB);
  MPrivilege readJob1Privilege=new MPrivilege(job1Resource,SqoopActionConstant.READ,false);
  client.createRole(role2);
  client.grantRole(Lists.newArrayList(role2),Lists.newArrayList(group2));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role2.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readJob1Privilege));
  client=sqoopServerRunner.getSqoopClient(USER1);
  try {
    assertTrue(client.getJobs().size() == 1);
    assertTrue(client.getJob(job1.getPersistenceId()) != null);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
  client=sqoopServerRunner.getSqoopClient(USER2);
  try {
    assertTrue(client.getJobs().size() == 1);
    assertTrue(client.getJob(job1.getPersistenceId()) != null);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
  client=sqoopServerRunner.getSqoopClient(USER3);
  try {
    assertTrue(client.getJobs().size() == 0);
    client.getJob(job1.getPersistenceId());
    fail("expected Authorization exception happend");
  }
 catch (  Exception e) {
    assertCausedMessage(e,SecurityError.AUTH_0014.getMessage());
  }
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  client.deleteJob(job1.getPersistenceId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestLinkEndToEnd </h4><pre class="type-5 type-7 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowLink() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MLink hdfsLink=client.createLink("hdfs-connector");
  sqoopServerRunner.fillHdfsLink(hdfsLink);
  sqoopServerRunner.saveLink(client,hdfsLink);
  MRole role1=new MRole(ROLE1);
  MPrincipal group1=new MPrincipal(GROUP1,MPrincipal.TYPE.GROUP);
  MResource allLink=new MResource(SqoopActionConstant.ALL,MResource.TYPE.LINK);
  MPrivilege readAllPrivilege=new MPrivilege(allLink,SqoopActionConstant.READ,false);
  dropAndCreateRole(client,role1);
  client.grantRole(Lists.newArrayList(role1),Lists.newArrayList(group1));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role1.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readAllPrivilege));
  MRole role2=new MRole(ROLE2);
  MPrincipal group2=new MPrincipal(GROUP2,MPrincipal.TYPE.GROUP);
  MResource hdfsLinkResource=new MResource(String.valueOf(hdfsLink.getPersistenceId()),MResource.TYPE.LINK);
  MPrivilege readHdfsLinkPrivilege=new MPrivilege(hdfsLinkResource,SqoopActionConstant.READ,false);
  dropAndCreateRole(client,role2);
  client.grantRole(Lists.newArrayList(role2),Lists.newArrayList(group2));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role2.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readHdfsLinkPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER1);
  try {
    assertTrue(client.getLinks().size() == 1);
    assertTrue(client.getLink(hdfsLink.getPersistenceId()) != null);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
  client=sqoopServerRunner.getSqoopClient(USER2);
  try {
    assertTrue(client.getLinks().size() == 1);
    assertTrue(client.getLink(hdfsLink.getPersistenceId()) != null);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
  client=sqoopServerRunner.getSqoopClient(USER3);
  try {
    assertTrue(client.getLinks().size() == 0);
    client.getLink(hdfsLink.getPersistenceId());
    fail("expected Authorization exception happend");
  }
 catch (  Exception e) {
    assertCausedMessage(e,SecurityError.AUTH_0014.getMessage());
  }
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  client.deleteLink(hdfsLink.getPersistenceId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestOwnerPrivilege </h4><pre class="type-5 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobOwner() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(USER3);
  assertTrue(client.getConnectors().size() == 0);
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole role3=new MRole(ROLE3);
  MPrincipal group3=new MPrincipal(GROUP3,MPrincipal.TYPE.GROUP);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MPrivilege readPriv=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  client.createRole(role3);
  client.grantRole(Lists.newArrayList(role3),Lists.newArrayList(group3));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(ROLE3,MPrincipal.TYPE.ROLE)),Lists.newArrayList(readPriv));
  client=sqoopServerRunner.getSqoopClient(USER3);
  assertTrue(client.getConnectors().size() > 0);
  MLink rdbmsLink=client.createLink("generic-jdbc-connector");
  sqoopServerRunner.fillRdbmsLinkConfig(rdbmsLink);
  sqoopServerRunner.saveLink(client,rdbmsLink);
  MLink hdfsLink=client.createLink("hdfs-connector");
  sqoopServerRunner.fillHdfsLink(hdfsLink);
  sqoopServerRunner.saveLink(client,hdfsLink);
  assertTrue(client.getLinks().size() == 2);
  hdfsLink.setName("HDFS_update2");
  client.updateLink(hdfsLink);
  rdbmsLink.setName("RDBM_update");
  client.updateLink(rdbmsLink);
  MJob job1=client.createJob(hdfsLink.getPersistenceId(),rdbmsLink.getPersistenceId());
  sqoopServerRunner.fillHdfsFromConfig(job1);
  sqoopServerRunner.fillRdbmsToConfig(job1);
  sqoopServerRunner.saveJob(client,job1);
  client=sqoopServerRunner.getSqoopClient(USER4);
  assertTrue(client.getJobs().size() == 0);
  try {
    client.deleteJob(job1.getPersistenceId());
    fail("expected Authorization exception happend");
  }
 catch (  Exception e) {
    assertCausedMessage(e,SecurityError.AUTH_0014.getMessage());
  }
  client=sqoopServerRunner.getSqoopClient(USER3);
  assertEquals(client.getJob(job1.getPersistenceId()),job1);
  client.deleteJob(job1.getPersistenceId());
  client.deleteLink(hdfsLink.getPersistenceId());
  client.deleteLink(rdbmsLink.getPersistenceId());
}

</code></pre>

<br>
<pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLinkOwner() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(USER1);
  assertTrue(client.getConnectors().size() == 0);
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole role1=new MRole(ROLE1);
  MPrincipal group1=new MPrincipal(GROUP1,MPrincipal.TYPE.GROUP);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MPrivilege readPriv=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  client.createRole(role1);
  client.grantRole(Lists.newArrayList(role1),Lists.newArrayList(group1));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role1.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readPriv));
  client=sqoopServerRunner.getSqoopClient(USER1);
  assertTrue(client.getConnectors().size() > 0);
  MLink hdfsLink=client.createLink("hdfs-connector");
  sqoopServerRunner.fillHdfsLink(hdfsLink);
  sqoopServerRunner.saveLink(client,hdfsLink);
  assertEquals(client.getLink(hdfsLink.getPersistenceId()),hdfsLink);
  hdfsLink.setName("HDFS_update1");
  sqoopServerRunner.updateLink(client,hdfsLink);
  client=sqoopServerRunner.getSqoopClient(USER2);
  assertTrue(client.getLinks().size() == 0);
  client=sqoopServerRunner.getSqoopClient(USER1);
  client.deleteLink(hdfsLink.getPersistenceId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestRevokePrivilege </h4><pre class="type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokePrivilegeWithAllPrivilegeExist() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole role3=new MRole(ROLE3);
  MPrincipal group3Princ=new MPrincipal(GROUP3,MPrincipal.TYPE.GROUP);
  MPrincipal role3Princ=new MPrincipal(ROLE3,MPrincipal.TYPE.ROLE);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MPrivilege allPrivilege=new MPrivilege(allConnector,SqoopActionConstant.ALL_NAME,false);
  client.createRole(role3);
  client.grantRole(Lists.newArrayList(role3),Lists.newArrayList(group3Princ));
  client.grantPrivilege(Lists.newArrayList(role3Princ),Lists.newArrayList(allPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER3);
  assertTrue(client.getPrivilegesByPrincipal(role3Princ,allConnector).size() == 1);
  MPrivilege user3Privilege=client.getPrivilegesByPrincipal(role3Princ,allConnector).get(0);
  assertEquals(user3Privilege.getAction(),SqoopActionConstant.ALL_NAME);
  MPrivilege readPrivilege=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  client.revokePrivilege(Lists.newArrayList(role3Princ),Lists.newArrayList(readPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER3);
  assertTrue(client.getPrivilegesByPrincipal(role3Princ,allConnector).size() == 1);
  user3Privilege=client.getPrivilegesByPrincipal(role3Princ,allConnector).get(0);
  assertEquals(user3Privilege.getAction().toLowerCase(),SqoopActionConstant.WRITE);
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRevokeNotExistPrivilege() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole testRole=new MRole("noexist_privilege_role1");
  MPrincipal testPrinc=new MPrincipal(testRole.getName(),MPrincipal.TYPE.ROLE);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MPrivilege readPrivilege=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  client.createRole(testRole);
  assertTrue(client.getPrivilegesByPrincipal(testPrinc,allConnector).size() == 0);
  client.revokePrivilege(Lists.newArrayList(testPrinc),Lists.newArrayList(readPrivilege));
  assertTrue(client.getPrivilegesByPrincipal(testPrinc,allConnector).size() == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestRoleOperation </h4><pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAdminShowAllRole() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  client.createRole(new MRole("show_all_role"));
  assertTrue(client.getRoles().size() > 0);
}

</code></pre>

<br>
<pre class="type-7 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testAdminToCreateDeleteRole() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MRole role1=new MRole("create_delete_role_1");
  MRole role2=new MRole("create_delete_role_2");
  client.createRole(role1);
  client.createRole(role2);
  assertTrue(client.getRoles().size() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sentry.tests.e2e.sqoop.TestServerScopeEndToEnd </h4><pre class="type-5 type-7 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerScopePrivilege() throws Exception {
  SqoopClient client=sqoopServerRunner.getSqoopClient(ADMIN_USER);
  MLink rdbmsLink=client.createLink("generic-jdbc-connector");
  sqoopServerRunner.fillRdbmsLinkConfig(rdbmsLink);
  sqoopServerRunner.saveLink(client,rdbmsLink);
  MLink hdfsLink=client.createLink("hdfs-connector");
  sqoopServerRunner.fillHdfsLink(hdfsLink);
  sqoopServerRunner.saveLink(client,hdfsLink);
  MJob job1=client.createJob(hdfsLink.getPersistenceId(),rdbmsLink.getPersistenceId());
  sqoopServerRunner.fillHdfsFromConfig(job1);
  sqoopServerRunner.fillRdbmsToConfig(job1);
  sqoopServerRunner.saveJob(client,job1);
  MResource sqoopServer1=new MResource(SQOOP_SERVER_NAME,MResource.TYPE.SERVER);
  MRole role1=new MRole(ROLE1);
  MPrincipal group1=new MPrincipal(GROUP1,MPrincipal.TYPE.GROUP);
  MPrivilege readPrivilege=new MPrivilege(sqoopServer1,SqoopActionConstant.READ,false);
  client.createRole(role1);
  client.grantRole(Lists.newArrayList(role1),Lists.newArrayList(group1));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role1.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(readPrivilege));
  MRole role2=new MRole(ROLE2);
  MPrincipal group2=new MPrincipal(GROUP2,MPrincipal.TYPE.GROUP);
  MPrivilege writePrivilege=new MPrivilege(sqoopServer1,SqoopActionConstant.WRITE,false);
  client.createRole(role2);
  MResource allConnector=new MResource(SqoopActionConstant.ALL,MResource.TYPE.CONNECTOR);
  MResource allLink=new MResource(SqoopActionConstant.ALL,MResource.TYPE.LINK);
  MPrivilege readAllConPriv=new MPrivilege(allConnector,SqoopActionConstant.READ,false);
  MPrivilege readAllLinkPriv=new MPrivilege(allLink,SqoopActionConstant.READ,false);
  client.grantRole(Lists.newArrayList(role2),Lists.newArrayList(group2));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role2.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(writePrivilege,readAllConPriv,readAllLinkPriv));
  MRole role3=new MRole(ROLE3);
  MPrincipal group3=new MPrincipal(GROUP3,MPrincipal.TYPE.GROUP);
  MPrivilege allPrivilege=new MPrivilege(sqoopServer1,SqoopActionConstant.ALL_NAME,false);
  client.createRole(role3);
  client.grantRole(Lists.newArrayList(role3),Lists.newArrayList(group3));
  client.grantPrivilege(Lists.newArrayList(new MPrincipal(role3.getName(),MPrincipal.TYPE.ROLE)),Lists.newArrayList(allPrivilege));
  client=sqoopServerRunner.getSqoopClient(USER1);
  try {
    assertTrue(client.getConnector("generic-jdbc-connector") != null);
    assertTrue(client.getConnector("hdfs-connector") != null);
    assertTrue(client.getConnectors().size() > 0);
    assertTrue(client.getLink(hdfsLink.getPersistenceId()) != null);
    assertTrue(client.getLink(rdbmsLink.getPersistenceId()) != null);
    assertTrue(client.getLinks().size() == 2);
    assertTrue(client.getJob(job1.getPersistenceId()) != null);
    assertTrue(client.getJobs().size() == 1);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
  try {
    hdfsLink.setName("hdfs1_update_user1");
    client.updateLink(hdfsLink);
    fail("expected Authorization exception happend");
  }
 catch (  Exception e) {
    assertCausedMessage(e,SecurityError.AUTH_0014.getMessage());
  }
  try {
    job1.setName("job1_update_user1");
    client.updateJob(job1);
    fail("expected Authorization exception happend");
  }
 catch (  Exception e) {
    assertCausedMessage(e,SecurityError.AUTH_0014.getMessage());
  }
  client=sqoopServerRunner.getSqoopClient(USER2);
  try {
    hdfsLink.setName("hdfs1_update_user2");
    client.updateLink(hdfsLink);
    job1.setName("job1_update_user2");
    client.updateJob(job1);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
  assertTrue(client.getJobs().size() == 0);
  client=sqoopServerRunner.getSqoopClient(USER3);
  try {
    assertTrue(client.getConnector("generic-jdbc-connector") != null);
    assertTrue(client.getConnector("hdfs-connector") != null);
    assertTrue(client.getConnectors().size() > 0);
    assertTrue(client.getLink(hdfsLink.getPersistenceId()) != null);
    assertTrue(client.getLink(rdbmsLink.getPersistenceId()) != null);
    assertTrue(client.getLinks().size() == 2);
    assertTrue(client.getJob(job1.getPersistenceId()) != null);
    assertTrue(client.getJobs().size() == 1);
    hdfsLink.setName("hdfs1_update_user3");
    client.updateLink(hdfsLink);
    job1.setName("job1_update_user3");
    client.updateJob(job1);
  }
 catch (  Exception e) {
    fail("unexpected Authorization exception happend");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.solr.handler.component.QueryDocAuthorizationComponentTest </h4><pre class="type-5 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a request from a user coming from an empty group.
 * This request should be rejected because otherwise document-level
 * filtering will be skipped.
 */
@Test public void testEmptyGroup() throws Exception {
  String user="bogusUser";
  try {
    NamedList args=new NamedList();
    args.add(QueryDocAuthorizationComponent.ENABLED_PROP,"true");
    ResponseBuilder builder=runComponent(user,args,null);
    checkParams(null,builder);
    Assert.fail("Expected SolrException");
  }
 catch (  SolrException ex) {
    assertEquals(ex.code(),SolrException.ErrorCode.UNAUTHORIZED.code);
    assertTrue(ex.getMessage().contains(user + " rejected because user is not associated with any roles"));
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test a request from a user coming from an empty role.
 * This request should be rejected because otherwise document-level
 * filtering will be skipped.
 */
@Test public void testEmptyRole() throws Exception {
  String user="undefinedRoleUser";
  try {
    NamedList args=new NamedList();
    args.add(QueryDocAuthorizationComponent.ENABLED_PROP,"true");
    ResponseBuilder builder=runComponent(user,args,null);
    checkParams(null,builder);
    Assert.fail("Expected SolrException");
  }
 catch (  SolrException ex) {
    assertEquals(ex.code(),SolrException.ErrorCode.UNAUTHORIZED.code);
    assertTrue(ex.getMessage().contains(user + " rejected because user is not associated with any roles"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.solr.sentry.SentryIndexAuthorizationSingletonTest </h4><pre class="type-12 type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoBinding() throws Exception {
  Constructor ctor=SentryIndexAuthorizationSingleton.class.getDeclaredConstructor(String.class);
  ctor.setAccessible(true);
  SentryIndexAuthorizationSingleton nonSingleton=(SentryIndexAuthorizationSingleton)ctor.newInstance("");
  doExpectUnauthorized(nonSingleton,null,null,"binding");
  try {
    nonSingleton.getUserName(null);
    Assert.fail("Expected Solr exception");
  }
 catch (  SolrException ex) {
    assertEquals(ex.code(),SolrException.ErrorCode.UNAUTHORIZED.code);
  }
  Collection<String> groups=nonSingleton.getRoles("junit");
  assertEquals(null,groups);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting the roles from user name
 */
@Test public void testGetRoles() throws Exception {
  Collection<String> emptyCollection=ImmutableSet.<String>of();
  try {
    sentryInstance.getRoles(null);
    Assert.fail("Excepted SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  try {
    sentryInstance.getRoles("withoutGroupUser");
    Assert.fail("Excepted SentryGroupNotFoundException");
  }
 catch (  SentryGroupNotFoundException e) {
  }
  Collection<String> roles=sentryInstance.getRoles("undefinedRoleUser");
  assertTrue(CollectionUtils.isEqualCollection(emptyCollection,roles));
  Collection<String> singleRole=ImmutableSet.<String>of("junit_role");
  roles=sentryInstance.getRoles("junit");
  assertTrue(CollectionUtils.isEqualCollection(singleRole,roles));
  Collection<String> multipleRoles=ImmutableSet.<String>of("junit_role","queryOnlyAdmin_role","updateOnlyAdmin_role");
  roles=sentryInstance.getRoles("multiGroupUser");
  assertTrue(CollectionUtils.isEqualCollection(multipleRoles,roles));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting the user name.
 */
@Test public void testUserName() throws Exception {
  SolrQueryRequest request=null;
  try {
    request=new SolrQueryRequestBase(core,new ModifiableSolrParams()){
    }
;
    try {
      sentryInstance.getUserName(request);
      Assert.fail("Expected SolrException");
    }
 catch (    SolrException ex) {
      assertEquals(ex.code(),SolrException.ErrorCode.UNAUTHORIZED.code);
    }
    LocalSolrQueryRequest localRequest=null;
    try {
      localRequest=new LocalSolrQueryRequest(null,new ModifiableSolrParams());
      String superUser=(System.getProperty("solr.authorization.superuser","solr"));
      String localName=sentryInstance.getUserName(localRequest);
      assertEquals(superUser,localName);
    }
  finally {
      if (localRequest != null)       localRequest.close();
    }
    SolrQueryRequest sqr=getRequest();
    prepareCollAndUser(core,sqr,"collection",null,true);
    String nullName=sentryInstance.getUserName(sqr);
    assertEquals(null,nullName);
    String userName="foobar";
    prepareCollAndUser(core,sqr,"collection",userName,true);
    String returnedName=sentryInstance.getUserName(sqr);
    assertEquals(userName,returnedName);
  }
  finally {
    if (request != null)     request.close();
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
