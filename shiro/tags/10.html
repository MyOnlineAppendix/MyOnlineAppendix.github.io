<h3><span class=" glyphicon glyphicon-tag"/>&nbspEqualityVerifier</h3><kbd>Verifies whether objects/variable are equal to an expected value </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.shiro.authc.AbstractAuthenticatorTest </h4><pre class="type-11 type-8 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notifyFailureAfterDoAuthenticateThrowsAuthenticationException(){
  AuthenticationListener mockListener=createMock(AuthenticationListener.class);
  AuthenticationToken token=newToken();
  final AuthenticationException ae=new AuthenticationException("dummy exception to test notification");
  abstractAuthenticator=new AbstractAuthenticator(){
    protected AuthenticationInfo doAuthenticate(    AuthenticationToken token) throws AuthenticationException {
      throw ae;
    }
  }
;
  abstractAuthenticator.getAuthenticationListeners().add(mockListener);
  mockListener.onFailure(token,ae);
  replay(mockListener);
  boolean exceptionThrown=false;
  try {
    abstractAuthenticator.authenticate(token);
  }
 catch (  AuthenticationException e) {
    exceptionThrown=true;
    assertEquals(e,ae);
  }
  verify(mockListener);
  if (!exceptionThrown) {
    fail("An AuthenticationException should have been thrown during the notifyFailure test case.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.SimpleAuthenticationInfoTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("serial") @Test public void testMergeWithImmutablePrincipalCollection(){
  SimpleAuthenticationInfo aggregate=new SimpleAuthenticationInfo();
  PrincipalCollection principalCollection=new PrincipalCollection(){
    @SuppressWarnings("unchecked") public List asList(){
      return null;
    }
    @SuppressWarnings("unchecked") public Set asSet(){
      return null;
    }
    public <T>Collection<T> byType(    Class<T> type){
      return null;
    }
    @SuppressWarnings("unchecked") public Collection fromRealm(    String realmName){
      Collection principals=new HashSet();
      principals.add("testprincipal");
      return principals;
    }
    public Object getPrimaryPrincipal(){
      return null;
    }
    public Set<String> getRealmNames(){
      Set<String> realms=new HashSet<String>();
      realms.add("testrealm");
      return realms;
    }
    public boolean isEmpty(){
      return false;
    }
    public <T>T oneByType(    Class<T> type){
      return null;
    }
    @SuppressWarnings("unchecked") public Iterator iterator(){
      return null;
    }
  }
;
  aggregate.setPrincipals(principalCollection);
  SimpleAuthenticationInfo local=new SimpleAuthenticationInfo("username","password","testRealm");
  aggregate.merge(local);
  assertEquals(2,aggregate.getPrincipals().asList().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.permission.DomainPermissionTest </h4><pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsConstructorWithMultipleActions(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1,action2,action3");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals(2,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsTargetsConstructorWithSingleActionAndTarget(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1","target1");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  set=p.getTargets();
  assertNotNull(set);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
  parts=p.getParts();
  assertEquals(3,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  set=parts.get(2);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConstructor(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  String entry;
  p=new DomainPermission();
  assertTrue("domain".equals(p.getDomain()));
  set=p.getActions();
  assertNull(set);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals("Number of parts",1,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  entry=set.iterator().next();
  assertEquals("domain",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsTargetsConstructorWithMultipleActionsAndTargets(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1,action2,action3","target1,target2,target3");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
  set=p.getTargets();
  assertNotNull(set);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
  entry=iterator.next();
  assertEquals("target2",entry);
  entry=iterator.next();
  assertEquals("target3",entry);
  parts=p.getParts();
  assertEquals(3,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
  set=parts.get(2);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
  entry=iterator.next();
  assertEquals("target2",entry);
  entry=iterator.next();
  assertEquals("target3",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsConstructorWithSingleAction(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals(2,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.cache.ehcache.EhCacheManagerTest </h4><pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLazyCacheManagerCreationWithoutCallingInit(){
  net.sf.ehcache.CacheManager ehCacheManager=cacheManager.getCacheManager();
  assertNull(ehCacheManager);
  Cache<String,String> cache=cacheManager.getCache("test");
  ehCacheManager=cacheManager.getCacheManager();
  assertNotNull(ehCacheManager);
  assertNotNull(cache);
  cache.put("hello","world");
  String value=cache.get("hello");
  assertNotNull(value);
  assertEquals(value,"world");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.aop.ShiroAopModuleTest </h4><pre class="type-11 type-8 type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindShiroInterceptor(){
  ShiroAopModule underTest=new ShiroAopModule(){
    @Override protected void configureInterceptors(    AnnotationResolver resolver){
      bindShiroInterceptor(new MyAnnotationMethodInterceptor());
    }
  }
;
  List<Element> elements=Elements.getElements(underTest);
  for (  Element element : elements) {
    if (element instanceof InterceptorBinding) {
      InterceptorBinding binding=(InterceptorBinding)element;
      assertTrue(binding.getClassMatcher().matches(getClass()));
      Method method=null;
      Class<? extends Annotation> theAnnotation=null;
      for (      Class<? extends Annotation> annotation : protectedMethods.keySet()) {
        if (binding.getMethodMatcher().matches(protectedMethods.get(annotation))) {
          method=protectedMethods.get(annotation);
          theAnnotation=annotation;
          protectedMethods.remove(annotation);
          break;
        }
      }
      if (method == null) {
        fail("Did not expect interceptor binding " + binding.getInterceptors());
      }
      List<MethodInterceptor> interceptors=binding.getInterceptors();
      assertEquals(1,interceptors.size());
      assertTrue(interceptors.get(0) instanceof AopAllianceMethodInterceptorAdapter);
      assertTrue(interceptorTypes.get(theAnnotation).isInstance(((AopAllianceMethodInterceptorAdapter)interceptors.get(0)).shiroInterceptor));
    }
  }
  assertTrue("Not all interceptors were bound.",protectedMethods.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.AbstractInjectionProviderTest </h4><pre class="type-13 type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet() throws Exception {
  Injector mockInjector=createMock(Injector.class);
  Object c1=new Object();
  Object c2=new Object();
  final AtomicBoolean postProcessCalled=new AtomicBoolean(false);
  expect(mockInjector.getInstance(keyC1)).andReturn(c1);
  expect(mockInjector.getInstance(keyC2)).andReturn(c2);
  mockInjector.injectMembers(anyObject(SomeInjectedClass.class));
  replay(mockInjector);
  AbstractInjectionProvider<SomeInjectedClass> underTest=new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class)){
    @Override protected SomeInjectedClass postProcess(    SomeInjectedClass someInjectedClass){
      postProcessCalled.set(true);
      return super.postProcess(someInjectedClass);
    }
  }
;
  underTest.injector=mockInjector;
  SomeInjectedClass got=underTest.get();
  assertEquals("Wrong parameter passed to constructor (index 0).",c1,got.c1);
  assertEquals("Wrong parameter passed to constructor (index 1).",c2,got.c2);
  assertTrue("postProcess method was not called.",postProcessCalled.get());
  verify(mockInjector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.FilterChainResolverProviderTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDependencies() throws Exception {
  Set<Dependency<?>> dependencySet=underTest.getDependencies();
  assertEquals(4,dependencySet.size());
  assertTrue("Dependency set doesn't contain key1a.",dependencySet.contains(Dependency.get(key1a)));
  assertTrue("Dependency set doesn't contain key1b.",dependencySet.contains(Dependency.get(key1b)));
  assertTrue("Dependency set doesn't contain key1c.",dependencySet.contains(Dependency.get(key1c)));
  assertTrue("Dependency set doesn't contain key2a.",dependencySet.contains(Dependency.get(key2a)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.jndi.JndiObjectFactoryTest </h4><pre class="type-13 type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetInstanceNoType() throws Exception {
  final String name="my/jndi/resource";
  final String returnValue="jndiString";
  JndiObjectFactory<String> underTest=new JndiObjectFactory<String>(){
    @Override protected Object lookup(    String jndiName) throws NamingException {
      assertEquals(name,jndiName);
      return new String(returnValue);
    }
  }
;
  underTest.setResourceName(name);
  assertEquals(returnValue,underTest.getInstance());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetInstanceWithType() throws Exception {
  final String name="my/jndi/resource";
  final String returnValue="jndiString";
  JndiObjectFactory<String> underTest=new JndiObjectFactory<String>(){
    @Override protected Object lookup(    String jndiName,    Class requiredType) throws NamingException {
      assertEquals(name,jndiName);
      assertEquals(String.class,requiredType);
      return new String(returnValue);
    }
  }
;
  underTest.setRequiredType(String.class);
  underTest.setResourceName(name);
  assertEquals(returnValue,underTest.getInstance());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.mgt.DefaultSecurityManagerTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that validates functionality for issue
 * <a href="https://issues.apache.org/jira/browse/JSEC-22">JSEC-22</a>
 */
@Test public void testSubjectReuseAfterLogout(){
  Subject subject=SecurityUtils.getSubject();
  AuthenticationToken token=new UsernamePasswordToken("guest","guest");
  subject.login(token);
  assertTrue(subject.isAuthenticated());
  assertTrue("guest".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("guest"));
  Session session=subject.getSession();
  Serializable firstSessionId=session.getId();
  session.setAttribute("key","value");
  assertEquals(session.getAttribute("key"),"value");
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
  subject.login(new UsernamePasswordToken("lonestarr","vespa"));
  assertTrue(subject.isAuthenticated());
  assertTrue("lonestarr".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("goodguy"));
  assertNotNull(subject.getSession());
  assertFalse(firstSessionId.equals(subject.getSession().getId()));
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
}

</code></pre>

<br>
<pre class="type-8 type-2 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that validates functionality for issue
 * <a href="https://issues.apache.org/jira/browse/JSEC-46">JSEC-46</a>
 */
@Test public void testAutoCreateSessionAfterInvalidation(){
  Subject subject=SecurityUtils.getSubject();
  Session session=subject.getSession();
  Serializable origSessionId=session.getId();
  String key="foo";
  String value1="bar";
  session.setAttribute(key,value1);
  assertEquals(value1,session.getAttribute(key));
  session.setTimeout(50);
  try {
    Thread.sleep(150);
  }
 catch (  InterruptedException e) {
  }
  try {
    session.setTimeout(AbstractValidatingSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT);
    fail("Session should have expired.");
  }
 catch (  ExpiredSessionException expected) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConfig(){
  Subject subject=SecurityUtils.getSubject();
  AuthenticationToken token=new UsernamePasswordToken("guest","guest");
  subject.login(token);
  assertTrue(subject.isAuthenticated());
  assertTrue("guest".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("guest"));
  Session session=subject.getSession();
  session.setAttribute("key","value");
  assertEquals(session.getAttribute("key"),"value");
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.AuthorizingRealmTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullAuthzInfo(){
  AuthorizingRealm realm=new AuthorizingRealm(){
    protected AuthorizationInfo doGetAuthorizationInfo(    PrincipalCollection principals){
      return null;
    }
    protected AuthenticationInfo doGetAuthenticationInfo(    AuthenticationToken token) throws AuthenticationException {
      return null;
    }
  }
;
  Principal principal=new UsernamePrincipal("blah");
  PrincipalCollection pCollection=new SimplePrincipalCollection(principal,"nullAuthzRealm");
  List<Permission> permList=new ArrayList<Permission>();
  permList.add(new WildcardPermission("stringPerm1"));
  permList.add(new WildcardPermission("stringPerm2"));
  List<String> roleList=new ArrayList<String>();
  roleList.add("role1");
  roleList.add("role2");
  boolean thrown=false;
  try {
    realm.checkPermission(pCollection,"stringPermission");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermission(pCollection,new WildcardPermission("stringPermission"));
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermissions(pCollection,"stringPerm1","stringPerm2");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermissions(pCollection,permList);
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkRole(pCollection,"role1");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkRoles(pCollection,roleList);
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  assertFalse(realm.hasAllRoles(pCollection,roleList));
  assertFalse(realm.hasRole(pCollection,"role1"));
  assertArrayEquals(new boolean[]{false,false},realm.hasRoles(pCollection,roleList));
  assertFalse(realm.isPermitted(pCollection,"perm1"));
  assertFalse(realm.isPermitted(pCollection,new WildcardPermission("perm1")));
  assertArrayEquals(new boolean[]{false,false},realm.isPermitted(pCollection,"perm1","perm2"));
  assertArrayEquals(new boolean[]{false,false},realm.isPermitted(pCollection,permList));
  assertFalse(realm.isPermittedAll(pCollection,"perm1","perm2"));
  assertFalse(realm.isPermittedAll(pCollection,permList));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateAccountOverride(){
  AuthorizingRealm realm=new AllowAllRealm(){
    @Override protected AuthenticationInfo buildAuthenticationInfo(    Object principal,    Object credentials){
      String username=(String)principal;
      UsernamePrincipal customPrincipal=new UsernamePrincipal(username);
      return new SimpleAccount(customPrincipal,credentials,getName());
    }
  }
;
  AuthenticationInfo info=realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),ROLE));
  Object principal=info.getPrincipals().getPrimaryPrincipal();
  assertTrue(principal instanceof UsernamePrincipal);
  assertEquals(USERNAME,((UsernamePrincipal)principal).getUsername());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapContextFactoryTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAuthenticationMechanism(){
  String mech="MD5-DIGEST";
  factory.setAuthenticationMechanism(mech);
  assertEquals(mech,factory.getAuthenticationMechanism());
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReferral(){
  String referral="throw";
  factory.setReferral(referral);
  assertEquals(referral,factory.getReferral());
}

</code></pre>

<br>
<pre class="type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLdapContextDefault() throws NamingException {
  factory=new JndiLdapContextFactory(){
    @Override protected LdapContext createLdapContext(    Hashtable env) throws NamingException {
      assertEquals("ldap://localhost:389",env.get(Context.PROVIDER_URL));
      assertEquals("foo",env.get(Context.SECURITY_PRINCIPAL));
      assertEquals("bar",env.get(Context.SECURITY_CREDENTIALS));
      assertEquals("simple",env.get(Context.SECURITY_AUTHENTICATION));
      assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));
      return createNiceMock(LdapContext.class);
    }
  }
;
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"foo","bar");
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCustomEnvironment(){
  Map<String,String> map=new HashMap<String,String>();
  map.put("foo","bar");
  factory.setEnvironment(map);
  assertEquals("bar",factory.getEnvironment().get("foo"));
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetContextFactoryClassName(){
  assertEquals(JndiLdapContextFactory.DEFAULT_CONTEXT_FACTORY_CLASS_NAME,factory.getContextFactoryClassName());
}

</code></pre>

<br>
<pre class="type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSystemLdapContextPoolingDisabled() throws NamingException {
  factory=new JndiLdapContextFactory(){
    @Override protected LdapContext createLdapContext(    Hashtable env) throws NamingException {
      assertEquals("ldap://localhost:389",env.get(Context.PROVIDER_URL));
      assertEquals("foo",env.get(Context.SECURITY_PRINCIPAL));
      assertEquals("bar",env.get(Context.SECURITY_CREDENTIALS));
      assertEquals("simple",env.get(Context.SECURITY_AUTHENTICATION));
      assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));
      return createNiceMock(LdapContext.class);
    }
  }
;
  factory.setSystemUsername("foo");
  factory.setSystemPassword("bar");
  factory.setPoolingEnabled(false);
  factory.setUrl("ldap://localhost:389");
  factory.getSystemLdapContext();
}

</code></pre>

<br>
<pre class="type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings({"deprecation"}) @Test public void testGetLdapContextStringArguments() throws NamingException {
  factory=new JndiLdapContextFactory(){
    @Override protected LdapContext createLdapContext(    Hashtable env) throws NamingException {
      assertEquals("ldap://localhost:389",env.get(Context.PROVIDER_URL));
      assertEquals("foo",env.get(Context.SECURITY_PRINCIPAL));
      assertEquals("bar",env.get(Context.SECURITY_CREDENTIALS));
      assertEquals("simple",env.get(Context.SECURITY_AUTHENTICATION));
      assertNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));
      return createNiceMock(LdapContext.class);
    }
  }
;
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext("foo","bar");
}

</code></pre>

<br>
<pre class="type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSystemLdapContext() throws NamingException {
  factory=new JndiLdapContextFactory(){
    @Override protected LdapContext createLdapContext(    Hashtable env) throws NamingException {
      assertEquals("ldap://localhost:389",env.get(Context.PROVIDER_URL));
      assertEquals("foo",env.get(Context.SECURITY_PRINCIPAL));
      assertEquals("bar",env.get(Context.SECURITY_CREDENTIALS));
      assertEquals("simple",env.get(Context.SECURITY_AUTHENTICATION));
      assertNotNull(env.get(SUN_CONNECTION_POOLING_PROPERTY));
      return createNiceMock(LdapContext.class);
    }
  }
;
  factory.setSystemUsername("foo");
  factory.setSystemPassword("bar");
  factory.setUrl("ldap://localhost:389");
  factory.getSystemLdapContext();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapRealmTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetUserDnWithOutPrefixAndSuffix(){
  realm=new JndiLdapRealm(){
    @Override protected String getUserDnPrefix(){
      return null;
    }
    @Override protected String getUserDnSuffix(){
      return null;
    }
  }
;
  String principal="foo";
  String userDn=realm.getUserDn(principal);
  assertEquals(principal,userDn);
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUserDnTemplate(){
  String template="uid={0},ou=users,dc=mycompany,dc=com";
  realm.setUserDnTemplate(template);
  assertEquals(template,realm.getUserDnTemplate());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInstance(){
  assertTrue(realm.getCredentialsMatcher() instanceof AllowAllCredentialsMatcher);
  assertEquals(AuthenticationToken.class,realm.getAuthenticationTokenClass());
  assertTrue(realm.getContextFactory() instanceof JndiLdapContextFactory);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.samples.aspectj.bank.SecureBankServiceTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCloseAccount_withBalance() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Gerry Smith");
  makeDepositAndValidateAccount(accountId,385.00d,"Gerry Smith");
  logoutCurrentSubject();
  loginAsSuperviser();
  double closingBalance=service.closeAccount(accountId);
  Assert.assertEquals(385.00d,closingBalance);
  assertAccount("Gerry Smith",false,0.00d,2,accountId);
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCloseAccount_zeroBalance() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Chris Smith");
  logoutCurrentSubject();
  loginAsSuperviser();
  double closingBalance=service.closeAccount(accountId);
  Assert.assertEquals(0.00d,closingBalance);
  assertAccount("Chris Smith",false,0.00d,1,accountId);
}

</code></pre>

<br>
<pre class="type-2 type-10 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=InactiveAccountException.class) public void testCloseAccount_alreadyClosed() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Chris Smith");
  logoutCurrentSubject();
  loginAsSuperviser();
  double closingBalance=service.closeAccount(accountId);
  Assert.assertEquals(0.00d,closingBalance);
  assertAccount("Chris Smith",false,0.00d,1,accountId);
  service.closeAccount(accountId);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.AbstractValidatingSessionManagerTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that no memory leak exists on invalid sessions: expired or stopped
 * Verifies <a href="https://issues.apache.org/jira/browse/SHIRO-399">SHIRO-399</a>.
 */
@Test public void testNoMemoryLeakOnInvalidSessions() throws Exception {
  SessionListener sessionListener=new SessionListener(){
    public void onStart(    Session session){
      session.setAttribute("I love","Romania");
    }
    public void onStop(    Session session){
      tryToCleanSession(session);
    }
    public void onExpiration(    Session session){
      tryToCleanSession(session);
    }
    private void tryToCleanSession(    Session session){
      Collection keys=session.getAttributeKeys();
      for (      Object key : keys) {
        session.removeAttribute(key);
      }
    }
  }
;
  DefaultSessionManager sessionManager=new DefaultSessionManager();
  sessionManager.setSessionListeners(Arrays.asList(sessionListener));
  Session session=sessionManager.start(null);
  assertEquals(1,sessionManager.getActiveSessions().size());
  session.setTimeout(0L);
  Thread.sleep(1);
  sessionManager.validateSessions();
  assertEquals(0,sessionManager.getActiveSessions().size());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that both SessionListeners are called and that invalid sessions are deleted by default.
 * Verifies <a href="https://issues.apache.org/jira/browse/SHIRO-199">SHIRO-199</a>.
 */
@Test public void testValidateSessions(){
  final SimpleSession validSession=new SimpleSession();
  validSession.setId(1);
  final SimpleSession invalidSession=new SimpleSession();
  Calendar cal=Calendar.getInstance();
  Long expiredTimeout=AbstractSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT + 1;
  cal.add(Calendar.MILLISECOND,-(expiredTimeout.intValue()));
  Date past=cal.getTime();
  invalidSession.setStartTimestamp(past);
  invalidSession.setLastAccessTime(past);
  invalidSession.setId(2);
  final AtomicInteger expirationCount=new AtomicInteger();
  SessionListener sessionListener=new SessionListenerAdapter(){
    @Override public void onExpiration(    Session session){
      expirationCount.incrementAndGet();
    }
  }
;
  AbstractValidatingSessionManager sessionManager=new AbstractValidatingSessionManager(){
    @Override protected Session retrieveSession(    SessionKey key) throws UnknownSessionException {
      throw new UnsupportedOperationException("Should not be called in this test.");
    }
    @Override protected Session doCreateSession(    SessionContext initData) throws AuthorizationException {
      throw new UnsupportedOperationException("Should not be called in this test.");
    }
    @Override protected Collection<Session> getActiveSessions(){
      Collection<Session> sessions=new ArrayList<Session>(2);
      sessions.add(validSession);
      sessions.add(invalidSession);
      return sessions;
    }
  }
;
  sessionManager.setSessionListeners(Arrays.asList(sessionListener));
  sessionManager.validateSessions();
  assertEquals(1,expirationCount.intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.DefaultSessionManagerTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionListenerStopNotificationWithReadAttribute(){
  final boolean[] stopped=new boolean[1];
  final String[] value=new String[1];
  SessionListener listener=new SessionListenerAdapter(){
    public void onStop(    Session session){
      stopped[0]=true;
      value[0]=(String)session.getAttribute("foo");
    }
  }
;
  sm.getSessionListeners().add(listener);
  Session session=sm.start(null);
  session.setAttribute("foo","bar");
  sm.stop(new DefaultSessionKey(session.getId()));
  assertTrue(stopped[0]);
  assertEquals("bar",value[0]);
}

</code></pre>

<br>
<pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalTimeout(){
  long timeout=1000;
  sm.setGlobalSessionTimeout(timeout);
  Session session=sm.start(null);
  assertNotNull(session);
  assertNotNull(session.getId());
  assertEquals(session.getTimeout(),timeout);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.DelegatingSessionTest </h4><pre class="type-8 type-2 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeout(){
  Serializable origId=session.getId();
  assertEquals(session.getTimeout(),AbstractSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT);
  session.touch();
  session.setTimeout(100);
  assertEquals(100,session.getTimeout());
  sleep(150);
  try {
    session.getTimeout();
    fail("Session should have expired.");
  }
 catch (  ExpiredSessionException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.SimpleSessionTest </h4><pre class="type-13 type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultSerialization() throws Exception {
  SimpleSession session=new SimpleSession();
  long timeout=session.getTimeout();
  Date start=session.getStartTimestamp();
  Date lastAccess=session.getLastAccessTime();
  SimpleSession deserialized=serializeAndDeserialize(session);
  assertEquals(timeout,deserialized.getTimeout());
  assertEquals(start,deserialized.getStartTimestamp());
  assertEquals(lastAccess,deserialized.getLastAccessTime());
}

</code></pre>

<br>
<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void serializeHost() throws IOException, ClassNotFoundException {
  SimpleSession session=new SimpleSession("localhost");
  assertEquals("localhost",serializeAndDeserialize(session).getHost());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.remoting.SecureRemoteInvocationFactoryTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSessionManagerProxyNonStartRemoteInvocation() throws Exception {
  SecureRemoteInvocationFactory factory=new SecureRemoteInvocationFactory();
  MethodInvocation mi=createMock(MethodInvocation.class);
  Method method=getMethod("getSession",SessionManager.class);
  expect(mi.getMethod()).andReturn(method).anyTimes();
  String dummySessionId=UUID.randomUUID().toString();
  SessionKey sessionKey=new DefaultSessionKey(dummySessionId);
  Object[] args={sessionKey};
  expect(mi.getArguments()).andReturn(args).anyTimes();
  replay(mi);
  RemoteInvocation ri=factory.createRemoteInvocation(mi);
  verify(mi);
  assertEquals(dummySessionId,ri.getAttribute(SecureRemoteInvocationFactory.SESSION_ID_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.web.ShiroFilterFactoryBeanTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDefinition(){
  ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("org/apache/shiro/spring/web/ShiroFilterFactoryBeanTest.xml");
  AbstractShiroFilter shiroFilter=(AbstractShiroFilter)context.getBean("shiroFilter");
  PathMatchingFilterChainResolver resolver=(PathMatchingFilterChainResolver)shiroFilter.getFilterChainResolver();
  DefaultFilterChainManager fcManager=(DefaultFilterChainManager)resolver.getFilterChainManager();
  NamedFilterList chain=fcManager.getChain("/test");
  assertNotNull(chain);
  assertEquals(chain.size(),2);
  Filter[] filters=new Filter[chain.size()];
  filters=chain.toArray(filters);
  assertTrue(filters[0] instanceof DummyFilter);
  assertTrue(filters[1] instanceof FormAuthenticationFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.subject.DelegatingSubjectTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRunAs(){
  Ini ini=new Ini();
  Ini.Section users=ini.addSection("users");
  users.put("user1","user1,role1");
  users.put("user2","user2,role2");
  users.put("user3","user3,role3");
  IniSecurityManagerFactory factory=new IniSecurityManagerFactory(ini);
  SecurityManager sm=factory.getInstance();
  Subject subject=new Subject.Builder(sm).buildSubject();
  subject.login(new UsernamePasswordToken("user1","user1"));
  assertFalse(subject.isRunAs());
  assertEquals("user1",subject.getPrincipal());
  assertTrue(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role3"));
  assertNull(subject.getPreviousPrincipals());
  subject.runAs(new SimplePrincipalCollection("user2",IniSecurityManagerFactory.INI_REALM_NAME));
  assertTrue(subject.isRunAs());
  assertEquals("user2",subject.getPrincipal());
  assertTrue(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role3"));
  PrincipalCollection previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user1"));
  subject.runAs(new SimplePrincipalCollection("user3",IniSecurityManagerFactory.INI_REALM_NAME));
  assertTrue(subject.isRunAs());
  assertEquals("user3",subject.getPrincipal());
  assertTrue(subject.hasRole("role3"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user2"));
  subject.releaseRunAs();
  assertTrue(subject.isRunAs());
  assertEquals("user2",subject.getPrincipal());
  assertTrue(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role3"));
  previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user1"));
  subject.releaseRunAs();
  assertFalse(subject.isRunAs());
  assertEquals("user1",subject.getPrincipal());
  assertTrue(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role3"));
  assertNull(subject.getPreviousPrincipals());
  subject.logout();
  LifecycleUtils.destroy(sm);
}

</code></pre>

<br>
<pre class="type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteRunnable(){
  String username="jsmith";
  SecurityManager securityManager=createNiceMock(SecurityManager.class);
  PrincipalCollection identity=new SimplePrincipalCollection(username,"testRealm");
  final Subject sourceSubject=new DelegatingSubject(identity,true,null,null,securityManager);
  assertNull(ThreadContext.getSubject());
  assertNull(ThreadContext.getSecurityManager());
  Runnable runnable=new Runnable(){
    public void run(){
      Subject callingSubject=SecurityUtils.getSubject();
      assertNotNull(callingSubject);
      assertNotNull(SecurityUtils.getSecurityManager());
      assertEquals(callingSubject,sourceSubject);
    }
  }
;
  sourceSubject.execute(runnable);
  assertNull(ThreadContext.getSubject());
  assertNull(ThreadContext.getSecurityManager());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteCallable(){
  String username="jsmith";
  SecurityManager securityManager=createNiceMock(SecurityManager.class);
  PrincipalCollection identity=new SimplePrincipalCollection(username,"testRealm");
  final Subject sourceSubject=new DelegatingSubject(identity,true,null,null,securityManager);
  assertNull(ThreadContext.getSubject());
  assertNull(ThreadContext.getSecurityManager());
  Callable<String> callable=new Callable<String>(){
    public String call() throws Exception {
      Subject callingSubject=SecurityUtils.getSubject();
      assertNotNull(callingSubject);
      assertNotNull(SecurityUtils.getSecurityManager());
      assertEquals(callingSubject,sourceSubject);
      return "Hello " + callingSubject.getPrincipal();
    }
  }
;
  String response=sourceSubject.execute(callable);
  assertNotNull(response);
  assertEquals("Hello " + username,response);
  assertNull(ThreadContext.getSubject());
  assertNull(ThreadContext.getSecurityManager());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.util.StringUtilsTest </h4><pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpacesAndEscapedQuotes(){
  String line="shall, \"\"\"we, play\", a, \"\"\"game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("shall",split[0]);
  assertEquals("\"we, play",split[1]);
  assertEquals("a",split[2]);
  assertEquals("\"game?",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithCommas(){
  String line="shall,we,play,a,game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 5);
  assertEquals("shall",split[0]);
  assertEquals("we",split[1]);
  assertEquals("play",split[2]);
  assertEquals("a",split[3]);
  assertEquals("game?",split[4]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitTestWithQuotedCommas(){
  String line="authc, test[blah], test[\"1,2,3\"], test[]";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("authc",split[0]);
  assertEquals("test[blah]",split[1]);
  assertEquals("test[1,2,3]",split[2]);
  assertEquals("test[]",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithCommasAndSpaces(){
  String line="shall,we ,    play, a,game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 5);
  assertEquals("shall",split[0]);
  assertEquals("we",split[1]);
  assertEquals("play",split[2]);
  assertEquals("a",split[3]);
  assertEquals("game?",split[4]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpaces(){
  String line="shall, \"we, play\", a, game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("shall",split[0]);
  assertEquals("we, play",split[1]);
  assertEquals("a",split[2]);
  assertEquals("game?",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpacesAndDifferentQuoteChars(){
  String line="authc, test[blah], test[1,2,3], test[]";
  String[] split=StringUtils.split(line,',','[',']',false,true);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("authc",split[0]);
  assertEquals("testblah",split[1]);
  assertEquals("test1,2,3",split[2]);
  assertEquals("test",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpacesAndDifferentQuoteCharsWhileRetainingQuotes(){
  String line="authc, test[blah], test[1,2,3], test[]";
  String[] split=StringUtils.split(line,',','[',']',true,true);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("authc",split[0]);
  assertEquals("test[blah]",split[1]);
  assertEquals("test[1,2,3]",split[2]);
  assertEquals("test[]",split[3]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authc.BasicHttpFilterAuthenticationTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoPassword() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro",""));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  UsernamePasswordToken upToken=(UsernamePasswordToken)token;
  assertEquals("pedro",upToken.getUsername());
  assertEquals("Password is not empty.",0,upToken.getPassword().length);
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenColonInPassword() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro","pass:word"));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  UsernamePasswordToken upToken=(UsernamePasswordToken)token;
  assertEquals("pedro",upToken.getUsername());
  assertEquals("pass:word",new String(upToken.getPassword()));
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoAuthorizationHeader() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(null);
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  assertEquals("",token.getPrincipal());
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoUsername() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("",""));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  assertEquals("",token.getPrincipal());
  verify(request);
  verify(response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authz.HttpMethodPermissionFilterTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPermisisonMapping(){
  HttpMethodPermissionFilter filter=new HttpMethodPermissionFilter();
  String[] permsBefore={"foo","bar"};
  String[] permsAfter=filter.buildPermissions(permsBefore,filter.getHttpMethodAction("get"));
  Assert.assertEquals(2,permsAfter.length);
  Assert.assertEquals("foo:read",permsAfter[0]);
  Assert.assertEquals("bar:read",permsAfter[1]);
  Assert.assertEquals("foo:read",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("head"))[0]);
  Assert.assertEquals("foo:update",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("put"))[0]);
  Assert.assertEquals("foo:create",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("post"))[0]);
  Assert.assertEquals("foo:create",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("mkcol"))[0]);
  Assert.assertEquals("foo:delete",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("delete"))[0]);
  Assert.assertEquals("foo:read",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("options"))[0]);
  Assert.assertEquals("foo:read",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("trace"))[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolverTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstanceWithFilterConfig(){
  FilterConfig mock=createNiceMockFilterConfig();
  replay(mock);
  resolver=new PathMatchingFilterChainResolver(mock);
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
  assertEquals(((DefaultFilterChainManager)resolver.getFilterChainManager()).getFilterConfig(),mock);
  verify(mock);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.mgt.SimpleNamedFilterListTest </h4><pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstance(){
  @SuppressWarnings({"MismatchedQueryAndUpdateOfCollection"}) SimpleNamedFilterList list=new SimpleNamedFilterList("test");
  assertNotNull(list.getName());
  assertEquals("test",list.getName());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-15 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Exists mainly to increase code coverage as the SimpleNamedFilterList
 * implementation is a direct pass through.
 */
@Test public void testListMethods(){
  FilterChain mock=createNiceMock(FilterChain.class);
  Filter filter=createNiceMock(Filter.class);
  NamedFilterList list=new SimpleNamedFilterList("test");
  list.add(filter);
  FilterChain chain=list.proxy(mock);
  assertNotNull(chain);
  assertNotSame(mock,chain);
  Filter singleFilter=new SslFilter();
  List<? extends Filter> multipleFilters=CollectionUtils.asList(new PortFilter(),new UserFilter());
  list.add(0,singleFilter);
  assertEquals(2,list.size());
  assertTrue(list.get(0) instanceof SslFilter);
  assertTrue(Arrays.equals(list.toArray(),new Object[]{singleFilter,filter}));
  list.addAll(multipleFilters);
  assertEquals(4,list.size());
  assertTrue(list.get(2) instanceof PortFilter);
  assertTrue(list.get(3) instanceof UserFilter);
  list.addAll(0,CollectionUtils.asList(new PermissionsAuthorizationFilter(),new RolesAuthorizationFilter()));
  assertEquals(6,list.size());
  assertTrue(list.get(0) instanceof PermissionsAuthorizationFilter);
  assertTrue(list.get(1) instanceof RolesAuthorizationFilter);
  assertEquals(2,list.indexOf(singleFilter));
  assertEquals(multipleFilters,list.subList(4,list.size()));
  assertTrue(list.contains(singleFilter));
  assertTrue(list.containsAll(multipleFilters));
  assertFalse(list.isEmpty());
  list.clear();
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  Iterator i=list.iterator();
  assertTrue(i.hasNext());
  assertEquals(i.next(),singleFilter);
  ListIterator li=list.listIterator();
  assertTrue(li.hasNext());
  assertEquals(li.next(),singleFilter);
  li=list.listIterator(0);
  assertTrue(li.hasNext());
  assertEquals(li.next(),singleFilter);
  list.set(0,singleFilter);
  assertEquals(list.get(0),singleFilter);
  Filter[] filters=new Filter[list.size()];
  filters=list.toArray(filters);
  assertEquals(1,filters.length);
  assertEquals(filters[0],singleFilter);
  assertEquals(0,list.lastIndexOf(singleFilter));
  list.remove(singleFilter);
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  list.remove(0);
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  list.addAll(multipleFilters);
  assertEquals(3,list.size());
  list.removeAll(multipleFilters);
  assertEquals(1,list.size());
  assertEquals(list.get(0),singleFilter);
  list.addAll(multipleFilters);
  assertEquals(3,list.size());
  list.retainAll(multipleFilters);
  assertEquals(2,list.size());
  assertEquals(new ArrayList(list),multipleFilters);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.DefaultWebSecurityManagerTest </h4><pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubjectByRequestSessionId(){
  shiroSessionModeInit();
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  replay(mockRequest);
  replay(mockResponse);
  Subject subject=newSubject(mockRequest,mockResponse);
  Session session=subject.getSession();
  Serializable sessionId=session.getId();
  assertNotNull(sessionId);
  verify(mockRequest);
  verify(mockResponse);
  mockRequest=createNiceMock(HttpServletRequest.class);
  mockResponse=createNiceMock(HttpServletResponse.class);
  Cookie[] cookies=new Cookie[]{new Cookie(ShiroHttpSession.DEFAULT_SESSION_ID_NAME,sessionId.toString())};
  expect(mockRequest.getCookies()).andReturn(cookies).anyTimes();
  expect(mockRequest.getParameter(isA(String.class))).andReturn(null).anyTimes();
  replay(mockRequest);
  replay(mockResponse);
  subject=newSubject(mockRequest,mockResponse);
  session=subject.getSession(false);
  assertNotNull(session);
  assertEquals(sessionId,session.getId());
  verify(mockRequest);
  verify(mockResponse);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-2 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionTimeout(){
  shiroSessionModeInit();
  long globalTimeout=100;
  ((AbstractSessionManager)sm.getSessionManager()).setGlobalSessionTimeout(globalTimeout);
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  expect(mockRequest.getCookies()).andReturn(null);
  expect(mockRequest.getContextPath()).andReturn("/");
  replay(mockRequest);
  Subject subject=newSubject(mockRequest,mockResponse);
  Session session=subject.getSession();
  assertEquals(session.getTimeout(),globalTimeout);
  session.setTimeout(125);
  assertEquals(session.getTimeout(),125);
  sleep(200);
  try {
    session.getTimeout();
    fail("Session should have expired.");
  }
 catch (  ExpiredSessionException expected) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Asserts fix for <a href="https://issues.apache.org/jira/browse/SHIRO-350">SHIRO-350</a>.
 */
@Test public void testBuildNonWebSubjectWithDefaultServletContainerSessionManager(){
  Ini ini=new Ini();
  Ini.Section section=ini.addSection(IniRealm.USERS_SECTION_NAME);
  section.put("user1","user1");
  WebIniSecurityManagerFactory factory=new WebIniSecurityManagerFactory(ini);
  WebSecurityManager securityManager=(WebSecurityManager)factory.getInstance();
  PrincipalCollection principals=new SimplePrincipalCollection("user1","iniRealm");
  Subject subject=new Subject.Builder(securityManager).principals(principals).buildSubject();
  assertNotNull(subject);
  assertEquals("user1",subject.getPrincipal());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
