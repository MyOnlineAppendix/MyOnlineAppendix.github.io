<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.shiro.authc.credential.AbstractHashedCredentialsMatcherTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBasic(){
  CredentialsMatcher matcher=(CredentialsMatcher)ClassUtils.newInstance(getMatcherClass());
  byte[] hashed=hash("password").getBytes();
  AuthenticationInfo account=new SimpleAuthenticationInfo("username",hashed,"realmName");
  AuthenticationToken token=new UsernamePasswordToken("username","password");
  assertTrue(matcher.doCredentialsMatch(token,account));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.credential.AllowAllCredentialsMatcherTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testBasic(){
  assertTrue(new AllowAllCredentialsMatcher().doCredentialsMatch(null,null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.credential.HashedCredentialsMatcherTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test new Shiro 1.1 functionality, where the salt is obtained from the stored account information, as it
 * should be.  See <a href="https://issues.apache.org/jira/browse/SHIRO-186">SHIRO-186</a>
 */
@Test public void testSaltedAuthenticationInfo(){
  HashedCredentialsMatcher matcher=new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);
  ByteSource salt=new SecureRandomNumberGenerator().nextBytes();
  Object hashedPassword=new Sha1Hash("password",salt);
  SimpleAuthenticationInfo account=new SimpleAuthenticationInfo("username",hashedPassword,salt,"realmName");
  AuthenticationToken token=new UsernamePasswordToken("username","password");
  assertTrue(matcher.doCredentialsMatch(token,account));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test backwards compatibility of salted credentials before
 * <a href="https://issues.apache.org/jira/browse/SHIRO-186">SHIRO-186</a> edits.
 */
@Test public void testBackwardsCompatibleSaltedAuthenticationInfo(){
  HashedCredentialsMatcher matcher=new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);
  matcher.setHashSalted(true);
  final String username="username";
  final String password="password";
  final Object hashedPassword=new Sha1Hash(password,username).getBytes();
  AuthenticationInfo account=new AuthenticationInfo(){
    public PrincipalCollection getPrincipals(){
      return new SimplePrincipalCollection(username,"realmName");
    }
    public Object getCredentials(){
      return hashedPassword;
    }
  }
;
  AuthenticationToken token=new UsernamePasswordToken("username","password");
  assertTrue(matcher.doCredentialsMatch(token,account));
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test backwards compatibility of unsalted credentials before
 * <a href="https://issues.apache.org/jira/browse/SHIRO-186">SHIRO-186</a> edits.
 */
@Test public void testBackwardsCompatibleUnsaltedAuthenticationInfo(){
  HashedCredentialsMatcher matcher=new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);
  final String username="username";
  final String password="password";
  final Object hashedPassword=new Sha1Hash(password).getBytes();
  AuthenticationInfo account=new AuthenticationInfo(){
    public PrincipalCollection getPrincipals(){
      return new SimplePrincipalCollection(username,"realmName");
    }
    public Object getCredentials(){
      return hashedPassword;
    }
  }
;
  AuthenticationToken token=new UsernamePasswordToken("username","password");
  assertTrue(matcher.doCredentialsMatch(token,account));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.ModularRealmAuthorizerTest </h4><pre class="type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSettingOfRolePermissionResolver(){
  Collection<Realm> realms=new ArrayList<Realm>();
  realms.add(new MockAuthorizingRealm());
  realms.add(new MockAuthorizingRealm());
  for (  Realm realm : realms) {
    Assert.assertNull(((AuthorizingRealm)realm).getRolePermissionResolver());
  }
  ModularRealmAuthorizer modRealmAuthz=new ModularRealmAuthorizer();
  modRealmAuthz.setRealms(realms);
  for (  Realm realm : realms) {
    Assert.assertNull(((AuthorizingRealm)realm).getRolePermissionResolver());
  }
  RolePermissionResolver rolePermissionResolver=new RolePermissionResolver(){
    public Collection<Permission> resolvePermissionsInRole(    String roleString){
      return null;
    }
  }
;
  modRealmAuthz.setRolePermissionResolver(rolePermissionResolver);
  for (  Realm realm : realms) {
    Assert.assertTrue(((AuthorizingRealm)realm).getRolePermissionResolver() == rolePermissionResolver);
  }
  MockAuthorizingRealm mockRealm=new MockAuthorizingRealm();
  realms.add(mockRealm);
  modRealmAuthz.setRealms(realms);
  assertTrue(((AuthorizingRealm)mockRealm).getRolePermissionResolver() == rolePermissionResolver);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.permission.AllPermissionTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testNullArgument(){
  assertTrue(new AllPermission().implies(null));
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testNonNullArgument(){
  assertTrue(new AllPermission().implies(new AllPermission()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.permission.DomainPermissionTest </h4><pre class="type-13 type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConstructor(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  String entry;
  p=new DomainPermission();
  assertTrue("domain".equals(p.getDomain()));
  set=p.getActions();
  assertNull(set);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals("Number of parts",1,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  entry=set.iterator().next();
  assertEquals("domain",entry);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.permission.WildcardPermissionTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLists(){
  WildcardPermission p1, p2, p3;
  p1=new WildcardPermission("one,two");
  p2=new WildcardPermission("one");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("one,two,three");
  p2=new WildcardPermission("one,three");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("one,two:one,two,three");
  p2=new WildcardPermission("one:three");
  p3=new WildcardPermission("one:two,three");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  assertTrue(p1.implies(p3));
  assertFalse(p2.implies(p3));
  assertTrue(p3.implies(p2));
  p1=new WildcardPermission("one,two,three:one,two,three:one,two");
  p2=new WildcardPermission("one:three:two");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("one");
  p2=new WildcardPermission("one:two,three,four");
  p3=new WildcardPermission("one:two,three,four:five:six:seven");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertFalse(p2.implies(p1));
  assertFalse(p3.implies(p1));
  assertTrue(p2.implies(p3));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWildcards(){
  WildcardPermission p1, p2, p3, p4, p5, p6, p7, p8;
  p1=new WildcardPermission("*");
  p2=new WildcardPermission("one");
  p3=new WildcardPermission("one:two");
  p4=new WildcardPermission("one,two:three,four");
  p5=new WildcardPermission("one,two:three,four,five:six:seven,eight");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  p1=new WildcardPermission("newsletter:*");
  p2=new WildcardPermission("newsletter:read");
  p3=new WildcardPermission("newsletter:read,write");
  p4=new WildcardPermission("newsletter:*");
  p5=new WildcardPermission("newsletter:*:*");
  p6=new WildcardPermission("newsletter:*:read");
  p7=new WildcardPermission("newsletter:write:*");
  p8=new WildcardPermission("newsletter:read,write:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  assertTrue(p1.implies(p6));
  assertTrue(p1.implies(p7));
  assertTrue(p1.implies(p8));
  p1=new WildcardPermission("newsletter:*:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  assertTrue(p1.implies(p6));
  assertTrue(p1.implies(p7));
  assertTrue(p1.implies(p8));
  p1=new WildcardPermission("newsletter:*:*:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  assertTrue(p1.implies(p6));
  assertTrue(p1.implies(p7));
  assertTrue(p1.implies(p8));
  p1=new WildcardPermission("newsletter:*:read");
  p2=new WildcardPermission("newsletter:123:read");
  p3=new WildcardPermission("newsletter:123,456:read,write");
  p4=new WildcardPermission("newsletter:read");
  p5=new WildcardPermission("newsletter:read,write");
  p6=new WildcardPermission("newsletter:123:read:write");
  assertTrue(p1.implies(p2));
  assertFalse(p1.implies(p3));
  assertFalse(p1.implies(p4));
  assertFalse(p1.implies(p5));
  assertTrue(p1.implies(p6));
  p1=new WildcardPermission("newsletter:*:read:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p6));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNamed(){
  WildcardPermission p1, p2;
  p1=new WildcardPermission("something");
  p2=new WildcardPermission("something");
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("something");
  p2=new WildcardPermission("SOMETHING");
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("something");
  p2=new WildcardPermission("else");
  assertFalse(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("BLAHBLAH",false);
  p2=new WildcardPermission("BLAHBLAH",false);
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("BLAHBLAH",false);
  p2=new WildcardPermission("bLAHBLAH",false);
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("BLAHBLAH",false);
  p2=new WildcardPermission("whatwhat",false);
  assertFalse(p1.implies(p2));
  assertFalse(p2.implies(p1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.BeanTypeListenerTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testMatchedPackage() throws Exception {
  assertTrue(BeanTypeListener.MATCHER.matches(TypeLiteral.get(SecurityUtils.class)));
  assertTrue(BeanTypeListener.MATCHER.matches(TypeLiteral.get(DefaultAnnotationResolver.class)));
  assertTrue(BeanTypeListener.MATCHER.matches(TypeLiteral.get(BlowfishCipherService.class)));
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testUnmatchedPackage() throws Exception {
  assertFalse(BeanTypeListener.MATCHER.matches(TypeLiteral.get(GuiceEnvironment.class)));
  assertFalse(BeanTypeListener.MATCHER.matches(TypeLiteral.get(ShiroWebModule.class)));
  assertFalse(BeanTypeListener.MATCHER.matches(TypeLiteral.get(ShiroAopModule.class)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroMatchersTest </h4><pre class="type-13 type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTypeLiteral() throws Exception {
  Matcher<Class> classMatcher=createMock(Matcher.class);
  expect(classMatcher.matches(MatchingClass.class)).andReturn(true);
  expect(classMatcher.matches(NotMatchingClass.class)).andReturn(false);
  replay(classMatcher);
  Matcher<TypeLiteral> underTest=ShiroMatchers.typeLiteral(classMatcher);
  assertTrue(underTest.matches(TypeLiteral.get(MatchingClass.class)));
  assertFalse(underTest.matches(TypeLiteral.get(NotMatchingClass.class)));
  verify(classMatcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroModuleTest </h4><pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindSecurityManager(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindSecurityManager(    AnnotatedBindingBuilder<? super SecurityManager> bind){
      bind.to(MyDefaultSecurityManager.class);
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertTrue(securityManager instanceof MyDefaultSecurityManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindEnvironment(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
      expose(Environment.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindEnvironment(    AnnotatedBindingBuilder<Environment> bind){
      bind.to(MyEnvironment.class);
    }
  }
);
  Environment environment=injector.getInstance(Environment.class);
  assertNotNull(environment);
  assertTrue(environment instanceof MyEnvironment);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindSessionManager(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindSessionManager(    AnnotatedBindingBuilder<SessionManager> bind){
      bind.to(MyDefaultSessionManager.class);
    }
  }
);
  DefaultSecurityManager securityManager=(DefaultSecurityManager)injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertNotNull(securityManager.getSessionManager());
  assertTrue(securityManager.getSessionManager() instanceof MyDefaultSessionManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.aop.ShiroAopModuleTest </h4><pre class="type-11 type-8 type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindShiroInterceptor(){
  ShiroAopModule underTest=new ShiroAopModule(){
    @Override protected void configureInterceptors(    AnnotationResolver resolver){
      bindShiroInterceptor(new MyAnnotationMethodInterceptor());
    }
  }
;
  List<Element> elements=Elements.getElements(underTest);
  for (  Element element : elements) {
    if (element instanceof InterceptorBinding) {
      InterceptorBinding binding=(InterceptorBinding)element;
      assertTrue(binding.getClassMatcher().matches(getClass()));
      Method method=null;
      Class<? extends Annotation> theAnnotation=null;
      for (      Class<? extends Annotation> annotation : protectedMethods.keySet()) {
        if (binding.getMethodMatcher().matches(protectedMethods.get(annotation))) {
          method=protectedMethods.get(annotation);
          theAnnotation=annotation;
          protectedMethods.remove(annotation);
          break;
        }
      }
      if (method == null) {
        fail("Did not expect interceptor binding " + binding.getInterceptors());
      }
      List<MethodInterceptor> interceptors=binding.getInterceptors();
      assertEquals(1,interceptors.size());
      assertTrue(interceptors.get(0) instanceof AopAllianceMethodInterceptorAdapter);
      assertTrue(interceptorTypes.get(theAnnotation).isInstance(((AopAllianceMethodInterceptorAdapter)interceptors.get(0)).shiroInterceptor));
    }
  }
  assertTrue("Not all interceptors were bound.",protectedMethods.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.AbstractInjectionProviderTest </h4><pre class="type-11 type-8 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDependencies() throws Exception {
  AbstractInjectionProvider<SomeInjectedClass> underTest=new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class));
  boolean foundC1=false;
  boolean foundC2=false;
  boolean foundV1=false;
  boolean foundV2=false;
  boolean foundF1=false;
  for (  Dependency<?> dependency : underTest.getDependencies()) {
    if (dependency.getInjectionPoint().getMember() instanceof Constructor) {
      if (dependency.getParameterIndex() == 0 && dependency.getKey().equals(keyC1)) {
        foundC1=true;
      }
 else       if (dependency.getParameterIndex() == 1 && dependency.getKey().equals(keyC2)) {
        foundC2=true;
      }
 else {
        fail("Did not expect constructor dependency with key " + dependency.getKey() + " at parameter index "+ dependency.getParameterIndex());
      }
    }
 else     if (dependency.getInjectionPoint().getMember() instanceof Method) {
      if (dependency.getKey().equals(keyV1)) {
        foundV1=true;
      }
 else       if (dependency.getKey().equals(keyV2)) {
        foundV2=true;
      }
 else {
        fail("Did not expect method dependency with key " + dependency.getKey());
      }
    }
 else     if (dependency.getInjectionPoint().getMember() instanceof Field) {
      if (dependency.getKey().equals(keyF1)) {
        foundF1=true;
      }
 else {
        fail("Did not expect field dependency with key " + dependency.getKey());
      }
    }
 else {
      fail("Did not expect dependency with key " + dependency.getKey());
    }
  }
  assertTrue("Did not find dependency C1",foundC1);
  assertTrue("Did not find dependency C2",foundC2);
  assertTrue("Did not find dependency V1",foundV1);
  assertTrue("Did not find dependency V2",foundV2);
  assertTrue("Did not find dependency F1",foundF1);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet() throws Exception {
  Injector mockInjector=createMock(Injector.class);
  Object c1=new Object();
  Object c2=new Object();
  final AtomicBoolean postProcessCalled=new AtomicBoolean(false);
  expect(mockInjector.getInstance(keyC1)).andReturn(c1);
  expect(mockInjector.getInstance(keyC2)).andReturn(c2);
  mockInjector.injectMembers(anyObject(SomeInjectedClass.class));
  replay(mockInjector);
  AbstractInjectionProvider<SomeInjectedClass> underTest=new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class)){
    @Override protected SomeInjectedClass postProcess(    SomeInjectedClass someInjectedClass){
      postProcessCalled.set(true);
      return super.postProcess(someInjectedClass);
    }
  }
;
  underTest.injector=mockInjector;
  SomeInjectedClass got=underTest.get();
  assertEquals("Wrong parameter passed to constructor (index 0).",c1,got.c1);
  assertEquals("Wrong parameter passed to constructor (index 1).",c2,got.c2);
  assertTrue("postProcess method was not called.",postProcessCalled.get());
  verify(mockInjector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.FilterChainResolverProviderTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDependencies() throws Exception {
  Set<Dependency<?>> dependencySet=underTest.getDependencies();
  assertEquals(4,dependencySet.size());
  assertTrue("Dependency set doesn't contain key1a.",dependencySet.contains(Dependency.get(key1a)));
  assertTrue("Dependency set doesn't contain key1b.",dependencySet.contains(Dependency.get(key1b)));
  assertTrue("Dependency set doesn't contain key1c.",dependencySet.contains(Dependency.get(key1c)));
  assertTrue("Dependency set doesn't contain key2a.",dependencySet.contains(Dependency.get(key2a)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.ShiroWebModuleTest </h4><pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void basicInstantiation(){
  final ShiroModuleTest.MockRealm mockRealm=createMock(ShiroModuleTest.MockRealm.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Injector injector=Guice.createInjector(new ShiroWebModule(servletContext){
    @Override protected void configureShiroWeb(){
      bindRealm().to(ShiroModuleTest.MockRealm.class);
      expose(SessionManager.class);
    }
    @Provides public ShiroModuleTest.MockRealm createRealm(){
      return mockRealm;
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertTrue(securityManager instanceof WebSecurityManager);
  SessionManager sessionManager=injector.getInstance(SessionManager.class);
  assertNotNull(sessionManager);
  assertTrue(sessionManager instanceof ServletContainerSessionManager);
  assertTrue(((DefaultWebSecurityManager)securityManager).getSessionManager() instanceof ServletContainerSessionManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindWebSecurityManager() throws Exception {
  final ShiroModuleTest.MockRealm mockRealm=createMock(ShiroModuleTest.MockRealm.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Injector injector=Guice.createInjector(new ShiroWebModule(servletContext){
    @Override protected void configureShiroWeb(){
      bindRealm().to(ShiroModuleTest.MockRealm.class);
      expose(WebSecurityManager.class);
    }
    @Provides public ShiroModuleTest.MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindWebSecurityManager(    AnnotatedBindingBuilder<? super WebSecurityManager> bind){
      bind.to(MyDefaultWebSecurityManager.class);
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertTrue(securityManager instanceof MyDefaultWebSecurityManager);
  WebSecurityManager webSecurityManager=injector.getInstance(WebSecurityManager.class);
  assertNotNull(webSecurityManager);
  assertTrue(webSecurityManager instanceof MyDefaultWebSecurityManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindWebEnvironment() throws Exception {
  final ShiroModuleTest.MockRealm mockRealm=createMock(ShiroModuleTest.MockRealm.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Injector injector=Guice.createInjector(new ShiroWebModule(servletContext){
    @Override protected void configureShiroWeb(){
      bindRealm().to(ShiroModuleTest.MockRealm.class);
      expose(WebEnvironment.class);
      expose(Environment.class);
    }
    @Provides public ShiroModuleTest.MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindWebEnvironment(    AnnotatedBindingBuilder<? super WebEnvironment> bind){
      bind.to(MyWebEnvironment.class);
    }
  }
);
  Environment environment=injector.getInstance(Environment.class);
  assertNotNull(environment);
  assertTrue(environment instanceof MyWebEnvironment);
  WebEnvironment webEnvironment=injector.getInstance(WebEnvironment.class);
  assertNotNull(webEnvironment);
  assertTrue(webEnvironment instanceof MyWebEnvironment);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.mgt.DefaultSecurityManagerTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that validates functionality for issue
 * <a href="https://issues.apache.org/jira/browse/JSEC-22">JSEC-22</a>
 */
@Test public void testSubjectReuseAfterLogout(){
  Subject subject=SecurityUtils.getSubject();
  AuthenticationToken token=new UsernamePasswordToken("guest","guest");
  subject.login(token);
  assertTrue(subject.isAuthenticated());
  assertTrue("guest".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("guest"));
  Session session=subject.getSession();
  Serializable firstSessionId=session.getId();
  session.setAttribute("key","value");
  assertEquals(session.getAttribute("key"),"value");
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
  subject.login(new UsernamePasswordToken("lonestarr","vespa"));
  assertTrue(subject.isAuthenticated());
  assertTrue("lonestarr".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("goodguy"));
  assertNotNull(subject.getSession());
  assertFalse(firstSessionId.equals(subject.getSession().getId()));
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConfig(){
  Subject subject=SecurityUtils.getSubject();
  AuthenticationToken token=new UsernamePasswordToken("guest","guest");
  subject.login(token);
  assertTrue(subject.isAuthenticated());
  assertTrue("guest".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("guest"));
  Session session=subject.getSession();
  session.setAttribute("key","value");
  assertEquals(session.getAttribute("key"),"value");
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.mgt.VMSingletonDefaultSecurityManagerTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testVMSingleton(){
  DefaultSecurityManager sm=new DefaultSecurityManager();
  Ini ini=new Ini();
  Ini.Section section=ini.addSection(IniRealm.USERS_SECTION_NAME);
  section.put("guest","guest");
  sm.setRealm(new IniRealm(ini));
  SecurityUtils.setSecurityManager(sm);
  try {
    Subject subject=SecurityUtils.getSubject();
    AuthenticationToken token=new UsernamePasswordToken("guest","guest");
    subject.login(token);
    subject.getSession().setAttribute("key","value");
    assertTrue(subject.getSession().getAttribute("key").equals("value"));
    subject=SecurityUtils.getSubject();
    assertTrue(subject.isAuthenticated());
    assertTrue(subject.getSession().getAttribute("key").equals("value"));
  }
  finally {
    sm.destroy();
    SecurityUtils.setSecurityManager(null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.AuthorizingRealmTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullAuthzInfo(){
  AuthorizingRealm realm=new AuthorizingRealm(){
    protected AuthorizationInfo doGetAuthorizationInfo(    PrincipalCollection principals){
      return null;
    }
    protected AuthenticationInfo doGetAuthenticationInfo(    AuthenticationToken token) throws AuthenticationException {
      return null;
    }
  }
;
  Principal principal=new UsernamePrincipal("blah");
  PrincipalCollection pCollection=new SimplePrincipalCollection(principal,"nullAuthzRealm");
  List<Permission> permList=new ArrayList<Permission>();
  permList.add(new WildcardPermission("stringPerm1"));
  permList.add(new WildcardPermission("stringPerm2"));
  List<String> roleList=new ArrayList<String>();
  roleList.add("role1");
  roleList.add("role2");
  boolean thrown=false;
  try {
    realm.checkPermission(pCollection,"stringPermission");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermission(pCollection,new WildcardPermission("stringPermission"));
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermissions(pCollection,"stringPerm1","stringPerm2");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermissions(pCollection,permList);
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkRole(pCollection,"role1");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkRoles(pCollection,roleList);
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  assertFalse(realm.hasAllRoles(pCollection,roleList));
  assertFalse(realm.hasRole(pCollection,"role1"));
  assertArrayEquals(new boolean[]{false,false},realm.hasRoles(pCollection,roleList));
  assertFalse(realm.isPermitted(pCollection,"perm1"));
  assertFalse(realm.isPermitted(pCollection,new WildcardPermission("perm1")));
  assertArrayEquals(new boolean[]{false,false},realm.isPermitted(pCollection,"perm1","perm2"));
  assertArrayEquals(new boolean[]{false,false},realm.isPermitted(pCollection,permList));
  assertFalse(realm.isPermittedAll(pCollection,"perm1","perm2"));
  assertFalse(realm.isPermittedAll(pCollection,permList));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRealmWithRolePermissionResolver(){
  Principal principal=new UsernamePrincipal("rolePermResolver");
  PrincipalCollection pCollection=new SimplePrincipalCollection(principal,"testRealmWithRolePermissionResolver");
  AuthorizingRealm realm=new AllowAllRealm();
  realm.setRolePermissionResolver(new RolePermissionResolver(){
    public Collection<Permission> resolvePermissionsInRole(    String roleString){
      Collection<Permission> permissions=new HashSet<Permission>();
      if (roleString.equals(ROLE)) {
        permissions.add(new WildcardPermission(ROLE + ":perm1"));
        permissions.add(new WildcardPermission(ROLE + ":perm2"));
        permissions.add(new WildcardPermission("other:*:foo"));
      }
      return permissions;
    }
  }
);
  assertTrue(realm.hasRole(pCollection,ROLE));
  assertTrue(realm.isPermitted(pCollection,ROLE + ":perm1"));
  assertTrue(realm.isPermitted(pCollection,ROLE + ":perm2"));
  assertFalse(realm.isPermitted(pCollection,ROLE + ":perm3"));
  assertTrue(realm.isPermitted(pCollection,"other:bar:foo"));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateAccountOverride(){
  AuthorizingRealm realm=new AllowAllRealm(){
    @Override protected AuthenticationInfo buildAuthenticationInfo(    Object principal,    Object credentials){
      String username=(String)principal;
      UsernamePrincipal customPrincipal=new UsernamePrincipal(username);
      return new SimpleAccount(customPrincipal,credentials,getName());
    }
  }
;
  AuthenticationInfo info=realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),ROLE));
  Object principal=info.getPrincipals().getPrimaryPrincipal();
  assertTrue(principal instanceof UsernamePrincipal);
  assertEquals(USERNAME,((UsernamePrincipal)principal).getUsername());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConfig(){
  AuthenticationInfo info=realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),ROLE));
  Object principal=info.getPrincipals().getPrimaryPrincipal();
  assertTrue(principal instanceof UserIdPrincipal);
  UsernamePrincipal usernamePrincipal=info.getPrincipals().oneByType(UsernamePrincipal.class);
  assertTrue(usernamePrincipal.getUsername().equals(USERNAME));
  UserIdPrincipal userIdPrincipal=info.getPrincipals().oneByType(UserIdPrincipal.class);
  assertTrue(userIdPrincipal.getUserId() == USER_ID);
  String stringPrincipal=info.getPrincipals().oneByType(String.class);
  assertTrue(stringPrincipal.equals(USER_ID + USERNAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.activedirectory.ActiveDirectoryRealmTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultConfig(){
  String localhost="localhost";
  Subject subject=SecurityUtils.getSubject();
  subject.login(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertTrue(subject.isAuthenticated());
  assertTrue(subject.hasRole(ROLE));
  UsernamePrincipal usernamePrincipal=subject.getPrincipals().oneByType(UsernamePrincipal.class);
  assertTrue(usernamePrincipal.getUsername().equals(USERNAME));
  UserIdPrincipal userIdPrincipal=subject.getPrincipals().oneByType(UserIdPrincipal.class);
  assertTrue(userIdPrincipal.getUserId() == USER_ID);
  assertTrue(realm.hasRole(subject.getPrincipals(),ROLE));
  subject.logout();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.jdbc.JDBCRealmTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPermissionPresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  realm.setPermissionsLookupEnabled(true);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertTrue(currentUser.isPermitted(testPermissionString));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRolePresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertTrue(currentUser.hasRole(testRole));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleNotPresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertFalse(currentUser.hasRole("Game Overall Director"));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPermissionNotPresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  realm.setPermissionsLookupEnabled(true);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertFalse(currentUser.isPermitted("testDomain:testTarget:specialAction"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapRealmTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInstance(){
  assertTrue(realm.getCredentialsMatcher() instanceof AllowAllCredentialsMatcher);
  assertEquals(AuthenticationToken.class,realm.getAuthenticationTokenClass());
  assertTrue(realm.getContextFactory() instanceof JndiLdapContextFactory);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.text.IniRealmTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIniFileWithoutUsers(){
  IniRealm realm=new IniRealm();
  realm.setResourcePath("classpath:org/apache/shiro/realm/text/IniRealmTest.noUsers.ini");
  realm.init();
  assertTrue(realm.roleExists("admin"));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIniFile(){
  IniRealm realm=new IniRealm();
  realm.setResourcePath("classpath:org/apache/shiro/realm/text/IniRealmTest.simple.ini");
  realm.init();
  assertTrue(realm.roleExists("admin"));
  UsernamePasswordToken token=new UsernamePasswordToken("user1","user1");
  AuthenticationInfo info=realm.getAuthenticationInfo(token);
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),"admin"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.text.TextConfigurationRealmTest </h4><pre class="type-13 type-8 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessRoleDefinitions() throws InterruptedException {
  realm=new TestRealm(){
    public void test(    Thread runnable) throws InterruptedException {
      ROLES_LOCK.writeLock().lock();
      try {
        runnable.start();
        Thread.sleep(500);
        assertFalse("role exists when it shouldn't",realm.roleExists("role1"));
      }
  finally {
        ROLES_LOCK.writeLock().unlock();
      }
    }
  }
;
  TestThread testThread=new TestThread(new Runnable(){
    public void run(){
      try {
        realm.processRoleDefinitions();
      }
 catch (      ParseException e) {
        fail("Unable to parse role definitions");
      }
    }
  }
);
  setRoles();
  Thread testTask=new Thread(testThread);
  realm.test(testTask);
  testTask.join(500);
  assertTrue("role doesn't exist when it should",realm.roleExists("role1"));
  testThread.test();
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsPermitted() throws InterruptedException {
  setUpForReadConfigurationTest();
  executeTest(new Runnable(){
    public void run(){
      PrincipalCollection principalCollection=new SimplePrincipalCollection("user1","realm1");
      assertTrue("permission not permitted when it should be",realm.isPermitted(principalCollection,"role1_permission1"));
      assertTrue("permission not permitted when it should be",realm.isPermittedAll(principalCollection,new String[]{"role1_permission1","role2_permission2"}));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleAndUserAccount() throws InterruptedException {
  setUpForReadConfigurationTest();
  executeTest(new Runnable(){
    public void run(){
      assertTrue("role not found when it was expected",realm.roleExists("role1"));
      assertTrue("user not found when it was expected",realm.accountExists("user1"));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testHasRole() throws InterruptedException {
  setUpForReadConfigurationTest();
  executeTest(new Runnable(){
    public void run(){
      PrincipalCollection principalCollection=new SimplePrincipalCollection("user1","realm1");
      assertTrue("principal doesn't have role when it should",realm.hasRole(principalCollection,"role2"));
      assertTrue("principal doesn't have all roles when it should",realm.hasAllRoles(principalCollection,Arrays.asList(new String[]{"role1","role2"})));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessUserDefinitions() throws InterruptedException {
  realm=new TestRealm(){
    public void test(    Thread runnable) throws InterruptedException {
      USERS_LOCK.writeLock().lock();
      try {
        runnable.start();
        Thread.sleep(500);
        assertFalse("account exists when it shouldn't",realm.accountExists("user1"));
      }
  finally {
        USERS_LOCK.writeLock().unlock();
      }
    }
  }
;
  TestThread testThread=new TestThread(new Runnable(){
    public void run(){
      try {
        realm.processUserDefinitions();
      }
 catch (      ParseException e) {
        fail("Unable to parse user definitions");
      }
    }
  }
);
  setUsers();
  Thread testTask=new Thread(testThread);
  realm.test(testTask);
  testTask.join(500);
  assertTrue("account doesn't exist when it should",realm.accountExists("user1"));
  testThread.test();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.DefaultSessionManagerTest </h4><pre class="type-8 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionListenerExpiredNotification(){
  final boolean[] expired=new boolean[1];
  SessionListener listener=new SessionListenerAdapter(){
    public void onExpiration(    Session session){
      expired[0]=true;
    }
  }
;
  sm.getSessionListeners().add(listener);
  sm.setGlobalSessionTimeout(100);
  Session session=sm.start(null);
  sleep(150);
  try {
    sm.checkValid(new DefaultSessionKey(session.getId()));
    fail("check should have thrown an exception.");
  }
 catch (  InvalidSessionException expected) {
  }
  assertTrue(expired[0]);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionListenerStopNotificationWithReadAttribute(){
  final boolean[] stopped=new boolean[1];
  final String[] value=new String[1];
  SessionListener listener=new SessionListenerAdapter(){
    public void onStop(    Session session){
      stopped[0]=true;
      value[0]=(String)session.getAttribute("foo");
    }
  }
;
  sm.getSessionListeners().add(listener);
  Session session=sm.start(null);
  session.setAttribute("foo","bar");
  sm.stop(new DefaultSessionKey(session.getId()));
  assertTrue(stopped[0]);
  assertEquals("bar",value[0]);
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSessionListenerStartNotification(){
  final boolean[] started=new boolean[1];
  SessionListener listener=new SessionListenerAdapter(){
    public void onStart(    Session session){
      started[0]=true;
    }
  }
;
  sm.getSessionListeners().add(listener);
  sm.start(null);
  assertTrue(started[0]);
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSessionListenerStopNotification(){
  final boolean[] stopped=new boolean[1];
  SessionListener listener=new SessionListenerAdapter(){
    public void onStop(    Session session){
      stopped[0]=true;
    }
  }
;
  sm.getSessionListeners().add(listener);
  Session session=sm.start(null);
  sm.stop(new DefaultSessionKey(session.getId()));
  assertTrue(stopped[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.SimpleSessionTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void serializeExpired() throws IOException, ClassNotFoundException {
  SimpleSession session=new SimpleSession();
  session.setExpired(true);
  assertTrue(serializeAndDeserialize(session).isExpired());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.web.ShiroFilterFactoryBeanTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDefinition(){
  ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("org/apache/shiro/spring/web/ShiroFilterFactoryBeanTest.xml");
  AbstractShiroFilter shiroFilter=(AbstractShiroFilter)context.getBean("shiroFilter");
  PathMatchingFilterChainResolver resolver=(PathMatchingFilterChainResolver)shiroFilter.getFilterChainResolver();
  DefaultFilterChainManager fcManager=(DefaultFilterChainManager)resolver.getFilterChainManager();
  NamedFilterList chain=fcManager.getChain("/test");
  assertNotNull(chain);
  assertEquals(chain.size(),2);
  Filter[] filters=new Filter[chain.size()];
  filters=chain.toArray(filters);
  assertTrue(filters[0] instanceof DummyFilter);
  assertTrue(filters[1] instanceof FormAuthenticationFilter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.subject.DelegatingSubjectTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRunAs(){
  Ini ini=new Ini();
  Ini.Section users=ini.addSection("users");
  users.put("user1","user1,role1");
  users.put("user2","user2,role2");
  users.put("user3","user3,role3");
  IniSecurityManagerFactory factory=new IniSecurityManagerFactory(ini);
  SecurityManager sm=factory.getInstance();
  Subject subject=new Subject.Builder(sm).buildSubject();
  subject.login(new UsernamePasswordToken("user1","user1"));
  assertFalse(subject.isRunAs());
  assertEquals("user1",subject.getPrincipal());
  assertTrue(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role3"));
  assertNull(subject.getPreviousPrincipals());
  subject.runAs(new SimplePrincipalCollection("user2",IniSecurityManagerFactory.INI_REALM_NAME));
  assertTrue(subject.isRunAs());
  assertEquals("user2",subject.getPrincipal());
  assertTrue(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role3"));
  PrincipalCollection previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user1"));
  subject.runAs(new SimplePrincipalCollection("user3",IniSecurityManagerFactory.INI_REALM_NAME));
  assertTrue(subject.isRunAs());
  assertEquals("user3",subject.getPrincipal());
  assertTrue(subject.hasRole("role3"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user2"));
  subject.releaseRunAs();
  assertTrue(subject.isRunAs());
  assertEquals("user2",subject.getPrincipal());
  assertTrue(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role3"));
  previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user1"));
  subject.releaseRunAs();
  assertFalse(subject.isRunAs());
  assertEquals("user1",subject.getPrincipal());
  assertTrue(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role3"));
  assertNull(subject.getPreviousPrincipals());
  subject.logout();
  LifecycleUtils.destroy(sm);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionStopThenStart(){
  String key="testKey";
  String value="testValue";
  DefaultSecurityManager sm=new DefaultSecurityManager();
  DelegatingSubject subject=new DelegatingSubject(sm);
  Session session=subject.getSession();
  session.setAttribute(key,value);
  assertTrue(session.getAttribute(key).equals(value));
  Serializable firstSessionId=session.getId();
  assertNotNull(firstSessionId);
  session.stop();
  session=subject.getSession();
  assertNotNull(session);
  assertNull(session.getAttribute(key));
  Serializable secondSessionId=session.getId();
  assertNotNull(secondSessionId);
  assertFalse(firstSessionId.equals(secondSessionId));
  subject.logout();
  sm.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.util.RegExPatternMatcherTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSimplePattern(){
  PatternMatcher pm=new RegExPatternMatcher();
  String pattern="a*b";
  String test="aaaaaaab";
  Pattern.compile(pattern);
  assertTrue(pm.matches(pattern,test));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.util.StringUtilsTest </h4><pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpacesAndEscapedQuotes(){
  String line="shall, \"\"\"we, play\", a, \"\"\"game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("shall",split[0]);
  assertEquals("\"we, play",split[1]);
  assertEquals("a",split[2]);
  assertEquals("\"game?",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithCommas(){
  String line="shall,we,play,a,game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 5);
  assertEquals("shall",split[0]);
  assertEquals("we",split[1]);
  assertEquals("play",split[2]);
  assertEquals("a",split[3]);
  assertEquals("game?",split[4]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitTestWithQuotedCommas(){
  String line="authc, test[blah], test[\"1,2,3\"], test[]";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("authc",split[0]);
  assertEquals("test[blah]",split[1]);
  assertEquals("test[1,2,3]",split[2]);
  assertEquals("test[]",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithCommasAndSpaces(){
  String line="shall,we ,    play, a,game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 5);
  assertEquals("shall",split[0]);
  assertEquals("we",split[1]);
  assertEquals("play",split[2]);
  assertEquals("a",split[3]);
  assertEquals("game?",split[4]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpaces(){
  String line="shall, \"we, play\", a, game?";
  String[] split=StringUtils.split(line);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("shall",split[0]);
  assertEquals("we, play",split[1]);
  assertEquals("a",split[2]);
  assertEquals("game?",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpacesAndDifferentQuoteChars(){
  String line="authc, test[blah], test[1,2,3], test[]";
  String[] split=StringUtils.split(line,',','[',']',false,true);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("authc",split[0]);
  assertEquals("testblah",split[1]);
  assertEquals("test1,2,3",split[2]);
  assertEquals("test",split[3]);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitWithQuotedCommasAndSpacesAndDifferentQuoteCharsWhileRetainingQuotes(){
  String line="authc, test[blah], test[1,2,3], test[]";
  String[] split=StringUtils.split(line,',','[',']',true,true);
  assertNotNull(split);
  assertTrue(split.length == 4);
  assertEquals("authc",split[0]);
  assertEquals("test[blah]",split[1]);
  assertEquals("test[1,2,3]",split[2]);
  assertEquals("test[]",split[3]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.config.WebIniSecurityManagerFactoryTest </h4><pre class="type-13 type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ensures the WebIniSecurityManagerFactory will automatically add the default
 * filters to the pool of beans before the INI configuration is interpreted.
 */
@Test public void testDefaultFiltersPresent(){
  Ini ini=new Ini();
  Ini.Section section=ini.addSection(IniSecurityManagerFactory.MAIN_SECTION_NAME);
  section.put("authc.loginUrl","/login.jsp");
  WebIniSecurityManagerFactory factory=new WebIniSecurityManagerFactory(ini);
  org.apache.shiro.mgt.SecurityManager sm=factory.getInstance();
  assertNotNull(sm);
  assertTrue(sm instanceof DefaultWebSecurityManager);
  Map<String,?> beans=factory.getBeans();
  for (  DefaultFilter defaultFilter : DefaultFilter.values()) {
    Filter filter=(Filter)beans.get(defaultFilter.name());
    assertNotNull(filter);
    assertTrue(defaultFilter.getFilterClass().isAssignableFrom(filter.getClass()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.PathMatchingFilterTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test asserting <a href="https://issues.apache.org/jira/browse/SHIRO-221">SHIRO-221<a/>.
 */
@SuppressWarnings({"JavaDoc"}) @Test public void testEnabled() throws Exception {
  filter.processPathConfig(DISABLED_PATH,null);
  filter.processPathConfig(ENABLED_PATH,null);
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  ServletResponse response=createNiceMock(ServletResponse.class);
  expect(request.getContextPath()).andReturn(CONTEXT_PATH).anyTimes();
  expect(request.getRequestURI()).andReturn(ENABLED_PATH).anyTimes();
  replay(request);
  boolean continueFilterChain=filter.preHandle(request,response);
  assertFalse("FilterChain should NOT continue.",continueFilterChain);
  verify(request);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test asserting <a href="https://issues.apache.org/jira/browse/SHIRO-221">SHIRO-221<a/>.
 */
@SuppressWarnings({"JavaDoc"}) @Test public void testDisabledBasedOnPath() throws Exception {
  filter.processPathConfig(DISABLED_PATH,null);
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  ServletResponse response=createNiceMock(ServletResponse.class);
  expect(request.getContextPath()).andReturn(CONTEXT_PATH).anyTimes();
  expect(request.getRequestURI()).andReturn(DISABLED_PATH).anyTimes();
  replay(request);
  boolean continueFilterChain=filter.preHandle(request,response);
  assertTrue("FilterChain should continue.",continueFilterChain);
  verify(request);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authc.AnonymousFilterTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void test(){
  AnonymousFilter filter=new AnonymousFilter();
  boolean allow=filter.onPreHandle(null,null,null);
  assertTrue(allow);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authc.BasicHttpFilterAuthenticationTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoPassword() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro",""));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  UsernamePasswordToken upToken=(UsernamePasswordToken)token;
  assertEquals("pedro",upToken.getUsername());
  assertEquals("Password is not empty.",0,upToken.getPassword().length);
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenColonInPassword() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro","pass:word"));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  UsernamePasswordToken upToken=(UsernamePasswordToken)token;
  assertEquals("pedro",upToken.getUsername());
  assertEquals("pass:word",new String(upToken.getPassword()));
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoAuthorizationHeader() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(null);
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  assertEquals("",token.getPrincipal());
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoUsername() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("",""));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  assertEquals("",token.getPrincipal());
  verify(request);
  verify(response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authz.HostFilterTest </h4><pre class="type-17 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testPrivateClassB(){
  Pattern p=Pattern.compile(HostFilter.PRIVATE_CLASS_B_REGEX);
  String base="172.";
  for (int i=16; i < 32; i++) {
    String ibase=base + i;
    for (int j=0; j < 256; j++) {
      String jBase=ibase + "." + j;
      for (int k=0; k < 256; k++) {
        String ip=jBase + "." + k;
        assertTrue(p.matcher(ip).matches());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-17 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testPrivateClassC(){
  Pattern p=Pattern.compile(HostFilter.PRIVATE_CLASS_C_REGEX);
  String base="192.168.";
  for (int i=0; i < 256; i++) {
    String ibase=base + i;
    for (int j=0; j < 256; j++) {
      String ip=ibase + "." + j;
      assertTrue(p.matcher(ip).matches());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authz.PortFilterTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDefault() throws Exception {
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  HttpServletRequest request=createBaseMockRequest();
  expect(response.encodeRedirectURL(eq("http://localhost/"))).andReturn("http://localhost/");
  replay(request);
  replay(response);
  PortFilter filter=new PortFilter();
  boolean result=filter.onAccessDenied(request,response,null);
  verify(request);
  verify(response);
  assertFalse(result);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This tests the case where the client (e.g. browser) specifies a simple request to http://localhost/
 * (i.e. http scheme with the implied port of 80). The redirectURL should reflect the configured port (8080) instead
 * of the implied port 80.
 * @throws Exception if there is a test failure
 */
@Test public void testConfiguredPort() throws Exception {
  int port=8080;
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  HttpServletRequest request=createBaseMockRequest();
  String expected="http://localhost:" + port + "/";
  expect(response.encodeRedirectURL(eq(expected))).andReturn(expected);
  replay(request);
  replay(response);
  PortFilter filter=new PortFilter();
  filter.setPort(port);
  boolean result=filter.onAccessDenied(request,response,null);
  verify(request);
  verify(response);
  assertFalse(result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolverTest </h4><pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstance(){
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstanceWithFilterConfig(){
  FilterConfig mock=createNiceMockFilterConfig();
  replay(mock);
  resolver=new PathMatchingFilterChainResolver(mock);
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
  assertEquals(((DefaultFilterChainManager)resolver.getFilterChainManager()).getFilterConfig(),mock);
  verify(mock);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetters(){
  resolver.setPathMatcher(new AntPathMatcher());
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  resolver.setFilterChainManager(new DefaultFilterChainManager());
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.mgt.SimpleNamedFilterListTest </h4><pre class="type-2 type-12 type-15 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Exists mainly to increase code coverage as the SimpleNamedFilterList
 * implementation is a direct pass through.
 */
@Test public void testListMethods(){
  FilterChain mock=createNiceMock(FilterChain.class);
  Filter filter=createNiceMock(Filter.class);
  NamedFilterList list=new SimpleNamedFilterList("test");
  list.add(filter);
  FilterChain chain=list.proxy(mock);
  assertNotNull(chain);
  assertNotSame(mock,chain);
  Filter singleFilter=new SslFilter();
  List<? extends Filter> multipleFilters=CollectionUtils.asList(new PortFilter(),new UserFilter());
  list.add(0,singleFilter);
  assertEquals(2,list.size());
  assertTrue(list.get(0) instanceof SslFilter);
  assertTrue(Arrays.equals(list.toArray(),new Object[]{singleFilter,filter}));
  list.addAll(multipleFilters);
  assertEquals(4,list.size());
  assertTrue(list.get(2) instanceof PortFilter);
  assertTrue(list.get(3) instanceof UserFilter);
  list.addAll(0,CollectionUtils.asList(new PermissionsAuthorizationFilter(),new RolesAuthorizationFilter()));
  assertEquals(6,list.size());
  assertTrue(list.get(0) instanceof PermissionsAuthorizationFilter);
  assertTrue(list.get(1) instanceof RolesAuthorizationFilter);
  assertEquals(2,list.indexOf(singleFilter));
  assertEquals(multipleFilters,list.subList(4,list.size()));
  assertTrue(list.contains(singleFilter));
  assertTrue(list.containsAll(multipleFilters));
  assertFalse(list.isEmpty());
  list.clear();
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  Iterator i=list.iterator();
  assertTrue(i.hasNext());
  assertEquals(i.next(),singleFilter);
  ListIterator li=list.listIterator();
  assertTrue(li.hasNext());
  assertEquals(li.next(),singleFilter);
  li=list.listIterator(0);
  assertTrue(li.hasNext());
  assertEquals(li.next(),singleFilter);
  list.set(0,singleFilter);
  assertEquals(list.get(0),singleFilter);
  Filter[] filters=new Filter[list.size()];
  filters=list.toArray(filters);
  assertEquals(1,filters.length);
  assertEquals(filters[0],singleFilter);
  assertEquals(0,list.lastIndexOf(singleFilter));
  list.remove(singleFilter);
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  list.remove(0);
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  list.addAll(multipleFilters);
  assertEquals(3,list.size());
  list.removeAll(multipleFilters);
  assertEquals(1,list.size());
  assertEquals(list.get(0),singleFilter);
  list.addAll(multipleFilters);
  assertEquals(3,list.size());
  list.retainAll(multipleFilters);
  assertEquals(2,list.size());
  assertEquals(new ArrayList(list),multipleFilters);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.CookieRememberMeManagerTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void getRememberedPrincipals(){
  HttpServletRequest mockRequest=createMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createMock(HttpServletResponse.class);
  WebSubjectContext context=new DefaultWebSubjectContext();
  context.setServletRequest(mockRequest);
  context.setServletResponse(mockResponse);
  expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);
  final String userPCAesBase64="WlD5MLzzZznN3dQ1lPJO/eScSuY245k29aECNmjUs31o7Yu478hWhaM5Sj" + "jmoe900/72JNu3hcJaPG6Q17Vuz4F8x0kBjbFnPVx4PqzsZYT6yreeS2jwO6OwfI+efqXOKyB2a5KPtnr" + "7jt5kZsyH38XJISb81cf6xqTGUru8zC+kNqJFz7E5RpO0kraBofS5jhMm45gDVjDRkjgPJAzocVWMtrza"+ "zy67P8eb+kMSBCqGI251JTNAGboVgQ28KjfaAJ/6LXRJUj7kB7CGia7mgRk+hxzEJGDs81at5VOPqODJr"+ "xb8tcIdemFUFIkiYVP9bGs4dP3ECtmw7aNrCzv+84sx3vRFUrd5DbDYpEuE12hF2Y9owDK9sxStbXoF0y"+ "A32dhfGDIqS+agsass0sWn8WX2TM9i8SxrUjiFbxqyIG49HbqGrZp5QLM9IuIwO+TzGfF1FzumQGdwmWT"+ "xkVapw5UESl34YvA615cb+82ue1I=";
  Cookie[] cookies=new Cookie[]{new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME,userPCAesBase64)};
  expect(mockRequest.getCookies()).andReturn(cookies);
  replay(mockRequest);
  CookieRememberMeManager mgr=new CookieRememberMeManager();
  PrincipalCollection collection=mgr.getRememberedPrincipals(context);
  verify(mockRequest);
  assertTrue(collection != null);
  assertTrue(collection.iterator().next().equals("user"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.DefaultWebSecurityManagerTest </h4><pre class="type-13 type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogin(){
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  expect(mockRequest.getCookies()).andReturn(null);
  expect(mockRequest.getContextPath()).andReturn("/");
  replay(mockRequest);
  Subject subject=newSubject(mockRequest,mockResponse);
  assertFalse(subject.isAuthenticated());
  subject.login(new UsernamePasswordToken("lonestarr","vespa"));
  assertTrue(subject.isAuthenticated());
  assertNotNull(subject.getPrincipal());
  assertTrue(subject.getPrincipal().equals("lonestarr"));
}

</code></pre>

<br>
<pre class="type-13 type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubjectByRequestResponsePair(){
  shiroSessionModeInit();
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  expect(mockRequest.getCookies()).andReturn(null);
  replay(mockRequest);
  replay(mockResponse);
  Subject subject=newSubject(mockRequest,mockResponse);
  verify(mockRequest);
  verify(mockResponse);
  assertNotNull(subject);
  assertTrue(subject.getPrincipals() == null || subject.getPrincipals().isEmpty());
  assertTrue(subject.getSession(false) == null);
  assertFalse(subject.isAuthenticated());
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void checkSessionManagerDeterminesContainerSessionMode(){
  sm.setSessionMode(DefaultWebSecurityManager.NATIVE_SESSION_MODE);
  WebSessionManager sessionManager=createMock(WebSessionManager.class);
  expect(sessionManager.isServletContainerSessions()).andReturn(true).anyTimes();
  replay(sessionManager);
  sm.setSessionManager(sessionManager);
  assertTrue("The set SessionManager is not being used to determine isHttpSessionMode.",sm.isHttpSessionMode());
  verify(sessionManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.servlet.OncePerRequestFilterTest </h4><pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test asserting <a href="https://issues.apache.org/jira/browse/SHIRO-221">SHIRO-221<a/>.
 */
@SuppressWarnings({"JavaDoc"}) @Test public void testDisabled() throws IOException, ServletException {
  filter.setEnabled(false);
  expect(request.getAttribute(ATTR_NAME)).andReturn(null).anyTimes();
  replay(request);
  filter.doFilter(request,response,chain);
  verify(request);
  assertFalse("Filter should NOT have executed",FILTERED[0]);
}

</code></pre>

<br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
/** 
 * Test asserting <a href="https://issues.apache.org/jira/browse/SHIRO-221">SHIRO-221<a/>.
 */
@SuppressWarnings({"JavaDoc"}) @Test public void testEnabled() throws IOException, ServletException {
  expect(request.getAttribute(ATTR_NAME)).andReturn(null).anyTimes();
  replay(request);
  filter.doFilter(request,response,chain);
  verify(request);
  assertTrue("Filter should have executed",FILTERED[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.servlet.SimpleCookieTest </h4><pre class="type-13 type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveValue() throws Exception {
  String name="test";
  String value="deleteMe";
  String path="/somepath";
  String headerValue=this.cookie.buildHeaderValue(name,value,null,null,path,0,SimpleCookie.DEFAULT_VERSION,false,false);
  String expectedStart=new StringBuilder().append(name).append(SimpleCookie.NAME_VALUE_DELIMITER).append(value).append(SimpleCookie.ATTRIBUTE_DELIMITER).append(SimpleCookie.PATH_ATTRIBUTE_NAME).append(SimpleCookie.NAME_VALUE_DELIMITER).append(path).toString();
  assertTrue(headerValue.startsWith(expectedStart));
  expect(mockRequest.getContextPath()).andReturn(path).times(1);
  mockResponse.addHeader(eq(SimpleCookie.COOKIE_HEADER_NAME),isA(String.class));
  replay(mockRequest);
  replay(mockResponse);
  this.cookie.removeFrom(mockRequest,mockResponse);
  verify(mockRequest);
  verify(mockResponse);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
