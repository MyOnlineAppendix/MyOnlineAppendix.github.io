<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.shiro.ExceptionTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMsgConstructor() throws Exception {
  ClassUtils.newInstance(getExceptionClass(),"Msg");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMsgCauseConstructor(){
  ClassUtils.newInstance(getExceptionClass(),"Msg",new Throwable());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNoArgConstructor(){
  ClassUtils.newInstance(getExceptionClass());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCauseConstructor() throws Exception {
  ClassUtils.newInstance(getExceptionClass(),new Throwable());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.aspectj.DummyServiceTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testChange_asAdmin() throws Exception {
  loginAsAdmin();
  SECURED_SERVICE.change();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRetrieve_asUser() throws Exception {
  loginAsUser();
  SECURED_SERVICE.retrieve();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testPeek_asAnonymous() throws Exception {
  SECURED_SERVICE.peek();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuest_asAdmin() throws Exception {
  loginAsAdmin();
  SECURED_SERVICE.guest();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRetrieve_asAdmin() throws Exception {
  loginAsAdmin();
  SECURED_SERVICE.retrieve();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthorizedException.class) public void testChange_asUser() throws Exception {
  loginAsUser();
  SECURED_SERVICE.change();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuest_asUser() throws Exception {
  loginAsUser();
  SECURED_SERVICE.guest();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testRetrieveRestricted_asAnonymous() throws Exception {
  RESTRICTED_SERVICE.retrieve();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnonymous_asUser() throws Exception {
  loginAsUser();
  SECURED_SERVICE.anonymous();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testChange_asAnonymous() throws Exception {
  SECURED_SERVICE.change();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGuest_asAnonymous() throws Exception {
  SECURED_SERVICE.guest();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testRetrieve_asAnonymous() throws Exception {
  SECURED_SERVICE.retrieve();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthorizedException.class) public void testRetrieveRestricted_asUser() throws Exception {
  loginAsUser();
  RESTRICTED_SERVICE.retrieve();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPeek_asUser() throws Exception {
  loginAsUser();
  SECURED_SERVICE.peek();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testRetrieveRestricted_asAdmin() throws Exception {
  loginAsAdmin();
  RESTRICTED_SERVICE.retrieve();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnonymous_asAdmin() throws Exception {
  loginAsAdmin();
  SECURED_SERVICE.anonymous();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAnonymous_asAnonymous() throws Exception {
  SECURED_SERVICE.anonymous();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPeek_asAdmin() throws Exception {
  loginAsAdmin();
  SECURED_SERVICE.peek();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.AbstractAuthenticatorTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void notifyFailureAfterDoAuthenticateThrowsNonAuthenticationException(){
  abstractAuthenticator=new AbstractAuthenticator(){
    protected AuthenticationInfo doAuthenticate(    AuthenticationToken token) throws AuthenticationException {
      throw new IllegalArgumentException("not an AuthenticationException subclass");
    }
  }
;
  AuthenticationToken token=newToken();
  abstractAuthenticator.authenticate(token);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Ensures that the authenticate() method proactively fails if a <tt>null</tt> AuthenticationToken is passed as an
 * argument.
 */
@Test(expected=IllegalArgumentException.class) public void authenticateWithNullArgument(){
  abstractAuthenticator.authenticate(null);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Ensures that the authenticate() method throws an AuthenticationException if the subclass returns <tt>null</tt>
 * as the return value to the doAuthenticate() method.
 */
@Test(expected=AuthenticationException.class) public void throwAuthenticationExceptionIfDoAuthenticateReturnsNull(){
  abstractAuthenticator=createAuthcReturnNull();
  abstractAuthenticator.authenticate(newToken());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void notifySuccessAfterDoAuthenticate(){
  AuthenticationListener mockListener=createMock(AuthenticationListener.class);
  abstractAuthenticator.getAuthenticationListeners().add(mockListener);
  AuthenticationToken token=newToken();
  mockListener.onSuccess(token,info);
  replay(mockListener);
  abstractAuthenticator.authenticate(token);
  verify(mockListener);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.SimpleAuthenticationInfoTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Verifies fix for JSEC-122
 */
@Test public void testMergeWithAggregateNullCredentials(){
  SimpleAuthenticationInfo aggregate=new SimpleAuthenticationInfo();
  SimpleAuthenticationInfo local=new SimpleAuthenticationInfo("username","password","testRealm");
  aggregate.merge(local);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMergeWithEmptyInstances(){
  SimpleAuthenticationInfo aggregate=new SimpleAuthenticationInfo();
  SimpleAuthenticationInfo local=new SimpleAuthenticationInfo();
  aggregate.merge(local);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.pam.AllSuccessfulStrategyTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnsupportedTokenException.class) public void beforeAttemptRealmDoesntSupportToken(){
  Realm notSupportingRealm=new AuthorizingRealm(){
    public boolean supports(    AuthenticationToken token){
      return false;
    }
    protected AuthenticationInfo doGetAuthenticationInfo(    AuthenticationToken token) throws AuthenticationException {
      return null;
    }
    protected AuthorizationInfo doGetAuthorizationInfo(    PrincipalCollection principal){
      return null;
    }
  }
;
  strategy.beforeAttempt(notSupportingRealm,null,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.aop.PermissionAnnotationHandlerTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuestSinglePermissionAssertion() throws Throwable {
  PermissionAnnotationHandler handler=new PermissionAnnotationHandler();
  Annotation requiresPermissionAnnotation=new RequiresPermissions(){
    public String[] value(){
      return new String[]{"test:test"};
    }
    public Class<? extends Annotation> annotationType(){
      return RequiresPermissions.class;
    }
    public Logical logical(){
      return Logical.AND;
    }
  }
;
  handler.assertAuthorized(requiresPermissionAnnotation);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuestMultiplePermissionAssertion() throws Throwable {
  PermissionAnnotationHandler handler=new PermissionAnnotationHandler();
  Annotation requiresPermissionAnnotation=new RequiresPermissions(){
    public String[] value(){
      return new String[]{"test:test","test2:test2"};
    }
    public Class<? extends Annotation> annotationType(){
      return RequiresPermissions.class;
    }
    public Logical logical(){
      return Logical.AND;
    }
  }
;
  handler.assertAuthorized(requiresPermissionAnnotation);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.aop.RoleAnnotationHandlerTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuestSingleRoleAssertion() throws Throwable {
  RoleAnnotationHandler handler=new RoleAnnotationHandler();
  Annotation requiresRolesAnnotation=new RequiresRoles(){
    public String[] value(){
      return new String[]{"blah"};
    }
    public Class<? extends Annotation> annotationType(){
      return RequiresRoles.class;
    }
    public Logical logical(){
      return Logical.AND;
    }
  }
;
  handler.assertAuthorized(requiresRolesAnnotation);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOneOfTheRolesRequired() throws Throwable {
  subject=createMock(Subject.class);
  expect(subject.hasRole("blah")).andReturn(true);
  expect(subject.hasRole("blah2")).andReturn(false);
  replay(subject);
  RoleAnnotationHandler handler=new RoleAnnotationHandler(){
    @Override protected Subject getSubject(){
      return subject;
    }
  }
;
  Annotation requiresRolesAnnotation=new RequiresRoles(){
    public String[] value(){
      return new String[]{"blah","blah2"};
    }
    public Class<? extends Annotation> annotationType(){
      return RequiresRoles.class;
    }
    public Logical logical(){
      return Logical.OR;
    }
  }
;
  handler.assertAuthorized(requiresRolesAnnotation);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuestMultipleRolesAssertion() throws Throwable {
  RoleAnnotationHandler handler=new RoleAnnotationHandler();
  Annotation requiresRolesAnnotation=new RequiresRoles(){
    public String[] value(){
      return new String[]{"blah","blah2"};
    }
    public Class<? extends Annotation> annotationType(){
      return RequiresRoles.class;
    }
    public Logical logical(){
      return Logical.AND;
    }
  }
;
  handler.assertAuthorized(requiresRolesAnnotation);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.concurrent.SubjectAwareExecutorServiceTest </h4><pre class="type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@SuppressWarnings({"unchecked"}) @Test public void testSubmitRunnable(){
  ExecutorService mockExecutorService=createNiceMock(ExecutorService.class);
  expect(mockExecutorService.submit(isA(SubjectRunnable.class))).andReturn(new DummyFuture());
  replay(mockExecutorService);
  final SubjectAwareExecutorService executor=new SubjectAwareExecutorService(mockExecutorService);
  Runnable testRunnable=new Runnable(){
    public void run(){
      System.out.println("Hello World");
    }
  }
;
  executor.submit(testRunnable);
  verify(mockExecutorService);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.concurrent.SubjectAwareExecutorTest </h4><pre class="type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExecute(){
  Executor targetMockExecutor=createNiceMock(Executor.class);
  targetMockExecutor.execute(isA(SubjectRunnable.class));
  replay(targetMockExecutor);
  final SubjectAwareExecutor executor=new SubjectAwareExecutor(targetMockExecutor);
  Runnable work=new Runnable(){
    public void run(){
      System.out.println("Hello World");
    }
  }
;
  executor.execute(work);
  verify(targetMockExecutor);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.DestroyableInjectionListenerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAfterInjection() throws Exception {
  DestroyableInjectionListener.DestroyableRegistry registry=createMock(DestroyableInjectionListener.DestroyableRegistry.class);
  Destroyable destroyable=createMock(Destroyable.class);
  registry.add(destroyable);
  replay(registry,destroyable);
  DestroyableInjectionListener underTest=new DestroyableInjectionListener(registry);
  underTest.afterInjection(destroyable);
  verify(registry,destroyable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.InitializableInjectionListenerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAfterInjection() throws Exception {
  Initializable initializable=createMock(Initializable.class);
  initializable.init();
  replay(initializable);
  InitializableInjectionListener underTest=new InitializableInjectionListener();
  underTest.afterInjection(initializable);
  verify(initializable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.LifecycleTypeListenerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHearInitializable() throws Exception {
  TypeEncounter encounter=createMock(TypeEncounter.class);
  encounter.register(anyObject(InitializableInjectionListener.class));
  replay(encounter);
  LifecycleTypeListener underTest=new LifecycleTypeListener(null);
  underTest.hear(TypeLiteral.get(MyInitializable.class),encounter);
  verify(encounter);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHearDestroyable() throws Exception {
  TypeEncounter encounter=createMock(TypeEncounter.class);
  encounter.register(anyObject(DestroyableInjectionListener.class));
  replay(encounter);
  LifecycleTypeListener underTest=new LifecycleTypeListener(null);
  underTest.hear(TypeLiteral.get(MyDestroyable.class),encounter);
  verify(encounter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroModuleTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDestroy() throws Exception {
  final MockRealm mockRealm=createMock(MockRealm.class);
  final MyDestroyable myDestroyable=createMock(MyDestroyable.class);
  myDestroyable.destroy();
  replay(myDestroyable);
  final ShiroModule shiroModule=new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
      bind(MyDestroyable.class).toInstance(myDestroyable);
      expose(MyDestroyable.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
  }
;
  Injector injector=Guice.createInjector(shiroModule);
  injector.getInstance(MyDestroyable.class);
  shiroModule.destroy();
  verify(myDestroyable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroSessionScopeTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=OutOfScopeException.class) public void testOutOfScope() throws Exception {
  ShiroSessionScope underTest=new ShiroSessionScope();
  Provider<SomeClass> mockProvider=createMock(Provider.class);
  replay(mockProvider);
  underTest.scope(Key.get(SomeClass.class),mockProvider).get();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.PathMatchingFilterProviderTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testPostProcess(){
  PathMatchingFilter filter=createMock(PathMatchingFilter.class);
  expect(filter.processPathConfig("/1","first")).andReturn(filter);
  expect(filter.processPathConfig("/2","second")).andReturn(filter);
  replay(filter);
  Map<String,String> pathConfigMap=new HashMap<String,String>();
  pathConfigMap.put("/1","first");
  pathConfigMap.put("/2","second");
  PathMatchingFilterProvider underTest=new PathMatchingFilterProvider(Key.get(PathMatchingFilter.class),pathConfigMap);
  underTest.postProcess(filter);
  verify(filter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.SimpleFilterChainTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoFilter() throws Exception {
  IMocksControl ctrl=createStrictControl();
  FilterChain originalChain=ctrl.createMock(FilterChain.class);
  Filter filter1=ctrl.createMock("filter1",Filter.class);
  Filter filter2=ctrl.createMock("filter2",Filter.class);
  ServletRequest request=ctrl.createMock(ServletRequest.class);
  ServletResponse response=ctrl.createMock(ServletResponse.class);
  Capture<FilterChain> fc1=new Capture<FilterChain>();
  Capture<FilterChain> fc2=new Capture<FilterChain>();
  filter1.doFilter(same(request),same(response),and(anyObject(FilterChain.class),capture(fc1)));
  filter2.doFilter(same(request),same(response),and(anyObject(FilterChain.class),capture(fc2)));
  originalChain.doFilter(request,response);
  ctrl.replay();
  SimpleFilterChain underTest=new SimpleFilterChain(originalChain,Iterators.forArray(filter1,filter2));
  underTest.doFilter(request,response);
  fc1.getValue().doFilter(request,response);
  fc2.getValue().doFilter(request,response);
  ctrl.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.jndi.JndiObjectFactoryTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalStateException.class) public void testJndiLookupFailsNoType() throws Exception {
  final String name="my/jndi/resource";
  JndiObjectFactory<String> underTest=new JndiObjectFactory<String>(){
    @Override protected Object lookup(    String jndiName) throws NamingException {
      throw new NamingException("No resource named " + jndiName);
    }
  }
;
  underTest.setResourceName(name);
  underTest.getInstance();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalStateException.class) public void testJndiLookupFailsWithType() throws Exception {
  final String name="my/jndi/resource";
  JndiObjectFactory<String> underTest=new JndiObjectFactory<String>(){
    @Override protected Object lookup(    String jndiName,    Class requiredType) throws NamingException {
      throw new NamingException("No resource named " + jndiName);
    }
  }
;
  underTest.setResourceName(name);
  underTest.setRequiredType(String.class);
  underTest.getInstance();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.jdbc.JDBCRealmTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExternalWrongPassword() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,true);
  realm.setSaltStyle(JdbcRealm.SaltStyle.EXTERNAL);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,"passwrd");
  try {
    currentUser.login(token);
  }
 catch (  IncorrectCredentialsException ex) {
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSaltColumnSuccess() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createSaltColumnSchema(testMethodName);
  realm.setSaltStyle(JdbcRealm.SaltStyle.COLUMN);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  currentUser.logout();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testExternalSuccess() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,true);
  realm.setSaltStyle(JdbcRealm.SaltStyle.EXTERNAL);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  currentUser.logout();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnSaltedMultipleRows() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Connection conn=dsMap.get(testMethodName).getConnection();
  Statement sql=conn.createStatement();
  sql.executeUpdate("insert into users values ('" + username + "', 'dupe')");
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,"passwrd");
  try {
    currentUser.login(token);
  }
 catch (  AuthenticationException ex) {
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSaltColumnWrongPassword() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createSaltColumnSchema(testMethodName);
  realm.setSaltStyle(JdbcRealm.SaltStyle.COLUMN);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,"passwrd");
  try {
    currentUser.login(token);
  }
 catch (  IncorrectCredentialsException ex) {
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnSaltedSuccess() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  currentUser.logout();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUnSaltedWrongPassword() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,"passwrd");
  try {
    currentUser.login(token);
  }
 catch (  IncorrectCredentialsException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.DefaultLdapContextFactoryTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalStateException.class) public void testGetLdapContextWithoutUrl() throws NamingException {
  factory.getLdapContext((Object)"foo","bar");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyStringCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder","");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is the only test that does not fake the JNDI environment.  It is provided for 100% test coverage.
 * @throws javax.naming.NamingException thrown because the host is always broken.
 */
@Test(expected=NamingException.class) public void testGetLdapContext() throws NamingException {
  factory=new DefaultLdapContextFactory();
  String brokenHost=UUID.randomUUID().toString();
  factory.setUrl("ldap://" + brokenHost + ":389");
  factory.getLdapContext((Object)"foo","bar");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyNullCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder",null);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyCharArrayCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder",new char[0]);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyByteArrayCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder",new byte[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapContextFactoryTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyCharArrayCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder",new char[0]);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyStringCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder","");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyByteArrayCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder",new byte[0]);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalStateException.class) public void testGetLdapContextWithoutUrl() throws NamingException {
  factory.getLdapContext((Object)"foo","bar");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This is the only test that does not fake the JNDI environment.  It is provided for 100% test coverage.
 * @throws NamingException thrown because the host is always broken.
 */
@Test(expected=NamingException.class) public void testGetLdapContext() throws NamingException {
  factory=new JndiLdapContextFactory();
  String brokenHost=UUID.randomUUID().toString();
  factory.setUrl("ldap://" + brokenHost + ":389");
  factory.getLdapContext((Object)"foo","bar");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testEmptyNullCredentials() throws NamingException {
  factory.setUrl("ldap://localhost:389");
  factory.getLdapContext((Object)"jcoder",null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapRealmTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSetUserDnTemplateNull(){
  realm.setUserDnTemplate(null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserDnTemplateSubstitution() throws NamingException {
  realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");
  LdapContextFactory factory=createMock(LdapContextFactory.class);
  realm.setContextFactory(factory);
  Object expectedPrincipal="uid=jsmith,ou=users,dc=mycompany,dc=com";
  expect(factory.getLdapContext(eq(expectedPrincipal),isA(Object.class))).andReturn(createNiceMock(LdapContext.class));
  replay(factory);
  realm.getAuthenticationInfo(new UsernamePasswordToken("jsmith","secret"));
  verify(factory);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testGetAuthenticationInfoNamingAuthenticationException() throws NamingException {
  realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");
  LdapContextFactory factory=createMock(LdapContextFactory.class);
  realm.setContextFactory(factory);
  expect(factory.getLdapContext(isA(Object.class),isA(Object.class))).andThrow(new javax.naming.AuthenticationException("LDAP Authentication failed."));
  replay(factory);
  realm.getAuthenticationInfo(new UsernamePasswordToken("jsmith","secret"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=AuthenticationException.class) public void testGetAuthenticationInfoNamingException() throws NamingException {
  realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");
  LdapContextFactory factory=createMock(LdapContextFactory.class);
  realm.setContextFactory(factory);
  expect(factory.getLdapContext(isA(Object.class),isA(Object.class))).andThrow(new NamingException("Communication error."));
  replay(factory);
  realm.getAuthenticationInfo(new UsernamePasswordToken("jsmith","secret"));
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSetUserDnTemplateEmpty(){
  realm.setUserDnTemplate("  ");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * This test simulates that if a non-String principal (i.e. not a username) is passed as the LDAP principal, that
 * it is not altered into a User DN and is passed as-is.  This will allow principals to be things like X.509
 * certificates as well instead of only strings.
 * @throws NamingException not thrown
 */
@Test public void testGetAuthenticationInfoNonSimpleToken() throws NamingException {
  realm.setUserDnTemplate("uid={0},ou=users,dc=mycompany,dc=com");
  LdapContextFactory factory=createMock(LdapContextFactory.class);
  realm.setContextFactory(factory);
  final UUID userId=UUID.randomUUID();
  expect(factory.getLdapContext(eq(userId),isA(Object.class))).andReturn(createNiceMock(LdapContext.class));
  replay(factory);
  realm.getAuthenticationInfo(new AuthenticationToken(){
    public Object getPrincipal(){
      return userId;
    }
    public Object getCredentials(){
      return "secret";
    }
  }
);
  verify(factory);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testSetUserDnTemplateWithoutToken(){
  realm.setUserDnTemplate("uid=,ou=users,dc=mycompany,dc=com");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testGetUserDnNullArgument(){
  realm.getUserDn(null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.text.IniRealmTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalStateException.class) public void testInitWithoutIniResource(){
  new IniRealm().init();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.samples.aspectj.bank.SecureBankServiceTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NotEnoughFundsException.class) public void testWithdrawFrom_emptyAccount() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Wally Smith");
  service.withdrawFrom(accountId,100.00d);
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NotEnoughFundsException.class) public void testWithdrawFrom_notEnoughFunds() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Frank Smith");
  makeDepositAndValidateAccount(accountId,50.00d,"Frank Smith");
  service.withdrawFrom(accountId,100.00d);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDepositInto_multiTxs() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Everett Smith");
  makeDepositAndValidateAccount(accountId,50.00d,"Everett Smith");
  makeDepositAndValidateAccount(accountId,300.00d,"Everett Smith");
  makeDepositAndValidateAccount(accountId,85.00d,"Everett Smith");
  assertAccount("Everett Smith",true,435.00d,3,accountId);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithdrawFrom_singleTx() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Al Smith");
  makeDepositAndValidateAccount(accountId,500.00d,"Al Smith");
  makeWithdrawalAndValidateAccount(accountId,100.00d,"Al Smith");
  assertAccount("Al Smith",true,400.00d,2,accountId);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCreateAccount() throws Exception {
  loginAsUser();
  createAndValidateAccountFor("Bob Smith");
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthorizedException.class) public void testCloseAccount_unauthorizedAttempt() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Chris Smith");
  service.closeAccount(accountId);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithdrawFrom_manyTxs() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Zoe Smith");
  makeDepositAndValidateAccount(accountId,500.00d,"Zoe Smith");
  makeWithdrawalAndValidateAccount(accountId,100.00d,"Zoe Smith");
  makeWithdrawalAndValidateAccount(accountId,75.00d,"Zoe Smith");
  makeWithdrawalAndValidateAccount(accountId,125.00d,"Zoe Smith");
  assertAccount("Zoe Smith",true,200.00d,4,accountId);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWithdrawFrom_upToZero() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Zoe Smith");
  makeDepositAndValidateAccount(accountId,500.00d,"Zoe Smith");
  makeWithdrawalAndValidateAccount(accountId,500.00d,"Zoe Smith");
  assertAccount("Zoe Smith",true,0.00d,2,accountId);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDepositInto_singleTx() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Joe Smith");
  makeDepositAndValidateAccount(accountId,250.00d,"Joe Smith");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.samples.guice.ContainerIntegrationTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void logInAndRememberMe() throws Exception {
  HtmlPage page=webClient.getPage(getBaseUri() + "login.jsp");
  HtmlForm form=page.getFormByName("loginform");
  form.<HtmlInput>getInputByName("username").setValueAttribute("root");
  form.<HtmlInput>getInputByName("password").setValueAttribute("secret");
  HtmlCheckBoxInput checkbox=form.getInputByName("rememberMe");
  checkbox.setChecked(true);
  page=form.<HtmlInput>getInputByName("submit").click();
  server.stop();
  server.start();
  page=webClient.getPage(getBaseUri());
  WebAssert.assertLinkPresentWithText(page,"Log out");
  page=page.getAnchorByHref("/account").click();
  WebAssert.assertFormPresent(page,"loginform");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void logIn() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException {
  HtmlPage page=webClient.getPage(getBaseUri() + "login.jsp");
  HtmlForm form=page.getFormByName("loginform");
  form.<HtmlInput>getInputByName("username").setValueAttribute("root");
  form.<HtmlInput>getInputByName("password").setValueAttribute("secret");
  page=form.<HtmlInput>getInputByName("submit").click();
  page.getAnchorByHref("/logout");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.security.interceptor.AbstractAuthorizationAnnotationTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testUserImplementationFailure(){
  bindGuest();
  testService.userImplementation();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAuthenticatedImplementation(){
  bindAuthenticatedUser();
  testService.authenticatedImplementation();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testAuthenticatedImplementationFailure(){
  bindUser();
  testService.authenticatedImplementation();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGuestInterface(){
  bindGuest();
  testService.guestInterface();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserImplementation(){
  bindUser();
  testService.userImplementation();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGuestImplementation(){
  bindGuest();
  testService.guestImplementation();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuestImplementationFailure(){
  bindUser();
  testService.guestImplementation();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAuthenticatedInterface(){
  bindAuthenticatedUser();
  testService.authenticatedInterface();
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserInterface(){
  bindUser();
  testService.userInterface();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.security.interceptor.DapcAuthorizationAnnotationTest </h4><pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testGuestInterfaceFailure(){
  bindUser();
  testService.guestInterface();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testAuthenticatedInterfaceFailure(){
  bindGuest();
  testService.authenticatedInterface();
}

</code></pre>

<br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=UnauthenticatedException.class) public void testUserInterfaceFailure(){
  bindGuest();
  testService.userInterface();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.subject.SimplePrincipalCollectionTest </h4><pre class="type-14 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void multiplePrincipalsTest(){
  SimplePrincipalCollection principalCollection=new SimplePrincipalCollection();
  principalCollection.add("frank","realm1");
  principalCollection.add("johnny","realm1");
  principalCollection.add("Alberto","realm2");
  PrincipalCollection underTest=principalCollection;
  System.out.println(principalCollection);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.test.ContainerIntegrationTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void logIn() throws FailingHttpStatusCodeException, MalformedURLException, IOException, InterruptedException {
  HtmlPage page=webClient.getPage(getBaseUri() + "login.jsp");
  HtmlForm form=page.getFormByName("loginform");
  form.<HtmlInput>getInputByName("username").setValueAttribute("root");
  form.<HtmlInput>getInputByName("password").setValueAttribute("secret");
  page=form.<HtmlInput>getInputByName("submit").click();
  page.getAnchorByHref("/logout");
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void logInAndRememberMe() throws Exception {
  HtmlPage page=webClient.getPage(getBaseUri() + "login.jsp");
  HtmlForm form=page.getFormByName("loginform");
  form.<HtmlInput>getInputByName("username").setValueAttribute("root");
  form.<HtmlInput>getInputByName("password").setValueAttribute("secret");
  HtmlCheckBoxInput checkbox=form.getInputByName("rememberMe");
  checkbox.setChecked(true);
  page=form.<HtmlInput>getInputByName("submit").click();
  server.stop();
  server.start();
  page=webClient.getPage(getBaseUri());
  WebAssert.assertLinkPresentWithText(page,"Log out");
  page=page.getAnchorByHref("/account").click();
  WebAssert.assertFormPresent(page,"loginform");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.test.ExampleShiroIntegrationTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimple(){
  Subject subjectUnderTest=new Subject.Builder(getSecurityManager()).buildSubject();
  setSubject(subjectUnderTest);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.test.ExampleShiroUnitTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimple(){
  Subject subjectUnderTest=createNiceMock(Subject.class);
  expect(subjectUnderTest.isAuthenticated()).andReturn(true);
  setSubject(subjectUnderTest);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authz.AuthorizationFilterTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserOnAccessDeniedWithResponseError() throws IOException {
  SecurityUtils.getSubject().login(new UsernamePasswordToken("test","test"));
  AuthorizationFilter filter=new AuthorizationFilter(){
    @Override protected boolean isAccessAllowed(    ServletRequest request,    ServletResponse response,    Object mappedValue) throws Exception {
      return false;
    }
  }
;
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  response.sendError(HttpServletResponse.SC_UNAUTHORIZED);
  replay(response);
  filter.onAccessDenied(request,response);
  verify(response);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testUserOnAccessDeniedWithRedirect() throws IOException {
  SecurityUtils.getSubject().login(new UsernamePasswordToken("test","test"));
  String unauthorizedUrl="unauthorized.jsp";
  AuthorizationFilter filter=new AuthorizationFilter(){
    @Override protected boolean isAccessAllowed(    ServletRequest request,    ServletResponse response,    Object mappedValue) throws Exception {
      return false;
    }
  }
;
  filter.setUnauthorizedUrl(unauthorizedUrl);
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  expect(request.getContextPath()).andReturn("/").anyTimes();
  String encoded="/" + unauthorizedUrl;
  expect(response.encodeRedirectURL(unauthorizedUrl)).andReturn(encoded);
  response.sendRedirect(encoded);
  replay(request);
  replay(response);
  filter.onAccessDenied(request,response);
  verify(request);
  verify(response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.CookieRememberMeManagerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void onLogout(){
  CookieRememberMeManager mgr=new CookieRememberMeManager();
  org.apache.shiro.web.servlet.Cookie cookie=createMock(org.apache.shiro.web.servlet.Cookie.class);
  mgr.setCookie(cookie);
  HttpServletRequest mockRequest=createMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createMock(HttpServletResponse.class);
  WebSubject mockSubject=createNiceMock(WebSubject.class);
  expect(mockSubject.getServletRequest()).andReturn(mockRequest).anyTimes();
  expect(mockSubject.getServletResponse()).andReturn(mockResponse).anyTimes();
  expect(mockRequest.getContextPath()).andReturn(null).anyTimes();
  cookie.removeFrom(isA(HttpServletRequest.class),isA(HttpServletResponse.class));
  replay(mockRequest);
  replay(mockResponse);
  replay(mockSubject);
  replay(cookie);
  mgr.onLogout(mockSubject);
  verify(mockSubject);
  verify(mockRequest);
  verify(mockResponse);
  verify(cookie);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void onSuccessfulLogin(){
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  WebSubject mockSubject=createNiceMock(WebSubject.class);
  expect(mockSubject.getServletRequest()).andReturn(mockRequest).anyTimes();
  expect(mockSubject.getServletResponse()).andReturn(mockResponse).anyTimes();
  CookieRememberMeManager mgr=new CookieRememberMeManager();
  org.apache.shiro.web.servlet.Cookie cookie=createMock(org.apache.shiro.web.servlet.Cookie.class);
  mgr.setCookie(cookie);
  cookie.removeFrom(isA(HttpServletRequest.class),isA(HttpServletResponse.class));
  expect(cookie.getName()).andReturn("rememberMe");
  expect(cookie.getValue()).andReturn(null);
  expect(cookie.getComment()).andReturn(null);
  expect(cookie.getDomain()).andReturn(null);
  expect(cookie.getPath()).andReturn(null);
  expect(cookie.getMaxAge()).andReturn(SimpleCookie.DEFAULT_MAX_AGE);
  expect(cookie.getVersion()).andReturn(SimpleCookie.DEFAULT_VERSION);
  expect(cookie.isSecure()).andReturn(false);
  expect(cookie.isHttpOnly()).andReturn(true);
  UsernamePasswordToken token=new UsernamePasswordToken("user","secret");
  token.setRememberMe(true);
  AuthenticationInfo account=new SimpleAuthenticationInfo("user","secret","test");
  replay(mockSubject);
  replay(mockRequest);
  replay(cookie);
  mgr.onSuccessfulLogin(mockSubject,token,account);
  verify(mockRequest);
  verify(mockSubject);
  verify(cookie);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.DefaultWebSecurityManagerTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shiroSessionModeInit(){
  sm.setSessionMode(DefaultWebSecurityManager.NATIVE_SESSION_MODE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.servlet.SimpleCookieTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullContextPath() throws Exception {
  testRootContextPath(null);
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmptyContextPath() throws Exception {
  testRootContextPath("");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
