<h3><span class=" glyphicon glyphicon-tag"/>&nbspInternalCallVerifier</h3><kbd>Verifies values of objects/variables related to AUT calls</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.shiro.aop.AnnotationResolverTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testAnnotationFoundFromMethod() throws SecurityException, NoSuchMethodException {
  MethodInvocation methodInvocation=createMock(MethodInvocation.class);
  Method method=MyFixture.class.getDeclaredMethod("operateThat");
  expect(methodInvocation.getMethod()).andReturn(method);
  replay(methodInvocation);
  assertNotNull(annotationResolver.getAnnotation(methodInvocation,RequiresUser.class));
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testAnnotationFoundFromClass() throws SecurityException, NoSuchMethodException {
  MyFixture myFixture=new MyFixture();
  MethodInvocation methodInvocation=createMock(MethodInvocation.class);
  Method method=MyFixture.class.getDeclaredMethod("operateThis");
  expect(methodInvocation.getMethod()).andReturn(method);
  expect(methodInvocation.getThis()).andReturn(myFixture);
  replay(methodInvocation);
  assertNotNull(annotationResolver.getAnnotation(methodInvocation,RequiresRoles.class));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.AbstractAuthenticatorTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Ensures a non-null <tt>Subject</tt> instance is returned from the authenticate() method after a valid
 * authentication attempt (i.e. the subclass's doAuthenticate implementation returns a valid, non-null
 * AuthenticationInfo object).
 */
@Test public void nonNullAuthenticationInfoAfterAuthenticate(){
  AuthenticationInfo authcInfo=abstractAuthenticator.authenticate(newToken());
  assertNotNull(authcInfo);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.SimpleAuthenticationInfoTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("serial") @Test public void testMergeWithImmutablePrincipalCollection(){
  SimpleAuthenticationInfo aggregate=new SimpleAuthenticationInfo();
  PrincipalCollection principalCollection=new PrincipalCollection(){
    @SuppressWarnings("unchecked") public List asList(){
      return null;
    }
    @SuppressWarnings("unchecked") public Set asSet(){
      return null;
    }
    public <T>Collection<T> byType(    Class<T> type){
      return null;
    }
    @SuppressWarnings("unchecked") public Collection fromRealm(    String realmName){
      Collection principals=new HashSet();
      principals.add("testprincipal");
      return principals;
    }
    public Object getPrimaryPrincipal(){
      return null;
    }
    public Set<String> getRealmNames(){
      Set<String> realms=new HashSet<String>();
      realms.add("testrealm");
      return realms;
    }
    public boolean isEmpty(){
      return false;
    }
    public <T>T oneByType(    Class<T> type){
      return null;
    }
    @SuppressWarnings("unchecked") public Iterator iterator(){
      return null;
    }
  }
;
  aggregate.setPrincipals(principalCollection);
  SimpleAuthenticationInfo local=new SimpleAuthenticationInfo("username","password","testRealm");
  aggregate.merge(local);
  assertEquals(2,aggregate.getPrincipals().asList().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.credential.HashedCredentialsMatcherTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test backwards compatibility of salted credentials before
 * <a href="https://issues.apache.org/jira/browse/SHIRO-186">SHIRO-186</a> edits.
 */
@Test public void testBackwardsCompatibleSaltedAuthenticationInfo(){
  HashedCredentialsMatcher matcher=new HashedCredentialsMatcher(Sha1Hash.ALGORITHM_NAME);
  matcher.setHashSalted(true);
  final String username="username";
  final String password="password";
  final Object hashedPassword=new Sha1Hash(password,username).getBytes();
  AuthenticationInfo account=new AuthenticationInfo(){
    public PrincipalCollection getPrincipals(){
      return new SimplePrincipalCollection(username,"realmName");
    }
    public Object getCredentials(){
      return hashedPassword;
    }
  }
;
  AuthenticationToken token=new UsernamePasswordToken("username","password");
  assertTrue(matcher.doCredentialsMatch(token,account));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authc.pam.AllSuccessfulStrategyTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void beforeAllAttempts(){
  AuthenticationInfo info=strategy.beforeAllAttempts(null,null);
  assertNotNull(info);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.permission.DomainPermissionTest </h4><pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsConstructorWithMultipleActions(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1,action2,action3");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals(2,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsTargetsConstructorWithSingleActionAndTarget(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1","target1");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  set=p.getTargets();
  assertNotNull(set);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
  parts=p.getParts();
  assertEquals(3,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  set=parts.get(2);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConstructor(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  String entry;
  p=new DomainPermission();
  assertTrue("domain".equals(p.getDomain()));
  set=p.getActions();
  assertNull(set);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals("Number of parts",1,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  entry=set.iterator().next();
  assertEquals("domain",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsTargetsConstructorWithMultipleActionsAndTargets(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1,action2,action3","target1,target2,target3");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
  set=p.getTargets();
  assertNotNull(set);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
  entry=iterator.next();
  assertEquals("target2",entry);
  entry=iterator.next();
  assertEquals("target3",entry);
  parts=p.getParts();
  assertEquals(3,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  entry=iterator.next();
  assertEquals("action2",entry);
  entry=iterator.next();
  assertEquals("action3",entry);
  set=parts.get(2);
  assertEquals(3,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("target1",entry);
  entry=iterator.next();
  assertEquals("target2",entry);
  entry=iterator.next();
  assertEquals("target3",entry);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testActionsConstructorWithSingleAction(){
  DomainPermission p;
  List<Set<String>> parts;
  Set<String> set;
  Iterator<String> iterator;
  String entry;
  p=new DomainPermission("action1");
  assertEquals("domain",p.getDomain());
  set=p.getActions();
  assertNotNull(set);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
  set=p.getTargets();
  assertNull(set);
  parts=p.getParts();
  assertEquals(2,parts.size());
  set=parts.get(0);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("domain",entry);
  set=parts.get(1);
  assertEquals(1,set.size());
  iterator=set.iterator();
  entry=iterator.next();
  assertEquals("action1",entry);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.authz.permission.WildcardPermissionTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testLists(){
  WildcardPermission p1, p2, p3;
  p1=new WildcardPermission("one,two");
  p2=new WildcardPermission("one");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("one,two,three");
  p2=new WildcardPermission("one,three");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("one,two:one,two,three");
  p2=new WildcardPermission("one:three");
  p3=new WildcardPermission("one:two,three");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  assertTrue(p1.implies(p3));
  assertFalse(p2.implies(p3));
  assertTrue(p3.implies(p2));
  p1=new WildcardPermission("one,two,three:one,two,three:one,two");
  p2=new WildcardPermission("one:three:two");
  assertTrue(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("one");
  p2=new WildcardPermission("one:two,three,four");
  p3=new WildcardPermission("one:two,three,four:five:six:seven");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertFalse(p2.implies(p1));
  assertFalse(p3.implies(p1));
  assertTrue(p2.implies(p3));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testWildcards(){
  WildcardPermission p1, p2, p3, p4, p5, p6, p7, p8;
  p1=new WildcardPermission("*");
  p2=new WildcardPermission("one");
  p3=new WildcardPermission("one:two");
  p4=new WildcardPermission("one,two:three,four");
  p5=new WildcardPermission("one,two:three,four,five:six:seven,eight");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  p1=new WildcardPermission("newsletter:*");
  p2=new WildcardPermission("newsletter:read");
  p3=new WildcardPermission("newsletter:read,write");
  p4=new WildcardPermission("newsletter:*");
  p5=new WildcardPermission("newsletter:*:*");
  p6=new WildcardPermission("newsletter:*:read");
  p7=new WildcardPermission("newsletter:write:*");
  p8=new WildcardPermission("newsletter:read,write:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  assertTrue(p1.implies(p6));
  assertTrue(p1.implies(p7));
  assertTrue(p1.implies(p8));
  p1=new WildcardPermission("newsletter:*:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  assertTrue(p1.implies(p6));
  assertTrue(p1.implies(p7));
  assertTrue(p1.implies(p8));
  p1=new WildcardPermission("newsletter:*:*:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p3));
  assertTrue(p1.implies(p4));
  assertTrue(p1.implies(p5));
  assertTrue(p1.implies(p6));
  assertTrue(p1.implies(p7));
  assertTrue(p1.implies(p8));
  p1=new WildcardPermission("newsletter:*:read");
  p2=new WildcardPermission("newsletter:123:read");
  p3=new WildcardPermission("newsletter:123,456:read,write");
  p4=new WildcardPermission("newsletter:read");
  p5=new WildcardPermission("newsletter:read,write");
  p6=new WildcardPermission("newsletter:123:read:write");
  assertTrue(p1.implies(p2));
  assertFalse(p1.implies(p3));
  assertFalse(p1.implies(p4));
  assertFalse(p1.implies(p5));
  assertTrue(p1.implies(p6));
  p1=new WildcardPermission("newsletter:*:read:*");
  assertTrue(p1.implies(p2));
  assertTrue(p1.implies(p6));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testNamed(){
  WildcardPermission p1, p2;
  p1=new WildcardPermission("something");
  p2=new WildcardPermission("something");
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("something");
  p2=new WildcardPermission("SOMETHING");
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("something");
  p2=new WildcardPermission("else");
  assertFalse(p1.implies(p2));
  assertFalse(p2.implies(p1));
  p1=new WildcardPermission("BLAHBLAH",false);
  p2=new WildcardPermission("BLAHBLAH",false);
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("BLAHBLAH",false);
  p2=new WildcardPermission("bLAHBLAH",false);
  assertTrue(p1.implies(p2));
  assertTrue(p2.implies(p1));
  p1=new WildcardPermission("BLAHBLAH",false);
  p2=new WildcardPermission("whatwhat",false);
  assertFalse(p1.implies(p2));
  assertFalse(p2.implies(p1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.cache.ehcache.EhCacheManagerTest </h4><pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLazyCacheManagerCreationWithoutCallingInit(){
  net.sf.ehcache.CacheManager ehCacheManager=cacheManager.getCacheManager();
  assertNull(ehCacheManager);
  Cache<String,String> cache=cacheManager.getCache("test");
  ehCacheManager=cacheManager.getCacheManager();
  assertNotNull(ehCacheManager);
  assertNotNull(cache);
  cache.put("hello","world");
  String value=cache.get("hello");
  assertNotNull(value);
  assertEquals(value,"world");
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCacheManagerCreationDuringInit(){
  net.sf.ehcache.CacheManager ehCacheManager=cacheManager.getCacheManager();
  assertNull(ehCacheManager);
  cacheManager.init();
  ehCacheManager=cacheManager.getCacheManager();
  assertNotNull(ehCacheManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.BeanTypeListenerTest </h4><pre class="type-2 type-15 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPropertySetting() throws Exception {
  IMocksControl control=createControl();
  TypeEncounter<SomeInjectableBean> encounter=control.createMock(TypeEncounter.class);
  Provider<Injector> injectorProvider=control.createMock(Provider.class);
  Injector injector=control.createMock(Injector.class);
  expect(encounter.getProvider(Injector.class)).andReturn(injectorProvider);
  expect(injectorProvider.get()).andReturn(injector).anyTimes();
  Capture<MembersInjector<SomeInjectableBean>> capture=new Capture<MembersInjector<SomeInjectableBean>>();
  encounter.register(and(anyObject(MembersInjector.class),capture(capture)));
  SecurityManager securityManager=control.createMock(SecurityManager.class);
  String property="myPropertyValue";
  expect(injector.getInstance(Key.get(SecurityManager.class))).andReturn(securityManager);
  expect(injector.getInstance(Key.get(String.class,Names.named("shiro.myProperty")))).andReturn(property);
  expect(injector.getInstance(Key.get(String.class,Names.named("shiro.unavailableProperty")))).andThrow(new ConfigurationException(Collections.singleton(new Message("Not Available!"))));
  expect((Map)injector.getInstance(BeanTypeListener.MAP_KEY)).andReturn(Collections.EMPTY_MAP).anyTimes();
  control.replay();
  BeanTypeListener underTest=new BeanTypeListener();
  underTest.hear(TypeLiteral.get(SomeInjectableBean.class),encounter);
  SomeInjectableBean bean=new SomeInjectableBean();
  capture.getValue().injectMembers(bean);
  assertSame(securityManager,bean.securityManager);
  assertSame(property,bean.myProperty);
  assertNull(bean.unavailableProperty);
  control.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroMatchersTest </h4><pre class="type-13 type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testTypeLiteral() throws Exception {
  Matcher<Class> classMatcher=createMock(Matcher.class);
  expect(classMatcher.matches(MatchingClass.class)).andReturn(true);
  expect(classMatcher.matches(NotMatchingClass.class)).andReturn(false);
  replay(classMatcher);
  Matcher<TypeLiteral> underTest=ShiroMatchers.typeLiteral(classMatcher);
  assertTrue(underTest.matches(TypeLiteral.get(MatchingClass.class)));
  assertFalse(underTest.matches(TypeLiteral.get(NotMatchingClass.class)));
  verify(classMatcher);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroModuleTest </h4><pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindSecurityManager(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindSecurityManager(    AnnotatedBindingBuilder<? super SecurityManager> bind){
      bind.to(MyDefaultSecurityManager.class);
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertTrue(securityManager instanceof MyDefaultSecurityManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindEnvironment(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
      expose(Environment.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindEnvironment(    AnnotatedBindingBuilder<Environment> bind){
      bind.to(MyEnvironment.class);
    }
  }
);
  Environment environment=injector.getInstance(Environment.class);
  assertNotNull(environment);
  assertTrue(environment instanceof MyEnvironment);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testConfigure(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  AuthenticationToken authToken=createMock(AuthenticationToken.class);
  AuthenticationInfo info=new SimpleAuthenticationInfo("mockUser","password","mockRealm");
  expect(mockRealm.supports(authToken)).andReturn(true);
  expect(mockRealm.getAuthenticationInfo(authToken)).andReturn(info);
  replay(mockRealm);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  SecurityUtils.setSecurityManager(securityManager);
  final Subject subject=new Subject.Builder(securityManager).buildSubject();
  securityManager.login(subject,authToken);
  verify(mockRealm);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindSessionManager(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindSessionManager(    AnnotatedBindingBuilder<SessionManager> bind){
      bind.to(MyDefaultSessionManager.class);
    }
  }
);
  DefaultSecurityManager securityManager=(DefaultSecurityManager)injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertNotNull(securityManager.getSessionManager());
  assertTrue(securityManager.getSessionManager() instanceof MyDefaultSessionManager);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void basicInstantiation(){
  final MockRealm mockRealm=createMock(MockRealm.class);
  Injector injector=Guice.createInjector(new ShiroModule(){
    @Override protected void configureShiro(){
      bindRealm().to(MockRealm.class);
    }
    @Provides public MockRealm createRealm(){
      return mockRealm;
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.ShiroSessionScopeTest </h4><pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testScope() throws Exception {
  Subject subject=createMock(Subject.class);
  try {
    final Key<SomeClass> key=Key.get(SomeClass.class);
    Provider<SomeClass> mockProvider=createMock(Provider.class);
    Session session=createMock(Session.class);
    SomeClass retuned=new SomeClass();
    expect(subject.getPrincipal()).andReturn("testUser").anyTimes();
    expect(subject.getSession()).andReturn(session);
    expect(session.getAttribute(key)).andReturn(null);
    expect(mockProvider.get()).andReturn(retuned);
    expect(subject.getSession()).andReturn(session);
    expect(session.getAttribute(key)).andReturn(retuned);
    replay(subject,mockProvider,session);
    ThreadContext.bind(subject);
    ShiroSessionScope underTest=new ShiroSessionScope();
    assertSame(retuned,underTest.scope(key,mockProvider).get());
    assertSame(retuned,underTest.scope(key,mockProvider).get());
    verify(subject,mockProvider,session);
  }
  finally {
    ThreadContext.unbindSubject();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.aop.AopAllianceMethodInterceptorAdapterTest </h4><pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testInvoke() throws Throwable {
  MethodInvocation allianceInvocation=createMock(MethodInvocation.class);
  MethodInterceptor mockShiroInterceptor=createMock(MethodInterceptor.class);
  expect(mockShiroInterceptor.invoke(anyObject(AopAllianceMethodInvocationAdapter.class))).andAnswer(new IAnswer(){
    public Object answer() throws Throwable {
      return getCurrentArguments()[0];
    }
  }
);
  final Object expectedValue=new Object();
  expect(allianceInvocation.proceed()).andReturn(expectedValue);
  replay(mockShiroInterceptor,allianceInvocation);
  AopAllianceMethodInterceptorAdapter underTest=new AopAllianceMethodInterceptorAdapter(mockShiroInterceptor);
  Object invocation=underTest.invoke(allianceInvocation);
  Object value=((AopAllianceMethodInvocationAdapter)invocation).proceed();
  assertSame("Adapter invocation returned a different value.",expectedValue,value);
  verify(mockShiroInterceptor,allianceInvocation);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.aop.AopAllianceMethodInvocationAdapterTest </h4><pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGetMethod() throws Exception {
  MethodInvocation mock=createMock(MethodInvocation.class);
  Method method=AopAllianceMethodInvocationAdapterTest.class.getMethod("testGetMethod");
  expect(mock.getMethod()).andReturn(method);
  AopAllianceMethodInvocationAdapter underTest=new AopAllianceMethodInvocationAdapter(mock);
  replay(mock);
  assertSame(method,underTest.getMethod());
  verify(mock);
}

</code></pre>

<br>
<pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGetThis() throws Exception {
  MethodInvocation mock=createMock(MethodInvocation.class);
  Object value=new Object();
  expect(mock.getThis()).andReturn(value);
  AopAllianceMethodInvocationAdapter underTest=new AopAllianceMethodInvocationAdapter(mock);
  replay(mock);
  assertSame(value,underTest.getThis());
  verify(mock);
}

</code></pre>

<br>
<pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testProceed() throws Throwable {
  MethodInvocation mock=createMock(MethodInvocation.class);
  Object value=new Object();
  expect(mock.proceed()).andReturn(value);
  AopAllianceMethodInvocationAdapter underTest=new AopAllianceMethodInvocationAdapter(mock);
  replay(mock);
  assertSame(value,underTest.proceed());
  verify(mock);
}

</code></pre>

<br>
<pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGetArguments() throws Exception {
  MethodInvocation mock=createMock(MethodInvocation.class);
  Object[] args=new Object[0];
  expect(mock.getArguments()).andReturn(args);
  AopAllianceMethodInvocationAdapter underTest=new AopAllianceMethodInvocationAdapter(mock);
  replay(mock);
  assertSame(args,underTest.getArguments());
  verify(mock);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.aop.ShiroAopModuleTest </h4><pre class="type-11 type-8 type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindShiroInterceptor(){
  ShiroAopModule underTest=new ShiroAopModule(){
    @Override protected void configureInterceptors(    AnnotationResolver resolver){
      bindShiroInterceptor(new MyAnnotationMethodInterceptor());
    }
  }
;
  List<Element> elements=Elements.getElements(underTest);
  for (  Element element : elements) {
    if (element instanceof InterceptorBinding) {
      InterceptorBinding binding=(InterceptorBinding)element;
      assertTrue(binding.getClassMatcher().matches(getClass()));
      Method method=null;
      Class<? extends Annotation> theAnnotation=null;
      for (      Class<? extends Annotation> annotation : protectedMethods.keySet()) {
        if (binding.getMethodMatcher().matches(protectedMethods.get(annotation))) {
          method=protectedMethods.get(annotation);
          theAnnotation=annotation;
          protectedMethods.remove(annotation);
          break;
        }
      }
      if (method == null) {
        fail("Did not expect interceptor binding " + binding.getInterceptors());
      }
      List<MethodInterceptor> interceptors=binding.getInterceptors();
      assertEquals(1,interceptors.size());
      assertTrue(interceptors.get(0) instanceof AopAllianceMethodInterceptorAdapter);
      assertTrue(interceptorTypes.get(theAnnotation).isInstance(((AopAllianceMethodInterceptorAdapter)interceptors.get(0)).shiroInterceptor));
    }
  }
  assertTrue("Not all interceptors were bound.",protectedMethods.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.AbstractInjectionProviderTest </h4><pre class="type-11 type-8 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDependencies() throws Exception {
  AbstractInjectionProvider<SomeInjectedClass> underTest=new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class));
  boolean foundC1=false;
  boolean foundC2=false;
  boolean foundV1=false;
  boolean foundV2=false;
  boolean foundF1=false;
  for (  Dependency<?> dependency : underTest.getDependencies()) {
    if (dependency.getInjectionPoint().getMember() instanceof Constructor) {
      if (dependency.getParameterIndex() == 0 && dependency.getKey().equals(keyC1)) {
        foundC1=true;
      }
 else       if (dependency.getParameterIndex() == 1 && dependency.getKey().equals(keyC2)) {
        foundC2=true;
      }
 else {
        fail("Did not expect constructor dependency with key " + dependency.getKey() + " at parameter index "+ dependency.getParameterIndex());
      }
    }
 else     if (dependency.getInjectionPoint().getMember() instanceof Method) {
      if (dependency.getKey().equals(keyV1)) {
        foundV1=true;
      }
 else       if (dependency.getKey().equals(keyV2)) {
        foundV2=true;
      }
 else {
        fail("Did not expect method dependency with key " + dependency.getKey());
      }
    }
 else     if (dependency.getInjectionPoint().getMember() instanceof Field) {
      if (dependency.getKey().equals(keyF1)) {
        foundF1=true;
      }
 else {
        fail("Did not expect field dependency with key " + dependency.getKey());
      }
    }
 else {
      fail("Did not expect dependency with key " + dependency.getKey());
    }
  }
  assertTrue("Did not find dependency C1",foundC1);
  assertTrue("Did not find dependency C2",foundC2);
  assertTrue("Did not find dependency V1",foundV1);
  assertTrue("Did not find dependency V2",foundV2);
  assertTrue("Did not find dependency F1",foundF1);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGet() throws Exception {
  Injector mockInjector=createMock(Injector.class);
  Object c1=new Object();
  Object c2=new Object();
  final AtomicBoolean postProcessCalled=new AtomicBoolean(false);
  expect(mockInjector.getInstance(keyC1)).andReturn(c1);
  expect(mockInjector.getInstance(keyC2)).andReturn(c2);
  mockInjector.injectMembers(anyObject(SomeInjectedClass.class));
  replay(mockInjector);
  AbstractInjectionProvider<SomeInjectedClass> underTest=new AbstractInjectionProvider<SomeInjectedClass>(Key.get(SomeInjectedClass.class)){
    @Override protected SomeInjectedClass postProcess(    SomeInjectedClass someInjectedClass){
      postProcessCalled.set(true);
      return super.postProcess(someInjectedClass);
    }
  }
;
  underTest.injector=mockInjector;
  SomeInjectedClass got=underTest.get();
  assertEquals("Wrong parameter passed to constructor (index 0).",c1,got.c1);
  assertEquals("Wrong parameter passed to constructor (index 1).",c2,got.c2);
  assertTrue("postProcess method was not called.",postProcessCalled.get());
  verify(mockInjector);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.FilterChainResolverProviderTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDependencies() throws Exception {
  Set<Dependency<?>> dependencySet=underTest.getDependencies();
  assertEquals(4,dependencySet.size());
  assertTrue("Dependency set doesn't contain key1a.",dependencySet.contains(Dependency.get(key1a)));
  assertTrue("Dependency set doesn't contain key1b.",dependencySet.contains(Dependency.get(key1b)));
  assertTrue("Dependency set doesn't contain key1c.",dependencySet.contains(Dependency.get(key1c)));
  assertTrue("Dependency set doesn't contain key2a.",dependencySet.contains(Dependency.get(key2a)));
}

</code></pre>

<br>
<pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testGet() throws Exception {
  Injector injector=createMock(Injector.class);
  PatternMatcher patternMatcher=createMock(PatternMatcher.class);
  underTest.injector=injector;
  underTest.setPatternMatcher(patternMatcher);
  FilterChainResolver resolver=underTest.get();
  Field chainsField=SimpleFilterChainResolver.class.getDeclaredField("chains");
  chainsField.setAccessible(true);
  Field injectorField=SimpleFilterChainResolver.class.getDeclaredField("injector");
  injectorField.setAccessible(true);
  Field patternMatcherField=SimpleFilterChainResolver.class.getDeclaredField("patternMatcher");
  patternMatcherField.setAccessible(true);
  assertSame(chains,chainsField.get(resolver));
  assertSame(injector,injectorField.get(resolver));
  assertSame(patternMatcher,patternMatcherField.get(resolver));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.FilterConfigTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testSimple() throws Exception {
  FilterChainResolver resolver=setupResolver();
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  HttpServletRequest request=createMockRequest("/index.html");
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNotNull(resolved);
  verify(request);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testWithConfig() throws Exception {
  FilterChainResolver resolver=setupResolver();
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  HttpServletRequest request=createMockRequest("/index2.html");
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNotNull(resolved);
  verify(request);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.GuiceShiroFilterTest </h4><pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testConstructor(){
  WebSecurityManager securityManager=createMock(WebSecurityManager.class);
  FilterChainResolver filterChainResolver=createMock(FilterChainResolver.class);
  GuiceShiroFilter underTest=new GuiceShiroFilter(securityManager,filterChainResolver);
  assertSame(securityManager,underTest.getSecurityManager());
  assertSame(filterChainResolver,underTest.getFilterChainResolver());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.ShiroWebModuleTest </h4><pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void basicInstantiation(){
  final ShiroModuleTest.MockRealm mockRealm=createMock(ShiroModuleTest.MockRealm.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Injector injector=Guice.createInjector(new ShiroWebModule(servletContext){
    @Override protected void configureShiroWeb(){
      bindRealm().to(ShiroModuleTest.MockRealm.class);
      expose(SessionManager.class);
    }
    @Provides public ShiroModuleTest.MockRealm createRealm(){
      return mockRealm;
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertTrue(securityManager instanceof WebSecurityManager);
  SessionManager sessionManager=injector.getInstance(SessionManager.class);
  assertNotNull(sessionManager);
  assertTrue(sessionManager instanceof ServletContainerSessionManager);
  assertTrue(((DefaultWebSecurityManager)securityManager).getSessionManager() instanceof ServletContainerSessionManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindWebSecurityManager() throws Exception {
  final ShiroModuleTest.MockRealm mockRealm=createMock(ShiroModuleTest.MockRealm.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Injector injector=Guice.createInjector(new ShiroWebModule(servletContext){
    @Override protected void configureShiroWeb(){
      bindRealm().to(ShiroModuleTest.MockRealm.class);
      expose(WebSecurityManager.class);
    }
    @Provides public ShiroModuleTest.MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindWebSecurityManager(    AnnotatedBindingBuilder<? super WebSecurityManager> bind){
      bind.to(MyDefaultWebSecurityManager.class);
    }
  }
);
  SecurityManager securityManager=injector.getInstance(SecurityManager.class);
  assertNotNull(securityManager);
  assertTrue(securityManager instanceof MyDefaultWebSecurityManager);
  WebSecurityManager webSecurityManager=injector.getInstance(WebSecurityManager.class);
  assertNotNull(webSecurityManager);
  assertTrue(webSecurityManager instanceof MyDefaultWebSecurityManager);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBindWebEnvironment() throws Exception {
  final ShiroModuleTest.MockRealm mockRealm=createMock(ShiroModuleTest.MockRealm.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Injector injector=Guice.createInjector(new ShiroWebModule(servletContext){
    @Override protected void configureShiroWeb(){
      bindRealm().to(ShiroModuleTest.MockRealm.class);
      expose(WebEnvironment.class);
      expose(Environment.class);
    }
    @Provides public ShiroModuleTest.MockRealm createRealm(){
      return mockRealm;
    }
    @Override protected void bindWebEnvironment(    AnnotatedBindingBuilder<? super WebEnvironment> bind){
      bind.to(MyWebEnvironment.class);
    }
  }
);
  Environment environment=injector.getInstance(Environment.class);
  assertNotNull(environment);
  assertTrue(environment instanceof MyWebEnvironment);
  WebEnvironment webEnvironment=injector.getInstance(WebEnvironment.class);
  assertNotNull(webEnvironment);
  assertTrue(webEnvironment instanceof MyWebEnvironment);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.SimpleFilterChainResolverTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetChain() throws Exception {
  IMocksControl ctrl=createStrictControl();
  Injector injector=ctrl.createMock(Injector.class);
  Map<String,Key<? extends Filter>[]> chainMap=new LinkedHashMap<String,Key<? extends Filter>[]>();
  final String chainOne="one";
  final String chainTwo="two";
  final String chainThree="three";
  final Key<? extends Filter> key1a=Key.get(Filter.class,Names.named("key1a"));
  final Key<? extends Filter> key1b=Key.get(Filter.class,Names.named("key1b"));
  final Key<? extends Filter> key2a=Key.get(Filter.class,Names.named("key2a"));
  final Key<? extends Filter> key2b=Key.get(Filter.class,Names.named("key2b"));
  final Key<? extends Filter> key3a=Key.get(Filter.class,Names.named("key3a"));
  final Key<? extends Filter> key3b=Key.get(Filter.class,Names.named("key3b"));
  chainMap.put(chainOne,new Key[]{key1a,key1b});
  chainMap.put(chainTwo,new Key[]{key2a,key2b});
  chainMap.put(chainThree,new Key[]{key3a,key3b});
  PatternMatcher patternMatcher=ctrl.createMock(PatternMatcher.class);
  ServletRequest request=ctrl.createMock(HttpServletRequest.class);
  ServletResponse response=ctrl.createMock(HttpServletResponse.class);
  FilterChain originalChain=ctrl.createMock(FilterChain.class);
  expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn("/context");
  expect(request.getAttribute(WebUtils.INCLUDE_REQUEST_URI_ATTRIBUTE)).andReturn("/mychain");
  expect(request.getCharacterEncoding()).andStubReturn(null);
  expect(patternMatcher.matches(chainOne,"/mychain")).andReturn(false);
  expect(patternMatcher.matches(chainTwo,"/mychain")).andReturn(true);
  Filter filter2a=ctrl.createMock(Filter.class);
  Filter filter2b=ctrl.createMock(Filter.class);
  expect((Filter)injector.getInstance(key2a)).andReturn(filter2a);
  filter2a.doFilter(same(request),same(response),anyObject(FilterChain.class));
  expect((Filter)injector.getInstance(key2b)).andReturn(filter2b);
  filter2b.doFilter(same(request),same(response),anyObject(FilterChain.class));
  originalChain.doFilter(request,response);
  ctrl.replay();
  SimpleFilterChainResolver underTest=new SimpleFilterChainResolver(chainMap,injector,patternMatcher);
  FilterChain got=underTest.getChain(request,response,originalChain);
  got.doFilter(request,response);
  got.doFilter(request,response);
  got.doFilter(request,response);
  ctrl.verify();
  ctrl.reset();
  expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn("/context");
  expect(request.getAttribute(WebUtils.INCLUDE_REQUEST_URI_ATTRIBUTE)).andReturn("/nochain");
  expect(request.getCharacterEncoding()).andStubReturn(null);
  expect(patternMatcher.matches(chainOne,"/nochain")).andReturn(false);
  expect(patternMatcher.matches(chainTwo,"/nochain")).andReturn(false);
  expect(patternMatcher.matches(chainThree,"/nochain")).andReturn(false);
  ctrl.replay();
  assertNull("Expected no chain to match, did not get a null value in return.",underTest.getChain(request,response,originalChain));
  ctrl.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.guice.web.WebGuiceEnvironmentTest </h4><pre class="type-2 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testConstructor(){
  WebSecurityManager securityManager=createMock(WebSecurityManager.class);
  FilterChainResolver filterChainResolver=createMock(FilterChainResolver.class);
  ServletContext servletContext=createMock(ServletContext.class);
  Capture<WebGuiceEnvironment> capture=new Capture<WebGuiceEnvironment>();
  servletContext.setAttribute(eq(EnvironmentLoaderListener.ENVIRONMENT_ATTRIBUTE_KEY),and(anyObject(WebGuiceEnvironment.class),capture(capture)));
  replay(servletContext,securityManager,filterChainResolver);
  WebGuiceEnvironment underTest=new WebGuiceEnvironment(filterChainResolver,servletContext,securityManager);
  assertSame(securityManager,underTest.getSecurityManager());
  assertSame(filterChainResolver,underTest.getFilterChainResolver());
  assertSame(securityManager,underTest.getWebSecurityManager());
  assertSame(servletContext,underTest.getServletContext());
  assertSame(underTest,capture.getValue());
  verify(servletContext);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.jndi.JndiObjectFactoryTest </h4><pre class="type-13 type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetInstanceNoType() throws Exception {
  final String name="my/jndi/resource";
  final String returnValue="jndiString";
  JndiObjectFactory<String> underTest=new JndiObjectFactory<String>(){
    @Override protected Object lookup(    String jndiName) throws NamingException {
      assertEquals(name,jndiName);
      return new String(returnValue);
    }
  }
;
  underTest.setResourceName(name);
  assertEquals(returnValue,underTest.getInstance());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetInstanceWithType() throws Exception {
  final String name="my/jndi/resource";
  final String returnValue="jndiString";
  JndiObjectFactory<String> underTest=new JndiObjectFactory<String>(){
    @Override protected Object lookup(    String jndiName,    Class requiredType) throws NamingException {
      assertEquals(name,jndiName);
      assertEquals(String.class,requiredType);
      return new String(returnValue);
    }
  }
;
  underTest.setRequiredType(String.class);
  underTest.setResourceName(name);
  assertEquals(returnValue,underTest.getInstance());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.mgt.AbstractRememberMeManagerTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Tests the {@link AbstractRememberMeManager#getRememberedPrincipals(SubjectContext)} method
 * implementation when the internal{@link AbstractRememberMeManager#getRememberedSerializedIdentity(SubjectContext)} method
 * returns null or empty bytes.
 */
@Test public void testGetRememberedPrincipalsWithEmptySerializedBytes(){
  AbstractRememberMeManager rmm=new DummyRememberMeManager();
  PrincipalCollection principals=rmm.getRememberedPrincipals(new DefaultSubjectContext());
  assertNull(principals);
  rmm=new DummyRememberMeManager(){
    @Override protected byte[] getRememberedSerializedIdentity(    SubjectContext subjectContext){
      return null;
    }
  }
;
  principals=rmm.getRememberedPrincipals(new DefaultSubjectContext());
  assertNull(principals);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.mgt.DefaultSecurityManagerTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that validates functionality for issue
 * <a href="https://issues.apache.org/jira/browse/JSEC-22">JSEC-22</a>
 */
@Test public void testSubjectReuseAfterLogout(){
  Subject subject=SecurityUtils.getSubject();
  AuthenticationToken token=new UsernamePasswordToken("guest","guest");
  subject.login(token);
  assertTrue(subject.isAuthenticated());
  assertTrue("guest".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("guest"));
  Session session=subject.getSession();
  Serializable firstSessionId=session.getId();
  session.setAttribute("key","value");
  assertEquals(session.getAttribute("key"),"value");
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
  subject.login(new UsernamePasswordToken("lonestarr","vespa"));
  assertTrue(subject.isAuthenticated());
  assertTrue("lonestarr".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("goodguy"));
  assertNotNull(subject.getSession());
  assertFalse(firstSessionId.equals(subject.getSession().getId()));
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
}

</code></pre>

<br>
<pre class="type-8 type-2 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that validates functionality for issue
 * <a href="https://issues.apache.org/jira/browse/JSEC-46">JSEC-46</a>
 */
@Test public void testAutoCreateSessionAfterInvalidation(){
  Subject subject=SecurityUtils.getSubject();
  Session session=subject.getSession();
  Serializable origSessionId=session.getId();
  String key="foo";
  String value1="bar";
  session.setAttribute(key,value1);
  assertEquals(value1,session.getAttribute(key));
  session.setTimeout(50);
  try {
    Thread.sleep(150);
  }
 catch (  InterruptedException e) {
  }
  try {
    session.setTimeout(AbstractValidatingSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT);
    fail("Session should have expired.");
  }
 catch (  ExpiredSessionException expected) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConfig(){
  Subject subject=SecurityUtils.getSubject();
  AuthenticationToken token=new UsernamePasswordToken("guest","guest");
  subject.login(token);
  assertTrue(subject.isAuthenticated());
  assertTrue("guest".equals(subject.getPrincipal()));
  assertTrue(subject.hasRole("guest"));
  Session session=subject.getSession();
  session.setAttribute("key","value");
  assertEquals(session.getAttribute("key"),"value");
  subject.logout();
  assertNull(subject.getSession(false));
  assertNull(subject.getPrincipal());
  assertNull(subject.getPrincipals());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.mgt.VMSingletonDefaultSecurityManagerTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testVMSingleton(){
  DefaultSecurityManager sm=new DefaultSecurityManager();
  Ini ini=new Ini();
  Ini.Section section=ini.addSection(IniRealm.USERS_SECTION_NAME);
  section.put("guest","guest");
  sm.setRealm(new IniRealm(ini));
  SecurityUtils.setSecurityManager(sm);
  try {
    Subject subject=SecurityUtils.getSubject();
    AuthenticationToken token=new UsernamePasswordToken("guest","guest");
    subject.login(token);
    subject.getSession().setAttribute("key","value");
    assertTrue(subject.getSession().getAttribute("key").equals("value"));
    subject=SecurityUtils.getSubject();
    assertTrue(subject.isAuthenticated());
    assertTrue(subject.getSession().getAttribute("key").equals("value"));
  }
  finally {
    sm.destroy();
    SecurityUtils.setSecurityManager(null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.AuthorizingRealmTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullAuthzInfo(){
  AuthorizingRealm realm=new AuthorizingRealm(){
    protected AuthorizationInfo doGetAuthorizationInfo(    PrincipalCollection principals){
      return null;
    }
    protected AuthenticationInfo doGetAuthenticationInfo(    AuthenticationToken token) throws AuthenticationException {
      return null;
    }
  }
;
  Principal principal=new UsernamePrincipal("blah");
  PrincipalCollection pCollection=new SimplePrincipalCollection(principal,"nullAuthzRealm");
  List<Permission> permList=new ArrayList<Permission>();
  permList.add(new WildcardPermission("stringPerm1"));
  permList.add(new WildcardPermission("stringPerm2"));
  List<String> roleList=new ArrayList<String>();
  roleList.add("role1");
  roleList.add("role2");
  boolean thrown=false;
  try {
    realm.checkPermission(pCollection,"stringPermission");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermission(pCollection,new WildcardPermission("stringPermission"));
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermissions(pCollection,"stringPerm1","stringPerm2");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkPermissions(pCollection,permList);
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkRole(pCollection,"role1");
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  thrown=false;
  try {
    realm.checkRoles(pCollection,roleList);
  }
 catch (  UnauthorizedException e) {
    thrown=true;
  }
  assertTrue(thrown);
  assertFalse(realm.hasAllRoles(pCollection,roleList));
  assertFalse(realm.hasRole(pCollection,"role1"));
  assertArrayEquals(new boolean[]{false,false},realm.hasRoles(pCollection,roleList));
  assertFalse(realm.isPermitted(pCollection,"perm1"));
  assertFalse(realm.isPermitted(pCollection,new WildcardPermission("perm1")));
  assertArrayEquals(new boolean[]{false,false},realm.isPermitted(pCollection,"perm1","perm2"));
  assertArrayEquals(new boolean[]{false,false},realm.isPermitted(pCollection,permList));
  assertFalse(realm.isPermittedAll(pCollection,"perm1","perm2"));
  assertFalse(realm.isPermittedAll(pCollection,permList));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRealmWithRolePermissionResolver(){
  Principal principal=new UsernamePrincipal("rolePermResolver");
  PrincipalCollection pCollection=new SimplePrincipalCollection(principal,"testRealmWithRolePermissionResolver");
  AuthorizingRealm realm=new AllowAllRealm();
  realm.setRolePermissionResolver(new RolePermissionResolver(){
    public Collection<Permission> resolvePermissionsInRole(    String roleString){
      Collection<Permission> permissions=new HashSet<Permission>();
      if (roleString.equals(ROLE)) {
        permissions.add(new WildcardPermission(ROLE + ":perm1"));
        permissions.add(new WildcardPermission(ROLE + ":perm2"));
        permissions.add(new WildcardPermission("other:*:foo"));
      }
      return permissions;
    }
  }
);
  assertTrue(realm.hasRole(pCollection,ROLE));
  assertTrue(realm.isPermitted(pCollection,ROLE + ":perm1"));
  assertTrue(realm.isPermitted(pCollection,ROLE + ":perm2"));
  assertFalse(realm.isPermitted(pCollection,ROLE + ":perm3"));
  assertTrue(realm.isPermitted(pCollection,"other:bar:foo"));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateAccountOverride(){
  AuthorizingRealm realm=new AllowAllRealm(){
    @Override protected AuthenticationInfo buildAuthenticationInfo(    Object principal,    Object credentials){
      String username=(String)principal;
      UsernamePrincipal customPrincipal=new UsernamePrincipal(username);
      return new SimpleAccount(customPrincipal,credentials,getName());
    }
  }
;
  AuthenticationInfo info=realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),ROLE));
  Object principal=info.getPrincipals().getPrimaryPrincipal();
  assertTrue(principal instanceof UsernamePrincipal);
  assertEquals(USERNAME,((UsernamePrincipal)principal).getUsername());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultConfig(){
  AuthenticationInfo info=realm.getAuthenticationInfo(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),ROLE));
  Object principal=info.getPrincipals().getPrimaryPrincipal();
  assertTrue(principal instanceof UserIdPrincipal);
  UsernamePrincipal usernamePrincipal=info.getPrincipals().oneByType(UsernamePrincipal.class);
  assertTrue(usernamePrincipal.getUsername().equals(USERNAME));
  UserIdPrincipal userIdPrincipal=info.getPrincipals().oneByType(UserIdPrincipal.class);
  assertTrue(userIdPrincipal.getUserId() == USER_ID);
  String stringPrincipal=info.getPrincipals().oneByType(String.class);
  assertTrue(stringPrincipal.equals(USER_ID + USERNAME));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.activedirectory.ActiveDirectoryRealmTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultConfig(){
  String localhost="localhost";
  Subject subject=SecurityUtils.getSubject();
  subject.login(new UsernamePasswordToken(USERNAME,PASSWORD,localhost));
  assertTrue(subject.isAuthenticated());
  assertTrue(subject.hasRole(ROLE));
  UsernamePrincipal usernamePrincipal=subject.getPrincipals().oneByType(UsernamePrincipal.class);
  assertTrue(usernamePrincipal.getUsername().equals(USERNAME));
  UserIdPrincipal userIdPrincipal=subject.getPrincipals().oneByType(UserIdPrincipal.class);
  assertTrue(userIdPrincipal.getUserId() == USER_ID);
  assertTrue(realm.hasRole(subject.getPrincipals(),ROLE));
  subject.logout();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.jdbc.JDBCRealmTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPermissionPresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  realm.setPermissionsLookupEnabled(true);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertTrue(currentUser.isPermitted(testPermissionString));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRolePresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertTrue(currentUser.hasRole(testRole));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleNotPresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertFalse(currentUser.hasRole("Game Overall Director"));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testPermissionNotPresent() throws Exception {
  String testMethodName=name.getMethodName();
  JdbcRealm realm=realmMap.get(testMethodName);
  createDefaultSchema(testMethodName,false);
  realm.setSaltStyle(JdbcRealm.SaltStyle.NO_SALT);
  realm.setPermissionsLookupEnabled(true);
  Subject.Builder builder=new Subject.Builder(securityManager);
  Subject currentUser=builder.buildSubject();
  UsernamePasswordToken token=new UsernamePasswordToken(username,plainTextPassword);
  currentUser.login(token);
  Assert.assertFalse(currentUser.isPermitted("testDomain:testTarget:specialAction"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapContextFactoryTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAuthenticationMechanism(){
  String mech="MD5-DIGEST";
  factory.setAuthenticationMechanism(mech);
  assertEquals(mech,factory.getAuthenticationMechanism());
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReferral(){
  String referral="throw";
  factory.setReferral(referral);
  assertEquals(referral,factory.getReferral());
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCustomEnvironment(){
  Map<String,String> map=new HashMap<String,String>();
  map.put("foo","bar");
  factory.setEnvironment(map);
  assertEquals("bar",factory.getEnvironment().get("foo"));
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testSetEnvironmentPropertyNull(){
  factory.setAuthenticationMechanism("MD5-DIGEST");
  factory.setAuthenticationMechanism(null);
  assertNull(factory.getAuthenticationMechanism());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.ldap.JndiLdapRealmTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetUserDnWithOutPrefixAndSuffix(){
  realm=new JndiLdapRealm(){
    @Override protected String getUserDnPrefix(){
      return null;
    }
    @Override protected String getUserDnSuffix(){
      return null;
    }
  }
;
  String principal="foo";
  String userDn=realm.getUserDn(principal);
  assertEquals(principal,userDn);
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUserDnTemplate(){
  String template="uid={0},ou=users,dc=mycompany,dc=com";
  realm.setUserDnTemplate(template);
  assertEquals(template,realm.getUserDnTemplate());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultInstance(){
  assertTrue(realm.getCredentialsMatcher() instanceof AllowAllCredentialsMatcher);
  assertEquals(AuthenticationToken.class,realm.getAuthenticationTokenClass());
  assertTrue(realm.getContextFactory() instanceof JndiLdapContextFactory);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.text.IniRealmTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIniFileWithoutUsers(){
  IniRealm realm=new IniRealm();
  realm.setResourcePath("classpath:org/apache/shiro/realm/text/IniRealmTest.noUsers.ini");
  realm.init();
  assertTrue(realm.roleExists("admin"));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIniFile(){
  IniRealm realm=new IniRealm();
  realm.setResourcePath("classpath:org/apache/shiro/realm/text/IniRealmTest.simple.ini");
  realm.init();
  assertTrue(realm.roleExists("admin"));
  UsernamePasswordToken token=new UsernamePasswordToken("user1","user1");
  AuthenticationInfo info=realm.getAuthenticationInfo(token);
  assertNotNull(info);
  assertTrue(realm.hasRole(info.getPrincipals(),"admin"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.realm.text.TextConfigurationRealmTest </h4><pre class="type-13 type-8 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessRoleDefinitions() throws InterruptedException {
  realm=new TestRealm(){
    public void test(    Thread runnable) throws InterruptedException {
      ROLES_LOCK.writeLock().lock();
      try {
        runnable.start();
        Thread.sleep(500);
        assertFalse("role exists when it shouldn't",realm.roleExists("role1"));
      }
  finally {
        ROLES_LOCK.writeLock().unlock();
      }
    }
  }
;
  TestThread testThread=new TestThread(new Runnable(){
    public void run(){
      try {
        realm.processRoleDefinitions();
      }
 catch (      ParseException e) {
        fail("Unable to parse role definitions");
      }
    }
  }
);
  setRoles();
  Thread testTask=new Thread(testThread);
  realm.test(testTask);
  testTask.join(500);
  assertTrue("role doesn't exist when it should",realm.roleExists("role1"));
  testThread.test();
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testIsPermitted() throws InterruptedException {
  setUpForReadConfigurationTest();
  executeTest(new Runnable(){
    public void run(){
      PrincipalCollection principalCollection=new SimplePrincipalCollection("user1","realm1");
      assertTrue("permission not permitted when it should be",realm.isPermitted(principalCollection,"role1_permission1"));
      assertTrue("permission not permitted when it should be",realm.isPermittedAll(principalCollection,new String[]{"role1_permission1","role2_permission2"}));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRoleAndUserAccount() throws InterruptedException {
  setUpForReadConfigurationTest();
  executeTest(new Runnable(){
    public void run(){
      assertTrue("role not found when it was expected",realm.roleExists("role1"));
      assertTrue("user not found when it was expected",realm.accountExists("user1"));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testHasRole() throws InterruptedException {
  setUpForReadConfigurationTest();
  executeTest(new Runnable(){
    public void run(){
      PrincipalCollection principalCollection=new SimplePrincipalCollection("user1","realm1");
      assertTrue("principal doesn't have role when it should",realm.hasRole(principalCollection,"role2"));
      assertTrue("principal doesn't have all roles when it should",realm.hasAllRoles(principalCollection,Arrays.asList(new String[]{"role1","role2"})));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProcessUserDefinitions() throws InterruptedException {
  realm=new TestRealm(){
    public void test(    Thread runnable) throws InterruptedException {
      USERS_LOCK.writeLock().lock();
      try {
        runnable.start();
        Thread.sleep(500);
        assertFalse("account exists when it shouldn't",realm.accountExists("user1"));
      }
  finally {
        USERS_LOCK.writeLock().unlock();
      }
    }
  }
;
  TestThread testThread=new TestThread(new Runnable(){
    public void run(){
      try {
        realm.processUserDefinitions();
      }
 catch (      ParseException e) {
        fail("Unable to parse user definitions");
      }
    }
  }
);
  setUsers();
  Thread testTask=new Thread(testThread);
  realm.test(testTask);
  testTask.join(500);
  assertTrue("account doesn't exist when it should",realm.accountExists("user1"));
  testThread.test();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.samples.aspectj.bank.SecureBankServiceTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCloseAccount_withBalance() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Gerry Smith");
  makeDepositAndValidateAccount(accountId,385.00d,"Gerry Smith");
  logoutCurrentSubject();
  loginAsSuperviser();
  double closingBalance=service.closeAccount(accountId);
  Assert.assertEquals(385.00d,closingBalance);
  assertAccount("Gerry Smith",false,0.00d,2,accountId);
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCloseAccount_zeroBalance() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Chris Smith");
  logoutCurrentSubject();
  loginAsSuperviser();
  double closingBalance=service.closeAccount(accountId);
  Assert.assertEquals(0.00d,closingBalance);
  assertAccount("Chris Smith",false,0.00d,1,accountId);
}

</code></pre>

<br>
<pre class="type-2 type-10 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=InactiveAccountException.class) public void testCloseAccount_alreadyClosed() throws Exception {
  loginAsUser();
  long accountId=createAndValidateAccountFor("Chris Smith");
  logoutCurrentSubject();
  loginAsSuperviser();
  double closingBalance=service.closeAccount(accountId);
  Assert.assertEquals(0.00d,closingBalance);
  assertAccount("Chris Smith",false,0.00d,1,accountId);
  service.closeAccount(accountId);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.AbstractValidatingSessionManagerTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests that no memory leak exists on invalid sessions: expired or stopped
 * Verifies <a href="https://issues.apache.org/jira/browse/SHIRO-399">SHIRO-399</a>.
 */
@Test public void testNoMemoryLeakOnInvalidSessions() throws Exception {
  SessionListener sessionListener=new SessionListener(){
    public void onStart(    Session session){
      session.setAttribute("I love","Romania");
    }
    public void onStop(    Session session){
      tryToCleanSession(session);
    }
    public void onExpiration(    Session session){
      tryToCleanSession(session);
    }
    private void tryToCleanSession(    Session session){
      Collection keys=session.getAttributeKeys();
      for (      Object key : keys) {
        session.removeAttribute(key);
      }
    }
  }
;
  DefaultSessionManager sessionManager=new DefaultSessionManager();
  sessionManager.setSessionListeners(Arrays.asList(sessionListener));
  Session session=sessionManager.start(null);
  assertEquals(1,sessionManager.getActiveSessions().size());
  session.setTimeout(0L);
  Thread.sleep(1);
  sessionManager.validateSessions();
  assertEquals(0,sessionManager.getActiveSessions().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.DefaultSessionManagerTest </h4><pre class="type-2 type-12 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionListenerStopNotificationWithReadAttribute(){
  final boolean[] stopped=new boolean[1];
  final String[] value=new String[1];
  SessionListener listener=new SessionListenerAdapter(){
    public void onStop(    Session session){
      stopped[0]=true;
      value[0]=(String)session.getAttribute("foo");
    }
  }
;
  sm.getSessionListeners().add(listener);
  Session session=sm.start(null);
  session.setAttribute("foo","bar");
  sm.stop(new DefaultSessionKey(session.getId()));
  assertTrue(stopped[0]);
  assertEquals("bar",value[0]);
}

</code></pre>

<br>
<pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalTimeout(){
  long timeout=1000;
  sm.setGlobalSessionTimeout(timeout);
  Session session=sm.start(null);
  assertNotNull(session);
  assertNotNull(session.getId());
  assertEquals(session.getTimeout(),timeout);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionDeleteOnExpiration(){
  sm.setGlobalSessionTimeout(100);
  SessionDAO sessionDAO=createMock(SessionDAO.class);
  sm.setSessionDAO(sessionDAO);
  String sessionId1=UUID.randomUUID().toString();
  final SimpleSession session1=new SimpleSession();
  session1.setId(sessionId1);
  final Session[] activeSession=new SimpleSession[]{session1};
  sm.setSessionFactory(new SessionFactory(){
    public Session createSession(    SessionContext initData){
      return activeSession[0];
    }
  }
);
  expect(sessionDAO.create(eq(session1))).andReturn(sessionId1);
  sessionDAO.update(eq(session1));
  expectLastCall().anyTimes();
  replay(sessionDAO);
  Session session=sm.start(null);
  assertNotNull(session);
  verify(sessionDAO);
  reset(sessionDAO);
  expect(sessionDAO.readSession(sessionId1)).andReturn(session1).anyTimes();
  sessionDAO.update(eq(session1));
  replay(sessionDAO);
  sm.setTimeout(new DefaultSessionKey(sessionId1),1);
  verify(sessionDAO);
  reset(sessionDAO);
  sleep(20);
  expect(sessionDAO.readSession(sessionId1)).andReturn(session1);
  sessionDAO.update(eq(session1));
  sessionDAO.delete(session1);
  replay(sessionDAO);
  try {
    sm.getTimeout(new DefaultSessionKey(sessionId1));
    fail("Session with id [" + sessionId1 + "] should have expired due to timeout.");
  }
 catch (  ExpiredSessionException expected) {
  }
  verify(sessionDAO);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.DelegatingSessionTest </h4><pre class="type-8 type-2 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeout(){
  Serializable origId=session.getId();
  assertEquals(session.getTimeout(),AbstractSessionManager.DEFAULT_GLOBAL_SESSION_TIMEOUT);
  session.touch();
  session.setTimeout(100);
  assertEquals(100,session.getTimeout());
  sleep(150);
  try {
    session.getTimeout();
    fail("Session should have expired.");
  }
 catch (  ExpiredSessionException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.session.mgt.SimpleSessionTest </h4><pre class="type-13 type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultSerialization() throws Exception {
  SimpleSession session=new SimpleSession();
  long timeout=session.getTimeout();
  Date start=session.getStartTimestamp();
  Date lastAccess=session.getLastAccessTime();
  SimpleSession deserialized=serializeAndDeserialize(session);
  assertEquals(timeout,deserialized.getTimeout());
  assertEquals(start,deserialized.getStartTimestamp());
  assertEquals(lastAccess,deserialized.getLastAccessTime());
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void serializeExpired() throws IOException, ClassNotFoundException {
  SimpleSession session=new SimpleSession();
  session.setExpired(true);
  assertTrue(serializeAndDeserialize(session).isExpired());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.remoting.SecureRemoteInvocationFactoryTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testSessionManagerProxyStartRemoteInvocation() throws Exception {
  SecureRemoteInvocationFactory factory=new SecureRemoteInvocationFactory();
  MethodInvocation mi=createMock(MethodInvocation.class);
  Method startMethod=getMethod("start",SessionManager.class);
  expect(mi.getMethod()).andReturn(startMethod).anyTimes();
  Object[] args={"localhost"};
  expect(mi.getArguments()).andReturn(args).anyTimes();
  replay(mi);
  RemoteInvocation ri=factory.createRemoteInvocation(mi);
  verify(mi);
  assertNull(ri.getAttribute(SecureRemoteInvocationFactory.SESSION_ID_KEY));
}

</code></pre>

<br>
<pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSessionManagerProxyNonStartRemoteInvocation() throws Exception {
  SecureRemoteInvocationFactory factory=new SecureRemoteInvocationFactory();
  MethodInvocation mi=createMock(MethodInvocation.class);
  Method method=getMethod("getSession",SessionManager.class);
  expect(mi.getMethod()).andReturn(method).anyTimes();
  String dummySessionId=UUID.randomUUID().toString();
  SessionKey sessionKey=new DefaultSessionKey(dummySessionId);
  Object[] args={sessionKey};
  expect(mi.getArguments()).andReturn(args).anyTimes();
  replay(mi);
  RemoteInvocation ri=factory.createRemoteInvocation(mi);
  verify(mi);
  assertEquals(dummySessionId,ri.getAttribute(SecureRemoteInvocationFactory.SESSION_ID_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.spring.web.ShiroFilterFactoryBeanTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDefinition(){
  ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("org/apache/shiro/spring/web/ShiroFilterFactoryBeanTest.xml");
  AbstractShiroFilter shiroFilter=(AbstractShiroFilter)context.getBean("shiroFilter");
  PathMatchingFilterChainResolver resolver=(PathMatchingFilterChainResolver)shiroFilter.getFilterChainResolver();
  DefaultFilterChainManager fcManager=(DefaultFilterChainManager)resolver.getFilterChainManager();
  NamedFilterList chain=fcManager.getChain("/test");
  assertNotNull(chain);
  assertEquals(chain.size(),2);
  Filter[] filters=new Filter[chain.size()];
  filters=chain.toArray(filters);
  assertTrue(filters[0] instanceof DummyFilter);
  assertTrue(filters[1] instanceof FormAuthenticationFilter);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * Verifies fix for <a href="https://issues.apache.org/jira/browse/SHIRO-167">SHIRO-167</a>
 * @throws Exception if there is any unexpected error
 */
@Test public void testFilterDefinitionWithInit() throws Exception {
  ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("org/apache/shiro/spring/web/ShiroFilterFactoryBeanTest.xml");
  AbstractShiroFilter shiroFilter=(AbstractShiroFilter)context.getBean("shiroFilter");
  FilterConfig mockFilterConfig=createNiceMock(FilterConfig.class);
  ServletContext mockServletContext=createNiceMock(ServletContext.class);
  expect(mockFilterConfig.getServletContext()).andReturn(mockServletContext).anyTimes();
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  expect(mockRequest.getContextPath()).andReturn("/").anyTimes();
  expect(mockRequest.getRequestURI()).andReturn("/").anyTimes();
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  replay(mockFilterConfig);
  replay(mockServletContext);
  shiroFilter.init(mockFilterConfig);
  verify(mockServletContext);
  verify(mockFilterConfig);
  FilterChain filterChain=new FilterChain(){
    public void doFilter(    ServletRequest servletRequest,    ServletResponse servletResponse) throws IOException, ServletException {
      HttpServletRequest request=(HttpServletRequest)servletRequest;
      assertNotNull(request.getSession());
      assertNotNull(request.getSession().getServletContext());
    }
  }
;
  replay(mockRequest);
  replay(mockResponse);
  shiroFilter.doFilter(mockRequest,mockResponse,filterChain);
  verify(mockResponse);
  verify(mockRequest);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.subject.DelegatingSubjectTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRunAs(){
  Ini ini=new Ini();
  Ini.Section users=ini.addSection("users");
  users.put("user1","user1,role1");
  users.put("user2","user2,role2");
  users.put("user3","user3,role3");
  IniSecurityManagerFactory factory=new IniSecurityManagerFactory(ini);
  SecurityManager sm=factory.getInstance();
  Subject subject=new Subject.Builder(sm).buildSubject();
  subject.login(new UsernamePasswordToken("user1","user1"));
  assertFalse(subject.isRunAs());
  assertEquals("user1",subject.getPrincipal());
  assertTrue(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role3"));
  assertNull(subject.getPreviousPrincipals());
  subject.runAs(new SimplePrincipalCollection("user2",IniSecurityManagerFactory.INI_REALM_NAME));
  assertTrue(subject.isRunAs());
  assertEquals("user2",subject.getPrincipal());
  assertTrue(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role3"));
  PrincipalCollection previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user1"));
  subject.runAs(new SimplePrincipalCollection("user3",IniSecurityManagerFactory.INI_REALM_NAME));
  assertTrue(subject.isRunAs());
  assertEquals("user3",subject.getPrincipal());
  assertTrue(subject.hasRole("role3"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user2"));
  subject.releaseRunAs();
  assertTrue(subject.isRunAs());
  assertEquals("user2",subject.getPrincipal());
  assertTrue(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role3"));
  previous=subject.getPreviousPrincipals();
  assertFalse(previous == null || previous.isEmpty());
  assertTrue(previous.getPrimaryPrincipal().equals("user1"));
  subject.releaseRunAs();
  assertFalse(subject.isRunAs());
  assertEquals("user1",subject.getPrincipal());
  assertTrue(subject.hasRole("role1"));
  assertFalse(subject.hasRole("role2"));
  assertFalse(subject.hasRole("role3"));
  assertNull(subject.getPreviousPrincipals());
  subject.logout();
  LifecycleUtils.destroy(sm);
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExecuteCallable(){
  String username="jsmith";
  SecurityManager securityManager=createNiceMock(SecurityManager.class);
  PrincipalCollection identity=new SimplePrincipalCollection(username,"testRealm");
  final Subject sourceSubject=new DelegatingSubject(identity,true,null,null,securityManager);
  assertNull(ThreadContext.getSubject());
  assertNull(ThreadContext.getSecurityManager());
  Callable<String> callable=new Callable<String>(){
    public String call() throws Exception {
      Subject callingSubject=SecurityUtils.getSubject();
      assertNotNull(callingSubject);
      assertNotNull(SecurityUtils.getSecurityManager());
      assertEquals(callingSubject,sourceSubject);
      return "Hello " + callingSubject.getPrincipal();
    }
  }
;
  String response=sourceSubject.execute(callable);
  assertNotNull(response);
  assertEquals("Hello " + username,response);
  assertNull(ThreadContext.getSubject());
  assertNull(ThreadContext.getSecurityManager());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionStopThenStart(){
  String key="testKey";
  String value="testValue";
  DefaultSecurityManager sm=new DefaultSecurityManager();
  DelegatingSubject subject=new DelegatingSubject(sm);
  Session session=subject.getSession();
  session.setAttribute(key,value);
  assertTrue(session.getAttribute(key).equals(value));
  Serializable firstSessionId=session.getId();
  assertNotNull(firstSessionId);
  session.stop();
  session=subject.getSession();
  assertNotNull(session);
  assertNull(session.getAttribute(key));
  Serializable secondSessionId=session.getId();
  assertNotNull(secondSessionId);
  assertFalse(firstSessionId.equals(secondSessionId));
  subject.logout();
  sm.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.config.WebIniSecurityManagerFactoryTest </h4><pre class="type-13 type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that ensures the WebIniSecurityManagerFactory will automatically add the default
 * filters to the pool of beans before the INI configuration is interpreted.
 */
@Test public void testDefaultFiltersPresent(){
  Ini ini=new Ini();
  Ini.Section section=ini.addSection(IniSecurityManagerFactory.MAIN_SECTION_NAME);
  section.put("authc.loginUrl","/login.jsp");
  WebIniSecurityManagerFactory factory=new WebIniSecurityManagerFactory(ini);
  org.apache.shiro.mgt.SecurityManager sm=factory.getInstance();
  assertNotNull(sm);
  assertTrue(sm instanceof DefaultWebSecurityManager);
  Map<String,?> beans=factory.getBeans();
  for (  DefaultFilter defaultFilter : DefaultFilter.values()) {
    Filter filter=(Filter)beans.get(defaultFilter.name());
    assertNotNull(filter);
    assertTrue(defaultFilter.getFilterClass().isAssignableFrom(filter.getClass()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.PathMatchingFilterTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test asserting <a href="https://issues.apache.org/jira/browse/SHIRO-221">SHIRO-221<a/>.
 */
@SuppressWarnings({"JavaDoc"}) @Test public void testEnabled() throws Exception {
  filter.processPathConfig(DISABLED_PATH,null);
  filter.processPathConfig(ENABLED_PATH,null);
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  ServletResponse response=createNiceMock(ServletResponse.class);
  expect(request.getContextPath()).andReturn(CONTEXT_PATH).anyTimes();
  expect(request.getRequestURI()).andReturn(ENABLED_PATH).anyTimes();
  replay(request);
  boolean continueFilterChain=filter.preHandle(request,response);
  assertFalse("FilterChain should NOT continue.",continueFilterChain);
  verify(request);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test asserting <a href="https://issues.apache.org/jira/browse/SHIRO-221">SHIRO-221<a/>.
 */
@SuppressWarnings({"JavaDoc"}) @Test public void testDisabledBasedOnPath() throws Exception {
  filter.processPathConfig(DISABLED_PATH,null);
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  ServletResponse response=createNiceMock(ServletResponse.class);
  expect(request.getContextPath()).andReturn(CONTEXT_PATH).anyTimes();
  expect(request.getRequestURI()).andReturn(DISABLED_PATH).anyTimes();
  replay(request);
  boolean continueFilterChain=filter.preHandle(request,response);
  assertTrue("FilterChain should continue.",continueFilterChain);
  verify(request);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authc.AnonymousFilterTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void test(){
  AnonymousFilter filter=new AnonymousFilter();
  boolean allow=filter.onPreHandle(null,null,null);
  assertTrue(allow);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authc.BasicHttpFilterAuthenticationTest </h4><pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoPassword() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro",""));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  UsernamePasswordToken upToken=(UsernamePasswordToken)token;
  assertEquals("pedro",upToken.getUsername());
  assertEquals("Password is not empty.",0,upToken.getPassword().length);
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenColonInPassword() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("pedro","pass:word"));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  UsernamePasswordToken upToken=(UsernamePasswordToken)token;
  assertEquals("pedro",upToken.getUsername());
  assertEquals("pass:word",new String(upToken.getPassword()));
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoAuthorizationHeader() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(null);
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  assertEquals("",token.getPrincipal());
  verify(request);
  verify(response);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTokenNoUsername() throws Exception {
  testFilter=new BasicHttpAuthenticationFilter();
  HttpServletRequest request=createMock(HttpServletRequest.class);
  expect(request.getHeader("Authorization")).andReturn(createAuthorizationHeader("",""));
  expect(request.getRemoteHost()).andReturn("localhost");
  HttpServletResponse response=createMock(HttpServletResponse.class);
  replay(request);
  replay(response);
  AuthenticationToken token=testFilter.createToken(request,response);
  assertNotNull(token);
  assertTrue("Token is not a username and password token.",token instanceof UsernamePasswordToken);
  assertEquals("",token.getPrincipal());
  verify(request);
  verify(response);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authz.HttpMethodPermissionFilterTest </h4><pre class="type-2 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPermisisonMapping(){
  HttpMethodPermissionFilter filter=new HttpMethodPermissionFilter();
  String[] permsBefore={"foo","bar"};
  String[] permsAfter=filter.buildPermissions(permsBefore,filter.getHttpMethodAction("get"));
  Assert.assertEquals(2,permsAfter.length);
  Assert.assertEquals("foo:read",permsAfter[0]);
  Assert.assertEquals("bar:read",permsAfter[1]);
  Assert.assertEquals("foo:read",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("head"))[0]);
  Assert.assertEquals("foo:update",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("put"))[0]);
  Assert.assertEquals("foo:create",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("post"))[0]);
  Assert.assertEquals("foo:create",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("mkcol"))[0]);
  Assert.assertEquals("foo:delete",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("delete"))[0]);
  Assert.assertEquals("foo:read",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("options"))[0]);
  Assert.assertEquals("foo:read",filter.buildPermissions(permsBefore,filter.getHttpMethodAction("trace"))[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.authz.PortFilterTest </h4><pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testDefault() throws Exception {
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  HttpServletRequest request=createBaseMockRequest();
  expect(response.encodeRedirectURL(eq("http://localhost/"))).andReturn("http://localhost/");
  replay(request);
  replay(response);
  PortFilter filter=new PortFilter();
  boolean result=filter.onAccessDenied(request,response,null);
  verify(request);
  verify(response);
  assertFalse(result);
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * This tests the case where the client (e.g. browser) specifies a simple request to http://localhost/
 * (i.e. http scheme with the implied port of 80). The redirectURL should reflect the configured port (8080) instead
 * of the implied port 80.
 * @throws Exception if there is a test failure
 */
@Test public void testConfiguredPort() throws Exception {
  int port=8080;
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  HttpServletRequest request=createBaseMockRequest();
  String expected="http://localhost:" + port + "/";
  expect(response.encodeRedirectURL(eq(expected))).andReturn(expected);
  replay(request);
  replay(response);
  PortFilter filter=new PortFilter();
  filter.setPort(port);
  boolean result=filter.onAccessDenied(request,response,null);
  verify(request);
  verify(response);
  assertFalse(result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.mgt.PathMatchingFilterChainResolverTest </h4><pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstance(){
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetChainsWithoutMatch(){
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  resolver.getFilterChainManager().addToChain("/index.html","authcBasic");
  expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();
  expect(request.getContextPath()).andReturn("");
  expect(request.getRequestURI()).andReturn("/");
  replay(request);
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNull(resolved);
  verify(request);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testPathTraversalWithDot(){
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  resolver.getFilterChainManager().addToChain("/index.html","authcBasic");
  expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();
  expect(request.getContextPath()).andReturn("");
  expect(request.getRequestURI()).andReturn("/./index.html");
  replay(request);
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNotNull(resolved);
  verify(request);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetChainsWithoutChains(){
  ServletRequest request=createNiceMock(HttpServletRequest.class);
  ServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNull(resolved);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetChainsWithMatch(){
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  resolver.getFilterChainManager().addToChain("/index.html","authcBasic");
  expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();
  expect(request.getContextPath()).andReturn("");
  expect(request.getRequestURI()).andReturn("/index.html");
  replay(request);
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNotNull(resolved);
  verify(request);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstanceWithFilterConfig(){
  FilterConfig mock=createNiceMockFilterConfig();
  replay(mock);
  resolver=new PathMatchingFilterChainResolver(mock);
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
  assertEquals(((DefaultFilterChainManager)resolver.getFilterChainManager()).getFilterConfig(),mock);
  verify(mock);
}

</code></pre>

<br>
<pre class="type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetters(){
  resolver.setPathMatcher(new AntPathMatcher());
  assertNotNull(resolver.getPathMatcher());
  assertTrue(resolver.getPathMatcher() instanceof AntPathMatcher);
  resolver.setFilterChainManager(new DefaultFilterChainManager());
  assertNotNull(resolver.getFilterChainManager());
  assertTrue(resolver.getFilterChainManager() instanceof DefaultFilterChainManager);
}

</code></pre>

<br>
<pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testPathTraversalWithDotDot(){
  HttpServletRequest request=createNiceMock(HttpServletRequest.class);
  HttpServletResponse response=createNiceMock(HttpServletResponse.class);
  FilterChain chain=createNiceMock(FilterChain.class);
  resolver.getFilterChainManager().addToChain("/index.html","authcBasic");
  expect(request.getAttribute(WebUtils.INCLUDE_CONTEXT_PATH_ATTRIBUTE)).andReturn(null).anyTimes();
  expect(request.getContextPath()).andReturn("");
  expect(request.getRequestURI()).andReturn("/public/../index.html");
  replay(request);
  FilterChain resolved=resolver.getChain(request,response,chain);
  assertNotNull(resolved);
  verify(request);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.filter.mgt.SimpleNamedFilterListTest </h4><pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInstance(){
  @SuppressWarnings({"MismatchedQueryAndUpdateOfCollection"}) SimpleNamedFilterList list=new SimpleNamedFilterList("test");
  assertNotNull(list.getName());
  assertEquals("test",list.getName());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-15 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Exists mainly to increase code coverage as the SimpleNamedFilterList
 * implementation is a direct pass through.
 */
@Test public void testListMethods(){
  FilterChain mock=createNiceMock(FilterChain.class);
  Filter filter=createNiceMock(Filter.class);
  NamedFilterList list=new SimpleNamedFilterList("test");
  list.add(filter);
  FilterChain chain=list.proxy(mock);
  assertNotNull(chain);
  assertNotSame(mock,chain);
  Filter singleFilter=new SslFilter();
  List<? extends Filter> multipleFilters=CollectionUtils.asList(new PortFilter(),new UserFilter());
  list.add(0,singleFilter);
  assertEquals(2,list.size());
  assertTrue(list.get(0) instanceof SslFilter);
  assertTrue(Arrays.equals(list.toArray(),new Object[]{singleFilter,filter}));
  list.addAll(multipleFilters);
  assertEquals(4,list.size());
  assertTrue(list.get(2) instanceof PortFilter);
  assertTrue(list.get(3) instanceof UserFilter);
  list.addAll(0,CollectionUtils.asList(new PermissionsAuthorizationFilter(),new RolesAuthorizationFilter()));
  assertEquals(6,list.size());
  assertTrue(list.get(0) instanceof PermissionsAuthorizationFilter);
  assertTrue(list.get(1) instanceof RolesAuthorizationFilter);
  assertEquals(2,list.indexOf(singleFilter));
  assertEquals(multipleFilters,list.subList(4,list.size()));
  assertTrue(list.contains(singleFilter));
  assertTrue(list.containsAll(multipleFilters));
  assertFalse(list.isEmpty());
  list.clear();
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  Iterator i=list.iterator();
  assertTrue(i.hasNext());
  assertEquals(i.next(),singleFilter);
  ListIterator li=list.listIterator();
  assertTrue(li.hasNext());
  assertEquals(li.next(),singleFilter);
  li=list.listIterator(0);
  assertTrue(li.hasNext());
  assertEquals(li.next(),singleFilter);
  list.set(0,singleFilter);
  assertEquals(list.get(0),singleFilter);
  Filter[] filters=new Filter[list.size()];
  filters=list.toArray(filters);
  assertEquals(1,filters.length);
  assertEquals(filters[0],singleFilter);
  assertEquals(0,list.lastIndexOf(singleFilter));
  list.remove(singleFilter);
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  list.remove(0);
  assertTrue(list.isEmpty());
  list.add(singleFilter);
  list.addAll(multipleFilters);
  assertEquals(3,list.size());
  list.removeAll(multipleFilters);
  assertEquals(1,list.size());
  assertEquals(list.get(0),singleFilter);
  list.addAll(multipleFilters);
  assertEquals(3,list.size());
  list.retainAll(multipleFilters);
  assertEquals(2,list.size());
  assertEquals(new ArrayList(list),multipleFilters);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.CookieRememberMeManagerTest </h4><pre class="type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void getRememberedSerializedIdentityReturnsNullForDeletedCookie(){
  HttpServletRequest mockRequest=createMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createMock(HttpServletResponse.class);
  WebSubjectContext context=new DefaultWebSubjectContext();
  context.setServletRequest(mockRequest);
  context.setServletResponse(mockResponse);
  expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);
  Cookie[] cookies=new Cookie[]{new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME,org.apache.shiro.web.servlet.Cookie.DELETED_COOKIE_VALUE)};
  expect(mockRequest.getCookies()).andReturn(cookies);
  replay(mockRequest);
  CookieRememberMeManager mgr=new CookieRememberMeManager();
  assertNull(mgr.getRememberedSerializedIdentity(context));
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void getRememberedPrincipals(){
  HttpServletRequest mockRequest=createMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createMock(HttpServletResponse.class);
  WebSubjectContext context=new DefaultWebSubjectContext();
  context.setServletRequest(mockRequest);
  context.setServletResponse(mockResponse);
  expect(mockRequest.getAttribute(ShiroHttpServletRequest.IDENTITY_REMOVED_KEY)).andReturn(null);
  final String userPCAesBase64="WlD5MLzzZznN3dQ1lPJO/eScSuY245k29aECNmjUs31o7Yu478hWhaM5Sj" + "jmoe900/72JNu3hcJaPG6Q17Vuz4F8x0kBjbFnPVx4PqzsZYT6yreeS2jwO6OwfI+efqXOKyB2a5KPtnr" + "7jt5kZsyH38XJISb81cf6xqTGUru8zC+kNqJFz7E5RpO0kraBofS5jhMm45gDVjDRkjgPJAzocVWMtrza"+ "zy67P8eb+kMSBCqGI251JTNAGboVgQ28KjfaAJ/6LXRJUj7kB7CGia7mgRk+hxzEJGDs81at5VOPqODJr"+ "xb8tcIdemFUFIkiYVP9bGs4dP3ECtmw7aNrCzv+84sx3vRFUrd5DbDYpEuE12hF2Y9owDK9sxStbXoF0y"+ "A32dhfGDIqS+agsass0sWn8WX2TM9i8SxrUjiFbxqyIG49HbqGrZp5QLM9IuIwO+TzGfF1FzumQGdwmWT"+ "xkVapw5UESl34YvA615cb+82ue1I=";
  Cookie[] cookies=new Cookie[]{new Cookie(CookieRememberMeManager.DEFAULT_REMEMBER_ME_COOKIE_NAME,userPCAesBase64)};
  expect(mockRequest.getCookies()).andReturn(cookies);
  replay(mockRequest);
  CookieRememberMeManager mgr=new CookieRememberMeManager();
  PrincipalCollection collection=mgr.getRememberedPrincipals(context);
  verify(mockRequest);
  assertTrue(collection != null);
  assertTrue(collection.iterator().next().equals("user"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.mgt.DefaultWebSecurityManagerTest </h4><pre class="type-13 type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogin(){
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  expect(mockRequest.getCookies()).andReturn(null);
  expect(mockRequest.getContextPath()).andReturn("/");
  replay(mockRequest);
  Subject subject=newSubject(mockRequest,mockResponse);
  assertFalse(subject.isAuthenticated());
  subject.login(new UsernamePasswordToken("lonestarr","vespa"));
  assertTrue(subject.isAuthenticated());
  assertNotNull(subject.getPrincipal());
  assertTrue(subject.getPrincipal().equals("lonestarr"));
}

</code></pre>

<br>
<pre class="type-13 type-2 type-12 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubjectByRequestResponsePair(){
  shiroSessionModeInit();
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  expect(mockRequest.getCookies()).andReturn(null);
  replay(mockRequest);
  replay(mockResponse);
  Subject subject=newSubject(mockRequest,mockResponse);
  verify(mockRequest);
  verify(mockResponse);
  assertNotNull(subject);
  assertTrue(subject.getPrincipals() == null || subject.getPrincipals().isEmpty());
  assertTrue(subject.getSession(false) == null);
  assertFalse(subject.isAuthenticated());
}

</code></pre>

<br>
<pre class="type-13 type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSubjectByRequestSessionId(){
  shiroSessionModeInit();
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  replay(mockRequest);
  replay(mockResponse);
  Subject subject=newSubject(mockRequest,mockResponse);
  Session session=subject.getSession();
  Serializable sessionId=session.getId();
  assertNotNull(sessionId);
  verify(mockRequest);
  verify(mockResponse);
  mockRequest=createNiceMock(HttpServletRequest.class);
  mockResponse=createNiceMock(HttpServletResponse.class);
  Cookie[] cookies=new Cookie[]{new Cookie(ShiroHttpSession.DEFAULT_SESSION_ID_NAME,sessionId.toString())};
  expect(mockRequest.getCookies()).andReturn(cookies).anyTimes();
  expect(mockRequest.getParameter(isA(String.class))).andReturn(null).anyTimes();
  replay(mockRequest);
  replay(mockResponse);
  subject=newSubject(mockRequest,mockResponse);
  session=subject.getSession(false);
  assertNotNull(session);
  assertEquals(sessionId,session.getId());
  verify(mockRequest);
  verify(mockResponse);
}

</code></pre>

<br>
<pre class="type-13 type-8 type-2 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionTimeout(){
  shiroSessionModeInit();
  long globalTimeout=100;
  ((AbstractSessionManager)sm.getSessionManager()).setGlobalSessionTimeout(globalTimeout);
  HttpServletRequest mockRequest=createNiceMock(HttpServletRequest.class);
  HttpServletResponse mockResponse=createNiceMock(HttpServletResponse.class);
  expect(mockRequest.getCookies()).andReturn(null);
  expect(mockRequest.getContextPath()).andReturn("/");
  replay(mockRequest);
  Subject subject=newSubject(mockRequest,mockResponse);
  Session session=subject.getSession();
  assertEquals(session.getTimeout(),globalTimeout);
  session.setTimeout(125);
  assertEquals(session.getTimeout(),125);
  sleep(200);
  try {
    session.getTimeout();
    fail("Session should have expired.");
  }
 catch (  ExpiredSessionException expected) {
  }
}

</code></pre>

<br>
<pre class="type-2 type-3 type-10 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Asserts fix for <a href="https://issues.apache.org/jira/browse/SHIRO-350">SHIRO-350</a>.
 */
@Test public void testBuildNonWebSubjectWithDefaultServletContainerSessionManager(){
  Ini ini=new Ini();
  Ini.Section section=ini.addSection(IniRealm.USERS_SECTION_NAME);
  section.put("user1","user1");
  WebIniSecurityManagerFactory factory=new WebIniSecurityManagerFactory(ini);
  WebSecurityManager securityManager=(WebSecurityManager)factory.getInstance();
  PrincipalCollection principals=new SimplePrincipalCollection("user1","iniRealm");
  Subject subject=new Subject.Builder(securityManager).principals(principals).buildSubject();
  assertNotNull(subject);
  assertEquals("user1",subject.getPrincipal());
}

</code></pre>

<br>
<pre class="type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void checkSessionManagerDeterminesContainerSessionMode(){
  sm.setSessionMode(DefaultWebSecurityManager.NATIVE_SESSION_MODE);
  WebSessionManager sessionManager=createMock(WebSessionManager.class);
  expect(sessionManager.isServletContainerSessions()).andReturn(true).anyTimes();
  replay(sessionManager);
  sm.setSessionManager(sessionManager);
  assertTrue("The set SessionManager is not being used to determine isHttpSessionMode.",sm.isHttpSessionMode());
  verify(sessionManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.shiro.web.servlet.SimpleCookieTest </h4><pre class="type-13 type-2 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveValue() throws Exception {
  String name="test";
  String value="deleteMe";
  String path="/somepath";
  String headerValue=this.cookie.buildHeaderValue(name,value,null,null,path,0,SimpleCookie.DEFAULT_VERSION,false,false);
  String expectedStart=new StringBuilder().append(name).append(SimpleCookie.NAME_VALUE_DELIMITER).append(value).append(SimpleCookie.ATTRIBUTE_DELIMITER).append(SimpleCookie.PATH_ATTRIBUTE_NAME).append(SimpleCookie.NAME_VALUE_DELIMITER).append(path).toString();
  assertTrue(headerValue.startsWith(expectedStart));
  expect(mockRequest.getContextPath()).andReturn(path).times(1);
  mockResponse.addHeader(eq(SimpleCookie.COOKIE_HEADER_NAME),isA(String.class));
  replay(mockRequest);
  replay(mockResponse);
  this.cookie.removeFrom(mockRequest,mockResponse);
  verify(mockRequest);
  verify(mockResponse);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
