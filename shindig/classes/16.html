<h3 style="margin:0px">Class: org.apache.shindig.common.crypto.CryptoTest (11 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(5)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-6 type-1 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomDigits() throws Exception {
  Pattern digitPattern=Pattern.compile("^\\d+$");
  String digits=Crypto.getRandomDigits(100);
  assertEquals(100,digits.length());
  assertTrue("Should be only digits: " + digits,digitPattern.matcher(digits).matches());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHmacSha256Verify() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={69,-128,-5,20,94,-46,-40,46,43,-24,-76,-93,-28,-70,3,93,101,124,111,-56,124,-38,103,41,83,-53,-45,36,-21,73,-10,-32};
  Crypto.hmacShaVerify(key.getBytes(),val.getBytes(),expected,HMACType.HMACSHA256.getName());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHmacSha384Verify() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={66,-117,24,-112,19,-58,80,27,-117,23,107,41,-118,-3,100,-61,42,77,50,70,-28,85,-39,-55,47,42,106,116,-26,72,76,-101,67,-37,-56,5,-85,117,-51,-95,-18,-100,81,69,9,105,70,99};
  Crypto.hmacShaVerify(key.getBytes(),val.getBytes(),expected,HMACType.HMACSHA384.getName());
}

</code></pre>

<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHmacSha512() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={-40,-114,57,41,-97,-13,13,106,-71,72,-54,97,-50,-109,-115,-24,-68,82,73,-97,46,-21,-128,-40,73,41,43,61,20,35,79,90,-27,83,-1,-64,-128,49,-118,-117,34,-63,-51,87,-85,120,-9,-107,29,106,-48,51,105,-56,86,-52,18,-45,-81,-6,0,16,67,90};
  byte[] hmac=Crypto.hmacSha(key.getBytes(),val.getBytes(),HMACType.HMACSHA512.getName());
  assertArrayEquals(expected,hmac);
}

</code></pre>

<pre class="type-9 type-11 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAes128Cbc() throws Exception {
  byte[] key=Crypto.getRandomBytes(Crypto.CIPHER_KEY_LEN);
  for (byte i=0; i < 50; i++) {
    byte[] orig=new byte[i];
    for (byte j=0; j < i; j++) {
      orig[j]=j;
    }
    byte[] cipherText=Crypto.aes128cbcEncrypt(key,orig);
    byte[] plainText=Crypto.aes128cbcDecrypt(key,cipherText);
    assertArrayEquals("Array of length " + i,orig,plainText);
  }
}

</code></pre>

<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHmacSha1() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={-21,2,47,-101,9,-40,18,43,76,117,-51,115,-122,-91,39,26,-18,122,30,90};
  byte[] hmac=Crypto.hmacSha(key.getBytes(),val.getBytes(),HMACType.HMACSHA1.getName());
  assertArrayEquals(expected,hmac);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHmacSha1Verify() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={-21,2,47,-101,9,-40,18,43,76,117,-51,115,-122,-91,39,26,-18,122,30,90};
  Crypto.hmacShaVerify(key.getBytes(),val.getBytes(),expected,HMACType.HMACSHA1.getName());
}

</code></pre>

<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHmacSha384() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={66,-117,24,-112,19,-58,80,27,-117,23,107,41,-118,-3,100,-61,42,77,50,70,-28,85,-39,-55,47,42,106,116,-26,72,76,-101,67,-37,-56,5,-85,117,-51,-95,-18,-100,81,69,9,105,70,99};
  byte[] hmac=Crypto.hmacSha(key.getBytes(),val.getBytes(),HMACType.HMACSHA384.getName());
  assertArrayEquals(expected,hmac);
}

</code></pre>

<pre class="type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=GeneralSecurityException.class) public void testHmacSha1VerifyTampered() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={-21,2,47,-101,9,-40,18,43,76,117,-51,115,-122,-91,39,0,-18,122,30,90};
  Crypto.hmacShaVerify(key.getBytes(),val.getBytes(),expected,HMACType.HMACSHA1.getName());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHmacSha512Verify() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={-40,-114,57,41,-97,-13,13,106,-71,72,-54,97,-50,-109,-115,-24,-68,82,73,-97,46,-21,-128,-40,73,41,43,61,20,35,79,90,-27,83,-1,-64,-128,49,-118,-117,34,-63,-51,87,-85,120,-9,-107,29,106,-48,51,105,-56,86,-52,18,-45,-81,-6,0,16,67,90};
  Crypto.hmacShaVerify(key.getBytes(),val.getBytes(),expected,HMACType.HMACSHA512.getName());
}

</code></pre>

<pre class="type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHmacSha256() throws Exception {
  String key="abcd1234";
  String val="your mother is a hedgehog";
  byte[] expected={69,-128,-5,20,94,-46,-40,46,43,-24,-76,-93,-28,-70,3,93,101,124,111,-56,124,-38,103,41,83,-53,-45,36,-21,73,-10,-32};
  byte[] hmac=Crypto.hmacSha(key.getBytes(),val.getBytes(),HMACType.HMACSHA256.getName());
  assertArrayEquals(expected,hmac);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
