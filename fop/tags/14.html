<h3><span class=" glyphicon glyphicon-tag"/>&nbspPublicFieldVerifier</h3><kbd>Verifies values related to public fields.</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.fop.events.BasicEventTestCase </h4><pre class="type-1 type-2 type-7 type-5 type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasics() throws Exception {
  MyEventListener listener=new MyEventListener();
  EventBroadcaster broadcaster=new DefaultEventBroadcaster();
  broadcaster.addEventListener(listener);
  assertTrue(broadcaster.hasEventListeners());
  Event ev=new Event(this,"123",EventSeverity.INFO,Event.paramsBuilder().param("reason","I'm tired").param("blah",new Integer(23)).build());
  broadcaster.broadcastEvent(ev);
  ev=listener.event;
  assertNotNull(ev);
  assertEquals("123",listener.event.getEventID());
  assertEquals(EventSeverity.INFO,listener.event.getSeverity());
  assertEquals("I'm tired",ev.getParam("reason"));
  assertEquals(new Integer(23),ev.getParam("blah"));
  broadcaster.removeEventListener(listener);
  assertFalse(broadcaster.hasEventListeners());
  broadcaster.broadcastEvent(ev);
}

</code></pre>

<br>
<pre class="type-1 type-2 type-7 type-5 type-14 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEventProducer() throws Exception {
  MyEventListener listener=new MyEventListener();
  EventBroadcaster broadcaster=new DefaultEventBroadcaster();
  broadcaster.addEventListener(listener);
  assertTrue(broadcaster.hasEventListeners());
  TestEventProducer producer=TestEventProducer.Provider.get(broadcaster);
  producer.complain(this,"I'm tired",23);
  Event ev=listener.event;
  assertNotNull(ev);
  assertEquals("org.apache.fop.events.TestEventProducer.complain",listener.event.getEventID());
  assertEquals(EventSeverity.WARN,listener.event.getSeverity());
  assertEquals("I'm tired",ev.getParam("reason"));
  assertEquals(new Integer(23),ev.getParam("blah"));
  broadcaster.removeEventListener(listener);
  assertFalse(broadcaster.hasEventListeners());
  broadcaster.broadcastEvent(ev);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.fop.fonts.truetype.GlyfTableTestCase </h4><pre class="type-5 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Tests that no glyphs are added if there are no composite glyphs the subset.
 * @throws IOException if an I/O error occurs
 */
@Test public void testPopulateNoCompositeGlyphs() throws IOException {
  int[] composedIndices=setupTest(36,37,38);
  int[] expected=new int[composedIndices.length];
  assertArrayEquals(expected,composedIndices);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Tests that glyphs aren't remapped twice if the glyph before a composite glyph has 0-length.
 * @throws IOException if an I/O error occurs
 */
@Test public void testGlyphsNotRemappedTwice() throws IOException {
  int composedGlyph=12;
  int[] composedIndices=setupTest(1,2,3,16,2014,4,7,8,13,2015,composedGlyph);
  int[] expected=new int[composedIndices.length];
  expected[10]=composedGlyph;
  assertArrayEquals(expected,composedIndices);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.fop.pdf.PDFEncryptionJCETestCase </h4><pre class="type-6 type-2 type-5 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testAES256() throws UnsupportedEncodingException, NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, InvalidAlgorithmParameterException, IllegalBlockSizeException, BadPaddingException {
  MessageDigest sha256=MessageDigest.getInstance("SHA-256");
  String dataText="Test data to encrypt.";
  byte[] data=dataText.getBytes("UTF-8");
  PDFEncryptionParams params=new PDFEncryptionParams();
  params.setEncryptionLengthInBits(256);
  params.setUserPassword("userpassword");
  params.setOwnerPassword("ownerpassword");
  PDFEncryptionJCE encryption=createEncryptionObject(params);
  PDFText text=new PDFText();
  text.setObjectNumber(1);
  String dictionary=new String(encryption.toPDF());
  byte[] encrypted=encryption.encrypt(data,text);
  byte[] u=parseHexStringEntries(dictionary,"U");
  byte[] o=parseHexStringEntries(dictionary,"O");
  byte[] ue=parseHexStringEntries(dictionary,"UE");
  byte[] oe=parseHexStringEntries(dictionary,"OE");
  byte[] perms=parseHexStringEntries(dictionary,"Perms");
  assertEquals(48,u.length);
  assertEquals(48,o.length);
  assertEquals(32,ue.length);
  assertEquals(32,oe.length);
  assertEquals(16,perms.length);
  byte[] userValSalt=new byte[8];
  byte[] userKeySalt=new byte[8];
  System.arraycopy(u,32,userValSalt,0,8);
  System.arraycopy(u,40,userKeySalt,0,8);
  byte[] uPassBytes=params.getUserPassword().getBytes("UTF-8");
  byte[] testUPass=new byte[uPassBytes.length + 8];
  System.arraycopy(uPassBytes,0,testUPass,0,uPassBytes.length);
  System.arraycopy(userValSalt,0,testUPass,uPassBytes.length,8);
  sha256.reset();
  sha256.update(testUPass);
  byte[] actualUPass=sha256.digest();
  byte[] expectedUPass=new byte[32];
  System.arraycopy(u,0,expectedUPass,0,32);
  assertArrayEquals(expectedUPass,actualUPass);
  byte[] ownerValSalt=new byte[8];
  byte[] ownerKeySalt=new byte[8];
  System.arraycopy(o,32,ownerValSalt,0,8);
  System.arraycopy(o,40,ownerKeySalt,0,8);
  byte[] oPassBytes=params.getOwnerPassword().getBytes("UTF-8");
  byte[] testOPass=new byte[oPassBytes.length + 8 + 48];
  System.arraycopy(oPassBytes,0,testOPass,0,oPassBytes.length);
  System.arraycopy(ownerValSalt,0,testOPass,oPassBytes.length,8);
  System.arraycopy(u,0,testOPass,oPassBytes.length + 8,48);
  sha256.reset();
  sha256.update(testOPass);
  byte[] actualOPass=sha256.digest();
  byte[] expectedOPass=new byte[32];
  System.arraycopy(o,0,expectedOPass,0,32);
  assertArrayEquals(expectedOPass,actualOPass);
  byte[] ivZero={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  IvParameterSpec ivspecZero=new IvParameterSpec(ivZero);
  Cipher cipherNoPadding=Cipher.getInstance("AES/CBC/NoPadding");
  byte[] tmpUKey=new byte[uPassBytes.length + 8];
  System.arraycopy(uPassBytes,0,tmpUKey,0,uPassBytes.length);
  System.arraycopy(userKeySalt,0,tmpUKey,uPassBytes.length,8);
  sha256.reset();
  sha256.update(tmpUKey);
  byte[] intUKey=sha256.digest();
  SecretKeySpec uSKeySpec=new SecretKeySpec(intUKey,"AES");
  cipherNoPadding.init(Cipher.DECRYPT_MODE,uSKeySpec,ivspecZero);
  byte[] uFileEncryptionKey=cipherNoPadding.doFinal(ue);
  byte[] tmpOKey=new byte[oPassBytes.length + 8 + 48];
  System.arraycopy(oPassBytes,0,tmpOKey,0,oPassBytes.length);
  System.arraycopy(ownerKeySalt,0,tmpOKey,oPassBytes.length,8);
  System.arraycopy(u,0,tmpOKey,oPassBytes.length + 8,48);
  sha256.reset();
  sha256.update(tmpOKey);
  byte[] intOKey=sha256.digest();
  SecretKeySpec oSKeySpec=new SecretKeySpec(intOKey,"AES");
  cipherNoPadding.init(Cipher.DECRYPT_MODE,oSKeySpec,ivspecZero);
  byte[] oFileEncryptionKey=cipherNoPadding.doFinal(oe);
  assertArrayEquals(uFileEncryptionKey,oFileEncryptionKey);
  byte[] fileEncryptionKey=new byte[uFileEncryptionKey.length];
  System.arraycopy(uFileEncryptionKey,0,fileEncryptionKey,0,uFileEncryptionKey.length);
  SecretKeySpec sKeySpec=new SecretKeySpec(fileEncryptionKey,"AES");
  cipherNoPadding.init(Cipher.DECRYPT_MODE,sKeySpec,ivspecZero);
  byte[] decryptedPerms=cipherNoPadding.doFinal(perms);
  assertEquals('T',decryptedPerms[8]);
  assertEquals('a',decryptedPerms[9]);
  assertEquals('d',decryptedPerms[10]);
  assertEquals('b',decryptedPerms[11]);
  int expectedPermissions=-4;
  int actualPermissions=decryptedPerms[3] << 24 | (decryptedPerms[2] & 0xFF) << 16 | (decryptedPerms[1] & 0xFF) << 8 | (decryptedPerms[0] & 0xFF);
  assertEquals(expectedPermissions,actualPermissions);
  byte[] iv=new byte[16];
  System.arraycopy(encrypted,0,iv,0,16);
  byte[] encryptedData=new byte[encrypted.length - 16];
  System.arraycopy(encrypted,16,encryptedData,0,encrypted.length - 16);
  IvParameterSpec ivspec=new IvParameterSpec(iv);
  Cipher cipher=Cipher.getInstance("AES/CBC/PKCS5Padding");
  cipher.init(Cipher.DECRYPT_MODE,sKeySpec,ivspec);
  byte[] decryptedData=cipher.doFinal(encryptedData);
  assertArrayEquals(data,decryptedData);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
