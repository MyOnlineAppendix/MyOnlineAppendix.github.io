<h3 style="margin:0px">Class: org.apache.juddi.v3.tck.JUDDI_300_MultiNodeIntegrationTest (7 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="18"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('18')" data-toggle="tooltip" title="Sets implicit assumptions "><kbd id="tag-18"class="label-info"style="display: inline-block;font-size:7pt" >AssumptionSetter&nbsp;(4)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(2)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(1)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Is not executed with the test suite"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IgnoredMethod&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-13 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is not executed with the test suite
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * If the same key is created at two nodes before the replication change
 * record has been distributed, it's possible for the same record to be
 * owned by two different nodes. After a short period of time, both
 * records should be rejected
 * <a href="http://www.uddi.org/pubs/uddi-v3.0.2-20041019.htm#_Toc85908178">7.3.9</a>
 * for more info on collision detection
 * requires support for conditional new data inserts and concurrence
 * from nodes.
 * @throws Exception
 */
@Test @Ignore public void replicationConflictMaintainOwership() throws Exception {
  try {
    resetTmodels();
    maryTModelNode1.saveMaryPublisherTmodel(maryTokenNode1);
    samTModelNode2.saveMaryPublisherTmodel(samTokenNode2);
  }
  finally {
    resetTmodels();
  }
}

</code></pre>

<pre class="type-18 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testReplicationPublisherAssertionSet() throws Exception {
  Assume.assumeTrue(TckPublisher.isReplicationEnabled());
  Assume.assumeTrue(TckPublisher.isJUDDI());
  logger.info("testReplicationPublisherAssertionSet");
}

</code></pre>

<pre class="type-5 type-3 type-2 type-11 type-18 type-1 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * covers adding and removing a service and a binding
 * @throws Exception
 */
@Test public void testReplicationServiceBindingAddRemove() throws Exception {
  Assume.assumeTrue(TckPublisher.isReplicationEnabled());
  Assume.assumeTrue(TckPublisher.isJUDDI());
  logger.info("testReplicationServiceBindingAddRemove");
  try {
    TckCommon.PrintMarker();
    resetBusinesses();
    resetTmodels();
    try {
      samTModelNode2.saveTmodels(rootNode2Token);
    }
 catch (    Exception ex) {
    }
    samTModelNode2.saveSamSyndicatorTmodel(samTokenNode2);
    samBizNode2.saveSamSyndicatorBusiness(samTokenNode2);
    GetTModelDetail findTModel=new GetTModelDetail();
    findTModel.setAuthInfo(maryTokenNode1);
    findTModel.getTModelKey().add(TckTModel.SAM_SYNDICATOR_TMODEL_KEY);
    TModelDetail tModelDetail=null;
    int timeout=TckPublisher.getSubscriptionTimeout();
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        tModelDetail=inquiryMary.getTModelDetail(findTModel);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        tModelDetail=null;
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(tModelDetail);
    Assert.assertNotNull(tModelDetail.getTModel());
    Assert.assertTrue(tModelDetail.getTModel().size() == 1);
    Assert.assertTrue(tModelDetail.getTModel().get(0).getTModelKey().equals(TckTModel.SAM_SYNDICATOR_TMODEL_KEY));
    GetBusinessDetail gbd=new GetBusinessDetail();
    gbd.setAuthInfo(maryTokenNode1);
    gbd.getBusinessKey().add(TckBusiness.SAM_BUSINESS_KEY);
    timeout=TckPublisher.getSubscriptionTimeout();
    BusinessDetail businessDetail=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        businessDetail=inquiryMary.getBusinessDetail(gbd);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        businessDetail=null;
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(businessDetail);
    Assert.assertNotNull(businessDetail.getBusinessEntity());
    Assert.assertTrue(businessDetail.getBusinessEntity().get(0).getBusinessKey().equals(TckBusiness.SAM_BUSINESS_KEY));
    logger.info("Business replicated");
    samServiceNode2.saveSamSyndicatorService(samTokenNode2);
    GetServiceDetail gsd=new GetServiceDetail();
    gsd.setAuthInfo(maryTokenNode1);
    gsd.getServiceKey().add(TckBusinessService.SAM_SERVICE_KEY);
    timeout=TckPublisher.getSubscriptionTimeout();
    ServiceDetail sd=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        sd=inquiryMary.getServiceDetail(gsd);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        sd=null;
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(sd);
    Assert.assertNotNull(sd.getBusinessService());
    Assert.assertTrue(sd.getBusinessService().get(0).getBusinessKey().equals(TckBusiness.SAM_BUSINESS_KEY));
    Assert.assertTrue(sd.getBusinessService().get(0).getServiceKey().equals(TckBusinessService.SAM_SERVICE_KEY));
    logger.info("Service replicated");
    BindingTemplate newbt=new BindingTemplate();
    newbt.setServiceKey(TckBusinessService.SAM_SERVICE_KEY);
    newbt.setAccessPoint(new AccessPoint("http://localhost","wsdlDeployment"));
    newbt.getDescription().add(new Description("a new accesspoint that's replicated!","en"));
    SaveBinding saveBind=new SaveBinding();
    saveBind.setAuthInfo(samTokenNode2);
    saveBind.getBindingTemplate().add(newbt);
    logger.info("Binding saved");
    BindingDetail saveBinding=publishSamNode2.saveBinding(saveBind);
    GetBindingDetail bindingDetail=new GetBindingDetail();
    bindingDetail.setAuthInfo(maryTokenNode1);
    bindingDetail.getBindingKey().add(saveBinding.getBindingTemplate().get(0).getBindingKey());
    timeout=TckPublisher.getSubscriptionTimeout();
    BindingDetail savedMary=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        savedMary=inquiryMary.getBindingDetail(bindingDetail);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        savedMary=null;
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(savedMary);
    Assert.assertNotNull(savedMary.getBindingTemplate());
    Assert.assertNotNull(savedMary.getBindingTemplate().get(0));
    Assert.assertEquals(savedMary.getBindingTemplate().get(0).getBindingKey(),saveBinding.getBindingTemplate().get(0).getBindingKey());
    Assert.assertEquals(savedMary.getBindingTemplate().get(0).getServiceKey(),saveBinding.getBindingTemplate().get(0).getServiceKey());
    logger.info("Binding was replicated");
    DeleteBinding db=new DeleteBinding();
    db.setAuthInfo(samTokenNode2);
    db.getBindingKey().add(saveBinding.getBindingTemplate().get(0).getBindingKey());
    publishSamNode2.deleteBinding(db);
    logger.info("binding deleted");
    timeout=TckPublisher.getSubscriptionTimeout();
    BindingDetail gbindd=null;
    GetBindingDetail getBindingDetail=new GetBindingDetail();
    getBindingDetail.setAuthInfo(maryTokenNode1);
    getBindingDetail.getBindingKey().add(saveBinding.getBindingTemplate().get(0).getBindingKey());
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        gbindd=inquiryMary.getBindingDetail(getBindingDetail);
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        gbindd=null;
        break;
      }
      timeout--;
      Thread.sleep(1000);
    }
    if (gbindd != null) {
      Assert.fail(saveBinding.getBindingTemplate().get(0).getBindingKey() + " wasn't deleted on node 1");
    }
    logger.info("binding deletion was replicated");
    DeleteService delsvc=new DeleteService();
    delsvc.setAuthInfo(samTokenNode2);
    delsvc.getServiceKey().add(TckBusinessService.SAM_SERVICE_KEY);
    publishSamNode2.deleteService(delsvc);
    logger.info("service deleted");
    ServiceDetail sdd=null;
    GetServiceDetail getServiceDetail=new GetServiceDetail();
    getServiceDetail.setAuthInfo(maryTokenNode1);
    getServiceDetail.getServiceKey().add(TckBusinessService.SAM_SERVICE_KEY);
    timeout=TckPublisher.getSubscriptionTimeout();
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        sdd=inquiryMary.getServiceDetail(getServiceDetail);
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        sdd=null;
        break;
      }
      timeout--;
      Thread.sleep(1000);
    }
    if (sdd != null) {
      Assert.fail(TckBusinessService.SAM_SERVICE_KEY + " wasn't deleted on node 1");
    }
    logger.info("service deletion was replicated");
    samBizNode2.deleteSamSyndicatorBusiness(samTokenNode2);
    samTModelNode2.deleteSamSyndicatorTmodel(samTokenNode2);
    timeout=TckPublisher.getSubscriptionTimeout();
    businessDetail=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        businessDetail=inquiryMary.getBusinessDetail(gbd);
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        businessDetail=null;
        break;
      }
      timeout--;
      Thread.sleep(1000);
    }
    if (businessDetail != null) {
      Assert.fail(TckBusiness.SAM_BUSINESS_KEY + " wasn't deleted on node 1");
    }
    logger.info("sam's business deletion was replicated");
    tModelDetail=inquiryMary.getTModelDetail(findTModel);
    Assert.assertNotNull(tModelDetail);
    Assert.assertNotNull(tModelDetail.getTModel());
    Assert.assertNotNull(tModelDetail.getTModel().get(0));
    Assert.assertEquals(tModelDetail.getTModel().get(0).getTModelKey(),TckTModel.SAM_SYNDICATOR_TMODEL_KEY);
    Assert.assertEquals(tModelDetail.getTModel().get(0).isDeleted(),true);
    logger.info("sam's tModel was deleted(hidden) replicated");
    logger.info("Test passed");
  }
  finally {
    try {
      DeleteBusiness db=new DeleteBusiness();
      db.setAuthInfo(samTokenNode2);
      db.getBusinessKey().add(TckBusiness.SAM_BUSINESS_KEY);
      try {
        publishSamNode2.deleteBusiness(db);
      }
 catch (      Exception ex) {
      }
      int timeout=TckPublisher.getSubscriptionTimeout();
      GetBusinessDetail findTModel=new GetBusinessDetail();
      findTModel.setAuthInfo(maryTokenNode1);
      findTModel.getBusinessKey().add(TckBusiness.SAM_BUSINESS_KEY);
      BusinessDetail tModelDetail=null;
      while (timeout > 0) {
        logger.info("Waiting for the update...");
        try {
          tModelDetail=inquiryMary.getBusinessDetail(findTModel);
        }
 catch (        Exception ex) {
          logger.warn(ex.getMessage());
          tModelDetail=null;
          break;
        }
        timeout--;
        try {
          Thread.sleep(1000);
        }
 catch (        InterruptedException ex) {
        }
      }
      Assert.assertNull(tModelDetail);
    }
 catch (    Exception ex) {
      ex.printStackTrace();
    }
    resetTmodels();
  }
}

</code></pre>

<pre class="type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
@Test public void santityTest(){
}

</code></pre>

<pre class="type-15 type-5 type-3 type-2 type-11 type-18 type-1 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * covers business, tmodels and publisher assertions
 * @throws Exception
 */
@Test public void testReplicationTModelBusinessPublisherAssertionAddDelete() throws Exception {
  Assume.assumeTrue(TckPublisher.isReplicationEnabled());
  Assume.assumeTrue(TckPublisher.isJUDDI());
  try {
    logger.info("testReplicationTModelBusinessPublisherAssertionAddDelete");
    resetTmodels();
    resetBusinesses();
    TModel saveMaryPublisherTmodel=maryTModelNode1.saveMaryPublisherTmodel(maryTokenNode1);
    samTModelNode2.saveSamSyndicatorTmodel(samTokenNode2);
    BusinessEntity saveMaryPublisherBusiness=maryBizNode1.saveMaryPublisherBusiness(maryTokenNode1);
    BusinessEntity saveSamSyndicatorBusiness=samBizNode2.saveSamSyndicatorBusiness(samTokenNode2);
    GetTModelDetail findTModel=new GetTModelDetail();
    findTModel.setAuthInfo(samTokenNode2);
    findTModel.getTModelKey().add(TckTModel.MARY_PUBLISHER_TMODEL_KEY);
    TModelDetail tModelDetail=null;
    int timeout=TckPublisher.getSubscriptionTimeout();
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        tModelDetail=inquirySamNode2.getTModelDetail(findTModel);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        tModelDetail=null;
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(tModelDetail);
    Assert.assertNotNull(tModelDetail.getTModel());
    Assert.assertTrue(tModelDetail.getTModel().size() == 1);
    Assert.assertTrue(tModelDetail.getTModel().get(0).getTModelKey().equals(TckTModel.MARY_PUBLISHER_TMODEL_KEY));
    GetBusinessDetail gbd=new GetBusinessDetail();
    gbd.setAuthInfo(samTokenNode2);
    gbd.getBusinessKey().add(TckBusiness.MARY_BUSINESS_KEY);
    timeout=TckPublisher.getSubscriptionTimeout();
    BusinessDetail businessDetail=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        businessDetail=inquirySamNode2.getBusinessDetail(gbd);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        businessDetail=null;
      }
      timeout--;
      Thread.sleep(1000);
    }
    logger.info("Business replicated");
    Assert.assertNotNull(businessDetail);
    Assert.assertNotNull(businessDetail.getBusinessEntity());
    Assert.assertTrue(businessDetail.getBusinessEntity().get(0).getBusinessKey().equals(TckBusiness.MARY_BUSINESS_KEY));
    logger.info(">>> Saving a new publisher assertion on node 2 (sam)");
    PublisherAssertion pa=new PublisherAssertion();
    pa.setFromKey(TckBusiness.SAM_BUSINESS_KEY);
    pa.setToKey(TckBusiness.MARY_BUSINESS_KEY);
    pa.setKeyedReference(new KeyedReference(UDDIConstants.RELATIONSHIPS,"parent-child","child"));
    AddPublisherAssertions apa=new AddPublisherAssertions();
    apa.setAuthInfo(samTokenNode2);
    apa.getPublisherAssertion().add(pa);
    publishSamNode2.addPublisherAssertions(apa);
    logger.info("Confirming that the assertion is saved on node2 (sam, origin)");
    List<AssertionStatusItem> assertionStatusReport=null;
    boolean found=false;
    assertionStatusReport=publishSamNode2.getAssertionStatusReport(samTokenNode2,null);
    logger.info("Publisher assertions returned: " + assertionStatusReport.size());
    for (int x=0; x < assertionStatusReport.size(); x++) {
      JAXB.marshal(assertionStatusReport.get(x),System.out);
      if (assertionStatusReport.get(x).getFromKey().equalsIgnoreCase(TckBusiness.SAM_BUSINESS_KEY) && assertionStatusReport.get(x).getToKey().equalsIgnoreCase(TckBusiness.MARY_BUSINESS_KEY) && assertionStatusReport.get(x).getKeyedReference().getTModelKey().equalsIgnoreCase(UDDIConstants.RELATIONSHIPS)&& assertionStatusReport.get(x).getKeyedReference().getKeyName().equalsIgnoreCase("parent-child")&& assertionStatusReport.get(x).getKeyedReference().getKeyValue().equalsIgnoreCase("child")) {
        found=true;
        break;
      }
    }
    Assert.assertTrue("Assertion not found on Sam's node (2)!!",found);
    logger.info("Ok it's saved.");
    timeout=TckPublisher.getSubscriptionTimeout();
    logger.info("confirming that the assertion made it to node 1");
    found=false;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        assertionStatusReport=publishMary.getAssertionStatusReport(maryTokenNode1,null);
        logger.info("Publisher assertions returned: " + assertionStatusReport.size());
        for (int x=0; x < assertionStatusReport.size(); x++) {
          JAXB.marshal(assertionStatusReport.get(x),System.out);
          if (assertionStatusReport.get(x).getFromKey().equalsIgnoreCase(TckBusiness.SAM_BUSINESS_KEY) && assertionStatusReport.get(x).getToKey().equalsIgnoreCase(TckBusiness.MARY_BUSINESS_KEY) && assertionStatusReport.get(x).getKeyedReference().getTModelKey().equalsIgnoreCase(UDDIConstants.RELATIONSHIPS)&& assertionStatusReport.get(x).getKeyedReference().getKeyName().equalsIgnoreCase("parent-child")&& assertionStatusReport.get(x).getKeyedReference().getKeyValue().equalsIgnoreCase("child")) {
            found=true;
            break;
          }
        }
        if (found) {
          break;
        }
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        Assert.fail("Unexpected failure " + ex.getMessage());
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertTrue("Assertion wasn't replicated",found);
    logger.info("Publisher Assertion replicated...");
    logger.info("confirming the pa is still on node 2 origin (sam)");
    found=false;
    assertionStatusReport=publishSamNode2.getAssertionStatusReport(samTokenNode2,null);
    logger.info("Publisher assertions returned: " + assertionStatusReport.size());
    for (int x=0; x < assertionStatusReport.size(); x++) {
      JAXB.marshal(assertionStatusReport.get(x),System.out);
      if (assertionStatusReport.get(x).getFromKey().equalsIgnoreCase(TckBusiness.SAM_BUSINESS_KEY) && assertionStatusReport.get(x).getToKey().equalsIgnoreCase(TckBusiness.MARY_BUSINESS_KEY) && assertionStatusReport.get(x).getKeyedReference().getTModelKey().equalsIgnoreCase(UDDIConstants.RELATIONSHIPS)&& assertionStatusReport.get(x).getKeyedReference().getKeyName().equalsIgnoreCase("parent-child")&& assertionStatusReport.get(x).getKeyedReference().getKeyValue().equalsIgnoreCase("child")) {
        found=true;
        break;
      }
    }
    Assert.assertTrue("The PA is not found on node 2(origin), very strange",found);
    DeletePublisherAssertions dpa=new DeletePublisherAssertions();
    dpa.setAuthInfo(samTokenNode2);
    dpa.getPublisherAssertion().add(pa);
    String sam=TckCommon.DumpAllBusinesses(samTokenNode2,inquirySamNode2);
    String mary=TckCommon.DumpAllBusinesses(maryTokenNode1,inquiryMary);
    logger.info("Publisher Assertion deletion...");
    try {
      publishSamNode2.deletePublisherAssertions(dpa);
    }
 catch (    Exception ex) {
      ex.printStackTrace();
      logger.info("Sam's businesses " + sam);
      logger.info("Mary's businesses " + mary);
      Assert.fail("unable to delete the assertion on sam's node!");
    }
    timeout=TckPublisher.getSubscriptionTimeout();
    found=false;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        assertionStatusReport=publishMary.getAssertionStatusReport(maryTokenNode1,null);
        found=false;
        for (int x=0; x < assertionStatusReport.size(); x++) {
          JAXB.marshal(assertionStatusReport.get(x),System.out);
          if (assertionStatusReport.get(x).getFromKey().equalsIgnoreCase(TckBusiness.SAM_BUSINESS_KEY) && assertionStatusReport.get(x).getToKey().equalsIgnoreCase(TckBusiness.MARY_BUSINESS_KEY) && assertionStatusReport.get(x).getKeyedReference().getTModelKey().equalsIgnoreCase(UDDIConstants.RELATIONSHIPS)&& assertionStatusReport.get(x).getKeyedReference().getKeyName().equalsIgnoreCase("parent-child")&& assertionStatusReport.get(x).getKeyedReference().getKeyValue().equalsIgnoreCase("child")) {
            found=true;
          }
        }
        if (!found) {
          break;
        }
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        Assert.fail("Unexpected failure " + ex.getMessage());
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertFalse("Assertion deletion wasn't replicated",found);
    logger.info("Publisher assertion deletion replicated");
    maryBizNode1.deleteMaryPublisherBusiness(maryTokenNode1);
    maryTModelNode1.deleteMaryPublisherTmodel(maryTokenNode1);
    timeout=TckPublisher.getSubscriptionTimeout();
    businessDetail=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        businessDetail=inquirySamNode2.getBusinessDetail(gbd);
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        businessDetail=null;
        break;
      }
      timeout--;
      Thread.sleep(1000);
    }
    if (businessDetail != null) {
      Assert.fail(TckBusiness.MARY_BUSINESS_KEY + " wasn't deleted on node 2");
    }
    logger.info("Mary's business deletion was replicated");
    tModelDetail=inquirySamNode2.getTModelDetail(findTModel);
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        tModelDetail=inquirySamNode2.getTModelDetail(findTModel);
        Assert.assertNotNull(tModelDetail);
        Assert.assertNotNull(tModelDetail.getTModel());
        Assert.assertNotNull(tModelDetail.getTModel().get(0));
        Assert.assertEquals(tModelDetail.getTModel().get(0).getTModelKey(),TckTModel.MARY_PUBLISHER_TMODEL_KEY);
        if (tModelDetail.getTModel().get(0).isDeleted()) {
          break;
        }
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
        tModelDetail=null;
        break;
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(tModelDetail);
    Assert.assertNotNull(tModelDetail.getTModel());
    Assert.assertNotNull(tModelDetail.getTModel().get(0));
    Assert.assertEquals(tModelDetail.getTModel().get(0).getTModelKey(),TckTModel.MARY_PUBLISHER_TMODEL_KEY);
    Assert.assertEquals(tModelDetail.getTModel().get(0).isDeleted(),true);
    logger.info("Mary's tModel was deleted(hidden) replicated");
  }
  finally {
    samBizNode2.deleteSamSyndicatorBusiness(samTokenNode2);
    resetTmodels();
    resetBusinesses();
  }
}

</code></pre>

<pre class="type-2 type-18 type-1 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * transfer business from mary/node1 to sam/node2, then delete
 * @throws Exception
 */
@Test public void testMultiNodeBusinessCustodyTransfer() throws Exception {
  logger.info("testMultiNodeBusinessCustodyTransfer");
  try {
    Assume.assumeTrue(TckPublisher.isReplicationEnabled() && TckPublisher.isCustodyTransferEnabled());
    Assume.assumeTrue(TckPublisher.isJUDDI());
    refreshTokens();
    testSetupReplicationConfig();
    getReplicationStatus();
    BusinessEntity mary=new BusinessEntity();
    mary.getName().add(new Name("Mary's biz on " + CFG_node1_MARY,null));
    mary.setBusinessServices(new BusinessServices());
    BusinessService bs=new BusinessService();
    bs.getName().add(new Name("Mary's service",null));
    bs.setBindingTemplates(new BindingTemplates());
    BindingTemplate bt=new BindingTemplate();
    bt.setAccessPoint(new AccessPoint("http://localhost/mary","wsdlDeployment"));
    bs.getBindingTemplates().getBindingTemplate().add(bt);
    mary.getBusinessServices().getBusinessService().add(bs);
    SaveBusiness sb=new SaveBusiness();
    sb.setAuthInfo(maryTokenNode1);
    sb.getBusinessEntity().add(mary);
    BusinessDetail saveBusiness=publishMary.saveBusiness(sb);
    Thread.sleep(5000);
    GetOperationalInfo operationalInfo=new GetOperationalInfo();
    operationalInfo.setAuthInfo(maryTokenNode1);
    operationalInfo.getEntityKey().add(saveBusiness.getBusinessEntity().get(0).getBusinessKey());
    OperationalInfos beforeNode1=inquiryMary.getOperationalInfo(operationalInfo);
    operationalInfo.setAuthInfo(samTokenNode2);
    OperationalInfos beforeNode2=null;
    int timeout=TckPublisher.getSubscriptionTimeout();
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        GetBusinessDetail gbd=new GetBusinessDetail();
        gbd.setAuthInfo(samTokenNode2);
        gbd.getBusinessKey().add(saveBusiness.getBusinessEntity().get(0).getBusinessKey());
        BusinessDetail businessDetail=inquirySamNode2.getBusinessDetail(gbd);
        if (businessDetail != null && !businessDetail.getBusinessEntity().isEmpty()) {
          logger.info("Mary's business exists on Sams node, grabbing the operational info to confirm ownership...");
        }
        beforeNode2=inquirySamNode2.getOperationalInfo(operationalInfo);
        break;
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(beforeNode1);
    Assert.assertNotNull(beforeNode2);
    JAXB.marshal(beforeNode1,System.out);
    JAXB.marshal(beforeNode2,System.out);
    Assert.assertEquals(beforeNode1.getOperationalInfo().get(0).getAuthorizedName(),beforeNode2.getOperationalInfo().get(0).getAuthorizedName());
    Assert.assertEquals(beforeNode1.getOperationalInfo().get(0).getEntityKey(),beforeNode2.getOperationalInfo().get(0).getEntityKey());
    Assert.assertEquals(beforeNode1.getOperationalInfo().get(0).getEntityKey(),saveBusiness.getBusinessEntity().get(0).getBusinessKey());
    Assert.assertEquals(beforeNode1.getOperationalInfo().get(0).getNodeID(),beforeNode2.getOperationalInfo().get(0).getNodeID());
    KeyBag kb=new KeyBag();
    kb.getKey().add(saveBusiness.getBusinessEntity().get(0).getBusinessKey());
    Holder<String> sourceNode=new Holder<String>();
    Holder<XMLGregorianCalendar> expiration=new Holder<XMLGregorianCalendar>();
    Holder<byte[]> token=new Holder<byte[]>();
    custodyMary.getTransferToken(maryTokenNode1,kb,sourceNode,expiration,token);
    TransferEntities transferEntities=new TransferEntities();
    transferEntities.setAuthInfo(samTokenNode2);
    transferEntities.setKeyBag(kb);
    transferEntities.setTransferToken(new TransferToken());
    transferEntities.getTransferToken().setExpirationTime(expiration.value);
    transferEntities.getTransferToken().setNodeID(sourceNode.value);
    transferEntities.getTransferToken().setOpaqueToken(token.value);
    custodySam.transferEntities(transferEntities);
    timeout=TckPublisher.getSubscriptionTimeout();
    OperationalInfos afterNode1=null;
    OperationalInfos afterNode2=null;
    while (timeout > 0) {
      logger.info("Waiting for the update...");
      try {
        operationalInfo.setAuthInfo(maryTokenNode1);
        afterNode1=inquiryMary.getOperationalInfo(operationalInfo);
        if (afterNode1.getOperationalInfo().get(0).getAuthorizedName().equals(TckPublisher.getSamPublisherId())) {
          logger.info("Mary's biz on node 1 is now owned by Sam");
          operationalInfo.setAuthInfo(samTokenNode2);
          afterNode2=inquirySamNode2.getOperationalInfo(operationalInfo);
          if (afterNode2.getOperationalInfo().get(0).getAuthorizedName().equals(TckPublisher.getSamPublisherId())) {
            logger.info("Mary's biz on node 2 is now owned by Sam");
            break;
          }
 else {
            logger.info("Mary's biz on node 2 is still owned by Mary");
          }
        }
 else {
          logger.info("Mary's biz on node 1 is still owned by Mary");
        }
      }
 catch (      Exception ex) {
        logger.warn(ex.getMessage());
      }
      timeout--;
      Thread.sleep(1000);
    }
    Assert.assertNotNull(afterNode1);
    Assert.assertNotNull(afterNode2);
    if (TckCommon.isDebug()) {
      JAXB.marshal(afterNode1,System.out);
      JAXB.marshal(afterNode2,System.out);
    }
    Assert.assertEquals(afterNode1.getOperationalInfo().get(0).getAuthorizedName(),afterNode2.getOperationalInfo().get(0).getAuthorizedName());
    Assert.assertEquals(afterNode1.getOperationalInfo().get(0).getEntityKey(),afterNode2.getOperationalInfo().get(0).getEntityKey());
    Assert.assertEquals(afterNode1.getOperationalInfo().get(0).getEntityKey(),saveBusiness.getBusinessEntity().get(0).getBusinessKey());
    Assert.assertEquals(afterNode1.getOperationalInfo().get(0).getNodeID(),afterNode2.getOperationalInfo().get(0).getNodeID());
    Assert.assertEquals(afterNode1.getOperationalInfo().get(0).getAuthorizedName(),TckPublisher.getSamPublisherId());
    Assert.assertNotEquals(beforeNode1.getOperationalInfo().get(0).getNodeID(),afterNode1.getOperationalInfo().get(0).getNodeID());
  }
  finally {
    resetTmodels();
    resetBusinesses();
  }
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void stopRegistry() throws ConfigurationException {
  if (!TckPublisher.isEnabled()) {
    return;
  }
  if (!TckPublisher.isJUDDI()) {
    return;
  }
  if (manager != null) {
    manager.stop();
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
