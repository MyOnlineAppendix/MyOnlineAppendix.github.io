<h3 style="margin:0px">Class: org.apache.sling.validation.impl.ValidationServiceImplTest (20 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="17"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('17')" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements"><kbd id="tag-17"class="label-info"style="display: inline-block;font-size:7pt" >ConditionMatcher&nbsp;(15)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(2)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="18"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('18')" data-toggle="tooltip" title="Is an empty test case"><kbd id="tag-18"class="label-info"style="display: inline-block;font-size:7pt" >EmptyTester&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-11 type-12 type-6 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithValidatorLeveragingTheResource() throws Exception {
  Validator<String> extendedValidator=new Validator<String>(){
    @Override @Nonnull public ValidationResult validate(    @Nonnull String data,    @Nonnull ValidationContext context,    @Nonnull ValueMap arguments) throws SlingValidationException {
      Resource resource=context.getResource();
      if (resource == null) {
        Assert.fail("Resource must not be null");
      }
 else {
        Assert.assertThat(resource.getPath(),Matchers.equalTo("/content/validation/1/resource"));
      }
      return DefaultValidationResult.VALID;
    }
  }
;
  propertyBuilder.validator(extendedValidator);
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  ValidationModel vm=modelBuilder.build("sometype");
  ResourceResolver rr=context.resourceResolver();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("field1","1");
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",properties,JcrConstants.NT_UNSTRUCTURED,true);
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<pre class="type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testValueMapWithEmptyOptionalValue() throws Exception {
  propertyBuilder.optional();
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"abc");
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  ValidationModel vm=modelBuilder.build("sling/validation/test");
  HashMap<String,Object> hashMap=new HashMap<String,Object>();
  hashMap.put("field1","");
  ValidationResult vr=validationService.validate(new ValueMapDecorator(hashMap),vm);
  Assert.assertFalse(vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("field1",RegexValidator.I18N_KEY_PATTERN_DOES_NOT_MATCH,"abc")));
}

</code></pre>

<pre class="type-11 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test() public void testValidateResourceRecursivelyWithMissingValidatorAndNoEnforcement() throws Exception {
  validationService.modelRetriever=new ValidationModelRetriever(){
    @Override public @CheckForNull ValidationModel getModel(    @Nonnull String resourceType,    String resourcePath,    boolean considerResourceSuperTypeModels){
      return null;
    }
  }
;
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource","resourcetype1",JcrConstants.NT_UNSTRUCTURED,true);
  ValidationResult vr=validationService.validateResourceRecursively(testResource,false,null,false);
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<pre class="type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValueMapWithCorrectDataType() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"abc");
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  propertyBuilder=new ResourcePropertyBuilder();
  final String TEST_REGEX="^test$";
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,TEST_REGEX);
  modelBuilder.resourceProperty(propertyBuilder.build("field2"));
  ValidationModel vm=modelBuilder.build("sling/validation/test");
  HashMap<String,Object> hashMap=new HashMap<String,Object>();
  hashMap.put("field1","HelloWorld");
  hashMap.put("field2","HelloWorld");
  ValidationResult vr=validationService.validate(new ValueMapDecorator(hashMap),vm);
  Assert.assertFalse(vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>hasItem(new DefaultValidationFailure("field2",RegexValidator.I18N_KEY_PATTERN_DOES_NOT_MATCH,TEST_REGEX)));
}

</code></pre>

<pre class="type-9 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test() public void testValueMapWithMissingField() throws Exception {
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  modelBuilder.resourceProperty(propertyBuilder.build("field2"));
  modelBuilder.resourceProperty(propertyBuilder.build("field3"));
  modelBuilder.resourceProperty(propertyBuilder.build("field4"));
  ValidationModel vm=modelBuilder.build("sling/validation/test");
  HashMap<String,Object> hashMap=new HashMap<String,Object>();
  hashMap.put("field1",new String[]{});
  hashMap.put("field2",new String[]{"null"});
  hashMap.put("field3","");
  ValidationResult vr=validationService.validate(new ValueMapDecorator(hashMap),vm);
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_PROPERTY_WITH_NAME,"field4")));
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithNestedChildren() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"\\d");
  ResourceProperty property=propertyBuilder.build("field1");
  ChildResource modelGrandChild=new ChildResourceImpl("grandchild",null,true,Collections.singletonList(property),Collections.<ChildResource>emptyList());
  ChildResource modelChild=new ChildResourceImpl("child",null,true,Collections.singletonList(property),Collections.singletonList(modelGrandChild));
  modelBuilder.childResource(modelChild);
  ValidationModel vm=modelBuilder.build("sometype");
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",JcrConstants.NT_UNSTRUCTURED,JcrConstants.NT_UNSTRUCTURED,true);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("field1","1");
  Resource resourceChild=rr.create(testResource,"child",properties);
  rr.create(resourceChild,"grandchild",properties);
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertThat(vr.getFailures(),Matchers.hasSize(0));
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithMissingGrandChildProperty() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"\\d");
  ResourceProperty property=propertyBuilder.build("field1");
  modelBuilder.resourceProperty(property);
  ChildResource modelGrandChild=new ChildResourceImpl("grandchild",null,true,Collections.singletonList(property),Collections.<ChildResource>emptyList());
  ChildResource modelChild=new ChildResourceImpl("child",null,true,Collections.singletonList(property),Collections.singletonList(modelGrandChild));
  modelBuilder.childResource(modelChild);
  ValidationModel vm=modelBuilder.build("sometype");
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",JcrConstants.NT_UNSTRUCTURED,JcrConstants.NT_UNSTRUCTURED,true);
  ModifiableValueMap mvm=testResource.adaptTo(ModifiableValueMap.class);
  mvm.put("field1","1");
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("field1","1");
  Resource resourceChild=rr.create(testResource,"child",properties);
  rr.create(resourceChild,"grandchild",null);
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertFalse("resource should have been considered invalid",vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("child/grandchild",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_PROPERTY_WITH_NAME,"field1")));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws LoginException, PersistenceException, RepositoryException {
  validationService=new ValidationServiceImpl();
  validationService.searchPaths=Arrays.asList(context.resourceResolver().getSearchPath());
  modelBuilder=new ValidationModelBuilder();
  propertyBuilder=new ResourcePropertyBuilder();
}

</code></pre>

<pre class="type-5 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testGetRelativeResourcePathWithAbsolutePathOutsideOfTheSearchPaths(){
  validationService.getRelativeResourceType("/apps2/relative/path");
}

</code></pre>

<pre class="type-9 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test() public void testValueMapWithWrongDataType() throws Exception {
  propertyBuilder.validator(new DateValidator());
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  ValidationModel vm=modelBuilder.build("sling/validation/test");
  HashMap<String,Object> hashMap=new HashMap<String,Object>();
  hashMap.put("field1","1");
  ValidationResult vr=validationService.validate(new ValueMapDecorator(hashMap),vm);
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("field1",ValidationServiceImpl.I18N_KEY_WRONG_PROPERTY_TYPE,Date.class)));
}

</code></pre>

<pre class="type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is an empty test case">EmptyTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is an empty test case
"></span><br>
@Test public void testGetValidationModel() throws Exception {
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithMissingOptionalChildResource() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"\\d");
  ResourceProperty property=propertyBuilder.build("field1");
  ChildResource child=new ChildResourceImpl("child",null,false,Collections.singletonList(property),Collections.<ChildResource>emptyList());
  modelBuilder.childResource(child);
  ValidationModel vm=modelBuilder.build("type");
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",JcrConstants.NT_UNSTRUCTURED,JcrConstants.NT_UNSTRUCTURED,true);
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertThat(vr.getFailures(),Matchers.hasSize(0));
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testValidateResourceRecursively() throws Exception {
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  final ValidationModel vm1=modelBuilder.build("resourcetype1");
  modelBuilder=new ValidationModelBuilder();
  modelBuilder.resourceProperty(propertyBuilder.build("field2"));
  final ValidationModel vm2=modelBuilder.build("resourcetype2");
  validationService.modelRetriever=new ValidationModelRetriever(){
    @Override public @CheckForNull ValidationModel getModel(    @Nonnull String resourceType,    String resourcePath,    boolean considerResourceSuperTypeModels){
      if (resourceType.equals("resourcetype1")) {
        return vm1;
      }
 else       if (resourceType.equals("resourcetype2")) {
        return vm2;
      }
 else {
        return null;
      }
    }
  }
;
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource","resourcetype1",JcrConstants.NT_UNSTRUCTURED,true);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put(JcrResourceConstants.SLING_RESOURCE_TYPE_PROPERTY,"resourcetype2");
  properties.put("field2","test");
  rr.create(testResource,"child1",properties);
  properties.clear();
  properties.put(JcrResourceConstants.SLING_RESOURCE_TYPE_PROPERTY,"resourcetype2");
  rr.create(testResource,"child2",properties);
  properties.clear();
  properties.put(JcrResourceConstants.SLING_RESOURCE_TYPE_PROPERTY,"resourcetype3");
  rr.create(testResource,"child3",properties);
  Predicate ignoreResourceType3Filter=new Predicate(){
    @Override public boolean evaluate(    Object object){
      Resource resource=(Resource)object;
      if ("resourcetype3".equals(resource.getResourceType())) {
        return false;
      }
      return true;
    }
  }
;
  ValidationResult vr=validationService.validateResourceRecursively(testResource,true,ignoreResourceType3Filter,false);
  Assert.assertFalse("resource should have been considered invalid",vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_PROPERTY_WITH_NAME,"field1"),new DefaultValidationFailure("child2",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_PROPERTY_WITH_NAME,"field2")));
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithMultivalueProperties() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"\\d");
  propertyBuilder.multiple();
  modelBuilder.resourceProperty(propertyBuilder.build("field"));
  ValidationModel vm=modelBuilder.build("type");
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",JcrConstants.NT_UNSTRUCTURED,JcrConstants.NT_UNSTRUCTURED,true);
  ModifiableValueMap mvm=testResource.adaptTo(ModifiableValueMap.class);
  mvm.put("field",new String[]{"1","abc","2"});
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertFalse("resource should have been considered invalid",vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("field[1]",RegexValidator.I18N_KEY_PATTERN_DOES_NOT_MATCH,"\\d")));
}

</code></pre>

<pre class="type-9 type-17 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetRelativeResourcePath(){
  Assert.assertThat(validationService.getRelativeResourceType("relative/path"),Matchers.equalTo("relative/path"));
  Assert.assertThat(validationService.getRelativeResourceType("/apps/relative/path"),Matchers.equalTo("relative/path"));
  Assert.assertThat(validationService.getRelativeResourceType("/libs/relative/path"),Matchers.equalTo("relative/path"));
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithPropertyPatternMatching() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"\\d");
  propertyBuilder.nameRegex("field.*");
  modelBuilder.resourceProperty(propertyBuilder.build("field"));
  propertyBuilder.nameRegex("otherfield.*");
  modelBuilder.resourceProperty(propertyBuilder.build("otherfield"));
  propertyBuilder.nameRegex("optionalfield.*").optional();
  modelBuilder.resourceProperty(propertyBuilder.build("optionalfield"));
  ValidationModel vm=modelBuilder.build("type");
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",JcrConstants.NT_UNSTRUCTURED,JcrConstants.NT_UNSTRUCTURED,true);
  ModifiableValueMap mvm=testResource.adaptTo(ModifiableValueMap.class);
  mvm.put("field1","1");
  mvm.put("field2","1");
  mvm.put("field3","abc");
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertFalse("resource should have been considered invalid",vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>contains(new DefaultValidationFailure("field3",RegexValidator.I18N_KEY_PATTERN_DOES_NOT_MATCH,"\\d"),new DefaultValidationFailure("",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_PROPERTY_MATCHING_PATTERN,"otherfield.*")));
}

</code></pre>

<pre class="type-5 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testValidateResourceRecursivelyWithMissingValidationModel() throws Exception {
  validationService.modelRetriever=new ValidationModelRetriever(){
    @Override public @CheckForNull ValidationModel getModel(    @Nonnull String resourceType,    String resourcePath,    boolean considerResourceSuperTypeModels){
      return null;
    }
  }
;
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource","resourcetype1",JcrConstants.NT_UNSTRUCTURED,true);
  validationService.validateResourceRecursively(testResource,true,null,false);
}

</code></pre>

<pre class="type-11 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithNestedChildrenAndPatternMatching() throws Exception {
  propertyBuilder.validator(new RegexValidator(),RegexValidator.REGEX_PARAM,"\\d");
  ResourceProperty property=propertyBuilder.build("field1");
  ChildResource modelGrandChild=new ChildResourceImpl("grandchild","grandchild.*",true,Collections.singletonList(property),Collections.<ChildResource>emptyList());
  ChildResource modelChild=new ChildResourceImpl("child","child.*",true,Collections.singletonList(property),Collections.singletonList(modelGrandChild));
  ChildResource siblingChild=new ChildResourceImpl("siblingchild","siblingchild.*",true,Collections.singletonList(property),Collections.singletonList(modelGrandChild));
  modelBuilder.childResource(modelChild);
  modelBuilder.childResource(siblingChild);
  ValidationModel vm=modelBuilder.build("sometype");
  ResourceResolver rr=context.resourceResolver();
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/apps/validation/1/resource",JcrConstants.NT_UNSTRUCTURED,JcrConstants.NT_UNSTRUCTURED,true);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("field1","1");
  Resource resourceChild=rr.create(testResource,"child1",properties);
  rr.create(resourceChild,"grandchild1",properties);
  rr.create(testResource,"child2",properties);
  rr.create(testResource,"child3",null);
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertFalse("resource should have been considered invalid",vr.isValid());
  Assert.assertThat(vr.getFailures(),Matchers.<ValidationFailure>containsInAnyOrder(new DefaultValidationFailure("child2",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_CHILD_RESOURCE_MATCHING_PATTERN,"grandchild.*"),new DefaultValidationFailure("child3",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_CHILD_RESOURCE_MATCHING_PATTERN,"grandchild.*"),new DefaultValidationFailure("child3",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_PROPERTY_WITH_NAME,"field1"),new DefaultValidationFailure("",ValidationServiceImpl.I18N_KEY_MISSING_REQUIRED_CHILD_RESOURCE_MATCHING_PATTERN,"siblingchild.*")));
}

</code></pre>

<pre class="type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testValueMapWithMissingOptionalValue() throws Exception {
  modelBuilder.resourceProperty(propertyBuilder.optional().build("field1"));
  ValidationModel vm=modelBuilder.build("sling/validation/test");
  HashMap<String,Object> hashMap=new HashMap<String,Object>();
  hashMap.put("field2","1");
  ValidationResult vr=validationService.validate(new ValueMapDecorator(hashMap),vm);
  Assert.assertThat(vr.getFailures(),Matchers.hasSize(0));
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<pre class="type-13 type-9 type-10 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidateNeverCalledWithNullValues() throws Exception {
  Validator<String> myValidator=new Validator<String>(){
    @Override public @Nonnull ValidationResult validate(    @Nonnull String data,    @Nonnull ValidationContext context,    @Nonnull ValueMap arguments) throws SlingValidationException {
      Assert.assertNotNull("data parameter for validate should never be null",data);
      Assert.assertNotNull("location of context parameter for validate should never be null",context.getLocation());
      Assert.assertNotNull("valueMap of context parameter for validate should never be null",context.getValueMap());
      Assert.assertNull("resource of context parameter for validate cannot be set if validate was called only with a value map",context.getResource());
      Assert.assertNotNull("arguments parameter for validate should never be null",arguments);
      return DefaultValidationResult.VALID;
    }
  }
;
  propertyBuilder.validator(myValidator);
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  ValidationModel vm=modelBuilder.build("sling/validation/test");
  HashMap<String,Object> hashMap=new HashMap<String,Object>();
  hashMap.put("field1","1");
  ValidationResult vr=validationService.validate(new ValueMapDecorator(hashMap),vm);
  Assert.assertThat(vr.getFailures(),Matchers.hasSize(0));
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
