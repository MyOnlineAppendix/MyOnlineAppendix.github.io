<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.sling.api.resource.ResourceUtilTest </h4><pre class="type-12 type-6 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetParentLevel() throws Exception {
  boolean caughtNullPointerException=false;
  try {
    ResourceUtil.getParent(null,4);
  }
 catch (  NullPointerException e) {
    caughtNullPointerException=true;
  }
catch (  Exception e) {
    fail("Expected NullPointerException, but caught " + e.getClass().getName() + " instead.");
  }
  if (!caughtNullPointerException) {
    fail("Expected NullPointerException, but no exception was thrown.");
  }
  boolean caughtIllegalArgumentException=false;
  try {
    ResourceUtil.getParent("/a/b",-2);
  }
 catch (  IllegalArgumentException e) {
    caughtIllegalArgumentException=true;
  }
catch (  Exception e) {
    fail("Expected IllegalArgumentException, but caught " + e.getClass().getName() + " instead.");
  }
  if (!caughtIllegalArgumentException) {
    fail("Expected IllegalArgumentException, but no exception was thrown.");
  }
  assertNull(ResourceUtil.getParent("/a",4));
  assertNull(ResourceUtil.getParent("/",1));
  assertNull(ResourceUtil.getParent("b/c",2));
  assertNull(ResourceUtil.getParent("/b/..",1));
  assertNull(ResourceUtil.getParent("b",1));
  assertNull(ResourceUtil.getParent("",3));
  assertNull(ResourceUtil.getParent("/..",1));
  assertNull(ResourceUtil.getParent("security:/b",2));
  assertNull(ResourceUtil.getParent("/b///",2));
  assertEquals("",ResourceUtil.getParent("",0));
  assertEquals("b",ResourceUtil.getParent("b",0));
  assertEquals("/",ResourceUtil.getParent("/",0));
  assertEquals("/a/b",ResourceUtil.getParent("/a/b",0));
  assertEquals("security:/b",ResourceUtil.getParent("security:/b",0));
  assertEquals("/",ResourceUtil.getParent("/b",1));
  assertEquals("b",ResourceUtil.getParent("b/c",1));
  assertEquals("b/c",ResourceUtil.getParent("b/c/d",1));
  assertEquals("/b/c",ResourceUtil.getParent("/b/c/d",1));
  assertEquals("security:/",ResourceUtil.getParent("security:/b",1));
  assertEquals("security:/b",ResourceUtil.getParent("security:/b/c",1));
  assertEquals("security:/b/c",ResourceUtil.getParent("security:/b/c/d",1));
  assertEquals("b",ResourceUtil.getParent("b/c/d",2));
  assertEquals("b/c",ResourceUtil.getParent("b/c/d/e",2));
  assertEquals("/",ResourceUtil.getParent("/b/c/d",3));
  assertEquals("/",ResourceUtil.getParent("/b///",1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.bgservlets.it.BackgroundRequestIT </h4><pre class="type-15 type-12 type-6 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTmpRequestCreatesJob() throws IOException, InterruptedException, JSONException {
  final int initialJobs=countStoredJobs();
  T.getContent(HttpTest.HTTP_BASE_URL + "/tmp.json?sling:bg=true","application/json");
  final long timeout=System.currentTimeMillis() + 10000L;
  while (true) {
    if (countStoredJobs() >= initialJobs + 1) {
      break;
    }
    if (System.currentTimeMillis() > timeout) {
      fail("Timeout waiting for background job creation");
    }
    Thread.sleep(50L);
  }
  final String path="/var/bg/jobs.tidy.1.json";
  final JSONObject json=new JSONObject(T.getContent(HttpTest.HTTP_BASE_URL + path,"application/json"));
  int matches=0;
  final Pattern instanceIdPattern=Pattern.compile("([0-9a-fA-F\\\\-]){20,}");
  final Iterator<String> it=json.keys();
  while (it.hasNext()) {
    final String key=it.next();
    if (instanceIdPattern.matcher(key).matches()) {
      matches++;
    }
  }
  if (matches == 0) {
    fail("No instance ID node found under " + path);
  }
  Thread.sleep(2000L);
  assertEquals("Expecting no extra jobs",initialJobs + 1,countStoredJobs());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.bgservlets.it.JobConsoleIT </h4><pre class="type-15 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testJobConsoleOutput() throws IOException, InterruptedException, JSONException {
  T.getContent(HttpTest.HTTP_BASE_URL + "/tmp.json?sling:bg=true","application/json");
  final long timeout=System.currentTimeMillis() + 10000L;
  final String path="/system/console/bgservlets";
  final Pattern instanceIdPattern=Pattern.compile("(?s).+([0-9a-fA-F\\\\-]){20,}.+");
  while (true) {
    final String jobConsoleContent=T.getContent(HttpTest.HTTP_BASE_URL + path,HttpTest.CONTENT_TYPE_HTML);
    if (instanceIdPattern.matcher(jobConsoleContent).matches()) {
      break;
    }
    if (System.currentTimeMillis() > timeout) {
      fail("Timeout waiting for instance ID at " + path);
    }
    Thread.sleep(50L);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.commons.osgi.BundleFileProcessorTest </h4><pre class="type-11 type-12 type-13 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBSNRenaming() throws IOException {
  File tempDir=new File(System.getProperty("java.io.tmpdir"));
  File originalFile=getMavenArtifactFile(getMavenRepoRoot(),"com.google.guava","guava","15.0");
  File generatedFile=new BSNRenamer(originalFile,tempDir,"org.acme.baklava.guava").process();
  try {
    compareJarContents(originalFile,generatedFile);
    JarFile jfOrg=null;
    JarFile jfNew=null;
    try {
      jfOrg=new JarFile(originalFile);
      jfNew=new JarFile(generatedFile);
      Manifest mfOrg=jfOrg.getManifest();
      Manifest mfNew=jfNew.getManifest();
      Attributes orgAttrs=mfOrg.getMainAttributes();
      Attributes newAttrs=mfNew.getMainAttributes();
      for (      Object key : orgAttrs.keySet()) {
        String orgVal=orgAttrs.getValue(key.toString());
        String newVal=newAttrs.getValue(key.toString());
        if ("Bundle-SymbolicName".equals(key.toString())) {
          assertEquals("Should have recorded the original Bundle-SymbolicName",orgVal,newAttrs.getValue("X-Original-Bundle-SymbolicName"));
          assertEquals("org.acme.baklava.guava",newVal);
        }
 else {
          assertEquals("Different keys: " + key,orgVal,newVal);
        }
      }
    }
  finally {
      closeQuietly(jfOrg);
      closeQuietly(jfNew);
    }
  }
  finally {
    assertTrue("Unable to delete temporary file",generatedFile.delete());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.commons.testing.junit.RetryRuleTest </h4><pre class="type-12 type-13 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Retry @Test public void testDefaultParameters(){
  callCount++;
  setupCounter++;
  if (callTime > 0) {
    final long delta=System.currentTimeMillis();
    assertTrue("Expecting at least 500 msec between calls",delta >= 500);
  }
  callTime=System.currentTimeMillis();
  assertTrue("Expecting to be called several times before passing",callCount > 3);
  assertEquals("Expecting setup() to be called before every retry",1,setupCounter);
  callTime=-1;
  callCount=0;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.crankstart.launcher.BasicLauncherIT </h4><pre class="type-15 type-11 type-12 type-13 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Retry(timeoutMsec=U.LONG_TIMEOUT_MSEC,intervalMsec=U.STD_INTERVAL) public void testSpecificStartLevel() throws Exception {
  final String symbolicName="org.apache.commons.collections";
  assertEquals("Expecting bundle " + symbolicName + " to be installed","Installed",osgiConsole.getBundleState(symbolicName));
  final JSONObject status=U.getBundleData(C,client,symbolicName);
  final JSONArray props=status.getJSONArray("data").getJSONObject(0).getJSONArray("props");
  final String KEY="key";
  final String SL="Start Level";
  boolean found=false;
  for (int i=0; i < props.length(); i++) {
    final JSONObject o=props.getJSONObject(i);
    if (o.has(KEY) && SL.equals(o.getString(KEY))) {
      found=true;
      assertEquals("Expecting the start level that's set in provisioning model","99",o.getString("value"));
    }
  }
  assertTrue("Expecting start level to be found in JSON output",found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.crankstart.launcher.NestedModelsMergerTest </h4><pre class="type-12 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNestedModelOrNot(){
  if (expectNestedModel) {
    assertTrue("Expecting a nested model for " + testArtifact,merger.isNestedModel(testArtifact));
  }
 else {
    assertFalse("Not expecting a nested model for " + testArtifact,merger.isNestedModel(testArtifact));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.discovery.base.its.AbstractClusterTest </h4><pre class="type-11 type-12 type-6 type-13 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test plan:
 * * have a discoveryservice with two listeners registered
 * * one of them (the 'first' one) is long running
 * * during one of the topology changes, when the first
 * one is hit, deactivate the discovery service
 * * that deactivation used to block (SLING-4755) due
 * to synchronized(lock) which was blocked by the
 * long running listener. With having asynchronous
 * event sending this should no longer be the case
 * * also, once asserted that deactivation finished,
 * and that the first listener is still busy, make
 * sure that once the first listener finishes, that
 * the second listener still gets the event
 * @throws Throwable 
 */
@Test public void testLongRunningListener() throws Throwable {
  instance1.getConfig().setViewCheckTimeout(2);
  instance2.getConfig().setViewCheckTimeout(2);
  logger.info("testLongRunningListener : letting instance2 remain silent from now on");
  instance1.heartbeatsAndCheckView();
  Thread.sleep(1500);
  instance1.heartbeatsAndCheckView();
  Thread.sleep(1500);
  instance1.heartbeatsAndCheckView();
  Thread.sleep(1500);
  instance1.heartbeatsAndCheckView();
  logger.info("testLongRunningListener : instance 2 should now be considered dead");
  LongRunningListener longRunningListener1=new LongRunningListener();
  AssertingTopologyEventListener fastListener2=new AssertingTopologyEventListener();
  fastListener2.addExpected(Type.TOPOLOGY_INIT);
  longRunningListener1.assertNoFail();
  assertEquals(1,fastListener2.getRemainingExpectedCount());
  logger.info("testLongRunningListener : binding longRunningListener1 ...");
  instance1.bindTopologyEventListener(longRunningListener1);
  logger.info("testLongRunningListener : binding fastListener2 ...");
  instance1.bindTopologyEventListener(fastListener2);
  logger.info("testLongRunningListener : waiting a bit for longRunningListener1 to receive the TOPOLOGY_INIT event");
  Thread.sleep(2500);
  assertEquals(0,fastListener2.getRemainingExpectedCount());
  assertTrue(longRunningListener1.initReceived);
  fastListener2.addExpected(Type.TOPOLOGY_CHANGING);
  fastListener2.addExpected(Type.TOPOLOGY_CHANGED);
  instance1.getConfig().setViewCheckTimeout(10);
  instance2.getConfig().setViewCheckTimeout(10);
  instance1.heartbeatsAndCheckView();
  instance2.heartbeatsAndCheckView();
  Thread.sleep(500);
  instance1.heartbeatsAndCheckView();
  instance2.heartbeatsAndCheckView();
  Thread.sleep(500);
  instance1.heartbeatsAndCheckView();
  instance2.heartbeatsAndCheckView();
  Thread.sleep(500);
  instance1.dumpRepo();
  longRunningListener1.assertNoFail();
  assertEquals(0,fastListener2.getUnexpectedCount());
  assertEquals(1,fastListener2.getRemainingExpectedCount());
  assertEquals(1,longRunningListener1.noninitReceived);
  Thread.sleep(2000);
  assertTrue(longRunningListener1.getChangedSemaphore().hasQueuedThreads());
  Thread.sleep(2000);
  assertEquals(0,fastListener2.getUnexpectedCount());
  assertEquals(1,fastListener2.getRemainingExpectedCount());
  assertEquals(1,longRunningListener1.noninitReceived);
  assertTrue(longRunningListener1.getChangedSemaphore().hasQueuedThreads());
  final List<Exception> asyncException=new LinkedList<Exception>();
  Thread th=new Thread(new Runnable(){
    public void run(){
      try {
        instance1.stop();
      }
 catch (      Exception e) {
synchronized (asyncException) {
          asyncException.add(e);
        }
      }
    }
  }
);
  th.start();
  logger.info("Waiting max 4 sec...");
  th.join(4000);
  logger.info("Done waiting max 4 sec...");
  if (th.isAlive()) {
    logger.warn("Thread still alive: " + th.isAlive());
    longRunningListener1.getChangedSemaphore().release();
    fail("Thread was still alive");
  }
  logger.info("Thread was no longer alive: " + th.isAlive());
synchronized (asyncException) {
    logger.info("Async exceptions: " + asyncException.size());
    if (asyncException.size() != 0) {
      longRunningListener1.getChangedSemaphore().release();
      fail("async exceptions: " + asyncException.size() + ", first: "+ asyncException.get(0));
    }
  }
  longRunningListener1.getChangedSemaphore().release();
  Thread.sleep(500);
  assertEquals(0,fastListener2.getUnexpectedCount());
  assertEquals(0,fastListener2.getRemainingExpectedCount());
  assertEquals(2,longRunningListener1.noninitReceived);
  assertFalse(longRunningListener1.getChangedSemaphore().hasQueuedThreads());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.discovery.impl.common.heartbeat.HeartbeatTest </h4><pre class="type-15 type-11 type-12 type-6 type-13 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SLING-5027 : test to reproduce the voting loop
 * (and verify that it's fixed)
 */
@Test public void testVotingLoop() throws Throwable {
  logger.info("testVotingLoop: creating slowMachine1...");
  FullJR2VirtualInstanceBuilder slowBuilder1=newBuilder();
  slowBuilder1.setDebugName("slow1").newRepository("/var/discovery/impl/",true).setConnectorPingTimeout(600).setConnectorPingInterval(999).setMinEventDelay(0);
  FullJR2VirtualInstance slowMachine1=slowBuilder1.fullBuild();
  instances.add(slowMachine1);
  SimpleTopologyEventListener slowListener1=new SimpleTopologyEventListener("slow1");
  slowMachine1.bindTopologyEventListener(slowListener1);
  logger.info("testVotingLoop: creating slowMachine2...");
  FullJR2VirtualInstanceBuilder slowBuilder2=newBuilder();
  slowBuilder2.setDebugName("slow2").useRepositoryOf(slowMachine1).setConnectorPingTimeout(600).setConnectorPingInterval(999).setMinEventDelay(0);
  FullJR2VirtualInstance slowMachine2=slowBuilder2.fullBuild();
  instances.add(slowMachine2);
  SimpleTopologyEventListener slowListener2=new SimpleTopologyEventListener("slow2");
  slowMachine2.bindTopologyEventListener(slowListener2);
  logger.info("testVotingLoop: creating fastMachine...");
  FullJR2VirtualInstanceBuilder fastBuilder=newBuilder();
  fastBuilder.setDebugName("fast").useRepositoryOf(slowMachine1).setConnectorPingTimeout(600).setConnectorPingInterval(999).setMinEventDelay(0);
  FullJR2VirtualInstance fastMachine=fastBuilder.fullBuild();
  instances.add(fastMachine);
  SimpleTopologyEventListener fastListener=new SimpleTopologyEventListener("fast");
  fastMachine.bindTopologyEventListener(fastListener);
  HeartbeatHandler hhSlow1=slowMachine1.getHeartbeatHandler();
  HeartbeatHandler hhSlow2=slowMachine2.getHeartbeatHandler();
  HeartbeatHandler hhFast=fastMachine.getHeartbeatHandler();
  Thread.sleep(1000);
  logger.info("testVotingLoop: after some initial 1sec sleep no event should yet have been sent");
  assertFalse(fastMachine.getDiscoveryService().getTopology().isCurrent());
  assertFalse(slowMachine1.getDiscoveryService().getTopology().isCurrent());
  assertFalse(slowMachine2.getDiscoveryService().getTopology().isCurrent());
  assertNull(fastListener.getLastEvent());
  assertNull(slowListener1.getLastEvent());
  assertNull(slowListener2.getLastEvent());
  logger.info("testVotingLoop: stopping voting of slowMachine1...");
  slowMachine1.stopVoting();
  logger.info("testVotingLoop: letting slow1, slow2 and fast all issue 1 heartbeat");
  hhSlow1.issueHeartbeat();
  hhSlow2.issueHeartbeat();
  hhFast.issueHeartbeat();
  logger.info("testVotingLoop: let the fast one do a checkView, thus initiate a voting");
  hhFast.doCheckView();
  Calendar previousVotedAt=null;
  for (int i=0; i < 5; i++) {
    logger.info("testVotingLoop: sleeping 1sec...");
    Thread.sleep(1000);
    logger.info("testVotingLoop: check to see that there is no voting loop...");
    ResourceResolverFactory factory=fastMachine.getResourceResolverFactory();
    ResourceResolver resourceResolver=factory.getAdministrativeResourceResolver(null);
    try {
      List<VotingView> ongoingVotings=VotingHelper.listOpenNonWinningVotings(resourceResolver,fastMachine.getFullConfig());
      assertNotNull(ongoingVotings);
      assertEquals(1,ongoingVotings.size());
      VotingView ongoingVote=ongoingVotings.get(0);
      assertFalse(ongoingVote.isWinning());
      assertFalse(ongoingVote.hasVotedYes(slowMachine1.getSlingId()));
      assertTrue(ongoingVote.hasVotedYes(slowMachine2.getSlingId()));
      final Resource memberResource=ongoingVote.getResource().getChild("members").getChild(slowMachine2.getSlingId());
      final ModifiableValueMap memberMap=memberResource.adaptTo(ModifiableValueMap.class);
      Property vote=(Property)memberMap.get("vote");
      assertEquals(Boolean.TRUE,vote.getBoolean());
      Property votedAt=(Property)memberMap.get("votedAt");
      if (previousVotedAt == null) {
        previousVotedAt=votedAt.getDate();
      }
 else {
        assertEquals(previousVotedAt,votedAt.getDate());
      }
    }
 catch (    Exception e) {
      resourceResolver.close();
      fail("Exception: " + e);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.engine.impl.request.SlingRequestProgressTrackerTest </h4><pre class="type-15 type-11 type-12 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void messageFormatting(){
  final SlingRequestProgressTracker tracker=new SlingRequestProgressTracker();
  tracker.startTimer("foo");
  tracker.log("one {0}, two {1}, three {2}","eins","zwei","drei");
  tracker.startTimer("bar");
  tracker.logTimer("bar");
  tracker.logTimer("foo");
  tracker.done();
  final String[] expected={"TIMER_START{Request Processing}\n","COMMENT timer_end format is {<elapsed msec>,<timer name>} <optional message>\n","TIMER_START{foo}\n","LOG one eins, two zwei, three drei\n","TIMER_START{bar}\n","TIMER_END{?,bar}\n","TIMER_END{?,foo}\n","TIMER_END{?,Request Processing} Request Processing\n"};
  final Iterator<String> messages=tracker.getMessages();
  int messageCounter=0;
  while (messages.hasNext()) {
    final String m=messages.next();
    final String e=expected[messageCounter++];
    if (e.startsWith("TIMER_END{")) {
      assertEquals(substringAfter(e,','),substringAfter(m,','));
    }
 else {
      assertEquals(e,m.substring(8));
    }
  }
  assertEquals(expected.length,messageCounter);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.event.it.HistoryTest </h4><pre class="type-11 type-12 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test history.
 * Start 10 jobs and cancel some of them and succeed others
 */
@Test(timeout=DEFAULT_TEST_TIMEOUT) public void testHistory() throws Exception {
  this.registerJobExecutor(TOPIC,new JobExecutor(){
    @Override public JobExecutionResult process(    final Job job,    final JobExecutionContext context){
      sleep(5L);
      final long count=job.getProperty(PROP_COUNTER,Long.class);
      if (count == 2 || count == 5 || count == 7) {
        return context.result().message(Job.JobState.ERROR.name()).cancelled();
      }
      return context.result().message(Job.JobState.SUCCEEDED.name()).succeeded();
    }
  }
);
  for (int i=0; i < 10; i++) {
    this.addJob(i);
  }
  this.sleep(200L);
  while (this.getJobManager().findJobs(JobManager.QueryType.HISTORY,TOPIC,-1,(Map<String,Object>[])null).size() < 10) {
    this.sleep(20L);
  }
  Collection<Job> col=this.getJobManager().findJobs(JobManager.QueryType.HISTORY,TOPIC,-1,(Map<String,Object>[])null);
  assertEquals(10,col.size());
  assertEquals(0,this.getJobManager().findJobs(JobManager.QueryType.ACTIVE,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(0,this.getJobManager().findJobs(JobManager.QueryType.QUEUED,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(0,this.getJobManager().findJobs(JobManager.QueryType.ALL,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(3,this.getJobManager().findJobs(JobManager.QueryType.CANCELLED,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(0,this.getJobManager().findJobs(JobManager.QueryType.DROPPED,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(3,this.getJobManager().findJobs(JobManager.QueryType.ERROR,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(0,this.getJobManager().findJobs(JobManager.QueryType.GIVEN_UP,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(0,this.getJobManager().findJobs(JobManager.QueryType.STOPPED,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(7,this.getJobManager().findJobs(JobManager.QueryType.SUCCEEDED,TOPIC,-1,(Map<String,Object>[])null).size());
  assertEquals(7,this.getJobManager().findJobs(JobManager.QueryType.SUCCEEDED,null,-1,(Map<String,Object>[])null).size());
  long last=9;
  for (  final Job j : col) {
    assertNotNull(j.getFinishedDate());
    final long count=j.getProperty(PROP_COUNTER,Long.class);
    assertEquals(last,count);
    if (count == 2 || count == 5 || count == 7) {
      assertEquals(Job.JobState.ERROR,j.getJobState());
    }
 else {
      assertEquals(Job.JobState.SUCCEEDED,j.getJobState());
    }
    assertEquals(j.getJobState().name(),j.getResultMessage());
    last--;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.hc.samples.junit.SampleJUnitTest </h4><pre class="type-12 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void checkSlingAPIBundleActive(){
  final String symbolicName="org.apache.sling.api";
  for (  Bundle b : bundleContext.getBundles()) {
    if (symbolicName.equals(b.getSymbolicName())) {
      assertEquals("Expecting " + symbolicName + " to be active",Bundle.ACTIVE,b.getState());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.i18n.it.ResourceBundleProviderIT </h4><pre class="type-12 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRepositoryName(){
  final String name=repository.getDescriptor("jcr.repository.name");
  log.info("Test running on  {} repository {}",name,repository.getDescriptor("jcr.repository.version"));
  if (System.getProperty("sling.run.modes","").contains("oak")) {
    assertEquals("Apache Jackrabbit Oak",name);
  }
 else {
    assertEquals("Jackrabbit",name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.installer.core.impl.InternalResourceTest </h4><pre class="type-15 type-11 type-12 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleProps() throws IOException {
  final String[] types=new String[]{InstallableResource.TYPE_CONFIG,InstallableResource.TYPE_PROPERTIES,null,"zip"};
  for (int i=0; i < types.length; i++) {
    final InstallableResource instRes=new InstallableResource("1",null,getSimpleDict(),null,types[i],null);
    final InternalResource ir=InternalResource.create(SCHEME,instRes);
    assertEquals(SCHEME + ":1",ir.getURL());
    assertEquals("1",ir.getId());
    assertNotNull(ir.getDictionary());
    assertIsSimpleDict(ir.getDictionary());
    assertNotNull(ir.getPrivateCopyOfDictionary());
    assertIsSimpleDict(ir.getPrivateCopyOfDictionary());
    assertNull(ir.getInputStream());
    assertNull(ir.getPrivateCopyOfFile());
    if ("zip".equals(types[i])) {
      assertEquals("zip",ir.getType());
    }
 else {
      assertEquals(InstallableResource.TYPE_PROPERTIES,ir.getType());
    }
    assertNotNull(ir.getDigest());
    assertEquals(InstallableResource.DEFAULT_PRIORITY,ir.getPriority());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.installer.factories.subsystems.base.impl.SubsystemBaseTransformerTest </h4><pre class="type-15 type-11 type-12 type-13 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOtherRunMode() throws Exception {
  SlingSettingsService slingSettings=Mockito.mock(SlingSettingsService.class);
  Mockito.when(slingSettings.getRunModes()).thenReturn(new HashSet<String>(Arrays.asList("bar","tar")));
  SubsystemBaseTransformer sbt=new SubsystemBaseTransformer(slingSettings);
  URL testArchive=getClass().getResource("/test1.subsystem-base");
  RegisteredResource resource=new TestRegisteredResource(testArchive);
  TransformationResult[] tra=sbt.transform(resource);
  assertEquals(1,tra.length);
  TransformationResult tr=tra[0];
  assertEquals("esa",tr.getResourceType());
  assertEquals("test1",tr.getId());
  DeleteOnCloseFileInputStream dcis=(DeleteOnCloseFileInputStream)tr.getInputStream();
  assertTrue("The file backing the stream should exist",dcis.file.exists());
  Set<String> foundBundles=new HashSet<>();
  try (ZipInputStream zis=new ZipInputStream(dcis);JarFile jf=new JarFile(testArchive.getFile())){
    ZipEntry ze=null;
    while ((ze=zis.getNextEntry()) != null) {
      foundBundles.add(ze.getName());
switch (ze.getName()) {
case "OSGI-INF/SUBSYSTEM.MF":
        Manifest mf=new Manifest(zis);
      Attributes attrs=mf.getMainAttributes();
    assertEquals("test1",attrs.getValue("Subsystem-SymbolicName"));
  assertEquals("osgi.subsystem.composite",attrs.getValue("Subsystem-Type"));
assertEquals("(c) 2015 yeah!",attrs.getValue("Subsystem-Copyright"));
assertEquals("Extra subsystem headers can go here including very long ones " + "that would span multiple lines in a manifest",attrs.getValue("Subsystem-Description"));
assertEquals("org.apache.sling.commons.osgi;version=2.3.0;type=osgi.bundle;start-order:=0," + "org.apache.sling.commons.json;version=2.0.12;type=osgi.bundle;start-order:=10," + "org.apache.sling.commons.mime;version=2.1.8;type=osgi.bundle;start-order:=10,"+ "org.apache.sling.commons.threads;version=3.2.0;type=osgi.bundle;start-order:=20,"+ "org.apache.sling.commons.contentdetection;version=1.0.2;type=osgi.bundle;start-order:=100",attrs.getValue("Subsystem-Content"));
break;
case "org.apache.sling.commons.osgi-2.3.0.jar":
ZipEntry oze=jf.getEntry("Potential_Bundles/0/org.apache.sling.commons.osgi-2.3.0.jar");
assertArtifactsEqual(oze.getName(),jf.getInputStream(oze),zis);
break;
case "org.apache.sling.commons.json-2.0.12.jar":
ZipEntry jze=jf.getEntry("Potential_Bundles/10/org.apache.sling.commons.json-2.0.12.jar");
assertArtifactsEqual(jze.getName(),jf.getInputStream(jze),zis);
break;
case "org.apache.sling.commons.mime-2.1.8.jar":
ZipEntry mze=jf.getEntry("Potential_Bundles/10/org.apache.sling.commons.mime-2.1.8.jar");
assertArtifactsEqual(mze.getName(),jf.getInputStream(mze),zis);
break;
case "org.apache.sling.commons.threads-3.2.0.jar":
ZipEntry tze=jf.getEntry("Potential_Bundles/20/org.apache.sling.commons.threads-3.2.0.jar");
assertArtifactsEqual(tze.getName(),jf.getInputStream(tze),zis);
break;
case "org.apache.sling.commons.contentdetection-1.0.2.jar":
ZipEntry cze=jf.getEntry("Potential_Bundles/100/org.apache.sling.commons.contentdetection-1.0.2.jar");
assertArtifactsEqual(cze.getName(),jf.getInputStream(cze),zis);
break;
}
}
}
 assertEquals(new HashSet<>(Arrays.asList("OSGI-INF/SUBSYSTEM.MF","org.apache.sling.commons.osgi-2.3.0.jar","org.apache.sling.commons.json-2.0.12.jar","org.apache.sling.commons.mime-2.1.8.jar","org.apache.sling.commons.threads-3.2.0.jar","org.apache.sling.commons.contentdetection-1.0.2.jar")),foundBundles);
assertFalse("After closing the stream the temp file should have been deleted.",dcis.file.exists());
}

</code></pre>

<br>
<pre class="type-15 type-11 type-12 type-13 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransformNoRunMode() throws Exception {
  SlingSettingsService slingSettings=Mockito.mock(SlingSettingsService.class);
  SubsystemBaseTransformer sbt=new SubsystemBaseTransformer(slingSettings);
  URL testArchive=getClass().getResource("/test1.subsystem-base");
  RegisteredResource resource=new TestRegisteredResource(testArchive);
  TransformationResult[] tra=sbt.transform(resource);
  assertEquals(1,tra.length);
  TransformationResult tr=tra[0];
  assertEquals("esa",tr.getResourceType());
  assertEquals("test1",tr.getId());
  DeleteOnCloseFileInputStream dcis=(DeleteOnCloseFileInputStream)tr.getInputStream();
  assertTrue("The file backing the stream should exist",dcis.file.exists());
  Set<String> foundBundles=new HashSet<>();
  try (ZipInputStream zis=new ZipInputStream(dcis);JarFile jf=new JarFile(testArchive.getFile())){
    ZipEntry ze=null;
    while ((ze=zis.getNextEntry()) != null) {
      foundBundles.add(ze.getName());
switch (ze.getName()) {
case "OSGI-INF/SUBSYSTEM.MF":
        Manifest mf=new Manifest(zis);
      Attributes attrs=mf.getMainAttributes();
    assertEquals("test1",attrs.getValue("Subsystem-SymbolicName"));
  assertEquals("osgi.subsystem.composite",attrs.getValue("Subsystem-Type"));
assertEquals("(c) 2015 yeah!",attrs.getValue("Subsystem-Copyright"));
assertEquals("Extra subsystem headers can go here including very long ones " + "that would span multiple lines in a manifest",attrs.getValue("Subsystem-Description"));
assertEquals("org.apache.sling.commons.osgi;version=2.3.0;type=osgi.bundle;start-order:=0," + "org.apache.sling.commons.json;version=2.0.12;type=osgi.bundle;start-order:=10," + "org.apache.sling.commons.mime;version=2.1.8;type=osgi.bundle;start-order:=10",attrs.getValue("Subsystem-Content"));
break;
case "org.apache.sling.commons.osgi-2.3.0.jar":
ZipEntry oze=jf.getEntry("Potential_Bundles/0/org.apache.sling.commons.osgi-2.3.0.jar");
assertArtifactsEqual(oze.getName(),jf.getInputStream(oze),zis);
break;
case "org.apache.sling.commons.json-2.0.12.jar":
ZipEntry jze=jf.getEntry("Potential_Bundles/10/org.apache.sling.commons.json-2.0.12.jar");
assertArtifactsEqual(jze.getName(),jf.getInputStream(jze),zis);
break;
case "org.apache.sling.commons.mime-2.1.8.jar":
ZipEntry mze=jf.getEntry("Potential_Bundles/10/org.apache.sling.commons.mime-2.1.8.jar");
assertArtifactsEqual(mze.getName(),jf.getInputStream(mze),zis);
break;
}
}
}
 assertEquals(new HashSet<>(Arrays.asList("OSGI-INF/SUBSYSTEM.MF","org.apache.sling.commons.osgi-2.3.0.jar","org.apache.sling.commons.json-2.0.12.jar","org.apache.sling.commons.mime-2.1.8.jar")),foundBundles);
assertFalse("After closing the stream the temp file should have been deleted.",dcis.file.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.installer.it.BundleInstallStressTest </h4><pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSemiRandomInstall() throws Exception {
  if (cycleCount < 1) {
    fail("Cycle count (" + cycleCount + ") should be >= 1");
  }
  final int initialBundleCount=bundleContext.getBundles().length;
  log(LogService.LOG_INFO,"Initial bundle count=" + initialBundleCount);
  logInstalledBundles();
  Object listener=this.startObservingBundleEvents();
  log(LogService.LOG_INFO,"Registering all test bundles, " + testBundles.size() + " resources");
  install(testBundles);
  BundleEvent[] installedEvents=new BundleEvent[testBundles.size()];
  for (int i=0; i < installedEvents.length; i++) {
    installedEvents[i]=new BundleEvent(null,null,org.osgi.framework.BundleEvent.INSTALLED);
  }
  this.waitForBundleEvents("All bundles should be installed",listener,expectBundlesTimeoutMsec,installedEvents);
  expectBundleCount("After installing all test bundles",initialBundleCount + testBundles.size());
  final List<File> currentInstallation=new ArrayList<File>(testBundles);
  for (int i=0; i < cycleCount; i++) {
    final long start=System.currentTimeMillis();
    log(LogService.LOG_INFO,"Test cycle " + i + ", semi-randomly selecting a subset of our test bundles");
    for (    final File f : currentInstallation) {
      log(LogService.LOG_DEBUG,"Installed bundle: " + f);
    }
    final List<File> toInstall=selectRandomBundles();
    log(LogService.LOG_INFO,"Re-registering " + toInstall.size() + " randomly selected resources (other test bundles should be uninstalled)");
    for (    final File f : toInstall) {
      log(LogService.LOG_DEBUG,"Re-Registering bundle: " + f);
    }
    int updates=0;
    int installs=0;
    for (    final File f : toInstall) {
      if (currentInstallation.contains(f)) {
        updates++;
      }
 else {
        installs++;
      }
    }
    final int removes=currentInstallation.size() - updates;
    installedEvents=new BundleEvent[removes + installs];
    for (int m=0; m < installedEvents.length; m++) {
      if (m < removes) {
        installedEvents[m]=new BundleEvent(null,null,org.osgi.framework.BundleEvent.UNINSTALLED);
      }
 else {
        installedEvents[m]=new BundleEvent(null,null,org.osgi.framework.BundleEvent.INSTALLED);
      }
    }
    log(LogService.LOG_DEBUG,"Cycle results in " + removes + " removed bundles, "+ updates+ " updated bundles, "+ installs+ " installed bundles");
    listener=this.startObservingBundleEvents();
    install(toInstall);
    this.waitForBundleEvents("All bundles should be installed in cycle " + i,listener,expectBundlesTimeoutMsec,installedEvents);
    eventsDetector.waitForNoEvents(MSEC_WITHOUT_EVENTS,expectBundlesTimeoutMsec);
    expectBundleCount("At cycle " + i,initialBundleCount + toInstall.size());
    log(LogService.LOG_INFO,"Test cycle " + i + " successful, "+ toInstall.size()+ " bundles, "+ (System.currentTimeMillis() - start)+ " msec");
    currentInstallation.clear();
    currentInstallation.addAll(toInstall);
    try {
      Thread.sleep(500);
    }
 catch (    final InterruptedException ie) {
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-12 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  setupInstaller();
  final String bf=System.getProperty(PROP_BUNDLES_FOLDER);
  if (bf == null) {
    fail("Missing system property: " + PROP_BUNDLES_FOLDER);
  }
  bundlesFolder=new File(bf);
  if (!bundlesFolder.isDirectory()) {
    fail("Bundles folder '" + bundlesFolder.getAbsolutePath() + "' not found");
  }
  final String cc=System.getProperty(PROP_CYCLE_COUNT);
  if (cc == null) {
    fail("Missing system property:" + PROP_CYCLE_COUNT);
  }
  cycleCount=Integer.parseInt(cc);
  final String et=System.getProperty(PROP_EXPECT_TIMEOUT_SECONDS);
  if (et == null) {
    fail("Missing system property:" + PROP_EXPECT_TIMEOUT_SECONDS);
  }
  expectBundlesTimeoutMsec=Integer.parseInt(et) * 1000L;
  log(LogService.LOG_INFO,getClass().getSimpleName() + ": cycle count=" + cycleCount+ ", expect timeout (msec)="+ expectBundlesTimeoutMsec+ ", test bundles folder="+ bundlesFolder.getAbsolutePath());
  testBundles=new LinkedList<File>();
  final String[] files=bundlesFolder.list();
  for (  String filename : files) {
    if (filename.endsWith(".jar")) {
      testBundles.add(new File(bundlesFolder,filename));
    }
  }
  if (testBundles.size() < MIN_TEST_BUNDLES) {
    fail("Found only " + testBundles.size() + " bundles in test folder, expected at least "+ MIN_TEST_BUNDLES+ " (test folder="+ bundlesFolder.getAbsolutePath()+ ")");
  }
  random=new Random(42 + cycleCount);
  eventsDetector=new EventsDetector(bundleContext);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.jcr.repository.it.CommonTests </h4><pre class="type-11 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testOsgiResourceEvents() throws RepositoryException {
  final ResourceEventListener listener=new ResourceEventListener();
  final ServiceRegistration reg=listener.register(bundleContext,SlingConstants.TOPIC_RESOURCE_ADDED);
  final Session s=repository.loginAdministrative(null);
  final int nPaths=2500 * TEST_SCALE;
  final int timeoutMsec=2 * nPaths;
  final String prefix=uniqueName("testOsgiResourceEvents");
  try {
    for (int i=0; i < nPaths; i++) {
      s.getRootNode().addNode(prefix + i);
    }
    s.save();
    log.info("Added {} nodes, checking what ResourceEventListener got...",nPaths);
    final long timeout=System.currentTimeMillis() + timeoutMsec;
    final Set<String> missing=new HashSet<String>();
    while (System.currentTimeMillis() < timeout) {
      missing.clear();
      final Set<String> paths=listener.getPaths();
      for (int i=0; i < nPaths; i++) {
        final String path="/" + prefix + i;
        if (!paths.contains(path)) {
          missing.add(path);
        }
      }
      if (missing.isEmpty()) {
        break;
      }
    }
    if (!missing.isEmpty()) {
      final String missingStr=missing.size() > 10 ? missing.size() + " paths missing" : missing.toString();
      fail("OSGi add resource events are missing for " + missing.size() + "/"+ nPaths+ " paths after "+ timeoutMsec+ " msec: "+ missingStr);
    }
  }
  finally {
    reg.unregister();
    s.logout();
  }
  log.info("Successfuly detected OSGi observation events for " + nPaths + " paths");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.jcr.repository.it.OakRepositoryIT </h4><pre class="type-11 type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void doCheckRepositoryDescriptors(){
  final String propName="jcr.repository.name";
  final String name=repository.getDescriptor(propName);
  final String expected="Oak";
  if (!name.contains(expected)) {
    fail("Expected repository descriptor " + propName + " to contain "+ expected+ ", failed (descriptor="+ name+ ")");
  }
  log.info("Running on Oak version {}",repository.getDescriptor("jcr.repository.version"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.jcr.resource.internal.AbstractListenerTest </h4><pre class="type-12 type-6 type-13 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleOperations() throws Exception {
  generateEvents();
  assertEquals("Received: " + events,5,events.size());
  final Set<String> addPaths=new HashSet<String>();
  final Set<String> modifyPaths=new HashSet<String>();
  final Set<String> removePaths=new HashSet<String>();
  for (  final ResourceChange event : events) {
    if (event.getType() == ChangeType.ADDED) {
      addPaths.add(event.getPath());
    }
 else     if (event.getType() == ChangeType.CHANGED) {
      modifyPaths.add(event.getPath());
      assertEquals(Collections.singleton("foo"),event.getAddedPropertyNames());
    }
 else     if (event.getType() == ChangeType.REMOVED) {
      removePaths.add(event.getPath());
    }
 else {
      fail("Unexpected event: " + event);
    }
    assertNotNull(event.getUserId());
  }
  assertEquals(3,addPaths.size());
  assertTrue("Added set should contain " + createdPath,addPaths.contains(createdPath));
  assertTrue("Added set should contain " + pathToDelete,addPaths.contains(pathToDelete));
  assertTrue("Added set should contain " + pathToModify,addPaths.contains(pathToModify));
  assertEquals(1,modifyPaths.size());
  assertTrue("Modified set should contain " + pathToModify,modifyPaths.contains(pathToModify));
  assertEquals(1,removePaths.size());
  assertTrue("Removed set should contain " + pathToDelete,removePaths.contains(pathToDelete));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.junit.remote.exported.ExampleRemoteTest </h4><pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFailsSometimes(){
  if (Math.random() < 0.5) {
    fail("This test fails sometimes");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.junit.scriptable.TestAllPaths </h4><pre class="type-12 type-6 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyContent() throws Exception {
  final TestContext ctx=ScriptableTestsProvider.getTestContext();
  final HttpRequest req=new HttpRequest(path);
  final HttpResponse resp=new HttpResponse();
  ctx.requestProcessor.processRequest(req,resp,ctx.resourceResolver);
  final String content=resp.getContent();
  assertEquals("Expecting HTTP status 200 for path " + path,200,resp.getStatus());
  boolean testSuccess=checkTest(content);
  if (!testSuccess) {
    fail("Unexpected content at path " + path + ", should be just "+ PASSED+ " (lines starting with # and empty lines are ignored)"+ "\ncontent was:\n"+ content+ "\n");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.launchpad.testservices.serversidetests.MappingEventsTest </h4><pre class="type-15 type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test SLING-4058 - unexpected timeouts in saveMappings 
 */
@Test public void testSaveMappings() throws Exception {
  final Node base=mapRoot.getNode("map/https/localhost.443");
  final MappingsFacade f=new MappingsFacade(eventsCounter);
  try {
    int count=N_STEPS;
    while (count-- > 0) {
      base.setProperty(PROP_REDIRECT_EXTERNAL,"http://somehost." + count);
      final String result=f.saveMappings(session);
      if (result != null) {
        fail(result);
      }
    }
  }
  finally {
    base.setProperty(PROP_REDIRECT_EXTERNAL,"");
    session.save();
  }
}

</code></pre>

<br>
<pre class="type-15 type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testVanityPaths() throws Exception {
  final MappingsFacade f=new MappingsFacade(eventsCounter);
  final Node vanityTest=maybeCreateNode(session.getRootNode(),"vanityTest","sling:Folder");
  toDelete.add(vanityTest.getPath());
  int count=N_STEPS;
  while (count-- > 0) {
    final String[] paths={"one","two","three_" + count};
    vanityTest.setProperty("sling:vanityPath",paths);
    final String result=f.saveMappings(session);
    if (result != null) {
      fail(result);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.launchpad.webapp.integrationtest.ServerSideScriptsTest </h4><pre class="type-12 type-6 type-9 type-3 type-19 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void runScripts() throws Exception {
  final String resourceType=RESOURCE_TYPE_PREFIX + '/' + test.testName;
  final String scriptPath="/apps/" + resourceType;
  String toDelete=null;
  try {
    this.slingClient.createNode(scriptPath,"jcr:primaryType","sling:Folder","jcr:mixinTypes","sling:Test","sling:resourceType",RESOURCE_TYPE_PREFIX + '/' + test.testName);
    toDelete=scriptPath;
    final String destPath=scriptPath + "/test.txt" + test.scriptExtension;
    logger.info("Setting up node {} for {}",destPath,test.testScriptFile.getAbsoluteFile());
    this.slingClient.upload(destPath,new FileInputStream(test.testScriptFile),-1,false);
    Thread.sleep(2000L);
    final long startTime=System.currentTimeMillis();
    final ServerSideTestClient.TestResults results=slingClient.runTests("org.apache.sling.junit.scriptable.ScriptableTestsProvider");
    assertEquals("Expecting 1 scriptable test",1,results.getTestCount());
    final int failureCount=test.willFail ? 1 : 0;
    if (results.getFailures().size() != failureCount) {
      fail("Expected " + failureCount + " failing tests but got "+ results.getFailures().size()+ " for "+ test.testScriptFile.getAbsolutePath()+ ": "+ results.getFailures());
    }
    logger.info("Execution of {} took {} msec",test,System.currentTimeMillis() - startTime);
  }
  finally {
    if (toDelete != null) {
      this.slingClient.delete(toDelete);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.launchpad.webapp.integrationtest.installer.ServerSideInstallerTest </h4><pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void noUntransformedResources(){
  final List<?> utr=is.getUntransformedResources();
  if (utr.size() > 0) {
    fail("Untransformed resources found: " + utr);
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void noDuplicates(){
  String output="";
  final List<ResourceGroup> resources=is.getInstalledResources();
  for (  final ResourceGroup group : resources) {
    if (group.getResources().size() > 1) {
      boolean first=true;
      for (      final Resource rsrc : group.getResources()) {
        if (first) {
          output+="Duplicate resources for '" + rsrc.getEntityId() + "' : ";
          first=false;
        }
 else {
          output+=", ";
        }
        output+=rsrc.getURL();
      }
      output+="\n";
    }
  }
  if (output.length() > 0) {
    fail(output);
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void noActiveResources(){
  final List<?> ar=is.getActiveResources();
  if (ar.size() > 0) {
    fail("Active resources found: " + ar);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.launchpad.webapp.integrationtest.teleporter.MultipleRulesTeleporterTest </h4><pre class="type-16 type-12 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@AfterClass public static void verifyTrace(){
  if (TeleporterRule.isServerSide()) {
    assertEquals(1,lastCounter);
    final String expected="-before-2-2--after-2--before-4-4--after-4--before-8";
    assertEquals(expected,lastTrace);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.mailarchiveserver.impl.Mime4jMboxParserImplTest </h4><pre class="type-15 type-11 type-12 type-6 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMboxParsing() throws IOException {
  Iterator<Message> iter=parser.parse(new FileInputStream(new File(TU.TEST_FOLDER,WRONGBODY_MBOX)));
  boolean fail=true;
  int i=1;
  while (iter.hasNext()) {
    final Message message=iter.next();
    File bodyFile=new File(TU.TEST_FOLDER,specialPathFromFilePath(WRONGBODY_MBOX,"_bodyOf" + i,"txt"));
    if (bodyFile.exists()) {
      final String actual=getPlainBody(message);
      final String expected=readTextFile(bodyFile);
      assertEquals("Body #" + i,expected,actual);
      fail=false;
    }
    i++;
  }
  if (fail) {
    fail("No file with expected body.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.maven.slingstart.PreparePackageMojoTest </h4><pre class="type-11 type-12 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBSNRenaming() throws Exception {
  PreparePackageMojo ppm=getMojoUnderTest("org.apache.sling/org.apache.sling.commons.classloader/1.3.2","org.apache.sling/org.apache.sling.commons.classloader/1.3.2/app","org.apache.sling/org.apache.sling.commons.json/2.0.12");
  try {
    String modelTxt="[feature name=:launchpad]\n" + "[artifacts]\n" + "  org.apache.sling/org.apache.sling.commons.classloader/1.3.2\n"+ ""+ "[feature name=rename_test]\n"+ "  org.apache.sling/org.apache.sling.commons.json/2.0.12 [bundle:rename-bsn=r-foo.bar.renamed.sling.commons.json]\n";
    Model model=ModelReader.read(new StringReader(modelTxt),null);
    ppm.execute(model);
    File orgJar=getMavenArtifactFile(getMavenRepoRoot(),"org.apache.sling","org.apache.sling.commons.json","2.0.12");
    File generatedJar=new File(ppm.getTmpDir() + "/r-foo.bar.renamed.sling.commons.json-2.0.12.jar");
    compareJarContents(orgJar,generatedJar);
    try (JarFile jfOrg=new JarFile(orgJar);JarFile jfNew=new JarFile(generatedJar)){
      Manifest mfOrg=jfOrg.getManifest();
      Manifest mfNew=jfNew.getManifest();
      Attributes orgAttrs=mfOrg.getMainAttributes();
      Attributes newAttrs=mfNew.getMainAttributes();
      for (      Object key : orgAttrs.keySet()) {
        String orgVal=orgAttrs.getValue(key.toString());
        String newVal=newAttrs.getValue(key.toString());
        if ("Bundle-SymbolicName".equals(key.toString())) {
          assertEquals("Should have recorded the original Bundle-SymbolicName",orgVal,newAttrs.getValue("X-Original-Bundle-SymbolicName"));
          assertEquals("r-foo.bar.renamed.sling.commons.json",newVal);
        }
 else {
          assertEquals("Different keys: " + key,orgVal,newVal);
        }
      }
    }
   }
  finally {
    FileUtils.deleteDirectory(new File(ppm.project.getBuild().getDirectory()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.paxexam.util.SlingRepositoryTest </h4><pre class="type-12 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNameDescriptor(){
  if (System.getProperty("sling.run.modes","").contains("oak")) {
    assertEquals("Apache Jackrabbit Oak",repository.getDescriptor("jcr.repository.name"));
  }
 else {
    assertEquals("Jackrabbit",repository.getDescriptor("jcr.repository.name"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.paxexam.util.SlingSetupTest </h4><pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSlingBundles(){
  final String[] LAUNCHPAD_7_BUNDLES={"derby","jcl.over.slf4j","log4j.over.slf4j","org.apache.aries.jmx.api","org.apache.aries.jmx.core","org.apache.aries.jmx.whiteboard","org.apache.aries.util","org.apache.commons.codec","org.apache.commons.collections","org.apache.commons.fileupload","org.apache.commons.io","org.apache.commons.lang","org.apache.commons.math","org.apache.commons.pool","org.apache.felix.bundlerepository","org.apache.felix.configadmin","org.apache.felix.eventadmin","org.apache.felix.framework","org.apache.felix.http.jetty","org.apache.felix.http.whiteboard","org.apache.felix.inventory","org.apache.felix.metatype","org.apache.felix.prefs","org.apache.felix.scr","org.apache.felix.webconsole","org.apache.felix.webconsole.plugins.ds","org.apache.felix.webconsole.plugins.event","org.apache.felix.webconsole.plugins.memoryusage","org.apache.felix.webconsole.plugins.obr","org.apache.felix.webconsole.plugins.packageadmin","org.apache.geronimo.bundles.commons-httpclient","org.apache.geronimo.bundles.json","org.apache.geronimo.bundles.jstl","org.apache.jackrabbit.jackrabbit-api","org.apache.jackrabbit.jackrabbit-jcr-commons","org.apache.jackrabbit.jackrabbit-jcr-rmi","org.apache.jackrabbit.jackrabbit-spi","org.apache.jackrabbit.jackrabbit-spi-commons","org.apache.jackrabbit.jackrabbit-webdav","org.apache.servicemix.bundles.concurrent","org.apache.sling.adapter","org.apache.sling.api","org.apache.sling.auth.core","org.apache.sling.auth.form","org.apache.sling.bundleresource.impl","org.apache.sling.commons.classloader","org.apache.sling.commons.compiler",IgnoredBundlesTest.JSON_BUNDLE_SN,"org.apache.sling.commons.log","org.apache.sling.commons.logservice",IgnoredBundlesTest.MIME_BUNDLE_SN,"org.apache.sling.commons.osgi","org.apache.sling.commons.scheduler","org.apache.sling.commons.threads","org.apache.sling.discovery.api","org.apache.sling.discovery.impl","org.apache.sling.discovery.support","org.apache.sling.engine","org.apache.sling.event","org.apache.sling.extensions.explorer","org.apache.sling.extensions.threaddump","org.apache.sling.extensions.webconsolebranding","org.apache.sling.extensions.webconsolesecurityprovider","org.apache.sling.fragment.transaction","org.apache.sling.fragment.ws","org.apache.sling.fragment.xml","org.apache.sling.fsresource","org.apache.sling.installer.console","org.apache.sling.installer.core","org.apache.sling.installer.factory.configuration","org.apache.sling.installer.provider.file","org.apache.sling.installer.provider.jcr","org.apache.sling.javax.activation","org.apache.sling.jcr.api","org.apache.sling.jcr.base","org.apache.sling.jcr.classloader","org.apache.sling.jcr.contentloader","org.apache.sling.jcr.davex","org.apache.sling.jcr.jackrabbit.accessmanager","org.apache.sling.jcr.jackrabbit.server","org.apache.sling.jcr.jackrabbit.usermanager","org.apache.sling.jcr.jcr-wrapper","org.apache.sling.jcr.registration","org.apache.sling.jcr.resource","org.apache.sling.jcr.webconsole","org.apache.sling.jcr.webdav","org.apache.sling.launchpad.content","org.apache.sling.launchpad.installer","org.apache.sling.models.api","org.apache.sling.models.impl","org.apache.sling.resourceresolver","org.apache.sling.scripting.api","org.apache.sling.scripting.core","org.apache.sling.scripting.javascript","org.apache.sling.scripting.jsp","org.apache.sling.scripting.jsp.taglib","org.apache.sling.serviceusermapper","org.apache.sling.servlets.get","org.apache.sling.servlets.post","org.apache.sling.servlets.resolver","org.apache.sling.settings","org.apache.tika.bundle","org.apache.tika.core","slf4j.api"};
  final List<String> missing=new ArrayList<String>();
  for (  String bundleName : LAUNCHPAD_7_BUNDLES) {
    final int state=getBundleState(bundleName);
    if (state != Bundle.ACTIVE) {
      missing.add(bundleName + " (state=" + state+ ")");
    }
  }
  if (!missing.isEmpty()) {
    fail("Some required bundles are missing or inactive:" + missing);
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSlingServices(){
  assertBundleActive("org.apache.sling.commons.mime");
  assertBundleActive("org.apache.sling.engine");
  final String[] services={"org.apache.sling.engine.SlingRequestProcessor","org.apache.sling.commons.mime.MimeTypeService","org.apache.sling.jcr.api.SlingRepository","org.apache.sling.settings.SlingSettingsService"};
  final List<String> missing=new ArrayList<String>();
  for (  String svc : services) {
    final ServiceReference<?> ref=bundleContext.getServiceReference(svc);
    if (ref == null) {
      missing.add(svc);
    }
 else {
      bundleContext.ungetService(ref);
    }
  }
  if (!missing.isEmpty()) {
    fail("Some required services are missing:" + missing);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.repoinit.parser.test.ParsingErrorsTest </h4><pre class="type-12 type-6 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkResult() throws ParseException, IOException {
  final StringReader r=new StringReader(input);
  try {
    new RepoInitParserImpl(r).parse();
    if (expected != null) {
      fail("Expected a " + expected.getSimpleName() + " for ["+ input+ "]");
    }
  }
 catch (  Exception e) {
    assertEquals(expected,e.getClass());
  }
catch (  Error err) {
    assertEquals(expected,err.getClass());
  }
 finally {
    r.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.resource.collection.impl.ResourceCollectionImplTest </h4><pre class="type-12 type-6 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddResourceWithProperties() throws Exception {
  final Map<String,Object> props=new HashMap<String,Object>();
  props.put("creator","slingdev");
  final ResourceCollection collection=rcm.createCollection(resResolver.getResource("/"),"collection3");
  final Resource resource=resResolver.create(resResolver.getResource("/"),"res1",Collections.singletonMap(ResourceResolver.PROPERTY_RESOURCE_TYPE,(Object)"type"));
  collection.add(resource,props);
  final Resource collectionRes=resResolver.getResource("/collection3");
  Assert.assertNotNull(collectionRes);
  Assert.assertEquals(true,collection.contains(resource));
  ValueMap vm=collection.getProperties(resource);
  if (vm != null) {
    Assert.assertEquals("slingdev",vm.get("creator",""));
  }
 else {
    Assert.fail("no resource entry in collection");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.resourcemerger.impl.MergedResourceProviderTest </h4><pre class="type-12 type-13 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetWithRelatedResource(){
  final String path="/merged/b/c/d";
  String[] relatedPaths=new String[]{null,"/merged/a","/merged/b","/merged/b/c","/merged/b/c/d","/merged/b/c/d/e","/merged/b/c/d/e/f"};
  for (  String relatedPath : relatedPaths) {
    final Resource relatedResource;
    if (relatedPath != null) {
      relatedResource=provider.getResource(ctx,relatedPath,ResourceContext.EMPTY_CONTEXT,null);
      assertNotNull("Not found: " + relatedPath,relatedResource);
    }
 else {
      relatedResource=null;
    }
    Resource resource=provider.getResource(ctx,path,ResourceContext.EMPTY_CONTEXT,relatedResource);
    assertNotNull(resource);
    assertEquals(path,resource.getPath());
    assertTrue(resource instanceof MergedResource);
    MergedResource mergedResource=(MergedResource)resource;
    List<Resource> mappedResources=mergedResource.getMappedResources();
    assertEquals(2,mappedResources.size());
    assertEquals(mappedResources.get(0).getPath(),"/libs/b/c/d");
    assertEquals(mappedResources.get(1).getPath(),"/apps/b/c/d");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.resourceresolver.impl.ResourceProviderEntryTest </h4><pre class="type-11 type-12 type-6 type-13 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveTheOnlyProvider() throws LoginException {
  long counter=1;
  providers.clear();
  for (  String path : new String[]{"/foo","/","/foo/bar"}) {
    final ResourceResolver resolver=Mockito.mock(ResourceResolver.class);
    final ResourceProvider<?> p=Mockito.mock(ResourceProvider.class);
    Mockito.when(p.getResource(Mockito.any(ResolverContext.class),Mockito.startsWith(path),Mockito.any(ResourceContext.class),Mockito.any(Resource.class))).thenReturn(new TestResource(resolver));
    ++counter;
    ResourceProviderHandler h=createRPHandler(p,"rp" + counter,counter,path);
    providers.add(h);
    this.providersBasedResolver=null;
{
      final Resource r=getResource(path);
      assertEqualsResolver(resolver,r);
      assertFalse(r instanceof SyntheticResource);
    }
    providers.remove(h);
    this.providersBasedResolver=null;
{
      final Resource r=getResource(path);
      if (r == null) {
      }
 else       if (!p.equals(r.getResourceResolver())) {
      }
 else {
        fail("Expecting inactive provider after removing it for " + path);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.resourceresolver.impl.mapping.MapEntriesTest </h4><pre class="type-11 type-12 type-13 type-9 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test_vanity_path_registration() throws Exception {
  int DEFAULT_VANITY_STATUS=333333;
  when(resourceResolverFactory.getDefaultVanityPathRedirectStatus()).thenReturn(DEFAULT_VANITY_STATUS);
  final List<Resource> resources=new ArrayList<Resource>();
  Resource justVanityPath=mock(Resource.class,"justVanityPath");
  when(justVanityPath.getPath()).thenReturn("/justVanityPath");
  when(justVanityPath.getName()).thenReturn("justVanityPath");
  when(justVanityPath.adaptTo(ValueMap.class)).thenReturn(buildValueMap("sling:vanityPath","/target/justVanityPath"));
  resources.add(justVanityPath);
  Resource badVanityPath=mock(Resource.class,"badVanityPath");
  when(badVanityPath.getPath()).thenReturn("/badVanityPath");
  when(badVanityPath.getName()).thenReturn("badVanityPath");
  when(badVanityPath.adaptTo(ValueMap.class)).thenReturn(buildValueMap("sling:vanityPath","/content/mypage/en-us-{132"));
  resources.add(badVanityPath);
  Resource redirectingVanityPath=mock(Resource.class,"redirectingVanityPath");
  when(redirectingVanityPath.getPath()).thenReturn("/redirectingVanityPath");
  when(redirectingVanityPath.getName()).thenReturn("redirectingVanityPath");
  when(redirectingVanityPath.adaptTo(ValueMap.class)).thenReturn(buildValueMap("sling:vanityPath","/target/redirectingVanityPath","sling:redirect",true));
  resources.add(redirectingVanityPath);
  Resource redirectingVanityPath301=mock(Resource.class,"redirectingVanityPath301");
  when(redirectingVanityPath301.getPath()).thenReturn("/redirectingVanityPath301");
  when(redirectingVanityPath301.getName()).thenReturn("redirectingVanityPath301");
  when(redirectingVanityPath301.adaptTo(ValueMap.class)).thenReturn(buildValueMap("sling:vanityPath","/target/redirectingVanityPath301","sling:redirect",true,"sling:redirectStatus",301));
  resources.add(redirectingVanityPath301);
  Resource vanityPathOnJcrContentParent=mock(Resource.class,"vanityPathOnJcrContentParent");
  when(vanityPathOnJcrContentParent.getPath()).thenReturn("/vanityPathOnJcrContent");
  when(vanityPathOnJcrContentParent.getName()).thenReturn("vanityPathOnJcrContent");
  Resource vanityPathOnJcrContent=mock(Resource.class,"vanityPathOnJcrContent");
  when(vanityPathOnJcrContent.getPath()).thenReturn("/vanityPathOnJcrContent/jcr:content");
  when(vanityPathOnJcrContent.getName()).thenReturn("jcr:content");
  when(vanityPathOnJcrContent.getParent()).thenReturn(vanityPathOnJcrContentParent);
  when(vanityPathOnJcrContent.adaptTo(ValueMap.class)).thenReturn(buildValueMap("sling:vanityPath","/target/vanityPathOnJcrContent"));
  resources.add(vanityPathOnJcrContent);
  when(resourceResolver.findResources(anyString(),eq("sql"))).thenAnswer(new Answer<Iterator<Resource>>(){
    public Iterator<Resource> answer(    InvocationOnMock invocation) throws Throwable {
      if (invocation.getArguments()[0].toString().contains("sling:vanityPath")) {
        return resources.iterator();
      }
 else {
        return Collections.<Resource>emptySet().iterator();
      }
    }
  }
);
  mapEntries.doInit();
  mapEntries.initializeVanityPaths();
  List<MapEntry> entries=mapEntries.getResolveMaps();
  assertEquals(8,entries.size());
  for (  MapEntry entry : entries) {
    if (entry.getPattern().contains("/target/redirectingVanityPath301")) {
      assertEquals(301,entry.getStatus());
      assertFalse(entry.isInternal());
    }
 else     if (entry.getPattern().contains("/target/redirectingVanityPath")) {
      assertEquals(DEFAULT_VANITY_STATUS,entry.getStatus());
      assertFalse(entry.isInternal());
    }
 else     if (entry.getPattern().contains("/target/justVanityPath")) {
      assertTrue(entry.isInternal());
    }
 else     if (entry.getPattern().contains("/target/vanityPathOnJcrContent")) {
      for (      String redirect : entry.getRedirect()) {
        assertFalse(redirect.contains("jcr:content"));
      }
    }
  }
  Field field=MapEntries.class.getDeclaredField("vanityTargets");
  field.setAccessible(true);
  @SuppressWarnings("unchecked") Map<String,List<String>> vanityTargets=(Map<String,List<String>>)field.get(mapEntries);
  assertEquals(4,vanityTargets.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.samples.pathbasedrtp.MappingTest </h4><pre class="type-15 type-12 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleMapping(){
  final Mapping m=new Mapping("/content:2");
  final String[][] testCases={{"/content/foo","nt:unstructured","foo"},{"/content/foo/bar","nt:unstructured","foo"},{"/not/content/foo/bar","nt:unstructured",null},{"/content/foo/bar","nt:file",null}};
  for (int i=0; i < testCases.length; i++) {
    final String[] tc=testCases[i];
    if (tc[2] == null) {
      assertNull("At index " + i,m.getResourceType(tc[0],tc[1]));
    }
 else {
      assertEquals("At index " + i,tc[2],m.getResourceType(tc[0],tc[1]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.testing.mock.jcr.ResourceUtilTest </h4><pre class="type-12 type-6 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetParentLevel() throws Exception {
  boolean caughtNullPointerException=false;
  try {
    ResourceUtil.getParent(null,4);
  }
 catch (  NullPointerException e) {
    caughtNullPointerException=true;
  }
catch (  Exception e) {
    fail("Expected NullPointerException, but caught " + e.getClass().getName() + " instead.");
  }
  if (!caughtNullPointerException) {
    fail("Expected NullPointerException, but no exception was thrown.");
  }
  boolean caughtIllegalArgumentException=false;
  try {
    ResourceUtil.getParent("/a/b",-2);
  }
 catch (  IllegalArgumentException e) {
    caughtIllegalArgumentException=true;
  }
catch (  Exception e) {
    fail("Expected IllegalArgumentException, but caught " + e.getClass().getName() + " instead.");
  }
  if (!caughtIllegalArgumentException) {
    fail("Expected IllegalArgumentException, but no exception was thrown.");
  }
  assertNull(ResourceUtil.getParent("/a",4));
  assertNull(ResourceUtil.getParent("/",1));
  assertNull(ResourceUtil.getParent("b/c",2));
  assertNull(ResourceUtil.getParent("/b/..",1));
  assertNull(ResourceUtil.getParent("b",1));
  assertNull(ResourceUtil.getParent("",3));
  assertNull(ResourceUtil.getParent("/..",1));
  assertNull(ResourceUtil.getParent("security:/b",2));
  assertNull(ResourceUtil.getParent("/b///",2));
  assertEquals("",ResourceUtil.getParent("",0));
  assertEquals("b",ResourceUtil.getParent("b",0));
  assertEquals("/",ResourceUtil.getParent("/",0));
  assertEquals("/a/b",ResourceUtil.getParent("/a/b",0));
  assertEquals("security:/b",ResourceUtil.getParent("security:/b",0));
  assertEquals("/",ResourceUtil.getParent("/b",1));
  assertEquals("b",ResourceUtil.getParent("b/c",1));
  assertEquals("b/c",ResourceUtil.getParent("b/c/d",1));
  assertEquals("/b/c",ResourceUtil.getParent("/b/c/d",1));
  assertEquals("security:/",ResourceUtil.getParent("security:/b",1));
  assertEquals("security:/b",ResourceUtil.getParent("security:/b/c",1));
  assertEquals("security:/b/c",ResourceUtil.getParent("security:/b/c/d",1));
  assertEquals("b",ResourceUtil.getParent("b/c/d",2));
  assertEquals("b/c",ResourceUtil.getParent("b/c/d/e",2));
  assertEquals("/",ResourceUtil.getParent("/b/c/d",3));
  assertEquals("/",ResourceUtil.getParent("/b///",1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.testing.mock.sling.resource.AbstractSlingCrudResourceResolverTest </h4><pre class="type-11 type-12 type-9 type-3 type-10 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatePropertyToCalendar() throws IOException {
  Resource resource1=context.resourceResolver().getResource(getTestRootResource().getPath() + "/node1");
  ValueMap props=ResourceUtil.getValueMap(resource1);
  if (getResourceResolverType() != ResourceResolverType.JCR_MOCK && getResourceResolverType() != ResourceResolverType.JCR_JACKRABBIT && getResourceResolverType() != ResourceResolverType.JCR_OAK) {
    Calendar calendarValue=props.get("dateProp",Calendar.class);
    assertNotNull(calendarValue);
    assertEquals(DATE_VALUE,calendarValue.getTime());
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateProperty() throws IOException {
  Resource resource1=context.resourceResolver().getResource(getTestRootResource().getPath() + "/node1");
  ValueMap props=ResourceUtil.getValueMap(resource1);
  if (getResourceResolverType() != ResourceResolverType.JCR_MOCK && getResourceResolverType() != ResourceResolverType.JCR_JACKRABBIT && getResourceResolverType() != ResourceResolverType.JCR_OAK) {
    assertEquals(DATE_VALUE,props.get("dateProp",Date.class));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.testing.samples.integrationtests.serverside.scriptable.ScriptableTestsTest </h4><pre class="type-12 type-6 type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScriptableTest() throws Exception {
  final RequestExecutor executor=testClient.runTests("org.apache.sling.junit.scriptable.ScriptableTestsProvider",null,"json");
  executor.assertContentType("application/json");
  final JSONArray json=new JSONArray(new JSONTokener((executor.getContent())));
  int testsCount=0;
  final List<String> failures=new ArrayList<String>();
  for (int i=0; i < json.length(); i++) {
    final JSONObject obj=json.getJSONObject(i);
    if ("test".equals(obj.getString("INFO_TYPE"))) {
      testsCount++;
      if (obj.has("failure")) {
        failures.add(obj.get("failure").toString());
      }
    }
  }
  final int expectedTests=1;
  assertEquals("Expecting " + expectedTests + " scriptable tests",expectedTests,testsCount);
  if (failures.size() != failureCount) {
    fail("Expected " + failureCount + " failing tests but got "+ failures.size()+ ": "+ failures);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.validation.impl.ValidationServiceImplTest </h4><pre class="type-11 type-12 type-6 type-13 type-9 type-17 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResourceWithValidatorLeveragingTheResource() throws Exception {
  Validator<String> extendedValidator=new Validator<String>(){
    @Override @Nonnull public ValidationResult validate(    @Nonnull String data,    @Nonnull ValidationContext context,    @Nonnull ValueMap arguments) throws SlingValidationException {
      Resource resource=context.getResource();
      if (resource == null) {
        Assert.fail("Resource must not be null");
      }
 else {
        Assert.assertThat(resource.getPath(),Matchers.equalTo("/content/validation/1/resource"));
      }
      return DefaultValidationResult.VALID;
    }
  }
;
  propertyBuilder.validator(extendedValidator);
  modelBuilder.resourceProperty(propertyBuilder.build("field1"));
  ValidationModel vm=modelBuilder.build("sometype");
  ResourceResolver rr=context.resourceResolver();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("field1","1");
  Resource testResource=ResourceUtil.getOrCreateResource(rr,"/content/validation/1/resource",properties,JcrConstants.NT_UNSTRUCTURED,true);
  ValidationResult vr=validationService.validate(testResource,vm);
  Assert.assertTrue(vr.isValid());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sling.xss.impl.XSSAPIImplTest </h4><pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetValidCSSColor(){
  String[][] testData={{null,RUBBISH},{"",RUBBISH},{"rgb(0,+0,-0)","rgb(0,+0,-0)"},{"rgba ( 0\f%, 0%,\t0%,\n100%\r)","rgba ( 0\f%, 0%,\t0%,\n100%\r)"},{"#ddd","#ddd"},{"#eeeeee","#eeeeee"},{"hsl(0,1,2)","hsl(0,1,2)"},{"hsla(0,1,2,3)","hsla(0,1,2,3)"},{"currentColor","currentColor"},{"transparent","transparent"},{"\f\r\n\t MenuText\f\r\n\t ","MenuText"},{"expression(99,99,99)",RUBBISH},{"blue;",RUBBISH},{"url(99,99,99)",RUBBISH}};
  for (  String[] aTestData : testData) {
    String source=aTestData[0];
    String expected=aTestData[1];
    String result=xssAPI.getValidCSSColor(source,RUBBISH);
    if (!result.equals(expected)) {
      fail("Validating CSS Color '" + source + "', expecting '"+ expected+ "', but got '"+ result+ "'");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetValidJSON(){
  String[][] testData={{null,RUBBISH_JSON},{"",""},{"1]",RUBBISH_JSON},{"{}","{}"},{"{1}",RUBBISH_JSON},{"{test: 'test'}","{\"test\":\"test\"}"},{"{test:\"test}",RUBBISH_JSON},{"{test1:'test1', test2: {test21: 'test21', test22: 'test22'}}","{\"test1\":\"test1\",\"test2\":{\"test21\":\"test21\",\"test22\":\"test22\"}}"},{"[]","[]"},{"[1,2]","[1,2]"},{"[1",RUBBISH_JSON},{"[{test: 'test'}]","[{\"test\":\"test\"}]"}};
  for (  String[] aTestData : testData) {
    String source=aTestData[0];
    String expected=aTestData[1];
    String result=xssAPI.getValidJSON(source,RUBBISH_JSON);
    if (!result.equals(expected)) {
      fail("Validating JSON '" + source + "', expecting '"+ expected+ "', but got '"+ result+ "'");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetValidMultiLineComment(){
  String[][] testData={{null,RUBBISH},{"blah */ hack",RUBBISH},{"Valid comment","Valid comment"}};
  for (  String[] aTestData : testData) {
    String source=aTestData[0];
    String expected=aTestData[1];
    String result=xssAPI.getValidMultiLineComment(source,RUBBISH);
    if (!result.equals(expected)) {
      fail("Validating multiline comment '" + source + "', expecting '"+ expected+ "', but got '"+ result+ "'");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetValidStyleToken(){
  String[][] testData={{null,RUBBISH},{"",RUBBISH},{"}",RUBBISH},{"br\neak",RUBBISH},{"javascript:alert(1)",RUBBISH},{"'javascript:alert(1)'",RUBBISH},{"\"javascript:alert('XSS')\"",RUBBISH},{"url(javascript:alert(1))",RUBBISH},{"url('javascript:alert(1)')",RUBBISH},{"url(\"javascript:alert('XSS')\")",RUBBISH},{"expression(alert(1))",RUBBISH},{"expression  (alert(1))",RUBBISH},{"expression(this.location='a.co')",RUBBISH},{"</style><script>alert(1)</script>",RUBBISH},{"background-color","background-color"},{"-moz-box-sizing","-moz-box-sizing"},{".42%",".42%"},{"#fff","#fff"},{"'literal string'","'literal string'"},{"\"literal string\"","\"literal string\""},{"'it\\'s here'","'it\\'s here'"},{"\"it\\\"s here\"","\"it\\\"s here\""},{"\"bad string",RUBBISH},{"'it's here'",RUBBISH},{"\"it\"s here\"",RUBBISH},{"rgb(255, 255, 255)","rgb(255, 255, 255)"},{"rgb(255, 255, 255",RUBBISH},{"255, 255, 255)",RUBBISH},{"url(http://example.com/test.png)","url(http://example.com/test.png)"},{"url('image/test.png')","url('image/test.png')"},{"color: red",RUBBISH}};
  for (  String[] aTestData : testData) {
    String source=aTestData[0];
    String expected=aTestData[1];
    String result=xssAPI.getValidStyleToken(source,RUBBISH);
    if (!result.equals(expected)) {
      fail("Validating style token '" + source + "', expecting '"+ expected+ "', but got '"+ result+ "'");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetValidXML(){
  String[][] testData={{null,RUBBISH_XML},{"",""},{"<t/>","<t/>"},{"<t>",RUBBISH_XML},{"<t>test</t>","<t>test</t>"},{"<t>test",RUBBISH_XML},{"<t t=\"t\">test</t>","<t t=\"t\">test</t>"},{"<t t=\"t>test</t>",RUBBISH_XML},{"<t><w>xyz</w></t>","<t><w>xyz</w></t>"},{"<t><w>xyz</t></w>",RUBBISH_XML}};
  for (  String[] aTestData : testData) {
    String source=aTestData[0];
    String expected=aTestData[1];
    String result=xssAPI.getValidXML(source,RUBBISH_XML);
    if (!result.equals(expected)) {
      fail("Validating XML '" + source + "', expecting '"+ expected+ "', but got '"+ result+ "'");
    }
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
