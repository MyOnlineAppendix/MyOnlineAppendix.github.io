<h3 style="margin:0px">Class: org.apache.archiva.webdav.ArchivaDavResourceFactoryTest (8 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-11 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After @Override public void tearDown() throws Exception {
  super.tearDown();
}

</code></pre>

<pre class="type-10 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestMetadataRepoIsLegacy() throws Exception {
  defaultManagedRepositoryAdmin.addManagedRepository(createManagedRepository(LEGACY_REPO,new File("target/test-classes/" + LEGACY_REPO).getPath(),"legacy"),false,null);
  DavResourceLocator locator=new ArchivaDavResourceLocator("","/repository/" + LEGACY_REPO + "/eclipse/maven-metadata.xml",LEGACY_REPO,new ArchivaDavLocatorFactory());
  ManagedRepositoryContent legacyRepo=createManagedRepositoryContent(LEGACY_REPO);
  RepositoryRequest repoRequest=new RepositoryRequest();
  resourceFactory.setRepositoryRequest(repoRequest);
  try {
    archivaConfigurationControl.reset();
    expect(archivaConfiguration.getConfiguration()).andReturn(config).times(2);
    expect(repoFactory.getManagedRepositoryContent(LEGACY_REPO)).andReturn(legacyRepo);
    expect(request.getMethod()).andReturn("GET").times(3);
    expect(request.getRemoteAddr()).andReturn("http://localhost:8080").times(3);
    expect(request.getDavSession()).andReturn(new ArchivaDavSession()).times(2);
    expect(request.getContextPath()).andReturn("").times(2);
    archivaConfigurationControl.replay();
    repoContentFactoryControl.replay();
    requestControl.replay();
    resourceFactory.createResource(locator,request,response);
    archivaConfigurationControl.verify();
    repoContentFactoryControl.verify();
    requestControl.verify();
    fail("A 404 error should have been thrown!");
  }
 catch (  DavException e) {
    assertEquals(404,e.getErrorCode());
  }
}

</code></pre>

<pre class="type-10 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequestArtifactMetadataTwoPartsRepoHasDefaultLayout() throws Exception {
  DavResourceLocator locator=new ArchivaDavResourceLocator("","/repository/" + INTERNAL_REPO + "/eclipse/maven-metadata.xml",INTERNAL_REPO,new ArchivaDavLocatorFactory());
  ManagedRepositoryContent internalRepo=createManagedRepositoryContent(INTERNAL_REPO);
  RepositoryRequest repoRequest=new RepositoryRequest();
  resourceFactory.setRepositoryRequest(repoRequest);
  try {
    archivaConfigurationControl.reset();
    expect(archivaConfiguration.getConfiguration()).andReturn(config).times(2);
    expect(repoFactory.getManagedRepositoryContent(INTERNAL_REPO)).andReturn(internalRepo);
    expect(request.getMethod()).andReturn("GET").times(3);
    expect(request.getRemoteAddr()).andReturn("http://localhost:8080").times(3);
    expect(request.getDavSession()).andReturn(new ArchivaDavSession()).times(2);
    expect(request.getContextPath()).andReturn("").times(2);
    archivaConfigurationControl.replay();
    repoContentFactoryControl.replay();
    requestControl.replay();
    resourceFactory.createResource(locator,request,response);
    archivaConfigurationControl.verify();
    repoContentFactoryControl.verify();
    requestControl.verify();
    fail("A 404 error should have been thrown!");
  }
 catch (  DavException e) {
    assertEquals(404,e.getErrorCode());
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before @Override public void setUp() throws Exception {
  super.setUp();
  requestControl=createControl();
  request=requestControl.createMock(DavServletRequest.class);
  responseControl=createControl();
  response=responseControl.createMock(DavServletResponse.class);
  archivaConfigurationControl=createControl();
  archivaConfiguration=archivaConfigurationControl.createMock(ArchivaConfiguration.class);
  config=new Configuration();
  expect(archivaConfiguration.getConfiguration()).andReturn(config).times(5,20);
  archivaConfiguration.save(config);
  expectLastCall().times(1,4);
  archivaConfigurationControl.replay();
  defaultManagedRepositoryAdmin.setArchivaConfiguration(archivaConfiguration);
  ((DefaultRepositoryCommonValidator)defaultManagedRepositoryAdmin.getRepositoryCommonValidator()).setArchivaConfiguration(archivaConfiguration);
  if (defaultManagedRepositoryAdmin.getManagedRepository(RELEASES_REPO) == null) {
    defaultManagedRepositoryAdmin.addManagedRepository(createManagedRepository(RELEASES_REPO,new File("target/test-classes/" + RELEASES_REPO).getPath(),"default"),false,null);
  }
  if (defaultManagedRepositoryAdmin.getManagedRepository(INTERNAL_REPO) == null) {
    defaultManagedRepositoryAdmin.addManagedRepository(createManagedRepository(INTERNAL_REPO,new File("target/test-classes/" + INTERNAL_REPO).getPath(),"default"),false,null);
  }
  RepositoryGroup repoGroupConfig=new RepositoryGroup();
  repoGroupConfig.setId(LOCAL_REPO_GROUP);
  repoGroupConfig.addRepository(RELEASES_REPO);
  repoGroupConfig.addRepository(INTERNAL_REPO);
  defaultRepositoryGroupAdmin.setArchivaConfiguration(archivaConfiguration);
  if (defaultManagedRepositoryAdmin.getManagedRepository(LOCAL_REPO_GROUP) == null) {
    defaultRepositoryGroupAdmin.addRepositoryGroup(repoGroupConfig,null);
  }
  repoContentFactoryControl=createControl();
  repoFactory=repoContentFactoryControl.createMock(RepositoryContentFactory.class);
  repoRequestControl=createControl();
  repoRequest=repoRequestControl.createMock(RepositoryRequest.class);
  resourceFactory=new OverridingArchivaDavResourceFactory(applicationContext,plexusSisuBridge,archivaConfiguration);
  resourceFactory.setArchivaConfiguration(archivaConfiguration);
  resourceFactory.setRepositoryFactory(repoFactory);
  resourceFactory.setRepositoryRequest(repoRequest);
  resourceFactory.setConnectors(new OverridingRepositoryProxyConnectors());
  resourceFactory.setRemoteRepositoryAdmin(remoteRepositoryAdmin);
  resourceFactory.setManagedRepositoryAdmin(defaultManagedRepositoryAdmin);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRequestArtifactMetadataThreePartsRepoHasDefaultLayout() throws Exception {
  DavResourceLocator locator=new ArchivaDavResourceLocator("","/repository/" + INTERNAL_REPO + "/eclipse/jdtcore/maven-metadata.xml",INTERNAL_REPO,new ArchivaDavLocatorFactory());
  ManagedRepositoryContent internalRepo=createManagedRepositoryContent(INTERNAL_REPO);
  RepositoryRequest repoRequest=new RepositoryRequest();
  resourceFactory.setRepositoryRequest(repoRequest);
  try {
    archivaConfigurationControl.reset();
    expect(archivaConfiguration.getConfiguration()).andReturn(config).times(2);
    expect(repoFactory.getManagedRepositoryContent(INTERNAL_REPO)).andReturn(internalRepo);
    expect(request.getMethod()).andReturn("GET").times(4);
    expect(request.getRemoteAddr()).andReturn("http://localhost:8080").times(3);
    expect(request.getContextPath()).andReturn("").times(1);
    expect(request.getDavSession()).andReturn(new ArchivaDavSession()).times(2);
    expect(request.getRequestURI()).andReturn("http://localhost:8080/archiva/repository/" + INTERNAL_REPO + "/eclipse/jdtcore/maven-metadata.xml");
    response.setHeader("Pragma","no-cache");
    expectLastCall();
    response.setHeader("Cache-Control","no-cache");
    expectLastCall();
    response.setDateHeader(eq("Last-Modified"),anyLong());
    expectLastCall();
    archivaConfigurationControl.replay();
    repoContentFactoryControl.replay();
    requestControl.replay();
    responseControl.replay();
    resourceFactory.createResource(locator,request,response);
    archivaConfigurationControl.verify();
    repoContentFactoryControl.verify();
    requestControl.verify();
    responseControl.verify();
  }
 catch (  DavException e) {
    fail("A DavException should not have been thrown!");
  }
}

</code></pre>

<pre class="type-10 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepositoryGroupArtifactDoesNotExistInAnyOfTheReposAuthenticationDisabled() throws Exception {
  DavResourceLocator locator=new ArchivaDavResourceLocator("","/repository/" + LOCAL_REPO_GROUP + "/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",LOCAL_REPO_GROUP,new ArchivaDavLocatorFactory());
  defaultManagedRepositoryAdmin.addManagedRepository(createManagedRepository(LOCAL_MIRROR_REPO,new File("target/test-classes/local-mirror").getPath(),"default"),false,null);
  List<RepositoryGroupConfiguration> repoGroups=new ArrayList<>();
  RepositoryGroupConfiguration repoGroup=new RepositoryGroupConfiguration();
  repoGroup.setId(LOCAL_REPO_GROUP);
  repoGroup.addRepository(INTERNAL_REPO);
  repoGroup.addRepository(LOCAL_MIRROR_REPO);
  repoGroups.add(repoGroup);
  config.setRepositoryGroups(repoGroups);
  ManagedRepositoryContent internalRepo=createManagedRepositoryContent(INTERNAL_REPO);
  ManagedRepositoryContent localMirrorRepo=createManagedRepositoryContent(LOCAL_MIRROR_REPO);
  try {
    archivaConfigurationControl.reset();
    expect(archivaConfiguration.getConfiguration()).andReturn(config).times(3);
    expect(request.getMethod()).andReturn("GET").times(5);
    expect(request.getPathInfo()).andReturn("org/apache/archiva").times(0,2);
    expect(repoFactory.getManagedRepositoryContent(INTERNAL_REPO)).andReturn(internalRepo);
    expect(repoFactory.getManagedRepositoryContent(LOCAL_MIRROR_REPO)).andReturn(localMirrorRepo);
    expect(request.getRemoteAddr()).andReturn("http://localhost:8080").times(4);
    expect(request.getDavSession()).andReturn(new ArchivaDavSession()).times(4);
    expect(request.getContextPath()).andReturn("").times(2);
    expect(repoRequest.isSupportFile("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false).times(2);
    expect(repoRequest.isDefault("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false).times(2);
    expect(repoRequest.toArtifactReference("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(null).times(2);
    expect(repoRequest.toNativePath("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",internalRepo)).andReturn(new File(config.findManagedRepositoryById(INTERNAL_REPO).getLocation(),"target/test-classes/internal/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar").getPath());
    expect(repoRequest.toNativePath("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",localMirrorRepo)).andReturn(new File(config.findManagedRepositoryById(LOCAL_MIRROR_REPO).getLocation(),"target/test-classes/internal/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar").getPath());
    expect(repoRequest.isArchetypeCatalog("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false).times(2);
    archivaConfigurationControl.replay();
    requestControl.replay();
    repoContentFactoryControl.replay();
    repoRequestControl.replay();
    resourceFactory.createResource(locator,request,response);
    archivaConfigurationControl.verify();
    requestControl.verify();
    repoContentFactoryControl.verify();
    repoRequestControl.verify();
    fail("A DavException with 404 error code should have been thrown.");
  }
 catch (  DavException e) {
    assertEquals(404,e.getErrorCode());
  }
}

</code></pre>

<pre class="type-10 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepositoryGroupLastRepositoryRequiresAuthentication() throws Exception {
  DavResourceLocator locator=new ArchivaDavResourceLocator("","/repository/" + LOCAL_REPO_GROUP + "/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",LOCAL_REPO_GROUP,new ArchivaDavLocatorFactory());
  List<RepositoryGroupConfiguration> repoGroups=new ArrayList<>();
  RepositoryGroupConfiguration repoGroup=new RepositoryGroupConfiguration();
  repoGroup.setId(LOCAL_REPO_GROUP);
  repoGroup.addRepository(INTERNAL_REPO);
  repoGroup.addRepository(RELEASES_REPO);
  repoGroups.add(repoGroup);
  config.setRepositoryGroups(repoGroups);
  ManagedRepositoryContent internalRepo=createManagedRepositoryContent(INTERNAL_REPO);
  ManagedRepositoryContent releasesRepo=createManagedRepositoryContent(RELEASES_REPO);
  try {
    archivaConfigurationControl.reset();
    expect(archivaConfiguration.getConfiguration()).andReturn(config).times(3);
    expect(request.getMethod()).andReturn("GET").times(3);
    expect(request.getPathInfo()).andReturn("org/apache/archiva").times(0,2);
    expect(repoFactory.getManagedRepositoryContent(INTERNAL_REPO)).andReturn(internalRepo);
    expect(repoFactory.getManagedRepositoryContent(RELEASES_REPO)).andReturn(releasesRepo);
    expect(request.getRemoteAddr()).andReturn("http://localhost:8080").times(2);
    expect(request.getDavSession()).andReturn(new ArchivaDavSession()).times(2);
    expect(request.getContextPath()).andReturn("").times(2);
    expect(repoRequest.isSupportFile("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false);
    expect(repoRequest.isDefault("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false);
    expect(repoRequest.toArtifactReference("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(null);
    expect(repoRequest.toNativePath("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",internalRepo)).andReturn(new File(config.findManagedRepositoryById(INTERNAL_REPO).getLocation(),"target/test-classes/internal/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar").getPath());
    expect(repoRequest.isArchetypeCatalog("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false);
    archivaConfigurationControl.replay();
    requestControl.replay();
    repoContentFactoryControl.replay();
    repoRequestControl.replay();
    resourceFactory.createResource(locator,request,response);
    archivaConfigurationControl.verify();
    requestControl.verify();
    repoContentFactoryControl.verify();
    repoRequestControl.verify();
    fail("A DavException with 401 error code should have been thrown.");
  }
 catch (  DavException e) {
    assertEquals(401,e.getErrorCode());
  }
}

</code></pre>

<pre class="type-10 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepositoryGroupFirstRepositoryRequiresAuthentication() throws Exception {
  DavResourceLocator locator=new ArchivaDavResourceLocator("","/repository/" + LOCAL_REPO_GROUP + "/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",LOCAL_REPO_GROUP,new ArchivaDavLocatorFactory());
  ManagedRepositoryContent internalRepo=createManagedRepositoryContent(INTERNAL_REPO);
  ManagedRepositoryContent releasesRepo=createManagedRepositoryContent(RELEASES_REPO);
  try {
    archivaConfigurationControl.reset();
    expect(archivaConfiguration.getConfiguration()).andReturn(config).times(3);
    expect(request.getMethod()).andReturn("GET").times(3);
    expect(request.getPathInfo()).andReturn("org/apache/archiva").times(0,2);
    expect(repoFactory.getManagedRepositoryContent(RELEASES_REPO)).andReturn(releasesRepo);
    expect(request.getRemoteAddr()).andReturn("http://localhost:8080").times(2);
    expect(request.getDavSession()).andReturn(new ArchivaDavSession()).times(2);
    expect(request.getContextPath()).andReturn("").times(2);
    expect(repoRequest.isSupportFile("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(true);
    expect(repoRequest.isDefault("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false);
    expect(repoRequest.toArtifactReference("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(null);
    expect(repoRequest.toNativePath("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar",internalRepo)).andReturn(new File(config.findManagedRepositoryById(INTERNAL_REPO).getLocation(),"target/test-classes/internal/org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar").getPath());
    expect(repoFactory.getManagedRepositoryContent(INTERNAL_REPO)).andReturn(internalRepo);
    expect(repoRequest.isArchetypeCatalog("org/apache/archiva/archiva/1.2-SNAPSHOT/archiva-1.2-SNAPSHOT.jar")).andReturn(false);
    archivaConfigurationControl.replay();
    requestControl.replay();
    repoContentFactoryControl.replay();
    repoRequestControl.replay();
    resourceFactory.createResource(locator,request,response);
    archivaConfigurationControl.verify();
    requestControl.verify();
    repoContentFactoryControl.verify();
    repoRequestControl.verify();
    fail("A DavException with 401 error code should have been thrown.");
  }
 catch (  DavException e) {
    assertEquals(401,e.getErrorCode());
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
