<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.archiva.admin.repository.managed.ManagedRepositoryAdminTest </h4><pre class="type-9 type-3 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addDeleteManagedRepoWithStaged() throws Exception {
  File repoDir=clearRepoLocation(repoLocation);
  mockAuditListener.clearEvents();
  List<ManagedRepository> repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  int initialSize=repos.size();
  assertTrue(initialSize > 0);
  ManagedRepository repo=new ManagedRepository();
  repo.setId(repoId);
  repo.setName("test repo");
  repo.setLocation(repoLocation);
  repo.setCronExpression("0 0 * * * ?");
  managedRepositoryAdmin.addManagedRepository(repo,true,getFakeAuditInformation());
  repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertEquals(initialSize + 2,repos.size());
  assertNotNull(managedRepositoryAdmin.getManagedRepository(repoId));
  assertTemplateRoleExists(repoId);
  assertTrue(repoDir.exists());
  assertNotNull(managedRepositoryAdmin.getManagedRepository(repoId + STAGE_REPO_ID_END));
  assertTemplateRoleExists(repoId + STAGE_REPO_ID_END);
  assertTrue(new File(repoLocation + STAGE_REPO_ID_END).exists());
  managedRepositoryAdmin.deleteManagedRepository(repoId,getFakeAuditInformation(),true);
  assertFalse(repoDir.exists());
  assertFalse(new File(repoLocation + STAGE_REPO_ID_END).exists());
  assertTemplateRoleNotExists(repoId + STAGE_REPO_ID_END);
  repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertEquals(initialSize,repos.size());
  assertTemplateRoleNotExists(repoId);
  assertTemplateRoleNotExists(repoId + STAGE_REPO_ID_END);
  mockAuditListener.clearEvents();
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addDeleteManagedRepo() throws Exception {
  mockAuditListener.clearEvents();
  File repoDir=clearRepoLocation(repoLocation);
  List<ManagedRepository> repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  int initialSize=repos.size();
  assertTrue(initialSize > 0);
  ManagedRepository repo=new ManagedRepository();
  repo.setId(repoId);
  repo.setName("test repo");
  repo.setLocation(repoLocation);
  repo.setCronExpression("0 0 * * * ?");
  repo.setDescription("cool repo");
  managedRepositoryAdmin.addManagedRepository(repo,false,getFakeAuditInformation());
  repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertEquals(initialSize + 1,repos.size());
  ManagedRepository managedRepository=managedRepositoryAdmin.getManagedRepository(repoId);
  assertNotNull(managedRepository);
  assertEquals("test repo",managedRepository.getName());
  assertEquals("cool repo",managedRepository.getDescription());
  assertTemplateRoleExists(repoId);
  managedRepositoryAdmin.deleteManagedRepository(repoId,getFakeAuditInformation(),false);
  assertTrue(repoDir.exists());
  repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertEquals(initialSize,repos.size());
  assertTemplateRoleNotExists(repoId);
  assertEquals(2,mockAuditListener.getAuditEvents().size());
  assertAuditListenerCallAddAndDelete();
  mockAuditListener.clearEvents();
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateDeleteManagedRepoWithStagedRepo() throws Exception {
  String stageRepoLocation=APPSERVER_BASE_PATH + File.separator + repoId;
  File repoDir=clearRepoLocation(repoLocation);
  mockAuditListener.clearEvents();
  List<ManagedRepository> repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  int initialSize=repos.size();
  assertTrue(initialSize > 0);
  ManagedRepository repo=getTestManagedRepository(repoId,repoLocation);
  managedRepositoryAdmin.addManagedRepository(repo,false,getFakeAuditInformation());
  assertTemplateRoleExists(repoId);
  assertFalse(new File(repoLocation + STAGE_REPO_ID_END).exists());
  assertTemplateRoleNotExists(repoId + STAGE_REPO_ID_END);
  repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertEquals(initialSize + 1,repos.size());
  repo=managedRepositoryAdmin.getManagedRepository(repoId);
  assertEquals(getTestManagedRepository(repoId,repoLocation).getIndexDirectory(),repo.getIndexDirectory());
  String newName="test repo update";
  repo.setName(newName);
  repo.setLocation(repoLocation);
  managedRepositoryAdmin.updateManagedRepository(repo,true,getFakeAuditInformation(),false);
  repo=managedRepositoryAdmin.getManagedRepository(repoId);
  assertNotNull(repo);
  assertEquals(newName,repo.getName());
  assertEquals(new File(repoLocation).getCanonicalPath(),new File(repo.getLocation()).getCanonicalPath());
  assertTrue(new File(repoLocation).exists());
  assertEquals(getTestManagedRepository(repoId,repoLocation).getCronExpression(),repo.getCronExpression());
  assertEquals(getTestManagedRepository(repoId,repoLocation).getLayout(),repo.getLayout());
  assertEquals(getTestManagedRepository(repoId,repoLocation).getId(),repo.getId());
  assertEquals(getTestManagedRepository(repoId,repoLocation).getIndexDirectory(),repo.getIndexDirectory());
  assertEquals(getTestManagedRepository(repoId,repoLocation).getDaysOlder(),repo.getDaysOlder());
  assertEquals(getTestManagedRepository(repoId,repoLocation).getRetentionCount(),repo.getRetentionCount());
  assertEquals(getTestManagedRepository(repoId,repoLocation).isDeleteReleasedSnapshots(),repo.isDeleteReleasedSnapshots());
  assertTemplateRoleExists(repoId);
  assertTrue(new File(stageRepoLocation + STAGE_REPO_ID_END).exists());
  assertTemplateRoleExists(repoId + STAGE_REPO_ID_END);
  managedRepositoryAdmin.deleteManagedRepository(repo.getId(),getFakeAuditInformation(),false);
  assertTrue(repoDir.exists());
  assertTemplateRoleNotExists(repoId);
  assertTrue(new File(stageRepoLocation + STAGE_REPO_ID_END).exists());
  assertTemplateRoleNotExists(repoId + STAGE_REPO_ID_END);
  assertAuditListenerCallAndUpdateAddAndDelete(true);
  mockAuditListener.clearEvents();
  new File(repoLocation + STAGE_REPO_ID_END).delete();
  assertFalse(new File(repoLocation + STAGE_REPO_ID_END).exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getAllManagedRepos() throws Exception {
  mockAuditListener.clearEvents();
  List<ManagedRepository> repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertTrue(repos.size() > 0);
  log.info("repos {}",repos);
  ManagedRepository internal=findManagedRepoById(repos,"internal");
  assertNotNull(internal);
  assertTrue(internal.isReleases());
  assertFalse(internal.isSnapshots());
  mockAuditListener.clearEvents();
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void updateDeleteManagedRepo() throws Exception {
  File repoDir=clearRepoLocation(repoLocation);
  mockAuditListener.clearEvents();
  List<ManagedRepository> repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  int initialSize=repos.size();
  assertTrue(initialSize > 0);
  ManagedRepository repo=new ManagedRepository();
  repo.setId(repoId);
  repo.setName("test repo");
  repo.setLocation(repoLocation);
  repo.setCronExpression("0 0 * * * ?");
  managedRepositoryAdmin.addManagedRepository(repo,false,getFakeAuditInformation());
  assertTemplateRoleExists(repoId);
  repos=managedRepositoryAdmin.getManagedRepositories();
  assertNotNull(repos);
  assertEquals(initialSize + 1,repos.size());
  String newName="test repo update";
  repo.setName(newName);
  String description="so great repository";
  repo.setDescription(description);
  repo.setLocation(repoLocation);
  repo.setCronExpression("0 0 * * * ?");
  repo.setSkipPackedIndexCreation(true);
  managedRepositoryAdmin.updateManagedRepository(repo,false,getFakeAuditInformation(),false);
  repo=managedRepositoryAdmin.getManagedRepository(repoId);
  assertNotNull(repo);
  assertEquals(newName,repo.getName());
  assertEquals(new File(repoLocation).getCanonicalPath(),new File(repo.getLocation()).getCanonicalPath());
  assertTrue(new File(repoLocation).exists());
  assertEquals(description,repo.getDescription());
  assertTrue(repo.isSkipPackedIndexCreation());
  assertTemplateRoleExists(repoId);
  managedRepositoryAdmin.deleteManagedRepository(repo.getId(),getFakeAuditInformation(),false);
  assertTrue(repoDir.exists());
  assertTemplateRoleNotExists(repoId);
  assertAuditListenerCallAndUpdateAddAndDelete(false);
  mockAuditListener.clearEvents();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.audit.AuditManagerTest </h4><pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsWithNonExistantResource() throws Exception {
  Date current=new Date();
  AuditEvent expectedEvent1=createEvent(new Date(current.getTime() - 12345));
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent2=createEvent(expectedTimestamp);
  expectedEvent2.setResource("different-resource");
  AuditEvent expectedEvent3=createEvent(new Date(current.getTime() - 1000));
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(expectedEvent1.getName(),expectedEvent2.getName(),expectedEvent3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent1.getName())).andReturn(expectedEvent1);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent2.getName())).andReturn(expectedEvent2);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent3.getName())).andReturn(expectedEvent3);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),"foo",new Date(current.getTime() - 20000),current);
  assertEquals(0,events.size());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsRangeNotInside() throws Exception {
  Date current=new Date();
  String name1=createEvent(new Date(current.getTime() - 12345)).getName();
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  String name2=createEvent(expectedTimestamp).getName();
  String name3=createEvent(new Date(current.getTime() - 1000)).getName();
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(name1,name2,name3));
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),new Date(current.getTime() - 20000),new Date(current.getTime() - 16000));
  assertEquals(0,events.size());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMostRecentEventsLessThan10() throws Exception {
  int numEvents=5;
  List<AuditEvent> expectedEvents=new ArrayList<>(numEvents);
  for (int i=0; i < numEvents; i++) {
    expectedEvents.add(createEvent(AUDIT_EVENT_BASE + MILLIS_FORMAT.format(i)));
  }
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(getEventNames(expectedEvents));
  for (  AuditEvent event : expectedEvents) {
    EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,event.getName())).andReturn(event);
  }
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getMostRecentAuditEvents(metadataRepository,Collections.singletonList(TEST_REPO_ID));
  assertNotNull(events);
  assertEquals(numEvents,events.size());
  int expectedTimestampCounter=numEvents - 1;
  for (  AuditEvent event : events) {
    String num=MILLIS_FORMAT.format(expectedTimestampCounter);
    assertTestEvent(event,AUDIT_EVENT_BASE + num,getDefaultTestResourceName(num));
    expectedTimestampCounter--;
  }
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsRangeInside() throws Exception {
  Date current=new Date();
  AuditEvent event1=createEvent(new Date(current.getTime() - 12345));
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent=createEvent(expectedTimestamp);
  AuditEvent event3=createEvent(new Date(current.getTime() - 1000));
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(event1.getName(),expectedEvent.getName(),event3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent.getName())).andReturn(expectedEvent);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),new Date(current.getTime() - 4000),new Date(current.getTime() - 2000));
  assertEquals(1,events.size());
  assertTestEvent(events.get(0),TIMESTAMP_FORMAT.format(expectedTimestamp),expectedEvent.getResource());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsRangeLowerAndUpperOutside() throws Exception {
  Date current=new Date();
  Date ts1=new Date(current.getTime() - 12345);
  AuditEvent expectedEvent1=createEvent(ts1);
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent2=createEvent(expectedTimestamp);
  Date ts3=new Date(current.getTime() - 1000);
  AuditEvent expectedEvent3=createEvent(ts3);
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(expectedEvent1.getName(),expectedEvent2.getName(),expectedEvent3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent1.getName())).andReturn(expectedEvent1);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent2.getName())).andReturn(expectedEvent2);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent3.getName())).andReturn(expectedEvent3);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),new Date(current.getTime() - 20000),current);
  assertEquals(3,events.size());
  assertTestEvent(events.get(0),TIMESTAMP_FORMAT.format(ts3),expectedEvent3.getResource());
  assertTestEvent(events.get(1),TIMESTAMP_FORMAT.format(expectedTimestamp),expectedEvent2.getResource());
  assertTestEvent(events.get(2),TIMESTAMP_FORMAT.format(ts1),expectedEvent1.getResource());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMostRecentEventsInterleavedRepositories() throws Exception {
  int numEvents=11;
  Map<String,List<String>> eventNames=new LinkedHashMap<String,List<String>>();
  List<AuditEvent> events=new ArrayList<>();
  eventNames.put(TEST_REPO_ID,new ArrayList<String>());
  eventNames.put(TEST_REPO_ID_2,new ArrayList<String>());
  for (int i=0; i < numEvents; i++) {
    String repositoryId=i % 2 == 0 ? TEST_REPO_ID : TEST_REPO_ID_2;
    String num=MILLIS_FORMAT.format(i);
    AuditEvent event=createEvent(repositoryId,AUDIT_EVENT_BASE + num,getDefaultTestResourceName(num));
    events.add(event);
    eventNames.get(repositoryId).add(event.getName());
  }
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(eventNames.get(TEST_REPO_ID));
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID_2,AuditEvent.FACET_ID)).andReturn(eventNames.get(TEST_REPO_ID_2));
  for (  AuditEvent event : events.subList(1,events.size())) {
    EasyMock.expect(metadataRepository.getMetadataFacet(event.getRepositoryId(),AuditEvent.FACET_ID,event.getName())).andReturn(event);
  }
  metadataRepositoryControl.replay();
  events=auditManager.getMostRecentAuditEvents(metadataRepository,Arrays.asList(TEST_REPO_ID,TEST_REPO_ID_2));
  assertNotNull(events);
  assertEquals(numEvents - 1,events.size());
  int expectedTimestampCounter=numEvents - 1;
  for (  AuditEvent event : events) {
    String num=MILLIS_FORMAT.format(expectedTimestampCounter);
    String expectedRepoId=expectedTimestampCounter % 2 == 0 ? TEST_REPO_ID : TEST_REPO_ID_2;
    assertTestEvent(event,expectedRepoId,AUDIT_EVENT_BASE + num,getDefaultTestResourceName(num));
    expectedTimestampCounter--;
  }
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMostRecentEvents() throws Exception {
  int numEvents=11;
  List<AuditEvent> expectedEvents=new ArrayList<>(numEvents);
  for (int i=0; i < numEvents; i++) {
    AuditEvent event=createEvent(AUDIT_EVENT_BASE + MILLIS_FORMAT.format(i));
    expectedEvents.add(event);
  }
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(getEventNames(expectedEvents));
  for (  AuditEvent event : expectedEvents.subList(1,expectedEvents.size())) {
    EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,event.getName())).andReturn(event);
  }
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getMostRecentAuditEvents(metadataRepository,Collections.singletonList(TEST_REPO_ID));
  assertNotNull(events);
  assertEquals(numEvents - 1,events.size());
  int expectedTimestampCounter=numEvents - 1;
  for (  AuditEvent event : events) {
    String num=MILLIS_FORMAT.format(expectedTimestampCounter);
    assertTestEvent(event,AUDIT_EVENT_BASE + num,getDefaultTestResourceName(num));
    expectedTimestampCounter--;
  }
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsRangeLowerOutside() throws Exception {
  Date current=new Date();
  Date ts1=new Date(current.getTime() - 12345);
  AuditEvent expectedEvent1=createEvent(ts1);
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent2=createEvent(expectedTimestamp);
  AuditEvent event3=createEvent(new Date(current.getTime() - 1000));
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(expectedEvent1.getName(),expectedEvent2.getName(),event3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent1.getName())).andReturn(expectedEvent1);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent2.getName())).andReturn(expectedEvent2);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),new Date(current.getTime() - 20000),new Date(current.getTime() - 2000));
  assertEquals(2,events.size());
  assertTestEvent(events.get(0),TIMESTAMP_FORMAT.format(expectedTimestamp),expectedEvent2.getResource());
  assertTestEvent(events.get(1),TIMESTAMP_FORMAT.format(ts1),expectedEvent1.getResource());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsRangeMultipleRepositories() throws Exception {
  Date current=new Date();
  Date ts1=new Date(current.getTime() - 12345);
  AuditEvent expectedEvent1=createEvent(ts1);
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent2=createEvent(expectedTimestamp);
  expectedEvent2.setRepositoryId(TEST_REPO_ID_2);
  Date ts3=new Date(current.getTime() - 1000);
  AuditEvent expectedEvent3=createEvent(ts3);
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(expectedEvent1.getName(),expectedEvent3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID_2,AuditEvent.FACET_ID)).andReturn(Arrays.asList(expectedEvent2.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent1.getName())).andReturn(expectedEvent1);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID_2,AuditEvent.FACET_ID,expectedEvent2.getName())).andReturn(expectedEvent2);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent3.getName())).andReturn(expectedEvent3);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Arrays.asList(TEST_REPO_ID,TEST_REPO_ID_2),new Date(current.getTime() - 20000),current);
  assertEquals(3,events.size());
  assertTestEvent(events.get(0),TEST_REPO_ID,TIMESTAMP_FORMAT.format(ts3),expectedEvent3.getResource());
  assertTestEvent(events.get(1),TEST_REPO_ID_2,TIMESTAMP_FORMAT.format(expectedTimestamp),expectedEvent2.getResource());
  assertTestEvent(events.get(2),TEST_REPO_ID,TIMESTAMP_FORMAT.format(ts1),expectedEvent1.getResource());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsRangeUpperOutside() throws Exception {
  Date current=new Date();
  AuditEvent event1=createEvent(new Date(current.getTime() - 12345));
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent2=createEvent(expectedTimestamp);
  Date ts3=new Date(current.getTime() - 1000);
  AuditEvent expectedEvent3=createEvent(ts3);
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(event1.getName(),expectedEvent2.getName(),expectedEvent3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent2.getName())).andReturn(expectedEvent2);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent3.getName())).andReturn(expectedEvent3);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),new Date(current.getTime() - 4000),current);
  assertEquals(2,events.size());
  assertTestEvent(events.get(0),TIMESTAMP_FORMAT.format(ts3),expectedEvent3.getResource());
  assertTestEvent(events.get(1),TIMESTAMP_FORMAT.format(expectedTimestamp),expectedEvent2.getResource());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetEventsWithResource() throws Exception {
  Date current=new Date();
  Date ts1=new Date(current.getTime() - 12345);
  AuditEvent expectedEvent1=createEvent(ts1);
  Date expectedTimestamp=new Date(current.getTime() - 3000);
  AuditEvent expectedEvent2=createEvent(expectedTimestamp);
  expectedEvent2.setResource("different-resource");
  Date ts3=new Date(current.getTime() - 1000);
  AuditEvent expectedEvent3=createEvent(ts3);
  EasyMock.expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,AuditEvent.FACET_ID)).andReturn(Arrays.asList(expectedEvent1.getName(),expectedEvent2.getName(),expectedEvent3.getName()));
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent1.getName())).andReturn(expectedEvent1);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent2.getName())).andReturn(expectedEvent2);
  EasyMock.expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,AuditEvent.FACET_ID,expectedEvent3.getName())).andReturn(expectedEvent3);
  metadataRepositoryControl.replay();
  List<AuditEvent> events=auditManager.getAuditEventsInRange(metadataRepository,Collections.singletonList(TEST_REPO_ID),TEST_RESOURCE_BASE,new Date(current.getTime() - 20000),current);
  assertEquals(2,events.size());
  assertTestEvent(events.get(0),TIMESTAMP_FORMAT.format(ts3),expectedEvent3.getResource());
  assertTestEvent(events.get(1),TIMESTAMP_FORMAT.format(ts1),expectedEvent1.getResource());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.checksum.ChecksummedFileTest </h4><pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateChecksum() throws IOException {
  File testableJar=createTestableJar("examples/redback-authz-open.jar");
  ChecksummedFile checksummedFile=new ChecksummedFile(testableJar);
  checksummedFile.createChecksum(ChecksumAlgorithm.SHA1);
  File hashFile=checksummedFile.getChecksumFile(ChecksumAlgorithm.SHA1);
  assertTrue("ChecksumAlgorithm file should exist.",hashFile.exists());
  String hashContents=FileUtils.readFileToString(hashFile);
  hashContents=StringUtils.trim(hashContents);
  assertEquals("2bb14b388973351b0a4dfe11d171965f59cc61a1  redback-authz-open.jar",hashContents);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.configuration.ArchivaConfigurationTest </h4><pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArchivaV1() throws Exception {
  ArchivaConfiguration archivaConfiguration=lookup(ArchivaConfiguration.class,"test-archiva-v1");
  Configuration configuration=archivaConfiguration.getConfiguration();
  assertConfiguration(configuration,2,2,2);
  assertEquals("check network proxies",1,configuration.getNetworkProxies().size());
  assertEquals("check managed repositories",2,configuration.getManagedRepositories().size());
  assertEquals("check v1 repositories size.",0,configuration.getRepositories().size());
  Map<String,ManagedRepositoryConfiguration> map=configuration.getManagedRepositoriesAsMap();
  ManagedRepositoryConfiguration repository=map.get("internal");
  assertEquals("check managed repositories","${appserver.base}/repositories/internal",repository.getLocation());
  assertEquals("check managed repositories","Archiva Managed Internal Repository",repository.getName());
  assertEquals("check managed repositories","internal",repository.getId());
  assertEquals("check managed repositories","default",repository.getLayout());
  assertTrue("check managed repositories",repository.isScanned());
  assertFalse("check managed repositories",repository.isSnapshots());
  repository=map.get("snapshots");
  assertEquals("check managed repositories","${appserver.base}/repositories/snapshots",repository.getLocation());
  assertEquals("check managed repositories","Archiva Managed Snapshot Repository",repository.getName());
  assertEquals("check managed repositories","snapshots",repository.getId());
  assertEquals("check managed repositories","default",repository.getLayout());
  assertFalse("check managed repositories",repository.isScanned());
  assertTrue("check managed repositories",repository.isSnapshots());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.converter.artifact.LegacyToDefaultConverterTest </h4><pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifedArtifactFails() throws Exception {
  Artifact artifact=createArtifact("test","modified-artifact","1.0.0");
  Artifact pomArtifact=createPomArtifact(artifact);
  File sourceFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(pomArtifact));
  File targetFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File targetPomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(pomArtifact));
  assertTrue("Check target file exists",targetFile.exists());
  assertTrue("Check target POM exists",targetPomFile.exists());
  sourceFile.setLastModified(System.currentTimeMillis());
  sourcePomFile.setLastModified(System.currentTimeMillis());
  long origTime=targetFile.lastModified();
  long origPomTime=targetPomFile.lastModified();
  Thread.sleep(SLEEP_MILLIS);
  artifactConverter.convert(artifact,targetRepository);
  checkWarnings(artifactConverter,2);
  assertHasWarningReason(artifactConverter,Messages.getString("failure.target.already.exists"));
  assertEquals("Check unmodified",origTime,targetFile.lastModified());
  assertEquals("Check unmodified",origPomTime,targetPomFile.lastModified());
  ArtifactRepositoryMetadata metadata=new ArtifactRepositoryMetadata(artifact);
  File metadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(metadata));
  assertFalse("Check metadata not created",metadataFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testV3SnapshotPomConvert() throws Exception {
  Artifact artifact=createArtifact("test","v3artifact","1.0.0-SNAPSHOT");
  ArtifactMetadata artifactMetadata=new ArtifactRepositoryMetadata(artifact);
  File artifactMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(artifactMetadata));
  artifactMetadataFile.delete();
  ArtifactMetadata snapshotMetadata=new SnapshotArtifactRepositoryMetadata(artifact);
  File snapshotMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(snapshotMetadata));
  snapshotMetadataFile.delete();
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File expectedPomFile=getTestFile("src/test/expected-files/converted-v3-snapshot.pom");
  assertTrue("Check POM created",pomFile.exists());
  compareFiles(expectedPomFile,pomFile);
  assertTrue("Check artifact metadata created",artifactMetadataFile.exists());
  File expectedMetadataFile=getTestFile("src/test/expected-files/v3-snapshot-artifact-metadata.xml");
  compareFiles(expectedMetadataFile,artifactMetadataFile);
  assertTrue("Check snapshot metadata created",snapshotMetadataFile.exists());
  expectedMetadataFile=getTestFile("src/test/expected-files/v3-snapshot-metadata.xml");
  compareFiles(expectedMetadataFile,snapshotMetadataFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDryRunFailure() throws Exception {
  artifactConverter=applicationContext.getBean("artifactConverter#dryrun-repository-converter",ArtifactConverter.class);
  Artifact artifact=createArtifact("test","modified-artifact","1.0.0");
  Artifact pomArtifact=createPomArtifact(artifact);
  File sourceFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(pomArtifact));
  File targetFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File targetPomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(pomArtifact));
  assertTrue("Check target file exists",targetFile.exists());
  assertTrue("Check target POM exists",targetPomFile.exists());
  sourceFile.setLastModified(System.currentTimeMillis());
  sourcePomFile.setLastModified(System.currentTimeMillis());
  long origTime=targetFile.lastModified();
  long origPomTime=targetPomFile.lastModified();
  Thread.sleep(SLEEP_MILLIS);
  artifactConverter.clearWarnings();
  artifactConverter.convert(artifact,targetRepository);
  checkWarnings(artifactConverter,2);
  assertHasWarningReason(artifactConverter,Messages.getString("failure.target.already.exists"));
  assertEquals("Check unmodified",origTime,targetFile.lastModified());
  assertEquals("Check unmodified",origPomTime,targetPomFile.lastModified());
  ArtifactRepositoryMetadata metadata=new ArtifactRepositoryMetadata(artifact);
  File metadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(metadata));
  assertFalse("Check metadata not created",metadataFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDryRunSuccess() throws Exception {
  artifactConverter=applicationContext.getBean("artifactConverter#dryrun-repository-converter",ArtifactConverter.class);
  Artifact artifact=createArtifact("test","dryrun-artifact","1.0.0");
  Artifact pomArtifact=createPomArtifact(artifact);
  File sourceFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(pomArtifact));
  File targetFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File targetPomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(pomArtifact));
  artifactConverter.clearWarnings();
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  assertTrue("Check source file exists",sourceFile.exists());
  assertTrue("Check source POM exists",sourcePomFile.exists());
  assertFalse("Check target file doesn't exist",targetFile.exists());
  assertFalse("Check target POM doesn't exist",targetPomFile.exists());
  ArtifactRepositoryMetadata metadata=new ArtifactRepositoryMetadata(artifact);
  File metadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(metadata));
  assertFalse("Check metadata not created",metadataFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMergeArtifactMetadata() throws Exception {
  Artifact artifact=createArtifact("test","newversion-artifact","1.0.1");
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  assertTrue("Check POM created",pomFile.exists());
  compareFiles(sourcePomFile,pomFile);
  ArtifactMetadata artifactMetadata=new ArtifactRepositoryMetadata(artifact);
  File artifactMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(artifactMetadata));
  assertTrue("Check artifact metadata created",artifactMetadataFile.exists());
  File expectedMetadataFile=getTestFile("src/test/expected-files/newversion-artifact-metadata.xml");
  compareFiles(expectedMetadataFile,artifactMetadataFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testForcedUnmodifiedArtifact() throws Exception {
  artifactConverter=applicationContext.getBean("artifactConverter#force-repository-converter",ArtifactConverter.class);
  Artifact artifact=createArtifact("test","unmodified-artifact","1.0.0");
  Artifact pomArtifact=createPomArtifact(artifact);
  File sourceFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(pomArtifact));
  File targetFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File targetPomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(pomArtifact));
  SimpleDateFormat dateFormat=new SimpleDateFormat("yyyy-MM-dd",Locale.getDefault());
  long origTime=dateFormat.parse("2006-03-03").getTime();
  targetFile.setLastModified(origTime);
  targetPomFile.setLastModified(origTime);
  sourceFile.setLastModified(dateFormat.parse("2006-01-01").getTime());
  sourcePomFile.setLastModified(dateFormat.parse("2006-02-02").getTime());
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  compareFiles(sourceFile,targetFile);
  compareFiles(sourcePomFile,targetPomFile);
  assertFalse("Check modified",origTime == targetFile.lastModified());
  assertFalse("Check modified",origTime == targetPomFile.lastModified());
  ArtifactRepositoryMetadata metadata=new ArtifactRepositoryMetadata(artifact);
  File metadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(metadata));
  assertTrue("Check metadata created",metadataFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testV4PomConvert() throws Exception {
  Artifact artifact=createArtifact("test","v4artifact","1.0.0");
  ArtifactMetadata artifactMetadata=new ArtifactRepositoryMetadata(artifact);
  File artifactMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(artifactMetadata));
  artifactMetadataFile.delete();
  ArtifactMetadata versionMetadata=new SnapshotArtifactRepositoryMetadata(artifact);
  File versionMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(versionMetadata));
  versionMetadataFile.delete();
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  artifactFile.delete();
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  assertTrue("Check POM created",pomFile.exists());
  compareFiles(sourcePomFile,pomFile);
  assertTrue("Check artifact metadata created",artifactMetadataFile.exists());
  File expectedMetadataFile=getTestFile("src/test/expected-files/v4-artifact-metadata.xml");
  compareFiles(expectedMetadataFile,artifactMetadataFile);
  assertTrue("Check snapshot metadata created",versionMetadataFile.exists());
  expectedMetadataFile=getTestFile("src/test/expected-files/v4-version-metadata.xml");
  compareFiles(expectedMetadataFile,versionMetadataFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testV3PomConvert() throws Exception {
  Artifact artifact=createArtifact("test","v3artifact","1.0.0");
  ArtifactMetadata artifactMetadata=new ArtifactRepositoryMetadata(artifact);
  File artifactMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(artifactMetadata));
  artifactMetadataFile.delete();
  ArtifactMetadata versionMetadata=new SnapshotArtifactRepositoryMetadata(artifact);
  File versionMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(versionMetadata));
  versionMetadataFile.delete();
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File expectedPomFile=getTestFile("src/test/expected-files/converted-v3.pom");
  assertTrue("Check POM created",pomFile.exists());
  compareFiles(expectedPomFile,pomFile);
  assertTrue("Check artifact metadata created",artifactMetadataFile.exists());
  File expectedMetadataFile=getTestFile("src/test/expected-files/v3-artifact-metadata.xml");
  compareFiles(expectedMetadataFile,artifactMetadataFile);
  assertTrue("Check snapshot metadata created",versionMetadataFile.exists());
  expectedMetadataFile=getTestFile("src/test/expected-files/v3-version-metadata.xml");
  compareFiles(expectedMetadataFile,versionMetadataFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testV3TimestampedSnapshotPomConvert() throws Exception {
  Artifact artifact=createArtifact("test","v3artifact","1.0.0-20060105.130101-3");
  ArtifactMetadata artifactMetadata=new ArtifactRepositoryMetadata(artifact);
  File artifactMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(artifactMetadata));
  artifactMetadataFile.delete();
  ArtifactMetadata snapshotMetadata=new SnapshotArtifactRepositoryMetadata(artifact);
  File snapshotMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(snapshotMetadata));
  snapshotMetadataFile.delete();
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File expectedPomFile=getTestFile("src/test/expected-files/converted-v3-timestamped-snapshot.pom");
  assertTrue("Check POM created",pomFile.exists());
  compareFiles(expectedPomFile,pomFile);
  assertTrue("Check artifact snapshotMetadata created",artifactMetadataFile.exists());
  File expectedMetadataFile=getTestFile("src/test/expected-files/v3-snapshot-artifact-metadata.xml");
  compareFiles(expectedMetadataFile,artifactMetadataFile);
  assertTrue("Check snapshot snapshotMetadata created",snapshotMetadataFile.exists());
  expectedMetadataFile=getTestFile("src/test/expected-files/v3-timestamped-snapshot-metadata.xml");
  compareFiles(expectedMetadataFile,snapshotMetadataFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMultipleArtifacts() throws Exception {
  List<Artifact> artifacts=new ArrayList<>();
  artifacts.add(createArtifact("test","artifact-one","1.0.0"));
  artifacts.add(createArtifact("test","artifact-two","1.0.0"));
  artifacts.add(createArtifact("test","artifact-three","1.0.0"));
  for (  Artifact artifact : artifacts) {
    artifactConverter.convert(artifact,targetRepository);
    checkSuccess(artifactConverter);
  }
  for (  Artifact artifact : artifacts) {
    File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
    assertTrue("Check artifact created",artifactFile.exists());
    assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
    artifact=createPomArtifact(artifact);
    File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
    File expectedPomFile=getTestFile("src/test/expected-files/converted-" + artifact.getArtifactId() + ".pom");
    assertTrue("Check POM created",pomFile.exists());
    compareFiles(expectedPomFile,pomFile);
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testV3PomWarningsOnConvert() throws Exception {
  Artifact artifact=createArtifact("test","v3-warnings-artifact","1.0.0");
  ArtifactMetadata artifactMetadata=new ArtifactRepositoryMetadata(artifact);
  File artifactMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(artifactMetadata));
  artifactMetadataFile.delete();
  ArtifactMetadata versionMetadata=new SnapshotArtifactRepositoryMetadata(artifact);
  File versionMetadataFile=new File(targetRepository.getBasedir(),targetRepository.pathOfRemoteRepositoryMetadata(versionMetadata));
  versionMetadataFile.delete();
  artifactConverter.convert(artifact,targetRepository);
  checkWarnings(artifactConverter,2);
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File expectedPomFile=getTestFile("src/test/expected-files/converted-v3-warnings.pom");
  assertTrue("Check POM created",pomFile.exists());
  compareFiles(expectedPomFile,pomFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnmodifiedArtifact() throws Exception, InterruptedException {
  Artifact artifact=createArtifact("test","unmodified-artifact","1.0.0");
  Artifact pomArtifact=createPomArtifact(artifact);
  File sourceFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(pomArtifact));
  File targetFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File targetPomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(pomArtifact));
  assertTrue("Check target file exists",targetFile.exists());
  assertTrue("Check target POM exists",targetPomFile.exists());
  sourceFile.setLastModified(System.currentTimeMillis());
  sourcePomFile.setLastModified(System.currentTimeMillis());
  long origTime=targetFile.lastModified();
  long origPomTime=targetPomFile.lastModified();
  Thread.sleep(SLEEP_MILLIS);
  artifactConverter.convert(artifact,targetRepository);
  checkSuccess(artifactConverter);
  compareFiles(sourceFile,targetFile);
  compareFiles(sourcePomFile,targetPomFile);
  assertEquals("Check artifact unmodified",origTime,targetFile.lastModified());
  assertEquals("Check POM unmodified",origPomTime,targetPomFile.lastModified());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNoPomConvert() throws Exception {
  Artifact artifact=createArtifact("test","noPomArtifact","1.0.0");
  artifactConverter.convert(artifact,targetRepository);
  checkWarnings(artifactConverter,1);
  assertHasWarningReason(artifactConverter,Messages.getString("warning.missing.pom"));
  File artifactFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  assertTrue("Check artifact created",artifactFile.exists());
  assertTrue("Check artifact matches",FileUtils.contentEquals(artifactFile,artifact.getFile()));
  artifact=createPomArtifact(artifact);
  File pomFile=new File(targetRepository.getBasedir(),targetRepository.pathOf(artifact));
  File sourcePomFile=new File(sourceRepository.getBasedir(),sourceRepository.pathOf(artifact));
  assertFalse("Check no POM created",pomFile.exists());
  assertFalse("No source POM",sourcePomFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.dependency.tree.maven2.DependencyTreeBuilderTestMaven3 </h4><pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testBuilderDependencies() throws Exception {
  List<TreeEntry> treeEntries=builder.buildDependencyTree(Collections.singletonList(TEST_REPO_ID),TEST_GROUP_ID,TEST_ARTIFACT_ID,TEST_VERSION);
  assertThat(treeEntries).isNotNull().isNotEmpty().contains(new TreeEntry(new Artifact(TEST_GROUP_ID,TEST_ARTIFACT_ID,TEST_VERSION,"","")));
  assertThat(treeEntries.get(0).getChilds()).isNotNull().isNotEmpty().contains(new TreeEntry(new Artifact("commons-lang","commons-lang","2.2","compile","")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.indexer.search.MavenRepositorySearchOSGITest </h4><pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void searchFelixWithSymbolicName() throws Exception {
  createIndex(TEST_REPO_1,Collections.<File>emptyList(),true);
  List<String> selectedRepos=Arrays.asList(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchFields searchFields=new SearchFields();
  searchFields.setBundleSymbolicName("org.apache.felix.bundlerepository");
  searchFields.setBundleVersion("1.6.6");
  searchFields.setRepositories(selectedRepos);
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(1,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("org.apache.felix",hit.getGroupId());
  assertEquals("org.apache.felix.bundlerepository",hit.getArtifactId());
  assertEquals("1.6.6",hit.getVersions().get(0));
  assertEquals("org.apache.felix.bundlerepository;uses:=\"org.osgi.framework\";version=\"2.0\"",hit.getBundleExportPackage());
  assertEquals("org.apache.felix.bundlerepository.RepositoryAdmin,org.osgi.service.obr.RepositoryAdmin",hit.getBundleExportService());
  assertEquals("org.apache.felix.bundlerepository",hit.getBundleSymbolicName());
  assertEquals("1.6.6",hit.getBundleVersion());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.indexer.search.MavenRepositorySearchTest </h4><pre class="type-9 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuickSearchWithMultipleKeywords() throws Exception {
  createSimpleIndex(false);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"archiva search",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(1,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearch() throws Exception {
  List<File> files=new ArrayList<>();
  files.add(new File(FileUtil.getBasedir(),"src/test/" + TEST_REPO_2 + "/org/apache/archiva/archiva-search/1.0/archiva-search-1.0.jar"));
  files.add(new File(FileUtil.getBasedir(),"src/test/" + TEST_REPO_2 + "/org/apache/archiva/archiva-search/1.1/archiva-search-1.1.jar"));
  createIndex(TEST_REPO_2,files,false);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_2);
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.apache.archiva");
  searchFields.setVersion("1.0");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(1,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-search",hit.getArtifactId());
  assertEquals("1.0",hit.getVersions().get(0));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchClassname() throws Exception {
  createIndexContainingMoreArtifacts(true);
  List<String> selectedRepos=Arrays.asList(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setClassName("com.classname.search.App");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("totalHits not 1 results " + results,1,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("groupId not com","com",hit.getGroupId());
  assertEquals("arttifactId not classname-search","classname-search",hit.getArtifactId());
  assertEquals(" hits.version(0) not 1.0","1.0",hit.getVersions().get(0));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuickSearchNotWithClassifier() throws Exception {
  createSimpleIndex(true);
  List<String> selectedRepos=Arrays.asList(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"archiva-search",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  SearchResultHit hit=results.getSearchResultHit(SearchUtil.getHitId("org.apache.archiva","archiva-search",null,"jar"));
  assertNotNull("hit null in result " + results.getHits(),hit);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-search",hit.getArtifactId());
  assertEquals("1.0",hit.getVersions().get(0));
  archivaConfigControl.reset();
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  results=search.search("user",selectedRepos,"archiva-search",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("total hints not 3 hits " + results.getHits(),3,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchJarArtifacts() throws Exception {
  createIndexContainingMoreArtifacts(true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setPackaging("jar");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("not 8 but " + results.getTotalHits() + ":"+ niceDisplay(results),8,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuickSearchMultipleArtifactsSameVersion() throws Exception {
  createIndexContainingMultipleArtifactsSameVersion(false);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"archiva-search",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(3,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-search",hit.getArtifactId());
  assertEquals("1.0",hit.getVersions().get(0));
  assertEquals(1,hit.getVersions().size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchNoIndexFound() throws Exception {
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.apache.archiva");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(0,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSearchWithinSearchResults() throws Exception {
  createSimpleIndex(true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  List<String> previousSearchTerms=new ArrayList<>();
  previousSearchTerms.add("archiva-test");
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"1.0",null,previousSearchTerms);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("total hints not 1",1,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-test",hit.getArtifactId());
  assertEquals("versions not 1",1,hit.getVersions().size());
  assertEquals("1.0",hit.getVersions().get(0));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleArtifactsSameVersionWithClassifier() throws Exception {
  createIndexContainingMultipleArtifactsSameVersion(true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.apache.archiva");
  searchFields.setArtifactId("archiva-search");
  searchFields.setClassifier("sources");
  searchFields.setRepositories(selectedRepos);
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(1,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-search",hit.getArtifactId());
  assertEquals("1.0",hit.getVersions().get(0));
  assertEquals(1,hit.getVersions().size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuickSearch() throws Exception {
  createSimpleIndex(false);
  List<String> selectedRepos=Arrays.asList(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"archiva-search",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  SearchResultHit hit=results.getSearchResultHit(SearchUtil.getHitId("org.apache.archiva","archiva-search",null,"jar"));
  assertNotNull("hit null in result " + results.getHits(),hit);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-search",hit.getArtifactId());
  assertEquals("1.0",hit.getVersions().get(0));
  archivaConfigControl.reset();
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  results=search.search("user",selectedRepos,"org.apache.archiva",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("total hints not 3",3,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void nolimitedResult() throws Exception {
  File repo=new File("target/repo-release");
  File indexDirectory=new File(repo,".index");
  FileUtils.copyDirectoryStructure(new File("src/test/repo-release"),repo);
  createIndex("repo-release",Collections.<File>emptyList(),false);
  nexusIndexer.addIndexingContext(REPO_RELEASE,REPO_RELEASE,repo,indexDirectory,repo.toURI().toURL().toExternalForm(),indexDirectory.toURI().toURL().toString(),search.getAllIndexCreators());
  SearchResultLimits limits=new SearchResultLimits(SearchResultLimits.ALL_PAGES);
  limits.setPageSize(300);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,5);
  archivaConfigControl.replay();
  SearchResults searchResults=search.search(null,Arrays.asList(REPO_RELEASE),"org.example",limits,Collections.<String>emptyList());
  log.info("results: {}",searchResults.getHits().size());
  assertEquals(255,searchResults.getHits().size());
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.example");
  searchFields.setRepositories(Arrays.asList(REPO_RELEASE));
  searchResults=search.search(null,searchFields,limits);
  log.info("results: {}",searchResults.getHits().size());
  assertEquals(255,searchResults.getHits().size());
  archivaConfigControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-3 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getAllGroupIds() throws Exception {
  createIndexContainingMoreArtifacts(true);
  List<String> selectedRepos=Arrays.asList(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(0,2);
  archivaConfigControl.replay();
  Collection<String> groupIds=search.getAllGroupIds("user",selectedRepos);
  archivaConfigControl.verify();
  log.info("groupIds: {}",groupIds);
  assertEquals(3,groupIds.size());
  assertTrue(groupIds.contains("com"));
  assertTrue(groupIds.contains("org.apache.felix"));
  assertTrue(groupIds.contains("org.apache.archiva"));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoIndexFound() throws Exception {
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"org.apache.archiva",null,null);
  assertNotNull(results);
  assertEquals(0,results.getTotalHits());
  archivaConfigControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchArtifactIdHasNumericChar() throws Exception {
  List<File> files=new ArrayList<>();
  files.add(new File(FileUtil.getBasedir(),"src/test/" + TEST_REPO_1 + "/com/artifactid-numeric/1.0/artifactid-numeric-1.0.jar"));
  files.add(new File(FileUtil.getBasedir(),"src/test/" + TEST_REPO_1 + "/com/artifactid-numeric123/1.0/artifactid-numeric123-1.0.jar"));
  createIndex(TEST_REPO_1,files,true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setArtifactId("artifactid-numeric");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(2,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchWithPagination() throws Exception {
  createIndexContainingMoreArtifacts(false);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.apache.archiva");
  searchFields.setRepositories(selectedRepos);
  SearchResultLimits limits=new SearchResultLimits(0);
  limits.setPageSize(1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,limits);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(4,results.getTotalHits());
  assertEquals(1,results.getHits().size());
  archivaConfigControl.reset();
  limits=new SearchResultLimits(1);
  limits.setPageSize(1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  results=search.search("user",searchFields,limits);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(4,results.getTotalHits());
  assertEquals(1,results.getHits().size());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArtifactFoundInMultipleRepositories() throws Exception {
  createSimpleIndex(true);
  List<File> files=new ArrayList<>();
  files.add(new File(FileUtil.getBasedir(),"src/test/" + TEST_REPO_2 + "/org/apache/archiva/archiva-search/1.0/archiva-search-1.0.jar"));
  files.add(new File(FileUtil.getBasedir(),"src/test/" + TEST_REPO_2 + "/org/apache/archiva/archiva-search/1.1/archiva-search-1.1.jar"));
  createIndex(TEST_REPO_2,files,false);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  selectedRepos.add(TEST_REPO_2);
  config.addManagedRepository(createRepositoryConfig(TEST_REPO_2));
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,5);
  archivaConfigControl.replay();
  Thread.sleep(2000);
  SearchResults results=search.search("user",selectedRepos,"archiva-search",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  SearchResultHit hit=results.getSearchResultHit(SearchUtil.getHitId("org.apache.archiva","archiva-search",null,"jar"));
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-search",hit.getArtifactId());
  assertEquals("not 2 version for hit " + hit + "::"+ niceDisplay(results),2,hit.getVersions().size());
  assertTrue(hit.getVersions().contains("1.0"));
  assertTrue(hit.getVersions().contains("1.1"));
  archivaConfigControl.reset();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchAllSearchCriteriaSpecified() throws Exception {
  createSimpleIndex(true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.apache.archiva");
  searchFields.setArtifactId("archiva-test");
  searchFields.setVersion("2.0");
  searchFields.setPackaging("jar");
  searchFields.setClassName("org.apache.archiva.test.App");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("total hints not 1" + results,1,results.getTotalHits());
  SearchResultHit hit=results.getHits().get(0);
  assertEquals("org.apache.archiva",hit.getGroupId());
  assertEquals("archiva-test",hit.getArtifactId());
  assertEquals("version not 2.0","2.0",hit.getVersions().get(0));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRepositoryNotFound() throws Exception {
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add("non-existing-repo");
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"org.apache.archiva",null,null);
  assertNotNull(results);
  assertEquals(0,results.getTotalHits());
  archivaConfigControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuickSearchWithPagination() throws Exception {
  createSimpleIndex(true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchResultLimits limits=new SearchResultLimits(0);
  limits.setPageSize(1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"org",limits,Collections.<String>emptyList());
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(1,results.getHits().size());
  assertEquals("total hits not 8 for page1 " + results,8,results.getTotalHits());
  assertEquals("returned hits not 1 for page1 " + results,1,results.getReturnedHitsCount());
  assertEquals(limits,results.getLimits());
  archivaConfigControl.reset();
  limits=new SearchResultLimits(1);
  limits.setPageSize(1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  results=search.search("user",selectedRepos,"org",limits,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals("hits not 1",1,results.getHits().size());
  assertEquals("total hits not 8 for page 2 " + results,8,results.getTotalHits());
  assertEquals("returned hits not 1 for page2 " + results,1,results.getReturnedHitsCount());
  assertEquals(limits,results.getLimits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchWithIncorrectPackaging() throws Exception {
  createSimpleIndex(true);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setGroupId("org.apache.archiva");
  searchFields.setArtifactId("archiva-test");
  searchFields.setVersion("2.0");
  searchFields.setPackaging("war");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(0,results.getTotalHits());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdvancedSearchClassNameInWar() throws Exception {
  createIndexContainingMoreArtifacts(true);
  List<String> selectedRepos=Arrays.asList(TEST_REPO_1);
  SearchFields searchFields=new SearchFields();
  searchFields.setClassName("SomeClass");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(1,results.getHits().size());
  assertEquals("test-webapp",results.getHits().get(0).getArtifactId());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSearchWithUnknownRepo() throws Exception {
  createIndexContainingMoreArtifacts(true);
  List<String> selectedRepos=Arrays.asList("foo");
  SearchFields searchFields=new SearchFields();
  searchFields.setClassName("SomeClass");
  searchFields.setRepositories(selectedRepos);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",searchFields,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(0,results.getHits().size());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMatchFound() throws Exception {
  createSimpleIndex(false);
  List<String> selectedRepos=new ArrayList<>();
  selectedRepos.add(TEST_REPO_1);
  EasyMock.expect(archivaConfig.getConfiguration()).andReturn(config).times(1,2);
  archivaConfigControl.replay();
  SearchResults results=search.search("user",selectedRepos,"dfghdfkweriuasndsaie",null,null);
  archivaConfigControl.verify();
  assertNotNull(results);
  assertEquals(0,results.getTotalHits());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.metadata.repository.AbstractMetadataRepositoryTest </h4><pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetArtifactsByPropertySingleResult() throws Exception {
  createArtifactWithData();
  Collection<ArtifactMetadata> artifactsByProperty=repository.getArtifactsByProperty("url",TEST_URL,TEST_REPO_ID);
  assertThat(artifactsByProperty).hasSize(1);
  ArtifactMetadata artifactMetadata=artifactsByProperty.iterator().next();
  assertThat(artifactMetadata.getId()).isEqualTo("projectId-1.0.jar");
  assertThat(artifactMetadata.getSha1()).isEqualTo(TEST_SHA1);
  assertThat(artifactMetadata.getRepositoryId()).isEqualTo(TEST_REPO_ID);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateArtifactMetadataWithExistingFacetsFacetPropertyWasRemoved() throws Exception {
  ArtifactMetadata metadata=createArtifact();
  Map<String,String> additionalProps=new HashMap<>();
  additionalProps.put("deleteKey","deleteValue");
  MetadataFacet facet=new TestMetadataFacet(TEST_FACET_ID,"baz",additionalProps);
  metadata.addFacet(facet);
  repository.updateArtifact(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,TEST_PROJECT_VERSION,metadata);
  Collection<ArtifactMetadata> artifacts=repository.getArtifacts(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,TEST_PROJECT_VERSION);
  assertThat(artifacts).isNotNull().isNotEmpty().hasSize(1);
  metadata=artifacts.iterator().next();
  Collection<String> ids=metadata.getFacetIds();
  assertThat(ids).isNotNull().isNotEmpty().hasSize(1).contains(TEST_FACET_ID);
  TestMetadataFacet testFacet=(TestMetadataFacet)metadata.getFacet(TEST_FACET_ID);
  Map<String,String> facetProperties=testFacet.toProperties();
  assertEquals("deleteValue",facetProperties.get("deleteKey"));
  facetProperties.remove("deleteKey");
  TestMetadataFacet newTestFacet=new TestMetadataFacet(TEST_FACET_ID,testFacet.getValue(),facetProperties);
  metadata.addFacet(newTestFacet);
  repository.updateArtifact(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,TEST_PROJECT_VERSION,metadata);
  artifacts=repository.getArtifacts(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,TEST_PROJECT_VERSION);
  assertThat(artifacts).isNotNull().isNotEmpty().hasSize(1);
  metadata=artifacts.iterator().next();
  ids=metadata.getFacetIds();
  assertThat(ids).isNotNull().isNotEmpty().hasSize(1).contains(TEST_FACET_ID);
  testFacet=(TestMetadataFacet)metadata.getFacet(TEST_FACET_ID);
  Map<String,String> props=testFacet.toProperties();
  assertThat(props).isNotNull().doesNotContainKey("deleteKey");
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteRepository() throws Exception {
  repository.updateNamespace(TEST_REPO_ID,TEST_NAMESPACE);
  ProjectMetadata project1=new ProjectMetadata();
  project1.setNamespace(TEST_NAMESPACE);
  project1.setId("project1");
  repository.updateProject(TEST_REPO_ID,project1);
  ProjectMetadata project2=new ProjectMetadata();
  project2.setNamespace(TEST_NAMESPACE);
  project2.setId("project2");
  repository.updateProject(TEST_REPO_ID,project2);
  ArtifactMetadata artifact1=createArtifact();
  artifact1.setProject("project1");
  repository.updateArtifact(TEST_REPO_ID,TEST_NAMESPACE,"project1",TEST_PROJECT_VERSION,artifact1);
  ArtifactMetadata artifact2=createArtifact();
  artifact2.setProject("project2");
  repository.updateArtifact(TEST_REPO_ID,TEST_NAMESPACE,"project2",TEST_PROJECT_VERSION,artifact2);
  repository.save();
  List<ArtifactMetadata> expected=Arrays.asList(artifact1,artifact2);
  Collections.sort(expected,new ArtifactMetadataComparator());
  List<ArtifactMetadata> actual=new ArrayList<>(repository.getArtifactsByDateRange(TEST_REPO_ID,null,null));
  Collections.sort(actual,new ArtifactMetadataComparator());
  assertEquals(expected,actual);
  repository.removeRepository(TEST_REPO_ID);
  assertTrue(repository.getArtifacts(TEST_REPO_ID).isEmpty());
  assertTrue(repository.getRootNamespaces(TEST_REPO_ID).isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetArtifactsByProjectVersionMetadata() throws Exception {
  createArtifactWithGenericMetadataFacet(10);
  Collection<ArtifactMetadata> artifactsByMetadata=repository.getArtifactsByProjectVersionMetadata(TEST_METADATA_KEY,TEST_METADATA_VALUE,TEST_REPO_ID);
  assertThat(artifactsByMetadata).hasSize(1);
  ArtifactMetadata artifactMetadata=artifactsByMetadata.iterator().next();
  assertThat(artifactMetadata.getId()).isEqualTo("projectId-1.0.jar");
  assertThat(artifactMetadata.getSha1()).isEqualTo(TEST_SHA1);
  assertThat(artifactMetadata.getRepositoryId()).isEqualTo(TEST_REPO_ID);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testSearchArtifactsFullTextExact() throws Exception {
  createArtifactWithGenericMetadataFacet();
  Collection<ArtifactMetadata> artifactsByProperty=repository.searchArtifacts(TEST_METADATA_VALUE,TEST_REPO_ID,true);
  assertThat(artifactsByProperty).isNotNull().isNotEmpty();
  artifactsByProperty=repository.searchArtifacts(TEST_METADATA_VALUE.substring(2),TEST_REPO_ID,true);
  assertThat(artifactsByProperty).isNotNull().isEmpty();
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateProjectVersionMetadataWithExistingFacetsFacetPropertyWasRemoved() throws Exception {
  ProjectVersionMetadata metadata=new ProjectVersionMetadata();
  metadata.setId(TEST_PROJECT_VERSION);
  Map<String,String> additionalProps=new HashMap<>();
  additionalProps.put("deleteKey","deleteValue");
  MetadataFacet facet=new TestMetadataFacet(TEST_FACET_ID,"baz",additionalProps);
  metadata.addFacet(facet);
  repository.updateProjectVersion(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,metadata);
  metadata=repository.getProjectVersion(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,TEST_PROJECT_VERSION);
  assertThat(metadata.getFacetIds()).isNotNull().isNotEmpty().hasSize(1).contains(TEST_FACET_ID);
  TestMetadataFacet testFacet=(TestMetadataFacet)metadata.getFacet(TEST_FACET_ID);
  Map<String,String> facetProperties=testFacet.toProperties();
  assertEquals("deleteValue",facetProperties.get("deleteKey"));
  facetProperties.remove("deleteKey");
  TestMetadataFacet newTestFacet=new TestMetadataFacet(TEST_FACET_ID,testFacet.getValue(),facetProperties);
  metadata.addFacet(newTestFacet);
  repository.updateProjectVersion(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,metadata);
  metadata=repository.getProjectVersion(TEST_REPO_ID,TEST_NAMESPACE,TEST_PROJECT,TEST_PROJECT_VERSION);
  assertThat(metadata.getFacetIds()).isNotNull().isNotEmpty().hasSize(1).contains(TEST_FACET_ID);
  testFacet=(TestMetadataFacet)metadata.getFacet(TEST_FACET_ID);
  assertFalse(testFacet.toProperties().containsKey("deleteKey"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetArtifactsByMetadataAllRepositories() throws Exception {
  createArtifactWithMavenArtifactFacet();
  Collection<ArtifactMetadata> artifactsByMetadata=repository.getArtifactsByMetadata("foo",TEST_METADATA_VALUE,null);
  assertThat(artifactsByMetadata).hasSize(1);
  ArtifactMetadata artifactMetadata=artifactsByMetadata.iterator().next();
  assertThat(artifactMetadata.getId()).isEqualTo("projectId-1.0.jar");
  assertThat(artifactMetadata.getSha1()).isEqualTo(TEST_SHA1);
  assertThat(artifactMetadata.getRepositoryId()).isEqualTo(TEST_REPO_ID);
  MetadataFacet facet=artifactMetadata.getFacet(TEST_FACET_ID);
  assertThat(facet).isNotNull();
  assertThat(facet.toProperties()).isEqualTo(Collections.singletonMap("foo",TEST_METADATA_VALUE));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.metadata.repository.stats.RepositoryStatisticsManagerTest </h4><pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStatsRangeLowerAndUpperOutside() throws Exception {
  walkRepository(3);
  Date current=new Date();
  addStats(new Date(current.getTime() - 12345),new Date(current.getTime() - 6000));
  addStats(new Date(current.getTime() - 3000),new Date(current.getTime() - 2000));
  addStats(new Date(current.getTime() - 1000),current);
  ArrayList<String> keys=new ArrayList<>(statsCreated.keySet());
  expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,RepositoryStatistics.FACET_ID)).andReturn(keys);
  String key=keys.get(0);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  key=keys.get(1);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  key=keys.get(2);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  expect(metadataRepository.canObtainAccess(Session.class)).andReturn(false).times(3);
  metadataRepositoryControl.replay();
  for (  RepositoryStatistics stats : statsCreated.values()) {
    repositoryStatisticsManager.addStatisticsAfterScan(metadataRepository,TEST_REPO_ID,stats.getScanStartTime(),stats.getScanEndTime(),56345,45);
  }
  List<RepositoryStatistics> list=repositoryStatisticsManager.getStatisticsInRange(metadataRepository,TEST_REPO_ID,new Date(current.getTime() - 20000),current);
  assertEquals(3,list.size());
  assertEquals(new Date(current.getTime() - 12345),list.get(2).getScanStartTime());
  assertEquals(new Date(current.getTime() - 3000),list.get(1).getScanStartTime());
  assertEquals(new Date(current.getTime() - 1000),list.get(0).getScanStartTime());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStatsRangeUpperOutside() throws Exception {
  walkRepository(3);
  Date current=new Date();
  addStats(new Date(current.getTime() - 12345),new Date(current.getTime() - 6000));
  addStats(new Date(current.getTime() - 3000),new Date(current.getTime() - 2000));
  addStats(new Date(current.getTime() - 1000),current);
  List<String> keys=new ArrayList<>(statsCreated.keySet());
  expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,RepositoryStatistics.FACET_ID)).andReturn(keys);
  String key=keys.get(1);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  key=keys.get(2);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  expect(metadataRepository.canObtainAccess(Session.class)).andReturn(false).times(3);
  metadataRepositoryControl.replay();
  for (  RepositoryStatistics stats : statsCreated.values()) {
    repositoryStatisticsManager.addStatisticsAfterScan(metadataRepository,TEST_REPO_ID,stats.getScanStartTime(),stats.getScanEndTime(),56345,45);
  }
  List<RepositoryStatistics> list=repositoryStatisticsManager.getStatisticsInRange(metadataRepository,TEST_REPO_ID,new Date(current.getTime() - 4000),current);
  assertEquals(2,list.size());
  assertEquals(new Date(current.getTime() - 3000),list.get(1).getScanStartTime());
  assertEquals(new Date(current.getTime() - 1000),list.get(0).getScanStartTime());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStatsRangeInside() throws Exception {
  walkRepository(3);
  Date current=new Date();
  addStats(new Date(current.getTime() - 12345),new Date(current.getTime() - 6000));
  addStats(new Date(current.getTime() - 3000),new Date(current.getTime() - 2000));
  addStats(new Date(current.getTime() - 1000),current);
  ArrayList<String> keys=new ArrayList<>(statsCreated.keySet());
  expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,RepositoryStatistics.FACET_ID)).andReturn(keys);
  String key=keys.get(1);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  expect(metadataRepository.canObtainAccess(Session.class)).andReturn(false).times(3);
  metadataRepositoryControl.replay();
  for (  RepositoryStatistics stats : statsCreated.values()) {
    repositoryStatisticsManager.addStatisticsAfterScan(metadataRepository,TEST_REPO_ID,stats.getScanStartTime(),stats.getScanEndTime(),56345,45);
  }
  List<RepositoryStatistics> list=repositoryStatisticsManager.getStatisticsInRange(metadataRepository,TEST_REPO_ID,new Date(current.getTime() - 4000),new Date(current.getTime() - 2000));
  assertEquals(1,list.size());
  assertEquals(new Date(current.getTime() - 3000),list.get(0).getScanStartTime());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStatsRangeLowerOutside() throws Exception {
  walkRepository(3);
  Date current=new Date();
  addStats(new Date(current.getTime() - 12345),new Date(current.getTime() - 6000));
  addStats(new Date(current.getTime() - 3000),new Date(current.getTime() - 2000));
  addStats(new Date(current.getTime() - 1000),current);
  List<String> keys=new ArrayList<>(statsCreated.keySet());
  expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,RepositoryStatistics.FACET_ID)).andReturn(keys);
  String key=keys.get(0);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  key=keys.get(1);
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,key)).andReturn(statsCreated.get(key));
  expect(metadataRepository.canObtainAccess(Session.class)).andReturn(false).times(3);
  metadataRepositoryControl.replay();
  for (  RepositoryStatistics stats : statsCreated.values()) {
    repositoryStatisticsManager.addStatisticsAfterScan(metadataRepository,TEST_REPO_ID,stats.getScanStartTime(),stats.getScanEndTime(),56345,45);
  }
  List<RepositoryStatistics> list=repositoryStatisticsManager.getStatisticsInRange(metadataRepository,TEST_REPO_ID,new Date(current.getTime() - 20000),new Date(current.getTime() - 2000));
  assertEquals(2,list.size());
  assertEquals(new Date(current.getTime() - 12345),list.get(1).getScanStartTime());
  assertEquals(new Date(current.getTime() - 3000),list.get(0).getScanStartTime());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetStatsRangeNotInside() throws Exception {
  walkRepository(3);
  Date current=new Date();
  addStats(new Date(current.getTime() - 12345),new Date(current.getTime() - 6000));
  addStats(new Date(current.getTime() - 3000),new Date(current.getTime() - 2000));
  addStats(new Date(current.getTime() - 1000),current);
  ArrayList<String> keys=new ArrayList<>(statsCreated.keySet());
  expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,RepositoryStatistics.FACET_ID)).andReturn(keys);
  expect(metadataRepository.canObtainAccess(Session.class)).andReturn(false).times(3);
  metadataRepositoryControl.replay();
  for (  RepositoryStatistics stats : statsCreated.values()) {
    repositoryStatisticsManager.addStatisticsAfterScan(metadataRepository,TEST_REPO_ID,stats.getScanStartTime(),stats.getScanEndTime(),56345,45);
  }
  List<RepositoryStatistics> list=repositoryStatisticsManager.getStatisticsInRange(metadataRepository,TEST_REPO_ID,new Date(current.getTime() - 20000),new Date(current.getTime() - 16000));
  assertEquals(0,list.size());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetLatestStats() throws Exception {
  Date startTime=TIMESTAMP_FORMAT.parse(SECOND_TEST_SCAN);
  Date endTime=new Date(startTime.getTime() + 60000);
  RepositoryStatistics stats=new RepositoryStatistics();
  stats.setScanStartTime(startTime);
  stats.setScanEndTime(endTime);
  stats.setTotalArtifactFileSize(1314527915L);
  stats.setNewFileCount(123);
  stats.setTotalArtifactCount(10386);
  stats.setTotalProjectCount(2031);
  stats.setTotalGroupCount(529);
  stats.setTotalFileCount(56229);
  expect(metadataRepository.getMetadataFacets(TEST_REPO_ID,RepositoryStatistics.FACET_ID)).andReturn(Arrays.asList(FIRST_TEST_SCAN,SECOND_TEST_SCAN));
  expect(metadataRepository.getMetadataFacet(TEST_REPO_ID,RepositoryStatistics.FACET_ID,SECOND_TEST_SCAN)).andReturn(stats);
  metadataRepositoryControl.replay();
  stats=repositoryStatisticsManager.getLastStatistics(metadataRepository,TEST_REPO_ID);
  assertNotNull(stats);
  assertEquals(1314527915L,stats.getTotalArtifactFileSize());
  assertEquals(123,stats.getNewFileCount());
  assertEquals(10386,stats.getTotalArtifactCount());
  assertEquals(2031,stats.getTotalProjectCount());
  assertEquals(529,stats.getTotalGroupCount());
  assertEquals(56229,stats.getTotalFileCount());
  assertEquals(SECOND_TEST_SCAN,TIMESTAMP_FORMAT.format(stats.getScanStartTime()));
  assertEquals(SECOND_TEST_SCAN,stats.getName());
  assertEquals(endTime,stats.getScanEndTime());
  metadataRepositoryControl.verify();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.metadata.repository.storage.maven2.Maven2RepositoryMetadataResolverTest </h4><pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetArtifactMetadata() throws Exception {
  Collection<ArtifactMetadata> springArtifacts=storage.readArtifactsMetadata(new ReadMetadataRequest(TEST_REPO_ID,"org.codehaus.plexus","plexus-spring","1.2",ALL));
  List<ArtifactMetadata> artifacts=new ArrayList<>(springArtifacts);
  Collections.sort(artifacts,new Comparator<ArtifactMetadata>(){
    @Override public int compare(    ArtifactMetadata o1,    ArtifactMetadata o2){
      return o1.getId().compareTo(o2.getId());
    }
  }
);
  assertEquals(3,artifacts.size());
  ArtifactMetadata artifactMetadata=artifacts.get(0);
  assertEquals("plexus-spring-1.2-sources.jar",artifactMetadata.getId());
  MavenArtifactFacet facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(0,facet.getBuildNumber());
  assertNull(facet.getTimestamp());
  assertEquals("sources",facet.getClassifier());
  assertEquals("java-source",facet.getType());
  artifactMetadata=artifacts.get(1);
  assertEquals("plexus-spring-1.2.jar",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(0,facet.getBuildNumber());
  assertNull(facet.getTimestamp());
  assertNull(facet.getClassifier());
  assertEquals("jar",facet.getType());
  artifactMetadata=artifacts.get(2);
  assertEquals("plexus-spring-1.2.pom",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(0,facet.getBuildNumber());
  assertNull(facet.getTimestamp());
  assertNull(facet.getClassifier());
  assertEquals("pom",facet.getType());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetArtifactMetadataSnapshots() throws Exception {
  Collection<ArtifactMetadata> testArtifacts=storage.readArtifactsMetadata(new ReadMetadataRequest(TEST_REPO_ID,"com.example.test","test-artifact","1.0-SNAPSHOT",ALL));
  List<ArtifactMetadata> artifacts=new ArrayList<>(testArtifacts);
  Collections.sort(artifacts,new Comparator<ArtifactMetadata>(){
    @Override public int compare(    ArtifactMetadata o1,    ArtifactMetadata o2){
      return o1.getId().compareTo(o2.getId());
    }
  }
);
  assertEquals(6,artifacts.size());
  ArtifactMetadata artifactMetadata=artifacts.get(0);
  assertEquals("test-artifact-1.0-20100308.230825-1.jar",artifactMetadata.getId());
  MavenArtifactFacet facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(1,facet.getBuildNumber());
  assertEquals("20100308.230825",facet.getTimestamp());
  assertNull(facet.getClassifier());
  assertEquals("jar",facet.getType());
  artifactMetadata=artifacts.get(1);
  assertEquals("test-artifact-1.0-20100308.230825-1.pom",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(1,facet.getBuildNumber());
  assertEquals("20100308.230825",facet.getTimestamp());
  assertNull(facet.getClassifier());
  assertEquals("pom",facet.getType());
  artifactMetadata=artifacts.get(2);
  assertEquals("test-artifact-1.0-20100310.014828-2-javadoc.jar",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(2,facet.getBuildNumber());
  assertEquals("20100310.014828",facet.getTimestamp());
  assertEquals("javadoc",facet.getClassifier());
  assertEquals("javadoc",facet.getType());
  artifactMetadata=artifacts.get(3);
  assertEquals("test-artifact-1.0-20100310.014828-2-sources.jar",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(2,facet.getBuildNumber());
  assertEquals("20100310.014828",facet.getTimestamp());
  assertEquals("sources",facet.getClassifier());
  assertEquals("java-source",facet.getType());
  artifactMetadata=artifacts.get(4);
  assertEquals("test-artifact-1.0-20100310.014828-2.jar",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(2,facet.getBuildNumber());
  assertEquals("20100310.014828",facet.getTimestamp());
  assertNull(facet.getClassifier());
  assertEquals("jar",facet.getType());
  artifactMetadata=artifacts.get(5);
  assertEquals("test-artifact-1.0-20100310.014828-2.pom",artifactMetadata.getId());
  facet=(MavenArtifactFacet)artifactMetadata.getFacet(MavenArtifactFacet.FACET_ID);
  assertEquals(2,facet.getBuildNumber());
  assertEquals("20100310.014828",facet.getTimestamp());
  assertNull(facet.getClassifier());
  assertEquals("pom",facet.getType());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetArtifactsTimestampedSnapshots() throws Exception {
  List<ArtifactMetadata> artifacts=new ArrayList<ArtifactMetadata>(storage.readArtifactsMetadata(new ReadMetadataRequest(TEST_REPO_ID,"com.example.test","missing-metadata","1.0-SNAPSHOT",ALL)));
  assertEquals(1,artifacts.size());
  ArtifactMetadata artifact=artifacts.get(0);
  assertEquals("missing-metadata-1.0-20091101.112233-1.pom",artifact.getId());
  assertEquals("com.example.test",artifact.getNamespace());
  assertEquals("missing-metadata",artifact.getProject());
  assertEquals("1.0-20091101.112233-1",artifact.getVersion());
  assertEquals(TEST_REPO_ID,artifact.getRepositoryId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.metadata.repository.storage.maven2.MavenRepositoryMetadataReaderTest </h4><pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupMetadata() throws XMLException {
  File metadataFile=new File(defaultRepoDir,"org/apache/maven/plugins/maven-metadata.xml");
  ArchivaRepositoryMetadata metadata=MavenMetadataReader.read(metadataFile);
  assertNotNull(metadata);
  assertEquals("org.apache.maven.plugins",metadata.getGroupId());
  assertNull(metadata.getArtifactId());
  assertNull(metadata.getReleasedVersion());
  assertNull(metadata.getLatestVersion());
  assertTrue(metadata.getAvailableVersions().isEmpty());
  assertNull(metadata.getSnapshotVersion());
  assertNull(metadata.getLastUpdated());
  Plugin cleanPlugin=new Plugin();
  cleanPlugin.setPrefix("clean");
  cleanPlugin.setArtifactId("maven-clean-plugin");
  cleanPlugin.setName("Maven Clean Plugin");
  Plugin compilerPlugin=new Plugin();
  compilerPlugin.setPrefix("compiler");
  compilerPlugin.setArtifactId("maven-compiler-plugin");
  compilerPlugin.setName("Maven Compiler Plugin");
  Plugin surefirePlugin=new Plugin();
  surefirePlugin.setPrefix("surefire");
  surefirePlugin.setArtifactId("maven-surefire-plugin");
  surefirePlugin.setName("Maven Surefire Plugin");
  assertEquals(Arrays.asList(cleanPlugin,compilerPlugin,surefirePlugin),metadata.getPlugins());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectVersionMetadata() throws XMLException {
  File metadataFile=new File(defaultRepoDir,"org/apache/apache/5-SNAPSHOT/maven-metadata.xml");
  ArchivaRepositoryMetadata metadata=MavenMetadataReader.read(metadataFile);
  assertNotNull(metadata);
  assertEquals("org.apache",metadata.getGroupId());
  assertEquals("apache",metadata.getArtifactId());
  assertNull(metadata.getReleasedVersion());
  assertNull(metadata.getLatestVersion());
  assertTrue(metadata.getAvailableVersions().isEmpty());
  assertNotNull(metadata.getSnapshotVersion());
  assertEquals("20080801.151215",metadata.getSnapshotVersion().getTimestamp());
  assertEquals(1,metadata.getSnapshotVersion().getBuildNumber());
  assertEquals("20080801151215",metadata.getLastUpdated());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectMetadata() throws XMLException {
  File metadataFile=new File(defaultRepoDir,"org/apache/maven/shared/maven-downloader/maven-metadata.xml");
  ArchivaRepositoryMetadata metadata=MavenMetadataReader.read(metadataFile);
  assertNotNull(metadata);
  assertEquals("org.apache.maven.shared",metadata.getGroupId());
  assertEquals("maven-downloader",metadata.getArtifactId());
  assertEquals("1.1",metadata.getReleasedVersion());
  assertNull(metadata.getLatestVersion());
  assertEquals(Arrays.asList("1.0","1.1"),metadata.getAvailableVersions());
  assertNull(metadata.getSnapshotVersion());
  assertEquals("20061212214311",metadata.getLastUpdated());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.proxy.ChecksumTransferTest </h4><pre class="type-9 type-3 type-7 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetChecksumWhenConnectorIsDisabled() throws Exception {
  String path="org/apache/maven/test/get-checksum-both-right/1.0/get-checksum-both-right-1.0.jar";
  setupTestableManagedRepository(path);
  File expectedFile=new File(managedDefaultDir,path);
  ArtifactReference artifact=managedDefaultRepository.toArtifactReference(path);
  FileUtils.deleteDirectory(expectedFile.getParentFile());
  assertFalse(expectedFile.exists());
  saveConnector(ID_DEFAULT_MANAGED,"proxied1",ChecksumPolicy.IGNORE,ReleasesPolicy.ALWAYS,SnapshotsPolicy.ALWAYS,CachedFailuresPolicy.NO,true);
  File downloadedFile=proxyHandler.fetchFromProxies(managedDefaultRepository,artifact);
  assertNull(downloadedFile);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.proxy.ErrorHandlingTest </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPropagateOnUpdateNotPresentArtifactPresent() throws Exception {
  String path=PATH_IN_BOTH_REMOTES_AND_LOCAL;
  File expectedFile=setupRepositoriesWithLocalFilePresent(path);
  createMockedProxyConnector(ID_MOCKED_PROXIED1,NAME_MOCKED_PROXIED1,PropagateErrorsDownloadPolicy.STOP,PropagateErrorsOnUpdateDownloadPolicy.NOT_PRESENT);
  createMockedProxyConnector(ID_MOCKED_PROXIED2,NAME_MOCKED_PROXIED2,PropagateErrorsDownloadPolicy.STOP,PropagateErrorsOnUpdateDownloadPolicy.NOT_PRESENT);
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  confirmNotDownloadedNoError(path);
  assertTrue(expectedFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPropagateOnUpdateNotPresentIgnoreArtifactPresent() throws Exception {
  String path=PATH_IN_BOTH_REMOTES_AND_LOCAL;
  File expectedFile=setupRepositoriesWithLocalFilePresent(path);
  createMockedProxyConnector(ID_MOCKED_PROXIED1,NAME_MOCKED_PROXIED1,PropagateErrorsDownloadPolicy.IGNORE,PropagateErrorsOnUpdateDownloadPolicy.NOT_PRESENT);
  createMockedProxyConnector(ID_MOCKED_PROXIED2,NAME_MOCKED_PROXIED2,PropagateErrorsDownloadPolicy.IGNORE,PropagateErrorsOnUpdateDownloadPolicy.NOT_PRESENT);
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  confirmNotDownloadedNoError(path);
  assertTrue(expectedFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPropagateOnUpdateAlwaysIgnoreArtifactPresent() throws Exception {
  String path=PATH_IN_BOTH_REMOTES_AND_LOCAL;
  File expectedFile=setupRepositoriesWithLocalFilePresent(path);
  createMockedProxyConnector(ID_MOCKED_PROXIED1,NAME_MOCKED_PROXIED1,PropagateErrorsDownloadPolicy.IGNORE,PropagateErrorsOnUpdateDownloadPolicy.ALWAYS);
  createMockedProxyConnector(ID_MOCKED_PROXIED2,NAME_MOCKED_PROXIED2,PropagateErrorsDownloadPolicy.IGNORE,PropagateErrorsOnUpdateDownloadPolicy.ALWAYS);
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  confirmNotDownloadedNoError(path);
  assertTrue(expectedFile.exists());
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testPropagateOnUpdateNotPresentQueueArtifactPresent() throws Exception {
  String path=PATH_IN_BOTH_REMOTES_AND_LOCAL;
  File expectedFile=setupRepositoriesWithLocalFilePresent(path);
  createMockedProxyConnector(ID_MOCKED_PROXIED1,NAME_MOCKED_PROXIED1,PropagateErrorsDownloadPolicy.QUEUE,PropagateErrorsOnUpdateDownloadPolicy.NOT_PRESENT);
  createMockedProxyConnector(ID_MOCKED_PROXIED2,NAME_MOCKED_PROXIED2,PropagateErrorsDownloadPolicy.QUEUE,PropagateErrorsOnUpdateDownloadPolicy.NOT_PRESENT);
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  simulateGetIfNewerError(path,expectedFile,createTransferException());
  confirmNotDownloadedNoError(path);
  assertTrue(expectedFile.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.proxy.HttpProxyTransferTest </h4><pre class="type-9 type-3 type-5 type-7 type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetOverHttpProxy() throws Exception {
  Assertions.assertThat(System.getProperty("http.proxyHost")).isEmpty();
  Assertions.assertThat(System.getProperty("http.proxyPort")).isEmpty();
  String path="org/apache/maven/test/get-default-layout/1.0/get-default-layout-1.0.jar";
  addConnector();
  File expectedFile=new File(new File(managedDefaultRepository.getRepoRoot()),path);
  ArtifactReference artifact=managedDefaultRepository.toArtifactReference(path);
  File downloadedFile=proxyHandler.fetchFromProxies(managedDefaultRepository,artifact);
  File sourceFile=new File(PROXIED_BASEDIR,path);
  assertNotNull("Expected File should not be null.",expectedFile);
  assertNotNull("Actual File should not be null.",downloadedFile);
  assertTrue("Check actual file exists.",downloadedFile.exists());
  assertEquals("Check filename path is appropriate.",expectedFile.getCanonicalPath(),downloadedFile.getCanonicalPath());
  assertEquals("Check file path matches.",expectedFile.getAbsolutePath(),downloadedFile.getAbsolutePath());
  String expectedContents=FileUtils.readFileToString(sourceFile,Charset.defaultCharset());
  String actualContents=FileUtils.readFileToString(downloadedFile,Charset.defaultCharset());
  assertEquals("Check file contents.",expectedContents,actualContents);
  Assertions.assertThat(System.getProperty("http.proxyHost")).isEmpty();
  Assertions.assertThat(System.getProperty("http.proxyPort")).isEmpty();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.proxy.ManagedDefaultTransferTest </h4><pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testGetDefaultLayoutNotPresentConnectorOffline() throws Exception {
  String path="org/apache/maven/test/get-default-layout/1.0/get-default-layout-1.0.jar";
  setupTestableManagedRepository(path);
  File expectedFile=new File(managedDefaultDir,path);
  ArtifactReference artifact=managedDefaultRepository.toArtifactReference(path);
  assertNotExistsInManagedDefaultRepo(expectedFile);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED1,ChecksumPolicy.FIX,ReleasesPolicy.ONCE,SnapshotsPolicy.ONCE,CachedFailuresPolicy.NO,true);
  File downloadedFile=proxyHandler.fetchFromProxies(managedDefaultRepository,artifact);
  assertNull("File should not have been downloaded",downloadedFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetDefaultLayoutNotPresentPassthrough() throws Exception {
  String path="org/apache/maven/test/get-default-layout/1.0/get-default-layout-1.0.jar.asc";
  setupTestableManagedRepository(path);
  File expectedFile=new File(managedDefaultDir,path);
  assertNotExistsInManagedDefaultRepo(expectedFile);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED1,ChecksumPolicy.FIX,ReleasesPolicy.ONCE,SnapshotsPolicy.ONCE,CachedFailuresPolicy.NO,false);
  File downloadedFile=proxyHandler.fetchFromProxies(managedDefaultRepository,path);
  File sourceFile=new File(REPOPATH_PROXIED1,path);
  assertFileEquals(expectedFile,downloadedFile,sourceFile);
  assertFalse(new File(downloadedFile.getParentFile(),downloadedFile.getName() + ".sha1").exists());
  assertFalse(new File(downloadedFile.getParentFile(),downloadedFile.getName() + ".md5").exists());
  assertFalse(new File(downloadedFile.getParentFile(),downloadedFile.getName() + ".asc").exists());
  assertNoTempFiles(expectedFile);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetWhenInBothProxiedRepos() throws Exception {
  String path="org/apache/maven/test/get-in-both-proxies/1.0/get-in-both-proxies-1.0.jar";
  setupTestableManagedRepository(path);
  File expectedFile=new File(managedDefaultDir,path);
  ArtifactReference artifact=managedDefaultRepository.toArtifactReference(path);
  assertNotExistsInManagedDefaultRepo(expectedFile);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED1,false);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED2,false);
  File downloadedFile=proxyHandler.fetchFromProxies(managedDefaultRepository,artifact);
  File proxied1File=new File(REPOPATH_PROXIED1,path);
  File proxied2File=new File(REPOPATH_PROXIED2,path);
  assertFileEquals(expectedFile,downloadedFile,proxied1File);
  assertNoTempFiles(expectedFile);
  String actualContents=FileUtils.readFileToString(downloadedFile,Charset.defaultCharset());
  String badContents=FileUtils.readFileToString(proxied2File,Charset.defaultCharset());
  assertFalse("Downloaded file contents should not be that of proxy 2",StringUtils.equals(actualContents,badContents));
}

</code></pre>

<br>
<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testNotFoundInAnyProxies() throws Exception {
  String path="org/apache/maven/test/does-not-exist/1.0/does-not-exist-1.0.jar";
  setupTestableManagedRepository(path);
  File expectedFile=new File(managedDefaultDir,path);
  ArtifactReference artifact=managedDefaultRepository.toArtifactReference(path);
  assertNotExistsInManagedDefaultRepo(expectedFile);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED1,false);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED2,false);
  File downloadedFile=proxyHandler.fetchFromProxies(managedDefaultRepository,artifact);
  assertNull("File returned was: " + downloadedFile + "; should have got a not found exception",downloadedFile);
  assertNoTempFiles(expectedFile);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.proxy.MetadataTransferTest </h4><pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testGetProjectMetadataProxiedNotLocalOnRemoteConnectoDisabled() throws Exception {
  String requestedResource="org/apache/maven/test/get-found-in-proxy/maven-metadata.xml";
  setupTestableManagedRepository(requestedResource);
  saveConnector(ID_DEFAULT_MANAGED,ID_PROXIED1,ChecksumPolicy.FIX,ReleasesPolicy.ALWAYS,SnapshotsPolicy.ALWAYS,CachedFailuresPolicy.NO,true);
  assertResourceNotFound(requestedResource);
  assertNoRepoMetadata(ID_PROXIED1,requestedResource);
  File expectedFile=new File(managedDefaultDir,requestedResource);
  ProjectReference metadata=createProjectReference(requestedResource);
  File downloadedFile=proxyHandler.fetchMetadataFromProxies(managedDefaultRepository,managedDefaultRepository.toMetadataPath(metadata)).getFile();
  assertNull("Should not have downloaded a file.",downloadedFile);
  assertNoTempFiles(expectedFile);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.remotedownload.DownloadArtifactsTest </h4><pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void downloadWithRemoteRedirect() throws Exception {
  RemoteRepository remoteRepository=getRemoteRepositoriesService().getRemoteRepository("central");
  remoteRepository.setUrl("http://localhost:" + redirectPort);
  getRemoteRepositoriesService().updateRemoteRepository(remoteRepository);
  RoleManagementService roleManagementService=getRoleManagementService(authorizationHeader);
  if (!roleManagementService.templatedRoleExists(ArchivaRoleConstants.TEMPLATE_REPOSITORY_OBSERVER,"internal")) {
    roleManagementService.createTemplatedRole(ArchivaRoleConstants.TEMPLATE_REPOSITORY_OBSERVER,"internal");
  }
  getUserService(authorizationHeader).createGuestUser();
  roleManagementService.assignRole(ArchivaRoleConstants.TEMPLATE_GUEST,"guest");
  roleManagementService.assignTemplatedRole(ArchivaRoleConstants.TEMPLATE_REPOSITORY_OBSERVER,"internal","guest");
  getUserService(authorizationHeader).removeFromCache("guest");
  File file=new File("target/junit-4.9.jar");
  if (file.exists()) {
    file.delete();
  }
  HttpWagon httpWagon=new HttpWagon();
  httpWagon.connect(new Repository("foo","http://localhost:" + port));
  httpWagon.get("/repository/internal/junit/junit/4.9/junit-4.9.jar",file);
  ZipFile zipFile=new ZipFile(file);
  List<String> entries=getZipEntriesNames(zipFile);
  ZipEntry zipEntry=zipFile.getEntry("org/junit/runners/JUnit4.class");
  assertNotNull("cannot find zipEntry org/junit/runners/JUnit4.class, entries: " + entries + ", content is: "+ FileUtils.readFileToString(file),zipEntry);
  zipFile.close();
  file.deleteOnExit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.remotedownload.DownloadSnapshotTest </h4><pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void downloadSNAPSHOT() throws Exception {
  File tmpIndexDir=new File(System.getProperty("java.io.tmpdir") + "/tmpIndex");
  if (tmpIndexDir.exists()) {
    FileUtils.deleteDirectory(tmpIndexDir);
  }
  String id=Long.toString(System.currentTimeMillis());
  ManagedRepository managedRepository=new ManagedRepository();
  managedRepository.setId(id);
  managedRepository.setName("name of " + id);
  managedRepository.setLocation(System.getProperty("basedir") + "/src/test/repositories/snapshot-repo");
  managedRepository.setIndexDirectory(System.getProperty("java.io.tmpdir") + "/tmpIndex/" + id);
  ManagedRepositoriesService managedRepositoriesService=getManagedRepositoriesService();
  if (managedRepositoriesService.getManagedRepository(id) != null) {
    managedRepositoriesService.deleteManagedRepository(id,false);
  }
  getManagedRepositoriesService().addManagedRepository(managedRepository);
  RoleManagementService roleManagementService=getRoleManagementService(authorizationHeader);
  if (!roleManagementService.templatedRoleExists(ArchivaRoleConstants.TEMPLATE_REPOSITORY_OBSERVER,id)) {
    roleManagementService.createTemplatedRole(ArchivaRoleConstants.TEMPLATE_REPOSITORY_OBSERVER,id);
  }
  getUserService(authorizationHeader).createGuestUser();
  roleManagementService.assignRole(ArchivaRoleConstants.TEMPLATE_GUEST,"guest");
  roleManagementService.assignTemplatedRole(ArchivaRoleConstants.TEMPLATE_REPOSITORY_OBSERVER,id,"guest");
  getUserService(authorizationHeader).removeFromCache("guest");
  File file=new File("target/archiva-model-1.4-M4-SNAPSHOT.jar");
  if (file.exists()) {
    file.delete();
  }
  HttpWagon httpWagon=new HttpWagon();
  httpWagon.connect(new Repository("foo","http://localhost:" + port));
  httpWagon.get("/repository/" + id + "/org/apache/archiva/archiva-model/1.4-M4-SNAPSHOT/archiva-model-1.4-M4-SNAPSHOT.jar",file);
  ZipFile zipFile=new ZipFile(file);
  List<String> entries=getZipEntriesNames(zipFile);
  ZipEntry zipEntry=zipFile.getEntry("org/apache/archiva/model/ArchivaArtifact.class");
  assertNotNull("cannot find zipEntry org/apache/archiva/model/ArchivaArtifact.class, entries: " + entries + ", content is: "+ FileUtils.readFileToString(file),zipEntry);
  zipFile.close();
  file.deleteOnExit();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.repository.metadata.RepositoryMetadataReaderTest </h4><pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadSimple() throws XMLException {
  File defaultRepoDir=new File("src/test/repositories/default-repository");
  File metadataFile=new File(defaultRepoDir,"org/apache/maven/shared/maven-downloader/maven-metadata.xml");
  ArchivaRepositoryMetadata metadata=MavenMetadataReader.read(metadataFile);
  assertNotNull(metadata);
  assertEquals("Group Id","org.apache.maven.shared",metadata.getGroupId());
  assertEquals("Artifact Id","maven-downloader",metadata.getArtifactId());
  assertEquals("Released Version","1.1",metadata.getReleasedVersion());
  assertEquals("List of Available Versions",2,metadata.getAvailableVersions().size());
  assertTrue("Available version 1.0",metadata.getAvailableVersions().contains("1.0"));
  assertTrue("Available version 1.1",metadata.getAvailableVersions().contains("1.1"));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadComplex() throws XMLException {
  File defaultRepoDir=new File("src/test/repositories/default-repository");
  File metadataFile=new File(defaultRepoDir,"org/apache/maven/samplejar/maven-metadata.xml");
  ArchivaRepositoryMetadata metadata=MavenMetadataReader.read(metadataFile);
  assertNotNull(metadata);
  assertEquals("Group Id","org.apache.maven",metadata.getGroupId());
  assertEquals("Artifact Id","samplejar",metadata.getArtifactId());
  assertEquals("Released Version","2.0",metadata.getReleasedVersion());
  assertEquals("Latest Version","6.0-SNAPSHOT",metadata.getLatestVersion());
  assertEquals("List of Available Versions",18,metadata.getAvailableVersions().size());
  assertTrue("Available version 6.0-20060311.183228-10",metadata.getAvailableVersions().contains("6.0-20060311.183228-10"));
  assertTrue("Available version 6.0-SNAPSHOT",metadata.getAvailableVersions().contains("6.0-SNAPSHOT"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.repository.scanner.RepositoryContentConsumersTest </h4><pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAvailableInvalidList() throws Exception {
  RepositoryContentConsumers consumerutil=lookupRepositoryConsumers();
  String expectedInvalidIds[]=new String[]{"update-db-bad-content","move-to-trash-then-notify"};
  List<InvalidRepositoryContentConsumer> invalidConsumers=consumerutil.getAvailableInvalidConsumers();
  assertNotNull("invalid consumers should not be null.",invalidConsumers);
  assertEquals("invalid consumers",expectedInvalidIds.length,invalidConsumers.size());
  List<String> expectedIds=Arrays.asList(expectedInvalidIds);
  for (  InvalidRepositoryContentConsumer consumer : invalidConsumers) {
    assertTrue("Consumer [" + consumer.getId() + "] returned by .getAvailableInvalidConsumers() is unexpected.",expectedIds.contains(consumer.getId()));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSelectedInvalidConsumerMap() throws Exception {
  RepositoryContentConsumers consumerutil=lookupRepositoryConsumers();
  String expectedSelectedInvalidIds[]=new String[]{"update-db-bad-content"};
  Map<String,InvalidRepositoryContentConsumer> invalidConsumerMap=consumerutil.getSelectedInvalidConsumersMap();
  assertNotNull("Invalid Consumer Map should not be null",invalidConsumerMap);
  assertEquals("Invalid Consumer Map.size",expectedSelectedInvalidIds.length,invalidConsumerMap.size());
  for (  String expectedId : expectedSelectedInvalidIds) {
    InvalidRepositoryContentConsumer consumer=invalidConsumerMap.get(expectedId);
    assertNotNull("Known[" + expectedId + "] should not be null.",consumer);
    assertEquals("Known[" + expectedId + "].id",expectedId,consumer.getId());
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAvailableKnownList() throws Exception {
  RepositoryContentConsumers consumerutil=lookupRepositoryConsumers();
  String expectedKnownIds[]=new String[]{"update-db-artifact","create-missing-checksums","update-db-repository-metadata","validate-checksum","index-content","auto-remove","auto-rename","available-but-unselected"};
  List<KnownRepositoryContentConsumer> knownConsumers=consumerutil.getAvailableKnownConsumers();
  assertNotNull("known consumers should not be null.",knownConsumers);
  assertEquals("known consumers",expectedKnownIds.length,knownConsumers.size());
  List<String> expectedIds=Arrays.asList(expectedKnownIds);
  for (  KnownRepositoryContentConsumer consumer : knownConsumers) {
    assertTrue("Consumer [" + consumer.getId() + "] returned by .getAvailableKnownConsumers() is unexpected.",expectedIds.contains(consumer.getId()));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSelectedKnownConsumerMap() throws Exception {
  RepositoryContentConsumers consumerutil=lookupRepositoryConsumers();
  String expectedSelectedKnownIds[]=new String[]{"create-missing-checksums","validate-checksum","index-content","auto-remove","auto-rename"};
  Map<String,KnownRepositoryContentConsumer> knownConsumerMap=consumerutil.getSelectedKnownConsumersMap();
  assertNotNull("Known Consumer Map should not be null",knownConsumerMap);
  assertEquals("Known Consumer Map.size but " + knownConsumerMap,expectedSelectedKnownIds.length,knownConsumerMap.size());
  for (  String expectedId : expectedSelectedKnownIds) {
    KnownRepositoryContentConsumer consumer=knownConsumerMap.get(expectedId);
    assertNotNull("Known[" + expectedId + "] should not be null.",consumer);
    assertEquals("Known[" + expectedId + "].id",expectedId,consumer.getId());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.rest.services.SearchServiceTest </h4><pre class="type-9 type-16 type-5 type-7 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getSearchArtifactsWithOnlyClassifier() throws Exception {
  if (getUserService(authorizationHeader).getGuestUser() == null) {
    assertNotNull(getUserService(authorizationHeader).createGuestUser());
  }
  createAndIndexRepo(TEST_REPO,"src/test/repo-with-classifier-only");
  SearchService searchService=getSearchService(authorizationHeader);
  SearchRequest searchRequest=new SearchRequest("org.foo","studio-all-update-site",null,null,null,Arrays.asList(TEST_REPO));
  List<Artifact> artifacts=searchService.searchArtifacts(searchRequest);
  log.info("artifacts: {}",artifacts);
  assertEquals(1,artifacts.size());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void getAllGroupIds() throws Exception {
  SearchService searchService=getSearchService(authorizationHeader);
  Collection<String> groupIds=searchService.getAllGroupIds(Arrays.asList(TEST_REPO)).getGroupIds();
  log.info("groupIds  {}",groupIds);
  assertFalse(groupIds.isEmpty());
  assertTrue(groupIds.contains("commons-cli"));
  assertTrue(groupIds.contains("org.apache.felix"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.rss.processor.NewArtifactsRssFeedProcessorTest </h4><pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testProcess() throws Exception {
  List<ArtifactMetadata> newArtifacts=new ArrayList<>();
  Date whenGathered=Calendar.getInstance().getTime();
  newArtifacts.add(createArtifact("artifact-one","1.0",whenGathered));
  newArtifacts.add(createArtifact("artifact-one","1.1",whenGathered));
  newArtifacts.add(createArtifact("artifact-one","2.0",whenGathered));
  newArtifacts.add(createArtifact("artifact-two","1.0.1",whenGathered));
  newArtifacts.add(createArtifact("artifact-two","1.0.2",whenGathered));
  newArtifacts.add(createArtifact("artifact-two","1.0.3-SNAPSHOT",whenGathered));
  newArtifacts.add(createArtifact("artifact-three","2.0-SNAPSHOT",whenGathered));
  newArtifacts.add(createArtifact("artifact-four","1.1-beta-2",whenGathered));
  metadataRepository.setArtifactsByDateRange(newArtifacts);
  Map<String,String> reqParams=new HashMap<>();
  reqParams.put(RssFeedProcessor.KEY_REPO_ID,TEST_REPO);
  SyndFeed feed=newArtifactsProcessor.process(reqParams,metadataRepository);
  Calendar cal=Calendar.getInstance(TimeZone.getTimeZone("GMT"));
  cal.add(Calendar.DATE,-30);
  assertTrue((metadataRepository.getFrom().getTime() - cal.getTimeInMillis()) < 1000 * 5);
  assertEquals(null,metadataRepository.getTo());
  assertEquals(TEST_REPO,metadataRepository.getRepoId());
  assertTrue(feed.getTitle().equals("New Artifacts in Repository 'test-repo'"));
  assertTrue(feed.getDescription().equals("New artifacts found in repository 'test-repo' during repository scan."));
  assertTrue(feed.getLanguage().equals("en-us"));
  assertTrue(feed.getPublishedDate().equals(whenGathered));
  List<SyndEntry> entries=feed.getEntries();
  assertEquals(entries.size(),1);
  assertTrue(entries.get(0).getTitle().equals("New Artifacts in Repository 'test-repo' as of " + whenGathered));
  assertTrue(entries.get(0).getPublishedDate().equals(whenGathered));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.scheduler.indexing.ArchivaIndexingTaskExecutorTest </h4><pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddArtifactToIndex() throws Exception {
  File artifactFile=new File(repositoryConfig.getLocation(),"org/apache/archiva/archiva-index-methods-jar-test/1.0/archiva-index-methods-jar-test-1.0.jar");
  ArtifactIndexingTask task=new ArtifactIndexingTask(repositoryConfig,artifactFile,ArtifactIndexingTask.Action.ADD,getIndexingContext());
  indexingExecutor.executeTask(task);
  BooleanQuery q=new BooleanQuery();
  q.add(indexer.constructQuery(MAVEN.GROUP_ID,new StringSearchExpression("org.apache.archiva")),Occur.SHOULD);
  q.add(indexer.constructQuery(MAVEN.ARTIFACT_ID,new StringSearchExpression("archiva-index-methods-jar-test")),Occur.SHOULD);
  if (!indexer.getIndexingContexts().containsKey(repositoryConfig.getId())) {
    IndexingContext context=indexer.addIndexingContext(repositoryConfig.getId(),repositoryConfig.getId(),new File(repositoryConfig.getLocation()),new File(repositoryConfig.getLocation(),".indexer"),null,null,mavenIndexerUtils.getAllIndexCreators());
    context.setSearchable(true);
  }
  FlatSearchRequest request=new FlatSearchRequest(q);
  FlatSearchResponse response=indexer.searchFlat(request);
  assertTrue(new File(repositoryConfig.getLocation(),".indexer").exists());
  assertFalse(new File(repositoryConfig.getLocation(),".index").exists());
  assertEquals(1,response.getTotalHits());
  Set<ArtifactInfo> results=response.getResults();
  ArtifactInfo artifactInfo=results.iterator().next();
  assertEquals("org.apache.archiva",artifactInfo.groupId);
  assertEquals("archiva-index-methods-jar-test",artifactInfo.artifactId);
  assertEquals("test-repo",artifactInfo.repository);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-5 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPackagedIndex() throws Exception {
  File indexerDirectory=new File(repositoryConfig.getLocation(),".indexer");
  indexerDirectory.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File file,    String s){
      if (s.startsWith("nexus-maven-repository-index")) {
        new File(file,s).delete();
      }
      return false;
    }
  }
);
  File artifactFile=new File(repositoryConfig.getLocation(),"org/apache/archiva/archiva-index-methods-jar-test/1.0/archiva-index-methods-jar-test-1.0.jar");
  ArtifactIndexingTask task=new ArtifactIndexingTask(repositoryConfig,artifactFile,ArtifactIndexingTask.Action.ADD,getIndexingContext());
  task.setExecuteOnEntireRepo(false);
  indexingExecutor.executeTask(task);
  task=new ArtifactIndexingTask(repositoryConfig,null,ArtifactIndexingTask.Action.FINISH,getIndexingContext());
  task.setExecuteOnEntireRepo(false);
  indexingExecutor.executeTask(task);
  assertTrue(indexerDirectory.exists());
  assertTrue(new File(indexerDirectory,"nexus-maven-repository-index.zip").exists());
  assertTrue(new File(indexerDirectory,"nexus-maven-repository-index.properties").exists());
  assertTrue(new File(indexerDirectory,"nexus-maven-repository-index.gz").exists());
  File destDir=new File(repositoryConfig.getLocation(),".indexer/tmp");
  unzipIndex(indexerDirectory.getPath(),destDir.getPath());
  BooleanQuery q=new BooleanQuery();
  q.add(indexer.constructQuery(MAVEN.GROUP_ID,new StringSearchExpression("org.apache.archiva")),Occur.SHOULD);
  q.add(indexer.constructQuery(MAVEN.ARTIFACT_ID,new StringSearchExpression("archiva-index-methods-jar-test")),Occur.SHOULD);
  FlatSearchRequest request=new FlatSearchRequest(q,getIndexingContext());
  FlatSearchResponse response=indexer.searchFlat(request);
  Set<ArtifactInfo> results=response.getResults();
  ArtifactInfo artifactInfo=results.iterator().next();
  assertEquals("org.apache.archiva",artifactInfo.groupId);
  assertEquals("archiva-index-methods-jar-test",artifactInfo.artifactId);
  assertEquals("test-repo",artifactInfo.repository);
  assertEquals(1,response.getTotalHits());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.transaction.CopyFileEventTest </h4><pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCreateRollbackCommit() throws Exception {
  CopyFileEvent event=new CopyFileEvent(testSource,testDest,digesters);
  assertFalse("Test that the destination is not yet created",testDest.exists());
  event.rollback();
  assertFalse("Test that the destination file is not yet created",testDest.exists());
  event.commit();
  assertTrue("Test that the destination is created",testDest.exists());
  assertChecksumCommit(testDest);
  String target=readFile(testDest);
  assertTrue("Test that the destination contents are copied correctly",source.equals(target));
}

</code></pre>

<br>
<pre class="type-9 type-1 type-3 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Override @Before public void setUp() throws Exception {
  super.setUp();
  testSource.getParentFile().mkdirs();
  testSource.createNewFile();
  writeFile(testSource,"source contents");
  testDestChecksum=new File(testDest.getPath() + ".sha1");
  testDestChecksum.getParentFile().mkdirs();
  testDestChecksum.createNewFile();
  writeFile(testDestChecksum,"this is the checksum");
  assertTrue("Test if the source exists",testSource.exists());
  assertTrue("Test if the destination checksum exists",testDestChecksum.exists());
  source=readFile(testSource);
  oldChecksum=readFile(testDestChecksum);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCopyCommitRollbackWithBackup() throws Exception {
  testDest.getParentFile().mkdirs();
  testDest.createNewFile();
  writeFile(testDest,"overwritten contents");
  assertTrue("Test that the destination exists",testDest.exists());
  CopyFileEvent event=new CopyFileEvent(testSource,testDest,digesters);
  String target=readFile(testDest);
  assertTrue("Test that the destination contents have not changed",target.equals("overwritten contents"));
  event.commit();
  target=readFile(testDest);
  assertTrue("Test that the destination contents are copied correctly",source.equals(target));
  assertChecksumCommit(testDest);
  event.rollback();
  target=readFile(testDest);
  assertTrue("Test the destination file contents have been restored",target.equals("overwritten contents"));
  assertChecksumRollback(testDest);
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCopyCommitRollback() throws Exception {
  CopyFileEvent event=new CopyFileEvent(testSource,testDest,digesters);
  assertFalse("Test that the destination is not yet created",testDest.exists());
  event.commit();
  assertTrue("Test that the destination is created",testDest.exists());
  assertChecksumCommit(testDest);
  String target=readFile(testDest);
  assertTrue("Test that the destination contents are copied correctly",source.equals(target));
  event.rollback();
  assertFalse("Test that the destination file has been deleted",testDest.exists());
  assertChecksumRollback(testDest);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.transaction.CreateFileEventTest </h4><pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateCommitRollbackWithBackup() throws Exception {
  File testFile=new File(testDir,"test-file.txt");
  testFile.getParentFile().mkdirs();
  testFile.createNewFile();
  writeFile(testFile,"original contents");
  CreateFileEvent event=new CreateFileEvent("modified contents",testFile,digesters);
  String contents=readFile(testFile);
  assertEquals("Test contents have not changed","original contents",contents);
  event.commit();
  contents=readFile(testFile);
  assertEquals("Test contents have not changed","modified contents",contents);
  assertChecksumCommit(testFile);
  event.rollback();
  contents=readFile(testFile);
  assertEquals("Test contents have not changed","original contents",contents);
  assertChecksumRollback(testFile);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.ArchivaDavResourceLocatorTest </h4><pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocatorWithHrefThatContainsPrefix() throws Exception {
  String prefix="http://myproxy/";
  String href="http://myproxy/repository/internal";
  ArchivaDavResourceLocator locator=getLocator(prefix,href);
  assertEquals("internal",locator.getRepositoryId());
  assertEquals("",locator.getWorkspaceName());
  assertEquals("",locator.getWorkspacePath());
  assertEquals("http://myproxy/",locator.getPrefix());
  assertEquals("http://myproxy/repository/internal",locator.getHref(false));
  assertEquals("http://myproxy/repository/internal/",locator.getHref(true));
  assertEquals("/repository/internal",locator.getResourcePath());
  assertEquals("/repository/internal",locator.getRepositoryPath());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAvoidDoubleSlashInHref() throws Exception {
  String prefix="http://myproxy/";
  String href="/repository/internal/";
  ArchivaDavResourceLocator locator=getLocator(prefix,href);
  assertEquals("internal",locator.getRepositoryId());
  assertEquals("",locator.getWorkspaceName());
  assertEquals("",locator.getWorkspacePath());
  assertEquals("http://myproxy/",locator.getPrefix());
  assertEquals("http://myproxy/repository/internal/",locator.getHref(false));
  assertEquals("http://myproxy/repository/internal/",locator.getHref(true));
  assertEquals("/repository/internal",locator.getResourcePath());
  assertEquals("/repository/internal",locator.getRepositoryPath());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocatorWithPrefixHref() throws Exception {
  String prefix="http://myproxy/";
  String href="/repository/internal";
  ArchivaDavResourceLocator locator=getLocator(prefix,href);
  assertEquals("internal",locator.getRepositoryId());
  assertEquals("",locator.getWorkspaceName());
  assertEquals("",locator.getWorkspacePath());
  assertEquals("http://myproxy/",locator.getPrefix());
  assertEquals("http://myproxy/repository/internal",locator.getHref(false));
  assertEquals("http://myproxy/repository/internal/",locator.getHref(true));
  assertEquals("/repository/internal",locator.getResourcePath());
  assertEquals("/repository/internal",locator.getRepositoryPath());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocatorWithRootHref() throws Exception {
  String prefix="http://myproxy/";
  String href="/";
  ArchivaDavResourceLocator locator=getLocator(prefix,href);
  assertEquals("",locator.getRepositoryId());
  assertEquals("",locator.getWorkspaceName());
  assertEquals("",locator.getWorkspacePath());
  assertEquals("http://myproxy/",locator.getPrefix());
  assertEquals("http://myproxy/",locator.getHref(false));
  assertEquals("http://myproxy/",locator.getHref(true));
  assertEquals("/",locator.getResourcePath());
  assertEquals("/",locator.getRepositoryPath());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.RepositoryServletBrowseTest </h4><pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBrowse() throws Exception {
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/");
  WebResponse response=getServletUnitClient().getResponse(request);
  assertEquals("Response",HttpServletResponse.SC_OK,response.getStatusCode());
  List<String> expectedLinks=Arrays.asList(".indexer/","commons-lang/","net/","org/");
  Document document=Jsoup.parse(response.getContentAsString());
  Elements elements=document.getElementsByTag("a");
  assertLinks(expectedLinks,elements);
}

</code></pre>

<br>
<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDirectoryWhichHasMatchingFile() throws Exception {
  new File(repoRootInternal,"org/apache/archiva/artifactId/1.0").mkdirs();
  new File(repoRootInternal,"org/apache/archiva/artifactId/1.0/artifactId-1.0.jar").createNewFile();
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/org/apache/archiva/artifactId");
  WebResponse response=getServletUnitClient().getResponse(request,true);
  assertEquals("1st Response",HttpServletResponse.SC_OK,response.getStatusCode());
  request=new GetMethodWebRequest("http://machine.com/repository/internal/org/apache/archiva/artifactId/");
  response=getServletUnitClient().getResponse(request);
  assertEquals("2nd Response",HttpServletResponse.SC_OK,response.getStatusCode());
  request=new GetMethodWebRequest("http://machine.com/repository/internal/org/apache/archiva/artifactId/1.0/artifactId-1.0.jar");
  response=getServletUnitClient().getResponse(request);
  assertEquals("3rd Response",HttpServletResponse.SC_OK,response.getStatusCode());
  request=new GetMethodWebRequest("http://machine.com/repository/internal/org/apache/archiva/artifactId/1.0/artifactId-1.0.jar/");
  response=getServletUnitClient().getResponse(request);
  assertEquals("4th Response",HttpServletResponse.SC_NOT_FOUND,response.getStatusCode());
}

</code></pre>

<br>
<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBrowseSubdirectory() throws Exception {
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/org");
  WebResponse response=getServletUnitClient().getResponse(request);
  assertEquals("Response",HttpServletResponse.SC_OK,response.getStatusCode());
  List<String> expectedLinks=Arrays.asList("../","apache/","codehaus/");
  Document document=Jsoup.parse(response.getContentAsString());
  Elements elements=document.getElementsByTag("a");
  assertLinks(expectedLinks,elements);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.RepositoryServletDeployTest </h4><pre class="type-9 type-3 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMkColWithMissingParentCollectionFails() throws Exception {
  setupCleanRepo(repoRootInternal);
  String putUrl="http://machine.com/repository/internal/path/to/";
  WebRequest request=new MkColMethodWebRequest(putUrl);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertEquals(HttpServletResponse.SC_CONFLICT,response.getStatusCode());
  File mkColLocalPath=new File(repoRootInternal,"path/to/");
  assertFalse(mkColLocalPath.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.RepositoryServletNoProxyMetadataTest </h4><pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetProjectMetadataDefaultLayout() throws Exception {
  String commonsLangMetadata="commons-lang/commons-lang/maven-metadata.xml";
  String expectedMetadataContents="metadata-for-commons-lang-version-for-project";
  File checksumFile=new File(repoRootInternal,commonsLangMetadata);
  checksumFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFile,expectedMetadataContents,Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/" + commonsLangMetadata);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertEquals("Expected file contents",expectedMetadataContents,response.getContentAsString());
}

</code></pre>

<br>
<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetSnapshotVersionMetadataDefaultLayout() throws Exception {
  String assemblyPluginMetadata="org/apache/maven/plugins/maven-assembly-plugin/2.2-beta-2-SNAPSHOT/maven-metadata.xml";
  String expectedMetadataContents="metadata-for-assembly-plugin-version-2.2-beta-2-SNAPSHOT";
  File checksumFile=new File(repoRootInternal,assemblyPluginMetadata);
  checksumFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFile,expectedMetadataContents,Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/" + assemblyPluginMetadata);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertEquals("Expected file contents",expectedMetadataContents,response.getContentAsString());
}

</code></pre>

<br>
<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetVersionMetadataDefaultLayout() throws Exception {
  String commonsLangMetadata="commons-lang/commons-lang/2.1/maven-metadata.xml";
  String expectedMetadataContents="metadata-for-commons-lang-version-2.1";
  File checksumFile=new File(repoRootInternal,commonsLangMetadata);
  checksumFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFile,expectedMetadataContents,Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/" + commonsLangMetadata);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertEquals("Expected file contents",expectedMetadataContents,response.getContentAsString());
}

</code></pre>

<br>
<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetGroupMetadataDefaultLayout() throws Exception {
  String commonsLangMetadata="commons-lang/maven-metadata.xml";
  String expectedMetadataContents="metadata-for-commons-lang-group";
  File checksumFile=new File(repoRootInternal,commonsLangMetadata);
  checksumFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFile,expectedMetadataContents,Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/" + commonsLangMetadata);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertEquals("Expected file contents",expectedMetadataContents,response.getContentAsString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.RepositoryServletNoProxyTest </h4><pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * [MRM-481] Artifact requests with a .xml.zip extension fail with a 404 Error
 */
@Test public void testGetNoProxyDualExtensionDefaultLayout() throws Exception {
  String expectedContents="the-contents-of-the-dual-extension";
  String dualExtensionPath="org/project/example-presentation/3.2/example-presentation-3.2.xml.zip";
  File checksumFile=new File(repoRootInternal,dualExtensionPath);
  checksumFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFile,expectedContents,Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/internal/" + dualExtensionPath);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertEquals("Expected file contents",expectedContents,response.getContentAsString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.RepositoryServletRepositoryGroupTest </h4><pre class="type-9 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testBrowseWithTwoArtifactsWithSameGroupIdInRepos() throws Exception {
  String resourceName="dummy/dummy-artifact/1.0/dummy-artifact-1.0.txt";
  File dummyInternalResourceFile=new File(repoRootFirst,resourceName);
  dummyInternalResourceFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(dummyInternalResourceFile,"first",Charset.defaultCharset());
  resourceName="dummy/dummy-artifact/2.0/dummy-artifact-2.0.txt";
  File dummyReleasesResourceFile=new File(repoRootLast,resourceName);
  dummyReleasesResourceFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(dummyReleasesResourceFile,"last",Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/" + REPO_GROUP_WITH_VALID_REPOS + "/dummy/dummy-artifact/");
  WebResponse response=getServletUnitClient().getResource(request);
  assertResponseOK(response);
  assertThat(response.getContentAsString()).contains("Collection").contains("dummy/dummy-artifact").contains("1.0").contains("2.0");
}

</code></pre>

<br>
<pre class="type-9 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetFromLastManagedRepositoryReturnOk() throws Exception {
  String resourceName="dummy/dummy-last-resource/1.0/dummy-last-resource-1.0.txt";
  File dummyReleasesResourceFile=new File(repoRootLast,resourceName);
  dummyReleasesResourceFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(dummyReleasesResourceFile,"last",Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/" + REPO_GROUP_WITH_VALID_REPOS + "/"+ resourceName);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertThat(response.getContentAsString()).isEqualTo("last");
}

</code></pre>

<br>
<pre class="type-9 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetFromFirstManagedRepositoryReturnOk() throws Exception {
  String resourceName="dummy/dummy-first-resource/1.0/dummy-first-resource-1.0.txt";
  File dummyInternalResourceFile=new File(repoRootFirst,resourceName);
  dummyInternalResourceFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(dummyInternalResourceFile,"first",Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/" + REPO_GROUP_WITH_VALID_REPOS + "/"+ resourceName);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertThat(response.getContentAsString()).isEqualTo("first");
}

</code></pre>

<br>
<pre class="type-9 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetMergedMetadata() throws Exception {
  String resourceName="dummy/dummy-merged-metadata-resource/maven-metadata.xml";
  File dummyInternalResourceFile=new File(repoRootFirst,resourceName);
  dummyInternalResourceFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(dummyInternalResourceFile,"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<metadata>\n<groupId>dummy</groupId>\n<artifactId>dummy-merged-metadata-resource</artifactId>\n" + "<versioning>\n<latest>1.0</latest>\n<release>1.0</release>\n<versions>\n<version>1.0</version>\n"+ "<version>2.5</version>\n</versions>\n<lastUpdated>20080708095554</lastUpdated>\n</versioning>\n</metadata>",Charset.defaultCharset());
  resourceName="dummy/dummy-merged-metadata-resource/maven-metadata.xml";
  dummyInternalResourceFile=new File(repoRootLast,resourceName);
  dummyInternalResourceFile.getParentFile().mkdirs();
  FileUtils.writeStringToFile(dummyInternalResourceFile,"<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<metadata><groupId>dummy</groupId><artifactId>dummy-merged-metadata-resource</artifactId>" + "<versioning><latest>2.0</latest><release>2.0</release><versions><version>1.0</version>"+ "<version>1.5</version><version>2.0</version></versions><lastUpdated>20080709095554</lastUpdated>"+ "</versioning></metadata>",Charset.defaultCharset());
  WebRequest request=new GetMethodWebRequest("http://machine.com/repository/" + REPO_GROUP_WITH_VALID_REPOS + "/dummy/"+ "dummy-merged-metadata-resource/maven-metadata.xml");
  WebResponse response=getServletUnitClient().getResource(request);
  File returnedMetadata=new File("target/test-classes/retrievedMetadataFile.xml");
  FileUtils.writeStringToFile(returnedMetadata,response.getContentAsString());
  ArchivaRepositoryMetadata metadata=MavenMetadataReader.read(returnedMetadata);
  assertResponseOK(response);
  assertThat(metadata.getAvailableVersions()).isNotNull().hasSize(4).contains("1.0","1.5","2.0","2.5");
  File checksumFileSha1=new File(repoRootFirst,resourceName + ".sha1");
  checksumFileSha1.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFileSha1,"3290853214d3687134",Charset.defaultCharset());
  File checksumFileMd5=new File(repoRootFirst,resourceName + ".md5");
  checksumFileMd5.getParentFile().mkdirs();
  FileUtils.writeStringToFile(checksumFileMd5,"98745897234eda12836423",Charset.defaultCharset());
  request=new GetMethodWebRequest("http://machine.com/repository/" + REPO_GROUP_WITH_VALID_REPOS + "/dummy/"+ "dummy-merged-metadata-resource/maven-metadata.xml.sha1");
  response=getServletUnitClient().getResource(request);
  assertResponseOK(response);
  assertThat(response.getContentAsString()).isEqualTo("add113b0d7f8c6adb92a5015a7a3701081edf998  maven-metadata-group-with-valid-repos.xml");
  request=new GetMethodWebRequest("http://machine.com/repository/" + REPO_GROUP_WITH_VALID_REPOS + "/dummy/"+ "dummy-merged-metadata-resource/maven-metadata.xml.md5");
  response=getServletUnitClient().getResource(request);
  assertResponseOK(response);
  assertThat(response.getContentAsString()).isEqualTo("5b85ea4aa5f52bb76760041a52f98de8  maven-metadata-group-with-valid-repos.xml");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.archiva.webdav.RepositoryServletTest </h4><pre class="type-9 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testGetRepositoryInvalidPathPassthroughMissing() throws Exception {
  String path=REQUEST_PATH + ".index/filecontent/foo.bar";
  WebRequest request=new GetMethodWebRequest(path);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseNotFound(response);
  assertThat(response.getContentAsString()).contains("Legacy Maven1 repository not supported anymore.");
}

</code></pre>

<br>
<pre class="type-9 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetRepositoryInvalidPathPassthroughPresent() throws Exception {
  String path=REQUEST_PATH + ".index/filecontent/segments.gen";
  populateRepo(repoRootInternal,".index/filecontent/segments.gen","index file");
  WebRequest request=new GetMethodWebRequest(path);
  WebResponse response=getServletUnitClient().getResponse(request);
  assertResponseOK(response);
  assertEquals("index file",response.getContentAsString());
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
