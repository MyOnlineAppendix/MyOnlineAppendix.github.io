<h3 style="margin:0px">Class: org.apache.hc.client5.http.impl.auth.TestDigestScheme (23 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(20)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(18)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(14)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(2)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthenticationWithQueryStringInDigestURI() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Simple","/?param=value");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/?param=value",table.get("uri"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
  Assert.assertEquals("a847f58f5fef0bc087bcb9c3eb30e042",table.get("response"));
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDigestAuthenticationInvalidInput() throws Exception {
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  try {
    authscheme.isResponseReady(null,credentialsProvider,null);
    Assert.fail("IllegalArgumentException should have been thrown");
  }
 catch (  final IllegalArgumentException ex) {
  }
  try {
    authscheme.isResponseReady(host,null,null);
    Assert.fail("IllegalArgumentException should have been thrown");
  }
 catch (  final IllegalArgumentException ex) {
  }
  try {
    authscheme.generateAuthResponse(host,null,null);
    Assert.fail("IllegalArgumentException should have been thrown");
  }
 catch (  final IllegalArgumentException ex) {
  }
}

</code></pre>

<pre class="type-2 type-4 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AuthenticationException.class) public void testDigestAuthenticationNoRealm() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest no-realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  authscheme.generateAuthResponse(host,request,null);
}

</code></pre>

<pre class="type-2 type-4 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test digest authentication with unknown qop value
 */
@Test(expected=AuthenticationException.class) public void testDigestAuthenticationMD5SessUnknownQop() throws Exception {
  final String realm="realm";
  final String username="username";
  final String password="password";
  final String nonce="e273f1776275974f1a120d8b92c5b3cb";
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,realm,null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials(username,password.toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"" + realm + "\", "+ "nonce=\""+ nonce+ "\", "+ "opaque=\"SomeString\", "+ "stale=false, "+ "algorithm=MD5-sess, "+ "qop=\"stuff\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  authscheme.generateAuthResponse(host,request,null);
}

</code></pre>

<pre class="type-2 type-4 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AuthenticationException.class) public void testDigestAuthenticationQopIntOnlyNonRepeatableEntity() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Post","/");
  request.setEntity(new InputStreamEntity(new ByteArrayInputStream(new byte[]{'a'}),-1));
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", " + "qop=\"auth-int\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  authscheme.generateAuthResponse(host,request,null);
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthenticationWithSHA() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", " + "nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", " + "algorithm=SHA";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
  Assert.assertEquals("8769e82e4e28ecc040b969562b9050580c6d186d",table.get("response"));
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthenticationWithDefaultCreds() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  Assert.assertTrue(authscheme.isChallengeComplete());
  Assert.assertFalse(authscheme.isConnectionBased());
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
  Assert.assertEquals("e95a7ddf37c2eab009568b1ed134f89a",table.get("response"));
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test digest authentication using the MD5-sess algorithm.
 */
@Test public void testDigestAuthenticationMD5Sess() throws Exception {
  final String realm="realm";
  final String username="username";
  final String password="password";
  final String nonce="e273f1776275974f1a120d8b92c5b3cb";
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,realm,null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials(username,password.toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"" + realm + "\", "+ "nonce=\""+ nonce+ "\", "+ "opaque=\"SomeString\", "+ "stale=false, "+ "algorithm=MD5-sess, "+ "qop=\"auth,auth-int\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  Assert.assertTrue(authResponse.indexOf("nc=00000001") > 0);
  Assert.assertTrue(authResponse.indexOf("qop=auth") > 0);
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals(username,table.get("username"));
  Assert.assertEquals(realm,table.get("realm"));
  Assert.assertEquals("MD5-sess",table.get("algorithm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals(nonce,table.get("nonce"));
  Assert.assertEquals(1,Integer.parseInt(table.get("nc"),16));
  Assert.assertTrue(null != table.get("cnonce"));
  Assert.assertEquals("SomeString",table.get("opaque"));
  Assert.assertEquals("auth",table.get("qop"));
  Assert.assertTrue(null != table.get("response"));
}

</code></pre>

<pre class="type-13 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MalformedChallengeException.class) public void testDigestAuthenticationEmptyChallenge1() throws Exception {
  final AuthChallenge authChallenge=parse("Digest");
  final AuthScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthenticationQopAuthInt() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Post","/");
  request.setEntity(new StringEntity("abc\u00e4\u00f6\u00fcabc",StandardCharsets.ISO_8859_1));
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", " + "qop=\"auth,auth-int\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  Assert.assertEquals("Post:/:acd2b59cd01c7737d8069015584c6cac",authscheme.getA2());
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals("auth-int",table.get("qop"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthenticationQopAuthOrAuthIntNonRepeatableEntity() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Post","/");
  request.setEntity(new InputStreamEntity(new ByteArrayInputStream(new byte[]{'a'}),-1));
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", " + "qop=\"auth,auth-int\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  Assert.assertEquals("Post:/",authscheme.getA2());
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals("auth",table.get("qop"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDigestAuthenticationWithStaleNonce() throws Exception {
  final String challenge="Digest realm=\"realm1\", " + "nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", stale=\"true\"";
  final AuthChallenge authChallenge=parse(challenge);
  final AuthScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertFalse(authscheme.isChallengeComplete());
}

</code></pre>

<pre class="type-13 type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=MalformedChallengeException.class) public void testDigestAuthenticationEmptyChallenge2() throws Exception {
  final AuthChallenge authChallenge=parse("Digest ");
  final AuthScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
}

</code></pre>

<pre class="type-2 type-4 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AuthenticationException.class) public void testDigestAuthenticationNoNonce() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", no-nonce=\"f2a3f18799759d4f1a1c068b92b573cb\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  authscheme.generateAuthResponse(host,request,null);
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthenticationQopAuthIntNullEntity() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Post","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", " + "qop=\"auth-int\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  Assert.assertEquals("Post:/:d41d8cd98f00b204e9800998ecf8427e",authscheme.getA2());
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals("auth-int",table.get("qop"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestAuthentication() throws Exception {
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals("username",table.get("username"));
  Assert.assertEquals("realm1",table.get("realm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals("f2a3f18799759d4f1a1c068b92b573cb",table.get("nonce"));
  Assert.assertEquals("e95a7ddf37c2eab009568b1ed134f89a",table.get("response"));
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization() throws Exception {
  final String challenge="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", " + "qop=\"auth,auth-int\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme digestScheme=new DigestScheme();
  digestScheme.processChallenge(authChallenge,null);
  final ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  final ObjectOutputStream out=new ObjectOutputStream(buffer);
  out.writeObject(digestScheme);
  out.flush();
  final byte[] raw=buffer.toByteArray();
  final ObjectInputStream in=new ObjectInputStream(new ByteArrayInputStream(raw));
  final DigestScheme authScheme=(DigestScheme)in.readObject();
  Assert.assertEquals(digestScheme.getName(),authScheme.getName());
  Assert.assertEquals(digestScheme.getRealm(),authScheme.getRealm());
  Assert.assertEquals(digestScheme.isChallengeComplete(),authScheme.isChallengeComplete());
  Assert.assertEquals(digestScheme.getA1(),authScheme.getA1());
  Assert.assertEquals(digestScheme.getA2(),authScheme.getA2());
  Assert.assertEquals(digestScheme.getCnonce(),authScheme.getCnonce());
}

</code></pre>

<pre class="type-2 type-4 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test digest authentication with unknown qop value
 */
@Test(expected=AuthenticationException.class) public void testDigestAuthenticationUnknownAlgo() throws Exception {
  final String realm="realm";
  final String username="username";
  final String password="password";
  final String nonce="e273f1776275974f1a120d8b92c5b3cb";
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,realm,null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials(username,password.toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"" + realm + "\", "+ "nonce=\""+ nonce+ "\", "+ "opaque=\"SomeString\", "+ "stale=false, "+ "algorithm=stuff, "+ "qop=\"auth\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  authscheme.generateAuthResponse(host,request,null);
}

</code></pre>

<pre class="type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParameterCaseSensitivity() throws Exception {
  final HttpRequest request=new BasicHttpRequest("GET","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"-",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest Realm=\"-\", " + "nonce=\"YjYuNGYyYmJhMzUuY2I5ZDhlZDE5M2ZlZDM 1Mjk3NGJkNTIyYjgyNTcwMjQ=\", " + "opaque=\"98700A3D9CE17065E2246B41035C6609\", qop=\"auth\"";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertEquals("-",authscheme.getRealm());
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  authscheme.generateAuthResponse(host,request,null);
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestMD5SessA1AndCnonceConsistency() throws Exception {
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"subnet.domain.com",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final HttpRequest request=new BasicHttpRequest("GET","/");
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge1="Digest qop=\"auth\", algorithm=MD5-sess, nonce=\"1234567890abcdef\", " + "charset=utf-8, realm=\"subnet.domain.com\"";
  final AuthChallenge authChallenge1=parse(challenge1);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge1,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse1=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table1=parseAuthResponse(authResponse1);
  Assert.assertEquals("00000001",table1.get("nc"));
  final String cnonce1=authscheme.getCnonce();
  final String sessionKey1=authscheme.getA1();
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse2=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table2=parseAuthResponse(authResponse2);
  Assert.assertEquals("00000002",table2.get("nc"));
  final String cnonce2=authscheme.getCnonce();
  final String sessionKey2=authscheme.getA1();
  Assert.assertEquals(cnonce1,cnonce2);
  Assert.assertEquals(sessionKey1,sessionKey2);
  final String challenge2="Digest qop=\"auth\", algorithm=MD5-sess, nonce=\"1234567890abcdef\", " + "charset=utf-8, realm=\"subnet.domain.com\"";
  final AuthChallenge authChallenge2=parse(challenge2);
  authscheme.processChallenge(authChallenge2,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse3=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table3=parseAuthResponse(authResponse3);
  Assert.assertEquals("00000003",table3.get("nc"));
  final String cnonce3=authscheme.getCnonce();
  final String sessionKey3=authscheme.getA1();
  Assert.assertEquals(cnonce1,cnonce3);
  Assert.assertEquals(sessionKey1,sessionKey3);
  final String challenge3="Digest qop=\"auth\", algorithm=MD5-sess, nonce=\"fedcba0987654321\", " + "charset=utf-8, realm=\"subnet.domain.com\"";
  final AuthChallenge authChallenge3=parse(challenge3);
  authscheme.processChallenge(authChallenge3,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse4=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table4=parseAuthResponse(authResponse4);
  Assert.assertEquals("00000001",table4.get("nc"));
  final String cnonce4=authscheme.getCnonce();
  final String sessionKey4=authscheme.getA1();
  Assert.assertFalse(cnonce1.equals(cnonce4));
  Assert.assertFalse(sessionKey1.equals(sessionKey4));
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDigestNouceCount() throws Exception {
  final HttpRequest request=new BasicHttpRequest("GET","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,"realm1",null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials("username","password".toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge1="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", qop=auth";
  final AuthChallenge authChallenge1=parse(challenge1);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge1,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse1=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table1=parseAuthResponse(authResponse1);
  Assert.assertEquals("00000001",table1.get("nc"));
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse2=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table2=parseAuthResponse(authResponse2);
  Assert.assertEquals("00000002",table2.get("nc"));
  final String challenge2="Digest realm=\"realm1\", nonce=\"f2a3f18799759d4f1a1c068b92b573cb\", qop=auth";
  final AuthChallenge authChallenge2=parse(challenge2);
  authscheme.processChallenge(authChallenge2,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse3=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table3=parseAuthResponse(authResponse3);
  Assert.assertEquals("00000003",table3.get("nc"));
  final String challenge3="Digest realm=\"realm1\", nonce=\"e273f1776275974f1a120d8b92c5b3cb\", qop=auth";
  final AuthChallenge authChallenge3=parse(challenge3);
  authscheme.processChallenge(authChallenge3,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse4=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table4=parseAuthResponse(authResponse4);
  Assert.assertEquals("00000001",table4.get("nc"));
}

</code></pre>

<pre class="type-8 type-4 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHttpEntityDigest() throws Exception {
  final HttpEntityDigester digester=new HttpEntityDigester(MessageDigest.getInstance("MD5"));
  Assert.assertNull(digester.getDigest());
  digester.write('a');
  digester.write('b');
  digester.write('c');
  digester.write(0xe4);
  digester.write(0xf6);
  digester.write(0xfc);
  digester.write(new byte[]{'a','b','c'});
  Assert.assertNull(digester.getDigest());
  digester.close();
  Assert.assertEquals("acd2b59cd01c7737d8069015584c6cac",DigestScheme.formatHex(digester.getDigest()));
  try {
    digester.write('a');
    Assert.fail("IOException should have been thrown");
  }
 catch (  final IOException ex) {
  }
  try {
    digester.write(new byte[]{'a','b','c'});
    Assert.fail("IOException should have been thrown");
  }
 catch (  final IOException ex) {
  }
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test digest authentication using the MD5-sess algorithm.
 */
@Test public void testDigestAuthenticationMD5SessNoQop() throws Exception {
  final String realm="realm";
  final String username="username";
  final String password="password";
  final String nonce="e273f1776275974f1a120d8b92c5b3cb";
  final HttpRequest request=new BasicHttpRequest("Simple","/");
  final HttpHost host=new HttpHost("somehost",80);
  final AuthScope authScope=new AuthScope(host,realm,null);
  final BasicCredentialsProvider credentialsProvider=new BasicCredentialsProvider();
  final Credentials creds=new UsernamePasswordCredentials(username,password.toCharArray());
  credentialsProvider.setCredentials(authScope,creds);
  final String challenge="Digest realm=\"" + realm + "\", "+ "nonce=\""+ nonce+ "\", "+ "opaque=\"SomeString\", "+ "stale=false, "+ "algorithm=MD5-sess";
  final AuthChallenge authChallenge=parse(challenge);
  final DigestScheme authscheme=new DigestScheme();
  authscheme.processChallenge(authChallenge,null);
  Assert.assertTrue(authscheme.isResponseReady(host,credentialsProvider,null));
  final String authResponse=authscheme.generateAuthResponse(host,request,null);
  final Map<String,String> table=parseAuthResponse(authResponse);
  Assert.assertEquals(username,table.get("username"));
  Assert.assertEquals(realm,table.get("realm"));
  Assert.assertEquals("MD5-sess",table.get("algorithm"));
  Assert.assertEquals("/",table.get("uri"));
  Assert.assertEquals(nonce,table.get("nonce"));
  Assert.assertTrue(null == table.get("nc"));
  Assert.assertEquals("SomeString",table.get("opaque"));
  Assert.assertTrue(null == table.get("qop"));
  Assert.assertTrue(null != table.get("response"));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
