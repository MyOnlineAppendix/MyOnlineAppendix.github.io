<h3 style="margin:0px">Class: org.apache.hc.client5.http.impl.cache.TestProtocolRecommendations (88 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(63)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(17)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyRetryAfterOnResponses() throws Exception {
  originResponse.setStatusCode(HttpStatus.SC_SERVICE_UNAVAILABLE);
  originResponse.setReasonPhrase("Service Unavailable");
  originResponse.setHeader("Retry-After","120");
  testDoesNotModifyHeaderOnResponses("Retry-After");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void variantNegotiationsDoNotIncludeEtagsForPartialResponses() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req1.setHeader("User-Agent","agent1");
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("Vary","User-Agent");
  resp1.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("User-Agent","agent2");
  req2.setHeader("Range","bytes=0-49");
  final HttpResponse resp2=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_PARTIAL_CONTENT,"Partial Content");
  resp2.setEntity(HttpTestUtils.makeBody(50));
  resp2.setHeader("Content-Length","50");
  resp2.setHeader("Content-Range","bytes 0-49/100");
  resp2.setHeader("Vary","User-Agent");
  resp2.setHeader("ETag","\"etag2\"");
  resp2.setHeader("Cache-Control","max-age=3600");
  resp2.setHeader("Date",DateUtils.formatDate(new Date()));
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req3.setHeader("User-Agent","agent3");
  final HttpResponse resp3=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("Vary","User-Agent");
  resp1.setHeader("ETag","\"etag3\"");
  final Capture<HttpRequestWrapper> cap=new Capture<>();
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),EasyMock.capture(cap),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(resp3));
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  impl.execute(route,req3,context,null);
  verifyMocks();
  final HttpRequest captured=cap.getValue();
  for (  final Header h : captured.getHeaders("If-None-Match")) {
    for (    final HeaderElement elt : h.getElements()) {
      assertFalse("\"etag2\"".equals(elt.toString()));
    }
  }
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongEtagValidatorShouldNotContainContentType() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Content-Type","text/html");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyVaryOnResponses() throws Exception {
  request.setHeader("Accept-Encoding","identity");
  originResponse.setHeader("Vary","Accept-Encoding");
  testDoesNotModifyHeaderOnResponses("Vary");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongValidatorShouldNotContainContentLength() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Content-Length","128");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyLastModifiedOnResponses() throws Exception {
  originResponse.setHeader("Last-Modified",DateUtils.formatDate(new Date()));
  testDoesNotModifyHeaderOnResponses("Last-Modified");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentMD5OnRequests() throws Exception {
  final HttpRequest post=new BasicHttpRequest("POST","/",HttpVersion.HTTP_1_1);
  post.setEntity(HttpTestUtils.makeBody(128));
  post.setHeader("Content-Length","128");
  post.setHeader("Content-MD5","Q2hlY2sgSW50ZWdyaXR5IQ==");
  request=HttpRequestWrapper.wrap(post,host);
  testDoesNotModifyHeaderOnRequests("Content-MD5");
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void cacheShouldUpdateWithNewCacheableResponse() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("Cache-Control","max-age=0");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("Date",DateUtils.formatDate(now));
  resp2.setHeader("Cache-Control","max-age=3600");
  resp2.setHeader("ETag","\"etag2\"");
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  final HttpResponse result=impl.execute(route,req3,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp2,result));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyAuthorizationOnRequests() throws Exception {
  request.setHeader("Authorization","Basic dXNlcjpwYXNzd2Q=");
  testDoesNotModifyHeaderOnRequests("Authorization");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentRangeOnRequests() throws Exception {
  final HttpRequest put=new BasicHttpRequest("PUT","/",HttpVersion.HTTP_1_1);
  put.setEntity(HttpTestUtils.makeBody(128));
  put.setHeader("Content-Length","128");
  put.setHeader("Content-Range","bytes 0-127/256");
  request=HttpRequestWrapper.wrap(put,host);
  testDoesNotModifyHeaderOnRequests("Content-Range");
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void expiresPriorToDateWithNoCacheControlIsNotCacheable() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(now));
  resp1.setHeader("Expires",DateUtils.formatDate(tenSecondsAgo));
  resp1.removeHeaders("Cache-Control");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("Cache-Control","max-stale=1000");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("ETag","\"etag2\"");
  backendExpectsAnyRequestAndReturn(resp2);
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp2,result));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyServerOnResponses() throws Exception {
  originResponse.setHeader("Server","SomeServer/1.0");
  testDoesNotModifyHeaderOnResponses("Server");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongEtagValidatorShouldNotContainContentEncoding() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Content-Encoding","gzip");
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void returnsStaleCacheEntryWithOnlyIfCachedAndMaxStale() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Cache-Control","max-age=5");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("Cache-Control","max-stale=20, only-if-cached");
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp1,result));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainLastModified() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Last-Modified",DateUtils.formatDate(twoMinutesAgo));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIdentityCodingIsNotUsedInContentEncodingHeader() throws Exception {
  originResponse.setHeader("Content-Encoding","identity");
  backendExpectsAnyRequest().andReturn(originResponse);
  replayMocks();
  final HttpResponse result=impl.execute(route,request,context,null);
  verifyMocks();
  boolean foundIdentity=false;
  for (  final Header h : result.getHeaders("Content-Encoding")) {
    for (    final HeaderElement elt : h.getElements()) {
      if ("identity".equalsIgnoreCase(elt.getName())) {
        foundIdentity=true;
      }
    }
  }
  assertFalse(foundIdentity);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainContentMD5() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Content-MD5","Q2hlY2sgSW50ZWdyaXR5IQ==");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyRangeOnRequests() throws Exception {
  request.setHeader("Range","bytes=0-128");
  testDoesNotModifyHeaderOnRequests("Range");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentLengthOnRequests() throws Exception {
  final HttpRequest post=new BasicHttpRequest("POST","/",HttpVersion.HTTP_1_1);
  post.setEntity(HttpTestUtils.makeBody(128));
  post.setHeader("Content-Length","128");
  request=HttpRequestWrapper.wrap(post,host);
  testDoesNotModifyHeaderOnRequests("Content-Length");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotReturnStaleResponseIfClientExplicitlyRequestsFreshWithMinFresh() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req.setHeader("Cache-Control","min-fresh=2");
  testDoesNotReturnStaleResponseOnError(req);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripContentLanguageFromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Content-Language","en");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void otherFreshnessRequestDirectivesNotAllowedWithNoCache() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req1.setHeader("Cache-Control","min-fresh=10, no-cache");
  req1.addHeader("Cache-Control","max-stale=0, max-age=0");
  final Capture<HttpRequestWrapper> cap=new Capture<>();
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),EasyMock.capture(cap),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(HttpTestUtils.make200Response()));
  replayMocks();
  impl.execute(route,req1,context,null);
  verifyMocks();
  final HttpRequest captured=cap.getValue();
  boolean foundNoCache=false;
  boolean foundDisallowedDirective=false;
  final List<String> disallowed=Arrays.asList("min-fresh","max-stale","max-age");
  for (  final Header h : captured.getHeaders("Cache-Control")) {
    for (    final HeaderElement elt : h.getElements()) {
      if (disallowed.contains(elt.getName())) {
        foundDisallowedDirective=true;
      }
      if ("no-cache".equals(elt.getName())) {
        foundNoCache=true;
      }
    }
  }
  assertTrue(foundNoCache);
  assertFalse(foundDisallowedDirective);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripContentLengthFromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Content-Length","128");
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUsesBothLastModifiedAndETagForConditionalRequestsIfAvailable() throws Exception {
  final Date twentySecondsAgo=new Date(now.getTime() - 20 * 1000L);
  final String lmDate=DateUtils.formatDate(twentySecondsAgo);
  final String etag="\"etag\"";
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Last-Modified",lmDate);
  resp1.setHeader("Cache-Control","max-age=5");
  resp1.setHeader("ETag",etag);
  backendExpectsAnyRequestAndReturn(resp1);
  final Capture<HttpRequestWrapper> cap=new Capture<>();
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp2=HttpTestUtils.make200Response();
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),EasyMock.capture(cap),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(resp2));
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  verifyMocks();
  final HttpRequest captured=cap.getValue();
  final Header ifModifiedSince=captured.getFirstHeader("If-Modified-Since");
  assertEquals(lmDate,ifModifiedSince.getValue());
  final Header ifNoneMatch=captured.getFirstHeader("If-None-Match");
  assertEquals(etag,ifNoneMatch.getValue());
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotReturnStaleResponseIfClientExplicitlyRequestsFirstHandOneWithCacheControl() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req.setHeader("Cache-Control","no-cache");
  testDoesNotReturnStaleResponseOnError(req);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentMD5OnResponses() throws Exception {
  originResponse.setEntity(HttpTestUtils.makeBody(128));
  originResponse.setHeader("Content-MD5","Q2hlY2sgSW50ZWdyaXR5IQ==");
  testDoesNotModifyHeaderOnResponses("Content-MD5");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotReturnStaleResponseIfClientExplicitlyRequestsFreshWithMaxStale() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req.setHeader("Cache-Control","max-stale=2");
  testDoesNotReturnStaleResponseOnError(req);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongEtagValidatorShouldNotContainContentLanguage() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Content-Language","en");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainContentLanguage() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Content-Language","en");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cachedEntryShouldNotBeUsedIfMoreRecentMentionInContentLocation() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new HttpGet("http://foo.example.com/"),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("ETag","\"old-etag\"");
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new HttpPost("http://foo.example.com/bar"),host);
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("ETag","\"new-etag\"");
  resp2.setHeader("Date",DateUtils.formatDate(now));
  resp2.setHeader("Content-Location","http://foo.example.com/");
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(new HttpGet("http://foo.example.com"),host);
  final HttpResponse resp3=HttpTestUtils.make200Response();
  backendExpectsAnyRequestAndReturn(resp3);
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  impl.execute(route,req3,context,null);
  verifyMocks();
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void cacheMissResultsIn504WithOnlyIfCached() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req.setHeader("Cache-Control","only-if-cached");
  replayMocks();
  final HttpResponse result=impl.execute(route,req,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_GATEWAY_TIMEOUT,result.getStatusLine().getStatusCode());
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyIfNoneMatchOnRequests() throws Exception {
  request.setHeader("If-None-Match","\"etag\"");
  testDoesNotModifyHeaderOnRequests("If-None-Match");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentRangeOnResponses() throws Exception {
  request.setHeader("Range","bytes=0-128");
  originResponse.setStatusCode(HttpStatus.SC_PARTIAL_CONTENT);
  originResponse.setReasonPhrase("Partial Content");
  originResponse.setEntity(HttpTestUtils.makeBody(128));
  originResponse.setHeader("Content-Range","bytes 0-127/256");
  testDoesNotModifyHeaderOnResponses("Content-Range");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentTypeOnResponses() throws Exception {
  originResponse.setHeader("Content-Type","application/octet-stream");
  testDoesNotModifyHeaderOnResponses("Content-Type");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void responseToGetWithQueryFrom1_0OriginAndNoExpiresIsNotCached() throws Exception {
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new HttpGet("http://foo.example.com/bar?baz=quux"),host);
  final HttpResponse resp2=new BasicHttpResponse(HttpVersion.HTTP_1_0,HttpStatus.SC_OK,"OK");
  resp2.setEntity(HttpTestUtils.makeBody(200));
  resp2.setHeader("Content-Length","200");
  resp2.setHeader("Date",DateUtils.formatDate(now));
  backendExpectsAnyRequestAndReturn(resp2);
  replayMocks();
  impl.execute(route,req2,context,null);
  verifyMocks();
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripContentTypeFromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Content-Type","text/html;charset=utf-8");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentLengthOnResponses() throws Exception {
  originResponse.setEntity(HttpTestUtils.makeBody(128));
  originResponse.setHeader("Content-Length","128");
  testDoesNotModifyHeaderOnResponses("Content-Length");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyUserAgentOnRequests() throws Exception {
  request.setHeader("User-Agent","MyClient/1.0");
  testDoesNotModifyHeaderOnRequests("User-Agent");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripAllowFromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Allow","GET,HEAD");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyContentTypeOnRequests() throws Exception {
  final HttpRequest post=new BasicHttpRequest("POST","/",HttpVersion.HTTP_1_1);
  post.setEntity(HttpTestUtils.makeBody(128));
  post.setHeader("Content-Length","128");
  post.setHeader("Content-Type","application/octet-stream");
  request=HttpRequestWrapper.wrap(post,host);
  testDoesNotModifyHeaderOnRequests("Content-Type");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotReturnStaleResponseIfClientExplicitlyRequestsFirstHandOneWithPragma() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req.setHeader("Pragma","no-cache");
  testDoesNotReturnStaleResponseOnError(req);
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testDoesNotAddNewWarningHeaderIfResponseArrivesStale() throws Exception {
  originResponse.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  originResponse.setHeader("Cache-Control","public, max-age=5");
  originResponse.setHeader("ETag","\"etag\"");
  backendExpectsAnyRequest().andReturn(originResponse);
  replayMocks();
  final HttpResponse result=impl.execute(route,request,context,null);
  verifyMocks();
  assertNull(result.getFirstHeader("Warning"));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyExtensionHeaderOnRequests() throws Exception {
  request.setHeader("X-Extension","x-value");
  testDoesNotModifyHeaderOnRequests("X-Extension");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyExtensionHeaderOnResponses() throws Exception {
  originResponse.setHeader("X-Extension","x-value");
  testDoesNotModifyHeaderOnResponses("X-Extension");
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void cacheHitOkWithOnlyIfCached() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("Cache-Control","only-if-cached");
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp1,result));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Override @Before public void setUp(){
  super.setUp();
  now=new Date();
  tenSecondsAgo=new Date(now.getTime() - 10 * 1000L);
  twoMinutesAgo=new Date(now.getTime() - 2 * 60 * 1000L);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyIfUnmodifiedSinceOnRequests() throws Exception {
  request=HttpRequestWrapper.wrap(new BasicHttpRequest("DELETE","/",HttpVersion.HTTP_1_1),host);
  request.setHeader("If-Unmodified-Since",DateUtils.formatDate(new Date()));
  testDoesNotModifyHeaderOnRequests("If-Unmodified-Since");
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void shouldInvalidateNonvariantCacheEntryForUnknownMethod() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("FROB","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("Cache-Control","max-age=3600");
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp3=HttpTestUtils.make200Response();
  resp3.setHeader("ETag","\"etag\"");
  backendExpectsAnyRequestAndReturn(resp3);
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  final HttpResponse result=impl.execute(route,req3,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp3,result));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotReturnStaleResponseIfClientExplicitlyRequestsFreshWithMaxAge() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req.setHeader("Cache-Control","max-age=0");
  testDoesNotReturnStaleResponseOnError(req);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripLastModifiedFromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Last-Modified",DateUtils.formatDate(twoMinutesAgo));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyAcceptRangesOnResponses() throws Exception {
  final String headerName="Accept-Ranges";
  originResponse.setHeader(headerName,"bytes");
  testDoesNotModifyHeaderOnResponses(headerName);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainAllow() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Allow","GET,HEAD");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripContentMD5FromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Content-MD5","Q2hlY2sgSW50ZWdyaXR5IQ==");
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void returns504ForStaleEntryWithOnlyIfCached() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Cache-Control","max-age=5");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("Cache-Control","only-if-cached");
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_GATEWAY_TIMEOUT,result.getStatusLine().getStatusCode());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testSendsAllVariantEtagsInConditionalRequest() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req1.setHeader("User-Agent","agent1");
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("Vary","User-Agent");
  resp1.setHeader("Etag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req2.setHeader("User-Agent","agent2");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("Cache-Control","max-age=3600");
  resp2.setHeader("Vary","User-Agent");
  resp2.setHeader("Etag","\"etag2\"");
  backendExpectsAnyRequestAndReturn(resp2);
  final Capture<HttpRequestWrapper> cap=new Capture<>();
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req3.setHeader("User-Agent","agent3");
  final HttpResponse resp3=HttpTestUtils.make200Response();
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),EasyMock.capture(cap),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(resp3));
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  impl.execute(route,req3,context,null);
  verifyMocks();
  final HttpRequest captured=cap.getValue();
  boolean foundEtag1=false;
  boolean foundEtag2=false;
  for (  final Header h : captured.getHeaders("If-None-Match")) {
    for (    final String etag : h.getValue().split(",")) {
      if ("\"etag1\"".equals(etag.trim())) {
        foundEtag1=true;
      }
      if ("\"etag2\"".equals(etag.trim())) {
        foundEtag2=true;
      }
    }
  }
  assertTrue(foundEtag1 && foundEtag2);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyIfRangeOnRequests() throws Exception {
  request.setHeader("Range","bytes=0-128");
  request.setHeader("If-Range","\"etag\"");
  testDoesNotModifyHeaderOnRequests("If-Range");
}

</code></pre>

<pre class="type-7 type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void shouldStripContentRangeFromOrigin304ResponseToStringValidation() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req.setHeader("If-Range","\"etag\"");
  req.setHeader("Range","bytes=0-127");
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_NOT_MODIFIED,"Not Modified");
  resp.setHeader("Date",DateUtils.formatDate(now));
  resp.setHeader("ETag","\"etag\"");
  resp.setHeader("Content-Range","bytes 0-127/256");
  backendExpectsAnyRequestAndReturn(resp);
  replayMocks();
  final HttpResponse result=impl.execute(route,req,context,null);
  verifyMocks();
  assertNull(result.getFirstHeader("Content-Range"));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testResponseToExistingVariantsIsCachedForFutureResponses() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req1.setHeader("User-Agent","agent1");
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Vary","User-Agent");
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req2.setHeader("User-Agent","agent2");
  final HttpResponse resp2=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_NOT_MODIFIED,"Not Modified");
  resp2.setHeader("Date",DateUtils.formatDate(now));
  resp2.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req3.setHeader("User-Agent","agent2");
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  impl.execute(route,req3,context,null);
  verifyMocks();
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResponseToExistingVariantsUpdatesEntry() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req1.setHeader("User-Agent","agent1");
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Vary","User-Agent");
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req2.setHeader("User-Agent","agent2");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp2.setHeader("Vary","User-Agent");
  resp2.setHeader("Cache-Control","max-age=3600");
  resp2.setHeader("ETag","\"etag2\"");
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req3.setHeader("User-Agent","agent3");
  final HttpResponse resp3=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_NOT_MODIFIED,"Not Modified");
  resp3.setHeader("Date",DateUtils.formatDate(now));
  resp3.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp3);
  final HttpRequestWrapper req4=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req4.setHeader("User-Agent","agent1");
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  final HttpResponse result1=impl.execute(route,req3,context,null);
  final HttpResponse result2=impl.execute(route,req4,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_OK,result1.getStatusLine().getStatusCode());
  assertEquals("\"etag1\"",result1.getFirstHeader("ETag").getValue());
  assertEquals(DateUtils.formatDate(now),result1.getFirstHeader("Date").getValue());
  assertEquals(DateUtils.formatDate(now),result2.getFirstHeader("Date").getValue());
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainContentEncoding() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Content-Encoding","gzip");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyIfMatchOnRequests() throws Exception {
  request=HttpRequestWrapper.wrap(new BasicHttpRequest("DELETE","/",HttpVersion.HTTP_1_1),host);
  request.setHeader("If-Match","\"etag\"");
  testDoesNotModifyHeaderOnRequests("If-Match");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyFromOnRequests() throws Exception {
  request.setHeader("From","foo@example.com");
  testDoesNotModifyHeaderOnRequests("From");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void responseToGetWithQueryFrom1_0OriginVia1_1ProxyAndNoExpiresIsNotCached() throws Exception {
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new HttpGet("http://foo.example.com/bar?baz=quux"),host);
  final HttpResponse resp2=new BasicHttpResponse(HttpVersion.HTTP_1_0,HttpStatus.SC_OK,"OK");
  resp2.setEntity(HttpTestUtils.makeBody(200));
  resp2.setHeader("Content-Length","200");
  resp2.setHeader("Date",DateUtils.formatDate(now));
  resp2.setHeader("Via","1.0 someproxy");
  backendExpectsAnyRequestAndReturn(resp2);
  replayMocks();
  impl.execute(route,req2,context,null);
  verifyMocks();
}

</code></pre>

<pre class="type-7 type-2 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReturnsCachedResponsesAppropriatelyWhenNoOriginCommunication() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","public, max-age=5");
  resp1.setHeader("ETag","\"etag\"");
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  backendExpectsAnyRequest().andThrow(new IOException()).anyTimes();
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_OK,result.getStatusLine().getStatusCode());
  boolean warning111Found=false;
  for (  final Header h : result.getHeaders("Warning")) {
    for (    final WarningValue wv : WarningValue.getWarningValues(h)) {
      if (wv.getWarnCode() == 111) {
        warning111Found=true;
        break;
      }
    }
  }
  assertTrue(warning111Found);
}

</code></pre>

<pre class="type-7 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRevalidatesCachedResponseWithExpirationInThePast() throws Exception {
  final Date oneSecondAgo=new Date(now.getTime() - 1 * 1000L);
  final Date oneSecondFromNow=new Date(now.getTime() + 1 * 1000L);
  final Date twoSecondsFromNow=new Date(now.getTime() + 2 * 1000L);
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("ETag","\"etag\"");
  resp1.setHeader("Date",DateUtils.formatDate(now));
  resp1.setHeader("Expires",DateUtils.formatDate(oneSecondAgo));
  resp1.setHeader("Cache-Control","public");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpRequestWrapper revalidate=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  revalidate.setHeader("If-None-Match","\"etag\"");
  final HttpResponse resp2=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_NOT_MODIFIED,"Not Modified");
  resp2.setHeader("Date",DateUtils.formatDate(twoSecondsFromNow));
  resp2.setHeader("Expires",DateUtils.formatDate(oneSecondFromNow));
  resp2.setHeader("ETag","\"etag\"");
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),eqRequest(revalidate),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(resp2));
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_OK,result.getStatusLine().getStatusCode());
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testForwardsExistingWarningHeadersOnResponseThatArrivesStale() throws Exception {
  originResponse.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  originResponse.setHeader("Cache-Control","public, max-age=5");
  originResponse.setHeader("ETag","\"etag\"");
  originResponse.addHeader("Age","10");
  final String warning="110 fred \"Response is stale\"";
  originResponse.addHeader("Warning",warning);
  backendExpectsAnyRequest().andReturn(originResponse);
  replayMocks();
  final HttpResponse result=impl.execute(route,request,context,null);
  verifyMocks();
  assertEquals(warning,result.getFirstHeader("Warning").getValue());
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongEtagValidatorShouldNotContainAllow() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Allow","GET,HEAD");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongValidatorShouldNotContainContentMD5() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Content-MD5","Q2hlY2sgSW50ZWdyaXR5IQ==");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongEtagValidatorShouldNotContainLastModified() throws Exception {
  cacheGenerated304ForStrongETagValidatorShouldNotContainEntityHeader("Last-Modified",DateUtils.formatDate(tenSecondsAgo));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyDateOnRequests() throws Exception {
  request.setHeader("Date",DateUtils.formatDate(new Date()));
  testDoesNotModifyHeaderOnRequests("Date");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotReturnStaleResponseIfClientExplicitlySpecifiesLargerMaxAge() throws Exception {
  final HttpRequestWrapper req=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req.setHeader("Cache-Control","max-age=20");
  testDoesNotReturnStaleResponseOnError(req);
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainContentLength() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Content-Length","128");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyIfModifiedSinceOnRequests() throws Exception {
  request.setHeader("If-Modified-Since",DateUtils.formatDate(new Date()));
  testDoesNotModifyHeaderOnRequests("If-Modified-Since");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyDateOnResponses() throws Exception {
  originResponse.setHeader("Date",DateUtils.formatDate(new Date()));
  testDoesNotModifyHeaderOnResponses("Date");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyLocationOnResponses() throws Exception {
  originResponse.setStatusCode(HttpStatus.SC_TEMPORARY_REDIRECT);
  originResponse.setReasonPhrase("Temporary Redirect");
  originResponse.setHeader("Location","http://foo.example.com/bar");
  testDoesNotModifyHeaderOnResponses("Location");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainContentRange() throws Exception {
  cacheGenerated304ForStrongValidatorShouldNotContainContentRange("Last-Modified",DateUtils.formatDate(twoMinutesAgo),"If-Modified-Since");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongEtagValidatorShouldNotContainContentRange() throws Exception {
  cacheGenerated304ForStrongValidatorShouldNotContainContentRange("ETag","\"etag\"","If-None-Match");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyRefererOnRequests() throws Exception {
  request.setHeader("Referer","http://foo.example.com/bar");
  testDoesNotModifyHeaderOnRequests("Referer");
}

</code></pre>

<pre class="type-2 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetriesValidationThatResultsInAnOlderDated304Response() throws Exception {
  final Date elevenSecondsAgo=new Date(now.getTime() - 11 * 1000L);
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("ETag","\"etag\"");
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Cache-Control","max-age=5");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp2=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_NOT_MODIFIED,"Not Modified");
  resp2.setHeader("ETag","\"etag\"");
  resp2.setHeader("Date",DateUtils.formatDate(elevenSecondsAgo));
  backendExpectsAnyRequestAndReturn(resp2);
  final Capture<HttpRequestWrapper> cap=new Capture<>();
  final HttpResponse resp3=HttpTestUtils.make200Response();
  resp3.setHeader("ETag","\"etag2\"");
  resp3.setHeader("Date",DateUtils.formatDate(now));
  resp3.setHeader("Cache-Control","max-age=5");
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),EasyMock.capture(cap),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(resp3));
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  verifyMocks();
  final HttpRequest captured=cap.getValue();
  boolean hasMaxAge0=false;
  boolean hasNoCache=false;
  for (  final Header h : captured.getHeaders("Cache-Control")) {
    for (    final HeaderElement elt : h.getElements()) {
      if ("max-age".equals(elt.getName())) {
        try {
          final int maxage=Integer.parseInt(elt.getValue());
          if (maxage == 0) {
            hasMaxAge0=true;
          }
        }
 catch (        final NumberFormatException nfe) {
        }
      }
 else       if ("no-cache".equals(elt.getName())) {
        hasNoCache=true;
      }
    }
  }
  assertTrue(hasMaxAge0 || hasNoCache);
  assertNull(captured.getFirstHeader("If-None-Match"));
  assertNull(captured.getFirstHeader("If-Modified-Since"));
  assertNull(captured.getFirstHeader("If-Range"));
  assertNull(captured.getFirstHeader("If-Match"));
  assertNull(captured.getFirstHeader("If-Unmodified-Since"));
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void shouldInvalidateAllVariantsForUnknownMethod() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req1.setHeader("User-Agent","agent1");
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Cache-Control","max-age=3600");
  resp1.setHeader("Vary","User-Agent");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req2.setHeader("User-Agent","agent2");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("Cache-Control","max-age=3600");
  resp2.setHeader("Vary","User-Agent");
  backendExpectsAnyRequestAndReturn(resp2);
  final HttpRequestWrapper req3=HttpRequestWrapper.wrap(new BasicHttpRequest("FROB","/",HttpVersion.HTTP_1_1),host);
  req3.setHeader("User-Agent","agent3");
  final HttpResponse resp3=HttpTestUtils.make200Response();
  resp3.setHeader("Cache-Control","max-age=3600");
  backendExpectsAnyRequestAndReturn(resp3);
  final HttpRequestWrapper req4=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req4.setHeader("User-Agent","agent1");
  final HttpResponse resp4=HttpTestUtils.make200Response();
  resp4.setHeader("ETag","\"etag1\"");
  backendExpectsAnyRequestAndReturn(resp4);
  final HttpRequestWrapper req5=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req5.setHeader("User-Agent","agent2");
  final HttpResponse resp5=HttpTestUtils.make200Response();
  resp5.setHeader("ETag","\"etag2\"");
  backendExpectsAnyRequestAndReturn(resp5);
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  impl.execute(route,req3,context,null);
  final HttpResponse result4=impl.execute(route,req4,context,null);
  final HttpResponse result5=impl.execute(route,req5,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp4,result4));
  assertTrue(HttpTestUtils.semanticallyTransparent(resp5,result5));
}

</code></pre>

<pre class="type-7 type-4 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMayReturnStaleResponseIfClientExplicitlySpecifiesAcceptableMaxStale() throws Exception {
  final HttpRequestWrapper req1=requestToPopulateStaleCacheEntry();
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  req2.setHeader("Cache-Control","max-stale=20");
  backendExpectsAnyRequest().andThrow(new IOException()).times(0,1);
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_OK,result.getStatusLine().getStatusCode());
  assertNotNull(result.getFirstHeader("Warning"));
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUsesLastModifiedDateForCacheConditionalRequests() throws Exception {
  final Date twentySecondsAgo=new Date(now.getTime() - 20 * 1000L);
  final String lmDate=DateUtils.formatDate(twentySecondsAgo);
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Last-Modified",lmDate);
  resp1.setHeader("Cache-Control","max-age=5");
  backendExpectsAnyRequestAndReturn(resp1);
  final Capture<HttpRequestWrapper> cap=new Capture<>();
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(new BasicHttpRequest("GET","/",HttpVersion.HTTP_1_1),host);
  final HttpResponse resp2=HttpTestUtils.make200Response();
  EasyMock.expect(mockBackend.execute(EasyMock.eq(route),EasyMock.capture(cap),EasyMock.isA(HttpClientContext.class),EasyMock.<HttpExecutionAware>isNull())).andReturn(Proxies.enhanceResponse(resp2));
  replayMocks();
  impl.execute(route,req1,context,null);
  impl.execute(route,req2,context,null);
  verifyMocks();
  final HttpRequest captured=cap.getValue();
  final Header ifModifiedSince=captured.getFirstHeader("If-Modified-Since");
  assertEquals(lmDate,ifModifiedSince.getValue());
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyExpiresOnResponses() throws Exception {
  originResponse.setHeader("Expires",DateUtils.formatDate(new Date()));
  testDoesNotModifyHeaderOnResponses("Expires");
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void issues304EvenWithWeakETag() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(tenSecondsAgo));
  resp1.setHeader("Cache-Control","max-age=300");
  resp1.setHeader("ETag","W/\"weak-sauce\"");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("If-None-Match","W/\"weak-sauce\"");
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertEquals(HttpStatus.SC_NOT_MODIFIED,result.getStatusLine().getStatusCode());
}

</code></pre>

<pre class="type-7 type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void expiresEqualToDateWithNoCacheControlIsNotCacheable() throws Exception {
  final HttpRequestWrapper req1=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(now));
  resp1.setHeader("Expires",DateUtils.formatDate(now));
  resp1.removeHeaders("Cache-Control");
  backendExpectsAnyRequestAndReturn(resp1);
  final HttpRequestWrapper req2=HttpRequestWrapper.wrap(HttpTestUtils.makeDefaultRequest(),host);
  req2.setHeader("Cache-Control","max-stale=1000");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("ETag","\"etag2\"");
  backendExpectsAnyRequestAndReturn(resp2);
  replayMocks();
  impl.execute(route,req1,context,null);
  final HttpResponse result=impl.execute(route,req2,context,null);
  verifyMocks();
  assertTrue(HttpTestUtils.semanticallyTransparent(resp2,result));
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void cacheGenerated304ForStrongDateValidatorShouldNotContainContentType() throws Exception {
  cacheGenerated304ForStrongDateValidatorShouldNotContainEntityHeader("Content-Type","text/html");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testDoesNotModifyETagOnResponses() throws Exception {
  originResponse.setHeader("ETag","\"random-etag\"");
  testDoesNotModifyHeaderOnResponses("ETag");
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void shouldStripContentEncodingFromOrigin304ResponseToStrongValidation() throws Exception {
  shouldStripEntityHeaderFromOrigin304ResponseToStrongValidation("Content-Encoding","gzip");
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
