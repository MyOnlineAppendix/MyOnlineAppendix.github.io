<h3 style="margin:0px">Class: org.apache.hc.client5.http.ssl.TestDefaultHostnameVerifier (9 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHTTPCLIENT_1316() throws Exception {
  final String host1="2001:0db8:aaaa:bbbb:cccc:0:0:0001";
  DefaultHostnameVerifier.matchIPv6Address(host1,Arrays.asList("2001:0db8:aaaa:bbbb:cccc:0:0:0001"));
  DefaultHostnameVerifier.matchIPv6Address(host1,Arrays.asList("2001:0db8:aaaa:bbbb:cccc::1"));
  try {
    DefaultHostnameVerifier.matchIPv6Address(host1,Arrays.asList("2001:0db8:aaaa:bbbb:cccc::10"));
    Assert.fail("SSLException expected");
  }
 catch (  final SSLException expected) {
  }
  final String host2="2001:0db8:aaaa:bbbb:cccc::1";
  DefaultHostnameVerifier.matchIPv6Address(host2,Arrays.asList("2001:0db8:aaaa:bbbb:cccc:0:0:0001"));
  DefaultHostnameVerifier.matchIPv6Address(host2,Arrays.asList("2001:0db8:aaaa:bbbb:cccc::1"));
  try {
    DefaultHostnameVerifier.matchIPv6Address(host2,Arrays.asList("2001:0db8:aaaa:bbbb:cccc::10"));
    Assert.fail("SSLException expected");
  }
 catch (  final SSLException expected) {
  }
}

</code></pre>

<pre class="type-12 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testVerify() throws Exception {
  final CertificateFactory cf=CertificateFactory.getInstance("X.509");
  InputStream in;
  X509Certificate x509;
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_FOO);
  x509=(X509Certificate)cf.generateCertificate(in);
  impl.verify("foo.com",x509);
  exceptionPlease(impl,"a.foo.com",x509);
  exceptionPlease(impl,"bar.com",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_HANAKO);
  x509=(X509Certificate)cf.generateCertificate(in);
  impl.verify("\u82b1\u5b50.co.jp",x509);
  exceptionPlease(impl,"a.\u82b1\u5b50.co.jp",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_FOO_BAR);
  x509=(X509Certificate)cf.generateCertificate(in);
  exceptionPlease(impl,"foo.com",x509);
  exceptionPlease(impl,"a.foo.com",x509);
  impl.verify("bar.com",x509);
  exceptionPlease(impl,"a.bar.com",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_FOO_BAR_HANAKO);
  x509=(X509Certificate)cf.generateCertificate(in);
  exceptionPlease(impl,"foo.com",x509);
  exceptionPlease(impl,"a.foo.com",x509);
  impl.verify("bar.com",x509);
  exceptionPlease(impl,"a.bar.com",x509);
  exceptionPlease(impl,"a.\u82b1\u5b50.co.jp",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_NO_CNS_FOO);
  x509=(X509Certificate)cf.generateCertificate(in);
  impl.verify("foo.com",x509);
  exceptionPlease(impl,"a.foo.com",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_NO_CNS_FOO);
  x509=(X509Certificate)cf.generateCertificate(in);
  impl.verify("foo.com",x509);
  exceptionPlease(impl,"a.foo.com",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_THREE_CNS_FOO_BAR_HANAKO);
  x509=(X509Certificate)cf.generateCertificate(in);
  exceptionPlease(impl,"foo.com",x509);
  exceptionPlease(impl,"a.foo.com",x509);
  exceptionPlease(impl,"bar.com",x509);
  exceptionPlease(impl,"a.bar.com",x509);
  impl.verify("\u82b1\u5b50.co.jp",x509);
  exceptionPlease(impl,"a.\u82b1\u5b50.co.jp",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_WILD_FOO);
  x509=(X509Certificate)cf.generateCertificate(in);
  exceptionPlease(impl,"foo.com",x509);
  impl.verify("www.foo.com",x509);
  impl.verify("\u82b1\u5b50.foo.com",x509);
  exceptionPlease(impl,"a.b.foo.com",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_WILD_CO_JP);
  x509=(X509Certificate)cf.generateCertificate(in);
  impl.verify("*.co.jp",x509);
  impl.verify("foo.co.jp",x509);
  impl.verify("\u82b1\u5b50.co.jp",x509);
  exceptionPlease(implWithPublicSuffixCheck,"foo.co.jp",x509);
  exceptionPlease(implWithPublicSuffixCheck,"\u82b1\u5b50.co.jp",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_WILD_FOO_BAR_HANAKO);
  x509=(X509Certificate)cf.generateCertificate(in);
  exceptionPlease(impl,"foo.com",x509);
  exceptionPlease(impl,"www.foo.com",x509);
  exceptionPlease(impl,"\u82b1\u5b50.foo.com",x509);
  exceptionPlease(impl,"a.b.foo.com",x509);
  exceptionPlease(impl,"bar.com",x509);
  impl.verify("www.bar.com",x509);
  impl.verify("\u82b1\u5b50.bar.com",x509);
  exceptionPlease(impl,"a.b.bar.com",x509);
  in=new ByteArrayInputStream(CertificatesToPlayWith.X509_MULTIPLE_VALUE_AVA);
  x509=(X509Certificate)cf.generateCertificate(in);
  impl.verify("repository.infonotary.com",x509);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHTTPCLIENT_1097(){
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("a.b.c","a*.b.c"));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentityStrict("a.b.c","a*.b.c"));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("a.a.b.c","a*.b.c"));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("a.a.b.c","a*.b.c"));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testDomainRootMatching(){
  Assert.assertFalse(DefaultHostnameVerifier.matchDomainRoot("a.b.c",null));
  Assert.assertTrue(DefaultHostnameVerifier.matchDomainRoot("a.b.c","a.b.c"));
  Assert.assertFalse(DefaultHostnameVerifier.matchDomainRoot("aa.b.c","a.b.c"));
  Assert.assertFalse(DefaultHostnameVerifier.matchDomainRoot("a.b.c","aa.b.c"));
  Assert.assertTrue(DefaultHostnameVerifier.matchDomainRoot("a.a.b.c","a.b.c"));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setup(){
  impl=new DefaultHostnameVerifier();
  publicSuffixMatcher=new PublicSuffixMatcher(DomainType.ICANN,Arrays.asList("com","co.jp","gov.uk"),null);
  implWithPublicSuffixCheck=new DefaultHostnameVerifier(publicSuffixMatcher);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testIdentityMatching(){
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("a.b.c","*.b.c"));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentityStrict("a.b.c","*.b.c"));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("s.a.b.c","*.b.c"));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("s.a.b.c","*.b.c"));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentity("a.gov.uk","*.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("a.gov.uk","*.gov.uk",publicSuffixMatcher));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("s.a.gov.uk","*.a.gov.uk",publicSuffixMatcher));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentityStrict("s.a.gov.uk","*.a.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentity("s.a.gov.uk","*.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("s.a.gov.uk","*.gov.uk",publicSuffixMatcher));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("a.gov.com","*.gov.com",publicSuffixMatcher));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentityStrict("a.gov.com","*.gov.com",publicSuffixMatcher));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("s.a.gov.com","*.gov.com",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("s.a.gov.com","*.gov.com",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentity("a.gov.uk","a*.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("a.gov.uk","a*.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentity("s.a.gov.uk","a*.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("s.a.gov.uk","a*.gov.uk",publicSuffixMatcher));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentity("a.b.c","*.b.*"));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("a.b.c","*.b.*"));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentity("a.b.c","*.*.c"));
  Assert.assertFalse(DefaultHostnameVerifier.matchIdentityStrict("a.b.c","*.*.c"));
}

</code></pre>

<pre class="type-7 type-8 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubjectAlt() throws Exception {
  final CertificateFactory cf=CertificateFactory.getInstance("X.509");
  final InputStream in=new ByteArrayInputStream(CertificatesToPlayWith.X509_MULTIPLE_SUBJECT_ALT);
  final X509Certificate x509=(X509Certificate)cf.generateCertificate(in);
  Assert.assertEquals("CN=localhost, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=CH",x509.getSubjectDN().getName());
  impl.verify("localhost.localdomain",x509);
  impl.verify("127.0.0.1",x509);
  try {
    impl.verify("localhost",x509);
    Assert.fail("SSLException should have been thrown");
  }
 catch (  final SSLException ex) {
  }
  try {
    impl.verify("local.host",x509);
    Assert.fail("SSLException should have been thrown");
  }
 catch (  final SSLException ex) {
  }
  try {
    impl.verify("127.0.0.2",x509);
    Assert.fail("SSLException should have been thrown");
  }
 catch (  final SSLException ex) {
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testHTTPCLIENT_1255(){
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentity("mail.a.b.c.com","m*.a.b.c.com"));
  Assert.assertTrue(DefaultHostnameVerifier.matchIdentityStrict("mail.a.b.c.com","m*.a.b.c.com"));
}

</code></pre>

<pre class="type-8 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtractCN() throws Exception {
  Assert.assertEquals("blah",DefaultHostnameVerifier.extractCN("cn=blah, ou=blah, o=blah"));
  Assert.assertEquals("blah",DefaultHostnameVerifier.extractCN("cn=blah, cn=yada, cn=booh"));
  Assert.assertEquals("blah",DefaultHostnameVerifier.extractCN("c = pampa ,  cn  =    blah    , ou = blah , o = blah"));
  Assert.assertEquals("blah",DefaultHostnameVerifier.extractCN("cn=\"blah\", ou=blah, o=blah"));
  Assert.assertEquals("blah  blah",DefaultHostnameVerifier.extractCN("cn=\"blah  blah\", ou=blah, o=blah"));
  Assert.assertEquals("blah, blah",DefaultHostnameVerifier.extractCN("cn=\"blah, blah\", ou=blah, o=blah"));
  Assert.assertEquals("blah, blah",DefaultHostnameVerifier.extractCN("cn=blah\\, blah, ou=blah, o=blah"));
  Assert.assertEquals("blah",DefaultHostnameVerifier.extractCN("c = cn=uuh, cn=blah, ou=blah, o=blah"));
  try {
    DefaultHostnameVerifier.extractCN("blah,blah");
    Assert.fail("SSLException expected");
  }
 catch (  final SSLException expected) {
  }
  try {
    DefaultHostnameVerifier.extractCN("cn,o=blah");
    Assert.fail("SSLException expected");
  }
 catch (  final SSLException expected) {
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
