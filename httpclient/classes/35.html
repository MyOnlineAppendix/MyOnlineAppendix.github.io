<h3 style="margin:0px">Class: org.apache.hc.client5.http.impl.cache.TestBasicHttpCache (29 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(27)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="16"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('16')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-16"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoNotFlushCacheEntriesOnOptions() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpOptions("/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,req);
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  backing.map.put(key,entry);
  impl.flushCacheEntriesFor(host,req);
  assertEquals(entry,backing.map.get(key));
}

</code></pre>

<pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreInCachePutsNonVariantEntryInPlace() throws Exception {
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  assertFalse(entry.hasVariants());
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpGet("http://foo.example.com/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,req);
  impl.storeInCache(host,req,entry);
  assertSame(entry,backing.map.get(key));
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testResponsesWithoutExplicitContentLengthAreComplete() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setEntity(new ByteArrayEntity(bytes));
  assertFalse(impl.isIncompleteResponse(resp,resource));
}

</code></pre>

<pre class="type-7 type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCacheUpdateAddsVariantURIToParentEntry() throws Exception {
  final String parentCacheKey="parentCacheKey";
  final String variantCacheKey="variantCacheKey";
  final String existingVariantKey="existingVariantKey";
  final String newVariantCacheKey="newVariantCacheKey";
  final String newVariantKey="newVariantKey";
  final Map<String,String> existingVariants=new HashMap<>();
  existingVariants.put(existingVariantKey,variantCacheKey);
  final HttpCacheEntry parent=HttpTestUtils.makeCacheEntry(existingVariants);
  final HttpCacheEntry variant=HttpTestUtils.makeCacheEntry();
  final HttpCacheEntry result=impl.doGetUpdatedParentEntry(parentCacheKey,parent,variant,newVariantKey,newVariantCacheKey);
  final Map<String,String> resultMap=result.getVariantMap();
  assertEquals(2,resultMap.size());
  assertEquals(variantCacheKey,resultMap.get(existingVariantKey));
  assertEquals(newVariantCacheKey,resultMap.get(newVariantKey));
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetCacheEntryReturnsNullIfNoVariantInCache() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final HttpRequest origRequest=new HttpGet("http://foo.example.com/bar");
  origRequest.setHeader("Accept-Encoding","gzip");
  final HttpResponse origResponse=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  origResponse.setEntity(HttpTestUtils.makeBody(128));
  origResponse.setHeader("Date",DateUtils.formatDate(new Date()));
  origResponse.setHeader("Cache-Control","max-age=3600, public");
  origResponse.setHeader("ETag","\"etag\"");
  origResponse.setHeader("Vary","Accept-Encoding");
  origResponse.setHeader("Content-Encoding","gzip");
  impl.cacheAndReturnResponse(host,origRequest,origResponse,new Date(),new Date());
  final HttpCacheEntry result=impl.getCacheEntry(host,request);
  assertNull(result);
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTooLargeResponsesAreNotCached() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final Date now=new Date();
  final Date requestSent=new Date(now.getTime() - 3 * 1000L);
  final Date responseGenerated=new Date(now.getTime() - 2 * 1000L);
  final Date responseReceived=new Date(now.getTime() - 1 * 1000L);
  final HttpResponse originResponse=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  originResponse.setEntity(HttpTestUtils.makeBody(CacheConfig.DEFAULT_MAX_OBJECT_SIZE_BYTES + 1));
  originResponse.setHeader("Cache-Control","public, max-age=3600");
  originResponse.setHeader("Date",DateUtils.formatDate(responseGenerated));
  originResponse.setHeader("ETag","\"etag\"");
  final HttpResponse result=impl.cacheAndReturnResponse(host,request,originResponse,requestSent,responseReceived);
  assertEquals(0,backing.map.size());
  assertTrue(HttpTestUtils.semanticallyTransparent(originResponse,result));
}

</code></pre>

<pre class="type-2 type-4 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCacheEntryFetchesFromCacheOnCacheHitIfNoVariants() throws Exception {
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  assertFalse(entry.hasVariants());
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,request);
  backing.map.put(key,entry);
  final HttpCacheEntry result=impl.getCacheEntry(host,request);
  Assert.assertSame(entry,result);
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testEntryUpdate() throws Exception {
  final HeapResourceFactory rf=new HeapResourceFactory(){
    @Override Resource createResource(    final byte[] buf){
      return new DisposableResource(buf);
    }
  }
;
  impl=new BasicHttpCache(rf,backing,CacheConfig.DEFAULT);
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest origRequest=new HttpGet("http://foo.example.com/bar");
  origRequest.setHeader("Accept-Encoding","gzip");
  final HttpResponse origResponse=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  origResponse.setEntity(HttpTestUtils.makeBody(128));
  origResponse.setHeader("Date",DateUtils.formatDate(new Date()));
  origResponse.setHeader("Cache-Control","max-age=3600, public");
  origResponse.setHeader("ETag","\"etag\"");
  origResponse.setHeader("Vary","Accept-Encoding");
  origResponse.setHeader("Content-Encoding","gzip");
  final HttpResponse response=impl.cacheAndReturnResponse(host,origRequest,origResponse,new Date(),new Date());
  final HttpEntity entity=response.getEntity();
  Assert.assertNotNull(entity);
  IOUtils.copyAndClose(entity.getContent(),new ByteArrayOutputStream());
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testFlushContentLocationEntryIfUnSafeRequest() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpPost("/foo");
  final HttpResponse resp=HttpTestUtils.make200Response();
  resp.setHeader("Content-Location","/bar");
  resp.setHeader(HeaderConstants.ETAG,"\"etag\"");
  final String key=(new CacheKeyGenerator()).getURI(host,new HttpGet("/bar"));
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry(new Header[]{new BasicHeader("Date",DateUtils.formatDate(new Date())),new BasicHeader("ETag","\"old-etag\"")});
  backing.map.put(key,entry);
  impl.flushInvalidatedCacheEntriesFor(host,req,resp);
  assertNull(backing.map.get(key));
}

</code></pre>

<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoNotFlushCacheEntriesOnTrace() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpTrace("/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,req);
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  backing.map.put(key,entry);
  impl.flushCacheEntriesFor(host,req);
  assertEquals(entry,backing.map.get(key));
}

</code></pre>

<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIncompleteResponseErrorProvidesPlainTextErrorMessage() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setEntity(new ByteArrayEntity(bytes));
  resp.setHeader("Content-Length","256");
  final HttpResponse result=impl.generateIncompleteResponseError(resp,resource);
  final Header ctype=result.getFirstHeader("Content-Type");
  assertEquals("text/plain;charset=UTF-8",ctype.getValue());
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRecognizesComplete206Response() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_PARTIAL_CONTENT,"Partial Content");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setEntity(new ByteArrayEntity(bytes));
  resp.setHeader("Content-Length","128");
  resp.setHeader("Content-Range","bytes 0-127/255");
  assertFalse(impl.isIncompleteResponse(resp,resource));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setUp() throws Exception {
  backing=new SimpleHttpCacheStorage();
  impl=new BasicHttpCache(new HeapResourceFactory(),backing,CacheConfig.DEFAULT);
}

</code></pre>

<pre class="type-7 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSmallEnoughResponsesAreCached() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final Date now=new Date();
  final Date requestSent=new Date(now.getTime() - 3 * 1000L);
  final Date responseGenerated=new Date(now.getTime() - 2 * 1000L);
  final Date responseReceived=new Date(now.getTime() - 1 * 1000L);
  final HttpResponse originResponse=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  originResponse.setEntity(HttpTestUtils.makeBody(CacheConfig.DEFAULT_MAX_OBJECT_SIZE_BYTES - 1));
  originResponse.setHeader("Cache-Control","public, max-age=3600");
  originResponse.setHeader("Date",DateUtils.formatDate(responseGenerated));
  originResponse.setHeader("ETag","\"etag\"");
  final HttpResponse result=impl.cacheAndReturnResponse(host,request,originResponse,requestSent,responseReceived);
  assertEquals(1,backing.map.size());
  assertTrue(backing.map.containsKey((new CacheKeyGenerator()).getURI(host,request)));
  assertTrue(HttpTestUtils.semanticallyTransparent(originResponse,result));
}

</code></pre>

<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoNotFlushContentLocationEntryIfSafeRequest() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpGet("/foo");
  final HttpResponse resp=HttpTestUtils.make200Response();
  resp.setHeader("Content-Location","/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,new HttpGet("/bar"));
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry(new Header[]{new BasicHeader("Date",DateUtils.formatDate(new Date())),new BasicHeader("ETag","\"old-etag\"")});
  backing.map.put(key,entry);
  impl.flushInvalidatedCacheEntriesFor(host,req,resp);
  assertEquals(entry,backing.map.get(key));
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRecognizesComplete200Response() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  resp.setEntity(new ByteArrayEntity(bytes));
  resp.setHeader("Content-Length","128");
  final Resource resource=new HeapResource(bytes);
  assertFalse(impl.isIncompleteResponse(resp,resource));
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetCacheEntryReturnsNullOnCacheMiss() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final HttpCacheEntry result=impl.getCacheEntry(host,request);
  Assert.assertNull(result);
}

</code></pre>

<pre class="type-16 type-2 type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncompleteResponseErrorProvidesNonEmptyErrorMessage() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setEntity(new ByteArrayEntity(bytes));
  resp.setHeader("Content-Length","256");
  final HttpResponse result=impl.generateIncompleteResponseError(resp,resource);
  final int clen=Integer.parseInt(result.getFirstHeader("Content-Length").getValue());
  assertTrue(clen > 0);
  final HttpEntity body=result.getEntity();
  if (body.getContentLength() < 0) {
    final InputStream is=body.getContent();
    int bytes_read=0;
    while ((is.read()) != -1) {
      bytes_read++;
    }
    is.close();
    assertEquals(clen,bytes_read);
  }
 else {
    assertTrue(body.getContentLength() == clen);
  }
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetCacheEntryReturnsVariantIfPresentInCache() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  request.setHeader("Accept-Encoding","gzip");
  final HttpRequest origRequest=new HttpGet("http://foo.example.com/bar");
  origRequest.setHeader("Accept-Encoding","gzip");
  final HttpResponse origResponse=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  origResponse.setEntity(HttpTestUtils.makeBody(128));
  origResponse.setHeader("Date",DateUtils.formatDate(new Date()));
  origResponse.setHeader("Cache-Control","max-age=3600, public");
  origResponse.setHeader("ETag","\"etag\"");
  origResponse.setHeader("Vary","Accept-Encoding");
  origResponse.setHeader("Content-Encoding","gzip");
  impl.cacheAndReturnResponse(host,origRequest,origResponse,new Date(),new Date());
  final HttpCacheEntry result=impl.getCacheEntry(host,request);
  assertNotNull(result);
}

</code></pre>

<pre class="type-4 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetVariantCacheEntriesReturnsEmptySetOnNoVariants() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final Map<String,Variant> variants=impl.getVariantCacheEntriesWithEtags(host,request);
  assertNotNull(variants);
  assertEquals(0,variants.size());
}

</code></pre>

<pre class="type-4 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetVariantCacheEntriesReturnsAllVariants() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req1=new HttpGet("http://foo.example.com/bar");
  req1.setHeader("Accept-Encoding","gzip");
  final HttpResponse resp1=HttpTestUtils.make200Response();
  resp1.setHeader("Date",DateUtils.formatDate(new Date()));
  resp1.setHeader("Cache-Control","max-age=3600, public");
  resp1.setHeader("ETag","\"etag1\"");
  resp1.setHeader("Vary","Accept-Encoding");
  resp1.setHeader("Content-Encoding","gzip");
  resp1.setHeader("Vary","Accept-Encoding");
  final HttpRequest req2=new HttpGet("http://foo.example.com/bar");
  req2.setHeader("Accept-Encoding","identity");
  final HttpResponse resp2=HttpTestUtils.make200Response();
  resp2.setHeader("Date",DateUtils.formatDate(new Date()));
  resp2.setHeader("Cache-Control","max-age=3600, public");
  resp2.setHeader("ETag","\"etag2\"");
  resp2.setHeader("Vary","Accept-Encoding");
  resp2.setHeader("Content-Encoding","gzip");
  resp2.setHeader("Vary","Accept-Encoding");
  impl.cacheAndReturnResponse(host,req1,resp1,new Date(),new Date());
  impl.cacheAndReturnResponse(host,req2,resp2,new Date(),new Date());
  final Map<String,Variant> variants=impl.getVariantCacheEntriesWithEtags(host,req1);
  assertNotNull(variants);
  assertEquals(2,variants.size());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testOriginalResponseWithNoContentSizeHeaderIsReleased() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest request=new HttpGet("http://foo.example.com/bar");
  final Date now=new Date();
  final Date requestSent=new Date(now.getTime() - 3 * 1000L);
  final Date responseGenerated=new Date(now.getTime() - 2 * 1000L);
  final Date responseReceived=new Date(now.getTime() - 1 * 1000L);
  final HttpResponse originResponse=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final BasicHttpEntity entity=new BasicHttpEntity();
  final ConsumableInputStream inputStream=new ConsumableInputStream(new ByteArrayInputStream(HttpTestUtils.getRandomBytes(CacheConfig.DEFAULT_MAX_OBJECT_SIZE_BYTES - 1)));
  entity.setContent(inputStream);
  originResponse.setEntity(entity);
  originResponse.setHeader("Cache-Control","public, max-age=3600");
  originResponse.setHeader("Date",DateUtils.formatDate(responseGenerated));
  originResponse.setHeader("ETag","\"etag\"");
  final HttpResponse result=impl.cacheAndReturnResponse(host,request,originResponse,requestSent,responseReceived);
  IOUtils.consume(result.getEntity());
  assertTrue(inputStream.wasClosed());
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIgnoresIncompleteNon200Or206Responses() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_FORBIDDEN,"Forbidden");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setEntity(new ByteArrayEntity(bytes));
  resp.setHeader("Content-Length","256");
  assertFalse(impl.isIncompleteResponse(resp,resource));
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNullResourcesAreComplete() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  resp.setHeader("Content-Length","256");
  assertFalse(impl.isIncompleteResponse(resp,null));
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testResponsesWithUnparseableContentLengthHeaderAreComplete() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setHeader("Content-Length","foo");
  resp.setEntity(new ByteArrayEntity(bytes));
  assertFalse(impl.isIncompleteResponse(resp,resource));
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCanFlushCacheEntriesAtUri() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpDelete("/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,req);
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  backing.map.put(key,entry);
  impl.flushCacheEntriesFor(host,req);
  assertNull(backing.map.get(key));
}

</code></pre>

<pre class="type-2 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRecognizesIncomplete200Response() throws Exception {
  final HttpResponse resp=new BasicHttpResponse(HttpVersion.HTTP_1_1,HttpStatus.SC_OK,"OK");
  final byte[] bytes=HttpTestUtils.getRandomBytes(128);
  final Resource resource=new HeapResource(bytes);
  resp.setEntity(new ByteArrayEntity(bytes));
  resp.setHeader("Content-Length","256");
  assertTrue(impl.isIncompleteResponse(resp,resource));
}

</code></pre>

<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoNotFlushCacheEntriesOnGet() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpGet("/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,req);
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  backing.map.put(key,entry);
  impl.flushCacheEntriesFor(host,req);
  assertEquals(entry,backing.map.get(key));
}

</code></pre>

<pre class="type-4 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoNotFlushCacheEntriesOnHead() throws Exception {
  final HttpHost host=new HttpHost("foo.example.com");
  final HttpRequest req=new HttpHead("/bar");
  final String key=(new CacheKeyGenerator()).getURI(host,req);
  final HttpCacheEntry entry=HttpTestUtils.makeCacheEntry();
  backing.map.put(key,entry);
  impl.flushCacheEntriesFor(host,req);
  assertEquals(entry,backing.map.get(key));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
