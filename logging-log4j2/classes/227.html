<h3 style="margin:0px">Class: org.apache.logging.log4j.core.layout.Rfc5424LayoutTest (9 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-6 type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDiscardEmptyLoggerFields(){
  final String mdcId="RequestContext";
  final List<String> expectedToContain=Arrays.asList("[BAZ@32473 baz=\"org.apache.logging.log4j.core.layout.Rfc5424LayoutTest.testLoggerFields\"]" + "[RequestContext@3692 bar=\"org.apache.logging.log4j.core.layout.Rfc5424LayoutTest.testLoggerFields\"]");
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final LoggerFields[] loggerFields=new LoggerFields[]{LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("dummy",Strings.EMPTY),new KeyValuePair("empty",Strings.EMPTY)},"SD-ID","32473",true),LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("baz","%C.%M"),new KeyValuePair("baz","%C.%M")},"BAZ","32473",false),LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("bar","%C.%M")},null,null,false)};
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,mdcId,null,null,true,null,"ATM",null,"key1, key2, locale",null,null,null,false,loggerFields,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  root.info("starting logger fields test");
  try {
    final List<String> list=appender.getMessages();
    assertTrue("Not enough list entries",list.size() > 0);
    final String message=list.get(0);
    Assert.assertTrue("SD-ID should have been discarded",!message.contains("SD-ID"));
    Assert.assertTrue("BAZ should have been included",message.contains("BAZ"));
    Assert.assertTrue(mdcId + "should have been included",message.contains(mdcId));
    appender.clear();
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<pre class="type-6 type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLoggerFields(){
  final String[] fields=new String[]{"[BAZ@32473 baz=\"org.apache.logging.log4j.core.layout.Rfc5424LayoutTest.testLoggerFields\"]","[RequestContext@3692 bar=\"org.apache.logging.log4j.core.layout.Rfc5424LayoutTest.testLoggerFields\"]","[SD-ID@32473 source=\"org.apache.logging.log4j.core.layout.Rfc5424LayoutTest.testLoggerFields\"]"};
  final List<String> expectedToContain=Arrays.asList(fields);
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final LoggerFields[] loggerFields=new LoggerFields[]{LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("source","%C.%M")},"SD-ID","32473",false),LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("baz","%C.%M"),new KeyValuePair("baz","%C.%M")},"BAZ","32473",false),LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("bar","%C.%M")},null,null,false)};
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,"RequestContext",null,null,true,null,"ATM",null,"key1, key2, locale",null,null,null,false,loggerFields,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  root.info("starting logger fields test");
  try {
    final List<String> list=appender.getMessages();
    assertTrue("Not enough list entries",list.size() > 0);
    final String message=list.get(0);
    assertTrue("No class/method",message.contains("Rfc5424LayoutTest.testLoggerFields"));
    for (    final String value : expectedToContain) {
      Assert.assertTrue("Message expected to contain " + value + " but did not",message.contains(value));
    }
    appender.clear();
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<pre class="type-6 type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testParameterizedMessage(){
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,"RequestContext",null,null,true,null,"ATM",null,"key1, key2, locale",null,null,null,true,null,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  root.info("Hello {}","World");
  try {
    final List<String> list=appender.getMessages();
    assertTrue("Not enough list entries",list.size() > 0);
    final String message=list.get(0);
    assertTrue("Incorrect message. Expected - Hello World, Actual - " + message,message.contains("Hello World"));
  }
  finally {
    root.removeAppender(appender);
    appender.stop();
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void cleanupClass(){
  ConfigurationFactory.removeConfigurationFactory(cf);
  ThreadContext.clearAll();
}

</code></pre>

<pre class="type-6 type-5 type-4 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test case for MDC conversion pattern.
 */
@Test public void testLayout() throws Exception {
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,"RequestContext",null,null,true,null,"ATM",null,"key1, key2, locale",null,"loginId",null,true,null,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  ThreadContext.put("loginId","JohnDoe");
  root.debug("starting mdc pattern test");
  root.debug("empty mdc");
  ThreadContext.put("key1","value1");
  ThreadContext.put("key2","value2");
  root.debug("filled mdc");
  ThreadContext.put("ipAddress","192.168.0.120");
  ThreadContext.put("locale",Locale.US.getDisplayName());
  try {
    final StructuredDataMessage msg=new StructuredDataMessage("Transfer@18060","Transfer Complete","Audit");
    msg.put("ToAccount","123456");
    msg.put("FromAccount","123457");
    msg.put("Amount","200.00");
    root.info(MarkerManager.getMarker("EVENT"),msg);
    List<String> list=appender.getMessages();
    assertTrue("Expected line 1 to end with: " + line1 + " Actual "+ list.get(0),list.get(0).endsWith(line1));
    assertTrue("Expected line 2 to end with: " + line2 + " Actual "+ list.get(1),list.get(1).endsWith(line2));
    assertTrue("Expected line 3 to end with: " + line3 + " Actual "+ list.get(2),list.get(2).endsWith(line3));
    assertTrue("Expected line 4 to end with: " + line4 + " Actual "+ list.get(3),list.get(3).endsWith(line4));
    for (    final String frame : list) {
      int length=-1;
      final int frameLength=frame.length();
      final int firstSpacePosition=frame.indexOf(' ');
      final String messageLength=frame.substring(0,firstSpacePosition);
      try {
        length=Integer.parseInt(messageLength);
        assertEquals(frameLength,messageLength.length() + length);
      }
 catch (      final NumberFormatException e) {
        assertTrue("Not a valid RFC 5425 frame",false);
      }
    }
    appender.clear();
    ThreadContext.remove("loginId");
    root.debug("This is a test");
    list=appender.getMessages();
    assertTrue("No messages expected, found " + list.size(),list.isEmpty());
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<pre class="type-6 type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSubstituteStructuredData(){
  final String mdcId="RequestContext";
  final String expectedToContain="ATM - MSG-ID - Message";
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,false,mdcId,null,null,true,null,"ATM","MSG-ID","key1, key2, locale",null,null,null,false,null,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  root.info("Message");
  try {
    final List<String> list=appender.getMessages();
    assertTrue("Not enough list entries",list.size() > 0);
    final String message=list.get(0);
    Assert.assertTrue("Not the expected message received",message.contains(expectedToContain));
    appender.clear();
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<pre class="type-6 type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test case for MDC logger field inclusion.
 */
@Test public void testMDCLoggerFields() throws Exception {
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final LoggerFields[] loggerFields=new LoggerFields[]{LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("source","%C.%M")},null,null,false),LoggerFields.createLoggerFields(new KeyValuePair[]{new KeyValuePair("source2","%C.%M")},null,null,false)};
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,"RequestContext",null,null,true,null,"ATM",null,"key1, key2, locale",null,null,null,true,loggerFields,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  root.info("starting logger fields test");
  try {
    final List<String> list=appender.getMessages();
    assertTrue("Not enough list entries",list.size() > 0);
    assertTrue("No class/method",list.get(0).contains("Rfc5424LayoutTest.testMDCLoggerFields"));
    appender.clear();
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<pre class="type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test case for escaping newlines and other SD PARAM-NAME special characters.
 */
@Test public void testEscape() throws Exception {
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,"RequestContext",null,null,true,"#012","ATM",null,"key1, key2, locale",null,"loginId",null,true,null,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  ThreadContext.put("loginId","JohnDoe");
  root.debug("starting mdc pattern test");
  root.debug("empty mdc");
  ThreadContext.put("escaped","Testing escaping \n \" ] \"");
  root.debug("filled mdc");
  ThreadContext.put("ipAddress","192.168.0.120");
  ThreadContext.put("locale",Locale.US.getDisplayName());
  try {
    final StructuredDataMessage msg=new StructuredDataMessage("Transfer@18060","Transfer Complete","Audit");
    msg.put("ToAccount","123456");
    msg.put("FromAccount","123457");
    msg.put("Amount","200.00");
    root.info(MarkerManager.getMarker("EVENT"),msg);
    List<String> list=appender.getMessages();
    assertTrue("Expected line 1 to end with: " + line1 + " Actual "+ list.get(0),list.get(0).endsWith(line1));
    assertTrue("Expected line 2 to end with: " + line2 + " Actual "+ list.get(1),list.get(1).endsWith(line2));
    assertTrue("Expected line 3 to end with: " + lineEscaped3 + " Actual "+ list.get(2),list.get(2).endsWith(lineEscaped3));
    assertTrue("Expected line 4 to end with: " + lineEscaped4 + " Actual "+ list.get(3),list.get(3).endsWith(lineEscaped4));
    appender.clear();
    ThreadContext.remove("loginId");
    root.debug("This is a test");
    list=appender.getMessages();
    assertTrue("No messages expected, found " + list.size(),list.isEmpty());
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<pre class="type-6 type-5 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test case for MDC exception conversion pattern.
 */
@Test public void testException() throws Exception {
  for (  final Appender appender : root.getAppenders().values()) {
    root.removeAppender(appender);
  }
  final AbstractStringLayout layout=Rfc5424Layout.createLayout(Facility.LOCAL0,"Event",3692,true,"RequestContext",null,null,true,null,"ATM",null,"key1, key2, locale",null,"loginId","%xEx",true,null,null);
  final ListAppender appender=new ListAppender("List",null,layout,true,false);
  appender.start();
  root.addAppender(appender);
  root.setLevel(Level.DEBUG);
  ThreadContext.put("loginId","JohnDoe");
  root.debug("starting mdc pattern test",new IllegalArgumentException("Test"));
  try {
    final List<String> list=appender.getMessages();
    assertTrue("Not enough list entries",list.size() > 1);
    final String string=list.get(1);
    assertTrue("No Exception in " + string,string.contains("IllegalArgumentException"));
    appender.clear();
  }
  finally {
    root.removeAppender(appender);
    ThreadContext.clearMap();
    appender.stop();
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
