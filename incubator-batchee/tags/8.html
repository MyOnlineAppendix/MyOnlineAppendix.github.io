<h3><span class=" glyphicon glyphicon-tag"/>&nbspConditionMatcher</h3><kbd>Verifies logic rules using matcher-style statements</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.batchee.cli.MainTest </h4><pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void instances(){
  final JobOperator jobOperator=BatchRuntime.getJobOperator();
  final long id=jobOperator.start("sample",null);
  main(new String[]{"instances","-name","sample"});
  assertThat(stdout.getLog(),containsString("sample has"));
  assertThat(stdout.getLog(),containsString("instance id"));
  Batches.waitForEnd(jobOperator,id);
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void startAndFail(){
  main(new String[]{"start","-name","sample","status=fail"});
  assertThat(stdout.getLog(),containsString("Batch 'sample' started with id #"));
  assertThat(stdout.getLog(),containsString("Batch status: FAILED"));
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void status(){
  final JobOperator jobOperator=BatchRuntime.getJobOperator();
  final long id=jobOperator.start("sample",null);
  main(new String[]{"status"});
  assertThat(stdout.getLog(),containsString("sample\t|"));
  assertThat(stdout.getLog(),containsString("COMPLETED"));
  Batches.waitForEnd(jobOperator,id);
}

</code></pre>

<br>
<pre class="type-1 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void user(){
  for (int i=1; i < 3; i++) {
    main(new String[]{"user" + i});
    assertThat(stdout.getLog(),containsString("User " + i + " called"));
  }
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void start(){
  main(new String[]{"start","-name","sample"});
  assertThat(stdout.getLog(),containsString("Batch 'sample' started with id #"));
  assertThat(stdout.getLog(),containsString("Batch status: COMPLETED"));
}

</code></pre>

<br>
<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void emptyRunning(){
  main(new String[]{"running"});
  assertThat(stdout.getLog(),containsString("No job started"));
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void restart(){
  main(new String[]{"start","-name","sample","status=fail"});
  final String str="Batch 'sample' started with id #";
  assertThat(stdout.getLog(),containsString(str));
  final int idx=stdout.getLog().indexOf(str);
  final int end=stdout.getLog().indexOf(System.getProperty("line.separator"),idx);
  final String id=stdout.getLog().substring(idx + str.length(),end);
  main(new String[]{"restart","-id",id,"status=ok"});
  assertThat(stdout.getLog(),containsString(str));
  assertThat(stdout.getLog(),containsString("Batch status: COMPLETED"));
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void stop(){
  final Thread start=new Thread(){
    @Override public void run(){
      main(new String[]{"start","-name","long-sample","-socket","1236","-wait","false"});
    }
  }
;
  start.run();
  final String str="Batch 'long-sample' started with id #";
  final String out=stdout.getLog();
  int idx;
  do {
    idx=out.indexOf(str);
  }
 while (idx < 0);
  final int end=out.lastIndexOf(System.getProperty("line.separator"));
  final long id=Long.parseLong(out.substring(idx + str.length(),end));
  main(new String[]{"stop","-id",Long.toString(id),"-socket","1236"});
  assertThat(stdout.getLog(),containsString("Stopped"));
  Batches.waitForEnd(id);
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void stepExecutions(){
  final JobOperator jobOperator=BatchRuntime.getJobOperator();
  final long id=jobOperator.start("sample",null);
  Batches.waitForEnd(jobOperator,id);
  main(new String[]{"stepExecutions","-id",Long.toString(id)});
  assertThat(stdout.getLog(),containsString("step id\t|\t step name\t|\t    start time   \t|\t     end time    \t|\t" + "exit status\t|\tbatch status\t|\t" + "READ_COUNT\t|\tWRITE_COUNT\t|\tCOMMIT_COUNT\t|\tROLLBACK_COUNT\t|\tREAD_SKIP_COUNT\t|\t"+ "PROCESS_SKIP_COUNT\t|\tFILTER_COUNT\t|\tWRITE_SKIP_COUNT"));
  assertThat(stdout.getLog(),containsString("OK"));
  assertThat(stdout.getLog(),containsString("sample-step"));
  assertThat(stdout.getLog(),containsString("COMPLETED"));
}

</code></pre>

<br>
<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void running(){
  final JobOperator jobOperator=BatchRuntime.getJobOperator();
  final long id=jobOperator.start("long-sample",null);
  try {
    sleep(100);
  }
 catch (  final InterruptedException e) {
    Thread.interrupted();
  }
  main(new String[]{"running"});
  assertThat(stdout.getLog(),containsString("long-sample -> ["));
  Batches.waitForEnd(jobOperator,id);
}

</code></pre>

<br>
<pre class="type-3 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void executions(){
  final JobOperator jobOperator=BatchRuntime.getJobOperator();
  final long id=jobOperator.start("sample",null);
  Batches.waitForEnd(jobOperator,id);
  main(new String[]{"executions","-id",Long.toString(id)});
  assertThat(stdout.getLog(),containsString("Executions of sample for instance " + id));
  assertThat(stdout.getLog(),containsString("COMPLETED"));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
