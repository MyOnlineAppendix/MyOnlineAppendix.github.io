<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestAccumuloHiveRow </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasFamilyAndQualifier(){
  AccumuloHiveRow row=new AccumuloHiveRow("row1");
  for (int i=1; i <= 5; i++) {
    row.add("cf1","cq" + i,Integer.toString(i).getBytes());
  }
  assertFalse(row.hasFamAndQual(new Text(""),new Text("")));
  assertFalse(row.hasFamAndQual(new Text("cf0"),new Text("cq1")));
  assertFalse(row.hasFamAndQual(new Text("cf1"),new Text("cq0")));
  for (int i=1; i <= 5; i++) {
    assertTrue(row.hasFamAndQual(new Text("cf1"),new Text("cq" + i)));
  }
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetValueFromColumn(){
  AccumuloHiveRow row=new AccumuloHiveRow("row1");
  assertNull(row.getValue(new Text(""),new Text("")));
  for (int i=1; i <= 5; i++) {
    row.add("cf","cq" + i,Integer.toString(i).getBytes());
  }
  assertNull(row.getValue(new Text("cf"),new Text("cq0")));
  for (int i=1; i <= 5; i++) {
    assertArrayEquals(Integer.toString(i).getBytes(),row.getValue(new Text("cf"),new Text("cq" + i)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.columns.TestColumnMapper </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalMapping() throws TooManyAccumuloColumnsException {
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  List<String> columnNames=Arrays.asList("row","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(rawMappings.size(),mappings.size());
  Assert.assertEquals(mappings.size(),mapper.size());
  Iterator<String> rawIter=rawMappings.iterator();
  Iterator<ColumnMapping> iter=mappings.iterator();
  for (int i=0; i < mappings.size() && iter.hasNext(); i++) {
    String rawMapping=rawIter.next();
    ColumnMapping mapping=iter.next();
    ColumnMapping mappingByOffset=mapper.get(i);
    Assert.assertEquals(mapping,mappingByOffset);
    if (AccumuloHiveConstants.ROWID.equals(rawMapping)) {
      Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mapping.getClass());
    }
 else {
      Assert.assertEquals(HiveAccumuloColumnMapping.class,mapping.getClass());
    }
  }
  Assert.assertEquals(0,mapper.getRowIdOffset());
  Assert.assertTrue(mapper.hasRowIdMapping());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetMappingFromHiveColumn() throws TooManyAccumuloColumnsException {
  List<String> hiveColumns=Arrays.asList("rowid","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),null,hiveColumns,columnTypes);
  for (int i=0; i < hiveColumns.size(); i++) {
    String hiveColumn=hiveColumns.get(i), accumuloMapping=rawMappings.get(i);
    ColumnMapping mapping=mapper.getColumnMappingForHiveColumn(hiveColumns,hiveColumn);
    Assert.assertEquals(accumuloMapping,mapping.getMappingSpec());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestPrimitiveComparisonFilter </h4><pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBase64ConstantEncode(){
  PrimitiveComparisonFilter filter=new PrimitiveComparisonFilter();
  Map<String,String> options=new HashMap<String,String>();
  for (int i=0; i < 500; i++) {
    String constant=Integer.toString(i);
    options.put(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64(constant.getBytes())));
    Assert.assertEquals(constant,new String(filter.getConstant(options)));
  }
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumericBase64ConstantEncode() throws IOException {
  PrimitiveComparisonFilter filter=new PrimitiveComparisonFilter();
  Map<String,String> options=new HashMap<String,String>();
  IntWritable writable=new IntWritable();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  for (int i=0; i < 500; i++) {
    writable.set(i);
    writable.write(out);
    options.put(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64(baos.toByteArray())));
    byte[] bytes=filter.getConstant(options);
    ByteArrayInputStream bais=new ByteArrayInputStream(bytes);
    DataInputStream in=new DataInputStream(bais);
    writable.readFields(in);
    Assert.assertEquals(i,writable.get());
    baos.reset();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestAccumuloSerDe </h4><pre class="type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompositeKeyDeserialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,field1");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"struct<col1:string,col2:string,col3:string>,string");
  properties.setProperty(DelimitedAccumuloRowIdFactory.ACCUMULO_COMPOSITE_DELIMITER,"_");
  properties.setProperty(AccumuloSerDeParameters.COMPOSITE_ROWID_FACTORY,DelimitedAccumuloRowIdFactory.class.getName());
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("p1_p2_p3");
  row.add("cf","f1","v1".getBytes());
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyStruct);
  LazyStruct struct=(LazyStruct)field0;
  List fields=struct.getFieldsAsList();
  assertEquals(3,fields.size());
  for (int i=0; i < fields.size(); i++) {
    assertEquals(LazyString.class,fields.get(i).getClass());
    assertEquals("p" + (i + 1),fields.get(i).toString());
  }
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue("Expected instance of LazyString but was " + field1.getClass(),field1 instanceof LazyString);
  assertEquals(field1.toString(),"v1");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArraySerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,array<string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  char separator=':';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("value1" + separator + "value2"+ separator+ "value3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyArray);
  LazyArray array=(LazyArray)field1;
  List values=array.getList();
  assertEquals(3,values.size());
  for (int i=0; i < 3; i++) {
    Object o=values.get(i);
    assertNotNull(o);
    assertTrue(o instanceof LazyString);
    assertEquals("value" + (i + 1),((LazyString)o).getWritableObject().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.TestValidReadTxnList </h4><pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void longEnoughToCompress() throws Exception {
  long[] exceptions=new long[1000];
  for (int i=0; i < 1000; i++)   exceptions[i]=i + 100;
  ValidTxnList txnList=new ValidReadTxnList(exceptions,2000);
  String str=txnList.writeToString();
  ValidTxnList newList=new ValidReadTxnList();
  newList.readFromString(str);
  for (int i=0; i < 100; i++)   Assert.assertTrue(newList.isTxnValid(i));
  for (int i=100; i < 1100; i++)   Assert.assertFalse(newList.isTxnValid(i));
  for (int i=1100; i < 2001; i++)   Assert.assertTrue(newList.isTxnValid(i));
  Assert.assertFalse(newList.isTxnValid(2001));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveVarchar </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testStringLength() throws Exception {
  int strLen=20;
  int[] lengths={15,20,25};
  for (int idx1=0; idx1 < lengths.length; ++idx1) {
    StringBuilder sb=new StringBuilder();
    int curLen=lengths[idx1];
    for (int idx2=0; idx2 < curLen; ++idx2) {
      sb.appendCodePoint(getRandomCodePoint(' '));
    }
    String testString=sb.toString();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  String[] testStrings={"abcdefg","abcdefghijklmnopqrst","abcdefghijklmnopqrstuvwxyz"};
  for (  String testString : testStrings) {
    int curLen=testString.length();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  HiveVarchar vc1=new HiveVarchar("0123456789",10);
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue("012345678901234");
  assertEquals(15,vc1.getCharacterLength());
  vc1.setValue("01234",-1);
  assertEquals(5,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("0123456789",-1));
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("01234",-1),-1);
  assertEquals(5,vc1.getCharacterLength());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestUnsignedInt128 </h4><pre class="type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiplyScaleDownTenDestructiveScaleTen(){
  for (int scale=0; scale < 38; ++scale) {
    UnsignedInt128 right=new UnsignedInt128(1);
    right.scaleUpTenDestructive((short)scale);
{
      UnsignedInt128 leftJust=new UnsignedInt128(1);
      leftJust.scaleUpTenDestructive((short)15);
      UnsignedInt128 leftInc=leftJust.incrementConstructive();
      UnsignedInt128 leftDec=leftJust.decrementConstructive();
      if (scale + 10 <= 38) {
        leftJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftJust.asLong());
        leftInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftInc.asLong());
        leftDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftDec.asLong());
      }
 else {
        leftJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftJust.asLong());
        leftInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftInc.asLong());
        leftDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftDec.asLong());
      }
    }
{
      UnsignedInt128 leftHalfJust=new UnsignedInt128(1);
      leftHalfJust.scaleUpTenDestructive((short)6);
      leftHalfJust.addDestructive(new UnsignedInt128(5));
      leftHalfJust.scaleUpTenDestructive((short)9);
      UnsignedInt128 leftHalfInc=leftHalfJust.incrementConstructive();
      UnsignedInt128 leftHalfDec=leftHalfJust.decrementConstructive();
      if (scale + 10 <= 38) {
        leftHalfJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100001L,leftHalfJust.asLong());
        leftHalfInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100001L,leftHalfInc.asLong());
        leftHalfDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftHalfDec.asLong());
      }
 else {
        leftHalfJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftHalfJust.asLong());
        leftHalfInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftHalfInc.asLong());
        leftHalfDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftHalfDec.asLong());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.conf.TestHiveConf </h4><pre class="type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testColumnNameMapping() throws Exception {
  for (int i=0; i < 20; i++) {
    Assert.assertTrue(i == HiveConf.getPositionFromInternalName(HiveConf.getColumnInternalName(i)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelCacheImpl </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testMTTWithCleanup(){
  final LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,1);
  final long fn1=1, fn2=2;
  final int offsetsToUse=8;
  final CountDownLatch cdlIn=new CountDownLatch(4), cdlOut=new CountDownLatch(1);
  final AtomicInteger rdmsDone=new AtomicInteger(0);
  Callable<Long> rdmCall=new Callable<Long>(){
    public Long call(){
      int gets=0, puts=0;
      try {
        Random rdm=new Random(1234 + Thread.currentThread().getId());
        syncThreadStart(cdlIn,cdlOut);
        for (int i=0; i < 20000; ++i) {
          boolean isGet=rdm.nextBoolean(), isFn1=rdm.nextBoolean();
          long fileName=isFn1 ? fn1 : fn2;
          int fileIndex=isFn1 ? 1 : 2;
          int count=rdm.nextInt(offsetsToUse);
          if (isGet) {
            int[] offsets=new int[count];
            count=generateOffsets(offsetsToUse,rdm,offsets);
            CreateHelper list=new CreateHelper();
            for (int j=0; i < count; ++i) {
              list.addOrMerge(offsets[j],offsets[j] + 1,true,false);
            }
            DiskRangeList iter=cache.getFileData(fileName,list.get(),0,testFactory,null,null);
            int j=-1;
            while (iter != null) {
              ++j;
              if (!(iter instanceof CacheChunk)) {
                iter=iter.next;
                continue;
              }
              ++gets;
              LlapDataBuffer result=(LlapDataBuffer)((CacheChunk)iter).getBuffer();
              assertEquals(makeFakeArenaIndex(fileIndex,offsets[j]),result.arenaIndex);
              cache.decRefBuffer(result);
              iter=iter.next;
            }
          }
 else {
            DiskRange[] ranges=new DiskRange[count];
            int[] offsets=new int[count];
            for (int j=0; j < count; ++j) {
              int next=rdm.nextInt(offsetsToUse);
              ranges[j]=dr(next,next + 1);
              offsets[j]=next;
            }
            MemoryBuffer[] buffers=new MemoryBuffer[count];
            for (int j=0; j < offsets.length; ++j) {
              LlapDataBuffer buf=LowLevelCacheImpl.allocateFake();
              buf.arenaIndex=makeFakeArenaIndex(fileIndex,offsets[j]);
              buffers[j]=buf;
            }
            long[] mask=cache.putFileData(fileName,ranges,buffers,0,Priority.NORMAL,null);
            puts+=buffers.length;
            long maskVal=0;
            if (mask != null) {
              assertEquals(1,mask.length);
              maskVal=mask[0];
            }
            for (int j=0; j < offsets.length; ++j) {
              LlapDataBuffer buf=(LlapDataBuffer)(buffers[j]);
              if ((maskVal & 1) == 1) {
                assertEquals(makeFakeArenaIndex(fileIndex,offsets[j]),buf.arenaIndex);
              }
              maskVal>>=1;
              cache.decRefBuffer(buf);
            }
          }
        }
      }
  finally {
        rdmsDone.incrementAndGet();
      }
      return (((long)gets) << 32) | puts;
    }
    private int makeFakeArenaIndex(    int fileIndex,    long offset){
      return (int)((fileIndex << 16) + offset);
    }
  }
;
  FutureTask<Integer> evictionTask=new FutureTask<Integer>(new Callable<Integer>(){
    public Integer call(){
      boolean isFirstFile=false;
      Random rdm=new Random(1234 + Thread.currentThread().getId());
      int evictions=0;
      syncThreadStart(cdlIn,cdlOut);
      while (rdmsDone.get() < 3) {
        DiskRangeList head=new DiskRangeList(0,offsetsToUse + 1);
        isFirstFile=!isFirstFile;
        long fileId=isFirstFile ? fn1 : fn2;
        head=cache.getFileData(fileId,head,0,testFactory,null,null);
        DiskRange[] results=head.listToArray();
        int startIndex=rdm.nextInt(results.length), index=startIndex;
        LlapDataBuffer victim=null;
        do {
          DiskRange r=results[index];
          if (r instanceof CacheChunk) {
            LlapDataBuffer result=(LlapDataBuffer)((CacheChunk)r).getBuffer();
            cache.decRefBuffer(result);
            if (victim == null && result.invalidate()) {
              ++evictions;
              victim=result;
            }
          }
          ++index;
          if (index == results.length)           index=0;
        }
 while (index != startIndex);
        if (victim == null)         continue;
        cache.notifyEvicted(victim);
      }
      return evictions;
    }
  }
);
  FutureTask<Long> rdmTask1=new FutureTask<Long>(rdmCall), rdmTask2=new FutureTask<Long>(rdmCall), rdmTask3=new FutureTask<Long>(rdmCall);
  Executor threadPool=Executors.newFixedThreadPool(4);
  threadPool.execute(rdmTask1);
  threadPool.execute(rdmTask2);
  threadPool.execute(rdmTask3);
  threadPool.execute(evictionTask);
  try {
    cdlIn.await();
    cdlOut.countDown();
    long result1=rdmTask1.get(), result2=rdmTask2.get(), result3=rdmTask3.get();
    int evictions=evictionTask.get();
    LOG.info("MTT test: task 1: " + descRdmTask(result1) + ", task 2: "+ descRdmTask(result2)+ ", task 3: "+ descRdmTask(result3)+ "; "+ evictions+ " evictions");
  }
 catch (  Throwable t) {
    throw new RuntimeException(t);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelLrfuCachePolicy </h4><pre class="type-11 type-6 type-4 type-5 type-14 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeadlockResolution(){
  int heapSize=4;
  LOG.info("Testing deadlock resolution");
  ArrayList<LlapDataBuffer> inserted=new ArrayList<LlapDataBuffer>(heapSize);
  EvictionTracker et=new EvictionTracker();
  Configuration conf=new Configuration();
  LowLevelLrfuCachePolicy lrfu=new LowLevelLrfuCachePolicy(1,heapSize,conf);
  LowLevelCacheMemoryManager mm=new LowLevelCacheMemoryManager(heapSize,lrfu,LlapDaemonCacheMetrics.create("test","1"));
  lrfu.setEvictionListener(et);
  for (int i=0; i < heapSize; ++i) {
    LlapDataBuffer buffer=LowLevelCacheImpl.allocateFake();
    assertTrue(cache(mm,lrfu,et,buffer));
    inserted.add(buffer);
  }
  LlapDataBuffer locked=inserted.get(0);
  lock(lrfu,locked);
  mm.reserveMemory(1,false);
  LlapDataBuffer evicted=et.evicted.get(0);
  assertNotNull(evicted);
  assertTrue(evicted.isInvalid());
  assertNotSame(locked,evicted);
  unlock(lrfu,locked);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLruExtreme(){
  int heapSize=4;
  LOG.info("Testing lambda 1 (LRU)");
  Random rdm=new Random(1234);
  Configuration conf=new Configuration();
  ArrayList<LlapDataBuffer> inserted=new ArrayList<LlapDataBuffer>(heapSize);
  conf.setFloat(HiveConf.ConfVars.LLAP_LRFU_LAMBDA.varname,1.0f);
  EvictionTracker et=new EvictionTracker();
  LowLevelLrfuCachePolicy lru=new LowLevelLrfuCachePolicy(1,heapSize,conf);
  LowLevelCacheMemoryManager mm=new LowLevelCacheMemoryManager(heapSize,lru,LlapDaemonCacheMetrics.create("test","1"));
  lru.setEvictionListener(et);
  for (int i=0; i < heapSize; ++i) {
    LlapDataBuffer buffer=LowLevelCacheImpl.allocateFake();
    assertTrue(cache(mm,lru,et,buffer));
    inserted.add(buffer);
  }
  Collections.shuffle(inserted,rdm);
  for (int i=0; i < inserted.size(); ++i) {
    for (int j=0; j < (inserted.size() - i); ++j) {
      lru.notifyLock(inserted.get(i));
      lru.notifyUnlock(inserted.get(i));
    }
  }
  verifyOrder(mm,lru,et,inserted,null);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLfuExtreme(){
  int heapSize=4;
  LOG.info("Testing lambda 0 (LFU)");
  Random rdm=new Random(1234);
  Configuration conf=new Configuration();
  ArrayList<LlapDataBuffer> inserted=new ArrayList<LlapDataBuffer>(heapSize);
  conf.setFloat(HiveConf.ConfVars.LLAP_LRFU_LAMBDA.varname,0.0f);
  EvictionTracker et=new EvictionTracker();
  LowLevelLrfuCachePolicy lfu=new LowLevelLrfuCachePolicy(1,heapSize,conf);
  LowLevelCacheMemoryManager mm=new LowLevelCacheMemoryManager(heapSize,lfu,LlapDaemonCacheMetrics.create("test","1"));
  lfu.setEvictionListener(et);
  for (int i=0; i < heapSize; ++i) {
    LlapDataBuffer buffer=LowLevelCacheImpl.allocateFake();
    assertTrue(cache(mm,lfu,et,buffer));
    inserted.add(buffer);
  }
  Collections.shuffle(inserted,rdm);
  for (int i=inserted.size() - 1; i >= 0; --i) {
    for (int j=0; j < i + 1; ++j) {
      lfu.notifyLock(inserted.get(i));
      lfu.notifyUnlock(inserted.get(i));
    }
  }
  verifyOrder(mm,lfu,et,inserted,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.daemon.impl.TestQueryIdentifier </h4><pre class="type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=5000) public void testEquality(){
  String appIdString1="app1";
  String appIdString2="app2";
  int dagId1=1;
  int dagId2=2;
  QueryIdentifier[] queryIdentifiers=new QueryIdentifier[4];
  queryIdentifiers[0]=new QueryIdentifier(appIdString1,dagId1);
  queryIdentifiers[1]=new QueryIdentifier(appIdString1,dagId2);
  queryIdentifiers[2]=new QueryIdentifier(appIdString2,dagId1);
  queryIdentifiers[3]=new QueryIdentifier(appIdString2,dagId2);
  for (int i=0; i < 4; i++) {
    for (int j=0; j < 4; j++) {
      if (i == j) {
        assertEquals(queryIdentifiers[i],queryIdentifiers[j]);
      }
 else {
        assertNotEquals(queryIdentifiers[i],queryIdentifiers[j]);
      }
    }
  }
  QueryIdentifier q11=new QueryIdentifier(appIdString1,dagId1);
  QueryIdentifier q12=new QueryIdentifier(appIdString1,dagId2);
  QueryIdentifier q21=new QueryIdentifier(appIdString2,dagId1);
  QueryIdentifier q22=new QueryIdentifier(appIdString2,dagId2);
  assertEquals(queryIdentifiers[0],q11);
  assertEquals(queryIdentifiers[1],q12);
  assertEquals(queryIdentifiers[2],q21);
  assertEquals(queryIdentifiers[3],q22);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs </h4><pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to confirm that partitions can be added using PartitionSpecs.
 */
@Test public void testAddPartitions(){
  try {
    HiveMetaStoreClient hmsc=new HiveMetaStoreClient(hiveConf);
    clearAndRecreateDB(hmsc);
    createTable(hmsc,true);
    Table table=hmsc.getTable(dbName,tableName);
    populatePartitions(hmsc,table,Arrays.asList("isLocatedInTablePath","isLocatedOutsideTablePath"));
    String targetTableName="cloned_" + tableName;
    Table targetTable=new Table(table);
    targetTable.setTableName(targetTableName);
    StorageDescriptor targetTableSd=new StorageDescriptor(targetTable.getSd());
    targetTableSd.setLocation(targetTableSd.getLocation().replace(tableName,targetTableName));
    hmsc.createTable(targetTable);
    PartitionSpecProxy partitionsForAddition=hmsc.listPartitionSpecsByFilter(dbName,tableName,"blurb = \"isLocatedInTablePath\"",-1);
    partitionsForAddition.setTableName(targetTableName);
    partitionsForAddition.setRootLocation(targetTableSd.getLocation());
    Assert.assertEquals("Unexpected number of partitions added. ",partitionsForAddition.size(),hmsc.add_partitions_pspec(partitionsForAddition));
    PartitionSpecProxy clonedPartitions=hmsc.listPartitionSpecs(dbName,targetTableName,-1);
    Assert.assertEquals("Unexpected number of partitions returned. ",partitionsForAddition.size(),clonedPartitions.size());
    PartitionSpecProxy.PartitionIterator sourceIterator=partitionsForAddition.getPartitionIterator(), targetIterator=clonedPartitions.getPartitionIterator();
    while (targetIterator.hasNext()) {
      Partition sourcePartition=sourceIterator.next(), targetPartition=targetIterator.next();
      Assert.assertEquals("Mismatched values.",sourcePartition.getValues(),targetPartition.getValues());
      Assert.assertEquals("Mismatched locations.",sourcePartition.getSd().getLocation(),targetPartition.getSd().getLocation());
    }
  }
 catch (  Throwable t) {
    LOG.error("Unexpected Exception!",t);
    t.printStackTrace();
    Assert.assertTrue("Unexpected Exception!",false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseImport </h4><pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importSecurity() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"securitydb1","securitydb2"};
  String[] roles=new String[]{"securityrole1","securityrole2"};
  String[] tokenIds=new String[]{"securitytokenid1","securitytokenid2"};
  String[] tokens=new String[]{"securitytoken1","securitytoken2"};
  String[] masterKeys=new String[]{"securitymk1","securitymk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  HBaseImport importer=new HBaseImport("-k");
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Assert.assertEquals(baseNumDbs,store.getAllDatabases().size());
  for (int i=0; i < tokenIds.length; i++) {
    Assert.assertEquals(tokens[i],store.getToken(tokenIds[i]));
  }
  String[] hbaseKeys=store.getMasterKeys();
  Set<String> keys=new HashSet<>(Arrays.asList(hbaseKeys));
  for (int i=0; i < masterKeys.length; i++) {
    Assert.assertTrue(keys.contains(masterKeys[i]));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importAll() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"alldb1","alldb2"};
  String[] roles=new String[]{"allrole1","allrole2"};
  String[] tokenIds=new String[]{"alltokenid1","alltokenid2"};
  String[] tokens=new String[]{"alltoken1","alltoken2"};
  String[] masterKeys=new String[]{"allmk1","allmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  HBaseImport importer=new HBaseImport("-a");
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < roles.length; i++) {
    Role role=store.getRole(roles[i]);
    Assert.assertNotNull(role);
    Assert.assertEquals(roles[i],role.getRoleName());
  }
  Assert.assertEquals(baseNumRoles + 2,store.listRoleNames().size());
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    Assert.assertEquals("file:/tmp",db.getLocationUri());
    Table table=store.getTable(db.getName(),tableNames[0]);
    Assert.assertNotNull(table);
    Assert.assertEquals(now,table.getLastAccessTime());
    Assert.assertEquals("input",table.getSd().getInputFormat());
    table=store.getTable(db.getName(),tableNames[1]);
    Assert.assertNotNull(table);
    for (int j=0; j < partVals.length; j++) {
      Partition part=store.getPartition(dbNames[i],tableNames[1],Arrays.asList(partVals[j]));
      Assert.assertNotNull(part);
      Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
    }
    Assert.assertEquals(4,store.getPartitions(dbNames[i],tableNames[1],-1).size());
    Assert.assertEquals(2,store.getAllTables(dbNames[i]).size());
    Assert.assertEquals(2,store.getFunctions(dbNames[i],"*").size());
    for (int j=0; j < funcNames.length; j++) {
      Assert.assertNotNull(store.getFunction(dbNames[i],funcNames[j]));
    }
  }
  Assert.assertEquals(baseNumDbs + 2,store.getAllDatabases().size());
  for (int i=0; i < tokenIds.length; i++) {
    Assert.assertEquals(tokens[i],store.getToken(tokenIds[i]));
  }
  String[] hbaseKeys=store.getMasterKeys();
  Set<String> keys=new HashSet<>(Arrays.asList(hbaseKeys));
  for (int i=0; i < masterKeys.length; i++) {
    Assert.assertTrue(keys.contains(masterKeys[i]));
  }
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parallel() throws Exception {
  int parallelFactor=10;
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"paralleldb1"};
  int now=(int)System.currentTimeMillis() / 1000;
  for (int i=0; i < dbNames.length; i++) {
    rdbms.createDatabase(new Database(dbNames[i],"no description","file:/tmp",emptyParameters));
    List<FieldSchema> cols=new ArrayList<>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    List<FieldSchema> partCols=new ArrayList<>();
    partCols.add(new FieldSchema("region","string",""));
    for (int j=0; j < parallelFactor; j++) {
      rdbms.createTable(new Table("t" + j,dbNames[i],"me",now,now,0,sd,partCols,emptyParameters,null,null,null));
      for (int k=0; k < parallelFactor; k++) {
        StorageDescriptor psd=new StorageDescriptor(sd);
        psd.setLocation("file:/tmp/region=" + k);
        Partition part=new Partition(Arrays.asList("p" + k),dbNames[i],"t" + j,now,now,psd,emptyParameters);
        rdbms.addPartition(part);
      }
    }
  }
  HBaseImport importer=new HBaseImport("-p","2","-b","2","-d",dbNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    for (int j=0; j < parallelFactor; j++) {
      Table table=store.getTable(db.getName(),"t" + j);
      Assert.assertNotNull(table);
      Assert.assertEquals(now,table.getLastAccessTime());
      Assert.assertEquals("input",table.getSd().getInputFormat());
      for (int k=0; k < parallelFactor; k++) {
        Partition part=store.getPartition(dbNames[i],"t" + j,Arrays.asList("p" + k));
        Assert.assertNotNull(part);
        Assert.assertEquals("file:/tmp/region=" + k,part.getSd().getLocation());
      }
      Assert.assertEquals(parallelFactor,store.getPartitions(dbNames[i],"t" + j,-1).size());
    }
    Assert.assertEquals(parallelFactor,store.getAllTables(dbNames[i]).size());
  }
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneTablePartitioned() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onetabpartdb1","onetabpartodb2"};
  String[] roles=new String[]{"onetabpartorole1","onetabpartorole2"};
  String[] tokenIds=new String[]{"onetabpartotokenid1","onetabpartotokenid2"};
  String[] tokens=new String[]{"onetabpartotoken1","onetabpartotoken2"};
  String[] masterKeys=new String[]{"onetabpartomk1","onetabpartomk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-t",dbNames[0] + "." + tableNames[1]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Table table=store.getTable(db.getName(),tableNames[1]);
  Assert.assertNotNull(table);
  Assert.assertEquals(1,store.getAllTables(db.getName()).size());
  for (int j=0; j < partVals.length; j++) {
    Partition part=store.getPartition(dbNames[0],tableNames[1],Arrays.asList(partVals[j]));
    Assert.assertNotNull(part);
    Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
  }
  Assert.assertEquals(4,store.getPartitions(dbNames[0],tableNames[1],-1).size());
  Assert.assertNull(store.getTable(db.getName(),tableNames[0]));
  Assert.assertEquals(0,store.getFunctions(dbNames[0],"*").size());
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneDb() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onedbdb1","onedbdb2"};
  String[] roles=new String[]{"onedbrole1","onedbrole2"};
  String[] tokenIds=new String[]{"onedbtokenid1","onedbtokenid2"};
  String[] tokens=new String[]{"onedbtoken1","onedbtoken2"};
  String[] masterKeys=new String[]{"onedbmk1","onedbmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  HBaseImport importer=new HBaseImport("-d",dbNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Assert.assertEquals("file:/tmp",db.getLocationUri());
  Table table=store.getTable(db.getName(),tableNames[0]);
  Assert.assertNotNull(table);
  Assert.assertEquals(now,table.getLastAccessTime());
  Assert.assertEquals("input",table.getSd().getInputFormat());
  table=store.getTable(db.getName(),tableNames[1]);
  Assert.assertNotNull(table);
  for (int j=0; j < partVals.length; j++) {
    Partition part=store.getPartition(dbNames[0],tableNames[1],Arrays.asList(partVals[j]));
    Assert.assertNotNull(part);
    Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
  }
  Assert.assertEquals(4,store.getPartitions(dbNames[0],tableNames[1],-1).size());
  Assert.assertEquals(2,store.getAllTables(dbNames[0]).size());
  Assert.assertEquals(2,store.getFunctions(dbNames[0],"*").size());
  for (int j=0; j < funcNames.length; j++) {
    Assert.assertNotNull(store.getFunction(dbNames[0],funcNames[j]));
  }
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
  thrown.expect(NoSuchObjectException.class);
  store.getDatabase(dbNames[1]);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parallelOdd() throws Exception {
  int parallelFactor=9;
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"oddparalleldb1"};
  int now=(int)System.currentTimeMillis() / 1000;
  for (int i=0; i < dbNames.length; i++) {
    rdbms.createDatabase(new Database(dbNames[i],"no description","file:/tmp",emptyParameters));
    List<FieldSchema> cols=new ArrayList<>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    List<FieldSchema> partCols=new ArrayList<>();
    partCols.add(new FieldSchema("region","string",""));
    for (int j=0; j < parallelFactor; j++) {
      rdbms.createTable(new Table("t" + j,dbNames[i],"me",now,now,0,sd,partCols,emptyParameters,null,null,null));
      for (int k=0; k < parallelFactor; k++) {
        StorageDescriptor psd=new StorageDescriptor(sd);
        psd.setLocation("file:/tmp/region=" + k);
        Partition part=new Partition(Arrays.asList("p" + k),dbNames[i],"t" + j,now,now,psd,emptyParameters);
        rdbms.addPartition(part);
      }
    }
  }
  HBaseImport importer=new HBaseImport("-p","2","-b","2","-d",dbNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    for (int j=0; j < parallelFactor; j++) {
      Table table=store.getTable(db.getName(),"t" + j);
      Assert.assertNotNull(table);
      Assert.assertEquals(now,table.getLastAccessTime());
      Assert.assertEquals("input",table.getSd().getInputFormat());
      for (int k=0; k < parallelFactor; k++) {
        Partition part=store.getPartition(dbNames[i],"t" + j,Arrays.asList("p" + k));
        Assert.assertNotNull(part);
        Assert.assertEquals("file:/tmp/region=" + k,part.getSd().getLocation());
      }
      Assert.assertEquals(parallelFactor,store.getPartitions(dbNames[i],"t" + j,-1).size());
    }
    Assert.assertEquals(parallelFactor,store.getAllTables(dbNames[i]).size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreIntegration </h4><pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void partitionStatistics() throws Exception {
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statspart";
  String[] partNames={"ds=today","ds=yesterday"};
  String[] partVals={"today","yesterday"};
  String boolcol="boolcol";
  String longcol="longcol";
  String doublecol="doublecol";
  String stringcol="stringcol";
  String binarycol="bincol";
  String decimalcol="deccol";
  long trues=37;
  long falses=12;
  long booleanNulls=2;
  long strMaxLen=1234;
  double strAvgLen=32.3;
  long strNulls=987;
  long strDVs=906;
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema(boolcol,"boolean","nocomment"));
  cols.add(new FieldSchema(longcol,"long","nocomment"));
  cols.add(new FieldSchema(doublecol,"double","nocomment"));
  cols.add(new FieldSchema(stringcol,"varchar(32)","nocomment"));
  cols.add(new FieldSchema(binarycol,"binary","nocomment"));
  cols.add(new FieldSchema(decimalcol,"decimal(5, 3)","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  Table table=new Table(tableName,dbname,"me",(int)now / 1000,(int)now / 1000,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  for (  String partVal : partVals) {
    Partition part=new Partition(Arrays.asList(partVal),dbname,tableName,(int)now / 1000,(int)now / 1000,sd,emptyParameters);
    store.addPartition(part);
  }
  for (int i=0; i < partNames.length; i++) {
    ColumnStatistics stats=new ColumnStatistics();
    ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
    desc.setLastAnalyzed(now);
    desc.setDbName(dbname);
    desc.setTableName(tableName);
    desc.setIsTblLevel(false);
    desc.setPartName(partNames[i]);
    stats.setStatsDesc(desc);
    ColumnStatisticsObj obj=new ColumnStatisticsObj();
    obj.setColName(boolcol);
    obj.setColType("boolean");
    ColumnStatisticsData data=new ColumnStatisticsData();
    BooleanColumnStatsData boolData=new BooleanColumnStatsData();
    boolData.setNumTrues(trues);
    boolData.setNumFalses(falses);
    boolData.setNumNulls(booleanNulls);
    data.setBooleanStats(boolData);
    obj.setStatsData(data);
    stats.addToStatsObj(obj);
    store.updatePartitionColumnStatistics(stats,Arrays.asList(partVals[i]));
  }
  List<ColumnStatistics> statsList=store.getPartitionColumnStatistics(dbname,tableName,Arrays.asList(partNames),Arrays.asList(boolcol));
  Assert.assertEquals(2,statsList.size());
  for (int i=0; i < partNames.length; i++) {
    Assert.assertEquals(1,statsList.get(i).getStatsObjSize());
  }
  for (int i=0; i < partNames.length; i++) {
    ColumnStatistics stats=new ColumnStatistics();
    ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
    desc.setLastAnalyzed(now);
    desc.setDbName(dbname);
    desc.setTableName(tableName);
    desc.setIsTblLevel(false);
    desc.setPartName(partNames[i]);
    stats.setStatsDesc(desc);
    ColumnStatisticsObj obj=new ColumnStatisticsObj();
    obj.setColName(stringcol);
    obj.setColType("string");
    ColumnStatisticsData data=new ColumnStatisticsData();
    StringColumnStatsData strData=new StringColumnStatsData();
    strData.setMaxColLen(strMaxLen);
    strData.setAvgColLen(strAvgLen);
    strData.setNumNulls(strNulls);
    strData.setNumDVs(strDVs);
    data.setStringStats(strData);
    obj.setStatsData(data);
    stats.addToStatsObj(obj);
    store.updatePartitionColumnStatistics(stats,Arrays.asList(partVals[i]));
  }
  statsList=store.getPartitionColumnStatistics(dbname,tableName,Arrays.asList(partNames),Arrays.asList(boolcol));
  Assert.assertEquals(2,statsList.size());
  for (int i=0; i < partNames.length; i++) {
    Assert.assertEquals(1,statsList.get(i).getStatsObjSize());
  }
  statsList=store.getPartitionColumnStatistics(dbname,tableName,Arrays.asList(partNames),Arrays.asList(boolcol,stringcol));
  Assert.assertEquals(2,statsList.size());
  for (int i=0; i < partNames.length; i++) {
    Assert.assertEquals(2,statsList.get(i).getStatsObjSize());
    Assert.assertEquals(booleanNulls,statsList.get(i).getStatsObj().get(0).getStatsData().getBooleanStats().getNumNulls());
    Assert.assertEquals(strDVs,statsList.get(i).getStatsObj().get(1).getStatsData().getStringStats().getNumDVs());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestTxnHandler </h4><pre class="type-6 type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void showLocks() throws Exception {
  long begining=System.currentTimeMillis();
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  txnid=openTxn();
  comp=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"mydb");
  comp.setTablename("mytable");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  components=new ArrayList<LockComponent>(1);
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.PARTITION,"yourdb");
  comp.setTablename("yourtable");
  comp.setPartitionname("yourpartition");
  components.add(comp);
  req=new LockRequest(components,"you","remotehost");
  res=txnHandler.lock(req);
  ShowLocksResponse rsp=txnHandler.showLocks(new ShowLocksRequest());
  List<ShowLocksResponseElement> locks=rsp.getLocks();
  assertEquals(3,locks.size());
  boolean[] saw=new boolean[locks.size()];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  ShowLocksResponseElement lock : locks) {
    if (lock.getLockid() == 1) {
      assertEquals(1,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertNull(lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.EXCLUSIVE,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertTrue("Expected acquired at " + lock.getAcquiredat() + " to be between "+ begining+ " and "+ System.currentTimeMillis(),begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[0]=true;
    }
 else     if (lock.getLockid() == 2) {
      assertEquals(2,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertEquals("mytable",lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.WAITING,lock.getState());
      assertEquals(LockType.SHARED_READ,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertEquals(0,lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[1]=true;
    }
 else     if (lock.getLockid() == 3) {
      assertEquals(0,lock.getTxnid());
      assertEquals("yourdb",lock.getDbname());
      assertEquals("yourtable",lock.getTablename());
      assertEquals("yourpartition",lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.SHARED_WRITE,lock.getType());
      assertTrue(lock.toString(),begining <= lock.getLastheartbeat() && System.currentTimeMillis() >= lock.getLastheartbeat());
      assertTrue(begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("you",lock.getUser());
      assertEquals("remotehost",lock.getHostname());
      saw[2]=true;
    }
 else {
      fail("Unknown lock id");
    }
  }
  for (int i=0; i < saw.length; i++)   assertTrue("Didn't see lock id " + i,saw[i]);
}

</code></pre>

<br>
<pre class="type-6 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeatLock() throws Exception {
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TXN_TIMEOUT,1,TimeUnit.SECONDS);
  HeartbeatRequest h=new HeartbeatRequest();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("mypartition");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  h.setLockid(res.getLockid());
  for (int i=0; i < 30; i++) {
    try {
      txnHandler.heartbeat(h);
    }
 catch (    NoSuchLockException e) {
      fail("Told there was no lock, when the heartbeat should have kept it.");
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortTxn() throws Exception {
  OpenTxnsResponse openedTxns=txnHandler.openTxns(new OpenTxnRequest(2,"me","localhost"));
  List<Long> txnList=openedTxns.getTxn_ids();
  long first=txnList.get(0);
  assertEquals(1L,first);
  long second=txnList.get(1);
  assertEquals(2L,second);
  txnHandler.abortTxn(new AbortTxnRequest(1));
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(2L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.ABORTED,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(2L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(2L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[3];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  for (int i=1; i < saw.length; i++)   assertTrue(saw[i]);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpenTxn() throws Exception {
  long first=openTxn();
  assertEquals(1L,first);
  long second=openTxn();
  assertEquals(2L,second);
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(2L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(2L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  assertEquals("me",txnsInfo.getOpen_txns().get(1).getUser());
  assertEquals("localhost",txnsInfo.getOpen_txns().get(1).getHostname());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(2L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[3];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  for (int i=1; i < saw.length; i++)   assertTrue(saw[i]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.TestTxnCommands2 </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the query correctness and directory layout after ACID table conversion and MAJOR compaction
 * @throws Exception
 */
@Test public void testNonAcidToAcidConversionAndMajorCompaction() throws Exception {
  FileSystem fs=FileSystem.get(hiveConf);
  FileStatus[] status;
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(1,2)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  List<String> rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  int[][] resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  int resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " SET TBLPROPERTIES ('transactional'='true')");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(3,4)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(3,status.length);
  boolean sawNewDelta=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("delta_.*")) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
    }
  }
  Assert.assertTrue(sawNewDelta);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " compact 'MAJOR'");
  Worker w=new Worker();
  w.setThreadId((int)w.getId());
  w.setHiveConf(hiveConf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  w.init(stop,looped);
  w.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(4,status.length);
  boolean sawNewBase=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("base_.*")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
  }
  Assert.assertTrue(sawNewBase);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  String fakeFile0=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_0";
  String fakeFile1=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_1";
  fs.create(new Path(fakeFile0));
  fs.create(new Path(fakeFile1));
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(5,status.length);
  Cleaner c=new Cleaner();
  c.setThreadId((int)c.getId());
  c.setHiveConf(hiveConf);
  stop=new AtomicBoolean();
  looped=new AtomicBoolean();
  stop.set(true);
  c.init(stop,looped);
  c.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(1,status.length);
  Assert.assertTrue(status[0].getPath().getName().matches("base_.*"));
  FileStatus[] buckets=fs.listStatus(status[0].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,buckets.length);
  Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
  Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestTezSessionPool </h4><pre class="type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionPoolThreads(){
  try {
    conf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"0,1,2");
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,4);
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSION_MAX_INIT_THREADS,16);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState[] sessions=new TezSessionState[12];
    int[] queueCounts=new int[3];
    for (int i=0; i < sessions.length; ++i) {
      sessions[i]=poolManager.getSession(null,conf,true,false);
      queueCounts[Integer.parseInt(sessions[i].getQueueName())]+=1;
    }
    for (int i=0; i < queueCounts.length; ++i) {
      assertEquals(4,queueCounts[i]);
    }
    for (int i=0; i < sessions.length; ++i) {
      poolManager.returnSession(sessions[i],false);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestListColumnVector </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  ListColumnVector vector=new ListColumnVector(10,col1);
  vector.init();
  col1.isRepeating=true;
  vector.isRepeating=true;
  vector.noNulls=false;
  vector.isNull[0]=true;
  vector.childCount=0;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i + 3;
    vector.offsets[i]=i;
    vector.lengths[i]=10 + i;
  }
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertTrue("isNull at " + i,vector.isNull[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("null",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(vector.isRepeating);
  Arrays.fill(vector.isNull,1,10,false);
  int[] sel=new int[]{3,5,7};
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    assertEquals("failure at " + i,i == 3 || i == 5 || i == 7,vector.isNull[i]);
  }
  vector.unFlatten();
  vector.noNulls=true;
  vector.isRepeating=true;
  vector.offsets[0]=0;
  vector.lengths[0]=3;
  vector.childCount=3;
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertFalse(col1.isRepeating);
  assertFalse(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertEquals("offset at " + i,0,vector.offsets[i]);
    assertEquals("length at " + i,3,vector.lengths[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[3, 3, 3]",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertTrue(vector.isRepeating);
  assertTrue(vector.noNulls);
  Arrays.fill(vector.offsets,1,10,-1);
  Arrays.fill(vector.lengths,1,10,-1);
  Arrays.fill(col1.vector,1,10,-1);
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    if (i == 3 || i == 5 || i == 7) {
      assertEquals("failure at " + i,0,vector.offsets[i]);
      assertEquals("failure at " + i,3,vector.lengths[i]);
    }
 else {
      assertEquals("failure at " + i,-1,vector.offsets[i]);
      assertEquals("failure at " + i,-1,vector.lengths[i]);
    }
  }
  for (int i=0; i < 3; ++i) {
    assertEquals("failure at " + i,3,col1.vector[i]);
  }
  for (int i=3; i < 10; ++i) {
    assertEquals("failure at " + i,-1,col1.vector[i]);
  }
  vector.unFlatten();
  vector.reset();
  assertFalse(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertFalse(vector.isRepeating);
  assertTrue(vector.noNulls);
  assertEquals(0,vector.childCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestMapColumnVector </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  DoubleColumnVector col2=new DoubleColumnVector(10);
  MapColumnVector vector=new MapColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  vector.isRepeating=true;
  vector.noNulls=false;
  vector.isNull[0]=true;
  vector.childCount=0;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i + 3;
    col2.vector[i]=i * 10;
    vector.offsets[i]=i;
    vector.lengths[i]=10 + i;
  }
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertTrue("isNull at " + i,vector.isNull[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("null",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(vector.isRepeating);
  Arrays.fill(vector.isNull,1,10,false);
  int[] sel=new int[]{3,5,7};
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    assertEquals("failure at " + i,i == 3 || i == 5 || i == 7,vector.isNull[i]);
  }
  vector.unFlatten();
  vector.noNulls=true;
  vector.isRepeating=true;
  vector.offsets[0]=0;
  vector.lengths[0]=3;
  vector.childCount=3;
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertFalse(col1.isRepeating);
  assertFalse(col1.noNulls);
  assertFalse(col2.isRepeating);
  assertFalse(col2.noNulls);
  for (int i=0; i < 10; ++i) {
    assertEquals("offset at " + i,0,vector.offsets[i]);
    assertEquals("length at " + i,3,vector.lengths[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[{\"key\": 3, \"value\": 0.0}," + " {\"key\": 3, \"value\": 10.0}," + " {\"key\": 3, \"value\": 20.0}]",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertTrue(vector.isRepeating);
  assertFalse(col2.isRepeating);
  assertTrue(col2.noNulls);
  assertTrue(vector.noNulls);
  Arrays.fill(vector.offsets,1,10,-1);
  Arrays.fill(vector.lengths,1,10,-1);
  Arrays.fill(col1.vector,1,10,-1);
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    if (i == 3 || i == 5 || i == 7) {
      assertEquals("failure at " + i,0,vector.offsets[i]);
      assertEquals("failure at " + i,3,vector.lengths[i]);
    }
 else {
      assertEquals("failure at " + i,-1,vector.offsets[i]);
      assertEquals("failure at " + i,-1,vector.lengths[i]);
    }
  }
  for (int i=0; i < 3; ++i) {
    assertEquals("failure at " + i,3,col1.vector[i]);
  }
  for (int i=3; i < 10; ++i) {
    assertEquals("failure at " + i,-1,col1.vector[i]);
  }
  vector.unFlatten();
  vector.reset();
  assertFalse(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertFalse(col2.isRepeating);
  assertTrue(col2.noNulls);
  assertFalse(vector.isRepeating);
  assertTrue(vector.noNulls);
  assertEquals(0,vector.childCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestStructColumnVector </h4><pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  LongColumnVector col2=new LongColumnVector(10);
  StructColumnVector vector=new StructColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i;
    col2.vector[i]=2 * i;
  }
  vector.flatten(false,null,10);
  assertFalse(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    assertEquals("col1 at " + i,0,col1.vector[i]);
    assertEquals("col2 at " + i,2 * i,col2.vector[i]);
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[0, " + (2 * i) + "]",buf.toString());
  }
  vector.reset();
  assertFalse(col1.isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestUnionColumnVector </h4><pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  LongColumnVector col2=new LongColumnVector(10);
  UnionColumnVector vector=new UnionColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  for (int i=0; i < 10; ++i) {
    vector.tags[i]=i % 2;
    col1.vector[i]=i;
    col2.vector[i]=2 * i;
  }
  vector.flatten(false,null,10);
  assertFalse(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    assertEquals(i % 2,vector.tags[i]);
    assertEquals("col1 at " + i,0,col1.vector[i]);
    assertEquals("col2 at " + i,2 * i,col2.vector[i]);
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("{\"tag\": " + (i % 2) + ", \"value\": "+ (i % 2 == 0 ? 0 : 2 * i)+ "}",buf.toString());
  }
  vector.reset();
  assertFalse(col1.isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestCuckooSet </h4><pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testSetBytesLargeRandom(){
  byte[][] values;
  Random gen=new Random(98763537);
  for (int i=0; i < 200; ) {
    int size=gen.nextInt() % MAX_SIZE;
    if (size <= 0) {
      continue;
    }
    i++;
    values=new byte[size][];
    loadRandomBytes(values,gen);
    CuckooSetBytes s=new CuckooSetBytes(size);
    loadSet(s,values);
    for (int j=0; j != size; j++) {
      assertTrue(s.lookup(values[j],0,values[j].length));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testSetLongRandom(){
  long[] values;
  Random gen=new Random(98763537);
  for (int i=0; i < 200; ) {
    int size=gen.nextInt() % MAX_SIZE;
    if (size <= 0) {
      continue;
    }
    i++;
    values=new long[size];
    loadRandom(values,gen);
    CuckooSetLong s=new CuckooSetLong(size);
    loadSet(s,values);
    for (int j=0; j != size; j++) {
      assertTrue(s.lookup(values[j]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestUnaryMinus </h4><pre class="type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testUnaryMinus(){
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(1024,2,23);
  LongColUnaryMinus expr=new LongColUnaryMinus(0,1);
  expr.evaluate(vrg);
  long[] inVector=((LongColumnVector)vrg.cols[0]).vector;
  long[] outVector=((LongColumnVector)vrg.cols[1]).vector;
  for (int i=0; i < outVector.length; i++) {
    assertEquals(0,inVector[i] + outVector[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorArithmeticExpressions </h4><pre class="type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testLongColDivideLongColumn(){
  final double eps=1e-7d;
  VectorizedRowBatch batch=getVectorizedRowBatch2LongInDoubleOut();
  LongColDivideLongColumn expr=new LongColDivideLongColumn(0,1,2);
  batch.cols[0].isNull[1]=true;
  batch.cols[0].noNulls=false;
  batch.cols[1].noNulls=false;
  DoubleColumnVector out=(DoubleColumnVector)batch.cols[2];
  out.noNulls=true;
  out.isRepeating=true;
  expr.evaluate(batch);
  assertFalse(out.noNulls);
  assertTrue(out.isNull[0]);
  assertTrue(Double.isNaN(out.vector[0]));
  assertTrue(out.isNull[1]);
  assertTrue(Double.isNaN(out.vector[1]));
  for (int i=2; i != batch.size; i++) {
    assertTrue(out.vector[i] > 1.0d - eps && out.vector[i] < 1.0d + eps);
  }
  assertFalse(out.noNulls);
  assertFalse(out.isRepeating);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongScalarWithNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColumnVector lcv=(LongColumnVector)batch.cols[0];
  LongColumnVector lcvOut=(LongColumnVector)batch.cols[1];
  TestVectorizedRowBatch.addRandomNulls(lcv);
  LongColAddLongScalar expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    if (!lcv.isNull[i]) {
      Assert.assertEquals(i * 37 + 23,lcvOut.vector[i]);
    }
 else {
      Assert.assertTrue(lcvOut.isNull[i]);
    }
  }
  Assert.assertFalse(lcvOut.noNulls);
  Assert.assertFalse(lcvOut.isRepeating);
  verifyLongNullDataVectorEntries(lcvOut,batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongColumn(){
  int seed=17;
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(VectorizedRowBatch.DEFAULT_SIZE,6,seed);
  LongColumnVector lcv0=(LongColumnVector)vrg.cols[0];
  LongColumnVector lcv1=(LongColumnVector)vrg.cols[1];
  LongColumnVector lcv2=(LongColumnVector)vrg.cols[2];
  LongColumnVector lcv3=(LongColumnVector)vrg.cols[3];
  LongColumnVector lcv4=(LongColumnVector)vrg.cols[4];
  LongColumnVector lcv5=(LongColumnVector)vrg.cols[5];
  LongColAddLongColumn expr=new LongColAddLongColumn(0,1,2);
  expr.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    assertEquals((i + 1) * seed * 3,lcv2.vector[i]);
  }
  assertTrue(lcv2.noNulls);
  lcv1.noNulls=false;
  lcv1.isNull[1]=true;
  lcv2.isRepeating=true;
  lcv2.noNulls=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.isNull[1]);
  assertFalse(lcv2.noNulls);
  assertFalse(lcv2.isRepeating);
  verifyLongNullDataVectorEntries(lcv2,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv0.noNulls=false;
  lcv0.isNull[1]=true;
  lcv0.isNull[3]=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.isNull[1]);
  assertTrue(lcv2.isNull[3]);
  assertFalse(lcv2.noNulls);
  verifyLongNullDataVectorEntries(lcv2,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv3.isRepeating=true;
  LongColAddLongColumn expr2=new LongColAddLongColumn(3,4,5);
  expr2.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    assertEquals(seed * (4 + 5 * (i + 1)),lcv5.vector[i]);
  }
  lcv4.noNulls=false;
  lcv4.isNull[0]=true;
  expr2.evaluate(vrg);
  assertTrue(lcv5.isNull[0]);
  assertFalse(lcv5.noNulls);
  verifyLongNullDataVectorEntries(lcv5,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv3.isRepeating=true;
  lcv3.noNulls=false;
  lcv3.isNull[0]=true;
  expr2.evaluate(vrg);
  assertFalse(lcv5.noNulls);
  assertTrue(lcv5.isRepeating);
  assertTrue(lcv5.isNull[0]);
  verifyLongNullDataVectorEntries(lcv5,vrg.selected,vrg.selectedInUse,vrg.size);
  vrg.selectedInUse=false;
  lcv0.noNulls=true;
  lcv1.noNulls=true;
  lcv0.isRepeating=false;
  lcv1.isRepeating=false;
  lcv2.noNulls=false;
  lcv2.isRepeating=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.noNulls);
  assertFalse(lcv2.isRepeating);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongScalarNoNulls(){
  VectorizedRowBatch vrg=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColAddLongScalar expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertEquals(i * 37 + 23,((LongColumnVector)vrg.cols[1]).vector[i]);
  }
  Assert.assertTrue(((LongColumnVector)vrg.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)vrg.cols[1]).isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorLogicalExpressions </h4><pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterExprOrExpr(){
  VectorizedRowBatch batch1=getBatchThreeBooleanCols();
  VectorizedRowBatch batch2=getBatchThreeBooleanCols();
  SelectColumnIsTrue expr1=new SelectColumnIsTrue(0);
  SelectColumnIsFalse expr2=new SelectColumnIsFalse(1);
  FilterExprOrExpr orExpr=new FilterExprOrExpr();
  orExpr.setChildExpressions(new VectorExpression[]{expr1,expr2});
  orExpr.evaluate(batch1);
  orExpr.evaluate(batch2);
  assertEquals(batch1.size,batch2.size);
  for (int j=0; j < batch1.size; j++) {
    assertEquals(batch1.selected[j],batch2.selected[j]);
    int i=j;
    assertEquals((((LongColumnVector)batch1.cols[0]).vector[i]),(((LongColumnVector)batch2.cols[0]).vector[i]));
  }
  assertEquals(5,batch1.size);
  assertEquals(0,batch1.selected[0]);
  assertEquals(2,batch1.selected[1]);
  assertEquals(3,batch1.selected[2]);
  assertEquals(4,batch1.selected[3]);
  assertEquals(7,batch1.selected[4]);
  orExpr.evaluate(batch1);
  assertEquals(5,batch1.size);
  assertEquals(0,batch1.selected[0]);
  assertEquals(2,batch1.selected[1]);
  assertEquals(3,batch1.selected[2]);
  assertEquals(4,batch1.selected[3]);
  assertEquals(7,batch1.selected[4]);
}

</code></pre>

<br>
<pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterExprMultiOrExpr(){
  VectorizedRowBatch batch1a=getBatchThreeBooleanCols();
  SelectColumnAll expr1a=new SelectColumnAll(0);
  SelectColumnNotExpected expr2a=new SelectColumnNotExpected(1);
  SelectColumnNotExpected expr3a=new SelectColumnNotExpected(1);
  FilterExprOrExpr orExpr=new FilterExprOrExpr();
  orExpr.setChildExpressions(new VectorExpression[]{expr1a,expr2a,expr3a});
  orExpr.evaluate(batch1a);
  assertEquals(BOOLEAN_COLUMN_TEST_SIZE,batch1a.size);
  for (int i=0; i < BOOLEAN_COLUMN_TEST_SIZE; i++) {
    assertEquals(i,batch1a.selected[i]);
  }
  VectorizedRowBatch batch1b=getBatchThreeBooleanCols();
  SelectColumnIsNotNull expr1b=new SelectColumnIsNotNull(0);
  SelectColumnIsNull expr2b=new SelectColumnIsNull(0);
  SelectColumnNotExpected expr3b=new SelectColumnNotExpected(0);
  FilterExprOrExpr orExpr2=new FilterExprOrExpr();
  orExpr2.setChildExpressions(new VectorExpression[]{expr1b,expr2b,expr3b});
  orExpr2.evaluate(batch1b);
  assertEquals(BOOLEAN_COLUMN_TEST_SIZE,batch1b.size);
  for (int i=0; i < BOOLEAN_COLUMN_TEST_SIZE; i++) {
    assertEquals(i,batch1b.selected[i]);
  }
  VectorizedRowBatch batch1c=getBatchThreeBooleanCols();
  SelectColumnIsNotNull expr1c=new SelectColumnIsNotNull(0);
  SelectColumnNothing expr2c=new SelectColumnNothing(0);
  SelectColumnIsNull expr3c=new SelectColumnIsNull(0);
  SelectColumnNotExpected expr4c=new SelectColumnNotExpected(0);
  FilterExprOrExpr orExpr3=new FilterExprOrExpr();
  orExpr3.setChildExpressions(new VectorExpression[]{expr1c,expr2c,expr3c,expr4c});
  orExpr3.evaluate(batch1c);
  assertEquals(BOOLEAN_COLUMN_TEST_SIZE,batch1c.size);
  for (int i=0; i < BOOLEAN_COLUMN_TEST_SIZE; i++) {
    assertEquals(i,batch1c.selected[i]);
  }
  VectorizedRowBatch batch1d=getBatchThreeBooleanCols();
  SelectColumnIsTrue expr1d=new SelectColumnIsTrue(0);
  SelectColumnNothing expr2d=new SelectColumnNothing(0);
  SelectColumnNothing expr3d=new SelectColumnNothing(0);
  FilterExprOrExpr orExpr4=new FilterExprOrExpr();
  orExpr4.setChildExpressions(new VectorExpression[]{expr1d,expr3d,expr3d});
  orExpr4.evaluate(batch1d);
  int[] expected4={2,3,7};
  assertEquals(expected4.length,batch1d.size);
  for (int i=0; i < expected4.length; i++) {
    assertEquals(expected4[i],batch1d.selected[i]);
  }
  VectorizedRowBatch batch1e=getBatchThreeBooleanCols();
  SelectColumnNothing expr1e=new SelectColumnNothing(0);
  SelectColumnNothing expr2e=new SelectColumnNothing(0);
  SelectColumnNothing expr3e=new SelectColumnNothing(0);
  FilterExprOrExpr orExpr5=new FilterExprOrExpr();
  orExpr5.setChildExpressions(new VectorExpression[]{expr1e,expr2e,expr3e});
  orExpr5.evaluate(batch1e);
  assertEquals(0,batch1e.size);
  VectorizedRowBatch batch1f=getBatchThreeBooleanCols();
  SelectColumnOne expr1f=new SelectColumnOne(0,4);
  SelectColumnNothing expr2f=new SelectColumnNothing(0);
  SelectColumnNothing expr3f=new SelectColumnNothing(0);
  FilterExprOrExpr orExpr6=new FilterExprOrExpr();
  orExpr6.setChildExpressions(new VectorExpression[]{expr1f,expr2f,expr3f});
  orExpr6.evaluate(batch1f);
  assertEquals(1,batch1f.size);
  assertEquals(4,batch1f.selected[0]);
  VectorizedRowBatch batch1g=getBatchThreeBooleanCols();
  SelectColumnNothing expr1g=new SelectColumnNothing(0);
  SelectColumnOne expr2g=new SelectColumnOne(0,2);
  SelectColumnNothing expr3g=new SelectColumnNothing(0);
  FilterExprOrExpr orExpr7=new FilterExprOrExpr();
  orExpr7.setChildExpressions(new VectorExpression[]{expr1g,expr2g,expr3g});
  orExpr7.evaluate(batch1g);
  assertEquals(1,batch1g.size);
  assertEquals(2,batch1g.selected[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorMathFunctions </h4><pre class="type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testVectorRand(){
  VectorizedRowBatch b=new VectorizedRowBatch(1);
  DoubleColumnVector v=new DoubleColumnVector();
  b.cols[0]=v;
  b.size=VectorizedRowBatch.DEFAULT_SIZE;
  int n=b.size;
  v.noNulls=true;
  VectorExpression expr=new FuncRandNoSeed(0);
  expr.evaluate(b);
  double sum=0;
  for (int i=0; i != n; i++) {
    sum+=v.vector[i];
    Assert.assertTrue(v.vector[i] >= 0.0 && v.vector[i] <= 1.0);
  }
  double avg=sum / n;
  Assert.assertTrue(avg > 0.3 && avg < 0.7);
  Arrays.fill(v.vector,0);
  expr=new FuncRand(99999,0);
  expr.evaluate(b);
  sum=0;
  for (int i=0; i != n; i++) {
    sum+=v.vector[i];
    Assert.assertTrue(v.vector[i] >= 0.0 && v.vector[i] <= 1.0);
  }
  avg=sum / n;
  Assert.assertTrue(avg > 0.3 && avg < 0.7);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorScalarColArithmetic </h4><pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarSubtractLongColNoNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongScalarSubtractLongColumn expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertEquals(100 - i * 37,((LongColumnVector)batch.cols[1]).vector[i]);
  }
  Assert.assertTrue(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testScalarLongDivide(){
  VectorizedRowBatch batch=TestVectorArithmeticExpressions.getVectorizedRowBatch2LongInDoubleOut();
  LongScalarDivideLongColumn expr=new LongScalarDivideLongColumn(100,0,2);
  batch.cols[0].isNull[1]=true;
  batch.cols[0].noNulls=false;
  DoubleColumnVector out=(DoubleColumnVector)batch.cols[2];
  out.noNulls=true;
  out.isRepeating=true;
  expr.evaluate(batch);
  assertTrue(out.isNull[0]);
  assertTrue(Double.isNaN(out.vector[0]));
  assertTrue(out.isNull[1]);
  assertTrue(Double.isNaN(out.vector[1]));
  for (int i=2; i != batch.size; i++) {
    assertTrue(equalsWithinTolerance(100d / (i * 37),out.vector[i]));
  }
  assertFalse(out.noNulls);
  assertFalse(out.isRepeating);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testLongScalarDivide(){
  VectorizedRowBatch batch=TestVectorArithmeticExpressions.getVectorizedRowBatch2LongInDoubleOut();
  LongColDivideLongScalar expr=new LongColDivideLongScalar(0,100,2);
  batch.cols[0].isNull[0]=true;
  batch.cols[0].noNulls=false;
  DoubleColumnVector out=(DoubleColumnVector)batch.cols[2];
  out.noNulls=true;
  out.isRepeating=true;
  expr.evaluate(batch);
  assertFalse(out.noNulls);
  assertTrue(out.isNull[0]);
  assertTrue(Double.isNaN(out.vector[0]));
  for (int i=1; i != batch.size; i++) {
    assertTrue(equalsWithinTolerance((i * 37) / 100d,out.vector[i]));
  }
  assertFalse(out.isRepeating);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarSubtractLongColWithNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColumnVector lcv=(LongColumnVector)batch.cols[0];
  TestVectorizedRowBatch.addRandomNulls(lcv);
  LongScalarSubtractLongColumn expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    if (!lcv.isNull[i]) {
      Assert.assertEquals(100 - i * 37,((LongColumnVector)batch.cols[1]).vector[i]);
    }
 else {
      Assert.assertTrue(((LongColumnVector)batch.cols[1]).isNull[i]);
    }
  }
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
  TestVectorArithmeticExpressions.verifyLongNullDataVectorEntries((LongColumnVector)batch.cols[1],batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarModuloLongColNoNulls(){
  VectorizedRowBatch batch=getBatchSingleLongVectorPositiveNonZero();
  LongScalarModuloLongColumn expr=new LongScalarModuloLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertEquals(100 % ((i + 1) * 37),((LongColumnVector)batch.cols[1]).vector[i]);
  }
  Assert.assertTrue(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorStringExpressions </h4><pre class="type-11 type-6 type-4 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void testLoadBytesColumnVectorByRef(){
  BytesColumnVector bcv=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  String s="red";
  byte[] b=null;
  try {
    b=s.getBytes("UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    e.printStackTrace();
  }
  for (int i=0; i != VectorizedRowBatch.DEFAULT_SIZE; i++) {
    bcv.setRef(i,b,0,b.length);
  }
  byte[] v=new byte[b.length];
  for (int i=0; i != VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertTrue(bcv.length[i] == b.length);
    System.arraycopy(bcv.vector[i],bcv.start[i],v,0,b.length);
    Assert.assertTrue(Arrays.equals(b,v));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.mapjoin.fast.TestVectorMapJoinFastMultiKeyHashMap </h4><pre class="type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testLarge() throws Exception {
  random=new Random(5231);
  VectorMapJoinFastMultiKeyHashMap map=new VectorMapJoinFastMultiKeyHashMap(false,LARGE_CAPACITY,LOAD_FACTOR,LARGE_WB_SIZE);
  RandomByteArrayStream randomByteArrayKeyStream=new RandomByteArrayStream(random,10);
  final int largeSize=1000;
  RandomByteArrayStream[] randomByteArrayValueStreams=new RandomByteArrayStream[largeSize];
  for (int i=0; i < largeSize; i++) {
    randomByteArrayValueStreams[i]=new RandomByteArrayStream(random);
    int count=generateLargeCount();
    byte[] key=randomByteArrayKeyStream.next();
    VectorMapJoinHashMapResult hashMapResult=map.createHashMapResult();
    JoinUtil.JoinResult joinResult=map.lookup(key,0,key.length,hashMapResult);
    if (joinResult == JoinUtil.JoinResult.MATCH) {
      assertTrue(false);
    }
    for (int v=0; v < count; v++) {
      byte[] value=randomByteArrayValueStreams[i].next();
      map.putRow(key,value);
    }
  }
  for (int i=0; i < largeSize; i++) {
    verifyHashMapResult(map,randomByteArrayKeyStream.get(i),randomByteArrayValueStreams[i]);
  }
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testLargeAndExpand() throws Exception {
  random=new Random(46809);
  VectorMapJoinFastMultiKeyHashMap map=new VectorMapJoinFastMultiKeyHashMap(false,MODERATE_CAPACITY,LOAD_FACTOR,MODERATE_WB_SIZE);
  RandomByteArrayStream randomByteArrayKeyStream=new RandomByteArrayStream(random,10);
  final int largeSize=1000;
  RandomByteArrayStream[] randomByteArrayValueStreams=new RandomByteArrayStream[largeSize];
  for (int i=0; i < largeSize; i++) {
    randomByteArrayValueStreams[i]=new RandomByteArrayStream(random);
    int count=generateLargeCount();
    byte[] key=randomByteArrayKeyStream.next();
    VectorMapJoinHashMapResult hashMapResult=map.createHashMapResult();
    JoinUtil.JoinResult joinResult=map.lookup(key,0,key.length,hashMapResult);
    if (joinResult == JoinUtil.JoinResult.MATCH) {
      assertTrue(false);
    }
    for (int v=0; v < count; v++) {
      byte[] value=randomByteArrayValueStreams[i].next();
      map.putRow(key,value);
    }
  }
  for (int i=0; i < largeSize; i++) {
    verifyHashMapResult(map,randomByteArrayKeyStream.get(i),randomByteArrayValueStreams[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestIOContextMap </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezLlapAttemptMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000, ATTEMPT_COUNT=3;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT * ATTEMPT_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        final Configuration conf=new Configuration(), conf2=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          String input1="Input " + nextIx;
          conf.set(Utilities.INPUT_NAME,input1);
          for (int j=0; j < ATTEMPT_COUNT; ++j) {
            String attemptId="Attempt " + nextIx + ":"+ j;
            IOContextMap.setThreadAttemptId(attemptId);
            final IOContext r1=results[(nextIx * ATTEMPT_COUNT) + j]=IOContextMap.get(conf);
            if ((nextIx % (ITER_COUNT / 10)) == 0) {
              String input2="Input2 " + nextIx;
              conf2.set(Utilities.INPUT_NAME,input2);
              final AtomicReference<IOContext> ref2=new AtomicReference<>();
              Thread t=new Thread(new Runnable(){
                public void run(){
                  assertSame(r1,IOContextMap.get(conf));
                  ref2.set(IOContextMap.get(conf2));
                }
              }
);
              t.start();
              t.join();
              assertSame(ref2.get(),IOContextMap.get(conf2));
            }
          }
          if (nextIx == 0)           break;
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Configuration conf=new Configuration();
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < ITER_COUNT; ++i) {
    conf.set(Utilities.INPUT_NAME,"Input " + i);
    for (int j=0; j < ATTEMPT_COUNT; ++j) {
      String attemptId="Attempt " + i + ":"+ j;
      IOContext result=results[(i * ATTEMPT_COUNT) + j];
      assertTrue(resultSet.add(result));
      IOContextMap.setThreadAttemptId(attemptId);
      assertSame(result,IOContextMap.get(conf));
      IOContextMap.clearThreadAttempt(attemptId);
      IOContextMap.setThreadAttemptId(attemptId);
      assertNotSame(result,IOContextMap.get(conf));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMRTezGlobalMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final CountDownLatch phase1End=new CountDownLatch(THREAD_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        Configuration conf=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          conf.set(Utilities.INPUT_NAME,"Input " + nextIx);
          results[nextIx]=IOContextMap.get(conf);
          if (nextIx == 0)           break;
        }
        phase1End.countDown();
        phase1End.await();
        for (int i=0; i < ITER_COUNT; ++i) {
          conf.set(Utilities.INPUT_NAME,"Input " + i);
          IOContext ctx=IOContextMap.get(conf);
          assertSame(results[i],ctx);
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < results.length; ++i) {
    assertTrue(resultSet.add(results[i]));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparkThreadLocal() throws Exception {
  final Configuration conf1=new Configuration();
  conf1.set(HiveConf.ConfVars.HIVE_EXECUTION_ENGINE.varname,"spark");
  final Configuration conf2=new Configuration(conf1);
  conf2.set(Utilities.INPUT_NAME,"Other input");
  final int THREAD_COUNT=2;
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<IOContext>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<IOContext>(new Callable<IOContext>(){
      public IOContext call() throws Exception {
        syncThreadStart(cdlIn,cdlOut);
        IOContext c1=IOContextMap.get(conf1), c2=IOContextMap.get(conf2);
        assertSame(c1,c2);
        return c1;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  Set<IOContext> results=Sets.newIdentityHashSet();
  for (int i=0; i < tasks.length; ++i) {
    assertTrue(results.add(tasks[i].get()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestRCFile </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleReadAndWrite() throws IOException, SerDeException {
  cleanup();
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  Object[] expectedRecord_1={new ByteWritable((byte)123),new ShortWritable((short)456),new IntWritable(789),new LongWritable(1000),new DoubleWritable(5.3),new Text("hive and hadoop"),null,null};
  Object[] expectedRecord_2={new ByteWritable((byte)100),new ShortWritable((short)200),new IntWritable(123),new LongWritable(1000),new DoubleWritable(5.3),new Text("hive and hadoop"),null,null};
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  assertEquals(new Text("block"),reader.getMetadata().get(new Text("apple")));
  assertEquals(new Text("block"),reader.getMetadataValueOf(new Text("apple")));
  assertEquals(new Text("dog"),reader.getMetadataValueOf(new Text("cat")));
  LongWritable rowID=new LongWritable();
  for (int i=0; i < 2; i++) {
    reader.next(rowID);
    BytesRefArrayWritable cols=new BytesRefArrayWritable();
    reader.getCurrentRow(cols);
    cols.resetValid(8);
    Object row=serDe.deserialize(cols);
    StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
    List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
    assertEquals("Field size should be 8",8,fieldRefs.size());
    for (int j=0; j < fieldRefs.size(); j++) {
      Object fieldData=oi.getStructFieldData(row,fieldRefs.get(j));
      Object standardWritableData=ObjectInspectorUtils.copyToStandardObject(fieldData,fieldRefs.get(j).getFieldObjectInspector(),ObjectInspectorCopyOption.WRITABLE);
      if (i == 0) {
        assertEquals("Field " + i,standardWritableData,expectedRecord_1[j]);
      }
 else {
        assertEquals("Field " + i,standardWritableData,expectedRecord_2[j]);
      }
    }
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link RCFile.Reader#getColumn(int,BytesRefArrayWritable) } method.
 * @throws IOException
 */
@Test public void testGetColumn() throws IOException {
  cleanup();
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  LongWritable rowID=new LongWritable();
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),0L);
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),1L);
  BytesRefArrayWritable result=null;
  BytesRefWritable brw;
  for (int col=0; col < 8; col++) {
    BytesRefArrayWritable result2=reader.getColumn(col,result);
    if (result == null) {
      assertNotNull(result2);
      result=result2;
    }
 else {
      assertSame(result2,result);
    }
    assertEquals(2,result.size());
    for (int row=0; row < result.size(); row++) {
      brw=result.get(row);
      int start=brw.getStart();
      int len=brw.getLength();
      byte[] actualData=Arrays.copyOfRange(brw.getData(),start,start + len);
      byte[] expectedData=(row == 0) ? record_1[col] : record_2[col];
      assertArrayEquals("col=" + col + " : row="+ row,expectedData,actualData);
    }
    result.clear();
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSync() throws IOException {
  Path testDir=new Path(System.getProperty("test.tmp.dir",".") + "/mapred/testsync");
  Path testFile=new Path(testDir,"test_rcfile");
  fs.delete(testFile,true);
  int intervalRecordCount=500;
  CompressionCodec codec=null;
  int writeCount=2500;
  Configuration cloneConf=new Configuration(conf);
  RCFileOutputFormat.setColumnNumber(cloneConf,bytesArray.length);
  cloneConf.setInt(HiveConf.ConfVars.HIVE_RCFILE_RECORD_INTERVAL.varname,intervalRecordCount);
  RCFile.Writer writer=new RCFile.Writer(fs,cloneConf,testFile,null,codec);
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(bytesArray.length);
  for (int i=0; i < bytesArray.length; i++) {
    BytesRefWritable cu=null;
    cu=new BytesRefWritable(bytesArray[i],0,bytesArray[i].length);
    bytes.set(i,cu);
  }
  for (int i=0; i < writeCount; i++) {
    writer.append(bytes);
  }
  writer.close();
  long fileLen=fs.getFileStatus(testFile).getLen();
  RCFileInputFormat inputFormat=new RCFileInputFormat();
  JobConf jobconf=new JobConf(cloneConf);
  jobconf.set("mapred.input.dir",testDir.toString());
  HiveConf.setLongVar(jobconf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,fileLen);
  InputSplit[] splits=inputFormat.getSplits(jobconf,1);
  RCFileRecordReader rr=new RCFileRecordReader(jobconf,(FileSplit)splits[0]);
  long lastSync=0;
  for (int i=0; i < 2500; i++) {
    rr.sync(i);
    if (rr.getPos() < lastSync) {
      String reason=String.format("Sync at offset %d skipped sync block at location %d (returned %d instead)",i - 1,rr.getPos(),lastSync);
      System.out.println(reason);
      fail(reason);
    }
    lastSync=rr.getPos();
  }
  rr.close();
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadOldFileHeader() throws IOException {
  String[] row=new String[]{"Tester","Bart","333 X St.","Reno","NV","USA"};
  RCFile.Reader reader=new RCFile.Reader(fs,new Path("src/test/data/rc-file-v0.rc"),conf);
  LongWritable rowID=new LongWritable();
  BytesRefArrayWritable cols=new BytesRefArrayWritable();
  assertTrue("old file reader first row",reader.next(rowID));
  reader.getCurrentRow(cols);
  assertEquals(row.length,cols.size());
  for (int i=0; i < cols.size(); ++i) {
    assertEquals(row[i],new String(cols.get(i).getBytesCopy()));
  }
  assertFalse("old file reader end",reader.next(rowID));
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProjectedColumnSize() throws Exception {
  long[] stripeSizes=new long[]{200,200,200,200,100};
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/file",500,createMockOrcFile(stripeSizes),new MockBlock("host1-1","host1-2","host1-3"),new MockBlock("host2-1","host0","host2-3"),new MockBlock("host0","host3-2","host3-3"),new MockBlock("host4-1","host4-2","host4-3"),new MockBlock("host5-1","host5-2","host5-3")));
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,300);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,200);
  conf.setBoolean(ColumnProjectionUtils.READ_ALL_COLUMNS,false);
  conf.set(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR,"0");
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  OrcInputFormat.SplitGenerator splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  List<OrcSplit> results=splitter.call();
  OrcSplit result=results.get(0);
  assertEquals(3,results.size());
  assertEquals(3,result.getStart());
  assertEquals(400,result.getLength());
  assertEquals(167468,result.getProjectedColumnsUncompressedSize());
  result=results.get(1);
  assertEquals(403,result.getStart());
  assertEquals(400,result.getLength());
  assertEquals(167468,result.getProjectedColumnsUncompressedSize());
  result=results.get(2);
  assertEquals(803,result.getStart());
  assertEquals(100,result.getLength());
  assertEquals(41867,result.getProjectedColumnsUncompressedSize());
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,0);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,0);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  assertEquals(5,results.size());
  for (int i=0; i < stripeSizes.length; ++i) {
    assertEquals("checking stripe " + i + " size",stripeSizes[i],results.get(i).getLength());
    if (i == stripeSizes.length - 1) {
      assertEquals(41867,results.get(i).getProjectedColumnsUncompressedSize());
    }
 else {
      assertEquals(83734,results.get(i).getProjectedColumnsUncompressedSize());
    }
  }
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,1000);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,100000);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  assertEquals(1,results.size());
  result=results.get(0);
  assertEquals(3,result.getStart());
  assertEquals(900,result.getLength());
  assertEquals(376804,result.getProjectedColumnsUncompressedSize());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testVectorizationWithAcid() throws Exception {
  StructObjectInspector inspector=new BigRowInspector();
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"vectorizationAcid",inspector,true,1);
  Path partDir=new Path(conf.get("mapred.input.dir"));
  OrcRecordUpdater writer=new OrcRecordUpdater(partDir,new AcidOutputFormat.Options(conf).maximumTransactionId(10).writingBase(true).bucket(0).inspector(inspector).finalDestination(partDir));
  for (int i=0; i < 100; ++i) {
    BigRow row=new BigRow(i);
    writer.insert(10,row);
  }
  WriterImpl baseWriter=(WriterImpl)writer.getWriter();
  writer.close(false);
  ((MockOutputStream)baseWriter.getStream()).setBlocks(new MockBlock("host0","host1"));
  HiveInputFormat<?,?> inputFormat=new HiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,10);
  assertEquals(1,splits.length);
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,BigRow.getColumnNamesProperty());
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,BigRow.getColumnTypesProperty());
  HiveConf.setBoolVar(conf,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> reader=inputFormat.getRecordReader(splits[0],conf,Reporter.NULL);
  NullWritable key=reader.createKey();
  VectorizedRowBatch value=reader.createValue();
  assertEquals(true,reader.next(key,value));
  assertEquals(100,value.count());
  LongColumnVector booleanColumn=(LongColumnVector)value.cols[0];
  LongColumnVector byteColumn=(LongColumnVector)value.cols[1];
  LongColumnVector shortColumn=(LongColumnVector)value.cols[2];
  LongColumnVector intColumn=(LongColumnVector)value.cols[3];
  LongColumnVector longColumn=(LongColumnVector)value.cols[4];
  DoubleColumnVector floatColumn=(DoubleColumnVector)value.cols[5];
  DoubleColumnVector doubleCoulmn=(DoubleColumnVector)value.cols[6];
  BytesColumnVector stringColumn=(BytesColumnVector)value.cols[7];
  DecimalColumnVector decimalColumn=(DecimalColumnVector)value.cols[8];
  LongColumnVector dateColumn=(LongColumnVector)value.cols[9];
  LongColumnVector timestampColumn=(LongColumnVector)value.cols[10];
  for (int i=0; i < 100; i++) {
    assertEquals("checking boolean " + i,i % 2 == 0 ? 1 : 0,booleanColumn.vector[i]);
    assertEquals("checking byte " + i,(byte)i,byteColumn.vector[i]);
    assertEquals("checking short " + i,(short)i,shortColumn.vector[i]);
    assertEquals("checking int " + i,i,intColumn.vector[i]);
    assertEquals("checking long " + i,i,longColumn.vector[i]);
    assertEquals("checking float " + i,i,floatColumn.vector[i],0.0001);
    assertEquals("checking double " + i,i,doubleCoulmn.vector[i],0.0001);
    Text strValue=new Text();
    strValue.set(stringColumn.vector[i],stringColumn.start[i],stringColumn.length[i]);
    assertEquals("checking string " + i,new Text(Long.toHexString(i)),strValue);
    assertEquals("checking decimal " + i,HiveDecimal.create(i),decimalColumn.vector[i].getHiveDecimal());
    assertEquals("checking date " + i,i,dateColumn.vector[i]);
    long millis=(long)i * MILLIS_IN_DAY;
    millis-=LOCAL_TIMEZONE.getOffset(millis);
    assertEquals("checking timestamp " + i,millis * 1000000L,timestampColumn.vector[i]);
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInOutFormat() throws Exception {
  Properties properties=new Properties();
  properties.setProperty("columns","x,y");
  properties.setProperty("columns.types","int:int");
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  SerDe serde=new OrcSerde();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.write(serde.serialize(new MyRow(1,2),inspector));
  writer.write(serde.serialize(new MyRow(2,2),inspector));
  writer.write(serde.serialize(new MyRow(3,2),inspector));
  writer.close(true);
  serde=new OrcSerde();
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  assertEquals(OrcSerde.OrcSerdeRow.class,serde.getSerializedClass());
  inspector=(StructObjectInspector)serde.getObjectInspector();
  assertEquals("struct<x:int,y:int>",inspector.getTypeName());
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertEquals(1,splits.length);
  ArrayList<FileStatus> fileList=new ArrayList<FileStatus>();
  assertEquals(false,((InputFormatChecker)in).validateInput(fs,new HiveConf(),fileList));
  fileList.add(fs.getFileStatus(testFilePath));
  assertEquals(true,((InputFormatChecker)in).validateInput(fs,new HiveConf(),fileList));
  fileList.add(fs.getFileStatus(workDir));
  assertEquals(false,((InputFormatChecker)in).validateInput(fs,new HiveConf(),fileList));
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,MyRow.getColumnNamesProperty());
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,MyRow.getColumnTypesProperty());
  org.apache.hadoop.mapred.RecordReader reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  Object key=reader.createKey();
  Writable value=(Writable)reader.createValue();
  int rowNum=0;
  List<? extends StructField> fields=inspector.getAllStructFieldRefs();
  IntObjectInspector intInspector=(IntObjectInspector)fields.get(0).getFieldObjectInspector();
  while (reader.next(key,value)) {
    assertEquals(++rowNum,intInspector.get(inspector.getStructFieldData(serde.deserialize(value),fields.get(0))));
    assertEquals(2,intInspector.get(inspector.getStructFieldData(serde.deserialize(value),fields.get(1))));
  }
  assertEquals(3,rowNum);
  assertEquals(1.0,reader.getProgress(),0.00001);
  reader.close();
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(0));
  reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  key=reader.createKey();
  value=(Writable)reader.createValue();
  rowNum=0;
  fields=inspector.getAllStructFieldRefs();
  while (reader.next(key,value)) {
    assertEquals(++rowNum,intInspector.get(inspector.getStructFieldData(value,fields.get(0))));
    assertEquals(null,inspector.getStructFieldData(value,fields.get(1)));
  }
  assertEquals(3,rowNum);
  reader.close();
  ColumnProjectionUtils.setReadAllColumns(conf);
  reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  key=reader.createKey();
  value=(Writable)reader.createValue();
  rowNum=0;
  fields=inspector.getAllStructFieldRefs();
  while (reader.next(key,value)) {
    assertEquals(++rowNum,intInspector.get(inspector.getStructFieldData(value,fields.get(0))));
    assertEquals(2,intInspector.get(inspector.getStructFieldData(serde.deserialize(value),fields.get(1))));
  }
  assertEquals(3,rowNum);
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMROutput() throws Exception {
  Properties properties=new Properties();
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(NestedRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  SerDe serde=new OrcSerde();
  OutputFormat<?,?> outFormat=new OrcOutputFormat();
  RecordWriter writer=outFormat.getRecordWriter(fs,conf,testFilePath.toString(),Reporter.NULL);
  writer.write(NullWritable.get(),serde.serialize(new NestedRow(1,2,3),inspector));
  writer.write(NullWritable.get(),serde.serialize(new NestedRow(4,5,6),inspector));
  writer.write(NullWritable.get(),serde.serialize(new NestedRow(7,8,9),inspector));
  writer.close(Reporter.NULL);
  serde=new OrcSerde();
  properties.setProperty("columns","z,r");
  properties.setProperty("columns.types","int:struct<x:int,y:int>");
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  inspector=(StructObjectInspector)serde.getObjectInspector();
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertEquals(1,splits.length);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(1));
  conf.set("columns","z,r");
  conf.set("columns.types","int:struct<x:int,y:int>");
  org.apache.hadoop.mapred.RecordReader reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  Object key=reader.createKey();
  Object value=reader.createValue();
  int rowNum=0;
  List<? extends StructField> fields=inspector.getAllStructFieldRefs();
  StructObjectInspector inner=(StructObjectInspector)fields.get(1).getFieldObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  IntObjectInspector intInspector=(IntObjectInspector)fields.get(0).getFieldObjectInspector();
  while (reader.next(key,value)) {
    assertEquals(null,inspector.getStructFieldData(value,fields.get(0)));
    Object sub=inspector.getStructFieldData(value,fields.get(1));
    assertEquals(3 * rowNum + 1,intInspector.get(inner.getStructFieldData(sub,inFields.get(0))));
    assertEquals(3 * rowNum + 2,intInspector.get(inner.getStructFieldData(sub,inFields.get(1))));
    rowNum+=1;
  }
  assertEquals(3,rowNum);
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test vectorization, non-acid, non-combine.
 * @throws Exception
 */
@Test public void testVectorization() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"vectorization",inspector,true,1);
  Writer writer=OrcFile.createWriter(new Path(conf.get("mapred.input.dir") + "/0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  ((MockOutputStream)((WriterImpl)writer).getStream()).setBlocks(new MockBlock("host0","host1"));
  HiveInputFormat<?,?> inputFormat=new HiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,10);
  assertEquals(1,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> reader=inputFormat.getRecordReader(splits[0],conf,Reporter.NULL);
  NullWritable key=reader.createKey();
  VectorizedRowBatch value=reader.createValue();
  assertEquals(true,reader.next(key,value));
  assertEquals(10,value.count());
  LongColumnVector col0=(LongColumnVector)value.cols[0];
  for (int i=0; i < 10; i++) {
    assertEquals("checking " + i,i,col0.vector[i]);
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCombinationInputFormatWithAcid() throws Exception {
  StructObjectInspector inspector;
  final int PARTITIONS=2;
  final int BUCKETS=3;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"combinationAcid",inspector,false,PARTITIONS);
  Path[] partDir=new Path[PARTITIONS];
  String[] paths=conf.getStrings("mapred.input.dir");
  for (int p=0; p < PARTITIONS; ++p) {
    partDir[p]=new Path(paths[p]);
  }
  OrcRecordUpdater writer=new OrcRecordUpdater(partDir[0],new AcidOutputFormat.Options(conf).maximumTransactionId(10).writingBase(true).bucket(0).inspector(inspector).finalDestination(partDir[0]));
  for (int i=0; i < 10; ++i) {
    writer.insert(10,new MyRow(i,2 * i));
  }
  WriterImpl baseWriter=(WriterImpl)writer.getWriter();
  writer.close(false);
  MockOutputStream outputStream=(MockOutputStream)baseWriter.getStream();
  outputStream.setBlocks(new MockBlock("host1","host2"));
  writer=new OrcRecordUpdater(partDir[0],new AcidOutputFormat.Options(conf).maximumTransactionId(10).writingBase(true).bucket(1).inspector(inspector).finalDestination(partDir[0]));
  for (int i=10; i < 20; ++i) {
    writer.insert(10,new MyRow(i,2 * i));
  }
  WriterImpl deltaWriter=(WriterImpl)writer.getWriter();
  outputStream=(MockOutputStream)deltaWriter.getStream();
  writer.close(false);
  outputStream.setBlocks(new MockBlock("host1","host2"));
  for (int bucket=0; bucket < BUCKETS; ++bucket) {
    Writer orc=OrcFile.createWriter(new Path(partDir[1],"00000" + bucket + "_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
    orc.addRow(new MyRow(1,2));
    outputStream=(MockOutputStream)((WriterImpl)orc).getStream();
    orc.close();
    outputStream.setBlocks(new MockBlock("host3","host4"));
  }
  conf.setInt(hive_metastoreConstants.BUCKET_COUNT,BUCKETS);
  HiveInputFormat<?,?> inputFormat=new CombineHiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,1);
  assertEquals(3,splits.length);
  HiveInputFormat.HiveInputSplit split=(HiveInputFormat.HiveInputSplit)splits[0];
  assertEquals("org.apache.hadoop.hive.ql.io.orc.OrcInputFormat",split.inputFormatClassName());
  assertEquals("mock:/combinationAcid/p=0/base_0000010/bucket_00000",split.getPath().toString());
  assertEquals(0,split.getStart());
  assertEquals(607,split.getLength());
  split=(HiveInputFormat.HiveInputSplit)splits[1];
  assertEquals("org.apache.hadoop.hive.ql.io.orc.OrcInputFormat",split.inputFormatClassName());
  assertEquals("mock:/combinationAcid/p=0/base_0000010/bucket_00001",split.getPath().toString());
  assertEquals(0,split.getStart());
  assertEquals(629,split.getLength());
  CombineHiveInputFormat.CombineHiveInputSplit combineSplit=(CombineHiveInputFormat.CombineHiveInputSplit)splits[2];
  assertEquals(BUCKETS,combineSplit.getNumPaths());
  for (int bucket=0; bucket < BUCKETS; ++bucket) {
    assertEquals("mock:/combinationAcid/p=1/00000" + bucket + "_0",combineSplit.getPath(bucket).toString());
    assertEquals(0,combineSplit.getOffset(bucket));
    assertEquals(241,combineSplit.getLength(bucket));
  }
  String[] hosts=combineSplit.getLocations();
  assertEquals(2,hosts.length);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombinationInputFormat() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"combination",inspector,false,1);
  Path partDir=new Path(conf.get("mapred.input.dir"));
  Writer writer=OrcFile.createWriter(new Path(partDir,"0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  MockOutputStream outputStream=(MockOutputStream)((WriterImpl)writer).getStream();
  outputStream.setBlocks(new MockBlock("host0","host1"));
  int length0=outputStream.file.length;
  writer=OrcFile.createWriter(new Path(partDir,"1_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=10; i < 20; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  outputStream=(MockOutputStream)((WriterImpl)writer).getStream();
  outputStream.setBlocks(new MockBlock("host1","host2"));
  HiveInputFormat<?,?> inputFormat=new CombineHiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,1);
  assertEquals(1,splits.length);
  CombineHiveInputFormat.CombineHiveInputSplit split=(CombineHiveInputFormat.CombineHiveInputSplit)splits[0];
  assertEquals(2,split.getNumPaths());
  assertEquals(partDir.toString() + "/0_0",split.getPath(0).toString());
  assertEquals(partDir.toString() + "/1_0",split.getPath(1).toString());
  assertEquals(length0,split.getLength(0));
  assertEquals(outputStream.file.length,split.getLength(1));
  assertEquals(0,split.getOffset(0));
  assertEquals(0,split.getOffset(1));
  assertTrue(3 >= split.getLocations().length);
  org.apache.hadoop.mapred.RecordReader<CombineHiveKey,OrcStruct> reader=inputFormat.getRecordReader(split,conf,Reporter.NULL);
  CombineHiveKey key=reader.createKey();
  OrcStruct value=reader.createValue();
  for (int i=0; i < 20; i++) {
    assertEquals(true,reader.next(key,value));
    assertEquals(i,((IntWritable)value.getFieldValue(0)).get());
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSplitGenerator() throws Exception {
  long[] stripeSizes=new long[]{197,300,600,200,200,100,100,100,100,100};
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/file",500,createMockOrcFile(stripeSizes),new MockBlock("host1-1","host1-2","host1-3"),new MockBlock("host2-1","host0","host2-3"),new MockBlock("host0","host3-2","host3-3"),new MockBlock("host4-1","host4-2","host4-3"),new MockBlock("host5-1","host5-2","host5-3")));
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,300);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,200);
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  OrcInputFormat.SplitGenerator splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,AcidUtils.createOriginalObj(null,fs.getFileStatus(new Path("/a/file"))),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  List<OrcSplit> results=splitter.call();
  OrcSplit result=results.get(0);
  assertEquals(3,result.getStart());
  assertEquals(497,result.getLength());
  result=results.get(1);
  assertEquals(500,result.getStart());
  assertEquals(600,result.getLength());
  result=results.get(2);
  assertEquals(1100,result.getStart());
  assertEquals(400,result.getLength());
  result=results.get(3);
  assertEquals(1500,result.getStart());
  assertEquals(300,result.getLength());
  result=results.get(4);
  assertEquals(1800,result.getStart());
  assertEquals(200,result.getLength());
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,0);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,0);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,AcidUtils.createOriginalObj(null,fs.getFileStatus(new Path("/a/file"))),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  for (int i=0; i < stripeSizes.length; ++i) {
    assertEquals("checking stripe " + i + " size",stripeSizes[i],results.get(i).getLength());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test vectorization, non-acid, non-combine.
 * @throws Exception
 */
@Test public void testVectorizationWithBuckets() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"vectorBuckets",inspector,true,1);
  Writer writer=OrcFile.createWriter(new Path(conf.get("mapred.input.dir") + "/0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  ((MockOutputStream)((WriterImpl)writer).getStream()).setBlocks(new MockBlock("host0","host1"));
  conf.setInt(hive_metastoreConstants.BUCKET_COUNT,3);
  HiveInputFormat<?,?> inputFormat=new HiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,10);
  assertEquals(1,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> reader=inputFormat.getRecordReader(splits[0],conf,Reporter.NULL);
  NullWritable key=reader.createKey();
  VectorizedRowBatch value=reader.createValue();
  assertEquals(true,reader.next(key,value));
  assertEquals(10,value.count());
  LongColumnVector col0=(LongColumnVector)value.cols[0];
  for (int i=0; i < 10; i++) {
    assertEquals("checking " + i,i,col0.vector[i]);
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestNewIntegerEncoding </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaOverflow3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{-4513343538618202711l,-2911390882471569739l,-2,Long.MAX_VALUE};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 100000; i++) {
    input.add((long)rand.nextInt());
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).stripeSize(100000).bufferSize(10000).version(OrcFile.Version.V_0_11).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=55555;
  rows.seekToRow(idx);
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin4() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{13,13,11,8,13,10,10,11,11,14,11,7,13,12,12,11,15,12,12,9,8,10,13,11,8,6,5,6,11,7,15,10,7,6,8,7,9,9,11,33,11,3,7,4,6,10,14,12,5,14,7,6};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add(371946367L);
  input.add(11963367L);
  input.add(68639400007L);
  input.add(100233367L);
  input.add(6367L);
  input.add(10026367L);
  input.add(3670000L);
  input.add(3602367L);
  input.add(4719226367L);
  input.add(7196367L);
  input.add(444442L);
  input.add(210267L);
  input.add(21033L);
  input.add(160267L);
  input.add(400267L);
  input.add(23634347L);
  input.add(16027L);
  input.add(46026367L);
  input.add(Long.MAX_VALUE);
  input.add(33333L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{20,2,3,2,1,3,17,71,35,2,1,139,2,2,3,1783,475,2,1,1,3,1,3,2,32,1,2,3,1,8,30,1,3,414,1,1,135,3,3,1,414,2,1,2,2,594,2,5,6,4,11,1,2,2,1,1,52,4,1,2,7,1,17,334,1,2,1,2,2,6,1,266,1,2,217,2,6,2,13,2,2,1,2,3,5,1,2,1,7244,11813,1,33,2,-13,1,2,3,13,1,92,3,13,5,14,9,141,12,6,15,25,1,1,1,46,2,1,1,141,3,1,1,1,1,2,1,4,34,5,78,8,1,2,2,1,9,10,2,1,4,13,1,5,4,4,19,5,1,1,1,68,33,399,1,1885,25,5,2,4,1,1,2,16,1,2966,3,1,1,25501,1,1,1,66,1,3,8,131,14,5,1,2,2,1,1,8,1,1,2,1,5,9,2,3,112,13,2,2,1,5,10,3,1,1,13,2,3,4,1,3,1,1,2,1,1,2,4,2,207,1,1,2,4,3,3,2,2,16};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{20,2,3,2,1,3,17,71,35,2,1,139,2,2,3,1783,475,2,1,1,3,1,3,2,32,1,2,3,1,8,30,1,3,414,1,1,135,3,3,1,414,2,1,2,2,594,2,5,6,4,11,1,2,2,1,1,52,4,1,2,7,1,17,334,1,2,1,2,2,6,1,266,1,2,217,2,6,2,13,2,2,1,2,3,5,1,2,1,7244,11813,1,33,2,0,1,2,3,13,1,92,3,13,5,14,9,141,12,6,15,25,1,1,1,46,2,1,1,141,3,1,1,1,1,2,1,4,34,5,78,8,1,2,2,1,9,10,2,1,4,13,1,5,4,4,19,5,1,1,1,68,33,399,1,1885,25,5,2,4,1,1,2,16,1,2966,3,1,1,25501,1,1,1,66,1,3,8,131,14,5,1,2,2,1,1,8,1,1,2,1,5,9,2,3,112,13,2,2,1,5,10,3,1,1,13,2,3,4,1,3,1,1,2,1,1,2,4,2,207,1,1,2,4,3,3,2,2,16};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(60));
  }
  input.set(128,Long.MAX_VALUE);
  input.set(256,Long.MAX_VALUE);
  input.set(511,Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRandomInt() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 100000; i++) {
    input.add((long)rand.nextInt());
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{-500,-400,-350,-325,-310};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerMax() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add((long)Integer.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt0() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(0,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{20,2,3,2,1,3,17,71,35,2,1,139,2,2,3,1783,475,2,1,1,3,1,3,2,32,1,2,3,1,8,30,1,3,414,1,1,135,3,3,1,414,2,1,2,2,594,2,5,6,4,11,1,2,2,1,1,52,4,1,2,7,1,17,334,1,2,1,2,2,6,1,266,1,2,217,2,6,2,13,2,2,1,2,3,5,1,2,1,7244,11813,1,33,2,-1,1,2,3,13,1,92,3,13,5,14,9,141,12,6,15,25,1,1,1,46,2,1,1,141,3,1,1,1,1,2,1,4,34,5,78,8,1,2,2,1,9,10,2,1,4,13,1,5,4,4,19,5,1,1,1,68,33,399,1,1885,25,5,2,4,1,1,2,16,1,2966,3,1,1,25501,1,1,1,66,1,3,8,131,14,5,1,2,2,1,1,8,1,1,2,1,5,9,2,3,112,13,2,2,1,5,10,3,1,1,13,2,3,4,1,3,1,1,2,1,1,2,4,2,207,1,1,2,4,3,3,2,2,16};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongMin() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add(Long.MIN_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicRow() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Row.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  writer.addRow(new Row(111,1111L));
  writer.addRow(new Row(111,1111L));
  writer.addRow(new Row(111,1111L));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new IntWritable(111),((OrcStruct)row).getFieldValue(0));
    assertEquals(new LongWritable(1111),((OrcStruct)row).getFieldValue(1));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerMin() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add((long)Integer.MIN_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseTimestamp() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(TSRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2099-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1993-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2007-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1994-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2001-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2011-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1974-01-01 00:00:00"));
  for (  Timestamp ts : tslist) {
    writer.addRow(new TSRow(ts));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((TimestampWritable)((OrcStruct)row).getFieldValue(0)).getNanos());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(1,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax4() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  for (int i=0; i < 25; i++) {
    input.add(371292224226367L);
    input.add(119622332222267L);
    input.add(686329400222007L);
    input.add(100233333222367L);
    input.add(636272333322222L);
    input.add(10202633223267L);
    input.add(36700222022230L);
    input.add(36023226224227L);
    input.add(47192226364427L);
    input.add(71963622222447L);
    input.add(22244444222222L);
    input.add(21220263327442L);
    input.add(21032233332232L);
    input.add(16026322232227L);
    input.add(40022262272212L);
    input.add(23634342227222L);
    input.add(16022222222227L);
    input.add(46026362222227L);
    input.add(46026362222227L);
    input.add(33322222222323L);
  }
  input.add(Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongMax() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add(Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{500,400,350,325,310};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRandomLong() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 100000; i++) {
    input.add(rand.nextLong());
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt256() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(256,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaOverflow() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{4513343538618202719l,4513343538618202711l,2911390882471569739l,-9181829309989854913l};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{-500,-600,-650,-675,-710};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt255() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(255,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(60));
  }
  input.set(511,Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBase510() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(510,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicNew() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{1,1,1,1,1,1,1,1,1,1,1,2,3,4,5,6,7,8,9,10,1,1,1,1,1,1,10,9,7,6,5,4,3,2,1,1,1,1,1,2,5,1,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,2000,2,1,1,1,1,1,3,7,1,9,2,6,1,1,1,1,1};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaOverflow2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{Long.MAX_VALUE,4513343538618202711l,2911390882471569739l,Long.MIN_VALUE};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta4() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{500,600,650,675,710};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicOld() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{1,1,1,1,1,1,1,1,1,1,1,2,3,4,5,6,7,8,9,10,1,1,1,1,1,1,10,9,7,6,5,4,3,2,1,1,1,1,1,2,5,1,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,2000,2,1,1,1,1,1,3,7,1,9,2,6,1,1,1,1,1};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).version(OrcFile.Version.V_0_11).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBase511() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(511,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcFile </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testSnappy() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.SNAPPY).bufferSize(100));
  Random rand=new Random(12);
  for (int i=0; i < 10000; ++i) {
    writer.addRow(new InnerStruct(rand.nextInt(),Integer.toHexString(rand.nextInt())));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  rand=new Random(12);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(rand.nextInt(),((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(rand.nextInt()),row.getFieldValue(1).toString());
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestamp() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).version(OrcFile.Version.V_0_11));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2037-01-01 00:00:00.000999"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.000000222"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00.999999999"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00.688888888"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00.1"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00.000009001"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00.000002229"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00.900203003"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.800000007"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00.723100809"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00.857340643"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  for (  Timestamp ts : tslist) {
    writer.addRow(ts);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((TimestampWritable)row).getNanos());
  }
  assertEquals(0,writer.getSchema().getMaximumId());
  boolean[] expected=new boolean[]{false};
  boolean[] included=OrcUtils.includeColumns("",writer.getSchema());
  assertEquals(true,Arrays.equals(expected,included));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testZeroCopySeek() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(200000).bufferSize(65536).rowIndexStride(1000));
  Random rand=new Random(42);
  final int COUNT=32768;
  long[] intValues=new long[COUNT];
  double[] doubleValues=new double[COUNT];
  String[] stringValues=new String[COUNT];
  BytesWritable[] byteValues=new BytesWritable[COUNT];
  String[] words=new String[128];
  for (int i=0; i < words.length; ++i) {
    words[i]=Integer.toHexString(rand.nextInt());
  }
  for (int i=0; i < COUNT / 2; ++i) {
    intValues[2 * i]=rand.nextLong();
    intValues[2 * i + 1]=intValues[2 * i];
    stringValues[2 * i]=words[rand.nextInt(words.length)];
    stringValues[2 * i + 1]=stringValues[2 * i];
  }
  for (int i=0; i < COUNT; ++i) {
    doubleValues[i]=rand.nextDouble();
    byte[] buf=new byte[20];
    rand.nextBytes(buf);
    byteValues[i]=new BytesWritable(buf);
  }
  for (int i=0; i < COUNT; ++i) {
    writer.addRow(createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i));
  }
  writer.close();
  writer=null;
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(COUNT,reader.getNumberOfRows());
  Configuration conf=new Configuration();
  HiveConf.setBoolVar(conf,HiveConf.ConfVars.HIVE_ORC_ZEROCOPY,true);
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int i=COUNT - 1; i >= 0; --i) {
    rows.seekToRow(i);
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i);
    assertEquals(expected.boolean1.booleanValue(),((BooleanWritable)row.getFieldValue(0)).get());
    assertEquals(expected.byte1.byteValue(),((ByteWritable)row.getFieldValue(1)).get());
    assertEquals(expected.short1.shortValue(),((ShortWritable)row.getFieldValue(2)).get());
    assertEquals(expected.int1.intValue(),((IntWritable)row.getFieldValue(3)).get());
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.float1.floatValue(),((FloatWritable)row.getFieldValue(5)).get(),0.0001);
    assertEquals(expected.double1.doubleValue(),((DoubleWritable)row.getFieldValue(6)).get(),0.0001);
    assertEquals(expected.bytes1,row.getFieldValue(7));
    assertEquals(expected.string1,row.getFieldValue(8));
    List<InnerStruct> expectedList=expected.middle.list;
    List<OrcStruct> actualList=(List)((OrcStruct)row.getFieldValue(9)).getFieldValue(0);
    compareList(expectedList,actualList);
    compareList(expected.list,(List)row.getFieldValue(10));
  }
  rows.close();
  Iterator<StripeInformation> stripeIterator=reader.getStripes().iterator();
  long offsetOfStripe2=0;
  long offsetOfStripe4=0;
  long lastRowOfStripe2=0;
  for (int i=0; i < 5; ++i) {
    StripeInformation stripe=stripeIterator.next();
    if (i < 2) {
      lastRowOfStripe2+=stripe.getNumberOfRows();
    }
 else     if (i == 2) {
      offsetOfStripe2=stripe.getOffset();
      lastRowOfStripe2+=stripe.getNumberOfRows() - 1;
    }
 else     if (i == 4) {
      offsetOfStripe4=stripe.getOffset();
    }
  }
  boolean[] columns=new boolean[reader.getStatistics().length];
  columns[5]=true;
  columns[9]=true;
  rows=reader.rowsOptions(new Reader.Options().range(offsetOfStripe2,offsetOfStripe4 - offsetOfStripe2).include(columns));
  rows.seekToRow(lastRowOfStripe2);
  for (int i=0; i < 2; ++i) {
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,(int)(lastRowOfStripe2 + i));
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.string1,row.getFieldValue(8));
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBitPack64Large() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  int size=1080832;
  long[] inp=new long[size];
  Random rand=new Random(1234);
  for (int i=0; i < size; i++) {
    inp[i]=rand.nextLong();
  }
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.ZLIB));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    Assert.assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPredicatePushdown() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(fs,testFilePath,conf,inspector,400000L,CompressionKind.NONE,500,1000);
  for (int i=0; i < 3500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(3500,reader.getNumberOfRows());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().startNot().lessThan("int1",PredicateLeaf.Type.LONG,300000L).end().lessThan("int1",PredicateLeaf.Type.LONG,600000L).end().build();
  RecordReader rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(1000L,rows.getRowNumber());
  OrcStruct row=null;
  for (int i=1000; i < 2000; ++i) {
    assertTrue(rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
  sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("int1",PredicateLeaf.Type.LONG,0L).end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(3500L,rows.getRowNumber());
  assertTrue(!rows.hasNext());
  sarg=SearchArgumentFactory.newBuilder().startOr().lessThan("int1",PredicateLeaf.Type.LONG,300L * 100).startNot().lessThan("int1",PredicateLeaf.Type.LONG,300L * 3400).end().end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  row=null;
  for (int i=0; i < 1000; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  for (int i=3000; i < 3500; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(200000).bufferSize(65536).rowIndexStride(1000));
  Random rand=new Random(42);
  final int COUNT=32768;
  long[] intValues=new long[COUNT];
  double[] doubleValues=new double[COUNT];
  String[] stringValues=new String[COUNT];
  BytesWritable[] byteValues=new BytesWritable[COUNT];
  String[] words=new String[128];
  for (int i=0; i < words.length; ++i) {
    words[i]=Integer.toHexString(rand.nextInt());
  }
  for (int i=0; i < COUNT / 2; ++i) {
    intValues[2 * i]=rand.nextLong();
    intValues[2 * i + 1]=intValues[2 * i];
    stringValues[2 * i]=words[rand.nextInt(words.length)];
    stringValues[2 * i + 1]=stringValues[2 * i];
  }
  for (int i=0; i < COUNT; ++i) {
    doubleValues[i]=rand.nextDouble();
    byte[] buf=new byte[20];
    rand.nextBytes(buf);
    byteValues[i]=new BytesWritable(buf);
  }
  for (int i=0; i < COUNT; ++i) {
    writer.addRow(createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(COUNT,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int i=COUNT - 1; i >= 0; --i) {
    rows.seekToRow(i);
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i);
    assertEquals(expected.boolean1.booleanValue(),((BooleanWritable)row.getFieldValue(0)).get());
    assertEquals(expected.byte1.byteValue(),((ByteWritable)row.getFieldValue(1)).get());
    assertEquals(expected.short1.shortValue(),((ShortWritable)row.getFieldValue(2)).get());
    assertEquals(expected.int1.intValue(),((IntWritable)row.getFieldValue(3)).get());
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.float1,((FloatWritable)row.getFieldValue(5)).get(),0.0001);
    assertEquals(expected.double1,((DoubleWritable)row.getFieldValue(6)).get(),0.0001);
    assertEquals(expected.bytes1,row.getFieldValue(7));
    assertEquals(expected.string1,row.getFieldValue(8));
    List<InnerStruct> expectedList=expected.middle.list;
    List<OrcStruct> actualList=(List<OrcStruct>)((OrcStruct)row.getFieldValue(9)).getFieldValue(0);
    compareList(expectedList,actualList);
    compareList(expected.list,(List<OrcStruct>)row.getFieldValue(10));
  }
  rows.close();
  Iterator<StripeInformation> stripeIterator=reader.getStripes().iterator();
  long offsetOfStripe2=0;
  long offsetOfStripe4=0;
  long lastRowOfStripe2=0;
  for (int i=0; i < 5; ++i) {
    StripeInformation stripe=stripeIterator.next();
    if (i < 2) {
      lastRowOfStripe2+=stripe.getNumberOfRows();
    }
 else     if (i == 2) {
      offsetOfStripe2=stripe.getOffset();
      lastRowOfStripe2+=stripe.getNumberOfRows() - 1;
    }
 else     if (i == 4) {
      offsetOfStripe4=stripe.getOffset();
    }
  }
  boolean[] columns=new boolean[reader.getStatistics().length];
  columns[5]=true;
  columns[9]=true;
  rows=reader.rowsOptions(new Reader.Options().range(offsetOfStripe2,offsetOfStripe4 - offsetOfStripe2).include(columns));
  rows.seekToRow(lastRowOfStripe2);
  for (int i=0; i < 2; ++i) {
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,(int)(lastRowOfStripe2 + i));
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.string1,row.getFieldValue(8));
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testWithoutIndex() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(5000).compress(CompressionKind.SNAPPY).bufferSize(1000).rowIndexStride(0));
  Random rand=new Random(24);
  for (int i=0; i < 10000; ++i) {
    InnerStruct row=new InnerStruct(rand.nextInt(),Integer.toBinaryString(rand.nextInt()));
    for (int j=0; j < 5; ++j) {
      writer.addRow(row);
    }
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(50000,reader.getNumberOfRows());
  assertEquals(0,reader.getRowIndexStride());
  StripeInformation stripe=reader.getStripes().iterator().next();
  assertEquals(true,stripe.getDataLength() != 0);
  assertEquals(0,stripe.getIndexLength());
  RecordReader rows=reader.rows();
  rand=new Random(24);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    int intVal=rand.nextInt();
    String strVal=Integer.toBinaryString(rand.nextInt());
    for (int j=0; j < 5; ++j) {
      assertEquals(true,rows.hasNext());
      row=(OrcStruct)rows.next(row);
      assertEquals(intVal,((IntWritable)row.getFieldValue(0)).get());
      assertEquals(strVal,row.getFieldValue(1).toString());
    }
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We test union, timestamp, and decimal separately since we need to make the
 * object inspector manually. (The Hive reflection-based doesn't handle
 * them properly.)
 */
@Test public void testUnionAndTimestamp() throws Exception {
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addFieldNames("time").addFieldNames("union").addFieldNames("decimal").addSubtypes(1).addSubtypes(2).addSubtypes(5).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.TIMESTAMP).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.UNION).addSubtypes(3).addSubtypes(4).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRING).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.DECIMAL).build());
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=OrcStruct.createObjectInspector(0,types);
  }
  HiveDecimal maxValue=HiveDecimal.create("10000000000000000000");
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).batchSize(1000).bufferSize(100).blockPadding(false));
  OrcStruct row=new OrcStruct(3);
  OrcUnion union=new OrcUnion();
  row.setFieldValue(1,union);
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")));
  HiveDecimal value=HiveDecimal.create("12345678.6547456");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  union.set((byte)0,new IntWritable(42));
  writer.addRow(row);
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")));
  union.set((byte)1,new Text("hello"));
  value=HiveDecimal.create("-5643.234");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  writer.addRow(row);
  row.setFieldValue(0,null);
  row.setFieldValue(1,null);
  row.setFieldValue(2,null);
  writer.addRow(row);
  row.setFieldValue(1,union);
  union.set((byte)0,null);
  writer.addRow(row);
  union.set((byte)1,null);
  writer.addRow(row);
  union.set((byte)0,new IntWritable(200000));
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")));
  value=HiveDecimal.create("10000000000000000000");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  writer.addRow(row);
  Random rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)));
    if ((i & 1) == 0) {
      union.set((byte)0,new IntWritable(i * i));
    }
 else {
      union.set((byte)1,new Text(Integer.toString(i * i)));
    }
    value=HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18));
    row.setFieldValue(2,new HiveDecimalWritable(value));
    if (maxValue.compareTo(value) < 0) {
      maxValue=value;
    }
    writer.addRow(row);
  }
  row.setFieldValue(0,null);
  union.set((byte)0,new IntWritable(1732050807));
  row.setFieldValue(2,null);
  for (int i=0; i < 5000; ++i) {
    writer.addRow(row);
  }
  union.set((byte)0,new IntWritable(0));
  writer.addRow(row);
  union.set((byte)0,new IntWritable(10));
  writer.addRow(row);
  union.set((byte)0,new IntWritable(138));
  writer.addRow(row);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(5,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,true};
  included=OrcUtils.includeColumns("time,decimal",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,true,true,true,false};
  included=OrcUtils.includeColumns("union",schema);
  assertEquals(true,Arrays.equals(expected,included));
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(5077,reader.getNumberOfRows());
  DecimalColumnStatistics stats=(DecimalColumnStatistics)reader.getStatistics()[5];
  assertEquals(71,stats.getNumberOfValues());
  assertEquals(HiveDecimal.create("-5643.234"),stats.getMinimum());
  assertEquals(maxValue,stats.getMaximum());
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  assertEquals(reader.getContentLength(),currentOffset);
  RecordReader rows=reader.rows();
  assertEquals(0,rows.getRowNumber());
  assertEquals(0.0,rows.getProgress(),0.000001);
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(1,rows.getRowNumber());
  inspector=reader.getObjectInspector();
  assertEquals("struct<time:timestamp,union:uniontype<int,string>,decimal:decimal(38,18)>",inspector.getTypeName());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")),row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(new IntWritable(42),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("12345678.6547456")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(2,rows.getRowNumber());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(null,row.getFieldValue(1));
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")),row.getFieldValue(0));
  assertEquals(new IntWritable(200000),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("10000000000000000000")),row.getFieldValue(2));
  rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)),row.getFieldValue(0));
    if ((i & 1) == 0) {
      assertEquals(0,union.getTag());
      assertEquals(new IntWritable(i * i),union.getObject());
    }
 else {
      assertEquals(1,union.getTag());
      assertEquals(new Text(Integer.toString(i * i)),union.getObject());
    }
    assertEquals(new HiveDecimalWritable(HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18))),row.getFieldValue(2));
  }
  for (int i=0; i < 5000; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new IntWritable(1732050807),union.getObject());
  }
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(0),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(10),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(138),union.getObject());
  assertEquals(false,rows.hasNext());
  assertEquals(1.0,rows.getProgress(),0.00001);
  assertEquals(reader.getNumberOfRows(),rows.getRowNumber());
  rows.seekToRow(1);
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void columnProjection() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).rowIndexStride(1000));
  Random r1=new Random(1);
  Random r2=new Random(2);
  int x;
  int minInt=0, maxInt=0;
  String y;
  String minStr=null, maxStr=null;
  for (int i=0; i < 21000; ++i) {
    x=r1.nextInt();
    y=Long.toHexString(r2.nextLong());
    if (i == 0 || x < minInt) {
      minInt=x;
    }
    if (i == 0 || x > maxInt) {
      maxInt=x;
    }
    if (i == 0 || y.compareTo(minStr) < 0) {
      minStr=y;
    }
    if (i == 0 || y.compareTo(maxStr) > 0) {
      maxStr=y;
    }
    writer.addRow(inner(x,y));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(3,stats.length);
  for (  ColumnStatistics s : stats) {
    assertEquals(21000,s.getNumberOfValues());
    if (s instanceof IntegerColumnStatistics) {
      assertEquals(minInt,((IntegerColumnStatistics)s).getMinimum());
      assertEquals(maxInt,((IntegerColumnStatistics)s).getMaximum());
    }
 else     if (s instanceof StringColumnStatistics) {
      assertEquals(maxStr,((StringColumnStatistics)s).getMaximum());
      assertEquals(minStr,((StringColumnStatistics)s).getMinimum());
    }
  }
  List<OrcProto.Type> types=reader.getTypes();
  assertEquals(3,types.size());
  assertEquals(OrcProto.Type.Kind.STRUCT,types.get(0).getKind());
  assertEquals(2,types.get(0).getSubtypesCount());
  assertEquals(1,types.get(0).getSubtypes(0));
  assertEquals(2,types.get(0).getSubtypes(1));
  assertEquals(OrcProto.Type.Kind.INT,types.get(1).getKind());
  assertEquals(0,types.get(1).getSubtypesCount());
  assertEquals(OrcProto.Type.Kind.STRING,types.get(2).getKind());
  assertEquals(0,types.get(2).getSubtypesCount());
  RecordReader rows1=reader.rows(new boolean[]{true,true,false});
  RecordReader rows2=reader.rows(new boolean[]{true,false,true});
  r1=new Random(1);
  r2=new Random(2);
  OrcStruct row1=null;
  OrcStruct row2=null;
  for (int i=0; i < 21000; ++i) {
    assertEquals(true,rows1.hasNext());
    assertEquals(true,rows2.hasNext());
    row1=(OrcStruct)rows1.next(row1);
    row2=(OrcStruct)rows2.next(row2);
    assertEquals(r1.nextInt(),((IntWritable)row1.getFieldValue(0)).get());
    assertEquals(Long.toHexString(r2.nextLong()),row2.getFieldValue(1).toString());
  }
  assertEquals(false,rows1.hasNext());
  assertEquals(false,rows2.hasNext());
  rows1.close();
  rows2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcRawRecordMerger </h4><pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the RecordReader when there is a new base and a delta.
 * @throws Exception
 */
@Test public void testRecordReaderDelta() throws Exception {
  final int BUCKET=0;
  Configuration conf=new Configuration();
  OrcOutputFormat of=new OrcOutputFormat();
  FileSystem fs=FileSystem.getLocal(conf);
  Path root=new Path(tmpDir,"testRecordReaderDelta").makeQualified(fs);
  fs.delete(root,true);
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).bucket(BUCKET).inspector(inspector).filesystem(fs).writingBase(false).minimumTransactionId(1).maximumTransactionId(1).finalDestination(root);
  RecordUpdater ru=of.getRecordUpdater(root,options);
  String[] values=new String[]{"a","b","c","d","e"};
  for (int i=0; i < values.length; ++i) {
    ru.insert(1,new MyRow(values[i]));
  }
  ru.close(false);
  options.minimumTransactionId(2).maximumTransactionId(2);
  ru=of.getRecordUpdater(root,options);
  values=new String[]{"f","g","h","i","j"};
  for (int i=0; i < values.length; ++i) {
    ru.insert(2,new MyRow(values[i]));
  }
  ru.close(false);
  InputFormat inf=new OrcInputFormat();
  JobConf job=new JobConf();
  job.set("mapred.min.split.size","1");
  job.set("mapred.max.split.size","2");
  job.set("mapred.input.dir",root.toString());
  job.set("bucket_count","1");
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,MyRow.getColumnNamesProperty());
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,MyRow.getColumnTypesProperty());
  HiveConf.setBoolVar(job,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  InputSplit[] splits=inf.getSplits(job,5);
  assertEquals(1,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,OrcStruct> rr;
  rr=inf.getRecordReader(splits[0],job,Reporter.NULL);
  values=new String[]{"a","b","c","d","e","f","g","h","i","j"};
  OrcStruct row=rr.createValue();
  for (int i=0; i < values.length; ++i) {
    System.out.println("Checking " + i);
    assertEquals(true,rr.next(NullWritable.get(),row));
    assertEquals(values[i],row.getFieldValue(0).toString());
  }
  assertEquals(false,rr.next(NullWritable.get(),row));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the RecordReader when there is a new base and a delta.
 * @throws Exception
 */
@Test public void testRecordReaderNewBaseAndDelta() throws Exception {
  final int BUCKET=11;
  Configuration conf=new Configuration();
  OrcOutputFormat of=new OrcOutputFormat();
  FileSystem fs=FileSystem.getLocal(conf);
  Path root=new Path(tmpDir,"testRecordReaderNewBaseAndDelta").makeQualified(fs);
  fs.delete(root,true);
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  MemoryManager mgr=new MemoryManager(conf){
    int rowsAddedSinceCheck=0;
    @Override public synchronized void addedRow(    int rows) throws IOException {
      rowsAddedSinceCheck+=rows;
      if (rowsAddedSinceCheck >= 2) {
        notifyWriters();
        rowsAddedSinceCheck=0;
      }
    }
  }
;
  OrcRecordUpdater.OrcOptions options=(OrcRecordUpdater.OrcOptions)new OrcRecordUpdater.OrcOptions(conf).writingBase(true).minimumTransactionId(0).maximumTransactionId(0).bucket(BUCKET).inspector(inspector).filesystem(fs);
  options.orcOptions(OrcFile.writerOptions(conf).stripeSize(1).blockPadding(false).compress(CompressionKind.NONE).memory(mgr).batchSize(2));
  options.finalDestination(root);
  RecordUpdater ru=of.getRecordUpdater(root,options);
  String[] values=new String[]{"ignore.1","0.1","ignore.2","ignore.3","2.0","2.1","3.0","ignore.4","ignore.5","ignore.6"};
  for (int i=0; i < values.length; ++i) {
    ru.insert(0,new BigRow(i,i,values[i],i,i));
  }
  ru.close(false);
  options.writingBase(false).minimumTransactionId(1).maximumTransactionId(1).recordIdColumn(5);
  ru=of.getRecordUpdater(root,options);
  values=new String[]{"0.0",null,null,"1.1",null,null,null,"ignore.7"};
  for (int i=0; i < values.length; ++i) {
    if (values[i] != null) {
      ru.update(1,new BigRow(i,i,values[i],i,i,i,0,BUCKET));
    }
  }
  ru.delete(100,new BigRow(9,0,BUCKET));
  ru.close(false);
  options.minimumTransactionId(2).maximumTransactionId(2);
  ru=of.getRecordUpdater(root,options);
  values=new String[]{null,null,"1.0",null,null,null,null,"3.1"};
  for (int i=0; i < values.length; ++i) {
    if (values[i] != null) {
      ru.update(2,new BigRow(i,i,values[i],i,i,i,0,BUCKET));
    }
  }
  ru.delete(100,new BigRow(8,0,BUCKET));
  ru.close(false);
  InputFormat inf=new OrcInputFormat();
  JobConf job=new JobConf();
  job.set("mapred.min.split.size","1");
  job.set("mapred.max.split.size","2");
  job.set("mapred.input.dir",root.toString());
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,BigRow.getColumnNamesProperty());
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,BigRow.getColumnTypesProperty());
  HiveConf.setBoolVar(job,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  InputSplit[] splits=inf.getSplits(job,5);
  assertEquals(5,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,OrcStruct> rr;
  for (int i=0; i < 4; ++i) {
    System.out.println("starting split " + i + " = "+ splits[i]);
    rr=inf.getRecordReader(splits[i],job,Reporter.NULL);
    NullWritable key=rr.createKey();
    OrcStruct value=rr.createValue();
    for (int j=0; j < 2; ++j) {
      System.out.println("i = " + i + ", j = "+ j);
      assertEquals(true,rr.next(key,value));
      System.out.println("record = " + value);
      assertEquals(i + "." + j,value.getFieldValue(2).toString());
    }
    assertEquals(false,rr.next(key,value));
  }
  rr=inf.getRecordReader(splits[4],job,Reporter.NULL);
  assertEquals(false,rr.next(rr.createKey(),rr.createValue()));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the OrcRecordUpdater with the OrcRawRecordMerger when there is
 * a base and a delta.
 * @throws Exception
 */
@Test public void testRecordReaderOldBaseAndDelta() throws Exception {
  final int BUCKET=10;
  Configuration conf=new Configuration();
  OrcOutputFormat of=new OrcOutputFormat();
  FileSystem fs=FileSystem.getLocal(conf);
  Path root=new Path(tmpDir,"testOldBaseAndDelta").makeQualified(fs);
  fs.delete(root,true);
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  MemoryManager mgr=new MemoryManager(conf){
    int rowsAddedSinceCheck=0;
    @Override public synchronized void addedRow(    int rows) throws IOException {
      rowsAddedSinceCheck+=rows;
      if (rowsAddedSinceCheck >= 2) {
        notifyWriters();
        rowsAddedSinceCheck=0;
      }
    }
  }
;
  Writer writer=OrcFile.createWriter(new Path(root,"0000010_0"),OrcFile.writerOptions(conf).inspector(inspector).fileSystem(fs).blockPadding(false).bufferSize(10000).compress(CompressionKind.NONE).stripeSize(1).memory(mgr).batchSize(2).version(OrcFile.Version.V_0_11));
  String[] values=new String[]{"ignore.1","0.1","ignore.2","ignore.3","2.0","2.1","3.0","ignore.4","ignore.5","ignore.6"};
  for (int i=0; i < values.length; ++i) {
    writer.addRow(new BigRow(i,i,values[i],i,i));
  }
  writer.close();
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).writingBase(false).minimumTransactionId(1).maximumTransactionId(1).bucket(BUCKET).inspector(inspector).filesystem(fs).recordIdColumn(5).finalDestination(root);
  RecordUpdater ru=of.getRecordUpdater(root,options);
  values=new String[]{"0.0",null,null,"1.1",null,null,null,"ignore.7"};
  for (int i=0; i < values.length; ++i) {
    if (values[i] != null) {
      ru.update(1,new BigRow(i,i,values[i],i,i,i,0,BUCKET));
    }
  }
  ru.delete(100,new BigRow(9,0,BUCKET));
  ru.close(false);
  options=options.minimumTransactionId(2).maximumTransactionId(2);
  ru=of.getRecordUpdater(root,options);
  values=new String[]{null,null,"1.0",null,null,null,null,"3.1"};
  for (int i=0; i < values.length; ++i) {
    if (values[i] != null) {
      ru.update(2,new BigRow(i,i,values[i],i,i,i,0,BUCKET));
    }
  }
  ru.delete(100,new BigRow(8,0,BUCKET));
  ru.close(false);
  InputFormat inf=new OrcInputFormat();
  JobConf job=new JobConf();
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,BigRow.getColumnNamesProperty());
  job.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,BigRow.getColumnTypesProperty());
  HiveConf.setBoolVar(job,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  job.set("mapred.min.split.size","1");
  job.set("mapred.max.split.size","2");
  job.set("mapred.input.dir",root.toString());
  InputSplit[] splits=inf.getSplits(job,5);
  assertEquals(5,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,OrcStruct> rr;
  for (int i=0; i < 4; ++i) {
    System.out.println("starting split " + i);
    rr=inf.getRecordReader(splits[i],job,Reporter.NULL);
    NullWritable key=rr.createKey();
    OrcStruct value=rr.createValue();
    for (int j=0; j < 2; ++j) {
      System.out.println("i = " + i + ", j = "+ j);
      assertEquals(true,rr.next(key,value));
      System.out.println("record = " + value);
      assertEquals(i + "." + j,value.getFieldValue(2).toString());
    }
    assertEquals(false,rr.next(key,value));
  }
  rr=inf.getRecordReader(splits[4],job,Reporter.NULL);
  assertEquals(false,rr.next(rr.createKey(),rr.createValue()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcTimezone1 </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampWriter() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  TimeZone.setDefault(TimeZone.getTimeZone(writerTimeZone));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  assertEquals(writerTimeZone,TimeZone.getDefault().getID());
  List<String> ts=Lists.newArrayList();
  ts.add("2003-01-01 01:00:00.000000222");
  ts.add("1996-08-02 09:00:00.723100809");
  ts.add("1999-01-01 02:00:00.999999999");
  ts.add("1995-01-02 03:00:00.688888888");
  ts.add("2002-01-01 04:00:00.1");
  ts.add("2010-03-02 05:00:00.000009001");
  ts.add("2005-01-01 06:00:00.000002229");
  ts.add("2006-01-01 07:00:00.900203003");
  ts.add("2003-01-01 08:00:00.800000007");
  ts.add("1998-11-02 10:00:00.857340643");
  ts.add("2008-10-02 11:00:00.0");
  ts.add("2037-01-01 00:00:00.000999");
  ts.add("2014-03-28 00:00:00.0");
  for (  String t : ts) {
    writer.addRow(Timestamp.valueOf(t));
  }
  writer.close();
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(readerTimeZone,TimeZone.getDefault().getID());
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    Timestamp got=((TimestampWritable)row).getTimestamp();
    assertEquals(ts.get(idx++),got.toString());
  }
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcTimezone2 </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampWriter() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  TimeZone.setDefault(TimeZone.getTimeZone(writerTimeZone));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  assertEquals(writerTimeZone,TimeZone.getDefault().getID());
  List<String> ts=Lists.newArrayList();
  ts.add("2003-01-01 01:00:00.000000222");
  ts.add("1999-01-01 02:00:00.999999999");
  ts.add("1995-01-02 03:00:00.688888888");
  ts.add("2002-01-01 04:00:00.1");
  ts.add("2010-03-02 05:00:00.000009001");
  ts.add("2005-01-01 06:00:00.000002229");
  ts.add("2006-01-01 07:00:00.900203003");
  ts.add("2003-01-01 08:00:00.800000007");
  ts.add("1996-08-02 09:00:00.723100809");
  ts.add("1998-11-02 10:00:00.857340643");
  ts.add("2008-10-02 11:00:00.0");
  ts.add("2037-01-01 00:00:00.000999");
  for (  String t : ts) {
    writer.addRow(Timestamp.valueOf(t));
  }
  writer.close();
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(readerTimeZone,TimeZone.getDefault().getID());
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    Timestamp got=((TimestampWritable)row).getTimestamp();
    assertEquals(ts.get(idx++),got.toString());
  }
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestStringDictionary </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHalfDistinct() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(123);
  int[] input=new int[20000];
  for (int i=0; i < 20000; i++) {
    input[i]=rand.nextInt(10000);
  }
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(input[i])));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(input[idx++])),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DICTIONARY_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHalfDistinctCheckDisabled() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  conf.setBoolean(ConfVars.HIVE_ORC_ROW_INDEX_STRIDE_DICTIONARY_CHECK.varname,false);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(123);
  int[] input=new int[20000];
  for (int i=0; i < 20000; i++) {
    input[i]=rand.nextInt(10000);
  }
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(input[i])));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(input[idx++])),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DICTIONARY_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooManyDistinctV11AlwaysDictionary() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).version(OrcFile.Version.V_0_11).bufferSize(10000));
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(idx++)),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DICTIONARY,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooManyDistinct() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(idx++)),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DIRECT_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooManyDistinctCheckDisabled() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  conf.setBoolean(ConfVars.HIVE_ORC_ROW_INDEX_STRIDE_DICTIONARY_CHECK.varname,false);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(idx++)),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DIRECT_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestUnrolledBitPack </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBitPacking() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{val,0,val,val,0,val,0,val,val,0,val,0,val,val,0,0,val,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,0,val,val};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestVectorOrcFile </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(200000).bufferSize(65536).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random rand=new Random(42);
  final int COUNT=32768;
  long[] intValues=new long[COUNT];
  double[] doubleValues=new double[COUNT];
  String[] stringValues=new String[COUNT];
  BytesWritable[] byteValues=new BytesWritable[COUNT];
  String[] words=new String[128];
  for (int i=0; i < words.length; ++i) {
    words[i]=Integer.toHexString(rand.nextInt());
  }
  for (int i=0; i < COUNT / 2; ++i) {
    intValues[2 * i]=rand.nextLong();
    intValues[2 * i + 1]=intValues[2 * i];
    stringValues[2 * i]=words[rand.nextInt(words.length)];
    stringValues[2 * i + 1]=stringValues[2 * i];
  }
  for (int i=0; i < COUNT; ++i) {
    doubleValues[i]=rand.nextDouble();
    byte[] buf=new byte[20];
    rand.nextBytes(buf);
    byteValues[i]=new BytesWritable(buf);
  }
  for (int i=0; i < COUNT; ++i) {
    appendRandomRow(batch,intValues,doubleValues,stringValues,byteValues,words,i);
    if (batch.size == 1024) {
      writer.addRowBatch(batch);
      batch.reset();
    }
  }
  if (batch.size != 0) {
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(COUNT,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  MetadataReader meta=((RecordReaderImpl)rows).getMetadataReader();
  OrcIndex index=meta.readRowIndex(reader.getStripes().get(0),null,null,null,null,null);
  for (int c=1; c < 9; ++c) {
    OrcProto.RowIndex colIndex=index.getRowGroupIndex()[c];
    assertEquals(1000,colIndex.getEntry(0).getStatistics().getNumberOfValues());
  }
  OrcStruct row=null;
  for (int i=COUNT - 1; i >= 0; --i) {
    rows.seekToRow(i);
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i);
    assertEquals(expected.boolean1.booleanValue(),((BooleanWritable)row.getFieldValue(0)).get());
    assertEquals(expected.byte1.byteValue(),((ByteWritable)row.getFieldValue(1)).get());
    assertEquals(expected.short1.shortValue(),((ShortWritable)row.getFieldValue(2)).get());
    assertEquals(expected.int1.intValue(),((IntWritable)row.getFieldValue(3)).get());
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.float1,((FloatWritable)row.getFieldValue(5)).get(),0.0001);
    assertEquals(expected.double1,((DoubleWritable)row.getFieldValue(6)).get(),0.0001);
    assertEquals(expected.bytes1,row.getFieldValue(7));
    assertEquals(expected.string1,row.getFieldValue(8));
    List<InnerStruct> expectedList=expected.middle.list;
    List<OrcStruct> actualList=(List<OrcStruct>)((OrcStruct)row.getFieldValue(9)).getFieldValue(0);
    compareList(expectedList,actualList,"middle list " + i);
    compareList(expected.list,(List<OrcStruct>)row.getFieldValue(10),"list " + i);
  }
  rows.close();
  Iterator<StripeInformation> stripeIterator=reader.getStripes().iterator();
  long offsetOfStripe2=0;
  long offsetOfStripe4=0;
  long lastRowOfStripe2=0;
  for (int i=0; i < 5; ++i) {
    StripeInformation stripe=stripeIterator.next();
    if (i < 2) {
      lastRowOfStripe2+=stripe.getNumberOfRows();
    }
 else     if (i == 2) {
      offsetOfStripe2=stripe.getOffset();
      lastRowOfStripe2+=stripe.getNumberOfRows() - 1;
    }
 else     if (i == 4) {
      offsetOfStripe4=stripe.getOffset();
    }
  }
  boolean[] columns=new boolean[reader.getStatistics().length];
  columns[5]=true;
  columns[9]=true;
  rows=reader.rowsOptions(new Reader.Options().range(offsetOfStripe2,offsetOfStripe4 - offsetOfStripe2).include(columns));
  rows.seekToRow(lastRowOfStripe2);
  for (int i=0; i < 2; ++i) {
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,(int)(lastRowOfStripe2 + i));
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.string1,row.getFieldValue(8));
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * A test case that tests the case where you add a repeating batch
 * to a column that isn't using dictionary encoding.
 * @throws Exception
 */
@Test public void testNonDictionaryRepeatingString() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("str",TypeDescription.createString());
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  for (int r=0; r < batch.size; ++r) {
    ((BytesColumnVector)batch.cols[0]).setVal(r,Integer.toString(r * 10001).getBytes());
  }
  writer.addRowBatch(batch);
  batch.cols[0].isRepeating=true;
  ((BytesColumnVector)batch.cols[0]).setVal(0,"Halloween".getBytes());
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  batch=rows.nextBatch(null);
  assertEquals(1024,batch.size);
  for (int r=0; r < 1024; ++r) {
    assertEquals(Integer.toString(r * 10001),makeString((BytesColumnVector)batch.cols[0],r));
  }
  batch=rows.nextBatch(batch);
  assertEquals(1024,batch.size);
  for (int r=0; r < 1024; ++r) {
    assertEquals("Halloween",makeString((BytesColumnVector)batch.cols[0],r));
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testColumnProjection() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random r1=new Random(1);
  Random r2=new Random(2);
  int x;
  int minInt=0, maxInt=0;
  String y;
  String minStr=null, maxStr=null;
  batch.size=1000;
  boolean first=true;
  for (int b=0; b < 21; ++b) {
    for (int r=0; r < 1000; ++r) {
      x=r1.nextInt();
      y=Long.toHexString(r2.nextLong());
      if (first || x < minInt) {
        minInt=x;
      }
      if (first || x > maxInt) {
        maxInt=x;
      }
      if (first || y.compareTo(minStr) < 0) {
        minStr=y;
      }
      if (first || y.compareTo(maxStr) > 0) {
        maxStr=y;
      }
      first=false;
      ((LongColumnVector)batch.cols[0]).vector[r]=x;
      ((BytesColumnVector)batch.cols[1]).setVal(r,y.getBytes());
    }
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(3,stats.length);
  for (  ColumnStatistics s : stats) {
    assertEquals(21000,s.getNumberOfValues());
    if (s instanceof IntegerColumnStatistics) {
      assertEquals(minInt,((IntegerColumnStatistics)s).getMinimum());
      assertEquals(maxInt,((IntegerColumnStatistics)s).getMaximum());
    }
 else     if (s instanceof StringColumnStatistics) {
      assertEquals(maxStr,((StringColumnStatistics)s).getMaximum());
      assertEquals(minStr,((StringColumnStatistics)s).getMinimum());
    }
  }
  List<OrcProto.Type> types=reader.getTypes();
  assertEquals(3,types.size());
  assertEquals(OrcProto.Type.Kind.STRUCT,types.get(0).getKind());
  assertEquals(2,types.get(0).getSubtypesCount());
  assertEquals(1,types.get(0).getSubtypes(0));
  assertEquals(2,types.get(0).getSubtypes(1));
  assertEquals(OrcProto.Type.Kind.INT,types.get(1).getKind());
  assertEquals(0,types.get(1).getSubtypesCount());
  assertEquals(OrcProto.Type.Kind.STRING,types.get(2).getKind());
  assertEquals(0,types.get(2).getSubtypesCount());
  RecordReader rows1=reader.rows(new boolean[]{true,true,false});
  RecordReader rows2=reader.rows(new boolean[]{true,false,true});
  r1=new Random(1);
  r2=new Random(2);
  OrcStruct row1=null;
  OrcStruct row2=null;
  for (int i=0; i < 21000; ++i) {
    assertEquals(true,rows1.hasNext());
    assertEquals(true,rows2.hasNext());
    row1=(OrcStruct)rows1.next(row1);
    row2=(OrcStruct)rows2.next(row2);
    assertEquals(r1.nextInt(),((IntWritable)row1.getFieldValue(0)).get());
    assertEquals(Long.toHexString(r2.nextLong()),row2.getFieldValue(1).toString());
  }
  assertEquals(false,rows1.hasNext());
  assertEquals(false,rows2.hasNext());
  rows1.close();
  rows2.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Unions.
 * @throws Exception
 */
@Test public void testUnions() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("outer",TypeDescription.createUnion().addUnionChild(TypeDescription.createInt()).addUnionChild(TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  UnionColumnVector outer=(UnionColumnVector)batch.cols[0];
  batch.cols[0].noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      outer.isNull[r]=true;
    }
 else     if (r < 300) {
      outer.tags[r]=0;
    }
 else     if (r < 400) {
      outer.tags[r]=1;
    }
 else     if (r < 600) {
      outer.isNull[r]=true;
    }
 else     if (r < 800) {
      outer.tags[r]=1;
    }
 else     if (r < 1000) {
      outer.isNull[r]=true;
    }
 else {
      outer.tags[r]=1;
    }
    ((LongColumnVector)outer.fields[0]).vector[r]=r;
    ((LongColumnVector)outer.fields[1]).vector[r]=-r;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    OrcUnion inner=(OrcUnion)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"union(0, " + r + ")",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 800) {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
 else     if (r < 1000) {
      assertEquals("row " + r,null,inner);
    }
 else {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test lists and how they interact with the child column. In particular,
 * put nulls between back to back lists and then make some lists that
 * oper lap.
 * @throws Exception
 */
@Test public void testLists() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("list",TypeDescription.createList(TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  ListColumnVector list=(ListColumnVector)batch.cols[0];
  list.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      list.isNull[r]=true;
    }
 else     if (r < 300) {
      list.offsets[r]=r - 200;
      list.lengths[r]=1;
    }
 else     if (r < 400) {
      list.isNull[r]=true;
    }
 else     if (r < 500) {
      list.offsets[r]=r - 300;
      list.lengths[r]=1;
    }
 else     if (r < 600) {
      list.isNull[r]=true;
    }
 else     if (r < 700) {
      list.offsets[r]=r;
      list.lengths[r]=2;
    }
 else {
      list.isNull[r]=true;
    }
    ((LongColumnVector)list.child).vector[r]=r * 10;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    List inner=(List)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"[" + ((r - 200) * 10) + "]",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 500) {
      assertEquals("row " + r,"[" + ((r - 300) * 10) + "]",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 700) {
      assertEquals("row " + r,"[" + (10 * r) + ", "+ (10 * (r + 1))+ "]",inner.toString());
    }
 else {
      assertEquals("row " + r,null,inner);
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testWithoutIndex() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(5000).compress(CompressionKind.SNAPPY).bufferSize(1000).rowIndexStride(0));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random rand=new Random(24);
  batch.size=5;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
  }
  for (int i=0; i < 10000; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[0]=rand.nextInt();
    ((BytesColumnVector)batch.cols[1]).setVal(0,Integer.toBinaryString(rand.nextInt()).getBytes());
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(50000,reader.getNumberOfRows());
  assertEquals(0,reader.getRowIndexStride());
  StripeInformation stripe=reader.getStripes().iterator().next();
  assertEquals(true,stripe.getDataLength() != 0);
  assertEquals(0,stripe.getIndexLength());
  RecordReader rows=reader.rows();
  rand=new Random(24);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    int intVal=rand.nextInt();
    String strVal=Integer.toBinaryString(rand.nextInt());
    for (int j=0; j < 5; ++j) {
      assertEquals(true,rows.hasNext());
      row=(OrcStruct)rows.next(row);
      assertEquals(intVal,((IntWritable)row.getFieldValue(0)).get());
      assertEquals(strVal,row.getFieldValue(1).toString());
    }
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStructs() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("struct",TypeDescription.createStruct().addField("inner",TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  StructColumnVector outer=(StructColumnVector)batch.cols[0];
  outer.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200 || (r >= 400 && r < 600) || r >= 800) {
      outer.isNull[r]=true;
    }
    ((LongColumnVector)outer.fields[0]).vector[r]=r;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    OrcStruct inner=(OrcStruct)row.getFieldValue(0);
    if (r < 200 || (r >= 400 && r < 600) || r >= 800) {
      assertEquals("row " + r,null,inner);
    }
 else {
      assertEquals("row " + r,"{" + r + "}",inner.toString());
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test all of the types that have distinct ORC writers using the vectorized
 * writer with different combinations of repeating and null values.
 * @throws Exception
 */
@Test public void testRepeating() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("bin",TypeDescription.createBinary()).addField("bool",TypeDescription.createBoolean()).addField("byte",TypeDescription.createByte()).addField("long",TypeDescription.createLong()).addField("float",TypeDescription.createFloat()).addField("double",TypeDescription.createDouble()).addField("date",TypeDescription.createDate()).addField("time",TypeDescription.createTimestamp()).addField("dec",TypeDescription.createDecimal().withPrecision(20).withScale(6)).addField("string",TypeDescription.createString()).addField("char",TypeDescription.createChar().withMaxLength(10)).addField("vc",TypeDescription.createVarchar().withMaxLength(10)).addField("struct",TypeDescription.createStruct().addField("sub1",TypeDescription.createInt())).addField("union",TypeDescription.createUnion().addUnionChild(TypeDescription.createString()).addUnionChild(TypeDescription.createInt())).addField("list",TypeDescription.createList(TypeDescription.createInt())).addField("map",TypeDescription.createMap(TypeDescription.createString(),TypeDescription.createString()));
  VectorizedRowBatch batch=schema.createRowBatch();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).rowIndexStride(1000));
  batch.size=1024;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
    batch.cols[c].noNulls=false;
    batch.cols[c].isNull[0]=true;
  }
  writer.addRowBatch(batch);
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].isNull[0]=false;
  }
  ((BytesColumnVector)batch.cols[0]).setVal(0,"Horton".getBytes());
  ((LongColumnVector)batch.cols[1]).vector[0]=1;
  ((LongColumnVector)batch.cols[2]).vector[0]=130;
  ((LongColumnVector)batch.cols[3]).vector[0]=0x123456789abcdef0L;
  ((DoubleColumnVector)batch.cols[4]).vector[0]=1.125;
  ((DoubleColumnVector)batch.cols[5]).vector[0]=0.0009765625;
  ((LongColumnVector)batch.cols[6]).vector[0]=new DateWritable(new Date(111,6,1)).getDays();
  ((LongColumnVector)batch.cols[7]).vector[0]=TimestampUtils.getTimeNanoSec(new Timestamp(115,9,23,10,11,59,999999999));
  ((DecimalColumnVector)batch.cols[8]).vector[0]=new HiveDecimalWritable("1.234567");
  ((BytesColumnVector)batch.cols[9]).setVal(0,"Echelon".getBytes());
  ((BytesColumnVector)batch.cols[10]).setVal(0,"Juggernaut".getBytes());
  ((BytesColumnVector)batch.cols[11]).setVal(0,"Dreadnaught".getBytes());
  ((LongColumnVector)((StructColumnVector)batch.cols[12]).fields[0]).vector[0]=123;
  ((UnionColumnVector)batch.cols[13]).tags[0]=1;
  ((LongColumnVector)((UnionColumnVector)batch.cols[13]).fields[1]).vector[0]=1234;
  ((ListColumnVector)batch.cols[14]).offsets[0]=0;
  ((ListColumnVector)batch.cols[14]).lengths[0]=3;
  ((ListColumnVector)batch.cols[14]).child.isRepeating=true;
  ((LongColumnVector)((ListColumnVector)batch.cols[14]).child).vector[0]=31415;
  ((MapColumnVector)batch.cols[15]).offsets[0]=0;
  ((MapColumnVector)batch.cols[15]).lengths[0]=3;
  ((MapColumnVector)batch.cols[15]).values.isRepeating=true;
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(0,"ORC".getBytes());
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(1,"Hive".getBytes());
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(2,"LLAP".getBytes());
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).values).setVal(0,"fast".getBytes());
  writer.addRowBatch(batch);
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(false);
    batch.cols[c].noNulls=false;
    Arrays.fill(batch.cols[c].isNull,true);
  }
  writer.addRowBatch(batch);
  batch.reset();
  batch.size=1024;
  ((ListColumnVector)batch.cols[14]).child.ensureSize(3 * 1024,false);
  ((MapColumnVector)batch.cols[15]).keys.ensureSize(3 * 1024,false);
  ((MapColumnVector)batch.cols[15]).values.ensureSize(3 * 1024,false);
  for (int r=0; r < 1024; ++r) {
    ((BytesColumnVector)batch.cols[0]).setVal(r,Integer.toHexString(r).getBytes());
    ((LongColumnVector)batch.cols[1]).vector[r]=r % 2;
    ((LongColumnVector)batch.cols[2]).vector[r]=(r % 255);
    ((LongColumnVector)batch.cols[3]).vector[r]=31415L * r;
    ((DoubleColumnVector)batch.cols[4]).vector[r]=1.125 * r;
    ((DoubleColumnVector)batch.cols[5]).vector[r]=0.0009765625 * r;
    ((LongColumnVector)batch.cols[6]).vector[r]=new DateWritable(new Date(111,6,1)).getDays() + r;
    ((LongColumnVector)batch.cols[7]).vector[r]=TimestampUtils.getTimeNanoSec(new Timestamp(115,9,23,10,11,59,999999999)) + r * 1000000000L;
    ((DecimalColumnVector)batch.cols[8]).vector[r]=new HiveDecimalWritable("1.234567");
    ((BytesColumnVector)batch.cols[9]).setVal(r,Integer.toString(r).getBytes());
    ((BytesColumnVector)batch.cols[10]).setVal(r,Integer.toHexString(r).getBytes());
    ((BytesColumnVector)batch.cols[11]).setVal(r,Integer.toHexString(r * 128).getBytes());
    ((LongColumnVector)((StructColumnVector)batch.cols[12]).fields[0]).vector[r]=r + 13;
    ((UnionColumnVector)batch.cols[13]).tags[r]=1;
    ((LongColumnVector)((UnionColumnVector)batch.cols[13]).fields[1]).vector[r]=r + 42;
    ((ListColumnVector)batch.cols[14]).offsets[r]=3 * r;
    ((ListColumnVector)batch.cols[14]).lengths[r]=3;
    for (int i=0; i < 3; ++i) {
      ((LongColumnVector)((ListColumnVector)batch.cols[14]).child).vector[3 * r + i]=31415 + i;
    }
    ((MapColumnVector)batch.cols[15]).offsets[r]=3 * r;
    ((MapColumnVector)batch.cols[15]).lengths[r]=3;
    for (int i=0; i < 3; ++i) {
      ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(3 * r + i,Integer.toHexString(3 * r + i).getBytes());
      ((BytesColumnVector)((MapColumnVector)batch.cols[15]).values).setVal(3 * r + i,Integer.toString(3 * r + i).getBytes());
    }
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4096,stats[0].getNumberOfValues());
  assertEquals(false,stats[0].hasNull());
  for (  TypeDescription colType : schema.getChildren()) {
    assertEquals("count on " + colType.getId(),2048,stats[colType.getId()].getNumberOfValues());
    assertEquals("hasNull on " + colType.getId(),true,stats[colType.getId()].hasNull());
  }
  assertEquals(8944,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals(1536,((BooleanColumnStatistics)stats[2]).getTrueCount());
  assertEquals(512,((BooleanColumnStatistics)stats[2]).getFalseCount());
  assertEquals(false,((IntegerColumnStatistics)stats[4]).isSumDefined());
  assertEquals(0,((IntegerColumnStatistics)stats[4]).getMinimum());
  assertEquals(0x123456789abcdef0L,((IntegerColumnStatistics)stats[4]).getMaximum());
  assertEquals("0",((StringColumnStatistics)stats[10]).getMinimum());
  assertEquals("Echelon",((StringColumnStatistics)stats[10]).getMaximum());
  assertEquals(10154,((StringColumnStatistics)stats[10]).getSum());
  assertEquals("0         ",((StringColumnStatistics)stats[11]).getMinimum());
  assertEquals("ff        ",((StringColumnStatistics)stats[11]).getMaximum());
  assertEquals(20480,((StringColumnStatistics)stats[11]).getSum());
  assertEquals("0",((StringColumnStatistics)stats[12]).getMinimum());
  assertEquals("ff80",((StringColumnStatistics)stats[12]).getMaximum());
  assertEquals(14813,((StringColumnStatistics)stats[12]).getSum());
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    for (int f=0; f < row.getNumFields(); ++f) {
      assertEquals("non-null on row " + r + " field "+ f,null,row.getFieldValue(f));
    }
  }
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals("row " + r,"48 6f 72 74 6f 6e",row.getFieldValue(0).toString());
    assertEquals("row " + r,"true",row.getFieldValue(1).toString());
    assertEquals("row " + r,"-126",row.getFieldValue(2).toString());
    assertEquals("row " + r,"1311768467463790320",row.getFieldValue(3).toString());
    assertEquals("row " + r,"1.125",row.getFieldValue(4).toString());
    assertEquals("row " + r,"9.765625E-4",row.getFieldValue(5).toString());
    assertEquals("row " + r,"2011-07-01",row.getFieldValue(6).toString());
    assertEquals("row " + r,"2015-10-23 10:11:59.999999999",row.getFieldValue(7).toString());
    assertEquals("row " + r,"1.234567",row.getFieldValue(8).toString());
    assertEquals("row " + r,"Echelon",row.getFieldValue(9).toString());
    assertEquals("row " + r,"Juggernaut",row.getFieldValue(10).toString());
    assertEquals("row " + r,"Dreadnaugh",row.getFieldValue(11).toString());
    assertEquals("row " + r,"{123}",row.getFieldValue(12).toString());
    assertEquals("row " + r,"union(1, 1234)",row.getFieldValue(13).toString());
    assertEquals("row " + r,"[31415, 31415, 31415]",row.getFieldValue(14).toString());
    assertEquals("row " + r,"{ORC=fast, Hive=fast, LLAP=fast}",row.getFieldValue(15).toString());
  }
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    for (int f=0; f < row.getNumFields(); ++f) {
      assertEquals("non-null on row " + r + " field "+ f,null,row.getFieldValue(f));
    }
  }
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    byte[] hex=Integer.toHexString(r).getBytes();
    StringBuilder expected=new StringBuilder();
    for (int i=0; i < hex.length; ++i) {
      if (i != 0) {
        expected.append(' ');
      }
      expected.append(Integer.toHexString(hex[i]));
    }
    assertEquals("row " + r,expected.toString(),row.getFieldValue(0).toString());
    assertEquals("row " + r,r % 2 == 1 ? "true" : "false",row.getFieldValue(1).toString());
    assertEquals("row " + r,Integer.toString((byte)(r % 255)),row.getFieldValue(2).toString());
    assertEquals("row " + r,Long.toString(31415L * r),row.getFieldValue(3).toString());
    assertEquals("row " + r,Float.toString(1.125F * r),row.getFieldValue(4).toString());
    assertEquals("row " + r,Double.toString(0.0009765625 * r),row.getFieldValue(5).toString());
    assertEquals("row " + r,new Date(111,6,1 + r).toString(),row.getFieldValue(6).toString());
    assertEquals("row " + r,new Timestamp(115,9,23,10,11,59 + r,999999999).toString(),row.getFieldValue(7).toString());
    assertEquals("row " + r,"1.234567",row.getFieldValue(8).toString());
    assertEquals("row " + r,Integer.toString(r),row.getFieldValue(9).toString());
    assertEquals("row " + r,pad(Integer.toHexString(r),10),row.getFieldValue(10).toString());
    assertEquals("row " + r,Integer.toHexString(r * 128),row.getFieldValue(11).toString());
    assertEquals("row " + r,"{" + Integer.toString(r + 13) + "}",row.getFieldValue(12).toString());
    assertEquals("row " + r,"union(1, " + Integer.toString(r + 42) + ")",row.getFieldValue(13).toString());
    assertEquals("row " + r,"[31415, 31416, 31417]",row.getFieldValue(14).toString());
    expected=new StringBuilder();
    expected.append('{');
    expected.append(Integer.toHexString(3 * r));
    expected.append('=');
    expected.append(3 * r);
    expected.append(", ");
    expected.append(Integer.toHexString(3 * r + 1));
    expected.append('=');
    expected.append(3 * r + 1);
    expected.append(", ");
    expected.append(Integer.toHexString(3 * r + 2));
    expected.append('=');
    expected.append(3 * r + 2);
    expected.append('}');
    assertEquals("row " + r,expected.toString(),row.getFieldValue(15).toString());
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestamp() throws Exception {
  ObjectInspector inspector;
synchronized (TestVectorOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  TypeDescription schema=TypeDescription.createTimestamp();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000).version(org.apache.orc.OrcFile.Version.V_0_11));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2037-01-01 00:00:00.000999"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.000000222"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00.999999999"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00.688888888"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00.1"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00.000009001"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00.000002229"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00.900203003"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.800000007"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00.723100809"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00.857340643"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  VectorizedRowBatch batch=new VectorizedRowBatch(1,1024);
  LongColumnVector vec=new LongColumnVector(1024);
  batch.cols[0]=vec;
  batch.reset();
  batch.size=tslist.size();
  for (int i=0; i < tslist.size(); ++i) {
    Timestamp ts=tslist.get(i);
    vec.vector[i]=TimestampUtils.getTimeNanoSec(ts);
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((TimestampWritable)row).getNanos());
  }
  assertEquals(tslist.size(),rows.getRowNumber());
  assertEquals(0,writer.getSchema().getMaximumId());
  boolean[] expected=new boolean[]{false};
  boolean[] included=OrcUtils.includeColumns("",writer.getSchema());
  assertEquals(true,Arrays.equals(expected,included));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We test union, timestamp, and decimal separately since we need to make the
 * object inspector manually. (The Hive reflection-based doesn't handle
 * them properly.)
 */
@Test public void testUnionAndTimestamp() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("time",TypeDescription.createTimestamp()).addField("union",TypeDescription.createUnion().addUnionChild(TypeDescription.createInt()).addUnionChild(TypeDescription.createString())).addField("decimal",TypeDescription.createDecimal().withPrecision(38).withScale(18));
  HiveDecimal maxValue=HiveDecimal.create("10000000000000000000");
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).blockPadding(false));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=6;
  setUnion(batch,0,Timestamp.valueOf("2000-03-12 15:00:00"),0,42,null,new HiveDecimalWritable("12345678.6547456"));
  setUnion(batch,1,Timestamp.valueOf("2000-03-20 12:00:00.123456789"),1,null,"hello",new HiveDecimalWritable("-5643.234"));
  setUnion(batch,2,null,null,null,null,null);
  setUnion(batch,3,null,0,null,null,null);
  setUnion(batch,4,null,1,null,null,null);
  setUnion(batch,5,Timestamp.valueOf("1970-01-01 00:00:00"),0,200000,null,new HiveDecimalWritable("10000000000000000000"));
  writer.addRowBatch(batch);
  batch.reset();
  Random rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    Timestamp ts=Timestamp.valueOf(i + "-05-05 12:34:56." + i);
    HiveDecimal dec=HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18));
    if ((i & 1) == 0) {
      setUnion(batch,batch.size++,ts,0,i * i,null,new HiveDecimalWritable(dec));
    }
 else {
      setUnion(batch,batch.size++,ts,1,null,Integer.toString(i * i),new HiveDecimalWritable(dec));
    }
    if (maxValue.compareTo(dec) < 0) {
      maxValue=dec;
    }
  }
  writer.addRowBatch(batch);
  batch.reset();
  batch.size=1000;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
  }
  setUnion(batch,0,null,0,1732050807,null,null);
  for (int i=0; i < 5; ++i) {
    writer.addRowBatch(batch);
  }
  batch.reset();
  batch.size=3;
  setUnion(batch,0,null,0,0,null,null);
  setUnion(batch,1,null,0,10,null,null);
  setUnion(batch,2,null,0,138,null,null);
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(5,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,true};
  included=OrcUtils.includeColumns("time,decimal",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,true,true,true,false};
  included=OrcUtils.includeColumns("union",schema);
  assertEquals(true,Arrays.equals(expected,included));
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(5077,reader.getNumberOfRows());
  DecimalColumnStatistics stats=(DecimalColumnStatistics)reader.getStatistics()[5];
  assertEquals(71,stats.getNumberOfValues());
  assertEquals(HiveDecimal.create("-5643.234"),stats.getMinimum());
  assertEquals(maxValue,stats.getMaximum());
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  assertEquals(reader.getContentLength(),currentOffset);
  RecordReader rows=reader.rows();
  assertEquals(0,rows.getRowNumber());
  assertEquals(0.0,rows.getProgress(),0.000001);
  assertEquals(true,rows.hasNext());
  OrcStruct row=(OrcStruct)rows.next(null);
  assertEquals(1,rows.getRowNumber());
  ObjectInspector inspector=reader.getObjectInspector();
  assertEquals("struct<time:timestamp,union:uniontype<int,string>,decimal:decimal(38,18)>",inspector.getTypeName());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")),row.getFieldValue(0));
  OrcUnion union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(new IntWritable(42),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("12345678.6547456")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(2,rows.getRowNumber());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(null,row.getFieldValue(1));
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")),row.getFieldValue(0));
  assertEquals(new IntWritable(200000),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("10000000000000000000")),row.getFieldValue(2));
  rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)),row.getFieldValue(0));
    if ((i & 1) == 0) {
      assertEquals(0,union.getTag());
      assertEquals(new IntWritable(i * i),union.getObject());
    }
 else {
      assertEquals(1,union.getTag());
      assertEquals(new Text(Integer.toString(i * i)),union.getObject());
    }
    assertEquals(new HiveDecimalWritable(HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18))),row.getFieldValue(2));
  }
  for (int i=0; i < 5000; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new IntWritable(1732050807),union.getObject());
  }
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(0),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(10),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(138),union.getObject());
  assertEquals(false,rows.hasNext());
  assertEquals(1.0,rows.getProgress(),0.00001);
  assertEquals(reader.getNumberOfRows(),rows.getRowNumber());
  rows.seekToRow(1);
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test maps and how they interact with the child column. In particular,
 * put nulls between back to back lists and then make some lists that
 * oper lap.
 * @throws Exception
 */
@Test public void testMaps() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("map",TypeDescription.createMap(TypeDescription.createLong(),TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  MapColumnVector map=(MapColumnVector)batch.cols[0];
  map.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      map.isNull[r]=true;
    }
 else     if (r < 300) {
      map.offsets[r]=r - 200;
      map.lengths[r]=1;
    }
 else     if (r < 400) {
      map.isNull[r]=true;
    }
 else     if (r < 500) {
      map.offsets[r]=r - 300;
      map.lengths[r]=1;
    }
 else     if (r < 600) {
      map.isNull[r]=true;
    }
 else     if (r < 700) {
      map.offsets[r]=r;
      map.lengths[r]=2;
    }
 else {
      map.isNull[r]=true;
    }
    ((LongColumnVector)map.keys).vector[r]=r;
    ((LongColumnVector)map.values).vector[r]=r * 10;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    Map inner=(Map)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"{" + (r - 200) + "="+ ((r - 200) * 10)+ "}",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 500) {
      assertEquals("row " + r,"{" + (r - 300) + "="+ ((r - 300) * 10)+ "}",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 700) {
      assertEquals("row " + r,"{" + r + "="+ (r * 10)+ ", "+ (r + 1)+ "="+ (10 * (r + 1))+ "}",inner.toString());
    }
 else {
      assertEquals("row " + r,null,inner);
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testSnappy() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.SNAPPY).bufferSize(100));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random rand=new Random(12);
  batch.size=1000;
  for (int b=0; b < 10; ++b) {
    for (int r=0; r < 1000; ++r) {
      ((LongColumnVector)batch.cols[0]).vector[r]=rand.nextInt();
      ((BytesColumnVector)batch.cols[1]).setVal(r,Integer.toHexString(rand.nextInt()).getBytes());
    }
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  rand=new Random(12);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(rand.nextInt(),((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(rand.nextInt()),row.getFieldValue(1).toString());
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPredicatePushdown() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(400000L).compress(CompressionKind.NONE).bufferSize(500).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.ensureSize(3500);
  batch.size=3500;
  for (int i=0; i < 3500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[i]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(i,Integer.toHexString(10 * i).getBytes());
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(3500,reader.getNumberOfRows());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().startNot().lessThan("int1",PredicateLeaf.Type.LONG,300000L).end().lessThan("int1",PredicateLeaf.Type.LONG,600000L).end().build();
  RecordReader rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(1000L,rows.getRowNumber());
  OrcStruct row=null;
  for (int i=1000; i < 2000; ++i) {
    assertTrue(rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
  sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("int1",PredicateLeaf.Type.LONG,0L).end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(3500L,rows.getRowNumber());
  assertTrue(!rows.hasNext());
  sarg=SearchArgumentFactory.newBuilder().startOr().lessThan("int1",PredicateLeaf.Type.LONG,300L * 100).startNot().lessThan("int1",PredicateLeaf.Type.LONG,300L * 3400).end().end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  row=null;
  for (int i=0; i < 1000; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  for (int i=3000; i < 3500; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.serde.TestParquetHiveArrayInspector </h4><pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegularList(){
  final ArrayWritable list=new ArrayWritable(Writable.class,new Writable[]{new IntWritable(3),new IntWritable(5),new IntWritable(1)});
  final List<Writable> expected=new ArrayList<Writable>();
  expected.add(new IntWritable(3));
  expected.add(new IntWritable(5));
  expected.add(new IntWritable(1));
  assertEquals("Wrong size",3,inspector.getListLength(list));
  assertEquals("Wrong result of inspection",expected,inspector.getList(list));
  for (int i=0; i < expected.size(); ++i) {
    assertEquals("Wrong result of inspection",expected.get(i),inspector.getListElement(list,i));
  }
  assertNull("Should be null",inspector.getListElement(list,3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestParseDriver </h4><pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParse() throws Exception {
  String selectStr="select field1, field2, sum(field3+field4)";
  String whereStr="field5=1 and field6 in ('a', 'b')";
  String havingStr="sum(field7) > 11";
  ASTNode tree=parseDriver.parse(selectStr + " from table1 where " + whereStr+ " group by field1, field2 having  "+ havingStr);
  assertEquals(tree.getType(),0);
  assertEquals(tree.getChildCount(),2);
  ASTNode queryTree=(ASTNode)tree.getChild(0);
  assertEquals(tree.getChild(1).getType(),HiveParser.EOF);
  assertEquals(queryTree.getChildCount(),2);
  ASTNode fromAST=(ASTNode)queryTree.getChild(0);
  ASTNode insertAST=(ASTNode)queryTree.getChild(1);
  assertEquals(fromAST.getType(),HiveParser.TOK_FROM);
  assertEquals(fromAST.getChildCount(),1);
  assertEquals(fromAST.getChild(0).getType(),HiveParser.TOK_TABREF);
  assertEquals(fromAST.getChild(0).getChildCount(),1);
  assertEquals(fromAST.getChild(0).getChild(0).getType(),HiveParser.TOK_TABNAME);
  assertEquals(fromAST.getChild(0).getChild(0).getChildCount(),1);
  assertEquals(fromAST.getChild(0).getChild(0).getChild(0).getType(),HiveParser.Identifier);
  assertEquals(fromAST.getChild(0).getChild(0).getChild(0).getText(),"table1");
  assertEquals(insertAST.getChildCount(),5);
  assertEquals(insertAST.getChild(0).getType(),HiveParser.TOK_DESTINATION);
  assertTree((ASTNode)insertAST.getChild(1),parseDriver.parseSelect(selectStr,null));
  assertEquals(insertAST.getChild(2).getType(),HiveParser.TOK_WHERE);
  assertTree((ASTNode)insertAST.getChild(2).getChild(0),parseDriver.parseExpression(whereStr));
  assertEquals(insertAST.getChild(3).getType(),HiveParser.TOK_GROUPBY);
  assertEquals(insertAST.getChild(3).getChildCount(),2);
  for (int i=0; i < 2; i++) {
    assertEquals(insertAST.getChild(3).getChild(i).getType(),HiveParser.TOK_TABLE_OR_COL);
    assertEquals(insertAST.getChild(3).getChild(i).getChild(0).getType(),HiveParser.Identifier);
    assertEquals(insertAST.getChild(3).getChild(i).getChild(0).getText(),"field" + (i + 1));
  }
  assertEquals(insertAST.getChild(4).getType(),HiveParser.TOK_HAVING);
  assertEquals(insertAST.getChild(4).getChildCount(),1);
  assertTree((ASTNode)insertAST.getChild(4).getChild(0),parseDriver.parseExpression(havingStr));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseExpression() throws Exception {
  ASTNode plusNode=parseDriver.parseExpression("field3 + field4");
  assertEquals(plusNode.getType(),HiveParser.PLUS);
  assertEquals(plusNode.getChildCount(),2);
  for (int i=0; i < 2; i++) {
    assertEquals(plusNode.getChild(i).getType(),HiveParser.TOK_TABLE_OR_COL);
    assertEquals(plusNode.getChild(i).getChildCount(),1);
    assertEquals(plusNode.getChild(i).getChild(0).getType(),HiveParser.Identifier);
    assertEquals(plusNode.getChild(i).getChild(0).getText(),"field" + (i + 3));
  }
  ASTNode sumNode=parseDriver.parseExpression("sum(field3 + field4)");
  assertEquals(sumNode.getType(),HiveParser.TOK_FUNCTION);
  assertEquals(sumNode.getChildCount(),2);
  assertEquals(sumNode.getChild(0).getType(),HiveParser.Identifier);
  assertEquals(sumNode.getChild(0).getText(),"sum");
  assertTree((ASTNode)sumNode.getChild(1),plusNode);
  ASTNode tree=parseDriver.parseExpression("case when field1 = 1 then sum(field3 + field4) when field1 != 2 then " + "sum(field3-field4) else sum(field3 * field4) end");
  assertEquals(tree.getChildCount(),6);
  assertEquals(tree.getChild(0).getType(),HiveParser.KW_WHEN);
  assertEquals(tree.getChild(1).getType(),HiveParser.EQUAL);
  assertTree((ASTNode)tree.getChild(2),sumNode);
  assertEquals(tree.getChild(3).getType(),HiveParser.NOTEQUAL);
  assertTree((ASTNode)tree.getChild(4),parseDriver.parseExpression("sum(field3-field4)"));
  assertTree((ASTNode)tree.getChild(5),parseDriver.parseExpression("sum(field3*field4)"));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseSelect() throws Exception {
  ASTNode tree=parseDriver.parseSelect("select field1, field2, sum(field3+field4)",null);
  assertEquals(tree.getType(),HiveParser.TOK_SELECT);
  assertEquals(tree.getChildCount(),3);
  for (int i=0; i < 3; i++) {
    assertEquals(((ASTNode)tree.getChild(i)).getType(),HiveParser.TOK_SELEXPR);
  }
  assertTree((ASTNode)tree.getChild(0).getChild(0),parseDriver.parseExpression("field1"));
  assertTree((ASTNode)tree.getChild(1).getChild(0),parseDriver.parseExpression("field2"));
  assertTree((ASTNode)tree.getChild(2).getChild(0),parseDriver.parseExpression("sum(field3+field4)"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestTezWork </h4><pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetAllWork() throws Exception {
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.SIMPLE_EDGE);
  for (int i=4; i > 0; --i) {
    work.connect(nodes.get(i),nodes.get(i - 1),edgeProp);
  }
  List<BaseWork> sorted=work.getAllWork();
  for (int i=0; i < 5; ++i) {
    Assert.assertEquals(sorted.get(i),nodes.get(4 - i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCompactor </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dynamicPartitioningUpdate() throws Exception {
  String tblName="udpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("update " + tblName + " set b = 'barney'",driver);
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,1);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=today",names.get(0));
  Assert.assertEquals("ds=yesterday",names.get(1));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dynamicPartitioningDelete() throws Exception {
  String tblName="ddpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("update " + tblName + " set b = 'fred' where a = 1",driver);
  executeStatementOnDriver("delete from " + tblName + " where b = 'fred'",driver);
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,2);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=today",names.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dynamicPartitioningInsert() throws Exception {
  String tblName="dpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,0);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=today",names.get(0));
  Assert.assertEquals("ds=yesterday",names.get(1));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Simple schema evolution add columns with partitioning.
 * @throws Exception
 */
@Test public void schemaEvolutionAddColDynamicPartitioningInsert() throws Exception {
  String tblName="dpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("ALTER TABLE " + tblName + " ADD COLUMNS(c int)",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(2,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tfred\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\twilma\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values "+ "(3, 'mark', 1900, 'soon'), (4, 'douglas', 1901, 'last_century'), "+ "(5, 'doc', 1902, 'yesterday')",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tfred\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\twilma\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t1900\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t1901\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t1902\tyesterday",valuesReadFromHiveDriver.get(4));
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,0);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(4,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=last_century",names.get(0));
  Assert.assertEquals("ds=soon",names.get(1));
  Assert.assertEquals("ds=today",names.get(2));
  Assert.assertEquals("ds=yesterday",names.get(3));
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tfred\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\twilma\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t1900\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t1901\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t1902\tyesterday",valuesReadFromHiveDriver.get(4));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void schemaEvolutionAddColDynamicPartitioningUpdate() throws Exception {
  String tblName="udpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("update " + tblName + " set b = 'barney'",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(2,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\tyesterday",valuesReadFromHiveDriver.get(1));
  executeStatementOnDriver("ALTER TABLE " + tblName + " ADD COLUMNS(c int)",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(2,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values "+ "(3, 'mark', 1900, 'soon'), (4, 'douglas', 1901, 'last_century'), "+ "(5, 'doc', 1902, 'yesterday')",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t1900\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t1901\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t1902\tyesterday",valuesReadFromHiveDriver.get(4));
  executeStatementOnDriver("update " + tblName + " set c = 2000",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\t2000\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\t2000\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t2000\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t2000\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t2000\tyesterday",valuesReadFromHiveDriver.get(4));
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,1);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(4,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=last_century",names.get(0));
  Assert.assertEquals("ds=soon",names.get(1));
  Assert.assertEquals("ds=today",names.get(2));
  Assert.assertEquals("ds=yesterday",names.get(3));
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\t2000\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\t2000\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t2000\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t2000\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t2000\tyesterday",valuesReadFromHiveDriver.get(4));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestWorker </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableWithBase() throws Exception {
  LOG.debug("Starting minorTableWithBase");
  Table t=newTable("default","mtwb",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mtwb",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBase() throws Exception {
  LOG.debug("Starting majorPartitionWithBase");
  Table t=newTable("default","mapwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mapwb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorPartitionWithBase() throws Exception {
  Table t=newTable("default","mpwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mpwb",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableLegacy() throws Exception {
  LOG.debug("Starting minorTableLegacy");
  Table t=newTable("default","mtl",false);
  addLegacyFile(t,null,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mtl",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableNoBase() throws Exception {
  LOG.debug("Starting minorTableWithBase");
  Table t=newTable("default","mtnb",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(5);
  CompactionRequest rqst=new CompactionRequest("default","mtnb",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(3,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(1,4))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBaseMissingBuckets() throws Exception {
  LOG.debug("Starting majorPartitionWithBaseMissingBuckets");
  Table t=newTable("default","mapwbmb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20,2,false);
  addDeltaFile(t,p,21L,22L,2,2,false);
  addDeltaFile(t,p,23L,26L,4);
  burnThroughTransactions(27);
  CompactionRequest rqst=new CompactionRequest("default","mapwbmb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000026")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(("bucket_00000".equals(buckets[0].getPath().getName()) && 104L == buckets[0].getLen() && "bucket_00001".equals(buckets[1].getPath().getName()) && 676L == buckets[1].getLen()) || ("bucket_00000".equals(buckets[1].getPath().getName()) && 104L == buckets[1].getLen() && "bucket_00001".equals(buckets[0].getPath().getName()) && 676L == buckets[0].getLen()));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableWithBase() throws Exception {
  LOG.debug("Starting majorTableWithBase");
  Table t=newTable("default","matwb",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","matwb",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableLegacy() throws Exception {
  LOG.debug("Starting majorTableLegacy");
  Table t=newTable("default","matl",false);
  addLegacyFile(t,null,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","matl",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableNoBase() throws Exception {
  LOG.debug("Starting majorTableNoBase");
  Table t=newTable("default","matnb",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(4);
  CompactionRequest rqst=new CompactionRequest("default","matnb",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(3,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000004")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(104L,buckets[0].getLen());
      Assert.assertEquals(104L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroDeserializer </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeBytes() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.BYTES_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  byte[] bytes="ANANCIENTBLUEBOX".getBytes();
  ByteBuffer bb=ByteBuffer.wrap(bytes);
  bb.rewind();
  record.put("bytesField",bb);
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object byteObject=row.get(0);
  assertTrue(byteObject instanceof byte[]);
  byte[] outBytes=(byte[])byteObject;
  for (int i=0; i < bytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef("bytesField");
  outBytes=(byte[])oi.getStructFieldData(row,fieldRef);
  for (int i=0; i < outBytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeFixed() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.FIXED_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  byte[] bytes="ANANCIENTBLUEBOX".getBytes();
  record.put("hash",new GenericData.Fixed(s,bytes));
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object byteObject=row.get(0);
  assertTrue(byteObject instanceof byte[]);
  byte[] outBytes=(byte[])byteObject;
  for (int i=0; i < bytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef("hash");
  outBytes=(byte[])oi.getStructFieldData(row,fieldRef);
  for (int i=0; i < outBytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroObjectInspectorGenerator </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void primitiveTypesWorkCorrectly() throws SerDeException {
  final String bunchOfPrimitives="{\n" + "  \"namespace\": \"testing\",\n" + "  \"name\": \"PrimitiveTypes\",\n"+ "  \"type\": \"record\",\n"+ "  \"fields\": [\n"+ "    {\n"+ "      \"name\":\"aString\",\n"+ "      \"type\":\"string\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"anInt\",\n"+ "      \"type\":\"int\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aBoolean\",\n"+ "      \"type\":\"boolean\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aLong\",\n"+ "      \"type\":\"long\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aFloat\",\n"+ "      \"type\":\"float\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aDouble\",\n"+ "      \"type\":\"double\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aNull\",\n"+ "      \"type\":\"null\"\n"+ "    }\n"+ "  ]\n"+ "}";
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(AvroSerdeUtils.getSchemaFor(bunchOfPrimitives));
  String[] expectedColumnNames={"aString","anInt","aBoolean","aLong","aFloat","aDouble","aNull"};
  verifyColumnNames(expectedColumnNames,aoig.getColumnNames());
  TypeInfo[] expectedColumnTypes={STRING,INT,BOOLEAN,LONG,FLOAT,DOUBLE,VOID};
  verifyColumnTypes(expectedColumnTypes,aoig.getColumnTypes());
  final ObjectInspector oi=aoig.getObjectInspector();
  assertTrue(oi instanceof StandardStructObjectInspector);
  final StandardStructObjectInspector ssoi=(StandardStructObjectInspector)oi;
  List<? extends StructField> structFields=ssoi.getAllStructFieldRefs();
  assertEquals(expectedColumnNames.length,structFields.size());
  for (int i=0; i < expectedColumnNames.length; i++) {
    assertEquals("Column names don't match",expectedColumnNames[i].toLowerCase(),structFields.get(i).getFieldName());
    assertEquals("Column types don't match",expectedColumnTypes[i].getTypeName(),structFields.get(i).getFieldObjectInspector().getTypeName());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleRecords() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(RECORD_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("aRecord",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertEquals(ObjectInspector.Category.STRUCT,typeInfo.getCategory());
  assertTrue(typeInfo instanceof StructTypeInfo);
  StructTypeInfo structTypeInfo=(StructTypeInfo)typeInfo;
  ArrayList<String> allStructFieldNames=structTypeInfo.getAllStructFieldNames();
  ArrayList<TypeInfo> allStructFieldTypeInfos=structTypeInfo.getAllStructFieldTypeInfos();
  assertEquals(allStructFieldNames.size(),3);
  String[] names=new String[]{"int1","boolean1","long1"};
  String[] typeInfoStrings=new String[]{"int","boolean","bigint"};
  for (int i=0; i < allStructFieldNames.size(); i++) {
    assertEquals("Fieldname " + allStructFieldNames.get(i) + " doesn't match expected "+ names[i],names[i],allStructFieldNames.get(i));
    assertEquals("Typeinfo " + allStructFieldTypeInfos.get(i) + " doesn't match expected "+ typeInfoStrings[i],typeInfoStrings[i],allStructFieldTypeInfos.get(i).getTypeName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestTimestampWritable </h4><pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) public void testDecimalToTimestampRandomly(){
  Random rand=new Random(294729777L);
  for (int i=0; i < 10000; ++i) {
    Timestamp ts=new Timestamp(randomMillis(MIN_FOUR_DIGIT_YEAR_MILLIS,MAX_FOUR_DIGIT_YEAR_MILLIS,rand));
    ts.setNanos(randomNanos(rand,9));
    assertEquals(ts,TimestampWritable.decimalToTimestamp(timestampToDecimal(ts)));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) public void testToFromDouble(){
  Random rand=new Random(294729777L);
  for (int nanosPrecision=0; nanosPrecision <= 4; ++nanosPrecision) {
    for (int i=0; i < 10000; ++i) {
      long millis=randomMillis(MIN_FOUR_DIGIT_YEAR_MILLIS,MAX_FOUR_DIGIT_YEAR_MILLIS,rand);
      Timestamp ts=new Timestamp(millis);
      int nanos=randomNanos(rand,nanosPrecision);
      ts.setNanos(nanos);
      TimestampWritable tsw=new TimestampWritable(ts);
      double asDouble=tsw.getDouble();
      int recoveredNanos=(int)(Math.round((asDouble - Math.floor(asDouble)) * Math.pow(10,nanosPrecision)) * Math.pow(10,9 - nanosPrecision));
      assertEquals(String.format("Invalid nanosecond part recovered from %f",asDouble),nanos,recoveredNanos);
      assertEquals(ts,TimestampWritable.doubleToTimestamp(asDouble));
      assertEquals(ts,TimestampWritable.decimalToTimestamp(HiveDecimal.create(BigDecimal.valueOf(asDouble))));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.common.util.TestFixedSizedObjectPool </h4><pre class="type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFullEmpty(){
  final int SIZE=8;
  HashSet offered=new HashSet<>();
  FixedSizedObjectPool pool=new FixedSizedObjectPool<>(SIZE,new DummyHelper(),true);
  Object newObj=pool.take();
  for (int i=0; i < SIZE; ++i) {
    Object obj=new Object();
    offered.add(obj);
    assertTrue(pool.tryOffer(obj));
  }
  assertFalse(pool.tryOffer(newObj));
  for (int i=0; i < SIZE; ++i) {
    Object obj=pool.take();
    assertTrue(offered.remove(obj));
  }
  assertTrue(offered.isEmpty());
  Object newObj2=pool.take();
  assertNotSame(newObj,newObj2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.common.util.TestMurmur3 </h4><pre class="type-11 type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_longs(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_128(seed);
  for (int i=0; i < 1000; i++) {
    long val=rand.nextLong();
    byte[] data=ByteBuffer.allocate(8).putLong(val).array();
    ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
    buf.put(hf.hashBytes(data).asBytes());
    buf.flip();
    long gl1=buf.getLong();
    long gl2=buf.getLong(8);
    long[] hc=Murmur3.hash128(data,0,data.length,seed);
    long m1=hc[0];
    long m2=hc[1];
    assertEquals(gl1,m1);
    assertEquals(gl2,m2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_ints(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_128(seed);
  for (int i=0; i < 1000; i++) {
    int val=rand.nextInt();
    byte[] data=ByteBuffer.allocate(4).putInt(val).array();
    ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
    buf.put(hf.hashBytes(data).asBytes());
    buf.flip();
    long gl1=buf.getLong();
    long gl2=buf.getLong(8);
    long[] hc=Murmur3.hash128(data,0,data.length,seed);
    long m1=hc[0];
    long m2=hc[1];
    assertEquals(gl1,m1);
    assertEquals(gl2,m2);
    byte[] offsetData=new byte[data.length + 50];
    System.arraycopy(data,0,offsetData,50,data.length);
    hc=Murmur3.hash128(offsetData,50,data.length,seed);
    assertEquals(gl1,hc[0]);
    assertEquals(gl2,hc[1]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_32_ints(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_32(seed);
  for (int i=0; i < 1000; i++) {
    int val=rand.nextInt();
    byte[] data=ByteBuffer.allocate(4).putInt(val).array();
    int hc1=hf.hashBytes(data).asInt();
    int hc2=Murmur3.hash32(data,data.length,seed);
    assertEquals(hc1,hc2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_double(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_128(seed);
  for (int i=0; i < 1000; i++) {
    double val=rand.nextDouble();
    byte[] data=ByteBuffer.allocate(8).putDouble(val).array();
    ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
    buf.put(hf.hashBytes(data).asBytes());
    buf.flip();
    long gl1=buf.getLong();
    long gl2=buf.getLong(8);
    long[] hc=Murmur3.hash128(data,0,data.length,seed);
    long m1=hc[0];
    long m2=hc[1];
    assertEquals(gl1,m1);
    assertEquals(gl2,m2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_32_longs(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_32(seed);
  for (int i=0; i < 1000; i++) {
    long val=rand.nextLong();
    byte[] data=ByteBuffer.allocate(8).putLong(val).array();
    int hc1=hf.hashBytes(data).asInt();
    int hc2=Murmur3.hash32(data,data.length,seed);
    assertEquals(hc1,hc2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_32_double(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_32(seed);
  for (int i=0; i < 1000; i++) {
    double val=rand.nextDouble();
    byte[] data=ByteBuffer.allocate(8).putDouble(val).array();
    int hc1=hf.hashBytes(data).asInt();
    int hc2=Murmur3.hash32(data,data.length,seed);
    assertEquals(hc1,hc2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClient </h4><pre class="type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that partition-definitions can be replicated between HCat-instances,
 * independently of table-metadata replication, using PartitionSpec interfaces.
 * (This is essentially the same test as testPartitionRegistrationWithCustomSchema(),
 * transliterated to use the PartitionSpec APIs.)
 * 2 identical tables are created on 2 different HCat instances ("source" and "target").
 * On the source instance,
 * 1. One partition is added with the old format ("TEXTFILE").
 * 2. The table is updated with an additional column and the data-format changed to ORC.
 * 3. Another partition is added with the new format.
 * 4. The partitions' metadata is copied to the target HCat instance, without updating the target table definition.
 * 5. The partitions' metadata is tested to be an exact replica of that on the source.
 * @throws Exception
 */
@Test public void testPartitionSpecRegistrationWithCustomSchema() throws Exception {
  try {
    startReplicationTargetMetaStoreIfRequired();
    HCatClient sourceMetaStore=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    sourceMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,"")));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable sourceTable=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema).comment("Source table.");
    sourceMetaStore.createTable(HCatCreateTableDesc.create(sourceTable).build());
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",sourceTable);
    Map<String,String> partitionSpec_1=new HashMap<String,String>();
    partitionSpec_1.put("grid","AB");
    partitionSpec_1.put("dt","2011_12_31");
    HCatPartition sourcePartition_1=new HCatPartition(sourceTable,partitionSpec_1,makePartLocation(sourceTable,partitionSpec_1));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_1).build());
    assertEquals("Unexpected number of partitions. ",1,sourceMetaStore.getPartitions(dbName,tableName).size());
    HCatPartition addedPartition_1=sourceMetaStore.getPartition(dbName,tableName,partitionSpec_1);
    assertEquals("Column schema doesn't match.",sourceTable.getCols(),addedPartition_1.getColumns());
    assertEquals("InputFormat doesn't match.",sourceTable.getInputFileFormat(),addedPartition_1.getInputFormat());
    assertEquals("OutputFormat doesn't match.",sourceTable.getOutputFileFormat(),addedPartition_1.getOutputFormat());
    assertEquals("SerDe doesn't match.",sourceTable.getSerdeLib(),addedPartition_1.getSerDe());
    assertEquals("SerDe params don't match.",sourceTable.getSerdeParams(),addedPartition_1.getSerdeParams());
    HCatClient targetMetaStore=HCatClient.create(new Configuration(replicationTargetHCatConf));
    targetMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    targetMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    HCatTable targetTable=targetMetaStore.deserializeTable(sourceMetaStore.serializeTable(sourceTable));
    targetMetaStore.createTable(HCatCreateTableDesc.create(targetTable).build());
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("Created table doesn't match the source.",HCatTable.NO_DIFF,targetTable.diff(sourceTable));
    List<HCatFieldSchema> newColumnSchema=new ArrayList<HCatFieldSchema>(columnSchema);
    newColumnSchema.add(new HCatFieldSchema("goo_new",Type.DOUBLE,""));
    Map<String,String> tableParams=new HashMap<String,String>(1);
    tableParams.put("orc.compress","ZLIB");
    sourceTable.cols(newColumnSchema).fileFormat("orcfile").tblProps(tableParams).serdeParam(serdeConstants.FIELD_DELIM,Character.toString('\001'));
    sourceMetaStore.updateTableSchema(dbName,tableName,sourceTable);
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    Map<String,String> partitionSpec_2=new HashMap<String,String>();
    partitionSpec_2.put("grid","AB");
    partitionSpec_2.put("dt","2012_01_01");
    HCatPartition sourcePartition_2=new HCatPartition(sourceTable,partitionSpec_2,makePartLocation(sourceTable,partitionSpec_2));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_2).build());
    HCatPartitionSpec sourcePartitionSpec=sourceMetaStore.getPartitionSpecs(dbName,tableName,-1);
    assertEquals("Unexpected number of source partitions.",2,sourcePartitionSpec.size());
    List<String> partitionSpecString=sourceMetaStore.serializePartitionSpec(sourcePartitionSpec);
    HCatPartitionSpec targetPartitionSpec=targetMetaStore.deserializePartitionSpec(partitionSpecString);
    assertEquals("Could not add the expected number of partitions.",sourcePartitionSpec.size(),targetMetaStore.addPartitionSpec(targetPartitionSpec));
    targetPartitionSpec=targetMetaStore.getPartitionSpecs(dbName,tableName,-1);
    assertEquals("Could not retrieve the expected number of partitions.",sourcePartitionSpec.size(),targetPartitionSpec.size());
    HCatPartitionSpec.HCatPartitionIterator sourceIterator=sourcePartitionSpec.getPartitionIterator();
    HCatPartitionSpec.HCatPartitionIterator targetIterator=targetPartitionSpec.getPartitionIterator();
    while (targetIterator.hasNext()) {
      assertTrue("Fewer target partitions than source.",sourceIterator.hasNext());
      HCatPartition sourcePartition=sourceIterator.next();
      HCatPartition targetPartition=targetIterator.next();
      assertEquals("Column schema doesn't match.",sourcePartition.getColumns(),targetPartition.getColumns());
      assertEquals("InputFormat doesn't match.",sourcePartition.getInputFormat(),targetPartition.getInputFormat());
      assertEquals("OutputFormat doesn't match.",sourcePartition.getOutputFormat(),targetPartition.getOutputFormat());
      assertEquals("SerDe doesn't match.",sourcePartition.getSerDe(),targetPartition.getSerDe());
      assertEquals("SerDe params don't match.",sourcePartition.getSerdeParams(),targetPartition.getSerdeParams());
    }
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception! ",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that partition-definitions can be replicated between HCat-instances,
 * independently of table-metadata replication.
 * 2 identical tables are created on 2 different HCat instances ("source" and "target").
 * On the source instance,
 * 1. One partition is added with the old format ("TEXTFILE").
 * 2. The table is updated with an additional column and the data-format changed to ORC.
 * 3. Another partition is added with the new format.
 * 4. The partitions' metadata is copied to the target HCat instance, without updating the target table definition.
 * 5. The partitions' metadata is tested to be an exact replica of that on the source.
 * @throws Exception
 */
@Test public void testPartitionRegistrationWithCustomSchema() throws Exception {
  try {
    startReplicationTargetMetaStoreIfRequired();
    HCatClient sourceMetaStore=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    sourceMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,"")));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable sourceTable=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema).comment("Source table.");
    sourceMetaStore.createTable(HCatCreateTableDesc.create(sourceTable).build());
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",sourceTable);
    Map<String,String> partitionSpec_1=new HashMap<String,String>();
    partitionSpec_1.put("grid","AB");
    partitionSpec_1.put("dt","2011_12_31");
    HCatPartition sourcePartition_1=new HCatPartition(sourceTable,partitionSpec_1,makePartLocation(sourceTable,partitionSpec_1));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_1).build());
    assertEquals("Unexpected number of partitions. ",1,sourceMetaStore.getPartitions(dbName,tableName).size());
    HCatPartition addedPartition_1=sourceMetaStore.getPartition(dbName,tableName,partitionSpec_1);
    assertEquals("Column schema doesn't match.",sourceTable.getCols(),addedPartition_1.getColumns());
    assertEquals("InputFormat doesn't match.",sourceTable.getInputFileFormat(),addedPartition_1.getInputFormat());
    assertEquals("OutputFormat doesn't match.",sourceTable.getOutputFileFormat(),addedPartition_1.getOutputFormat());
    assertEquals("SerDe doesn't match.",sourceTable.getSerdeLib(),addedPartition_1.getSerDe());
    assertEquals("SerDe params don't match.",sourceTable.getSerdeParams(),addedPartition_1.getSerdeParams());
    HCatClient targetMetaStore=HCatClient.create(new Configuration(replicationTargetHCatConf));
    targetMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    targetMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    HCatTable targetTable=targetMetaStore.deserializeTable(sourceMetaStore.serializeTable(sourceTable));
    targetMetaStore.createTable(HCatCreateTableDesc.create(targetTable).build());
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("Created table doesn't match the source.",HCatTable.NO_DIFF,targetTable.diff(sourceTable));
    List<HCatFieldSchema> newColumnSchema=new ArrayList<HCatFieldSchema>(columnSchema);
    newColumnSchema.add(new HCatFieldSchema("goo_new",Type.DOUBLE,""));
    Map<String,String> tableParams=new HashMap<String,String>(1);
    tableParams.put("orc.compress","ZLIB");
    sourceTable.cols(newColumnSchema).fileFormat("orcfile").tblProps(tableParams).serdeParam(serdeConstants.FIELD_DELIM,Character.toString('\001'));
    sourceMetaStore.updateTableSchema(dbName,tableName,sourceTable);
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    Map<String,String> partitionSpec_2=new HashMap<String,String>();
    partitionSpec_2.put("grid","AB");
    partitionSpec_2.put("dt","2012_01_01");
    HCatPartition sourcePartition_2=new HCatPartition(sourceTable,partitionSpec_2,makePartLocation(sourceTable,partitionSpec_2));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_2).build());
    List<HCatPartition> sourcePartitions=sourceMetaStore.getPartitions(dbName,tableName);
    assertEquals("Unexpected number of source partitions.",2,sourcePartitions.size());
    List<HCatAddPartitionDesc> addPartitionDescs=new ArrayList<HCatAddPartitionDesc>(sourcePartitions.size());
    for (    HCatPartition partition : sourcePartitions) {
      addPartitionDescs.add(HCatAddPartitionDesc.create(partition).build());
    }
    targetMetaStore.addPartitions(addPartitionDescs);
    List<HCatPartition> targetPartitions=targetMetaStore.getPartitions(dbName,tableName);
    assertEquals("Expected the same number of partitions. ",sourcePartitions.size(),targetPartitions.size());
    for (int i=0; i < targetPartitions.size(); ++i) {
      HCatPartition sourcePartition=sourcePartitions.get(i), targetPartition=targetPartitions.get(i);
      assertEquals("Column schema doesn't match.",sourcePartition.getColumns(),targetPartition.getColumns());
      assertEquals("InputFormat doesn't match.",sourcePartition.getInputFormat(),targetPartition.getInputFormat());
      assertEquals("OutputFormat doesn't match.",sourcePartition.getOutputFormat(),targetPartition.getOutputFormat());
      assertEquals("SerDe doesn't match.",sourcePartition.getSerDe(),targetPartition.getSerDe());
      assertEquals("SerDe params don't match.",sourcePartition.getSerdeParams(),targetPartition.getSerdeParams());
    }
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception! ",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.common.TestHCatUtil </h4><pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFsPermissionOperation(){
  HashMap<String,Integer> permsCode=new HashMap<String,Integer>();
  for (int i=0; i < 8; i++) {
    for (int j=0; j < 8; j++) {
      for (int k=0; k < 8; k++) {
        StringBuilder sb=new StringBuilder();
        sb.append("0");
        sb.append(i);
        sb.append(j);
        sb.append(k);
        Integer code=(((i * 8) + j) * 8) + k;
        String perms=(new FsPermission(Short.decode(sb.toString()))).toString();
        if (permsCode.containsKey(perms)) {
          Assert.assertEquals("permissions(" + perms + ") mapped to multiple codes",code,permsCode.get(perms));
        }
        permsCode.put(perms,code);
        assertFsPermissionTransformationIsGood(perms);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.hbase.TestPigHBaseStorageHandler </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigFilterProjection() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.default.storage.type'='binary')";
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  populateHBaseTable(hbaseTableName);
  Configuration conf=new Configuration(getHbaseConf());
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes("testFamily"));
  ResultScanner scanner=table.getScanner(scan);
  int index=1;
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + databaseName + "."+ tableName+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("B = filter A by key < 5;");
  server.registerQuery("C = foreach B generate key,testqualifier2;");
  Iterator<Tuple> itr=server.openIterator("C");
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertTrue(t.size() == 2);
    assertTrue(t.get(0).getClass() == Integer.class);
    assertEquals(index,t.get(0));
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals("textB-" + index,t.get(1));
    index++;
  }
  assertEquals(index - 1,4);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigPopulation() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String POPTXT_FILE_NAME=db_dir + "testfile.txt";
  float f=-100.1f;
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, testqualifier1 float, testqualifier2 string) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.default.storage.type'='binary')";
  String selectQuery="SELECT * from " + databaseName.toLowerCase() + "."+ tableName.toLowerCase();
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  createTestDataFile(POPTXT_FILE_NAME);
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + POPTXT_FILE_NAME + "' using PigStorage() as (key:int, testqualifier1:float, testqualifier2:chararray);");
  server.registerQuery("B = filter A by (key > 2) AND (key < 8) ;");
  server.registerQuery("store B into '" + databaseName.toLowerCase() + "."+ tableName.toLowerCase()+ "' using  org.apache.hive.hcatalog.pig.HCatStorer();");
  server.registerQuery("C = load '" + databaseName.toLowerCase() + "."+ tableName.toLowerCase()+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedBSchema=server.dumpSchema("C");
  List<FieldSchema> fields=dumpedBSchema.getFields();
  assertEquals(3,fields.size());
  assertEquals(DataType.INTEGER,fields.get(0).type);
  assertEquals("key",fields.get(0).alias.toLowerCase());
  assertEquals(DataType.FLOAT,fields.get(1).type);
  assertEquals("testQualifier1".toLowerCase(),fields.get(1).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,fields.get(2).type);
  assertEquals("testQualifier2".toLowerCase(),fields.get(2).alias.toLowerCase());
  Configuration conf=new Configuration(getHbaseConf());
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes("testFamily"));
  byte[] familyNameBytes=Bytes.toBytes("testFamily");
  ResultScanner scanner=table.getScanner(scan);
  int index=3;
  int count=0;
  for (  Result result : scanner) {
    assertEquals(index,Bytes.toInt(result.getRow()));
    assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes("testQualifier1")));
    assertEquals((index + f),Bytes.toFloat(result.getValue(familyNameBytes,Bytes.toBytes("testQualifier1"))),0);
    assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes("testQualifier2")));
    assertEquals(("textB-" + index).toString(),Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes("testQualifier2"))));
    index++;
    count++;
  }
  assertEquals(count,5);
  driver.run(selectQuery);
  ArrayList<String> result=new ArrayList<String>();
  driver.getResults(result);
  assertEquals(5,result.size());
  Iterator<String> itr=result.iterator();
  for (int i=3; i <= 7; i++) {
    String tokens[]=itr.next().split("\\s+");
    assertEquals(i,Integer.parseInt(tokens[0]));
    assertEquals(i + f,Float.parseFloat(tokens[1]),0);
    assertEquals(("textB-" + i).toString(),tokens[2]);
  }
  CommandProcessorResponse responseFour=driver.run(deleteQuery);
  assertEquals(0,responseFour.getResponseCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatHiveCompatibility </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnpartedReadWrite() throws Exception {
  driver.run("drop table if exists junit_unparted_noisd");
  String createTable="create table junit_unparted_noisd(a int) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_unparted_noisd' using org.apache.hive.hcatalog.pig.HCatStorer();");
  logAndRegister(server,"B = load 'default.junit_unparted_noisd' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(1,t.size());
    Assert.assertEquals(t.get(0),i);
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartedRead() throws Exception {
  driver.run("drop table if exists junit_parted_noisd");
  String createTable="create table junit_parted_noisd(a int) partitioned by (b string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_parted_noisd' using org.apache.hive.hcatalog.pig.HCatStorer('b=42');");
  logAndRegister(server,"B = load 'default.junit_parted_noisd' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(2,t.size());
    Assert.assertEquals(t.get(0),i);
    Assert.assertEquals(t.get(1),"42");
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  Partition ptn=client.getPartition("default","junit_parted_noisd",Arrays.asList("42"));
  Assert.assertNotNull(ptn);
  Assert.assertTrue(ptn.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatMultiOutputFormat </h4><pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test case.
 * <ol>
 * <li>Submits a mapred job which writes out one fixed line to each of the tables</li>
 * <li>uses hive fetch task to read the data and see if it matches what was written</li>
 * </ol>
 * @throws Exception if any error occurs
 */
@Test public void testOutputFormat() throws Throwable {
  HashMap<String,String> partitionValues=new HashMap<String,String>();
  partitionValues.put("ds","1");
  partitionValues.put("cluster","ag");
  ArrayList<OutputJobInfo> infoList=new ArrayList<OutputJobInfo>();
  infoList.add(OutputJobInfo.create("default",tableNames[0],partitionValues));
  infoList.add(OutputJobInfo.create("default",tableNames[1],partitionValues));
  infoList.add(OutputJobInfo.create("default",tableNames[2],partitionValues));
  Job job=new Job(hiveConf,"SampleJob");
  job.setMapperClass(MyMapper.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  for (int i=0; i < tableNames.length; i++) {
    configurer.addOutputFormat(tableNames[i],HCatOutputFormat.class,BytesWritable.class,HCatRecord.class);
    HCatOutputFormat.setOutput(configurer.getJob(tableNames[i]),infoList.get(i));
    HCatOutputFormat.setSchema(configurer.getJob(tableNames[i]),schemaMap.get(tableNames[i]));
  }
  configurer.configure();
  Path filePath=createInputFile();
  FileInputFormat.addInputPath(job,filePath);
  Assert.assertTrue(job.waitForCompletion(true));
  ArrayList<String> outputs=new ArrayList<String>();
  for (  String tbl : tableNames) {
    outputs.add(getTableData(tbl,"default").get(0));
  }
  Assert.assertEquals("Comparing output of table " + tableNames[0] + " is not correct",outputs.get(0),"a,a,1,ag");
  Assert.assertEquals("Comparing output of table " + tableNames[1] + " is not correct",outputs.get(1),"a,1,ag");
  Assert.assertEquals("Comparing output of table " + tableNames[2] + " is not correct",outputs.get(2),"a,a,extra,1,ag");
  for (int i=0; i < tableNames.length; i++) {
    Path partitionFile=new Path(warehousedir + "/" + tableNames[i]+ "/ds=1/cluster=ag/part-m-00000");
    FileSystem fs=partitionFile.getFileSystem(mrConf);
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile).getPermission(),new FsPermission(tablePerms[i]));
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile.getParent()).getPermission(),new FsPermission(tablePerms[i]));
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile.getParent().getParent()).getPermission(),new FsPermission(tablePerms[i]));
  }
  LOG.info("File permissions verified");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestMultiOutputFormat </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A test job that reads a input file and outputs each word and the index of
 * the word encountered to a text file and sequence file with different key
 * values.
 */
@Test public void testMultiOutputFormatWithoutReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutNoReduce");
  job.setMapperClass(MultiOutWordIndexMapper.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  String fileContent="Hello World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  DistributedCache.addFileToClassPath(new Path(inputFile),job.getConfiguration(),fs);
  String dummyFile=createInputFile("dummy file");
  DistributedCache.addFileToClassPath(new Path(dummyFile),configurer.getJob("out1").getConfiguration(),fs);
  DistributedCache.addFileToClassPath(new Path(inputFile),configurer.getJob("out2").getConfiguration(),fs);
  configurer.configure();
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(job.getConfiguration());
  List<Path> fileClassPathsList=Arrays.asList(fileClassPaths);
  Assert.assertTrue("Cannot find " + (new Path(inputFile)) + " in "+ fileClassPathsList,fileClassPathsList.contains(new Path(inputFile)));
  Assert.assertTrue("Cannot find " + (new Path(dummyFile)) + " in "+ fileClassPathsList,fileClassPathsList.contains(new Path(dummyFile)));
  URI[] cacheFiles=DistributedCache.getCacheFiles(job.getConfiguration());
  List<URI> cacheFilesList=Arrays.asList(cacheFiles);
  URI inputFileURI=new Path(inputFile).makeQualified(fs).toUri();
  Assert.assertTrue("Cannot find " + inputFileURI + " in "+ cacheFilesList,cacheFilesList.contains(inputFileURI));
  URI dummyFileURI=new Path(dummyFile).makeQualified(fs).toUri();
  Assert.assertTrue("Cannot find " + dummyFileURI + " in "+ cacheFilesList,cacheFilesList.contains(dummyFileURI));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-m-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-m-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words=fileContent.split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  LOG.info("Verifying file contents");
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 1) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 1),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word count test job that reads a input file and outputs the count of
 * words to a text file and sequence file with different key values.
 */
@Test public void testMultiOutputFormatWithReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutWithReduce");
  job.setMapperClass(WordCountMapper.class);
  job.setReducerClass(MultiOutWordCountReducer.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(IntWritable.class);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  configurer.addOutputFormat("out3",NullOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  configurer.configure();
  String fileContent="Hello World Hello World World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-r-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-r-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words="Hello World".split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 2) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 2),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestSequenceFileReadWrite </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteRead() throws Exception {
  String createTable="CREATE TABLE demo_table(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + inputFileName + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteReadMR() throws Exception {
  String createTable="CREATE TABLE demo_table_2(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table_2");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-seq-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,inputFileName);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_2",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("C = load 'default.demo_table_2' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("C");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteReadMR() throws Exception {
  String createTable="CREATE TABLE demo_table_3(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_3");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-text-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setNumReduceTasks(0);
  TextInputFormat.setInputPaths(job,inputFileName);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_3",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("D = load 'default.demo_table_3' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("D");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteRead() throws Exception {
  String createTable="CREATE TABLE demo_table_1(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_1");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + inputFileName + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table_1' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table_1' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoader </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectionsBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("Y1 = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("Y2 = foreach Y1 generate a;");
  server.registerQuery("Y3 = foreach Y1 generate b,a;");
  Schema dumpedY2Schema=server.dumpSchema("Y2");
  Schema dumpedY3Schema=server.dumpSchema("Y3");
  List<FieldSchema> Y2fields=dumpedY2Schema.getFields();
  List<FieldSchema> Y3fields=dumpedY3Schema.getFields();
  assertEquals(1,Y2fields.size());
  assertEquals("a",Y2fields.get(0).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Y2fields.get(0).type);
  assertEquals(2,Y3fields.size());
  assertEquals("b",Y3fields.get(0).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,Y3fields.get(0).type);
  assertEquals("a",Y3fields.get(1).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Y3fields.get(1).type);
  int numTuplesRead=0;
  Iterator<Tuple> Y2Iter=server.openIterator("Y2");
  while (Y2Iter.hasNext()) {
    Tuple t=Y2Iter.next();
    assertEquals(t.size(),1);
    assertNotNull(t.get(0));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    numTuplesRead++;
  }
  numTuplesRead=0;
  Iterator<Tuple> Y3Iter=server.openIterator("Y3");
  while (Y3Iter.hasNext()) {
    Tuple t=Y3Iter.next();
    assertEquals(t.size(),2);
    assertNotNull(t.get(0));
    assertTrue(t.get(0).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).second);
    assertNotNull(t.get(1));
    assertTrue(t.get(1).getClass() == Integer.class);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).first);
    numTuplesRead++;
  }
  assertEquals(basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadPartitionedBasic() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),valuesReadFromHiveDriver.size());
  server.registerQuery("W = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedWSchema=server.dumpSchema("W");
  List<FieldSchema> Wfields=dumpedWSchema.getFields();
  assertEquals(3,Wfields.size());
  assertTrue(Wfields.get(0).alias.equalsIgnoreCase("a"));
  assertTrue(Wfields.get(0).type == DataType.INTEGER);
  assertTrue(Wfields.get(1).alias.equalsIgnoreCase("b"));
  assertTrue(Wfields.get(1).type == DataType.CHARARRAY);
  assertTrue(Wfields.get(2).alias.equalsIgnoreCase("bkt"));
  assertTrue(Wfields.get(2).type == DataType.CHARARRAY);
  Iterator<Tuple> WIter=server.openIterator("W");
  Collection<Pair<Integer,String>> valuesRead=new ArrayList<Pair<Integer,String>>();
  while (WIter.hasNext()) {
    Tuple t=WIter.next();
    assertTrue(t.size() == 3);
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertNotNull(t.get(2));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertTrue(t.get(2).getClass() == String.class);
    valuesRead.add(new Pair<Integer,String>((Integer)t.get(0),(String)t.get(1)));
    if ((Integer)t.get(0) < 2) {
      assertEquals("0",t.get(2));
    }
 else {
      assertEquals("1",t.get(2));
    }
  }
  assertEquals(valuesReadFromHiveDriver.size(),valuesRead.size());
  server.registerQuery("P1 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P1filter = filter P1 by bkt == '0';");
  Iterator<Tuple> P1Iter=server.openIterator("P1filter");
  int count1=0;
  while (P1Iter.hasNext()) {
    Tuple t=P1Iter.next();
    assertEquals("0",t.get(2));
    assertEquals(1,t.get(0));
    count1++;
  }
  assertEquals(3,count1);
  server.registerQuery("P2 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P2filter = filter P2 by bkt == '1';");
  Iterator<Tuple> P2Iter=server.openIterator("P2filter");
  int count2=0;
  while (P2Iter.hasNext()) {
    Tuple t=P2Iter.next();
    assertEquals("1",t.get(2));
    assertTrue(((Integer)t.get(0)) > 1);
    count2++;
  }
  assertEquals(6,count2);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("X");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(2,t.size());
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals(basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoaderEncryption </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataFromEncryptedHiveTableByPig() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + ENCRYPTED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("X");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(2,t.size());
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals("failed with storage format: " + this.storageFormat,basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorer </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartColsInData() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "\t1";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertEquals(2,t.size());
    assertEquals(t.get(0),i);
    assertEquals(t.get(1),"1");
    i++;
  }
  assertFalse(itr.hasNext());
  assertEquals(LOOP_SIZE,i);
}

</code></pre>

<br>
<pre class="type-6 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a data file with datatypes added in 0.13.  Read it with Pig and use
 * Pig + HCatStorer to write to a Hive table.  Then read it using Pig and Hive
 * and make sure results match.
 */
@Test public void testDateCharTypes() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  final String tblName="junit_date_char";
  TestHCatLoader.dropTable(tblName,driver);
  TestHCatLoader.createTable(tblName,"id int, char5 char(5), varchar10 varchar(10), dec52 decimal(5,2)",null,driver,storageFormat);
  int NUM_ROWS=5;
  String[] rows=new String[NUM_ROWS];
  for (int i=0; i < NUM_ROWS; i++) {
    rows[i]=i + "\txxxxx\tyyy\t" + 5.2;
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,rows);
  LOG.debug("File=" + INPUT_FILE_NAME);
  PigServer server=createPigServer(true);
  int queryNumber=1;
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (id:int, char5:chararray, varchar10:chararray, dec52:bigdecimal);",queryNumber++);
  logAndRegister(server,"store A into '" + tblName + "' using "+ HCatStorer.class.getName()+ "();",queryNumber++);
  logAndRegister(server,"B = load '" + tblName + "' using "+ HCatLoader.class.getName()+ "();",queryNumber);
  CommandProcessorResponse cpr=driver.run("select * from " + tblName);
  LOG.debug("cpr.respCode=" + cpr.getResponseCode() + " cpr.errMsg="+ cpr.getErrorMessage());
  List l=new ArrayList();
  driver.getResults(l);
  LOG.debug("Dumping rows via SQL from " + tblName);
  for (  Object t : l) {
    LOG.debug(t == null ? null : t.toString());
  }
  Iterator<Tuple> itr=server.openIterator("B");
  int numRowsRead=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    StringBuilder rowFromPig=new StringBuilder();
    for (int i=0; i < t.size(); i++) {
      rowFromPig.append(t.get(i)).append("\t");
    }
    rowFromPig.setLength(rowFromPig.length() - 1);
    assertEquals("Comparing Pig to Raw data",rows[numRowsRead],rowFromPig.toString());
    numRowsRead++;
  }
  assertEquals("Expected " + NUM_ROWS + " rows; got "+ numRowsRead+ " file="+ INPUT_FILE_NAME,NUM_ROWS,numRowsRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreMultiTables() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  driver.run("drop table junit_unparted2");
  createTable="create table junit_unparted2(a int, b string) stored as RCFILE";
  retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a < 2;");
  server.registerQuery("store B into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.registerQuery("C = filter A by a >= 2;");
  server.registerQuery("store C into 'junit_unparted2' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("select * from junit_unparted2");
  ArrayList<String> res2=new ArrayList<String>();
  driver.getResults(res2);
  res.addAll(res2);
  driver.run("drop table junit_unparted");
  driver.run("drop table junit_unparted2");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncSimple() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      assertEquals(si + "\t" + j,itr.next());
    }
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoSchema() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncAllSimpleTypes() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b float, c double, d bigint, e string, h boolean, f binary, g binary) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int i=0;
  String[] input=new String[3];
  input[i++]="0\t\t\t\t\t\t\t";
  input[i++]="\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "true" + "\tbinary-data";
  input[i++]=i + "\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "false" + "\tbinary-data";
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  Iterator<String> itr=res.iterator();
  String next=itr.next();
  assertEquals("0\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL",next);
  assertEquals("NULL\t4.2\t2.2\t4\tlets hcat\ttrue\tbinary-data\tNULL",itr.next());
  assertEquals("3\t6.2999997\t3.3000000000000003\t6\tlets hcat\tfalse\tbinary-data\tNULL",itr.next());
  assertFalse(itr.hasNext());
  server.registerQuery("B = load 'junit_unparted' using " + HCatLoader.class.getName() + ";");
  Iterator<Tuple> iter=server.openIterator("B");
  int count=0;
  int num5nulls=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    if (t.get(6) == null) {
      num5nulls++;
    }
 else {
      assertTrue(t.get(6) instanceof DataByteArray);
    }
    assertNull(t.get(7));
    count++;
  }
  assertEquals(3,count);
  assertEquals(1,num5nulls);
  driver.run("drop table junit_unparted");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreInPartiitonedTbl() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertEquals(2,t.size());
    assertEquals(t.get(0),i);
    assertEquals(t.get(1),"1");
    i++;
  }
  assertFalse(itr.hasNext());
  assertEquals(11,i);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoCtorArgs() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorerWrapper </h4><pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreExternalTableWithExternalDir() throws IOException, CommandNeedRetryException {
  File tmpExternalDir=new File(TEST_DATA_DIR,UUID.randomUUID().toString());
  tmpExternalDir.deleteOnExit();
  String part_val="100";
  driver.run("drop table junit_external");
  String createTable="create external table junit_external(a int, b string) partitioned by (c string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  logAndRegister(server,"store A into 'default.junit_external' using " + HCatStorerWrapper.class.getName() + "('c="+ part_val+ "','"+ tmpExternalDir.getPath().replaceAll("\\\\","/")+ "');");
  server.executeBatch();
  Assert.assertTrue(tmpExternalDir.exists());
  boolean found=false;
  File[] f=tmpExternalDir.listFiles();
  if (f != null) {
    for (    File fin : f) {
      if (fin.getPath().contains("part-m-00000")) {
        found=true;
      }
    }
  }
  Assert.assertTrue(found);
  driver.run("select * from junit_external");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_external");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      Assert.assertEquals(si + "\t" + j+ "\t"+ part_val,itr.next());
    }
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestStreaming </h4><pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRemainingTransactions() throws Exception {
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName,tblName,partitionVals);
  DelimitedInputWriter writer=new DelimitedInputWriter(fieldNames,",",endPt);
  StreamingConnection connection=endPt.newConnection(true);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(10,writer);
  int batch=0;
  int initialCount=txnBatch.remainingTransactions();
  while (txnBatch.remainingTransactions() > 0) {
    txnBatch.beginNextTransaction();
    Assert.assertEquals(--initialCount,txnBatch.remainingTransactions());
    for (int rec=0; rec < 2; ++rec) {
      Assert.assertEquals(TransactionBatch.TxnState.OPEN,txnBatch.getCurrentTransactionState());
      txnBatch.write((batch * rec + ",Hello streaming").getBytes());
    }
    txnBatch.commit();
    Assert.assertEquals(TransactionBatch.TxnState.COMMITTED,txnBatch.getCurrentTransactionState());
    ++batch;
  }
  Assert.assertEquals(0,txnBatch.remainingTransactions());
  txnBatch.close();
  Assert.assertEquals(TransactionBatch.TxnState.INACTIVE,txnBatch.getCurrentTransactionState());
  txnBatch=connection.fetchTransactionBatch(10,writer);
  batch=0;
  initialCount=txnBatch.remainingTransactions();
  while (txnBatch.remainingTransactions() > 0) {
    txnBatch.beginNextTransaction();
    Assert.assertEquals(--initialCount,txnBatch.remainingTransactions());
    for (int rec=0; rec < 2; ++rec) {
      Assert.assertEquals(TransactionBatch.TxnState.OPEN,txnBatch.getCurrentTransactionState());
      txnBatch.write((batch * rec + ",Hello streaming").getBytes());
    }
    txnBatch.abort();
    Assert.assertEquals(TransactionBatch.TxnState.ABORTED,txnBatch.getCurrentTransactionState());
    ++batch;
  }
  Assert.assertEquals(0,txnBatch.remainingTransactions());
  txnBatch.close();
  Assert.assertEquals(TransactionBatch.TxnState.INACTIVE,txnBatch.getCurrentTransactionState());
  connection.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTempletonUtils </h4><pre class="type-11 type-6 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecodeArray(){
  Assert.assertTrue(TempletonUtils.encodeArray((String[])null) == null);
  String[] tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  String[] tmp2=TempletonUtils.decodeArray(TempletonUtils.encodeArray(tmp));
  try {
    for (int i=0; i < tmp.length; i++) {
      Assert.assertEquals((String)tmp[i],(String)tmp2[i]);
    }
  }
 catch (  Exception e) {
    Assert.fail("Arrays were not equal" + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstructingUserHomeDirectory() throws Exception {
  String[] sources=new String[]{"output+","/user/hadoop/output","hdfs://container","hdfs://container/","hdfs://container/path","output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  String[] expectedResults=new String[]{"/user/webhcat/output+","/user/hadoop/output","hdfs://container/user/webhcat","hdfs://container/","hdfs://container/path","/user/webhcat/output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  for (int i=0; i < sources.length; i++) {
    String source=sources[i];
    String expectedResult=expectedResults[i];
    String result=TempletonUtils.addUserHomeDirectoryIfApplicable(source,"webhcat");
    Assert.assertEquals(result,expectedResult);
  }
  String badUri="c:\\some\\path";
  try {
    TempletonUtils.addUserHomeDirectoryIfApplicable(badUri,"webhcat");
    Assert.fail("addUserHomeDirectoryIfApplicable should fail for bad URI: " + badUri);
  }
 catch (  URISyntaxException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPropertiesParsing() throws Exception {
  String[] props={"hive.metastore.uris=thrift://localhost:9933\\,thrift://127.0.0.1:9933","hive.metastore.sasl.enabled=false","hive.some.fake.path=C:\\foo\\bar.txt\\"};
  StringBuilder input=new StringBuilder();
  for (  String prop : props) {
    if (input.length() > 0) {
      input.append(',');
    }
    input.append(prop);
  }
  String[] newProps=StringUtils.split(input.toString());
  for (int i=0; i < newProps.length; i++) {
    Assert.assertEquals("Pre/post split values don't match",TempletonUtils.unEscapeString(props[i]),TempletonUtils.unEscapeString(newProps[i]));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTrivialExecService </h4><pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  ArrayList<String> list=new ArrayList<String>();
  list.add("echo");
  list.add("success");
  BufferedReader out=null;
  BufferedReader err=null;
  try {
    Process process=TrivialExecService.getInstance().run(list,new ArrayList<String>(),new HashMap<String,String>());
    out=new BufferedReader(new InputStreamReader(process.getInputStream()));
    err=new BufferedReader(new InputStreamReader(process.getErrorStream()));
    Assert.assertEquals("success",out.readLine());
    out.close();
    String line;
    while ((line=err.readLine()) != null) {
      Assert.fail(line);
    }
    process.waitFor();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Process caused exception.");
  }
 finally {
    try {
      out.close();
    }
 catch (    Exception ex) {
    }
    try {
      err.close();
    }
 catch (    Exception ex) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcDriver2 </h4><pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},8);
  tests.put(new String[]{"testhiveJDBC%",null},8);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,"default",checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("c12_1",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Loads data from a table containing non-ascii value column
 * Runs a query and compares the return value
 * @throws Exception
 */
@Test public void testNonAsciiReturnValues() throws Exception {
  String nonAsciiTableName="nonAsciiTable";
  String nonAsciiString="Garçu Kôkaku kidôtai";
  Path nonAsciiFilePath=new Path(dataFileDir,"non_ascii_tbl.txt");
  Statement stmt=con.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("create table " + nonAsciiTableName + " (key int, value string) "+ "row format delimited fields terminated by '|'");
  stmt.execute("load data local inpath '" + nonAsciiFilePath.toString() + "' into table "+ nonAsciiTableName);
  ResultSet rs=stmt.executeQuery("select value from " + nonAsciiTableName + " limit 1");
  while (rs.next()) {
    String resultValue=rs.getString(1);
    assertTrue(resultValue.equalsIgnoreCase(nonAsciiString));
  }
  try {
    stmt.execute("drop table " + nonAsciiTableName);
  }
 catch (  Exception ex) {
  }
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.1234560",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * validate schema generated by "set" command
 * @throws SQLException
 */
@Test public void testSetCommand() throws SQLException {
  String sql="set -v";
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery(sql);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(1,md.getColumnCount());
  assertEquals(SET_COLUMN_NAME,md.getColumnLabel(1));
  int numLines=0;
  while (res.next()) {
    numLines++;
    String rline=res.getString(1);
    assertFalse("set output must not contain hidden variables such as the metastore password:" + rline,rline.contains(HiveConf.ConfVars.METASTOREPWD.varname) && !(rline.contains(HiveConf.ConfVars.HIVE_CONF_HIDDEN_LIST.varname)));
  }
  assertTrue("Nothing returned by set -v",numLines > 0);
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniHS2 </h4><pre class="type-11 type-6 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test is to connect to any database without using the command "Use <<DB>>"
 * 1)connect to default database.
 * 2) Create a new DB test_default.
 * 3) Connect to test_default database.
 * 4) Connect and create table under test_default_test.
 * 5) Connect and display all tables.
 * 6) Connect to default database and shouldn't find table test_default_test.
 * 7) Connect and drop test_default_test.
 * 8) drop test_default database.
 */
@Test public void testURIDatabaseName() throws Exception {
  String jdbcUri=miniHS2.getJdbcURL().substring(0,miniHS2.getJdbcURL().indexOf("default"));
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  String dbName="test_connection_non_default_db";
  String tableInNonDefaultSchema="table_in_non_default_schema";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("create database  if not exists " + dbName);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  boolean expected=stmt.execute(" create table " + tableInNonDefaultSchema + " (x int)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name  " + tableInNonDefaultSchema + "   found in SHOW TABLES result set",testTableExists);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  res=stmt.executeQuery("show tables");
  testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertFalse("table name " + tableInNonDefaultSchema + "  NOT  found in SHOW TABLES result set",testTableExists);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  res=stmt.executeQuery("show tables");
  stmt.execute(" drop table if exists table_in_non_default_schema");
  expected=stmt.execute("DROP DATABASE " + dbName);
  stmt.close();
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  res=stmt.executeQuery("show tables");
  testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  hs2Conn=getConnection(jdbcUri,System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + ";",System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + ";/foo=bar;foo1=bar1",System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniMr </h4><pre class="type-11 type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempTable() throws Exception {
  String tempTableName="tmp1";
  stmt.execute("CREATE TEMPORARY TABLE " + tempTableName + " (key string, value string)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tempTableName);
  String resultVal="val_238";
  String queryStr="SELECT * FROM " + tempTableName + " where value = '"+ resultVal+ "'";
  verifyResult(queryStr,resultVal,2);
  DatabaseMetaData md=hs2Conn.getMetaData();
  assertTrue(md.getConnection() == hs2Conn);
  ResultSet rs=md.getTables(null,null,tempTableName,null);
  boolean foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getTables(null,null,null,null);
  foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getColumns(null,null,tempTableName,null);
  assertTrue("First row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("key"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  assertTrue("Second row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("value"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  boolean gotException=false;
  try {
    ResultSet res;
    res=stmt2.executeQuery(queryStr);
  }
 catch (  SQLException err) {
    assertTrue("Expecting table not found error, instead got: " + err,err.getMessage().contains("Table not found"));
    gotException=true;
  }
  assertTrue("Exception while querying non-existing temp table",gotException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestSSL </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Start HS2 in SSL mode, open a SSL connection and fetch data
 * @throws Exception
 */
@Test public void testSSLFetch() throws Exception {
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  String tableName="sslTab";
  Path dataFilePath=new Path(dataFileDir,"kv1.txt");
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
  setupTestTableWithData(tableName,dataFilePath,hs2Conn);
  Statement stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  int rowCount=0;
  while (res.next()) {
    ++rowCount;
    assertEquals("val_" + res.getInt(1),res.getString(2));
  }
  assertEquals(500,rowCount);
  hs2Conn.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Start HS2 in Http mode with SSL enabled, open a SSL connection and fetch data
 * @throws Exception
 */
@Test public void testSSLFetchHttp() throws Exception {
  setSslConfOverlay(confOverlay);
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  String tableName="sslTab";
  Path dataFilePath=new Path(dataFileDir,"kv1.txt");
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
  setupTestTableWithData(tableName,dataFilePath,hs2Conn);
  Statement stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  int rowCount=0;
  while (res.next()) {
    ++rowCount;
    assertEquals("val_" + res.getInt(1),res.getString(2));
  }
  assertEquals(500,rowCount);
  hs2Conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.cbo_rp_TestJdbcDriver2 </h4><pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("_c12",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},7);
  tests.put(new String[]{"testhiveJDBC%",null},7);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,null,checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.0123456",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Loads data from a table containing non-ascii value column
 * Runs a query and compares the return value
 * @throws Exception
 */
@Test public void testNonAsciiReturnValues() throws Exception {
  String nonAsciiTableName="nonAsciiTable";
  String nonAsciiString="Garçu Kôkaku kidôtai";
  Path nonAsciiFilePath=new Path(dataFileDir,"non_ascii_tbl.txt");
  Statement stmt=con.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("create table " + nonAsciiTableName + " (key int, value string) "+ "row format delimited fields terminated by '|'");
  stmt.execute("load data local inpath '" + nonAsciiFilePath.toString() + "' into table "+ nonAsciiTableName);
  ResultSet rs=stmt.executeQuery("select value from " + nonAsciiTableName + " limit 1");
  while (rs.next()) {
    String resultValue=rs.getString(1);
    assertTrue(resultValue.equalsIgnoreCase(nonAsciiString));
  }
  try {
    stmt.execute("drop table " + nonAsciiTableName);
  }
 catch (  Exception ex) {
  }
  stmt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceTest </h4><pre class="type-11 type-6 type-12 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalCompileLockTimeout() throws Exception {
  String tableName="TEST_COMPILE_LOCK_TIMEOUT";
  String columnDefinitions="(ID STRING)";
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,new HashMap<String,String>());
  assertNotNull(sessionHandle);
  int THREAD_COUNT=3;
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=(FutureTask<Void>[])new FutureTask[THREAD_COUNT];
  long longPollingTimeoutMs=10 * 60 * 1000;
  Map<String,String> confOverlay=getConfOverlay(0,longPollingTimeoutMs);
  confOverlay.put(HiveConf.ConfVars.SEMANTIC_ANALYZER_HOOK.varname,CompileLockTestSleepHook.class.getName());
  String query="SELECT 0 FROM " + tableName;
  tasks[0]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[0]).start();
  Thread.sleep(5 * 1000);
  confOverlay=getConfOverlay(1,longPollingTimeoutMs);
  query="SELECT 1 FROM " + tableName;
  tasks[1]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.ERROR,false,null,null));
  new Thread(tasks[1]).start();
  confOverlay=getConfOverlay(100,longPollingTimeoutMs);
  query="SELECT 2 FROM " + tableName;
  tasks[2]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[2]).start();
  boolean foundExpectedException=false;
  for (int i=0; i < THREAD_COUNT; ++i) {
    try {
      tasks[i].get();
    }
 catch (    Throwable t) {
      if (i == 1) {
        assertTrue(t.getMessage().contains(ErrorMsg.COMPILE_LOCK_TIMED_OUT.getMsg()));
        foundExpectedException=true;
      }
 else {
        throw new RuntimeException(t);
      }
    }
  }
  assertTrue(foundExpectedException);
  client.executeStatement(sessionHandle,"DROP TABLE " + tableName,getConfOverlay(0,longPollingTimeoutMs));
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.TestColumn </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllIntegerTypeValues(){
  Map<Type,List> integerTypesAndValues=new LinkedHashMap<Type,List>();
  integerTypesAndValues.put(Type.TINYINT_TYPE,Arrays.asList(Byte.MIN_VALUE,Byte.MAX_VALUE));
  integerTypesAndValues.put(Type.SMALLINT_TYPE,Arrays.asList(Short.MIN_VALUE,Short.MIN_VALUE));
  integerTypesAndValues.put(Type.INT_TYPE,Arrays.asList(Integer.MIN_VALUE,Integer.MAX_VALUE));
  integerTypesAndValues.put(Type.BIGINT_TYPE,Arrays.asList(Long.MIN_VALUE,Long.MAX_VALUE));
  for (  Map.Entry entry : integerTypesAndValues.entrySet()) {
    Type type=(Type)entry.getKey();
    List values=(List)entry.getValue();
    Column c=new Column(type);
    for (    Object v : values) {
      c.addValue(type,v);
    }
    assertEquals(type,c.getType());
    assertEquals(values.size(),c.size());
    for (int i=0; i < c.size(); i++) {
      assertEquals(values.get(i),c.get(i));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithMr </h4><pre class="type-11 type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchResultsOfLogAsync() throws Exception {
  OperationHandle operationHandle=client.executeStatementAsync(sessionHandle,sql,null);
  boolean isQueryRunning=true;
  long pollTimeout=System.currentTimeMillis() + 100000;
  OperationStatus opStatus;
  OperationState state=null;
  RowSet rowSetAccumulated=null;
  StringBuilder logs=new StringBuilder();
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      break;
    }
    opStatus=client.getOperationStatus(operationHandle);
    Assert.assertNotNull(opStatus);
    state=opStatus.getState();
    rowSetAccumulated=client.fetchResults(operationHandle,FetchOrientation.FETCH_NEXT,2000,FetchType.LOG);
    for (    Object[] row : rowSetAccumulated) {
      logs.append(row[0]);
    }
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(10);
  }
  Assert.assertEquals("Query should be finished",OperationState.FINISHED,state);
  verifyFetchedLogPost(logs.toString(),expectedLogsVerbose,true);
  RowSet rowSet=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,2000,FetchType.LOG);
  verifyFetchedLog(rowSet,expectedLogsVerbose);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.TestOperationLoggingLayout </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSwitchLogLayout() throws Exception {
  OperationHandle operationHandle=client.executeStatement(sessionHandle,sqlCntStar,null);
  RowSet rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  Iterator<Object[]> iter=rowSetLog.iterator();
  while (iter.hasNext()) {
    String row=iter.next()[0].toString();
    Assert.assertEquals(true,row.matches("^(FATAL|ERROR|WARN|INFO|DEBUG|TRACE).*$"));
  }
  String queryString="set hive.server2.logging.operation.level=verbose";
  client.executeStatement(sessionHandle,queryString,null);
  operationHandle=client.executeStatement(sessionHandle,sqlCntStar,null);
  rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,10,FetchType.LOG);
  iter=rowSetLog.iterator();
  while (iter.hasNext()) {
    String row=iter.next()[0].toString();
    Assert.assertEquals(true,row.matches("^\\d{2}[/](0[1-9]|1[012])[/](0[1-9]|[12][0-9]|3[01]).*$"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.thrift.ThriftCLIServiceTest </h4><pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test asynchronous query execution and error reporting to the client
 * @throws Exception
 */
@Test public void testExecuteStatementAsync() throws Exception {
  Map<String,String> opConf=new HashMap<String,String>();
  SessionHandle sessHandle=client.openSession(USERNAME,PASSWORD,opConf);
  assertNotNull("Session handle should not be null",sessHandle);
  OperationHandle opHandle;
  OperationStatus opStatus;
  OperationState state=null;
  String queryString="SET hive.lock.manager=" + "org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="DROP TABLE IF EXISTS TEST_EXEC_ASYNC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="CREATE TABLE TEST_EXEC_ASYNC_THRIFT(ID STRING)";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="SELECT ID+1 FROM TEST_EXEC_ASYNC_THRIFT";
  System.out.println("Will attempt to execute: " + queryString);
  opHandle=client.executeStatementAsync(sessHandle,queryString,opConf);
  assertNotNull(opHandle);
  boolean isQueryRunning=true;
  long pollTimeout=System.currentTimeMillis() + 100000;
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      System.out.println("Polling timed out");
      break;
    }
    opStatus=client.getOperationStatus(opHandle);
    assertNotNull(opStatus);
    state=opStatus.getState();
    System.out.println("Current state: " + state);
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(1000);
  }
  assertEquals("Query should be finished",OperationState.FINISHED,state);
  queryString="CREATE TABLE NON_EXISTING_TAB (ID STRING) location 'hdfs://localhost:10000/a/b/c'";
  System.out.println("Will attempt to execute: " + queryString);
  opHandle=client.executeStatementAsync(sessHandle,queryString,opConf);
  assertNotNull(opHandle);
  opStatus=client.getOperationStatus(opHandle);
  assertNotNull(opStatus);
  isQueryRunning=true;
  pollTimeout=System.currentTimeMillis() + 100000;
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      System.out.println("Polling timed out");
      break;
    }
    state=opStatus.getState();
    System.out.println("Current state: " + state);
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(1000);
    opStatus=client.getOperationStatus(opHandle);
  }
  assertEquals("Operation should be in error state",OperationState.ERROR,state);
  assertEquals(opStatus.getOperationException().getSQLState(),"08S01");
  assertEquals(opStatus.getOperationException().getErrorCode(),1);
  queryString="DROP TABLE TEST_EXEC_ASYNC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  client.closeSession(sessHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestBitFieldReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testBiggerItems() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  final int COUNT=16384;
  BitFieldWriter out=new BitFieldWriter(new OutStream("test",500,null,collect),3);
  for (int i=0; i < COUNT; ++i) {
    if (i < COUNT / 2) {
      out.write(i & 7);
    }
 else {
      out.write((i / 3) & 7);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  BitFieldReader in=new BitFieldReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,500),3);
  for (int i=0; i < COUNT; ++i) {
    int x=in.next();
    if (i < COUNT / 2) {
      assertEquals(i & 7,x);
    }
 else {
      assertEquals((i / 3) & 7,x);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  BitFieldWriter out=new BitFieldWriter(new OutStream("test",100,null,collect),1);
  final int COUNT=16384;
  for (int i=0; i < COUNT; ++i) {
    if (i < COUNT / 2) {
      out.write(i & 1);
    }
 else {
      out.write((i / 3) & 1);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  BitFieldReader in=new BitFieldReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),1);
  for (int i=0; i < COUNT; i+=5) {
    int x=(int)in.next();
    if (i < COUNT / 2) {
      assertEquals(i & 1,x);
    }
 else {
      assertEquals((i / 3) & 1,x);
    }
    if (i < COUNT - 5) {
      in.skip(4);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestDynamicArray </h4><pre class="type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntArray() throws Exception {
  DynamicIntArray dia=new DynamicIntArray(10);
  for (int i=0; i < 10000; ++i) {
    dia.add(2 * i);
  }
  assertEquals(10000,dia.size());
  for (int i=0; i < 10000; ++i) {
    assertEquals(2 * i,dia.get(i));
  }
  dia.clear();
  assertEquals(0,dia.size());
  dia.add(3);
  dia.add(12);
  dia.add(65);
  assertEquals("{3,12,65}",dia.toString());
  for (int i=0; i < 5; ++i) {
    dia.increment(i,3);
  }
  assertEquals("{6,15,68,3,3}",dia.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestInStream </h4><pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testUncompressed() throws Exception {
  OutputCollector collect=new OutputCollector();
  OutStream out=new OutStream("test",100,null,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    out.write(i);
  }
  out.flush();
  assertEquals(1024,collect.buffer.size());
  for (int i=0; i < 1024; ++i) {
    assertEquals((byte)i,collect.buffer.get(i));
  }
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  InStream in=InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100);
  assertEquals("uncompressed stream test position: 0 length: 1024" + " range: 0 offset: 0 limit: 0",in.toString());
  for (int i=0; i < 1024; ++i) {
    int x=in.read();
    assertEquals(i & 0xff,x);
  }
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i & 0xff,in.read());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCompressed() throws Exception {
  OutputCollector collect=new OutputCollector();
  CompressionCodec codec=new ZlibCodec();
  OutStream out=new OutStream("test",300,codec,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    out.write(i);
  }
  out.flush();
  assertEquals("test",out.toString());
  assertEquals(961,collect.buffer.size());
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  InStream in=InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,300);
  assertEquals("compressed stream test position: 0 length: 961 range: 0" + " offset: 0 limit: 0 range 0 = 0 to 961",in.toString());
  for (int i=0; i < 1024; ++i) {
    int x=in.read();
    assertEquals(i & 0xff,x);
  }
  assertEquals(0,in.available());
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i & 0xff,in.read());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUncompressedDisjointBuffers() throws Exception {
  OutputCollector collect=new OutputCollector();
  OutStream out=new OutStream("test",400,null,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  DataOutput stream=new DataOutputStream(out);
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    stream.writeInt(i);
  }
  out.flush();
  assertEquals("test",out.toString());
  assertEquals(4096,collect.buffer.size());
  ByteBuffer[] inBuf=new ByteBuffer[3];
  inBuf[0]=ByteBuffer.allocate(1100);
  inBuf[1]=ByteBuffer.allocate(2200);
  inBuf[2]=ByteBuffer.allocate(1100);
  collect.buffer.setByteBuffer(inBuf[0],0,1024);
  collect.buffer.setByteBuffer(inBuf[1],1024,2048);
  collect.buffer.setByteBuffer(inBuf[2],3072,1024);
  for (int i=0; i < inBuf.length; ++i) {
    inBuf[i].flip();
  }
  InStream in=InStream.create("test",inBuf,new long[]{0,1024,3072},4096,null,400);
  assertEquals("uncompressed stream test position: 0 length: 4096" + " range: 0 offset: 0 limit: 0",in.toString());
  DataInputStream inStream=new DataInputStream(in);
  for (int i=0; i < 1024; ++i) {
    int x=inStream.readInt();
    assertEquals(i,x);
  }
  assertEquals(0,in.available());
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[1],inBuf[2]},new long[]{1024,3072},4096,null,400);
  inStream=new DataInputStream(in);
  positions[256].reset();
  in.seek(positions[256]);
  for (int i=256; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[0],inBuf[2]},new long[]{0,3072},4096,null,400);
  inStream=new DataInputStream(in);
  positions[768].reset();
  for (int i=0; i < 256; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in.seek(positions[768]);
  for (int i=768; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDisjointBuffers() throws Exception {
  OutputCollector collect=new OutputCollector();
  CompressionCodec codec=new ZlibCodec();
  OutStream out=new OutStream("test",400,codec,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  DataOutput stream=new DataOutputStream(out);
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    stream.writeInt(i);
  }
  out.flush();
  assertEquals("test",out.toString());
  assertEquals(1674,collect.buffer.size());
  ByteBuffer[] inBuf=new ByteBuffer[3];
  inBuf[0]=ByteBuffer.allocate(500);
  inBuf[1]=ByteBuffer.allocate(1200);
  inBuf[2]=ByteBuffer.allocate(500);
  collect.buffer.setByteBuffer(inBuf[0],0,483);
  collect.buffer.setByteBuffer(inBuf[1],483,1625 - 483);
  collect.buffer.setByteBuffer(inBuf[2],1625,1674 - 1625);
  for (int i=0; i < inBuf.length; ++i) {
    inBuf[i].flip();
  }
  InStream in=InStream.create("test",inBuf,new long[]{0,483,1625},1674,codec,400);
  assertEquals("compressed stream test position: 0 length: 1674 range: 0" + " offset: 0 limit: 0 range 0 = 0 to 483;" + "  range 1 = 483 to 1142;  range 2 = 1625 to 49",in.toString());
  DataInputStream inStream=new DataInputStream(in);
  for (int i=0; i < 1024; ++i) {
    int x=inStream.readInt();
    assertEquals(i,x);
  }
  assertEquals(0,in.available());
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[1],inBuf[2]},new long[]{483,1625},1674,codec,400);
  inStream=new DataInputStream(in);
  positions[303].reset();
  in.seek(positions[303]);
  for (int i=303; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[0],inBuf[2]},new long[]{0,1625},1674,codec,400);
  inStream=new DataInputStream(in);
  positions[1001].reset();
  for (int i=0; i < 300; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in.seek(positions[1001]);
  for (int i=1001; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestIntegerCompressionReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthIntegerWriterV2 out=new RunLengthIntegerWriterV2(new OutStream("test",100,null,collect),true);
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write(i);
    }
 else {
      out.write(256 * i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthIntegerReaderV2 in=new RunLengthIntegerReaderV2(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),true,false);
  for (int i=0; i < 2048; i+=10) {
    int x=(int)in.next();
    if (i < 1024) {
      assertEquals(i,x);
    }
 else {
      assertEquals(256 * i,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestRunLengthByteReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",100,null,collect));
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write((byte)(i / 16));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100));
  for (int i=0; i < 2048; i+=10) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 16) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testUncompressedSeek() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",100,null,collect));
  TestInStream.PositionCollector[] positions=new TestInStream.PositionCollector[2048];
  for (int i=0; i < 2048; ++i) {
    positions[i]=new TestInStream.PositionCollector();
    out.getPosition(positions[i]);
    if (i < 1024) {
      out.write((byte)(i / 4));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100));
  for (int i=0; i < 2048; ++i) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
  for (int i=2047; i >= 0; --i) {
    in.seek(positions[i]);
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCompressedSeek() throws Exception {
  CompressionCodec codec=new SnappyCodec();
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",500,codec,collect));
  TestInStream.PositionCollector[] positions=new TestInStream.PositionCollector[2048];
  for (int i=0; i < 2048; ++i) {
    positions[i]=new TestInStream.PositionCollector();
    out.getPosition(positions[i]);
    if (i < 1024) {
      out.write((byte)(i / 4));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,500));
  for (int i=0; i < 2048; ++i) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
  for (int i=2047; i >= 0; --i) {
    in.seek(positions[i]);
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestRunLengthIntegerReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthIntegerWriter out=new RunLengthIntegerWriter(new OutStream("test",100,null,collect),true);
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write(i);
    }
 else {
      out.write(256 * i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthIntegerReader in=new RunLengthIntegerReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),true);
  for (int i=0; i < 2048; i+=10) {
    int x=(int)in.next();
    if (i < 1024) {
      assertEquals(i,x);
    }
 else {
      assertEquals(256 * i,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestSerializationUtils </h4><pre class="type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBigIntegers() throws Exception {
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  SerializationUtils.writeBigInteger(buffer,BigInteger.valueOf(0));
  assertArrayEquals(new byte[]{0},buffer.toByteArray());
  assertEquals(0L,SerializationUtils.readBigInteger(fromBuffer(buffer)).longValue());
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,BigInteger.valueOf(1));
  assertArrayEquals(new byte[]{2},buffer.toByteArray());
  assertEquals(1L,SerializationUtils.readBigInteger(fromBuffer(buffer)).longValue());
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,BigInteger.valueOf(-1));
  assertArrayEquals(new byte[]{1},buffer.toByteArray());
  assertEquals(-1L,SerializationUtils.readBigInteger(fromBuffer(buffer)).longValue());
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,BigInteger.valueOf(50));
  assertArrayEquals(new byte[]{100},buffer.toByteArray());
  assertEquals(50L,SerializationUtils.readBigInteger(fromBuffer(buffer)).longValue());
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,BigInteger.valueOf(-50));
  assertArrayEquals(new byte[]{99},buffer.toByteArray());
  assertEquals(-50L,SerializationUtils.readBigInteger(fromBuffer(buffer)).longValue());
  for (int i=-8192; i < 8192; ++i) {
    buffer.reset();
    SerializationUtils.writeBigInteger(buffer,BigInteger.valueOf(i));
    assertEquals("compare length for " + i,i >= -64 && i < 64 ? 1 : 2,buffer.size());
    assertEquals("compare result for " + i,i,SerializationUtils.readBigInteger(fromBuffer(buffer)).intValue());
  }
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,new BigInteger("123456789abcdef0",16));
  assertEquals(new BigInteger("123456789abcdef0",16),SerializationUtils.readBigInteger(fromBuffer(buffer)));
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,new BigInteger("-123456789abcdef0",16));
  assertEquals(new BigInteger("-123456789abcdef0",16),SerializationUtils.readBigInteger(fromBuffer(buffer)));
  StringBuilder buf=new StringBuilder();
  for (int i=0; i < 256; ++i) {
    String num=Integer.toHexString(i);
    if (num.length() == 1) {
      buf.append('0');
    }
    buf.append(num);
  }
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,new BigInteger(buf.toString(),16));
  assertEquals(new BigInteger(buf.toString(),16),SerializationUtils.readBigInteger(fromBuffer(buffer)));
  buffer.reset();
  SerializationUtils.writeBigInteger(buffer,new BigInteger("ff000000000000000000000000000000000000000000ff",16));
  assertEquals(new BigInteger("ff000000000000000000000000000000000000000000ff",16),SerializationUtils.readBigInteger(fromBuffer(buffer)));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
