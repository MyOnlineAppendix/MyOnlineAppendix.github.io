<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestAccumuloConnectionParameters </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInstantiatesWithNullConfiguration(){
  AccumuloConnectionParameters cnxnParams=new AccumuloConnectionParameters(null);
  try {
    cnxnParams.getAccumuloInstanceName();
    Assert.fail("Should have gotten an NPE");
  }
 catch (  NullPointerException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestAccumuloPredicateHandler </h4><pre class="type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPushdownComparisonOptNotSupported(){
  try {
    ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"field1",null,false);
    List<ExprNodeDesc> children=Lists.newArrayList();
    children.add(column);
    ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPNotNull(),children);
    assertNotNull(node);
    String filterExpr=SerializationUtilities.serializeExpression(node);
    conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
    List<IndexSearchCondition> sConditions=handler.getSearchConditions(conf);
    assertEquals(sConditions.size(),1);
    IndexSearchCondition sc=sConditions.get(0);
    new PushdownTuple(sc,handler.getPrimitiveComparison(sc.getColumnDesc().getTypeString(),sc),handler.getCompareOp(sc.getComparisonOp(),sc));
    fail("Should fail: compare op not registered for index analyzer. Should leave undesirable residual predicate");
  }
 catch (  RuntimeException e) {
    assertTrue(e.getMessage().contains("Unexpected residual predicate: field1 is not null"));
  }
catch (  Exception e) {
    fail(StringUtils.stringifyException(e));
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIgnoreIteratorPushdown() throws TooManyAccumuloColumnsException {
  conf=new JobConf();
  List<String> columnNames=Arrays.asList("field1","field2","rid");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  conf.set(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columnNames));
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,int,string");
  String columnMappingStr="cf:f1,cf:f2,:rowID";
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,columnMappingStr);
  columnMapper=new ColumnMapper(columnMappingStr,ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"field2",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,5);
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  conf.setBoolean(AccumuloSerDeParameters.ITERATOR_PUSHDOWN_KEY,false);
  try {
    List<IteratorSetting> iterators=handler.getIterators(conf,columnMapper);
    assertEquals(iterators.size(),0);
  }
 catch (  Exception e) {
    fail(StringUtils.stringifyException(e));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.compare.TestDoubleCompare </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void like(){
  try {
    Like likeObj=new Like(doubleCompare);
    assertTrue(likeObj.accept(new byte[]{}));
    fail("should not accept");
  }
 catch (  UnsupportedOperationException e) {
    assertTrue(e.getMessage().contains("Like not supported for " + doubleCompare.getClass().getName()));
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidSerialization(){
  try {
    byte[] badVal=new byte[4];
    ByteBuffer.wrap(badVal).putInt(1);
    doubleCompare.serialize(badVal);
    fail("Should fail");
  }
 catch (  RuntimeException e) {
    assertTrue(e.getMessage().contains(" occurred trying to build double value"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.compare.TestIntCompare </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void like(){
  try {
    Like likeObj=new Like(intCompare);
    assertTrue(likeObj.accept(new byte[]{}));
    fail("should not accept");
  }
 catch (  UnsupportedOperationException e) {
    assertTrue(e.getMessage().contains("Like not supported for " + intCompare.getClass().getName()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.compare.TestLongComparison </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void like(){
  try {
    Like likeObj=new Like(longComp);
    assertTrue(likeObj.accept(new byte[]{}));
    fail("should not accept");
  }
 catch (  UnsupportedOperationException e) {
    assertTrue(e.getMessage().contains("Like not supported for " + longComp.getClass().getName()));
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidSerialization(){
  try {
    byte[] badVal=new byte[4];
    ByteBuffer.wrap(badVal).putInt(1);
    longComp.serialize(badVal);
    fail("Should fail");
  }
 catch (  RuntimeException e) {
    assertTrue(e.getMessage().contains(" occurred trying to build long value"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestDecimal128 </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPrecisionOverflow(){
  new Decimal128("1.004",(short)3).checkPrecisionOverflow(4);
  try {
    new Decimal128("1.004",(short)3).checkPrecisionOverflow(3);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  try {
    new Decimal128("1.004",(short)3).checkPrecisionOverflow(2);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  new Decimal128("1.004",(short)3).checkPrecisionOverflow(38);
  new Decimal128("-3322",(short)0).checkPrecisionOverflow(4);
  try {
    new Decimal128("-3322",(short)0).checkPrecisionOverflow(3);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  new Decimal128("-3322",(short)1).checkPrecisionOverflow(5);
  try {
    new Decimal128("-3322",(short)1).checkPrecisionOverflow(4);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  new Decimal128("0.99999999999999999999999999999999999999",(short)38).checkPrecisionOverflow(38);
  try {
    new Decimal128("0.99999999999999999999999999999999999999",(short)38).checkPrecisionOverflow(37);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  new Decimal128("99999999999999999999999999999999999999",(short)0).checkPrecisionOverflow(38);
  try {
    new Decimal128("99999999999999999999999999999999999999",(short)0).checkPrecisionOverflow(37);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveIntervalDayTime </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testValueOf() throws Exception {
  HiveIntervalDayTime i1=HiveIntervalDayTime.valueOf("3 04:05:06.123456");
  assertEquals(3,i1.getDays());
  assertEquals(4,i1.getHours());
  assertEquals(5,i1.getMinutes());
  assertEquals(6,i1.getSeconds());
  assertEquals(123456000,i1.getNanos());
  HiveIntervalDayTime i2=HiveIntervalDayTime.valueOf("+3 04:05:06");
  assertEquals(3,i2.getDays());
  assertEquals(4,i2.getHours());
  assertEquals(5,i2.getMinutes());
  assertEquals(6,i2.getSeconds());
  assertEquals(0,i2.getNanos());
  HiveIntervalDayTime i3=HiveIntervalDayTime.valueOf("-12 13:14:15.987654321");
  assertEquals(-12,i3.getDays());
  assertEquals(-13,i3.getHours());
  assertEquals(-14,i3.getMinutes());
  assertEquals(-15,i3.getSeconds());
  assertEquals(-987654321,i3.getNanos());
  HiveIntervalDayTime i4=HiveIntervalDayTime.valueOf("-0 0:0:0.000000012");
  assertEquals(0,i4.getDays());
  assertEquals(0,i4.getHours());
  assertEquals(0,i4.getMinutes());
  assertEquals(0,i4.getSeconds());
  assertEquals(-12,i4.getNanos());
  String[] invalidValues={null,"abc","0-11","0 60:0:0","0 0:60:0"};
  for (  String invalidValue : invalidValues) {
    boolean caughtException=false;
    try {
      HiveIntervalDayTime.valueOf(invalidValue);
      fail("Expected exception");
    }
 catch (    IllegalArgumentException err) {
      caughtException=true;
    }
    assertTrue("Expected exception",caughtException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveIntervalYearMonth </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testValueOf() throws Exception {
  HiveIntervalYearMonth i1=HiveIntervalYearMonth.valueOf("1-2");
  assertEquals(1,i1.getYears());
  assertEquals(2,i1.getMonths());
  HiveIntervalYearMonth i2=HiveIntervalYearMonth.valueOf("+8-9");
  assertEquals(8,i2.getYears());
  assertEquals(9,i2.getMonths());
  HiveIntervalYearMonth i3=HiveIntervalYearMonth.valueOf("-10-11");
  assertEquals(-10,i3.getYears());
  assertEquals(-11,i3.getMonths());
  HiveIntervalYearMonth i4=HiveIntervalYearMonth.valueOf("-0-0");
  assertEquals(0,i4.getYears());
  assertEquals(0,i4.getMonths());
  String[] invalidValues={null,"abc","0-12","0 1:2:3"};
  for (  String invalidValue : invalidValues) {
    boolean caughtException=false;
    try {
      HiveIntervalYearMonth.valueOf(invalidValue);
      fail("Expected exception");
    }
 catch (    IllegalArgumentException err) {
      caughtException=true;
    }
    assertTrue("Expected exception",caughtException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestSignedInt128 </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveInt(){
  two.divideDestructive(1);
  assertEquals(1L,one.longValue());
  assertEquals(2L,two.longValue());
  one.divideDestructive(2);
  assertEquals(0L,one.longValue());
  assertEquals(2L,two.longValue());
  SignedInt128 var1=new SignedInt128(1234234662345L);
  var1.divideDestructive(642337);
  assertEquals(1234234662345L / 642337L,var1.longValue());
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  complicated1.divideDestructive(1534223465);
  BigInteger bigInteger2=BigInteger.valueOf(1534223465);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(0);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveSignedInt128(){
  SignedInt128 remainder=new SignedInt128();
  two.divideDestructive(one,remainder);
  assertEquals(1L,one.longValue());
  assertEquals(2L,two.longValue());
  assertEquals(zero,remainder);
  one.divideDestructive(two,remainder);
  assertEquals(0L,one.longValue());
  assertEquals(2L,two.longValue());
  assertEquals(new SignedInt128(1),remainder);
  SignedInt128 var1=new SignedInt128(1234234662345L);
  var1.divideDestructive(new SignedInt128(642337),remainder);
  assertEquals(1234234662345L / 642337L,var1.longValue());
  assertEquals(1234234662345L % 642337L,remainder.longValue());
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0x42395ADC);
  SignedInt128 complicated2=new SignedInt128(0xF09DC19A,0x00001234,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,remainder);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(zero,remainder);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveInt(){
  two.multiplyDestructive(1);
  assertEquals(2L,two.longValue());
  assertEquals(1L,one.longValue());
  two.multiplyDestructive(2);
  assertEquals(4L,two.longValue());
  SignedInt128 five=new SignedInt128(5);
  five.multiplyDestructive(6432346);
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  SignedInt128 big=new SignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(96);
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  SignedInt128 tmp=new SignedInt128(1);
  tmp.shiftLeftDestructive(126);
  try {
    tmp.multiplyDestructive(2);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveSignedInt128(){
  two.multiplyDestructive(one);
  assertEquals(2L,two.longValue());
  assertEquals(1L,one.longValue());
  two.multiplyDestructive(two);
  assertEquals(4L,two.longValue());
  SignedInt128 five=new SignedInt128(5);
  five.multiplyDestructive(new SignedInt128(6432346));
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  SignedInt128 big=new SignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(new SignedInt128(96));
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  SignedInt128 tmp=new SignedInt128(1);
  tmp.shiftLeftDestructive(126);
  try {
    tmp.multiplyDestructive(new SignedInt128(2));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  SignedInt128 complicated2=new SignedInt128(54234234,9,0,0);
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.multiplyDestructive(complicated2);
  BigInteger ans=bigInteger1.multiply(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    SignedInt128 complicated3=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
    complicated3.multiplyDestructive(new SignedInt128(54234234,9845,0,0));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDestructive(){
  one.addDestructive(two);
  assertEquals(3L,one.longValue());
  assertEquals(2L,two.longValue());
  SignedInt128 big=new SignedInt128((1L << 62) + 3L);
  SignedInt128 tmp=new SignedInt128(0L);
  for (int i=0; i < 54; ++i) {
    tmp.addDestructive(big);
  }
  assertEquals(3 * 54,tmp.getV0());
  assertEquals(0x80000000,tmp.getV1());
  assertEquals(13,tmp.getV2());
  assertEquals(0,tmp.getV3());
  assertEquals((1L << 62) + 3L,big.longValue());
  SignedInt128 huge=new SignedInt128(one);
  huge.shiftLeftDestructive(125);
  SignedInt128 huge2=new SignedInt128(one);
  huge2.shiftLeftDestructive(125);
  try {
    huge2.addDestructive(huge);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestUnsignedInt128 </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveUnsignedInt128(){
  two.multiplyDestructive(one);
  assertEquals(2L,two.asLong());
  assertEquals(1L,one.asLong());
  two.multiplyDestructive(two);
  assertEquals(4L,two.asLong());
  UnsignedInt128 five=new UnsignedInt128(5);
  five.multiplyDestructive(new UnsignedInt128(6432346));
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(new UnsignedInt128(96));
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  UnsignedInt128 tmp=new UnsignedInt128(1);
  tmp.shiftLeftDestructive(126);
  tmp.multiplyDestructive(new UnsignedInt128(2));
  try {
    tmp.multiplyDestructive(new UnsignedInt128(2));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  UnsignedInt128 complicated2=new UnsignedInt128(54234234,9,0,0);
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.multiplyDestructive(complicated2);
  BigInteger ans=bigInteger1.multiply(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    UnsignedInt128 complicated3=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
    complicated3.multiplyDestructive(new UnsignedInt128(54234234,9845,0,0));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtractDestructive(){
  two.subtractDestructive(one);
  assertEquals(1L,one.asLong());
  assertEquals(1L,one.asLong());
  try {
    one.subtractDestructive(new UnsignedInt128(10L));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.shiftLeftDestructive(6);
  UnsignedInt128 tmp=new UnsignedInt128((1L << 61) + 5L);
  tmp.shiftLeftDestructive(6);
  big.subtractDestructive(tmp);
  big.subtractDestructive(tmp);
  assertEquals((3 << 6) - 2 * (5 << 6),big.getV0());
  assertEquals((3 << 8) - 1,big.getV1());
  assertEquals(0,big.getV2());
  assertEquals(0,big.getV3());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveUnsignedInt128(){
  UnsignedInt128 remainder=new UnsignedInt128();
  two.divideDestructive(one,remainder);
  assertEquals(1L,one.asLong());
  assertEquals(2L,two.asLong());
  assertEquals(zero,remainder);
  one.divideDestructive(two,remainder);
  assertEquals(0L,one.asLong());
  assertEquals(2L,two.asLong());
  assertEquals(new UnsignedInt128(1),remainder);
  UnsignedInt128 var1=new UnsignedInt128(1234234662345L);
  var1.divideDestructive(new UnsignedInt128(642337),remainder);
  assertEquals(1234234662345L / 642337L,var1.asLong());
  assertEquals(1234234662345L % 642337L,remainder.asLong());
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0x42395ADC);
  UnsignedInt128 complicated2=new UnsignedInt128(0xF09DC19A,0x00001234,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,remainder);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(zero,remainder);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveInt(){
  two.multiplyDestructive(1);
  assertEquals(2L,two.asLong());
  assertEquals(1L,one.asLong());
  two.multiplyDestructive(2);
  assertEquals(4L,two.asLong());
  UnsignedInt128 five=new UnsignedInt128(5);
  five.multiplyDestructive(6432346);
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(96);
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  UnsignedInt128 tmp=new UnsignedInt128(1);
  tmp.shiftLeftDestructive(126);
  tmp.multiplyDestructive(2);
  try {
    tmp.multiplyDestructive(2);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDestructive(){
  one.addDestructive(two);
  assertEquals(3L,one.asLong());
  assertEquals(2L,two.asLong());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + 3L);
  UnsignedInt128 tmp=new UnsignedInt128(0L);
  for (int i=0; i < 54; ++i) {
    tmp.addDestructive(big);
  }
  assertEquals(3 * 54,tmp.getV0());
  assertEquals(0x80000000,tmp.getV1());
  assertEquals(13,tmp.getV2());
  assertEquals(0,tmp.getV3());
  assertEquals((1L << 62) + 3L,big.asLong());
  UnsignedInt128 huge=one.shiftLeftConstructive(127);
  UnsignedInt128 huge2=one.shiftLeftConstructive(127);
  try {
    huge2.addDestructive(huge);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveInt(){
  two.divideDestructive(1);
  assertEquals(1L,one.asLong());
  assertEquals(2L,two.asLong());
  one.divideDestructive(2);
  assertEquals(0L,one.asLong());
  assertEquals(2L,two.asLong());
  UnsignedInt128 var1=new UnsignedInt128(1234234662345L);
  var1.divideDestructive(642337);
  assertEquals(1234234662345L / 642337L,var1.asLong());
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  complicated1.divideDestructive(1534223465);
  BigInteger bigInteger2=BigInteger.valueOf(1534223465);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(0);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.conf.TestHiveConf </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHiddenConfig() throws Exception {
  HiveConf conf=new HiveConf();
  Assert.assertTrue(conf.isHiddenConfig(HiveConf.ConfVars.METASTOREPWD.varname));
  Assert.assertTrue(conf.isHiddenConfig(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname));
  try {
    final String name=HiveConf.ConfVars.HIVE_CONF_HIDDEN_LIST.varname;
    conf.verifyAndSet(name,"");
    Assert.fail("Setting config property " + name + " should fail");
  }
 catch (  IllegalArgumentException e) {
  }
  Configuration conf2=new Configuration(conf);
  conf2.set(HiveConf.ConfVars.METASTOREPWD.varname,"password");
  conf2.set(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname,"password");
  conf.stripHiddenConfigurations(conf2);
  Assert.assertEquals("",conf2.get(HiveConf.ConfVars.METASTOREPWD.varname));
  Assert.assertEquals("",conf2.get(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestDeadline </h4><pre class="type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeadline() throws Exception {
  isFailed=false;
  errorMsg="";
  Thread threadTimeout=new Thread(createRunnable());
  threadTimeout.setDaemon(true);
  threadTimeout.start();
  threadTimeout.join(60000);
  if (isFailed) {
    Assert.fail(errorMsg);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestFilterHooks </h4><pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForPartition() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    assertNotNull(msc.getPartition(DBNAME1,TAB2,"name=value1"));
    fail("getPartition() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
  assertEquals(0,msc.getPartitionsByNames(DBNAME1,TAB2,Lists.newArrayList("name=value1")).size());
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForDb() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    assertNotNull(msc.getDatabase(DBNAME1));
    fail("getDatabase() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
  assertEquals(0,msc.getDatabases("*").size());
  assertEquals(0,msc.getAllDatabases().size());
  assertEquals(0,msc.getDatabases(DBNAME1).size());
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForTables() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    msc.getTable(DBNAME1,TAB1);
    fail("getTable() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
  assertEquals(0,msc.getTables(DBNAME1,"*").size());
  assertEquals(0,msc.getAllTables(DBNAME1).size());
  assertEquals(0,msc.getTables(DBNAME1,TAB2).size());
}

</code></pre>

<br>
<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForIndex() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    assertNotNull(msc.getIndex(DBNAME1,TAB1,INDEX1));
    fail("getPartition() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStoreTimeout </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNoTimeout() throws Exception {
  HiveMetaStore.TEST_TIMEOUT_VALUE=5 * 1000;
  String dbName="db";
  client.dropDatabase(dbName,true,true);
  Database db=new Database();
  db.setName(dbName);
  try {
    client.createDatabase(db);
  }
 catch (  MetaException e) {
    Assert.fail("should not throw timeout exception: " + e.getMessage());
  }
  client.dropDatabase(dbName,true,true);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeout() throws Exception {
  HiveMetaStore.TEST_TIMEOUT_VALUE=15 * 1000;
  String dbName="db";
  client.dropDatabase(dbName,true,true);
  Database db=new Database();
  db.setName(dbName);
  try {
    client.createDatabase(db);
    Assert.fail("should throw timeout exception.");
  }
 catch (  MetaException e) {
    Assert.assertTrue("unexpected MetaException",e.getMessage().contains("Timeout when " + "executing method: create_database"));
  }
  HiveMetaStore.TEST_TIMEOUT_VALUE=5 * 1000;
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResetTimeout() throws Exception {
  HiveMetaStore.TEST_TIMEOUT_VALUE=5 * 1000;
  String dbName="db";
  client.dropDatabase(dbName,true,true);
  Database db=new Database();
  db.setName(dbName);
  try {
    client.createDatabase(db);
  }
 catch (  MetaException e) {
    Assert.fail("should not throw timeout exception: " + e.getMessage());
  }
  client.dropDatabase(dbName,true,true);
  client.setMetaConf(HiveConf.ConfVars.METASTORE_CLIENT_SOCKET_TIMEOUT.varname,"3s");
  try {
    client.createDatabase(db);
    Assert.fail("should throw timeout exception.");
  }
 catch (  MetaException e) {
    Assert.assertTrue("unexpected MetaException",e.getMessage().contains("Timeout when " + "executing method: create_database"));
  }
  client.dropDatabase(dbName,true,true);
  client.setMetaConf(HiveConf.ConfVars.METASTORE_CLIENT_SOCKET_TIMEOUT.varname,"10s");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringifyValidTxns() throws Exception {
  ValidTxnList validTxns=new ValidReadTxnList("1:");
  String asString=validTxns.toString();
  Assert.assertEquals("1:",asString);
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(1,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(0,validTxns.getInvalidTransactions().length);
  asString=validTxns.toString();
  Assert.assertEquals("1:",asString);
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(1,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(0,validTxns.getInvalidTransactions().length);
  validTxns=new ValidReadTxnList("10:5:3");
  asString=validTxns.toString();
  if (!asString.equals("10:3:5") && !asString.equals("10:5:3")) {
    Assert.fail("Unexpected string value " + asString);
  }
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(10,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(2,validTxns.getInvalidTransactions().length);
  boolean sawThree=false, sawFive=false;
  for (  long tid : validTxns.getInvalidTransactions()) {
    if (tid == 3)     sawThree=true;
 else     if (tid == 5)     sawFive=true;
 else     Assert.fail("Unexpected value " + tid);
  }
  Assert.assertTrue(sawThree);
  Assert.assertTrue(sawFive);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreIntegration </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void grantRevokeRoles() throws Exception {
  int now=(int)(System.currentTimeMillis() / 1000);
  String roleName1="role1";
  store.addRole(roleName1,"me");
  String roleName2="role2";
  store.addRole(roleName2,"me");
  Role role1=store.getRole(roleName1);
  Role role2=store.getRole(roleName2);
  store.grantRole(role1,"fred",PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role2,roleName1,PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role2,"fred",PrincipalType.USER,"admin",PrincipalType.ROLE,false);
  List<Role> roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(3,roles.size());
  boolean sawRole1=false, sawRole2=false, sawPublic=false;
  for (  Role role : roles) {
    if (role.getRoleName().equals(roleName1)) {
      sawRole1=true;
    }
 else     if (role.getRoleName().equals(roleName2)) {
      sawRole2=true;
    }
 else     if (role.getRoleName().equals(HiveMetaStore.PUBLIC)) {
      sawPublic=true;
    }
 else {
      Assert.fail("Unknown role name " + role.getRoleName());
    }
  }
  Assert.assertTrue(sawRole1 && sawRole2 && sawPublic);
  roles=store.listRoles("fred",PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Role role=roles.get(0);
  Assert.assertEquals(roleName2,role.getRoleName());
  List<RolePrincipalGrant> grants=store.listRoleMembers(roleName1);
  Assert.assertEquals(1,grants.size());
  Assert.assertEquals("fred",grants.get(0).getPrincipalName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getPrincipalType());
  Assert.assertTrue("Expected grant time of " + now + " got "+ grants.get(0).getGrantTime(),grants.get(0).getGrantTime() >= now);
  Assert.assertEquals("bob",grants.get(0).getGrantorName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getGrantorPrincipalType());
  Assert.assertFalse(grants.get(0).isGrantOption());
  grants=store.listRoleMembers(roleName2);
  Assert.assertEquals(2,grants.size());
  boolean sawFred=false;
  sawRole1=false;
  for (  RolePrincipalGrant m : grants) {
    if ("fred".equals(m.getPrincipalName()))     sawFred=true;
 else     if (roleName1.equals(m.getPrincipalName()))     sawRole1=true;
 else     Assert.fail("Unexpected principal " + m.getPrincipalName());
  }
  Assert.assertTrue(sawFred && sawRole1);
  store.revokeRole(role2,roleName1,PrincipalType.ROLE,true);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName2,roles.get(0).getRoleName());
  grants=store.listRoleMembers(roleName1);
  Assert.assertFalse(grants.get(0).isGrantOption());
  store.removeRole(roleName1);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(2,roles.size());
  sawRole2=sawPublic=false;
  for (  Role m : roles) {
    if (m.getRoleName().equals(roleName2))     sawRole2=true;
 else     if (m.getRoleName().equals(HiveMetaStore.PUBLIC))     sawPublic=true;
 else     Assert.fail("Unknown role " + m.getRoleName());
  }
  Assert.assertTrue(sawRole2 && sawPublic);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  store.revokeRole(role2,"fred",PrincipalType.USER,false);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(HiveMetaStore.PUBLIC,roles.get(0).getRoleName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeFromLocalWorkers() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","baz",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","bazzoo",CompactionType.MINOR);
  txnHandler.compact(rqst);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  assertNotNull(txnHandler.findNextToCompact("bob-193892"));
  assertNotNull(txnHandler.findNextToCompact("fred-193893"));
  txnHandler.revokeFromLocalWorkers("fred");
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(3,compacts.size());
  boolean sawWorkingBob=false;
  int initiatedCount=0;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working")) {
      assertEquals("bob-193892",c.getWorkerid());
      sawWorkingBob=true;
    }
 else     if (c.getState().equals("initiated")) {
      initiatedCount++;
    }
 else {
      fail("Unexpected state");
    }
  }
  assertTrue(sawWorkingBob);
  assertEquals(2,initiatedCount);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeTimedOutWorkers() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","baz",CompactionType.MINOR);
  txnHandler.compact(rqst);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  Thread.sleep(200);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  txnHandler.revokeTimedoutWorkers(100);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(2,compacts.size());
  boolean sawWorking=false, sawInitiated=false;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working"))     sawWorking=true;
 else     if (c.getState().equals("initiated"))     sawInitiated=true;
 else     fail("Unexpected state");
  }
  assertTrue(sawWorking);
  assertTrue(sawInitiated);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToCompact2() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=yesterday");
  txnHandler.compact(rqst);
  long now=System.currentTimeMillis();
  boolean expectToday=false;
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  if ("ds=today".equals(ci.partName))   expectToday=false;
 else   if ("ds=yesterday".equals(ci.partName))   expectToday=true;
 else   fail("partition name should have been today or yesterday but was " + ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  if (expectToday)   assertEquals("ds=today",ci.partName);
 else   assertEquals("ds=yesterday",ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(2,compacts.size());
  for (  ShowCompactResponseElement e : compacts) {
    assertEquals("working",e.getState());
    assertTrue(e.getStart() - 5000 < now && e.getStart() + 5000 > now);
    assertEquals("fred",e.getWorkerid());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestTxnHandler </h4><pre class="type-6 type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void showLocks() throws Exception {
  long begining=System.currentTimeMillis();
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  txnid=openTxn();
  comp=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"mydb");
  comp.setTablename("mytable");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  components=new ArrayList<LockComponent>(1);
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.PARTITION,"yourdb");
  comp.setTablename("yourtable");
  comp.setPartitionname("yourpartition");
  components.add(comp);
  req=new LockRequest(components,"you","remotehost");
  res=txnHandler.lock(req);
  ShowLocksResponse rsp=txnHandler.showLocks(new ShowLocksRequest());
  List<ShowLocksResponseElement> locks=rsp.getLocks();
  assertEquals(3,locks.size());
  boolean[] saw=new boolean[locks.size()];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  ShowLocksResponseElement lock : locks) {
    if (lock.getLockid() == 1) {
      assertEquals(1,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertNull(lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.EXCLUSIVE,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertTrue("Expected acquired at " + lock.getAcquiredat() + " to be between "+ begining+ " and "+ System.currentTimeMillis(),begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[0]=true;
    }
 else     if (lock.getLockid() == 2) {
      assertEquals(2,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertEquals("mytable",lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.WAITING,lock.getState());
      assertEquals(LockType.SHARED_READ,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertEquals(0,lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[1]=true;
    }
 else     if (lock.getLockid() == 3) {
      assertEquals(0,lock.getTxnid());
      assertEquals("yourdb",lock.getDbname());
      assertEquals("yourtable",lock.getTablename());
      assertEquals("yourpartition",lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.SHARED_WRITE,lock.getType());
      assertTrue(lock.toString(),begining <= lock.getLastheartbeat() && System.currentTimeMillis() >= lock.getLastheartbeat());
      assertTrue(begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("you",lock.getUser());
      assertEquals("remotehost",lock.getHostname());
      saw[2]=true;
    }
 else {
      fail("Unknown lock id");
    }
  }
  for (int i=0; i < saw.length; i++)   assertTrue("Didn't see lock id " + i,saw[i]);
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCheckLockNoSuchLock() throws Exception {
  try {
    txnHandler.checkLock(new CheckLockRequest(23L));
    fail("Allowed to check lock on non-existent lock");
  }
 catch (  NoSuchLockException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHeartbeatTxnAborted() throws Exception {
  openTxn();
  txnHandler.abortTxn(new AbortTxnRequest(1));
  HeartbeatRequest h=new HeartbeatRequest();
  h.setTxnid(1);
  try {
    txnHandler.heartbeat(h);
    fail("Told there was a txn, when it should have been aborted.");
  }
 catch (  TxnAbortedException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnlockWithTxn() throws Exception {
  LOG.debug("Starting testUnlockWithTxn");
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("mypartition");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  long lockid=res.getLockid();
  try {
    txnHandler.unlock(new UnlockRequest(lockid));
    fail("Allowed to unlock lock associated with transaction.");
  }
 catch (  TxnOpenException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHeartbeatNoLock() throws Exception {
  HeartbeatRequest h=new HeartbeatRequest();
  h.setLockid(29389839L);
  try {
    txnHandler.heartbeat(h);
    fail("Told there was a lock, when there wasn't.");
  }
 catch (  NoSuchLockException e) {
  }
}

</code></pre>

<br>
<pre class="type-6 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeatLock() throws Exception {
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TXN_TIMEOUT,1,TimeUnit.SECONDS);
  HeartbeatRequest h=new HeartbeatRequest();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("mypartition");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  h.setLockid(res.getLockid());
  for (int i=0; i < 30; i++) {
    try {
      txnHandler.heartbeat(h);
    }
 catch (    NoSuchLockException e) {
      fail("Told there was no lock, when the heartbeat should have kept it.");
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLockTimeout() throws Exception {
  long timeout=txnHandler.setTimeout(1);
  try {
    LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
    comp.setTablename("mytable");
    comp.setPartitionname("mypartition");
    List<LockComponent> components=new ArrayList<LockComponent>(1);
    components.add(comp);
    LockRequest req=new LockRequest(components,"me","localhost");
    LockResponse res=txnHandler.lock(req);
    assertTrue(res.getState() == LockState.ACQUIRED);
    Thread.sleep(10);
    txnHandler.performTimeOuts();
    txnHandler.checkLock(new CheckLockRequest(res.getLockid()));
    fail("Told there was a lock, when it should have timed out.");
  }
 catch (  NoSuchLockException e) {
  }
 finally {
    txnHandler.setTimeout(timeout);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCheckLockTxnAborted() throws Exception {
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("mypartition");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  long lockid=res.getLockid();
  txnHandler.abortTxn(new AbortTxnRequest(txnid));
  try {
    txnHandler.checkLock(new CheckLockRequest(lockid));
    fail("Allowed to check lock on aborted transaction.");
  }
 catch (  NoSuchLockException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHeartbeatNoTxn() throws Exception {
  HeartbeatRequest h=new HeartbeatRequest();
  h.setTxnid(939393L);
  try {
    txnHandler.heartbeat(h);
    fail("Told there was a txn, when there wasn't.");
  }
 catch (  NoSuchTxnException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests multi-user scenario (like HiveServer2) where each user gets a session
 * and uses it multiple times.
 */
@Test public void testMultiSessionMultipleUse() throws Exception {
  sessionManagerHS2=SparkSessionManagerImpl.getInstance();
  sessionManagerHS2.shutdown();
  HiveConf hiveConf=new HiveConf();
  hiveConf.set("spark.master","local");
  sessionManagerHS2.setup(hiveConf);
  List<Thread> threadList=new ArrayList<Thread>();
  for (int i=0; i < 10; i++) {
    Thread t=new Thread(new SessionThread(),"Session thread " + i);
    t.start();
    threadList.add(t);
  }
  for (  Thread t : threadList) {
    try {
      t.join();
    }
 catch (    InterruptedException e) {
      String msg="Interrupted while waiting for test session threads.";
      LOG.error(msg,e);
      fail(msg);
    }
  }
  assertFalse("At least one of the session threads failed. See the test output for details.",anyFailedSessionThread);
  System.out.println("Ending SessionManagerHS2");
  sessionManagerHS2.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestTezSessionPool </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLlapSessionQueuing(){
  try {
    random=new Random(1000);
    conf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_LLAP_CONCURRENT_QUERIES,2);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
  }
 catch (  Exception e) {
    LOG.error("Initialization error",e);
    fail();
  }
  List<Thread> threadList=new ArrayList<Thread>();
  for (int i=0; i < 15; i++) {
    Thread t=new Thread(new SessionThread(true));
    threadList.add(t);
    t.start();
  }
  for (  Thread t : threadList) {
    try {
      t.join();
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
      fail();
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionPoolThreads(){
  try {
    conf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"0,1,2");
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,4);
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSION_MAX_INIT_THREADS,16);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState[] sessions=new TezSessionState[12];
    int[] queueCounts=new int[3];
    for (int i=0; i < sessions.length; ++i) {
      sessions[i]=poolManager.getSession(null,conf,true,false);
      queueCounts[Integer.parseInt(sessions[i].getQueueName())]+=1;
    }
    for (int i=0; i < queueCounts.length; ++i) {
      assertEquals(4,queueCounts[i]);
    }
    for (int i=0; i < sessions.length; ++i) {
      poolManager.returnSession(sessions[i],false);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetNonDefaultSession(){
  poolManager=new TestTezSessionPoolManager();
  try {
    TezSessionState sessionState=poolManager.getSession(null,conf,true,false);
    TezSessionState sessionState1=poolManager.getSession(sessionState,conf,true,false);
    if (sessionState1 != sessionState) {
      fail();
    }
    conf.set("tez.queue.name","nondefault");
    TezSessionState sessionState2=poolManager.getSession(sessionState,conf,true,false);
    if (sessionState2 == sessionState) {
      fail();
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionPoolGetInOrder(){
  try {
    conf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"a,b,c");
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,2);
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSION_MAX_INIT_THREADS,1);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("a",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("b",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("c",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    if (sessionState.getQueueName().compareTo("a") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState,false);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReturn(){
  conf.set("tez.queue.name","");
  random=new Random(1000);
  conf.setBoolVar(HiveConf.ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
  conf.setVar(HiveConf.ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"a,b,c");
  conf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,2);
  try {
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
  List<Thread> threadList=new ArrayList<Thread>();
  for (int i=0; i < 15; i++) {
    Thread t=new Thread(new SessionThread(false));
    threadList.add(t);
    t.start();
  }
  for (  Thread t : threadList) {
    try {
      t.join();
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
      fail();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorDateExpressions </h4><pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testMultiThreadedVectorUDFDate(){
  List<Callable<Void>> tasks=new ArrayList<Callable<Void>>();
  for (int i=0; i < 200; i++) {
    tasks.add(new MultiThreadedDateFormatTest());
  }
  try {
    List<Future<Void>> results=runner.invokeAll(tasks);
    for (    Future<Void> f : results) {
      Assert.assertNull(f.get());
    }
  }
 catch (  InterruptedException ioe) {
    Assert.fail("Interrupted while running tests");
  }
catch (  Exception e) {
    Assert.fail("Multi threaded operations threw unexpected Exception: " + e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestRCFile </h4><pre class="type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseForErroneousRCFile() throws IOException {
  Configuration conf=new Configuration();
  LocalFileSystem fs=FileSystem.getLocal(conf);
  Path path=new Path(System.getProperty("test.tmp.dir",".") + "/broken.rcfile");
  fs.create(path).close();
  final TestFSDataInputStream[] openedFile=new TestFSDataInputStream[1];
  try {
    new RCFile.Reader(fs,path,conf){
      @Override protected FSDataInputStream openFile(      FileSystem fs,      Path file,      int bufferSize,      long length) throws IOException {
        final InputStream in=super.openFile(fs,file,bufferSize,length);
        openedFile[0]=new TestFSDataInputStream(in);
        return openedFile[0];
      }
    }
;
    fail("IOException expected.");
  }
 catch (  IOException expected) {
  }
  assertNotNull(path + " should have been opened.",openedFile[0]);
  assertTrue("InputStream for " + path + " should have been closed.",openedFile[0].isClosed());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSync() throws IOException {
  Path testDir=new Path(System.getProperty("test.tmp.dir",".") + "/mapred/testsync");
  Path testFile=new Path(testDir,"test_rcfile");
  fs.delete(testFile,true);
  int intervalRecordCount=500;
  CompressionCodec codec=null;
  int writeCount=2500;
  Configuration cloneConf=new Configuration(conf);
  RCFileOutputFormat.setColumnNumber(cloneConf,bytesArray.length);
  cloneConf.setInt(HiveConf.ConfVars.HIVE_RCFILE_RECORD_INTERVAL.varname,intervalRecordCount);
  RCFile.Writer writer=new RCFile.Writer(fs,cloneConf,testFile,null,codec);
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(bytesArray.length);
  for (int i=0; i < bytesArray.length; i++) {
    BytesRefWritable cu=null;
    cu=new BytesRefWritable(bytesArray[i],0,bytesArray[i].length);
    bytes.set(i,cu);
  }
  for (int i=0; i < writeCount; i++) {
    writer.append(bytes);
  }
  writer.close();
  long fileLen=fs.getFileStatus(testFile).getLen();
  RCFileInputFormat inputFormat=new RCFileInputFormat();
  JobConf jobconf=new JobConf(cloneConf);
  jobconf.set("mapred.input.dir",testDir.toString());
  HiveConf.setLongVar(jobconf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,fileLen);
  InputSplit[] splits=inputFormat.getSplits(jobconf,1);
  RCFileRecordReader rr=new RCFileRecordReader(jobconf,(FileSplit)splits[0]);
  long lastSync=0;
  for (int i=0; i < 2500; i++) {
    rr.sync(i);
    if (rr.getPos() < lastSync) {
      String reason=String.format("Sync at offset %d skipped sync block at location %d (returned %d instead)",i - 1,rr.getPos(),lastSync);
      System.out.println(reason);
      fail(reason);
    }
    lastSync=rr.getPos();
  }
  rr.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestDataWritableWriter </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedStructTypeOnRecord() throws Exception {
  String columnNames="structCol";
  String columnTypes="int";
  ArrayWritable hiveRecord=createGroup(createInt(1));
  String fileSchema="message hive_schema {\n" + "  optional group structCol {\n" + "      optional int32 int;\n"+ "    }\n"+ "}\n";
  try {
    writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Invalid data type: expected STRUCT type, but found: PRIMITIVE",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedMapTypeOnRecord() throws Exception {
  String columnNames="mapCol";
  String columnTypes="int";
  ArrayWritable hiveRecord=createGroup(createInt(1));
  String fileSchema="message hive_schema {\n" + "  optional group mapCol (MAP) {\n" + "    repeated group map (MAP_KEY_VALUE) {\n"+ "      required binary key;\n"+ "      optional int32 value;\n"+ "    }\n"+ "  }\n"+ "}\n";
  try {
    writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Invalid data type: expected MAP type, but found: PRIMITIVE",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedArrayTypeOnRecord() throws Exception {
  String columnNames="arrayCol";
  String columnTypes="int";
  ArrayWritable hiveRecord=createGroup(createInt(1));
  String fileSchema="message hive_schema {\n" + "  optional group arrayCol (LIST) {\n" + "    repeated group bag {\n"+ "      optional int32 array_element;\n"+ "    }\n"+ "  }\n"+ "}\n";
  try {
    writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Invalid data type: expected LIST type, but found: PRIMITIVE",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestMapredParquetOutputFormat </h4><pre class="type-3 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testGetHiveRecordWriter() throws IOException {
  Properties tableProps=new Properties();
  tableProps.setProperty("columns","foo,bar");
  tableProps.setProperty("columns.types","int:int");
  final Progressable mockProgress=mock(Progressable.class);
  final ParquetOutputFormat<ParquetHiveRecord> outputFormat=(ParquetOutputFormat<ParquetHiveRecord>)mock(ParquetOutputFormat.class);
  JobConf jobConf=new JobConf();
  try {
    new MapredParquetOutputFormat(outputFormat){
      @Override protected ParquetRecordWriterWrapper getParquerRecordWriterWrapper(      ParquetOutputFormat<ParquetHiveRecord> realOutputFormat,      JobConf jobConf,      String finalOutPath,      Progressable progress,      Properties tableProperties) throws IOException {
        assertEquals(outputFormat,realOutputFormat);
        assertNotNull(jobConf.get(DataWritableWriteSupport.PARQUET_HIVE_SCHEMA));
        assertEquals("/foo",finalOutPath.toString());
        assertEquals(mockProgress,progress);
        throw new RuntimeException("passed tests");
      }
    }
.getHiveRecordWriter(jobConf,new Path("/foo"),null,false,tableProps,mockProgress);
    fail("should throw runtime exception.");
  }
 catch (  RuntimeException e) {
    assertEquals("passed tests",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRecordWriterThrowsException(){
  try {
    new MapredParquetOutputFormat().getRecordWriter(null,null,null,null);
    fail("should throw runtime exception.");
  }
 catch (  Exception e) {
    assertEquals("Should never be used",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lib.TestRuleRegExp </h4><pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPatternWithWildCardChar(){
  RuleRegExp rule1=new RuleRegExp("R1","(" + TableScanOperator.getOperatorName() + "%"+ FilterOperator.getOperatorName()+ "%)|("+ TableScanOperator.getOperatorName()+ "%"+ FileSinkOperator.getOperatorName()+ "%)");
  assertEquals(rule1.rulePatternIsValidWithoutWildCardChar(),false);
  assertEquals(rule1.rulePatternIsValidWithWildCardChar(),true);
  Stack<Node> ns1=new Stack<Node>();
  ns1.push(new TestNode(TableScanOperator.getOperatorName()));
  ns1.push(new TestNode(FilterOperator.getOperatorName()));
  Stack<Node> ns2=new Stack<Node>();
  ns2.push(new TestNode(TableScanOperator.getOperatorName()));
  ns2.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertNotEquals(rule1.cost(ns1),-1);
    assertNotEquals(rule1.cost(ns2),-1);
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
  Stack<Node> ns3=new Stack<Node>();
  ns3.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns3.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns3.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertEquals(rule1.cost(ns3),-1);
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPatternWithoutWildCardChar(){
  String patternStr=ReduceSinkOperator.getOperatorName() + "%" + SelectOperator.getOperatorName()+ "%"+ FileSinkOperator.getOperatorName()+ "%";
  RuleRegExp rule1=new RuleRegExp("R1",patternStr);
  assertEquals(rule1.rulePatternIsValidWithoutWildCardChar(),true);
  assertEquals(rule1.rulePatternIsValidWithWildCardChar(),false);
  Stack<Node> ns1=new Stack<Node>();
  ns1.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns1.push(new TestNode(SelectOperator.getOperatorName()));
  ns1.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertEquals(rule1.cost(ns1),patternStr.length());
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
  Stack<Node> ns2=new Stack<Node>();
  ns2.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns1.push(new TestNode(TableScanOperator.getOperatorName()));
  ns1.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertEquals(rule1.cost(ns2),-1);
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.zookeeper.TestZookeeperLockManager </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteNoChildren() throws Exception {
  client.create().creatingParentsIfNeeded().forPath(TABLE_LOCK_PATH,lockObjData.toString().getBytes());
  byte[] data=client.getData().forPath(TABLE_LOCK_PATH);
  Assert.assertArrayEquals(lockObjData.toString().getBytes(),data);
  ZooKeeperHiveLockManager.unlockPrimitive(zLock,PARENT,client);
  try {
    data=client.getData().forPath(TABLE_LOCK_PATH);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertEquals(e instanceof KeeperException.NoNodeException,true);
  }
  try {
    data=client.getData().forPath(PARENT_LOCK_PATH);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertEquals(e instanceof KeeperException.NoNodeException,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestSemanticAnalyzer </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNormalizeColSpec() throws Exception {
  checkNormalization("date","2010-01-01","2010-01-01",Date.valueOf("2010-01-01"));
  checkNormalization("date","2010-1-01","2010-01-01",Date.valueOf("2010-01-01"));
  checkNormalization("date","2010-1-1","2010-01-01",Date.valueOf("2010-01-01"));
  checkNormalization("string","2010-1-1","2010-1-1","2010-1-1");
  try {
    checkNormalization("date","foo","","foo");
    fail("should throw");
  }
 catch (  SemanticException ex) {
  }
  try {
    checkNormalization("date","2010-01-01","2010-01-01","2010-01-01");
    fail("should throw");
  }
 catch (  SemanticException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.authorization.TestHiveAuthorizationTaskFactory </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ALL ON SERVER
 */
@Test public void testGrantServer() throws Exception {
  String serverName="foo";
  try {
    analyze("GRANT ALL ON SERVER " + serverName + " TO USER user2");
    Assert.fail("Grant on Server should fail");
  }
 catch (  SemanticException e) {
    Assert.assertEquals(serverName,DummyHiveAuthorizationTaskFactoryImpl.serverName);
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ALL ON URI
 */
@Test public void testGrantUri() throws Exception {
  String uriPath="/tmp";
  try {
    analyze("GRANT ALL ON URI '" + uriPath + "' TO USER user2");
    Assert.fail("Grant on URI should fail");
  }
 catch (  SemanticException e) {
    Assert.assertEquals(uriPath,DummyHiveAuthorizationTaskFactoryImpl.uriPath);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.authorization.plugin.sqlstd.TestOperation2Privilege </h4><pre class="type-12 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test that all enums in {@link HiveOperationType} match one map entry in
 * Operation2Privilege
 */
@Test public void checkHiveOperationTypeMatch(){
  Set<HiveOperationType> operationMapKeys=Operation2Privilege.getOperationTypes();
  for (  HiveOperationType operationType : HiveOperationType.values()) {
    if (!operationMapKeys.contains(operationType)) {
      fail("Unable to find corresponding entry in Operation2Privilege map for HiveOperationType " + operationType);
    }
  }
  assertEquals("Check if Operation2Privilege, HiveOperationType have same number of instances",operationMapKeys.size(),HiveOperationType.values().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestReadEntityDirect </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as direct, as it is also accessed
 * directly in the join query
 * @throws ParseException
 */
@Test public void testSelectEntityViewDirectJoin() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1 join t1 on (v1.i = t1.i)");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as indirect
 * @throws ParseException
 */
@Test public void testSelectEntityInDirect() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertFalse("not direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as direct, as it is also accessed
 * directly in the union-all query
 * @throws ParseException
 */
@Test public void testSelectEntityViewDirectUnion() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from ( select * from v1 union all select * from t1) uv1t1");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as indirect. Query with join of views and aliases
 * @throws ParseException
 */
@Test public void testSelectEntityInDirectJoinAlias() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1 as a join v1 as b on (a.i = b.i)");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertFalse("not direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.processors.TestCommandProcessorFactory </h4><pre class="type-11 type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAvailableCommands() throws Exception {
  enableTestOnlyCmd(conf);
  SessionState.start(conf);
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    String cmdInLowerCase=cmd.toLowerCase();
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting()));
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmdInLowerCase},conf,command.isOnlyForTesting()));
  }
  conf.set(HiveConf.ConfVars.HIVE_SECURITY_COMMAND_WHITELIST.toString(),"");
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    try {
      CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting());
      Assert.fail("Expected SQLException for " + cmd + " as available commands is empty");
    }
 catch (    SQLException e) {
      Assert.assertEquals("Insufficient privileges to execute " + cmd,e.getMessage());
      Assert.assertEquals("42000",e.getSQLState());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.security.authorization.plugin.TestHiveOperationType </h4><pre class="type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * test that all enums in {@link HiveOperation} match one in @{link HiveOperationType}
 */
@Test public void checkHiveOperationTypeMatch(){
  for (  HiveOperation op : HiveOperation.values()) {
    try {
      HiveOperationType.valueOf(op.name());
    }
 catch (    IllegalArgumentException ex) {
      fail("Unable to find corresponding type in HiveOperationType for " + op + " : "+ ex);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.session.TestSessionState </h4><pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReloadExistingAuxJars2(){
  HiveConf conf=new HiveConf();
  HiveConf.setVar(conf,ConfVars.HIVERELOADABLEJARS,hiveReloadPath);
  SessionState ss=new SessionState(conf);
  SessionState.start(ss);
  File dist=null;
  try {
    ss=SessionState.get();
    LOG.info("copy jar file 1");
    dist=new File(reloadFolder.getAbsolutePath() + File.separator + reloadClazzFileName);
    Files.copy(new File(HiveTestUtils.getFileFromClasspath(clazzDistFileName)),dist);
    ss.reloadAuxJars();
    Assert.assertEquals("version1",getReloadedClazzVersion(ss.getConf().getClassLoader()));
    LOG.info("copy jar file 2");
    FileUtils.deleteQuietly(dist);
    Files.copy(new File(HiveTestUtils.getFileFromClasspath(clazzV2FileName)),dist);
    ss.reloadAuxJars();
    Assert.assertEquals("version2",getReloadedClazzVersion(ss.getConf().getClassLoader()));
    FileUtils.deleteQuietly(dist);
    ss.reloadAuxJars();
  }
 catch (  Exception e) {
    LOG.error("refresh existing jar file case failed with message: ",e);
    Assert.fail(e.getMessage());
  }
 finally {
    FileUtils.deleteQuietly(dist);
    try {
      ss.close();
    }
 catch (    IOException ioException) {
      Assert.fail(ioException.getMessage());
      LOG.error("Fail to close the created session: ",ioException);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  HiveConf conf=new HiveConf();
  String tmp=System.getProperty("java.io.tmpdir");
  File tmpDir=new File(tmp);
  if (!tmpDir.exists()) {
    tmpDir.mkdir();
  }
  hiveReloadPath=Files.createTempDir().getAbsolutePath();
  reloadFolder=new File(hiveReloadPath);
  if (!reloadFolder.exists()) {
    reloadFolder.mkdir();
  }
  try {
    generateRefreshJarFiles(V2);
    generateRefreshJarFiles(V1);
  }
 catch (  Throwable e) {
    Assert.fail("fail to generate refresh jar file due to the error " + e);
  }
  if (prewarm) {
    HiveConf.setBoolVar(conf,ConfVars.HIVE_PREWARM_ENABLED,true);
    HiveConf.setIntVar(conf,ConfVars.HIVE_PREWARM_NUM_CONTAINERS,1);
  }
  SessionState.start(conf);
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReloadAuxJars2(){
  HiveConf conf=new HiveConf();
  HiveConf.setVar(conf,ConfVars.HIVERELOADABLEJARS,hiveReloadPath);
  SessionState ss=new SessionState(conf);
  SessionState.start(ss);
  ss=SessionState.get();
  File dist=null;
  try {
    dist=new File(reloadFolder.getAbsolutePath() + File.separator + reloadClazzFileName);
    Files.copy(new File(HiveTestUtils.getFileFromClasspath(clazzDistFileName)),dist);
    ss.reloadAuxJars();
    Assert.assertEquals("version1",getReloadedClazzVersion(ss.getConf().getClassLoader()));
  }
 catch (  Exception e) {
    LOG.error("Reload auxiliary jar test fail with message: ",e);
    Assert.fail(e.getMessage());
  }
 finally {
    FileUtils.deleteQuietly(dist);
    try {
      ss.close();
    }
 catch (    IOException ioException) {
      Assert.fail(ioException.getMessage());
      LOG.error("Fail to close the created session: ",ioException);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCleaner </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorTableCompaction() throws Exception {
  Table t=newTable("default","camitc",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addDeltaFile(t,null,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camitc",CompactionType.MINOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path p : paths) {
    if (p.getName().equals("base_20"))     sawBase=true;
 else     if (p.getName().equals(makeDeltaDirName(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + p.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorPartitionCompaction() throws Exception {
  Table t=newTable("default","camipc",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addDeltaFile(t,p,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camipc",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path path : paths) {
    if (path.getName().equals("base_20"))     sawBase=true;
 else     if (path.getName().equals(makeDeltaDirNameCompacted(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + path.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCompactor </h4><pre class="type-11 type-12 type-3 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void minorCompactAfterAbort() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MINOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.deltaFileFilter);
    String[] names=new String[stat.length];
    Path resultDelta=null;
    for (int i=0; i < names.length; i++) {
      names[i]=stat[i].getPath().getName();
      if (names[i].equals("delta_0000001_0000006")) {
        resultDelta=stat[i].getPath();
      }
    }
    Arrays.sort(names);
    String[] expected=new String[]{"delta_0000001_0000002","delta_0000001_0000006","delta_0000003_0000004","delta_0000005_0000006"};
    if (!Arrays.deepEquals(expected,names)) {
      Assert.fail("Expected: " + Arrays.toString(expected) + ", found: "+ Arrays.toString(names));
    }
    checkExpectedTxnsPresent(null,new Path[]{resultDelta},columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void majorCompactAfterAbort() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("majorCompactAfterAbort FileStatus[] stat " + Arrays.toString(stat));
    }
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000006\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    if (!name.equals("base_0000006")) {
      Assert.fail("majorCompactAfterAbort name " + name + " not equals to base_0000006");
    }
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * After each major compaction, stats need to be updated on each column of the
 * table/partition which previously had stats.
 * 1. create a bucketed ORC backed table (Orc is currently required by ACID)
 * 2. populate 2 partitions with data
 * 3. compute stats
 * 4. insert some data into the table using StreamingAPI
 * 5. Trigger major compaction (which should update stats)
 * 6. check that stats have been updated
 * @throws Exceptiontodo:
 * 2. add non-partitioned test
 * 4. add a test with sorted table?
 */
@Test public void testStatsAfterCompactionPartTbl() throws Exception {
  String tblName="compaction_test";
  String tblNameStg=tblName + "_stg";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("drop table if exists " + tblNameStg,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(bkt INT)"+ " CLUSTERED BY(a) INTO 4 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("CREATE EXTERNAL TABLE " + tblNameStg + "(a INT, b STRING)"+ " ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t' LINES TERMINATED BY '\\n'"+ " STORED AS TEXTFILE"+ " LOCATION '"+ stagingFolder.newFolder().toURI().getPath()+ "'"+ " TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("load data local inpath '" + BASIC_FILE_NAME + "' overwrite into table "+ tblNameStg,driver);
  execSelectAndDumpData("select * from " + tblNameStg,driver,"Dumping data for " + tblNameStg + " after load:");
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=0) "+ "SELECT a, b where a < 2",driver);
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=1) "+ "SELECT a, b where a >= 2",driver);
  execSelectAndDumpData("select * from " + tblName,driver,"Dumping data for " + tblName + " after load:");
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  CompactionInfo ci=new CompactionInfo("default",tblName,"bkt=0",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  Worker.StatsUpdater su=Worker.StatsUpdater.init(ci,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  CompactionInfo ciPart2=new CompactionInfo("default",tblName,"bkt=1",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  su=Worker.StatsUpdater.init(ciPart2,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  Map<String,List<ColumnStatisticsObj>> stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  List<ColumnStatisticsObj> colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  LongColumnStatsData colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",1,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",1,colAStats.getNumDVs());
  StringColumnStatsData colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",3,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",3.0,colBStats.getAvgColLen(),0.01);
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",2,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  LongColumnStatsData colAStatsPart2=colStats.get(0).getStatsData().getLongStats();
  StringColumnStatsData colBStatsPart2=colStats.get(1).getStatsData().getStringStats();
  HiveEndPoint endPt=new HiveEndPoint(null,ci.dbname,ci.tableName,Arrays.asList("0"));
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(true);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  Assert.assertEquals(TransactionBatch.TxnState.OPEN,txnBatch.getCurrentTransactionState());
  txnBatch.write("50,Kiev".getBytes());
  txnBatch.write("51,St. Petersburg".getBytes());
  txnBatch.write("44,Boston".getBytes());
  txnBatch.commit();
  txnBatch.beginNextTransaction();
  txnBatch.write("52,Tel Aviv".getBytes());
  txnBatch.write("53,Atlantis".getBytes());
  txnBatch.write("53,Boston".getBytes());
  txnBatch.commit();
  txnBatch.close();
  connection.close();
  execSelectAndDumpData("select * from " + ci.getFullTableName(),driver,ci.getFullTableName());
  CompactionRequest rqst=new CompactionRequest(ci.dbname,ci.tableName,CompactionType.MAJOR);
  rqst.setPartitionname(ci.partName);
  txnHandler.compact(rqst);
  Worker t=new Worker();
  t.setThreadId((int)t.getId());
  t.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  t.init(stop,looped);
  t.run();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  if (1 != compacts.size()) {
    Assert.fail("Expecting 1 file and found " + compacts.size() + " files "+ compacts.toString());
  }
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",53,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",6,colAStats.getNumDVs());
  colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",14,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",(long)6.1111111111,(long)colBStats.getAvgColLen());
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",10,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colAStatsPart2,colStats.get(0).getStatsData().getLongStats());
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colBStatsPart2,colStats.get(1).getStatsData().getStringStats());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true') ",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000004\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    Assert.assertEquals(name,"base_0000004");
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void minorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MINOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.deltaFileFilter);
    String[] names=new String[stat.length];
    Path resultFile=null;
    for (int i=0; i < names.length; i++) {
      names[i]=stat[i].getPath().getName();
      if (names[i].equals("delta_0000001_0000004")) {
        resultFile=stat[i].getPath();
      }
    }
    Arrays.sort(names);
    String[] expected=new String[]{"delta_0000001_0000002","delta_0000001_0000004","delta_0000003_0000004","delta_0000005_0000006"};
    if (!Arrays.deepEquals(expected,names)) {
      Assert.fail("Expected: " + Arrays.toString(expected) + ", found: "+ Arrays.toString(names));
    }
    checkExpectedTxnsPresent(null,new Path[]{resultFile},columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestInitiator </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recoverFailedLocalWorkers() throws Exception {
  Table t=newTable("default","rflw1",false);
  CompactionRequest rqst=new CompactionRequest("default","rflw1",CompactionType.MINOR);
  txnHandler.compact(rqst);
  t=newTable("default","rflw2",false);
  rqst=new CompactionRequest("default","rflw2",CompactionType.MINOR);
  txnHandler.compact(rqst);
  txnHandler.findNextToCompact(Worker.hostname() + "-193892");
  txnHandler.findNextToCompact("nosuchhost-193892");
  startInitiator();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  boolean sawInitiated=false;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working")) {
      Assert.assertEquals("nosuchhost-193892",c.getWorkerid());
    }
 else     if (c.getState().equals("initiated")) {
      sawInitiated=true;
    }
 else {
      Assert.fail("Unexpected state");
    }
  }
  Assert.assertTrue(sawInitiated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestWorker </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringableList() throws Exception {
  CompactorMR.StringableList ls=new CompactorMR.StringableList();
  String s=ls.toString();
  Assert.assertEquals("0:",s);
  ls=new CompactorMR.StringableList(s);
  Assert.assertEquals(0,ls.size());
  ls=new CompactorMR.StringableList();
  ls.add(new Path("/tmp"));
  ls.add(new Path("/usr"));
  s=ls.toString();
  Assert.assertTrue("Expected 2:4:/tmp4:/usr or 2:4:/usr4:/tmp, got " + s,"2:4:/tmp4:/usr".equals(s) || "2:4:/usr4:/tmp".equals(s));
  ls=new CompactorMR.StringableList(s);
  Assert.assertEquals(2,ls.size());
  boolean sawTmp=false, sawUsr=false;
  for (  Path p : ls) {
    if ("/tmp".equals(p.toString()))     sawTmp=true;
 else     if ("/usr".equals(p.toString()))     sawUsr=true;
 else     Assert.fail("Unexpected path " + p.toString());
  }
  Assert.assertTrue(sawTmp);
  Assert.assertTrue(sawUsr);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringableMap() throws Exception {
  CompactorMR.StringableMap m=new CompactorMR.StringableMap(new HashMap<String,String>());
  String s=m.toString();
  Assert.assertEquals("0:",s);
  m=new CompactorMR.StringableMap(s);
  Assert.assertEquals(0,m.size());
  Map<String,String> base=new HashMap<String,String>();
  base.put("mary","poppins");
  base.put("bert",null);
  base.put(null,"banks");
  m=new CompactorMR.StringableMap(base);
  s=m.toString();
  m=new CompactorMR.StringableMap(s);
  Assert.assertEquals(3,m.size());
  Map<String,Boolean> saw=new HashMap<String,Boolean>(3);
  saw.put("mary",false);
  saw.put("bert",false);
  saw.put(null,false);
  for (  Map.Entry<String,String> e : m.entrySet()) {
    saw.put(e.getKey(),true);
    if ("mary".equals(e.getKey()))     Assert.assertEquals("poppins",e.getValue());
 else     if ("bert".equals(e.getKey()))     Assert.assertNull(e.getValue());
 else     if (null == e.getKey())     Assert.assertEquals("banks",e.getValue());
 else     Assert.fail("Unexpected value " + e.getKey());
  }
  Assert.assertEquals(3,saw.size());
  Assert.assertTrue(saw.get("mary"));
  Assert.assertTrue(saw.get("bert"));
  Assert.assertTrue(saw.get(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.xml.TestReusableStringReader </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test empty {@link ReusableStringReader} 
 */
@Test public void testEmpty() throws IOException {
  Reader reader=new ReusableStringReader();
  try {
    int ch=reader.read();
    fail("IOException expected.");
  }
 catch (  IOException ioe) {
  }
  try {
    boolean ready=reader.ready();
    fail("IOException expected.");
  }
 catch (  IOException ioe) {
  }
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroObjectInspectorGenerator </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void failOnNonRecords() throws Exception {
  String nonRecordSchema="{ \"type\": \"enum\",\n" + "  \"name\": \"Suit\",\n" + "  \"symbols\" : [\"SPADES\", \"HEARTS\", \"DIAMONDS\", \"CLUBS\"]\n"+ "}";
  Schema s=AvroSerdeUtils.getSchemaFor(nonRecordSchema);
  try {
    new AvroObjectInspectorGenerator(s);
    fail("Should not be able to handle non-record Avro types");
  }
 catch (  SerDeException sde) {
    assertTrue(sde.getMessage().startsWith("Schema for table must be of type RECORD"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroSerdeUtils </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void detemineSchemaTriesToOpenUrl() throws AvroSerdeException, IOException {
  Configuration conf=new Configuration();
  Properties props=new Properties();
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),"not:///a.real.url");
  try {
    AvroSerdeUtils.determineSchemaOrThrowException(conf,props);
    fail("Should have tried to open that URL");
  }
 catch (  AvroSerdeException e) {
    assertEquals("Unable to read schema from given path: not:///a.real.url",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noneOptionWorksForSpecifyingSchemas() throws IOException, AvroSerdeException {
  Configuration conf=new Configuration();
  Properties props=new Properties();
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),SCHEMA_NONE);
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),SCHEMA_NONE);
  try {
    determineSchemaOrThrowException(conf,props);
    fail("Should have thrown exception with none set for both url and literal");
  }
 catch (  AvroSerdeException he) {
    assertEquals(EXCEPTION_MESSAGE,he.getMessage());
  }
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),TestAvroObjectInspectorGenerator.RECORD_SCHEMA);
  Schema s;
  try {
    s=determineSchemaOrThrowException(conf,props);
    assertNotNull(s);
    assertEquals(AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.RECORD_SCHEMA),s);
  }
 catch (  AvroSerdeException he) {
    fail("Should have parsed schema literal, not thrown exception.");
  }
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),SCHEMA_NONE);
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),"not:///a.real.url");
  try {
    determineSchemaOrThrowException(conf,props);
    fail("Should have tried to open that bogus URL");
  }
 catch (  AvroSerdeException e) {
    assertEquals("Unable to read schema from given path: not:///a.real.url",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeeLineWithArgs </h4><pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Attempt to execute a missing script file with the -f option to BeeLine
 */
@Test public void testNegativeScriptFile() throws Throwable {
  final String EXPECTED_PATTERN=" default ";
  File scriptFile=File.createTempFile("beelinenegative","temp");
  scriptFile.delete();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("-f");
  argList.add(scriptFile.getAbsolutePath());
  try {
    String output=testCommandLineScript(argList,null);
    if (output.contains(EXPECTED_PATTERN)) {
      fail("Output: " + output + " Negative pattern: "+ EXPECTED_PATTERN);
    }
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClient </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicDDLCommands() throws Exception {
  String db="testdb";
  String tableOne="testTable1";
  String tableTwo="testTable2";
  String tableThree="testTable3";
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  client.dropDatabase(db,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(db).ifNotExists(false).build();
  client.createDatabase(dbDesc);
  List<String> dbNames=client.listDatabaseNamesByPattern("*");
  assertTrue(dbNames.contains("default"));
  assertTrue(dbNames.contains(db));
  HCatDatabase testDb=client.getDatabase(db);
  assertTrue(testDb.getComment() == null);
  assertTrue(testDb.getProperties().size() == 0);
  String warehouseDir=System.getProperty("test.warehouse.dir","/user/hive/warehouse");
  if (useExternalMS) {
    assertTrue(testDb.getLocation().matches(".*" + "/" + db + ".db"));
  }
 else {
    String expectedDir=warehouseDir.replaceFirst("pfile:///","pfile:/");
    assertEquals(expectedDir + "/" + db+ ".db",testDb.getLocation());
  }
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id comment"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"value comment"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(db,tableOne,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  HCatTable table1=client.getTable(db,tableOne);
  assertTrue(table1.getInputFileFormat().equalsIgnoreCase(RCFileInputFormat.class.getName()));
  assertTrue(table1.getOutputFileFormat().equalsIgnoreCase(RCFileOutputFormat.class.getName()));
  assertTrue(table1.getSerdeLib().equalsIgnoreCase(LazyBinaryColumnarSerDe.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  try {
    client.createTable(tableDesc);
    fail("Expected exception");
  }
 catch (  HCatException e) {
    assertTrue(e.getMessage().contains("AlreadyExistsException while creating table."));
  }
  client.dropTable(db,tableOne,true);
  HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(db,tableTwo,cols).fieldsTerminatedBy('\001').escapeChar('\002').linesTerminatedBy('\003').mapKeysTerminatedBy('\004').collectionItemsTerminatedBy('\005').nullDefinedAs('\006').build();
  client.createTable(tableDesc2);
  HCatTable table2=client.getTable(db,tableTwo);
  assertTrue("Expected TextInputFormat, but got: " + table2.getInputFileFormat(),table2.getInputFileFormat().equalsIgnoreCase(TextInputFormat.class.getName()));
  assertTrue(table2.getOutputFileFormat().equalsIgnoreCase(HiveIgnoreKeyTextOutputFormat.class.getName()));
  assertTrue("SerdeParams not found",table2.getSerdeParams() != null);
  assertEquals("checking " + serdeConstants.FIELD_DELIM,Character.toString('\001'),table2.getSerdeParams().get(serdeConstants.FIELD_DELIM));
  assertEquals("checking " + serdeConstants.ESCAPE_CHAR,Character.toString('\002'),table2.getSerdeParams().get(serdeConstants.ESCAPE_CHAR));
  assertEquals("checking " + serdeConstants.LINE_DELIM,Character.toString('\003'),table2.getSerdeParams().get(serdeConstants.LINE_DELIM));
  assertEquals("checking " + serdeConstants.MAPKEY_DELIM,Character.toString('\004'),table2.getSerdeParams().get(serdeConstants.MAPKEY_DELIM));
  assertEquals("checking " + serdeConstants.COLLECTION_DELIM,Character.toString('\005'),table2.getSerdeParams().get(serdeConstants.COLLECTION_DELIM));
  assertEquals("checking " + serdeConstants.SERIALIZATION_NULL_FORMAT,Character.toString('\006'),table2.getSerdeParams().get(serdeConstants.SERIALIZATION_NULL_FORMAT));
  assertTrue(table2.getLocation().toLowerCase().matches(".*" + ("/" + db + ".db/"+ tableTwo).toLowerCase()));
  HCatCreateTableDesc tableDesc3=HCatCreateTableDesc.create(db,tableThree,cols).fileFormat("orcfile").build();
  client.createTable(tableDesc3);
  HCatTable table3=client.getTable(db,tableThree);
  assertTrue(table3.getInputFileFormat().equalsIgnoreCase(OrcInputFormat.class.getName()));
  assertTrue(table3.getOutputFileFormat().equalsIgnoreCase(OrcOutputFormat.class.getName()));
  assertTrue(table3.getSerdeLib().equalsIgnoreCase(OrcSerde.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClientNotification </h4><pre class="type-12 type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  long now=System.currentTimeMillis() / 1000;
  startTime=0;
  if (now > Integer.MAX_VALUE)   fail("Bummer, time has fallen over the edge");
 else   startTime=(int)now;
  firstEventId=hCatClient.getCurrentNotificationEventId();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.common.TestHiveClientCache </h4><pre class="type-3 type-4 type-5 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that a long table name actually breaks the HMSC. Subsequently check that isOpen() reflects
 * and tells if the client is broken
 */
@Ignore("hangs indefinitely") @Test public void testHMSCBreakability() throws IOException, MetaException, LoginException, TException, AlreadyExistsException, InvalidObjectException, NoSuchObjectException, InterruptedException {
  LocalMetaServer metaServer=new LocalMetaServer();
  metaServer.start();
  final HiveClientCache cache=new HiveClientCache(1000);
  HiveClientCache.CacheableHiveMetaStoreClient client=(HiveClientCache.CacheableHiveMetaStoreClient)cache.get(metaServer.getHiveConf());
  assertTrue(client.isOpen());
  final String DB_NAME="test_db";
  final String LONG_TABLE_NAME="long_table_name_" + new BigInteger(200,new Random()).toString(2);
  try {
    client.dropTable(DB_NAME,LONG_TABLE_NAME);
  }
 catch (  Exception e) {
  }
  try {
    client.dropDatabase(DB_NAME);
  }
 catch (  Exception e) {
  }
  client.createDatabase(new Database(DB_NAME,"",null,null));
  List<FieldSchema> fields=new ArrayList<FieldSchema>();
  fields.add(new FieldSchema("colname",serdeConstants.STRING_TYPE_NAME,""));
  Table tbl=new Table();
  tbl.setDbName(DB_NAME);
  tbl.setTableName(LONG_TABLE_NAME);
  StorageDescriptor sd=new StorageDescriptor();
  sd.setCols(fields);
  tbl.setSd(sd);
  sd.setSerdeInfo(new SerDeInfo());
  try {
    client.createTable(tbl);
    fail("Exception was expected while creating table with long name");
  }
 catch (  Exception e) {
  }
  assertFalse(client.isOpen());
  metaServer.shutDown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.listener.TestDbNotificationListener </h4><pre class="type-12 type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  long now=System.currentTimeMillis() / 1000;
  startTime=0;
  if (now > Integer.MAX_VALUE)   fail("Bummer, time has fallen over the edge");
 else   startTime=(int)now;
  firstEventId=msClient.getCurrentNotificationEventId().getEventId();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestDelimitedInputWriter </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFieldReordering() throws Exception {
  ArrayList<String> colNames=Lists.newArrayList(new String[]{"col1","col2","col3","col4","col5"});
{
    String[] fieldNames={null,"col2",null,"col4",null};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{-1,1,-1,3,-1}));
  }
{
    String[] fieldNames={"col5","col4","col3","col2","col1"};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{4,3,2,1,0}));
  }
{
    String[] fieldNames={"xyz","abc","col3","col4","as"};
    try {
      DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
      Assert.fail();
    }
 catch (    InvalidColumn e) {
    }
  }
{
    String[] fieldNames={"col3","col4"};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{2,3}));
  }
{
    String[] fieldNames={"col5","col4","col3","col2","col1","col1"};
    try {
      DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
      Assert.fail();
    }
 catch (    InvalidColumn e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.mutate.client.TestMutatorClient </h4><pre class="type-3 type-5 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaStoreFailsOnConnect() throws Exception {
  when(mockMetaStoreClient.getTable(anyString(),anyString())).thenThrow(new TException());
  try {
    client.connect();
    fail();
  }
 catch (  ConnectionException e) {
  }
  assertThat(client.isConnected(),is(false));
}

</code></pre>

<br>
<pre class="type-3 type-5 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckNonTransactionalTableConnect() throws Exception {
  when(mockParameters.get("transactional")).thenReturn(Boolean.FALSE.toString());
  try {
    client.connect();
    fail();
  }
 catch (  ConnectionException e) {
  }
  assertThat(client.isConnected(),is(false));
}

</code></pre>

<br>
<pre class="type-3 type-5 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckUnBucketedTableConnect() throws Exception {
  when(mockSd.getNumBuckets()).thenReturn(0);
  try {
    client.connect();
    fail();
  }
 catch (  ConnectionException e) {
  }
  assertThat(client.isConnected(),is(false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTempletonUtils </h4><pre class="type-11 type-6 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecodeArray(){
  Assert.assertTrue(TempletonUtils.encodeArray((String[])null) == null);
  String[] tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  String[] tmp2=TempletonUtils.decodeArray(TempletonUtils.encodeArray(tmp));
  try {
    for (int i=0; i < tmp.length; i++) {
      Assert.assertEquals((String)tmp[i],(String)tmp2[i]);
    }
  }
 catch (  Exception e) {
    Assert.fail("Arrays were not equal" + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstructingUserHomeDirectory() throws Exception {
  String[] sources=new String[]{"output+","/user/hadoop/output","hdfs://container","hdfs://container/","hdfs://container/path","output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  String[] expectedResults=new String[]{"/user/webhcat/output+","/user/hadoop/output","hdfs://container/user/webhcat","hdfs://container/","hdfs://container/path","/user/webhcat/output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  for (int i=0; i < sources.length; i++) {
    String source=sources[i];
    String expectedResult=expectedResults[i];
    String result=TempletonUtils.addUserHomeDirectoryIfApplicable(source,"webhcat");
    Assert.assertEquals(result,expectedResult);
  }
  String badUri="c:\\some\\path";
  try {
    TempletonUtils.addUserHomeDirectoryIfApplicable(badUri,"webhcat");
    Assert.fail("addUserHomeDirectoryIfApplicable should fail for bad URI: " + badUri);
  }
 catch (  URISyntaxException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsListAsString(){
  try {
    String tmpFileName1="/tmp/testHadoopFsListAsString1";
    String tmpFileName2="/tmp/testHadoopFsListAsString2";
    File tmpFile1=new File(tmpFileName1);
    File tmpFile2=new File(tmpFileName2);
    tmpFile1.createNewFile();
    tmpFile2.createNewFile();
    Assert.assertTrue(TempletonUtils.hadoopFsListAsString(null,null,null) == null);
    Assert.assertTrue(TempletonUtils.hadoopFsListAsString("/tmp,/usr",null,null) == null);
    Assert.assertEquals("file:" + tmpFileName1 + ",file:"+ tmpFileName2,TempletonUtils.hadoopFsListAsString(tmpFileName1 + "," + tmpFileName2,new Configuration(),null));
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsListAsString("/scoobydoo/teddybear,joe",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsFilename(){
  try {
    String tmpFileName1="/tmp/testHadoopFsListAsArray1";
    String tmpFileName2="/tmp/testHadoopFsListAsArray2";
    File tmpFile1=new File(tmpFileName1);
    File tmpFile2=new File(tmpFileName2);
    tmpFile1.createNewFile();
    tmpFile2.createNewFile();
    Assert.assertEquals(null,TempletonUtils.hadoopFsFilename(null,null,null));
    Assert.assertEquals(null,TempletonUtils.hadoopFsFilename(tmpFile.toURI().toString(),null,null));
    Assert.assertEquals(tmpFile.toURI().toString(),TempletonUtils.hadoopFsFilename(tmpFile.toURI().toString(),new Configuration(),null));
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for /tmp");
    Assert.fail("Couldn't find name for " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsFilename("/scoobydoo/teddybear",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsPath(){
  try {
    TempletonUtils.hadoopFsPath(null,null,null);
    TempletonUtils.hadoopFsPath(tmpFile.toURI().toString(),null,null);
    TempletonUtils.hadoopFsPath(tmpFile.toURI().toString(),new Configuration(),null);
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsPath("/scoobydoo/teddybear",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsPath("a",new Configuration(),"teddybear");
    Assert.fail("Should not have found /user/teddybear/a");
  }
 catch (  FileNotFoundException e) {
    Assert.assertTrue(e.getMessage().contains("/user/teddybear/a"));
  }
catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Get wrong exception: " + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsListAsArray(){
  try {
    String tmpFileName1="/tmp/testHadoopFsListAsArray1";
    String tmpFileName2="/tmp/testHadoopFsListAsArray2";
    File tmpFile1=new File(tmpFileName1);
    File tmpFile2=new File(tmpFileName2);
    tmpFile1.createNewFile();
    tmpFile2.createNewFile();
    Assert.assertTrue(TempletonUtils.hadoopFsListAsArray(null,null,null) == null);
    Assert.assertTrue(TempletonUtils.hadoopFsListAsArray(tmpFileName1 + "," + tmpFileName2,null,null) == null);
    String[] tmp2=TempletonUtils.hadoopFsListAsArray(tmpFileName1 + "," + tmpFileName2,new Configuration(),null);
    Assert.assertEquals("file:" + tmpFileName1,tmp2[0]);
    Assert.assertEquals("file:" + tmpFileName2,tmp2[1]);
    tmpFile1.delete();
    tmpFile2.delete();
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsListAsArray("/scoobydoo/teddybear,joe",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup(){
  try {
    tmpFile=new File(testDataDir,"tmp");
    tmpFile.createNewFile();
    usrFile=new File(testDataDir,"usr");
    usrFile.createNewFile();
  }
 catch (  IOException ex) {
    Assert.fail(ex.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTrivialExecService </h4><pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  ArrayList<String> list=new ArrayList<String>();
  list.add("echo");
  list.add("success");
  BufferedReader out=null;
  BufferedReader err=null;
  try {
    Process process=TrivialExecService.getInstance().run(list,new ArrayList<String>(),new HashMap<String,String>());
    out=new BufferedReader(new InputStreamReader(process.getInputStream()));
    err=new BufferedReader(new InputStreamReader(process.getErrorStream()));
    Assert.assertEquals("success",out.readLine());
    out.close();
    String line;
    while ((line=err.readLine()) != null) {
      Assert.fail(line);
    }
    process.waitFor();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Process caused exception.");
  }
 finally {
    try {
      out.close();
    }
 catch (    Exception ex) {
    }
    try {
      err.close();
    }
 catch (    Exception ex) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcDriver2 </h4><pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<br>
<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the cancellation of a query that is running.
 * We spawn 2 threads - one running the query and
 * the other attempting to cancel.
 * We're using a dummy udf to simulate a query,
 * that runs for a sufficiently long time.
 * @throws Exception
 */
@Test public void testQueryCancel() throws Exception {
  String udfName=SleepUDF.class.getName();
  Statement stmt1=con.createStatement();
  stmt1.execute("create temporary function sleepUDF as '" + udfName + "'");
  stmt1.close();
  final Statement stmt=con.createStatement();
  Thread tExecute=new Thread(new Runnable(){
    @Override public void run(){
      try {
        System.out.println("Executing query: ");
        stmt.executeQuery("select sleepUDF(t1.under_col) as u0, t1.under_col as u1, " + "t2.under_col as u2 from " + tableName + "t1 join "+ tableName+ " t2 on t1.under_col = t2.under_col");
        fail("Expecting SQLException");
      }
 catch (      SQLException e) {
        assertNotNull(e);
        System.out.println(e.toString());
      }
    }
  }
);
  Thread tCancel=new Thread(new Runnable(){
    @Override public void run(){
      try {
        Thread.sleep(1000);
        System.out.println("Cancelling query: ");
        stmt.cancel();
      }
 catch (      Exception e) {
      }
    }
  }
);
  tExecute.start();
  tCancel.start();
  tExecute.join();
  tCancel.join();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset methods
 * @throws Exception
 */
@Test public void testFetchFirstError() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  try {
    res.beforeFirst();
    fail("beforeFirst() should fail for normal resultset");
  }
 catch (  SQLException e) {
    assertEquals("Method not supported for TYPE_FORWARD_ONLY resultset",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorDiag() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("select from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
  try {
    stmt.executeQuery("select * from nonTable");
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42S02",e.getSQLState());
  }
  try {
    stmt.executeQuery("select zzzz from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecuteQueryException() throws Exception {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("create table test_t2 (under_col int, value string)");
    fail("Expecting SQLException");
  }
 catch (  SQLException e) {
    System.out.println("Caught an expected SQLException: " + e.getMessage());
  }
 finally {
    stmt.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetColumnNameCaseInsensitive() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res;
  res=stmt.executeQuery("select c1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
  res=stmt.executeQuery("select c1 C1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset attributes
 * @throws Exception
 */
@Test public void testUnsupportedFetchTypes() throws Exception {
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_READ_ONLY);
    fail("createStatement with TYPE_SCROLL_SENSITIVE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
    fail("createStatement with CONCUR_UPDATABLE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniHS2 </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentStatements() throws Exception {
  String tableName="testConcurrentStatements";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("DROP TABLE IF EXISTS " + tableName);
  stmt.execute("CREATE TABLE " + tableName + " (under_col INT COMMENT 'the under column', value STRING) COMMENT ' test table'");
  stmt.execute("load data local inpath '" + kvDataFilePath.toString() + "' into table "+ tableName);
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  assertTrue(res.next());
  res.close();
  stmt.close();
  int POOL_SIZE=100;
  int TASK_COUNT=300;
  SynchronousQueue<Runnable> executorQueue=new SynchronousQueue<Runnable>();
  ExecutorService workers=new ThreadPoolExecutor(1,POOL_SIZE,20,TimeUnit.SECONDS,executorQueue);
  List<Future<Boolean>> list=new ArrayList<Future<Boolean>>();
  int i=0;
  while (i < TASK_COUNT) {
    try {
      Future<Boolean> future=workers.submit(new JDBCTask(hs2Conn,i,tableName));
      list.add(future);
      i++;
    }
 catch (    RejectedExecutionException ree) {
      try {
        TimeUnit.MILLISECONDS.sleep(100);
      }
 catch (      InterruptedException e) {
        Thread.currentThread().interrupt();
      }
    }
  }
  for (  Future<Boolean> future : list) {
    try {
      Boolean result=future.get(30,TimeUnit.SECONDS);
      assertTrue(result);
    }
 catch (    ExecutionException ee) {
      fail("Concurrent Statement failed: " + ee.getCause());
    }
catch (    TimeoutException te) {
      System.out.println("Task was timeout after 30 second: " + te);
    }
catch (    CancellationException ce) {
      System.out.println("Task was interrupted: " + ce);
    }
catch (    InterruptedException ie) {
      System.out.println("Thread was interrupted: " + ie);
    }
  }
  workers.shutdown();
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for http header size
 * @throws Exception
 */
@Test public void testHttpHeaderSize() throws Exception {
  if (miniHS2.isStarted()) {
    miniHS2.stop();
  }
  HiveConf conf=new HiveConf();
  conf.set("hive.server2.transport.mode","http");
  conf.setInt("hive.server2.thrift.http.request.header.size",1024);
  conf.setInt("hive.server2.thrift.http.response.header.size",1024);
  miniHS2=new MiniHS2(conf);
  Map<String,String> confOverlay=new HashMap<String,String>();
  miniHS2.start(confOverlay);
  String userName=StringUtils.leftPad("*",100);
  try {
    hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  }
 catch (  Exception e) {
    fail("Not expecting exception: " + e);
  }
  userName=StringUtils.leftPad("*",2000);
  try {
    hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  }
 catch (  Exception e) {
    assertTrue("Header exception thrown",e != null);
    assertTrue(e.getMessage().contains("HTTP Response code: 413"));
  }
  if (miniHS2.isStarted()) {
    miniHS2.stop();
  }
  conf.setInt("hive.server2.thrift.http.request.header.size",3000);
  conf.setInt("hive.server2.thrift.http.response.header.size",3000);
  miniHS2=new MiniHS2(conf);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  }
 catch (  Exception e) {
    fail("Not expecting exception: " + e);
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test UDF blacklist overrides whitelist
 * @throws Exception
 */
@Test public void testUdfBlackListOverride() throws Exception {
  HiveConf testConf=new HiveConf();
  Set<String> funcNames=FunctionRegistry.getFunctionNames();
  String funcNameStr="";
  for (  String funcName : funcNames) {
    funcNameStr+="," + funcName;
  }
  funcNameStr=funcNameStr.substring(1);
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_WHITELIST,funcNameStr);
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_BLACKLIST,"reflect");
  miniHS2=new MiniHS2(testConf);
  miniHS2.start(new HashMap<String,String>());
  hs2Conn=getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
  Statement stmt=hs2Conn.createStatement();
  try {
    stmt.executeQuery("SELECT reflect('java.lang.String', 'valueOf', 1) ");
    fail("reflect() udf invocation should fail");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test UDF blacklist
 * - verify default value
 * - verify udfs allowed with default blacklist
 * - verify udf disallowed when in blacklist
 * @throws Exception
 */
@Test public void testUdfBlackList() throws Exception {
  HiveConf testConf=new HiveConf();
  assertTrue(testConf.getVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_BLACKLIST).isEmpty());
  Statement stmt=hs2Conn.createStatement();
  stmt.executeQuery("SELECT substr('foobar', 4) ");
  miniHS2.stop();
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_BLACKLIST,"reflect");
  miniHS2=new MiniHS2(testConf);
  miniHS2.start(new HashMap<String,String>());
  hs2Conn=getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  try {
    stmt.executeQuery("SELECT reflect('java.lang.String', 'valueOf', 1) ");
    fail("reflect() udf invocation should fail");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test UDF whitelist
 * - verify default value
 * - verify udf allowed with default whitelist
 * - verify udf allowed with specific whitelist
 * - verify udf disallowed when not in whitelist
 * @throws Exception
 */
@Test public void testUdfWhiteList() throws Exception {
  HiveConf testConf=new HiveConf();
  assertTrue(testConf.getVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_WHITELIST).isEmpty());
  Statement stmt=hs2Conn.createStatement();
  stmt.executeQuery("SELECT substr('foobar', 4) ");
  hs2Conn.close();
  miniHS2.stop();
  Set<String> funcNames=FunctionRegistry.getFunctionNames();
  funcNames.remove("reflect");
  String funcNameStr="";
  for (  String funcName : funcNames) {
    funcNameStr+="," + funcName;
  }
  funcNameStr=funcNameStr.substring(1);
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_WHITELIST,funcNameStr);
  miniHS2=new MiniHS2(testConf);
  miniHS2.start(new HashMap<String,String>());
  hs2Conn=getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  stmt.executeQuery("SELECT substr('foobar', 3) ");
  try {
    stmt.executeQuery("SELECT reflect('java.lang.String', 'valueOf', 1) ");
    fail("reflect() udf invocation should fail");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestSSL </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test non-SSL client with SSL server fails
 * @throws Exception
 */
@Test public void testConnectionMismatch() throws Exception {
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=false",System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  miniHS2.stop();
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",";ssl=false"),System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test SSL client with non-SSL server fails
 * @throws Exception
 */
@Test public void testInvalidConfig() throws Exception {
  clearSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  DriverManager.setLoginTimeout(4);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
    fail("SSL connection should fail with NON-SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  System.setProperty(JAVA_TRUST_STORE_PROP,dataFileDir + File.separator + TRUST_STORE_NAME);
  System.setProperty(JAVA_TRUST_STORE_PASS_PROP,KEY_STORE_PASSWORD);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true",System.getProperty("user.name"),"bar");
    fail("SSL connection should fail with NON-SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  miniHS2.stop();
  System.clearProperty(JAVA_TRUST_STORE_PROP);
  System.clearProperty(JAVA_TRUST_STORE_PASS_PROP);
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
    fail("SSL connection should fail with NON-SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests to ensure SSLv2 and SSLv3 are disabled
 */
@Test public void testSSLVersion() throws Exception {
  Assume.assumeTrue(execCommand("which openssl") == 0);
  Assume.assumeTrue(System.getProperty("os.name").toLowerCase().contains("linux"));
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD,System.getProperty("user.name"),"bar");
  hs2Conn.close();
  Assert.assertEquals("Expected exit code of 1",1,execCommand("openssl s_client -connect " + miniHS2.getHost() + ":"+ miniHS2.getBinaryPort()+ " -ssl2 < /dev/null"));
  Assert.assertEquals("Expected exit code of 1",1,execCommand("openssl s_client -connect " + miniHS2.getHost() + ":"+ miniHS2.getBinaryPort()+ " -ssl3 < /dev/null"));
  miniHS2.stop();
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD,System.getProperty("user.name"),"bar");
    Assert.fail("Expected SQLException during connect");
  }
 catch (  SQLException e) {
    LOG.info("Expected exception: " + e,e);
    Assert.assertEquals("08S01",e.getSQLState().trim());
    Throwable cause=e.getCause();
    Assert.assertNotNull(cause);
    while (cause.getCause() != null) {
      cause=cause.getCause();
    }
    Assert.assertEquals("org.apache.http.NoHttpResponseException",cause.getClass().getName());
    Assert.assertTrue(cause.getMessage().contains("failed to respond"));
  }
  miniHS2.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestJdbcMetadataApiAuth </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Call the HS2 metadata api's with authorizer disallowing those calls
 * @throws Exception
 */
@Test public void testMetaApiDisAllowed() throws Exception {
  TestAuthValidator.allowActions=false;
  Connection hs2Conn=getConnection("user1");
  DatabaseMetaData dbmetadata=hs2Conn.getMetaData();
  try {
    dbmetadata.getCatalogs();
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
  try {
    dbmetadata.getSchemas();
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
  try {
    dbmetadata.getTypeInfo();
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
  try {
    dbmetadata.getTables(null,"default","t%",null);
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
  try {
    dbmetadata.getTableTypes();
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
  try {
    dbmetadata.getColumns(null,"default","nosuchtable",null);
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
  try {
    dbmetadata.getFunctions(null,null,"trim");
    fail("HiveAccessControlException expected");
  }
 catch (  SQLException e) {
    assertErrorContains(e,TestAuthValidator.DENIED_ERR);
  }
catch (  Exception e) {
    fail("HiveAccessControlException expected");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthorization </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorization1() throws Exception {
  String tableName1="test_jdbc_sql_auth1";
  String tableName2="test_jdbc_sql_auth2";
{
    Connection hs2Conn=getConnection("user1");
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("create table " + tableName1 + "(i int) ");
    stmt.execute("create table " + tableName2 + "(i int) ");
    stmt.close();
    hs2Conn.close();
  }
{
    Connection hs2Conn=getConnection("user1");
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("drop table " + tableName1);
  }
{
    Connection hs2Conn=getConnection("user2");
    try {
      hs2Conn.getMetaData().getColumns(null,"default",tableName2,null);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("SELECT"));
    }
  }
{
    Connection hs2Conn=getConnection("user2");
    try {
      Statement stmt=hs2Conn.createStatement();
      stmt.execute("drop table " + tableName2);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("OBJECT OWNERSHIP"));
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigWhiteList() throws Exception {
  Connection hs2Conn=getConnection("user1");
  Statement stmt=hs2Conn.createStatement();
  try {
    stmt.execute("set hive.metastore.uris=x");
    fail("exception expected");
  }
 catch (  SQLException e) {
    String msg="Cannot modify hive.metastore.uris at runtime. " + "It is not in list of params that are allowed to be modified at runtime";
    assertTrue(e.getMessage().contains(msg));
  }
  stmt.execute("set hive.exec.reducers.bytes.per.reducer=10000");
  stmt.close();
  hs2Conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.cbo_rp_TestJdbcDriver2 </h4><pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-10 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  con=getConnection("default");
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("set hive.cbo.returnpath.hiveop = true");
  try {
    stmt.execute("drop table " + tableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + tableName + " (under_col int comment 'the under column', value string) comment '"+ tableComment+ "'");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tableName);
  try {
    stmt.execute("drop table " + partitionedTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + partitionedTableName + " (under_col int, value string) comment '"+ partitionedTableComment+ "' partitioned by ("+ partitionedColumnName+ " STRING)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ partitionedTableName+ " PARTITION ("+ partitionedColumnName+ "="+ partitionedColumnValue+ ")");
  try {
    stmt.execute("drop table " + dataTypeTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + dataTypeTableName + " (c1 int, c2 boolean, c3 double, c4 string,"+ " c5 array<int>, c6 map<int,string>, c7 map<string,string>,"+ " c8 struct<r:string,s:int,t:double>,"+ " c9 tinyint, c10 smallint, c11 float, c12 bigint,"+ " c13 array<array<string>>,"+ " c14 map<int, map<int,int>>,"+ " c15 struct<r:int,s:struct<a:int,b:string>>,"+ " c16 array<struct<m:map<string,string>,n:int>>,"+ " c17 timestamp, "+ " c18 decimal(16,7), "+ " c19 binary, "+ " c20 date,"+ " c21 varchar(20),"+ " c22 char(15),"+ " c23 binary"+ ") comment'"+ dataTypeTableComment+ "' partitioned by (dt STRING)");
  stmt.execute("load data local inpath '" + dataTypeDataFilePath.toString() + "' into table "+ dataTypeTableName+ " PARTITION (dt='20090619')");
  try {
    stmt.execute("drop view " + viewName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create view " + viewName + " comment '"+ viewComment+ "' as select * from "+ tableName);
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetColumnNameCaseInsensitive() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res;
  res=stmt.executeQuery("select c1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
  res=stmt.executeQuery("select c1 C1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset methods
 * @throws Exception
 */
@Test public void testFetchFirstError() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  try {
    res.beforeFirst();
    fail("beforeFirst() should fail for normal resultset");
  }
 catch (  SQLException e) {
    assertEquals("Method not supported for TYPE_FORWARD_ONLY resultset",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the cancellation of a query that is running.
 * We spawn 2 threads - one running the query and
 * the other attempting to cancel.
 * We're using a dummy udf to simulate a query,
 * that runs for a sufficiently long time.
 * @throws Exception
 */
@Test public void testQueryCancel() throws Exception {
  String udfName=SleepUDF.class.getName();
  Statement stmt1=con.createStatement();
  stmt1.execute("create temporary function sleepUDF as '" + udfName + "'");
  stmt1.close();
  final Statement stmt=con.createStatement();
  Thread tExecute=new Thread(new Runnable(){
    @Override public void run(){
      try {
        System.out.println("Executing query: ");
        stmt.executeQuery("select sleepUDF(t1.under_col) as u0, t1.under_col as u1, " + "t2.under_col as u2 from " + tableName + "t1 join "+ tableName+ " t2 on t1.under_col = t2.under_col");
        fail("Expecting SQLException");
      }
 catch (      SQLException e) {
        assertNotNull(e);
        System.out.println(e.toString());
      }
    }
  }
);
  Thread tCancel=new Thread(new Runnable(){
    @Override public void run(){
      try {
        Thread.sleep(1000);
        System.out.println("Cancelling query: ");
        stmt.cancel();
      }
 catch (      Exception e) {
      }
    }
  }
);
  tExecute.start();
  tCancel.start();
  tExecute.join();
  tCancel.join();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorDiag() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("select from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
  try {
    stmt.executeQuery("select * from nonTable");
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42S02",e.getSQLState());
  }
  try {
    stmt.executeQuery("select zzzz from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset attributes
 * @throws Exception
 */
@Test public void testUnsupportedFetchTypes() throws Exception {
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_READ_ONLY);
    fail("createStatement with TYPE_SCROLL_SENSITIVE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
    fail("createStatement with CONCUR_UPDATABLE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecuteQueryException() throws Exception {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("create table test_t2 (under_col int, value string)");
    fail("Expecting SQLException");
  }
 catch (  SQLException e) {
    System.out.println("Caught an expected SQLException: " + e.getMessage());
  }
 finally {
    stmt.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.miniHS2.TestHiveServer2SessionTimeout </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnection() throws Exception {
  CLIServiceClient serviceClient=miniHS2.getServiceClient();
  SessionHandle sessHandle=serviceClient.openSession("foo","bar");
  OperationHandle handle=serviceClient.executeStatement(sessHandle,"SELECT 1",confOverlay);
  Thread.sleep(7000);
  try {
    serviceClient.closeOperation(handle);
    fail("Operation should have been closed by timeout!");
  }
 catch (  HiveSQLException e) {
    assertTrue(StringUtils.stringifyException(e),e.getMessage().contains("Invalid OperationHandle"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.JdbcWithMiniKdcSQLAuthTest </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorization1() throws Exception {
  String tableName1="test_jdbc_sql_auth1";
  String tableName2="test_jdbc_sql_auth2";
{
    Connection hs2Conn=getConnection(MiniHiveKdc.HIVE_TEST_USER_1);
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("create table " + tableName1 + "(i int) ");
    stmt.execute("create table " + tableName2 + "(i int) ");
    stmt.execute("grant select on table " + tableName2 + " to user "+ MiniHiveKdc.HIVE_TEST_USER_2);
    stmt.close();
    hs2Conn.close();
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_1));
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("drop table " + tableName1);
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_2));
    try {
      Statement stmt=hs2Conn.createStatement();
      stmt.execute("drop table " + tableName2);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("OBJECT OWNERSHIP"));
    }
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_2));
    Statement stmt=hs2Conn.createStatement();
    stmt.execute(" desc " + tableName2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.TestJdbcWithMiniKdc </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative test, verify that connection to secure HS2 fails when
 * required connection attributes are not provided
 * @throws Exception
 */
@Test public void testConnectionNeg() throws Exception {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_USER_1);
  try {
    String url=miniHS2.getJdbcURL().replaceAll(";principal.*","");
    hs2Conn=DriverManager.getConnection(url);
    fail("NON kerberos connection should fail");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test connection using the proxy user connection property.
 * Verify proxy connection fails when super user doesn't have privilege to
 * impersonate the given user
 * @throws Exception
 */
@Test public void testNegativeProxyAuth() throws Exception {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_SUPER_USER);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",";hive.server2.proxy.user=" + MiniHiveKdc.HIVE_TEST_USER_2));
    verifyProperty(SESSION_USER_NAME,MiniHiveKdc.HIVE_TEST_USER_2);
    fail(MiniHiveKdc.HIVE_TEST_SUPER_USER + " shouldn't be allowed proxy connection for " + MiniHiveKdc.HIVE_TEST_USER_2);
  }
 catch (  SQLException e) {
    e.printStackTrace();
    assertTrue(e.getMessage().contains("Failed to validate proxy privilege"));
    assertTrue(e.getCause().getCause().getMessage().contains("is not allowed to impersonate"));
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative test for token based authentication
 * Verify that a user can't retrieve a token for user that
 * it's not allowed to impersonate
 * @throws Exception
 */
@Test public void testNegativeTokenAuth() throws Exception {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_SUPER_USER);
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL());
  try {
    String token=((HiveConnection)hs2Conn).getDelegationToken(MiniHiveKdc.HIVE_TEST_USER_2,MiniHiveKdc.HIVE_SERVICE_PRINCIPAL);
    fail(MiniHiveKdc.HIVE_TEST_SUPER_USER + " shouldn't be allowed to retrieve token for " + MiniHiveKdc.HIVE_TEST_USER_2);
  }
 catch (  SQLException e) {
    assertTrue(e.getMessage().contains("Error retrieving delegation token for user"));
    assertTrue(e.getCause().getCause().getMessage().contains("is not allowed to impersonate"));
  }
 finally {
    hs2Conn.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.TestHS2ImpersonationWithRemoteMS </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImpersonation() throws Exception {
  assertTrue("Test setup failed. MiniHS2 is not initialized",miniHS2 != null && miniHS2.isStarted());
  Class.forName(MiniHS2.getJdbcDriverName());
  Connection hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"foo",null);
  Statement stmt=hs2Conn.createStatement();
  String tableName="foo_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"bar",null);
  stmt=hs2Conn.createStatement();
  tableName="bar_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  MiniDFSShim dfs=miniHS2.getDfs();
  FileSystem fs=dfs.getFileSystem();
  FileStatus[] files=fs.listStatus(miniHS2.getWareHouseDir());
  boolean fooTableValidated=false;
  boolean barTableValidated=false;
  for (  FileStatus file : files) {
    final String name=file.getPath().getName();
    final String owner=file.getOwner();
    if (name.equals("foo_table")) {
      fooTableValidated=owner.equals("foo");
      assertTrue(String.format("User 'foo' table has wrong ownership '%s'",owner),fooTableValidated);
    }
 else     if (name.equals("bar_table")) {
      barTableValidated=owner.equals("bar");
      assertTrue(String.format("User 'bar' table has wrong ownership '%s'",owner),barTableValidated);
    }
 else {
      fail(String.format("Unexpected table directory '%s' in warehouse",name));
    }
    System.out.println(String.format("File: %s, Owner: %s",name,owner));
  }
  assertTrue("User 'foo' table not found in warehouse",fooTableValidated);
  assertTrue("User 'bar' table not found in warehouse",barTableValidated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.auth.TestCustomAuthentication </h4><pre class="type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomAuthentication() throws Exception {
  String url="jdbc:hive2://localhost:10000/default";
  Class.forName("org.apache.hive.jdbc.HiveDriver");
  try {
    DriverManager.getConnection(url,"wronguser","pwd");
    Assert.fail("Expected Exception");
  }
 catch (  SQLException e) {
    Assert.assertNotNull(e.getMessage());
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("Peer indicated failure: Error validating the login"));
  }
  Connection connection=DriverManager.getConnection(url,"hiveuser","hive");
  connection.close();
  System.out.println(">>> PASSED testCustomAuthentication");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceRestoreTest </h4><pre class="type-3 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestore() throws HiveSQLException {
  SessionHandle session=service.openSession("foo","bar",null);
  service.stop();
  service=getService();
  try {
    service.getSessionManager().getSession(session);
    Assert.fail("session already exists before restore");
  }
 catch (  HiveSQLException e) {
    Assert.assertTrue(e.getMessage().contains("Invalid SessionHandle"));
  }
  service.createSessionWithSessionHandle(session,"foo","bar",null);
  Assert.assertNotNull(service.getSessionManager().getSession(session));
  service.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceTest </h4><pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test per statement configuration overlay.
 * Create a table using hiveconf: var substitution, with the conf var passed
 * via confOverlay.Verify the confOverlay works for the query and does set the
 * value in the session configuration
 * @throws Exception
 */
@Test public void testConfOverlay() throws Exception {
  SessionHandle sessionHandle=client.openSession("tom","password",new HashMap<String,String>());
  assertNotNull(sessionHandle);
  String tabName="TEST_CONF_EXEC";
  String tabNameVar="tabNameVar";
  String setLockMgr="SET " + HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname + " = false";
  OperationHandle opHandle=client.executeStatement(sessionHandle,setLockMgr,null);
  client.closeOperation(opHandle);
  String dropTable="DROP TABLE IF EXISTS " + tabName;
  opHandle=client.executeStatement(sessionHandle,dropTable,null);
  client.closeOperation(opHandle);
  Map<String,String> confOverlay=new HashMap<String,String>();
  confOverlay.put(tabNameVar,tabName);
  String createTab="CREATE TABLE ${hiveconf:" + tabNameVar + "} (id int)";
  opHandle=client.executeStatement(sessionHandle,createTab,confOverlay);
  assertNotNull(opHandle);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  String selectTab="SELECT * FROM " + tabName;
  opHandle=client.executeStatement(sessionHandle,selectTab,null);
  assertNotNull(opHandle);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  selectTab="SELECT * FROM ${hiveconf:" + tabNameVar + "}";
  try {
    opHandle=client.executeStatement(sessionHandle,selectTab,null);
    fail("Query should fail");
  }
 catch (  HiveSQLException e) {
  }
  dropTable="DROP TABLE IF EXISTS " + tabName;
  opHandle=client.executeStatement(sessionHandle,dropTable,null);
  client.closeOperation(opHandle);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.TestRetryingThriftCLIServiceClient </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetryBehaviour() throws Exception {
  HiveConf hiveConf=new HiveConf();
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_BIND_HOST,"localhost");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_PORT,15000);
  hiveConf.setBoolVar(HiveConf.ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_AUTHENTICATION,HiveAuthFactory.AuthTypes.NONE.toString());
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_TRANSPORT_MODE,"binary");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_CLIENT_RETRY_LIMIT,3);
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_CLIENT_CONNECTION_RETRY_LIMIT,3);
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_ASYNC_EXEC_THREADS,10);
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_ASYNC_EXEC_SHUTDOWN_TIMEOUT,"1s");
  final HiveServer2 server=new HiveServer2();
  server.init(hiveConf);
  server.start();
  Thread.sleep(5000);
  System.out.println("## HiveServer started");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_PORT,17000);
  try {
    CLIServiceClient cliServiceClient=RetryingThriftCLIServiceClientTest.newRetryingCLIServiceClient(hiveConf);
    fail("Expected to throw exception for invalid port");
  }
 catch (  HiveSQLException sqlExc) {
    assertTrue(sqlExc.getCause() instanceof TTransportException);
    assertTrue(sqlExc.getMessage().contains("3"));
  }
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_PORT,15000);
  CLIServiceClient cliServiceClient=RetryingThriftCLIServiceClientTest.newRetryingCLIServiceClient(hiveConf);
  System.out.println("## Created client");
  server.stop();
  Thread.sleep(5000);
  try {
    Map<String,String> confOverlay=new HashMap<String,String>();
    RetryingThriftCLIServiceClientTest.handlerInst.callCount=0;
    RetryingThriftCLIServiceClientTest.handlerInst.connectCount=0;
    SessionHandle session=cliServiceClient.openSession("anonymous","anonymous");
  }
 catch (  HiveSQLException exc) {
    exc.printStackTrace();
    assertTrue(exc.getCause() instanceof TException);
    assertEquals(1,RetryingThriftCLIServiceClientTest.handlerInst.callCount);
    assertEquals(3,RetryingThriftCLIServiceClientTest.handlerInst.connectCount);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.OperationLoggingAPITestBase </h4><pre class="type-12 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchResultsOfLogCleanup() throws Exception {
  SessionHandle sessionHandleCleanup=setupSession();
  OperationHandle operationHandle=client.executeStatement(sessionHandleCleanup,sql,null);
  RowSet rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  verifyFetchedLog(rowSetLog,expectedLogsVerbose);
  File sessionLogDir=new File(hiveConf.getVar(HiveConf.ConfVars.HIVE_SERVER2_LOGGING_OPERATION_LOG_LOCATION) + File.separator + sessionHandleCleanup.getHandleIdentifier());
  File operationLogFile=new File(sessionLogDir,operationHandle.getHandleIdentifier().toString());
  client.closeOperation(operationHandle);
  try {
    client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
    Assert.fail("Fetch should fail");
  }
 catch (  HiveSQLException e) {
    Assert.assertTrue(e.getMessage().contains("Invalid OperationHandle:"));
  }
  if (operationLogFile.exists()) {
    Assert.fail("Operation log file should be deleted.");
  }
  client.closeSession(sessionHandleCleanup);
  if (sessionLogDir.exists()) {
    Assert.fail("Session log dir should be deleted.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.session.TestHiveSessionImpl </h4><pre class="type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Verifying OperationManager.closeOperation(opHandle) is invoked when
 * get HiveSQLException during sync query
 * @throws HiveSQLException
 */
@Test public void testLeakOperationHandle() throws HiveSQLException {
  TProtocolVersion protocol=TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V2;
  String username="";
  String password="";
  HiveConf serverhiveConf=new HiveConf();
  String ipAddress=null;
  HiveSessionImpl session=new HiveSessionImpl(protocol,username,password,serverhiveConf,ipAddress){
    @Override protected synchronized void acquire(    boolean userAccess){
    }
    @Override protected synchronized void release(    boolean userAccess){
    }
  }
;
  OperationManager operationManager=Mockito.mock(OperationManager.class);
  session.setOperationManager(operationManager);
  ExecuteStatementOperation operation=Mockito.mock(ExecuteStatementOperation.class);
  OperationHandle opHandle=Mockito.mock(OperationHandle.class);
  Mockito.when(operation.getHandle()).thenReturn(opHandle);
  Map<String,String> confOverlay=new HashMap<String,String>();
  String hql="drop table if exists table_not_exists";
  Mockito.when(operationManager.newExecuteStatementOperation(session,hql,confOverlay,true)).thenReturn(operation);
  try {
    session.open(new HashMap<String,String>());
    session.executeStatementAsync(hql,confOverlay);
    Mockito.verify(operationManager,Mockito.times(0)).closeOperation(opHandle);
    Mockito.doThrow(new HiveSQLException("Fail for clean up test")).when(operation).run();
    session.executeStatementAsync(hql,confOverlay);
    Assert.fail("HiveSqlException expected.");
  }
 catch (  HiveSQLException e) {
    if (!"Fail for clean up test".equals(e.getMessage())) {
      Assert.fail("unexpected exception:" + e.getMessage());
    }
    Mockito.verify(operationManager,Mockito.times(1)).closeOperation(opHandle);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.TestSparkClient </h4><pre class="type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorJob() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle.Listener<String> listener=newListener();
      JobHandle<String> handle=client.submit(new ErrorJob());
      handle.addListener(listener);
      try {
        handle.get(TIMEOUT,TimeUnit.SECONDS);
        fail("Should have thrown an exception.");
      }
 catch (      ExecutionException ee) {
        assertTrue(ee.getCause() instanceof SparkException);
        assertTrue(ee.getCause().getMessage().contains("IllegalStateException: Hello"));
      }
      assertFalse(((JobHandleImpl<String>)handle).changeState(JobHandle.State.SENT));
      verify(listener).onJobQueued(handle);
      verify(listener).onJobStarted(handle);
      verify(listener).onJobFailed(same(handle),any(Throwable.class));
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.rpc.TestKryoMessageCodec </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMessageSize() throws Exception {
  KryoMessageCodec codec=new KryoMessageCodec(1024);
  ByteBuf buf=newBuffer();
  buf.writeInt(-1);
  try {
    List out=Lists.newArrayList();
    codec.decode(null,buf,out);
    fail("Should have failed to decode message with negative size.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("must be positive") > 0);
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxMessageSize() throws Exception {
  KryoMessageCodec codec=new KryoMessageCodec(1024);
  ByteBuf buf=newBuffer();
  codec.encode(null,new TestMessage(new byte[512]),buf);
  try {
    codec.encode(null,new TestMessage(new byte[1025]),buf);
    fail("Should have failed to encode large message.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("maximum allowed size") > 0);
  }
  KryoMessageCodec unlimited=new KryoMessageCodec(0);
  buf=newBuffer();
  unlimited.encode(null,new TestMessage(new byte[1025]),buf);
  try {
    List out=Lists.newArrayList();
    codec.decode(null,buf,out);
    fail("Should have failed to decode large message.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("maximum allowed size") > 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.rpc.TestRpc </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientTimeout() throws Exception {
  Map<String,String> conf=ImmutableMap.<String,String>builder().putAll(emptyConfig).build();
  RpcServer server=autoClose(new RpcServer(conf));
  String secret=server.createSecret();
  try {
    autoClose(server.registerClient("client",secret,new TestDispatcher(),1L).get());
    fail("Server should have timed out client.");
  }
 catch (  ExecutionException ee) {
    assertTrue(ee.getCause() instanceof TimeoutException);
  }
  NioEventLoopGroup eloop=new NioEventLoopGroup();
  Future<Rpc> clientRpcFuture=Rpc.createClient(conf,eloop,"localhost",server.getPort(),"client",secret,new TestDispatcher());
  try {
    autoClose(clientRpcFuture.get());
    fail("Client should have failed to connect to server.");
  }
 catch (  ExecutionException ee) {
    assertFalse(ee.getCause() instanceof TimeoutException);
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadHello() throws Exception {
  RpcServer server=autoClose(new RpcServer(emptyConfig));
  Future<Rpc> serverRpcFuture=server.registerClient("client","newClient",new TestDispatcher());
  NioEventLoopGroup eloop=new NioEventLoopGroup();
  Future<Rpc> clientRpcFuture=Rpc.createClient(emptyConfig,eloop,"localhost",server.getPort(),"client","wrongClient",new TestDispatcher());
  try {
    autoClose(clientRpcFuture.get(10,TimeUnit.SECONDS));
    fail("Should have failed to create client with wrong secret.");
  }
 catch (  ExecutionException ee) {
    assertTrue("Unexpected exception: " + ee.getCause(),ee.getCause() instanceof SaslException);
  }
  serverRpcFuture.cancel(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestInStream </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCorruptStream() throws Exception {
  OutputCollector collect=new OutputCollector();
  CompressionCodec codec=new ZlibCodec();
  OutStream out=new OutStream("test",500,codec,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    out.write(i);
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  InStream in=InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,100);
  byte[] contents=new byte[1024];
  try {
    in.read(contents);
    fail();
  }
 catch (  IllegalArgumentException iae) {
  }
  inBuf.clear();
  inBuf.put((byte)32);
  inBuf.put((byte)0);
  inBuf.flip();
  in=InStream.create("test2",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,300);
  try {
    in.read();
    fail();
  }
 catch (  IllegalStateException ise) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestSerializationUtils </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtractionOverflowGuava(){
  try {
    LongMath.checkedSubtract(22222222222L,Long.MIN_VALUE);
    fail("expected ArithmeticException for overflow");
  }
 catch (  ArithmeticException ex) {
    assertEquals(ex.getMessage(),"overflow");
  }
  try {
    LongMath.checkedSubtract(-22222222222L,Long.MAX_VALUE);
    fail("expected ArithmeticException for overflow");
  }
 catch (  ArithmeticException ex) {
    assertEquals(ex.getMessage(),"overflow");
  }
  try {
    LongMath.checkedSubtract(Long.MIN_VALUE,Long.MAX_VALUE);
    fail("expected ArithmeticException for overflow");
  }
 catch (  ArithmeticException ex) {
    assertEquals(ex.getMessage(),"overflow");
  }
  assertEquals(-8106206116692740190L,LongMath.checkedSubtract(-1553103058346370095L,6553103058346370095L));
  assertEquals(-Long.MAX_VALUE,LongMath.checkedSubtract(0,Long.MAX_VALUE));
  assertEquals(Long.MIN_VALUE,LongMath.checkedSubtract(Long.MIN_VALUE,0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestZlib </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCorrupt() throws Exception {
  ByteBuffer buf=ByteBuffer.allocate(1000);
  buf.put(new byte[]{127,-128,0,99,98,-1});
  buf.flip();
  CompressionCodec codec=new ZlibCodec();
  ByteBuffer out=ByteBuffer.allocate(1000);
  try {
    codec.decompress(buf,out);
    fail();
  }
 catch (  IOException ioe) {
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
