<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.columns.TestColumnMapper </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalMapping() throws TooManyAccumuloColumnsException {
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  List<String> columnNames=Arrays.asList("row","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(rawMappings.size(),mappings.size());
  Assert.assertEquals(mappings.size(),mapper.size());
  Iterator<String> rawIter=rawMappings.iterator();
  Iterator<ColumnMapping> iter=mappings.iterator();
  for (int i=0; i < mappings.size() && iter.hasNext(); i++) {
    String rawMapping=rawIter.next();
    ColumnMapping mapping=iter.next();
    ColumnMapping mappingByOffset=mapper.get(i);
    Assert.assertEquals(mapping,mappingByOffset);
    if (AccumuloHiveConstants.ROWID.equals(rawMapping)) {
      Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mapping.getClass());
    }
 else {
      Assert.assertEquals(HiveAccumuloColumnMapping.class,mapping.getClass());
    }
  }
  Assert.assertEquals(0,mapper.getRowIdOffset());
  Assert.assertTrue(mapper.hasRowIdMapping());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTableInputFormat </h4><pre class="type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNameEqualBrian() throws Exception {
  Connector con=mockInstance.getConnector(USER,new PasswordToken(PASS.getBytes()));
  Scanner scan=con.createScanner(TEST_TABLE,new Authorizations("blah"));
  IteratorSetting is=new IteratorSetting(1,PrimitiveComparisonFilter.FILTER_PREFIX + 1,PrimitiveComparisonFilter.class);
  is.addOption(PrimitiveComparisonFilter.P_COMPARE_CLASS,StringCompare.class.getName());
  is.addOption(PrimitiveComparisonFilter.COMPARE_OPT_CLASS,Equal.class.getName());
  is.addOption(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64("brian".getBytes())));
  is.addOption(PrimitiveComparisonFilter.COLUMN,"cf:name");
  scan.addScanIterator(is);
  boolean foundName=false;
  boolean foundSid=false;
  boolean foundDegrees=false;
  boolean foundMillis=false;
  for (  Map.Entry<Key,Value> kv : scan) {
    SortedMap<Key,Value> items=PrimitiveComparisonFilter.decodeRow(kv.getKey(),kv.getValue());
    for (    Map.Entry<Key,Value> item : items.entrySet()) {
      assertEquals(item.getKey().getRow().toString(),"r1");
      if (item.getKey().getColumnQualifier().equals(NAME)) {
        foundName=true;
        assertArrayEquals(item.getValue().get(),"brian".getBytes());
      }
 else       if (item.getKey().getColumnQualifier().equals(SID)) {
        foundSid=true;
        assertArrayEquals(item.getValue().get(),parseIntBytes("1"));
      }
 else       if (item.getKey().getColumnQualifier().equals(DEGREES)) {
        foundDegrees=true;
        assertArrayEquals(item.getValue().get(),parseDoubleBytes("44.5"));
      }
 else       if (item.getKey().getColumnQualifier().equals(MILLIS)) {
        foundMillis=true;
        assertArrayEquals(item.getValue().get(),parseLongBytes("555"));
      }
    }
  }
  assertTrue(foundDegrees & foundMillis & foundName& foundSid);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestAccumuloPredicateHandler </h4><pre class="type-12 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateIteratorSettings() throws Exception {
  conf=new JobConf();
  List<String> columnNames=Arrays.asList("field1","field2","rid");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  conf.set(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columnNames));
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,int,string");
  String columnMappingStr="cf:f1,cf:f2,:rowID";
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,columnMappingStr);
  columnMapper=new ColumnMapper(columnMappingStr,ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"field2",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,5);
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<IteratorSetting> iterators=handler.getIterators(conf,columnMapper);
  assertEquals(iterators.size(),2);
  IteratorSetting is1=iterators.get(0);
  IteratorSetting is2=iterators.get(1);
  boolean foundQual=false;
  boolean foundPCompare=false;
  boolean foundCOpt=false;
  boolean foundConst=false;
  for (  Map.Entry<String,String> option : is1.getOptions().entrySet()) {
    String optKey=option.getKey();
    if (optKey.equals(PrimitiveComparisonFilter.COLUMN)) {
      foundQual=true;
      assertEquals(option.getValue(),"cf:f1");
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.CONST_VAL)) {
      foundConst=true;
      assertEquals(option.getValue(),new String(Base64.encodeBase64("aaa".getBytes())));
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.COMPARE_OPT_CLASS)) {
      foundCOpt=true;
      assertEquals(option.getValue(),LessThanOrEqual.class.getName());
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.P_COMPARE_CLASS)) {
      foundPCompare=true;
      assertEquals(option.getValue(),StringCompare.class.getName());
    }
  }
  assertTrue(foundConst & foundCOpt & foundPCompare& foundQual);
  foundQual=false;
  foundPCompare=false;
  foundCOpt=false;
  foundConst=false;
  for (  Map.Entry<String,String> option : is2.getOptions().entrySet()) {
    String optKey=option.getKey();
    if (optKey.equals(PrimitiveComparisonFilter.COLUMN)) {
      foundQual=true;
      assertEquals(option.getValue(),"cf:f2");
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.CONST_VAL)) {
      foundConst=true;
      byte[] intVal=new byte[4];
      ByteBuffer.wrap(intVal).putInt(5);
      assertEquals(option.getValue(),new String(Base64.encodeBase64(intVal)));
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.COMPARE_OPT_CLASS)) {
      foundCOpt=true;
      assertEquals(option.getValue(),GreaterThan.class.getName());
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.P_COMPARE_CLASS)) {
      foundPCompare=true;
      assertEquals(option.getValue(),IntCompare.class.getName());
    }
  }
  assertTrue(foundConst & foundCOpt & foundPCompare& foundQual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.metrics.TestLegacyMetrics </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricsMBean() throws Exception {
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  final ObjectName oname=new ObjectName("org.apache.hadoop.hive.common.metrics:type=MetricsMBean");
  MBeanInfo mBeanInfo=mbs.getMBeanInfo(oname);
  assertEquals(MetricsMBeanImpl.class.getName(),mBeanInfo.getClassName());
  MBeanOperationInfo[] oops=mBeanInfo.getOperations();
  boolean resetFound=false;
  for (  MBeanOperationInfo op : oops) {
    if ("reset".equals(op.getName())) {
      resetFound=true;
      break;
    }
  }
  assertTrue(resetFound);
  Attribute attr=new Attribute("fooMetric",Long.valueOf(-77));
  mbs.setAttribute(oname,attr);
  mBeanInfo=mbs.getMBeanInfo(oname);
  MBeanAttributeInfo[] attrinuteInfos=mBeanInfo.getAttributes();
  assertEquals(1,attrinuteInfos.length);
  boolean attrFound=false;
  for (  MBeanAttributeInfo info : attrinuteInfos) {
    if ("fooMetric".equals(info.getName())) {
      assertEquals("java.lang.Long",info.getType());
      assertTrue(info.isReadable());
      assertTrue(info.isWritable());
      assertFalse(info.isIs());
      attrFound=true;
      break;
    }
  }
  assertTrue(attrFound);
  Object v=mbs.getAttribute(oname,"fooMetric");
  assertEquals(Long.valueOf(-77),v);
  Object result=mbs.invoke(oname,"reset",new Object[0],new String[0]);
  assertNull(result);
  v=mbs.getAttribute(oname,"fooMetric");
  assertEquals(Long.valueOf(0),v);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveVarchar </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testStringLength() throws Exception {
  int strLen=20;
  int[] lengths={15,20,25};
  for (int idx1=0; idx1 < lengths.length; ++idx1) {
    StringBuilder sb=new StringBuilder();
    int curLen=lengths[idx1];
    for (int idx2=0; idx2 < curLen; ++idx2) {
      sb.appendCodePoint(getRandomCodePoint(' '));
    }
    String testString=sb.toString();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  String[] testStrings={"abcdefg","abcdefghijklmnopqrst","abcdefghijklmnopqrstuvwxyz"};
  for (  String testString : testStrings) {
    int curLen=testString.length();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  HiveVarchar vc1=new HiveVarchar("0123456789",10);
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue("012345678901234");
  assertEquals(15,vc1.getCharacterLength());
  vc1.setValue("01234",-1);
  assertEquals(5,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("0123456789",-1));
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("01234",-1),-1);
  assertEquals(5,vc1.getCharacterLength());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestUnsignedInt128 </h4><pre class="type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiplyScaleDownTenDestructiveScaleTen(){
  for (int scale=0; scale < 38; ++scale) {
    UnsignedInt128 right=new UnsignedInt128(1);
    right.scaleUpTenDestructive((short)scale);
{
      UnsignedInt128 leftJust=new UnsignedInt128(1);
      leftJust.scaleUpTenDestructive((short)15);
      UnsignedInt128 leftInc=leftJust.incrementConstructive();
      UnsignedInt128 leftDec=leftJust.decrementConstructive();
      if (scale + 10 <= 38) {
        leftJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftJust.asLong());
        leftInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftInc.asLong());
        leftDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftDec.asLong());
      }
 else {
        leftJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftJust.asLong());
        leftInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftInc.asLong());
        leftDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftDec.asLong());
      }
    }
{
      UnsignedInt128 leftHalfJust=new UnsignedInt128(1);
      leftHalfJust.scaleUpTenDestructive((short)6);
      leftHalfJust.addDestructive(new UnsignedInt128(5));
      leftHalfJust.scaleUpTenDestructive((short)9);
      UnsignedInt128 leftHalfInc=leftHalfJust.incrementConstructive();
      UnsignedInt128 leftHalfDec=leftHalfJust.decrementConstructive();
      if (scale + 10 <= 38) {
        leftHalfJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100001L,leftHalfJust.asLong());
        leftHalfInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100001L,leftHalfInc.asLong());
        leftHalfDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,100000L,leftHalfDec.asLong());
      }
 else {
        leftHalfJust.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftHalfJust.asLong());
        leftHalfInc.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftHalfInc.asLong());
        leftHalfDec.multiplyScaleDownTenDestructive(right,(short)(scale + 10));
        assertEquals("scale=" + scale,0L,leftHalfDec.asLong());
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelCacheImpl </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testMTTWithCleanup(){
  final LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,1);
  final long fn1=1, fn2=2;
  final int offsetsToUse=8;
  final CountDownLatch cdlIn=new CountDownLatch(4), cdlOut=new CountDownLatch(1);
  final AtomicInteger rdmsDone=new AtomicInteger(0);
  Callable<Long> rdmCall=new Callable<Long>(){
    public Long call(){
      int gets=0, puts=0;
      try {
        Random rdm=new Random(1234 + Thread.currentThread().getId());
        syncThreadStart(cdlIn,cdlOut);
        for (int i=0; i < 20000; ++i) {
          boolean isGet=rdm.nextBoolean(), isFn1=rdm.nextBoolean();
          long fileName=isFn1 ? fn1 : fn2;
          int fileIndex=isFn1 ? 1 : 2;
          int count=rdm.nextInt(offsetsToUse);
          if (isGet) {
            int[] offsets=new int[count];
            count=generateOffsets(offsetsToUse,rdm,offsets);
            CreateHelper list=new CreateHelper();
            for (int j=0; i < count; ++i) {
              list.addOrMerge(offsets[j],offsets[j] + 1,true,false);
            }
            DiskRangeList iter=cache.getFileData(fileName,list.get(),0,testFactory,null,null);
            int j=-1;
            while (iter != null) {
              ++j;
              if (!(iter instanceof CacheChunk)) {
                iter=iter.next;
                continue;
              }
              ++gets;
              LlapDataBuffer result=(LlapDataBuffer)((CacheChunk)iter).getBuffer();
              assertEquals(makeFakeArenaIndex(fileIndex,offsets[j]),result.arenaIndex);
              cache.decRefBuffer(result);
              iter=iter.next;
            }
          }
 else {
            DiskRange[] ranges=new DiskRange[count];
            int[] offsets=new int[count];
            for (int j=0; j < count; ++j) {
              int next=rdm.nextInt(offsetsToUse);
              ranges[j]=dr(next,next + 1);
              offsets[j]=next;
            }
            MemoryBuffer[] buffers=new MemoryBuffer[count];
            for (int j=0; j < offsets.length; ++j) {
              LlapDataBuffer buf=LowLevelCacheImpl.allocateFake();
              buf.arenaIndex=makeFakeArenaIndex(fileIndex,offsets[j]);
              buffers[j]=buf;
            }
            long[] mask=cache.putFileData(fileName,ranges,buffers,0,Priority.NORMAL,null);
            puts+=buffers.length;
            long maskVal=0;
            if (mask != null) {
              assertEquals(1,mask.length);
              maskVal=mask[0];
            }
            for (int j=0; j < offsets.length; ++j) {
              LlapDataBuffer buf=(LlapDataBuffer)(buffers[j]);
              if ((maskVal & 1) == 1) {
                assertEquals(makeFakeArenaIndex(fileIndex,offsets[j]),buf.arenaIndex);
              }
              maskVal>>=1;
              cache.decRefBuffer(buf);
            }
          }
        }
      }
  finally {
        rdmsDone.incrementAndGet();
      }
      return (((long)gets) << 32) | puts;
    }
    private int makeFakeArenaIndex(    int fileIndex,    long offset){
      return (int)((fileIndex << 16) + offset);
    }
  }
;
  FutureTask<Integer> evictionTask=new FutureTask<Integer>(new Callable<Integer>(){
    public Integer call(){
      boolean isFirstFile=false;
      Random rdm=new Random(1234 + Thread.currentThread().getId());
      int evictions=0;
      syncThreadStart(cdlIn,cdlOut);
      while (rdmsDone.get() < 3) {
        DiskRangeList head=new DiskRangeList(0,offsetsToUse + 1);
        isFirstFile=!isFirstFile;
        long fileId=isFirstFile ? fn1 : fn2;
        head=cache.getFileData(fileId,head,0,testFactory,null,null);
        DiskRange[] results=head.listToArray();
        int startIndex=rdm.nextInt(results.length), index=startIndex;
        LlapDataBuffer victim=null;
        do {
          DiskRange r=results[index];
          if (r instanceof CacheChunk) {
            LlapDataBuffer result=(LlapDataBuffer)((CacheChunk)r).getBuffer();
            cache.decRefBuffer(result);
            if (victim == null && result.invalidate()) {
              ++evictions;
              victim=result;
            }
          }
          ++index;
          if (index == results.length)           index=0;
        }
 while (index != startIndex);
        if (victim == null)         continue;
        cache.notifyEvicted(victim);
      }
      return evictions;
    }
  }
);
  FutureTask<Long> rdmTask1=new FutureTask<Long>(rdmCall), rdmTask2=new FutureTask<Long>(rdmCall), rdmTask3=new FutureTask<Long>(rdmCall);
  Executor threadPool=Executors.newFixedThreadPool(4);
  threadPool.execute(rdmTask1);
  threadPool.execute(rdmTask2);
  threadPool.execute(rdmTask3);
  threadPool.execute(evictionTask);
  try {
    cdlIn.await();
    cdlOut.countDown();
    long result1=rdmTask1.get(), result2=rdmTask2.get(), result3=rdmTask3.get();
    int evictions=evictionTask.get();
    LOG.info("MTT test: task 1: " + descRdmTask(result1) + ", task 2: "+ descRdmTask(result2)+ ", task 3: "+ descRdmTask(result3)+ "; "+ evictions+ " evictions");
  }
 catch (  Throwable t) {
    throw new RuntimeException(t);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.daemon.impl.TestQueryIdentifier </h4><pre class="type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=5000) public void testEquality(){
  String appIdString1="app1";
  String appIdString2="app2";
  int dagId1=1;
  int dagId2=2;
  QueryIdentifier[] queryIdentifiers=new QueryIdentifier[4];
  queryIdentifiers[0]=new QueryIdentifier(appIdString1,dagId1);
  queryIdentifiers[1]=new QueryIdentifier(appIdString1,dagId2);
  queryIdentifiers[2]=new QueryIdentifier(appIdString2,dagId1);
  queryIdentifiers[3]=new QueryIdentifier(appIdString2,dagId2);
  for (int i=0; i < 4; i++) {
    for (int j=0; j < 4; j++) {
      if (i == j) {
        assertEquals(queryIdentifiers[i],queryIdentifiers[j]);
      }
 else {
        assertNotEquals(queryIdentifiers[i],queryIdentifiers[j]);
      }
    }
  }
  QueryIdentifier q11=new QueryIdentifier(appIdString1,dagId1);
  QueryIdentifier q12=new QueryIdentifier(appIdString1,dagId2);
  QueryIdentifier q21=new QueryIdentifier(appIdString2,dagId1);
  QueryIdentifier q22=new QueryIdentifier(appIdString2,dagId2);
  assertEquals(queryIdentifiers[0],q11);
  assertEquals(queryIdentifiers[1],q12);
  assertEquals(queryIdentifiers[2],q21);
  assertEquals(queryIdentifiers[3],q22);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestDeadline </h4><pre class="type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeadline() throws Exception {
  isFailed=false;
  errorMsg="";
  Thread threadTimeout=new Thread(createRunnable());
  threadTimeout.setDaemon(true);
  threadTimeout.start();
  threadTimeout.join(60000);
  if (isFailed) {
    Assert.fail(errorMsg);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringifyValidTxns() throws Exception {
  ValidTxnList validTxns=new ValidReadTxnList("1:");
  String asString=validTxns.toString();
  Assert.assertEquals("1:",asString);
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(1,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(0,validTxns.getInvalidTransactions().length);
  asString=validTxns.toString();
  Assert.assertEquals("1:",asString);
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(1,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(0,validTxns.getInvalidTransactions().length);
  validTxns=new ValidReadTxnList("10:5:3");
  asString=validTxns.toString();
  if (!asString.equals("10:3:5") && !asString.equals("10:5:3")) {
    Assert.fail("Unexpected string value " + asString);
  }
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(10,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(2,validTxns.getInvalidTransactions().length);
  boolean sawThree=false, sawFive=false;
  for (  long tid : validTxns.getInvalidTransactions()) {
    if (tid == 3)     sawThree=true;
 else     if (tid == 5)     sawFive=true;
 else     Assert.fail("Unexpected value " + tid);
  }
  Assert.assertTrue(sawThree);
  Assert.assertTrue(sawFive);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreIntegration </h4><pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listGlobalGrants() throws Exception {
  String[] roleNames=new String[]{"lgg_role1","lgg_role2"};
  String[] userNames=new String[]{"merry","pippen"};
  store.addRole(roleNames[0],"me");
  store.addRole(roleNames[1],"me");
  int now=(int)(System.currentTimeMillis() / 1000);
  Role role1=store.getRole(roleNames[0]);
  Role role2=store.getRole(roleNames[1]);
  store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
  List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
  HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.GLOBAL,null,null,null,null);
  PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
  HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
  privileges.add(hop);
  grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
  hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
  privileges.add(hop);
  PrivilegeBag pBag=new PrivilegeBag(privileges);
  store.grantPrivileges(pBag);
  List<HiveObjectPrivilege> hops=store.listPrincipalGlobalGrants(roleNames[0],PrincipalType.ROLE);
  Assert.assertEquals(1,hops.size());
  Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
  Assert.assertEquals(HiveObjectType.GLOBAL,hops.get(0).getHiveObject().getObjectType());
  Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
  hops=store.listPrincipalGlobalGrants(userNames[0],PrincipalType.USER);
  Assert.assertEquals(1,hops.size());
  Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
  Assert.assertEquals(HiveObjectType.GLOBAL,hops.get(0).getHiveObject().getObjectType());
  Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
  hops=store.listPrincipalGlobalGrants(roleNames[1],PrincipalType.ROLE);
  Assert.assertEquals(0,hops.size());
  hops=store.listPrincipalGlobalGrants(userNames[1],PrincipalType.USER);
  Assert.assertEquals(0,hops.size());
  hops=store.listGlobalGrantsAll();
  Assert.assertEquals(2,hops.size());
  boolean sawUser=false, sawRole=false;
  for (  HiveObjectPrivilege h : hops) {
    if (h.getPrincipalName().equals(userNames[0])) {
      Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
      Assert.assertEquals(HiveObjectType.GLOBAL,h.getHiveObject().getObjectType());
      Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
      sawUser=true;
    }
 else     if (h.getPrincipalName().equals(roleNames[0])) {
      Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
      Assert.assertEquals(HiveObjectType.GLOBAL,h.getHiveObject().getObjectType());
      Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
      sawRole=true;
    }
  }
  Assert.assertTrue(sawUser && sawRole);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listTableGrants() throws Exception {
  String dbName="ltg_db";
  String[] tableNames=new String[]{"ltg_t1","ltg_t2"};
  try {
    Database db=new Database(dbName,"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    int startTime=(int)(System.currentTimeMillis() / 1000);
    List<FieldSchema> cols=new ArrayList<FieldSchema>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    Table table=new Table(tableNames[0],dbName,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
    store.createTable(table);
    table=new Table(tableNames[1],dbName,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
    store.createTable(table);
    String[] roleNames=new String[]{"ltg_role1","ltg_role2"};
    String[] userNames=new String[]{"gandalf","radagast"};
    store.addRole(roleNames[0],"me");
    store.addRole(roleNames[1],"me");
    int now=(int)(System.currentTimeMillis() / 1000);
    Role role1=store.getRole(roleNames[0]);
    Role role2=store.getRole(roleNames[1]);
    store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
    store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
    store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
    List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
    HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.TABLE,dbName,tableNames[0],null,null);
    PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
    HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
    privileges.add(hop);
    grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
    hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
    privileges.add(hop);
    PrivilegeBag pBag=new PrivilegeBag(privileges);
    store.grantPrivileges(pBag);
    List<HiveObjectPrivilege> hops=store.listAllTableGrants(roleNames[0],PrincipalType.ROLE,dbName,tableNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listAllTableGrants(userNames[0],PrincipalType.USER,dbName,tableNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listAllTableGrants(roleNames[1],PrincipalType.ROLE,dbName,tableNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(userNames[1],PrincipalType.USER,dbName,tableNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(roleNames[0],PrincipalType.ROLE,dbName,tableNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(userNames[0],PrincipalType.USER,dbName,tableNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listTableGrantsAll(dbName,tableNames[0]);
    Assert.assertEquals(2,hops.size());
    boolean sawUser=false, sawRole=false;
    for (    HiveObjectPrivilege h : hops) {
      if (h.getPrincipalName().equals(userNames[0])) {
        Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.TABLE,h.getHiveObject().getObjectType());
        Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
        sawUser=true;
      }
 else       if (h.getPrincipalName().equals(roleNames[0])) {
        Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.TABLE,h.getHiveObject().getObjectType());
        Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
        sawRole=true;
      }
    }
    Assert.assertTrue(sawUser && sawRole);
    hops=store.listPrincipalTableGrantsAll(roleNames[0],PrincipalType.ROLE);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalTableGrantsAll(userNames[0],PrincipalType.USER);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(roleNames[1],PrincipalType.ROLE);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrantsAll(userNames[1],PrincipalType.USER);
    Assert.assertEquals(0,hops.size());
  }
  finally {
    store.dropTable(dbName,tableNames[0]);
    store.dropTable(dbName,tableNames[1]);
    store.dropDatabase(dbName);
  }
}

</code></pre>

<br>
<pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listDbGrants() throws Exception {
  String dbNames[]=new String[]{"ldbg_db1","ldbg_db2"};
  try {
    Database db=new Database(dbNames[0],"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    db=new Database(dbNames[1],"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    String[] roleNames=new String[]{"ldbg_role1","ldbg_role2"};
    String[] userNames=new String[]{"frodo","sam"};
    store.addRole(roleNames[0],"me");
    store.addRole(roleNames[1],"me");
    int now=(int)(System.currentTimeMillis() / 1000);
    Role role1=store.getRole(roleNames[0]);
    Role role2=store.getRole(roleNames[1]);
    store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
    store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
    store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
    List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
    HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.DATABASE,dbNames[0],null,null,null);
    PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
    HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
    privileges.add(hop);
    grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
    hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
    privileges.add(hop);
    PrivilegeBag pBag=new PrivilegeBag(privileges);
    store.grantPrivileges(pBag);
    List<HiveObjectPrivilege> hops=store.listPrincipalDBGrants(roleNames[0],PrincipalType.ROLE,dbNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrants(userNames[0],PrincipalType.USER,dbNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrants(roleNames[1],PrincipalType.ROLE,dbNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrants(userNames[1],PrincipalType.USER,dbNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrants(roleNames[0],PrincipalType.ROLE,dbNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrants(userNames[0],PrincipalType.USER,dbNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listDBGrantsAll(dbNames[0]);
    Assert.assertEquals(2,hops.size());
    boolean sawUser=false, sawRole=false;
    for (    HiveObjectPrivilege h : hops) {
      if (h.getPrincipalName().equals(userNames[0])) {
        Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.DATABASE,h.getHiveObject().getObjectType());
        Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
        sawUser=true;
      }
 else       if (h.getPrincipalName().equals(roleNames[0])) {
        Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.DATABASE,h.getHiveObject().getObjectType());
        Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
        sawRole=true;
      }
    }
    Assert.assertTrue(sawUser && sawRole);
    hops=store.listPrincipalDBGrantsAll(roleNames[0],PrincipalType.ROLE);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(userNames[0],PrincipalType.USER);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(roleNames[1],PrincipalType.ROLE);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrantsAll(userNames[1],PrincipalType.USER);
    Assert.assertEquals(0,hops.size());
  }
  finally {
    store.dropDatabase(dbNames[0]);
    store.dropDatabase(dbNames[1]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void grantRevokeRoles() throws Exception {
  int now=(int)(System.currentTimeMillis() / 1000);
  String roleName1="role1";
  store.addRole(roleName1,"me");
  String roleName2="role2";
  store.addRole(roleName2,"me");
  Role role1=store.getRole(roleName1);
  Role role2=store.getRole(roleName2);
  store.grantRole(role1,"fred",PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role2,roleName1,PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role2,"fred",PrincipalType.USER,"admin",PrincipalType.ROLE,false);
  List<Role> roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(3,roles.size());
  boolean sawRole1=false, sawRole2=false, sawPublic=false;
  for (  Role role : roles) {
    if (role.getRoleName().equals(roleName1)) {
      sawRole1=true;
    }
 else     if (role.getRoleName().equals(roleName2)) {
      sawRole2=true;
    }
 else     if (role.getRoleName().equals(HiveMetaStore.PUBLIC)) {
      sawPublic=true;
    }
 else {
      Assert.fail("Unknown role name " + role.getRoleName());
    }
  }
  Assert.assertTrue(sawRole1 && sawRole2 && sawPublic);
  roles=store.listRoles("fred",PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Role role=roles.get(0);
  Assert.assertEquals(roleName2,role.getRoleName());
  List<RolePrincipalGrant> grants=store.listRoleMembers(roleName1);
  Assert.assertEquals(1,grants.size());
  Assert.assertEquals("fred",grants.get(0).getPrincipalName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getPrincipalType());
  Assert.assertTrue("Expected grant time of " + now + " got "+ grants.get(0).getGrantTime(),grants.get(0).getGrantTime() >= now);
  Assert.assertEquals("bob",grants.get(0).getGrantorName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getGrantorPrincipalType());
  Assert.assertFalse(grants.get(0).isGrantOption());
  grants=store.listRoleMembers(roleName2);
  Assert.assertEquals(2,grants.size());
  boolean sawFred=false;
  sawRole1=false;
  for (  RolePrincipalGrant m : grants) {
    if ("fred".equals(m.getPrincipalName()))     sawFred=true;
 else     if (roleName1.equals(m.getPrincipalName()))     sawRole1=true;
 else     Assert.fail("Unexpected principal " + m.getPrincipalName());
  }
  Assert.assertTrue(sawFred && sawRole1);
  store.revokeRole(role2,roleName1,PrincipalType.ROLE,true);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName2,roles.get(0).getRoleName());
  grants=store.listRoleMembers(roleName1);
  Assert.assertFalse(grants.get(0).isGrantOption());
  store.removeRole(roleName1);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(2,roles.size());
  sawRole2=sawPublic=false;
  for (  Role m : roles) {
    if (m.getRoleName().equals(roleName2))     sawRole2=true;
 else     if (m.getRoleName().equals(HiveMetaStore.PUBLIC))     sawPublic=true;
 else     Assert.fail("Unknown role " + m.getRoleName());
  }
  Assert.assertTrue(sawRole2 && sawPublic);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  store.revokeRole(role2,"fred",PrincipalType.USER,false);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(HiveMetaStore.PUBLIC,roles.get(0).getRoleName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeFromLocalWorkers() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","baz",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","bazzoo",CompactionType.MINOR);
  txnHandler.compact(rqst);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  assertNotNull(txnHandler.findNextToCompact("bob-193892"));
  assertNotNull(txnHandler.findNextToCompact("fred-193893"));
  txnHandler.revokeFromLocalWorkers("fred");
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(3,compacts.size());
  boolean sawWorkingBob=false;
  int initiatedCount=0;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working")) {
      assertEquals("bob-193892",c.getWorkerid());
      sawWorkingBob=true;
    }
 else     if (c.getState().equals("initiated")) {
      initiatedCount++;
    }
 else {
      fail("Unexpected state");
    }
  }
  assertTrue(sawWorkingBob);
  assertEquals(2,initiatedCount);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeTimedOutWorkers() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","baz",CompactionType.MINOR);
  txnHandler.compact(rqst);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  Thread.sleep(200);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  txnHandler.revokeTimedoutWorkers(100);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(2,compacts.size());
  boolean sawWorking=false, sawInitiated=false;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working"))     sawWorking=true;
 else     if (c.getState().equals("initiated"))     sawInitiated=true;
 else     fail("Unexpected state");
  }
  assertTrue(sawWorking);
  assertTrue(sawInitiated);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToCompact2() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=yesterday");
  txnHandler.compact(rqst);
  long now=System.currentTimeMillis();
  boolean expectToday=false;
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  if ("ds=today".equals(ci.partName))   expectToday=false;
 else   if ("ds=yesterday".equals(ci.partName))   expectToday=true;
 else   fail("partition name should have been today or yesterday but was " + ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  if (expectToday)   assertEquals("ds=today",ci.partName);
 else   assertEquals("ds=yesterday",ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(2,compacts.size());
  for (  ShowCompactResponseElement e : compacts) {
    assertEquals("working",e.getState());
    assertTrue(e.getStart() - 5000 < now && e.getStart() + 5000 > now);
    assertEquals("fred",e.getWorkerid());
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void addDynamicPartitions() throws Exception {
  String dbName="default";
  String tableName="adp_table";
  OpenTxnsResponse openTxns=txnHandler.openTxns(new OpenTxnRequest(1,"me","localhost"));
  long txnId=openTxns.getTxn_ids().get(0);
  LockComponent lc=new LockComponent(LockType.SHARED_WRITE,LockLevel.TABLE,dbName);
  lc.setTablename(tableName);
  LockRequest lr=new LockRequest(Arrays.asList(lc),"me","localhost");
  lr.setTxnid(txnId);
  LockResponse lock=txnHandler.lock(new LockRequest(Arrays.asList(lc),"me","localhost"));
  assertEquals(LockState.ACQUIRED,lock.getState());
  txnHandler.addDynamicPartitions(new AddDynamicPartitions(txnId,dbName,tableName,Arrays.asList("ds=yesterday","ds=today")));
  txnHandler.commitTxn(new CommitTxnRequest(txnId));
  Set<CompactionInfo> potentials=txnHandler.findPotentialCompactions(1000);
  assertEquals(2,potentials.size());
  SortedSet<CompactionInfo> sorted=new TreeSet<CompactionInfo>(potentials);
  int i=0;
  for (  CompactionInfo ci : sorted) {
    assertEquals(dbName,ci.dbname);
    assertEquals(tableName,ci.tableName);
switch (i++) {
case 0:
      assertEquals("ds=today",ci.partName);
    break;
case 1:
  assertEquals("ds=yesterday",ci.partName);
break;
default :
throw new RuntimeException("What?");
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestTxnHandler </h4><pre class="type-6 type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void showLocks() throws Exception {
  long begining=System.currentTimeMillis();
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  txnid=openTxn();
  comp=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"mydb");
  comp.setTablename("mytable");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  components=new ArrayList<LockComponent>(1);
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.PARTITION,"yourdb");
  comp.setTablename("yourtable");
  comp.setPartitionname("yourpartition");
  components.add(comp);
  req=new LockRequest(components,"you","remotehost");
  res=txnHandler.lock(req);
  ShowLocksResponse rsp=txnHandler.showLocks(new ShowLocksRequest());
  List<ShowLocksResponseElement> locks=rsp.getLocks();
  assertEquals(3,locks.size());
  boolean[] saw=new boolean[locks.size()];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  ShowLocksResponseElement lock : locks) {
    if (lock.getLockid() == 1) {
      assertEquals(1,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertNull(lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.EXCLUSIVE,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertTrue("Expected acquired at " + lock.getAcquiredat() + " to be between "+ begining+ " and "+ System.currentTimeMillis(),begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[0]=true;
    }
 else     if (lock.getLockid() == 2) {
      assertEquals(2,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertEquals("mytable",lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.WAITING,lock.getState());
      assertEquals(LockType.SHARED_READ,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertEquals(0,lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[1]=true;
    }
 else     if (lock.getLockid() == 3) {
      assertEquals(0,lock.getTxnid());
      assertEquals("yourdb",lock.getDbname());
      assertEquals("yourtable",lock.getTablename());
      assertEquals("yourpartition",lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.SHARED_WRITE,lock.getType());
      assertTrue(lock.toString(),begining <= lock.getLastheartbeat() && System.currentTimeMillis() >= lock.getLastheartbeat());
      assertTrue(begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("you",lock.getUser());
      assertEquals("remotehost",lock.getHostname());
      saw[2]=true;
    }
 else {
      fail("Unknown lock id");
    }
  }
  for (int i=0; i < saw.length; i++)   assertTrue("Didn't see lock id " + i,saw[i]);
}

</code></pre>

<br>
<pre class="type-12 type-4 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void deadlockDetected() throws Exception {
  LOG.debug("Starting deadlock test");
  if (txnHandler instanceof TxnHandler) {
    final TxnHandler tHndlr=(TxnHandler)txnHandler;
    Connection conn=tHndlr.getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    Statement stmt=conn.createStatement();
    long now=tHndlr.getDbTime(conn);
    stmt.executeUpdate("insert into TXNS (txn_id, txn_state, txn_started, txn_last_heartbeat, " + "txn_user, txn_host) values (1, 'o', " + now + ", "+ now+ ", 'shagy', "+ "'scooby.com')");
    stmt.executeUpdate("insert into HIVE_LOCKS (hl_lock_ext_id, hl_lock_int_id, hl_txnid, " + "hl_db, hl_table, hl_partition, hl_lock_state, hl_lock_type, hl_last_heartbeat, " + "hl_user, hl_host) values (1, 1, 1, 'mydb', 'mytable', 'mypartition', '" + tHndlr.LOCK_WAITING + "', '"+ tHndlr.LOCK_EXCLUSIVE+ "', "+ now+ ", 'fred', "+ "'scooby.com')");
    conn.commit();
    tHndlr.closeDbConn(conn);
    final AtomicBoolean sawDeadlock=new AtomicBoolean();
    final Connection conn1=tHndlr.getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    final Connection conn2=tHndlr.getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    try {
      for (int i=0; i < 5; i++) {
        Thread t1=new Thread(){
          @Override public void run(){
            try {
              try {
                updateTxns(conn1);
                updateLocks(conn1);
                Thread.sleep(1000);
                conn1.commit();
                LOG.debug("no exception, no deadlock");
              }
 catch (              SQLException e) {
                try {
                  tHndlr.checkRetryable(conn1,e,"thread t1");
                  LOG.debug("Got an exception, but not a deadlock, SQLState is " + e.getSQLState() + " class of exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                }
 catch (                TxnHandler.RetryException de) {
                  LOG.debug("Forced a deadlock, SQLState is " + e.getSQLState() + " class of "+ "exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                  sawDeadlock.set(true);
                }
              }
              conn1.rollback();
            }
 catch (            Exception e) {
              throw new RuntimeException(e);
            }
          }
        }
;
        Thread t2=new Thread(){
          @Override public void run(){
            try {
              try {
                updateLocks(conn2);
                updateTxns(conn2);
                Thread.sleep(1000);
                conn2.commit();
                LOG.debug("no exception, no deadlock");
              }
 catch (              SQLException e) {
                try {
                  tHndlr.checkRetryable(conn2,e,"thread t2");
                  LOG.debug("Got an exception, but not a deadlock, SQLState is " + e.getSQLState() + " class of exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                }
 catch (                TxnHandler.RetryException de) {
                  LOG.debug("Forced a deadlock, SQLState is " + e.getSQLState() + " class of "+ "exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                  sawDeadlock.set(true);
                }
              }
              conn2.rollback();
            }
 catch (            Exception e) {
              throw new RuntimeException(e);
            }
          }
        }
;
        t1.start();
        t2.start();
        t1.join();
        t2.join();
        if (sawDeadlock.get())         break;
      }
      assertTrue(sawDeadlock.get());
    }
  finally {
      conn1.rollback();
      tHndlr.closeDbConn(conn1);
      conn2.rollback();
      tHndlr.closeDbConn(conn2);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.TestTxnCommands2 </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the query correctness and directory layout after ACID table conversion and MAJOR compaction
 * @throws Exception
 */
@Test public void testNonAcidToAcidConversionAndMajorCompaction() throws Exception {
  FileSystem fs=FileSystem.get(hiveConf);
  FileStatus[] status;
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(1,2)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  List<String> rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  int[][] resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  int resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " SET TBLPROPERTIES ('transactional'='true')");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(3,4)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(3,status.length);
  boolean sawNewDelta=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("delta_.*")) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
    }
  }
  Assert.assertTrue(sawNewDelta);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " compact 'MAJOR'");
  Worker w=new Worker();
  w.setThreadId((int)w.getId());
  w.setHiveConf(hiveConf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  w.init(stop,looped);
  w.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(4,status.length);
  boolean sawNewBase=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("base_.*")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
  }
  Assert.assertTrue(sawNewBase);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  String fakeFile0=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_0";
  String fakeFile1=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_1";
  fs.create(new Path(fakeFile0));
  fs.create(new Path(fakeFile1));
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(5,status.length);
  Cleaner c=new Cleaner();
  c.setThreadId((int)c.getId());
  c.setHiveConf(hiveConf);
  stop=new AtomicBoolean();
  looped=new AtomicBoolean();
  stop.set(true);
  c.init(stop,looped);
  c.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(1,status.length);
  Assert.assertTrue(status[0].getPath().getName().matches("base_.*"));
  FileStatus[] buckets=fs.listStatus(status[0].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,buckets.length);
  Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
  Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestTezSessionPool </h4><pre class="type-12 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetNonDefaultSession(){
  poolManager=new TestTezSessionPoolManager();
  try {
    TezSessionState sessionState=poolManager.getSession(null,conf,true,false);
    TezSessionState sessionState1=poolManager.getSession(sessionState,conf,true,false);
    if (sessionState1 != sessionState) {
      fail();
    }
    conf.set("tez.queue.name","nondefault");
    TezSessionState sessionState2=poolManager.getSession(sessionState,conf,true,false);
    if (sessionState2 == sessionState) {
      fail();
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionPoolGetInOrder(){
  try {
    conf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"a,b,c");
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,2);
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSION_MAX_INIT_THREADS,1);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("a",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("b",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("c",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    if (sessionState.getQueueName().compareTo("a") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState,false);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestListColumnVector </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  ListColumnVector vector=new ListColumnVector(10,col1);
  vector.init();
  col1.isRepeating=true;
  vector.isRepeating=true;
  vector.noNulls=false;
  vector.isNull[0]=true;
  vector.childCount=0;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i + 3;
    vector.offsets[i]=i;
    vector.lengths[i]=10 + i;
  }
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertTrue("isNull at " + i,vector.isNull[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("null",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(vector.isRepeating);
  Arrays.fill(vector.isNull,1,10,false);
  int[] sel=new int[]{3,5,7};
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    assertEquals("failure at " + i,i == 3 || i == 5 || i == 7,vector.isNull[i]);
  }
  vector.unFlatten();
  vector.noNulls=true;
  vector.isRepeating=true;
  vector.offsets[0]=0;
  vector.lengths[0]=3;
  vector.childCount=3;
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertFalse(col1.isRepeating);
  assertFalse(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertEquals("offset at " + i,0,vector.offsets[i]);
    assertEquals("length at " + i,3,vector.lengths[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[3, 3, 3]",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertTrue(vector.isRepeating);
  assertTrue(vector.noNulls);
  Arrays.fill(vector.offsets,1,10,-1);
  Arrays.fill(vector.lengths,1,10,-1);
  Arrays.fill(col1.vector,1,10,-1);
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    if (i == 3 || i == 5 || i == 7) {
      assertEquals("failure at " + i,0,vector.offsets[i]);
      assertEquals("failure at " + i,3,vector.lengths[i]);
    }
 else {
      assertEquals("failure at " + i,-1,vector.offsets[i]);
      assertEquals("failure at " + i,-1,vector.lengths[i]);
    }
  }
  for (int i=0; i < 3; ++i) {
    assertEquals("failure at " + i,3,col1.vector[i]);
  }
  for (int i=3; i < 10; ++i) {
    assertEquals("failure at " + i,-1,col1.vector[i]);
  }
  vector.unFlatten();
  vector.reset();
  assertFalse(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertFalse(vector.isRepeating);
  assertTrue(vector.noNulls);
  assertEquals(0,vector.childCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestMapColumnVector </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  DoubleColumnVector col2=new DoubleColumnVector(10);
  MapColumnVector vector=new MapColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  vector.isRepeating=true;
  vector.noNulls=false;
  vector.isNull[0]=true;
  vector.childCount=0;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i + 3;
    col2.vector[i]=i * 10;
    vector.offsets[i]=i;
    vector.lengths[i]=10 + i;
  }
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertTrue("isNull at " + i,vector.isNull[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("null",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(vector.isRepeating);
  Arrays.fill(vector.isNull,1,10,false);
  int[] sel=new int[]{3,5,7};
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    assertEquals("failure at " + i,i == 3 || i == 5 || i == 7,vector.isNull[i]);
  }
  vector.unFlatten();
  vector.noNulls=true;
  vector.isRepeating=true;
  vector.offsets[0]=0;
  vector.lengths[0]=3;
  vector.childCount=3;
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertFalse(col1.isRepeating);
  assertFalse(col1.noNulls);
  assertFalse(col2.isRepeating);
  assertFalse(col2.noNulls);
  for (int i=0; i < 10; ++i) {
    assertEquals("offset at " + i,0,vector.offsets[i]);
    assertEquals("length at " + i,3,vector.lengths[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[{\"key\": 3, \"value\": 0.0}," + " {\"key\": 3, \"value\": 10.0}," + " {\"key\": 3, \"value\": 20.0}]",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertTrue(vector.isRepeating);
  assertFalse(col2.isRepeating);
  assertTrue(col2.noNulls);
  assertTrue(vector.noNulls);
  Arrays.fill(vector.offsets,1,10,-1);
  Arrays.fill(vector.lengths,1,10,-1);
  Arrays.fill(col1.vector,1,10,-1);
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    if (i == 3 || i == 5 || i == 7) {
      assertEquals("failure at " + i,0,vector.offsets[i]);
      assertEquals("failure at " + i,3,vector.lengths[i]);
    }
 else {
      assertEquals("failure at " + i,-1,vector.offsets[i]);
      assertEquals("failure at " + i,-1,vector.lengths[i]);
    }
  }
  for (int i=0; i < 3; ++i) {
    assertEquals("failure at " + i,3,col1.vector[i]);
  }
  for (int i=3; i < 10; ++i) {
    assertEquals("failure at " + i,-1,col1.vector[i]);
  }
  vector.unFlatten();
  vector.reset();
  assertFalse(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertFalse(col2.isRepeating);
  assertTrue(col2.noNulls);
  assertFalse(vector.isRepeating);
  assertTrue(vector.noNulls);
  assertEquals(0,vector.childCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorArithmeticExpressions </h4><pre class="type-6 type-12 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongScalarWithNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColumnVector lcv=(LongColumnVector)batch.cols[0];
  LongColumnVector lcvOut=(LongColumnVector)batch.cols[1];
  TestVectorizedRowBatch.addRandomNulls(lcv);
  LongColAddLongScalar expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    if (!lcv.isNull[i]) {
      Assert.assertEquals(i * 37 + 23,lcvOut.vector[i]);
    }
 else {
      Assert.assertTrue(lcvOut.isNull[i]);
    }
  }
  Assert.assertFalse(lcvOut.noNulls);
  Assert.assertFalse(lcvOut.isRepeating);
  verifyLongNullDataVectorEntries(lcvOut,batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorScalarColArithmetic </h4><pre class="type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarSubtractLongColWithNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColumnVector lcv=(LongColumnVector)batch.cols[0];
  TestVectorizedRowBatch.addRandomNulls(lcv);
  LongScalarSubtractLongColumn expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    if (!lcv.isNull[i]) {
      Assert.assertEquals(100 - i * 37,((LongColumnVector)batch.cols[1]).vector[i]);
    }
 else {
      Assert.assertTrue(((LongColumnVector)batch.cols[1]).isNull[i]);
    }
  }
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
  TestVectorArithmeticExpressions.verifyLongNullDataVectorEntries((LongColumnVector)batch.cols[1],batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.mapjoin.fast.TestVectorMapJoinFastMultiKeyHashMap </h4><pre class="type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testLarge() throws Exception {
  random=new Random(5231);
  VectorMapJoinFastMultiKeyHashMap map=new VectorMapJoinFastMultiKeyHashMap(false,LARGE_CAPACITY,LOAD_FACTOR,LARGE_WB_SIZE);
  RandomByteArrayStream randomByteArrayKeyStream=new RandomByteArrayStream(random,10);
  final int largeSize=1000;
  RandomByteArrayStream[] randomByteArrayValueStreams=new RandomByteArrayStream[largeSize];
  for (int i=0; i < largeSize; i++) {
    randomByteArrayValueStreams[i]=new RandomByteArrayStream(random);
    int count=generateLargeCount();
    byte[] key=randomByteArrayKeyStream.next();
    VectorMapJoinHashMapResult hashMapResult=map.createHashMapResult();
    JoinUtil.JoinResult joinResult=map.lookup(key,0,key.length,hashMapResult);
    if (joinResult == JoinUtil.JoinResult.MATCH) {
      assertTrue(false);
    }
    for (int v=0; v < count; v++) {
      byte[] value=randomByteArrayValueStreams[i].next();
      map.putRow(key,value);
    }
  }
  for (int i=0; i < largeSize; i++) {
    verifyHashMapResult(map,randomByteArrayKeyStream.get(i),randomByteArrayValueStreams[i]);
  }
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testLargeAndExpand() throws Exception {
  random=new Random(46809);
  VectorMapJoinFastMultiKeyHashMap map=new VectorMapJoinFastMultiKeyHashMap(false,MODERATE_CAPACITY,LOAD_FACTOR,MODERATE_WB_SIZE);
  RandomByteArrayStream randomByteArrayKeyStream=new RandomByteArrayStream(random,10);
  final int largeSize=1000;
  RandomByteArrayStream[] randomByteArrayValueStreams=new RandomByteArrayStream[largeSize];
  for (int i=0; i < largeSize; i++) {
    randomByteArrayValueStreams[i]=new RandomByteArrayStream(random);
    int count=generateLargeCount();
    byte[] key=randomByteArrayKeyStream.next();
    VectorMapJoinHashMapResult hashMapResult=map.createHashMapResult();
    JoinUtil.JoinResult joinResult=map.lookup(key,0,key.length,hashMapResult);
    if (joinResult == JoinUtil.JoinResult.MATCH) {
      assertTrue(false);
    }
    for (int v=0; v < count; v++) {
      byte[] value=randomByteArrayValueStreams[i].next();
      map.putRow(key,value);
    }
  }
  for (int i=0; i < largeSize; i++) {
    verifyHashMapResult(map,randomByteArrayKeyStream.get(i),randomByteArrayValueStreams[i]);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestIOContextMap </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezLlapAttemptMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000, ATTEMPT_COUNT=3;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT * ATTEMPT_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        final Configuration conf=new Configuration(), conf2=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          String input1="Input " + nextIx;
          conf.set(Utilities.INPUT_NAME,input1);
          for (int j=0; j < ATTEMPT_COUNT; ++j) {
            String attemptId="Attempt " + nextIx + ":"+ j;
            IOContextMap.setThreadAttemptId(attemptId);
            final IOContext r1=results[(nextIx * ATTEMPT_COUNT) + j]=IOContextMap.get(conf);
            if ((nextIx % (ITER_COUNT / 10)) == 0) {
              String input2="Input2 " + nextIx;
              conf2.set(Utilities.INPUT_NAME,input2);
              final AtomicReference<IOContext> ref2=new AtomicReference<>();
              Thread t=new Thread(new Runnable(){
                public void run(){
                  assertSame(r1,IOContextMap.get(conf));
                  ref2.set(IOContextMap.get(conf2));
                }
              }
);
              t.start();
              t.join();
              assertSame(ref2.get(),IOContextMap.get(conf2));
            }
          }
          if (nextIx == 0)           break;
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Configuration conf=new Configuration();
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < ITER_COUNT; ++i) {
    conf.set(Utilities.INPUT_NAME,"Input " + i);
    for (int j=0; j < ATTEMPT_COUNT; ++j) {
      String attemptId="Attempt " + i + ":"+ j;
      IOContext result=results[(i * ATTEMPT_COUNT) + j];
      assertTrue(resultSet.add(result));
      IOContextMap.setThreadAttemptId(attemptId);
      assertSame(result,IOContextMap.get(conf));
      IOContextMap.clearThreadAttempt(attemptId);
      IOContextMap.setThreadAttemptId(attemptId);
      assertNotSame(result,IOContextMap.get(conf));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestRCFile </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleReadAndWrite() throws IOException, SerDeException {
  cleanup();
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  Object[] expectedRecord_1={new ByteWritable((byte)123),new ShortWritable((short)456),new IntWritable(789),new LongWritable(1000),new DoubleWritable(5.3),new Text("hive and hadoop"),null,null};
  Object[] expectedRecord_2={new ByteWritable((byte)100),new ShortWritable((short)200),new IntWritable(123),new LongWritable(1000),new DoubleWritable(5.3),new Text("hive and hadoop"),null,null};
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  assertEquals(new Text("block"),reader.getMetadata().get(new Text("apple")));
  assertEquals(new Text("block"),reader.getMetadataValueOf(new Text("apple")));
  assertEquals(new Text("dog"),reader.getMetadataValueOf(new Text("cat")));
  LongWritable rowID=new LongWritable();
  for (int i=0; i < 2; i++) {
    reader.next(rowID);
    BytesRefArrayWritable cols=new BytesRefArrayWritable();
    reader.getCurrentRow(cols);
    cols.resetValid(8);
    Object row=serDe.deserialize(cols);
    StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
    List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
    assertEquals("Field size should be 8",8,fieldRefs.size());
    for (int j=0; j < fieldRefs.size(); j++) {
      Object fieldData=oi.getStructFieldData(row,fieldRefs.get(j));
      Object standardWritableData=ObjectInspectorUtils.copyToStandardObject(fieldData,fieldRefs.get(j).getFieldObjectInspector(),ObjectInspectorCopyOption.WRITABLE);
      if (i == 0) {
        assertEquals("Field " + i,standardWritableData,expectedRecord_1[j]);
      }
 else {
        assertEquals("Field " + i,standardWritableData,expectedRecord_2[j]);
      }
    }
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link RCFile.Reader#getColumn(int,BytesRefArrayWritable) } method.
 * @throws IOException
 */
@Test public void testGetColumn() throws IOException {
  cleanup();
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  LongWritable rowID=new LongWritable();
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),0L);
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),1L);
  BytesRefArrayWritable result=null;
  BytesRefWritable brw;
  for (int col=0; col < 8; col++) {
    BytesRefArrayWritable result2=reader.getColumn(col,result);
    if (result == null) {
      assertNotNull(result2);
      result=result2;
    }
 else {
      assertSame(result2,result);
    }
    assertEquals(2,result.size());
    for (int row=0; row < result.size(); row++) {
      brw=result.get(row);
      int start=brw.getStart();
      int len=brw.getLength();
      byte[] actualData=Arrays.copyOfRange(brw.getData(),start,start + len);
      byte[] expectedData=(row == 0) ? record_1[col] : record_2[col];
      assertArrayEquals("col=" + col + " : row="+ row,expectedData,actualData);
    }
    result.clear();
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSync() throws IOException {
  Path testDir=new Path(System.getProperty("test.tmp.dir",".") + "/mapred/testsync");
  Path testFile=new Path(testDir,"test_rcfile");
  fs.delete(testFile,true);
  int intervalRecordCount=500;
  CompressionCodec codec=null;
  int writeCount=2500;
  Configuration cloneConf=new Configuration(conf);
  RCFileOutputFormat.setColumnNumber(cloneConf,bytesArray.length);
  cloneConf.setInt(HiveConf.ConfVars.HIVE_RCFILE_RECORD_INTERVAL.varname,intervalRecordCount);
  RCFile.Writer writer=new RCFile.Writer(fs,cloneConf,testFile,null,codec);
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(bytesArray.length);
  for (int i=0; i < bytesArray.length; i++) {
    BytesRefWritable cu=null;
    cu=new BytesRefWritable(bytesArray[i],0,bytesArray[i].length);
    bytes.set(i,cu);
  }
  for (int i=0; i < writeCount; i++) {
    writer.append(bytes);
  }
  writer.close();
  long fileLen=fs.getFileStatus(testFile).getLen();
  RCFileInputFormat inputFormat=new RCFileInputFormat();
  JobConf jobconf=new JobConf(cloneConf);
  jobconf.set("mapred.input.dir",testDir.toString());
  HiveConf.setLongVar(jobconf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,fileLen);
  InputSplit[] splits=inputFormat.getSplits(jobconf,1);
  RCFileRecordReader rr=new RCFileRecordReader(jobconf,(FileSplit)splits[0]);
  long lastSync=0;
  for (int i=0; i < 2500; i++) {
    rr.sync(i);
    if (rr.getPos() < lastSync) {
      String reason=String.format("Sync at offset %d skipped sync block at location %d (returned %d instead)",i - 1,rr.getPos(),lastSync);
      System.out.println(reason);
      fail(reason);
    }
    lastSync=rr.getPos();
  }
  rr.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProjectedColumnSize() throws Exception {
  long[] stripeSizes=new long[]{200,200,200,200,100};
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/file",500,createMockOrcFile(stripeSizes),new MockBlock("host1-1","host1-2","host1-3"),new MockBlock("host2-1","host0","host2-3"),new MockBlock("host0","host3-2","host3-3"),new MockBlock("host4-1","host4-2","host4-3"),new MockBlock("host5-1","host5-2","host5-3")));
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,300);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,200);
  conf.setBoolean(ColumnProjectionUtils.READ_ALL_COLUMNS,false);
  conf.set(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR,"0");
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  OrcInputFormat.SplitGenerator splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  List<OrcSplit> results=splitter.call();
  OrcSplit result=results.get(0);
  assertEquals(3,results.size());
  assertEquals(3,result.getStart());
  assertEquals(400,result.getLength());
  assertEquals(167468,result.getProjectedColumnsUncompressedSize());
  result=results.get(1);
  assertEquals(403,result.getStart());
  assertEquals(400,result.getLength());
  assertEquals(167468,result.getProjectedColumnsUncompressedSize());
  result=results.get(2);
  assertEquals(803,result.getStart());
  assertEquals(100,result.getLength());
  assertEquals(41867,result.getProjectedColumnsUncompressedSize());
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,0);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,0);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  assertEquals(5,results.size());
  for (int i=0; i < stripeSizes.length; ++i) {
    assertEquals("checking stripe " + i + " size",stripeSizes[i],results.get(i).getLength());
    if (i == stripeSizes.length - 1) {
      assertEquals(41867,results.get(i).getProjectedColumnsUncompressedSize());
    }
 else {
      assertEquals(83734,results.get(i).getProjectedColumnsUncompressedSize());
    }
  }
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,1000);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,100000);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  assertEquals(1,results.size());
  result=results.get(0);
  assertEquals(3,result.getStart());
  assertEquals(900,result.getLength());
  assertEquals(376804,result.getProjectedColumnsUncompressedSize());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcFile </h4><pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new BigRow(false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map()));
  writer.addRow(new BigRow(true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib"))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(23,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,byte1,short1,int1,long1,float1,double1,bytes1,string1,middle,list,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  StripeStatistics ss=reader.getStripeStatistics().get(0);
  assertEquals(2,ss.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)ss.getColumnStatistics()[1]).getTrueCount());
  assertEquals(1024,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMinimum());
  assertEquals(2048,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMaximum());
  assertEquals(3072,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getSum());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We test union, timestamp, and decimal separately since we need to make the
 * object inspector manually. (The Hive reflection-based doesn't handle
 * them properly.)
 */
@Test public void testUnionAndTimestamp() throws Exception {
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addFieldNames("time").addFieldNames("union").addFieldNames("decimal").addSubtypes(1).addSubtypes(2).addSubtypes(5).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.TIMESTAMP).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.UNION).addSubtypes(3).addSubtypes(4).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRING).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.DECIMAL).build());
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=OrcStruct.createObjectInspector(0,types);
  }
  HiveDecimal maxValue=HiveDecimal.create("10000000000000000000");
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).batchSize(1000).bufferSize(100).blockPadding(false));
  OrcStruct row=new OrcStruct(3);
  OrcUnion union=new OrcUnion();
  row.setFieldValue(1,union);
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")));
  HiveDecimal value=HiveDecimal.create("12345678.6547456");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  union.set((byte)0,new IntWritable(42));
  writer.addRow(row);
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")));
  union.set((byte)1,new Text("hello"));
  value=HiveDecimal.create("-5643.234");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  writer.addRow(row);
  row.setFieldValue(0,null);
  row.setFieldValue(1,null);
  row.setFieldValue(2,null);
  writer.addRow(row);
  row.setFieldValue(1,union);
  union.set((byte)0,null);
  writer.addRow(row);
  union.set((byte)1,null);
  writer.addRow(row);
  union.set((byte)0,new IntWritable(200000));
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")));
  value=HiveDecimal.create("10000000000000000000");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  writer.addRow(row);
  Random rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)));
    if ((i & 1) == 0) {
      union.set((byte)0,new IntWritable(i * i));
    }
 else {
      union.set((byte)1,new Text(Integer.toString(i * i)));
    }
    value=HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18));
    row.setFieldValue(2,new HiveDecimalWritable(value));
    if (maxValue.compareTo(value) < 0) {
      maxValue=value;
    }
    writer.addRow(row);
  }
  row.setFieldValue(0,null);
  union.set((byte)0,new IntWritable(1732050807));
  row.setFieldValue(2,null);
  for (int i=0; i < 5000; ++i) {
    writer.addRow(row);
  }
  union.set((byte)0,new IntWritable(0));
  writer.addRow(row);
  union.set((byte)0,new IntWritable(10));
  writer.addRow(row);
  union.set((byte)0,new IntWritable(138));
  writer.addRow(row);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(5,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,true};
  included=OrcUtils.includeColumns("time,decimal",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,true,true,true,false};
  included=OrcUtils.includeColumns("union",schema);
  assertEquals(true,Arrays.equals(expected,included));
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(5077,reader.getNumberOfRows());
  DecimalColumnStatistics stats=(DecimalColumnStatistics)reader.getStatistics()[5];
  assertEquals(71,stats.getNumberOfValues());
  assertEquals(HiveDecimal.create("-5643.234"),stats.getMinimum());
  assertEquals(maxValue,stats.getMaximum());
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  assertEquals(reader.getContentLength(),currentOffset);
  RecordReader rows=reader.rows();
  assertEquals(0,rows.getRowNumber());
  assertEquals(0.0,rows.getProgress(),0.000001);
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(1,rows.getRowNumber());
  inspector=reader.getObjectInspector();
  assertEquals("struct<time:timestamp,union:uniontype<int,string>,decimal:decimal(38,18)>",inspector.getTypeName());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")),row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(new IntWritable(42),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("12345678.6547456")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(2,rows.getRowNumber());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(null,row.getFieldValue(1));
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")),row.getFieldValue(0));
  assertEquals(new IntWritable(200000),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("10000000000000000000")),row.getFieldValue(2));
  rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)),row.getFieldValue(0));
    if ((i & 1) == 0) {
      assertEquals(0,union.getTag());
      assertEquals(new IntWritable(i * i),union.getObject());
    }
 else {
      assertEquals(1,union.getTag());
      assertEquals(new Text(Integer.toString(i * i)),union.getObject());
    }
    assertEquals(new HiveDecimalWritable(HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18))),row.getFieldValue(2));
  }
  for (int i=0; i < 5000; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new IntWritable(1732050807),union.getObject());
  }
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(0),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(10),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(138),union.getObject());
  assertEquals(false,rows.hasNext());
  assertEquals(1.0,rows.getProgress(),0.00001);
  assertEquals(reader.getNumberOfRows(),rows.getRowNumber());
  rows.seekToRow(1);
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFormat_0_11() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>,ts:timestamp,"+ "decimal1:decimal(38,18)>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  HiveDecimalObjectInspector dco=(HiveDecimalObjectInspector)readerInspector.getStructFieldRef("decimal1").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547456"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547457"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void columnProjection() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).rowIndexStride(1000));
  Random r1=new Random(1);
  Random r2=new Random(2);
  int x;
  int minInt=0, maxInt=0;
  String y;
  String minStr=null, maxStr=null;
  for (int i=0; i < 21000; ++i) {
    x=r1.nextInt();
    y=Long.toHexString(r2.nextLong());
    if (i == 0 || x < minInt) {
      minInt=x;
    }
    if (i == 0 || x > maxInt) {
      maxInt=x;
    }
    if (i == 0 || y.compareTo(minStr) < 0) {
      minStr=y;
    }
    if (i == 0 || y.compareTo(maxStr) > 0) {
      maxStr=y;
    }
    writer.addRow(inner(x,y));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(3,stats.length);
  for (  ColumnStatistics s : stats) {
    assertEquals(21000,s.getNumberOfValues());
    if (s instanceof IntegerColumnStatistics) {
      assertEquals(minInt,((IntegerColumnStatistics)s).getMinimum());
      assertEquals(maxInt,((IntegerColumnStatistics)s).getMaximum());
    }
 else     if (s instanceof StringColumnStatistics) {
      assertEquals(maxStr,((StringColumnStatistics)s).getMaximum());
      assertEquals(minStr,((StringColumnStatistics)s).getMinimum());
    }
  }
  List<OrcProto.Type> types=reader.getTypes();
  assertEquals(3,types.size());
  assertEquals(OrcProto.Type.Kind.STRUCT,types.get(0).getKind());
  assertEquals(2,types.get(0).getSubtypesCount());
  assertEquals(1,types.get(0).getSubtypes(0));
  assertEquals(2,types.get(0).getSubtypes(1));
  assertEquals(OrcProto.Type.Kind.INT,types.get(1).getKind());
  assertEquals(0,types.get(1).getSubtypesCount());
  assertEquals(OrcProto.Type.Kind.STRING,types.get(2).getKind());
  assertEquals(0,types.get(2).getSubtypesCount());
  RecordReader rows1=reader.rows(new boolean[]{true,true,false});
  RecordReader rows2=reader.rows(new boolean[]{true,false,true});
  r1=new Random(1);
  r2=new Random(2);
  OrcStruct row1=null;
  OrcStruct row2=null;
  for (int i=0; i < 21000; ++i) {
    assertEquals(true,rows1.hasNext());
    assertEquals(true,rows2.hasNext());
    row1=(OrcStruct)rows1.next(row1);
    row2=(OrcStruct)rows2.next(row2);
    assertEquals(r1.nextInt(),((IntWritable)row1.getFieldValue(0)).get());
    assertEquals(Long.toHexString(r2.nextLong()),row2.getFieldValue(1).toString());
  }
  assertEquals(false,rows1.hasNext());
  assertEquals(false,rows2.hasNext());
  rows1.close();
  rows2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcSerDeStats </h4><pre class="type-11 type-12 type-5 type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ClassCastException.class) public void testSerdeStatsOldFormat() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(6300000,reader.getRawDataSize());
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("bye",((StringColumnStatistics)stats[9]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[9]).getMaximum());
  assertEquals(0,((StringColumnStatistics)stats[9]).getSum());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  assertEquals("count: 7500 hasNull: true",stats[8].toString());
  assertEquals(5,((BinaryColumnStatistics)stats[8]).getSum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestVectorOrcFile </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testColumnProjection() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random r1=new Random(1);
  Random r2=new Random(2);
  int x;
  int minInt=0, maxInt=0;
  String y;
  String minStr=null, maxStr=null;
  batch.size=1000;
  boolean first=true;
  for (int b=0; b < 21; ++b) {
    for (int r=0; r < 1000; ++r) {
      x=r1.nextInt();
      y=Long.toHexString(r2.nextLong());
      if (first || x < minInt) {
        minInt=x;
      }
      if (first || x > maxInt) {
        maxInt=x;
      }
      if (first || y.compareTo(minStr) < 0) {
        minStr=y;
      }
      if (first || y.compareTo(maxStr) > 0) {
        maxStr=y;
      }
      first=false;
      ((LongColumnVector)batch.cols[0]).vector[r]=x;
      ((BytesColumnVector)batch.cols[1]).setVal(r,y.getBytes());
    }
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(3,stats.length);
  for (  ColumnStatistics s : stats) {
    assertEquals(21000,s.getNumberOfValues());
    if (s instanceof IntegerColumnStatistics) {
      assertEquals(minInt,((IntegerColumnStatistics)s).getMinimum());
      assertEquals(maxInt,((IntegerColumnStatistics)s).getMaximum());
    }
 else     if (s instanceof StringColumnStatistics) {
      assertEquals(maxStr,((StringColumnStatistics)s).getMaximum());
      assertEquals(minStr,((StringColumnStatistics)s).getMinimum());
    }
  }
  List<OrcProto.Type> types=reader.getTypes();
  assertEquals(3,types.size());
  assertEquals(OrcProto.Type.Kind.STRUCT,types.get(0).getKind());
  assertEquals(2,types.get(0).getSubtypesCount());
  assertEquals(1,types.get(0).getSubtypes(0));
  assertEquals(2,types.get(0).getSubtypes(1));
  assertEquals(OrcProto.Type.Kind.INT,types.get(1).getKind());
  assertEquals(0,types.get(1).getSubtypesCount());
  assertEquals(OrcProto.Type.Kind.STRING,types.get(2).getKind());
  assertEquals(0,types.get(2).getSubtypesCount());
  RecordReader rows1=reader.rows(new boolean[]{true,true,false});
  RecordReader rows2=reader.rows(new boolean[]{true,false,true});
  r1=new Random(1);
  r2=new Random(2);
  OrcStruct row1=null;
  OrcStruct row2=null;
  for (int i=0; i < 21000; ++i) {
    assertEquals(true,rows1.hasNext());
    assertEquals(true,rows2.hasNext());
    row1=(OrcStruct)rows1.next(row1);
    row2=(OrcStruct)rows2.next(row2);
    assertEquals(r1.nextInt(),((IntWritable)row1.getFieldValue(0)).get());
    assertEquals(Long.toHexString(r2.nextLong()),row2.getFieldValue(1).toString());
  }
  assertEquals(false,rows1.hasNext());
  assertEquals(false,rows2.hasNext());
  rows1.close();
  rows2.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Unions.
 * @throws Exception
 */
@Test public void testUnions() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("outer",TypeDescription.createUnion().addUnionChild(TypeDescription.createInt()).addUnionChild(TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  UnionColumnVector outer=(UnionColumnVector)batch.cols[0];
  batch.cols[0].noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      outer.isNull[r]=true;
    }
 else     if (r < 300) {
      outer.tags[r]=0;
    }
 else     if (r < 400) {
      outer.tags[r]=1;
    }
 else     if (r < 600) {
      outer.isNull[r]=true;
    }
 else     if (r < 800) {
      outer.tags[r]=1;
    }
 else     if (r < 1000) {
      outer.isNull[r]=true;
    }
 else {
      outer.tags[r]=1;
    }
    ((LongColumnVector)outer.fields[0]).vector[r]=r;
    ((LongColumnVector)outer.fields[1]).vector[r]=-r;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    OrcUnion inner=(OrcUnion)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"union(0, " + r + ")",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 800) {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
 else     if (r < 1000) {
      assertEquals("row " + r,null,inner);
    }
 else {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test lists and how they interact with the child column. In particular,
 * put nulls between back to back lists and then make some lists that
 * oper lap.
 * @throws Exception
 */
@Test public void testLists() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("list",TypeDescription.createList(TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  ListColumnVector list=(ListColumnVector)batch.cols[0];
  list.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      list.isNull[r]=true;
    }
 else     if (r < 300) {
      list.offsets[r]=r - 200;
      list.lengths[r]=1;
    }
 else     if (r < 400) {
      list.isNull[r]=true;
    }
 else     if (r < 500) {
      list.offsets[r]=r - 300;
      list.lengths[r]=1;
    }
 else     if (r < 600) {
      list.isNull[r]=true;
    }
 else     if (r < 700) {
      list.offsets[r]=r;
      list.lengths[r]=2;
    }
 else {
      list.isNull[r]=true;
    }
    ((LongColumnVector)list.child).vector[r]=r * 10;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    List inner=(List)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"[" + ((r - 200) * 10) + "]",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 500) {
      assertEquals("row " + r,"[" + ((r - 300) * 10) + "]",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 700) {
      assertEquals("row " + r,"[" + (10 * r) + ", "+ (10 * (r + 1))+ "]",inner.toString());
    }
 else {
      assertEquals("row " + r,null,inner);
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFormat_0_11() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>,ts:timestamp,"+ "decimal1:decimal(38,18)>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  HiveDecimalObjectInspector dco=(HiveDecimalObjectInspector)readerInspector.getStructFieldRef("decimal1").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547456"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547457"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStructs() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("struct",TypeDescription.createStruct().addField("inner",TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  StructColumnVector outer=(StructColumnVector)batch.cols[0];
  outer.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200 || (r >= 400 && r < 600) || r >= 800) {
      outer.isNull[r]=true;
    }
    ((LongColumnVector)outer.fields[0]).vector[r]=r;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    OrcStruct inner=(OrcStruct)row.getFieldValue(0);
    if (r < 200 || (r >= 400 && r < 600) || r >= 800) {
      assertEquals("row " + r,null,inner);
    }
 else {
      assertEquals("row " + r,"{" + r + "}",inner.toString());
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We test union, timestamp, and decimal separately since we need to make the
 * object inspector manually. (The Hive reflection-based doesn't handle
 * them properly.)
 */
@Test public void testUnionAndTimestamp() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("time",TypeDescription.createTimestamp()).addField("union",TypeDescription.createUnion().addUnionChild(TypeDescription.createInt()).addUnionChild(TypeDescription.createString())).addField("decimal",TypeDescription.createDecimal().withPrecision(38).withScale(18));
  HiveDecimal maxValue=HiveDecimal.create("10000000000000000000");
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).blockPadding(false));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=6;
  setUnion(batch,0,Timestamp.valueOf("2000-03-12 15:00:00"),0,42,null,new HiveDecimalWritable("12345678.6547456"));
  setUnion(batch,1,Timestamp.valueOf("2000-03-20 12:00:00.123456789"),1,null,"hello",new HiveDecimalWritable("-5643.234"));
  setUnion(batch,2,null,null,null,null,null);
  setUnion(batch,3,null,0,null,null,null);
  setUnion(batch,4,null,1,null,null,null);
  setUnion(batch,5,Timestamp.valueOf("1970-01-01 00:00:00"),0,200000,null,new HiveDecimalWritable("10000000000000000000"));
  writer.addRowBatch(batch);
  batch.reset();
  Random rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    Timestamp ts=Timestamp.valueOf(i + "-05-05 12:34:56." + i);
    HiveDecimal dec=HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18));
    if ((i & 1) == 0) {
      setUnion(batch,batch.size++,ts,0,i * i,null,new HiveDecimalWritable(dec));
    }
 else {
      setUnion(batch,batch.size++,ts,1,null,Integer.toString(i * i),new HiveDecimalWritable(dec));
    }
    if (maxValue.compareTo(dec) < 0) {
      maxValue=dec;
    }
  }
  writer.addRowBatch(batch);
  batch.reset();
  batch.size=1000;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
  }
  setUnion(batch,0,null,0,1732050807,null,null);
  for (int i=0; i < 5; ++i) {
    writer.addRowBatch(batch);
  }
  batch.reset();
  batch.size=3;
  setUnion(batch,0,null,0,0,null,null);
  setUnion(batch,1,null,0,10,null,null);
  setUnion(batch,2,null,0,138,null,null);
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(5,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,true};
  included=OrcUtils.includeColumns("time,decimal",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,true,true,true,false};
  included=OrcUtils.includeColumns("union",schema);
  assertEquals(true,Arrays.equals(expected,included));
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(5077,reader.getNumberOfRows());
  DecimalColumnStatistics stats=(DecimalColumnStatistics)reader.getStatistics()[5];
  assertEquals(71,stats.getNumberOfValues());
  assertEquals(HiveDecimal.create("-5643.234"),stats.getMinimum());
  assertEquals(maxValue,stats.getMaximum());
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  assertEquals(reader.getContentLength(),currentOffset);
  RecordReader rows=reader.rows();
  assertEquals(0,rows.getRowNumber());
  assertEquals(0.0,rows.getProgress(),0.000001);
  assertEquals(true,rows.hasNext());
  OrcStruct row=(OrcStruct)rows.next(null);
  assertEquals(1,rows.getRowNumber());
  ObjectInspector inspector=reader.getObjectInspector();
  assertEquals("struct<time:timestamp,union:uniontype<int,string>,decimal:decimal(38,18)>",inspector.getTypeName());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")),row.getFieldValue(0));
  OrcUnion union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(new IntWritable(42),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("12345678.6547456")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(2,rows.getRowNumber());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(null,row.getFieldValue(1));
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")),row.getFieldValue(0));
  assertEquals(new IntWritable(200000),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("10000000000000000000")),row.getFieldValue(2));
  rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)),row.getFieldValue(0));
    if ((i & 1) == 0) {
      assertEquals(0,union.getTag());
      assertEquals(new IntWritable(i * i),union.getObject());
    }
 else {
      assertEquals(1,union.getTag());
      assertEquals(new Text(Integer.toString(i * i)),union.getObject());
    }
    assertEquals(new HiveDecimalWritable(HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18))),row.getFieldValue(2));
  }
  for (int i=0; i < 5000; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new IntWritable(1732050807),union.getObject());
  }
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(0),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(10),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(138),union.getObject());
  assertEquals(false,rows.hasNext());
  assertEquals(1.0,rows.getProgress(),0.00001);
  assertEquals(reader.getNumberOfRows(),rows.getRowNumber());
  rows.seekToRow(1);
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test maps and how they interact with the child column. In particular,
 * put nulls between back to back lists and then make some lists that
 * oper lap.
 * @throws Exception
 */
@Test public void testMaps() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("map",TypeDescription.createMap(TypeDescription.createLong(),TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  MapColumnVector map=(MapColumnVector)batch.cols[0];
  map.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      map.isNull[r]=true;
    }
 else     if (r < 300) {
      map.offsets[r]=r - 200;
      map.lengths[r]=1;
    }
 else     if (r < 400) {
      map.isNull[r]=true;
    }
 else     if (r < 500) {
      map.offsets[r]=r - 300;
      map.lengths[r]=1;
    }
 else     if (r < 600) {
      map.isNull[r]=true;
    }
 else     if (r < 700) {
      map.offsets[r]=r;
      map.lengths[r]=2;
    }
 else {
      map.isNull[r]=true;
    }
    ((LongColumnVector)map.keys).vector[r]=r;
    ((LongColumnVector)map.values).vector[r]=r * 10;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    Map inner=(Map)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"{" + (r - 200) + "="+ ((r - 200) * 10)+ "}",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 500) {
      assertEquals("row " + r,"{" + (r - 300) + "="+ ((r - 300) * 10)+ "}",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 700) {
      assertEquals("row " + r,"{" + r + "="+ (r * 10)+ ", "+ (r + 1)+ "="+ (10 * (r + 1))+ "}",inner.toString());
    }
 else {
      assertEquals("row " + r,null,inner);
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=2;
  setBigRow(batch,0,false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map());
  setBigRow(batch,1,true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib")));
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(23,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertArrayEquals(expected,included);
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertArrayEquals(expected,included);
  expected=new boolean[]{false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,byte1,short1,int1,long1,float1,double1,bytes1,string1,middle,list,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  StripeStatistics ss=reader.getStripeStatistics().get(0);
  assertEquals(2,ss.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)ss.getColumnStatistics()[1]).getTrueCount());
  assertEquals(1024,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMinimum());
  assertEquals(2048,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMaximum());
  assertEquals(3072,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getSum());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.ppr.TestPositivePartitionPrunerCompactExpr </h4><pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactExpr(){
  ExprNodeDesc actual=PartitionPruner.compactExpr(expression);
  if (expected == null) {
    assertNull(actual);
  }
 else {
    assertNotNull("Expected not NULL expression",actual);
    assertNotNull("Expected not NULL expression string",actual.getExprString());
    assertEquals(expected,actual.getExprString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.authorization.plugin.sqlstd.TestOperation2Privilege </h4><pre class="type-12 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test that all enums in {@link HiveOperationType} match one map entry in
 * Operation2Privilege
 */
@Test public void checkHiveOperationTypeMatch(){
  Set<HiveOperationType> operationMapKeys=Operation2Privilege.getOperationTypes();
  for (  HiveOperationType operationType : HiveOperationType.values()) {
    if (!operationMapKeys.contains(operationType)) {
      fail("Unable to find corresponding entry in Operation2Privilege map for HiveOperationType " + operationType);
    }
  }
  assertEquals("Check if Operation2Privilege, HiveOperationType have same number of instances",operationMapKeys.size(),HiveOperationType.values().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestReadEntityDirect </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as direct, as it is also accessed
 * directly in the join query
 * @throws ParseException
 */
@Test public void testSelectEntityViewDirectJoin() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1 join t1 on (v1.i = t1.i)");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as indirect
 * @throws ParseException
 */
@Test public void testSelectEntityInDirect() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertFalse("not direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as direct, as it is also accessed
 * directly in the union-all query
 * @throws ParseException
 */
@Test public void testSelectEntityViewDirectUnion() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from ( select * from v1 union all select * from t1) uv1t1");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as indirect. Query with join of views and aliases
 * @throws ParseException
 */
@Test public void testSelectEntityInDirectJoinAlias() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1 as a join v1 as b on (a.i = b.i)");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertFalse("not direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCleaner </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorTableCompaction() throws Exception {
  Table t=newTable("default","camitc",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addDeltaFile(t,null,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camitc",CompactionType.MINOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path p : paths) {
    if (p.getName().equals("base_20"))     sawBase=true;
 else     if (p.getName().equals(makeDeltaDirName(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + p.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorPartitionCompaction() throws Exception {
  Table t=newTable("default","camipc",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addDeltaFile(t,p,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camipc",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path path : paths) {
    if (path.getName().equals("base_20"))     sawBase=true;
 else     if (path.getName().equals(makeDeltaDirNameCompacted(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + path.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCompactor </h4><pre class="type-11 type-12 type-3 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void minorCompactAfterAbort() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MINOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.deltaFileFilter);
    String[] names=new String[stat.length];
    Path resultDelta=null;
    for (int i=0; i < names.length; i++) {
      names[i]=stat[i].getPath().getName();
      if (names[i].equals("delta_0000001_0000006")) {
        resultDelta=stat[i].getPath();
      }
    }
    Arrays.sort(names);
    String[] expected=new String[]{"delta_0000001_0000002","delta_0000001_0000006","delta_0000003_0000004","delta_0000005_0000006"};
    if (!Arrays.deepEquals(expected,names)) {
      Assert.fail("Expected: " + Arrays.toString(expected) + ", found: "+ Arrays.toString(names));
    }
    checkExpectedTxnsPresent(null,new Path[]{resultDelta},columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void majorCompactAfterAbort() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("majorCompactAfterAbort FileStatus[] stat " + Arrays.toString(stat));
    }
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000006\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    if (!name.equals("base_0000006")) {
      Assert.fail("majorCompactAfterAbort name " + name + " not equals to base_0000006");
    }
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * After each major compaction, stats need to be updated on each column of the
 * table/partition which previously had stats.
 * 1. create a bucketed ORC backed table (Orc is currently required by ACID)
 * 2. populate 2 partitions with data
 * 3. compute stats
 * 4. insert some data into the table using StreamingAPI
 * 5. Trigger major compaction (which should update stats)
 * 6. check that stats have been updated
 * @throws Exceptiontodo:
 * 2. add non-partitioned test
 * 4. add a test with sorted table?
 */
@Test public void testStatsAfterCompactionPartTbl() throws Exception {
  String tblName="compaction_test";
  String tblNameStg=tblName + "_stg";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("drop table if exists " + tblNameStg,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(bkt INT)"+ " CLUSTERED BY(a) INTO 4 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("CREATE EXTERNAL TABLE " + tblNameStg + "(a INT, b STRING)"+ " ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t' LINES TERMINATED BY '\\n'"+ " STORED AS TEXTFILE"+ " LOCATION '"+ stagingFolder.newFolder().toURI().getPath()+ "'"+ " TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("load data local inpath '" + BASIC_FILE_NAME + "' overwrite into table "+ tblNameStg,driver);
  execSelectAndDumpData("select * from " + tblNameStg,driver,"Dumping data for " + tblNameStg + " after load:");
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=0) "+ "SELECT a, b where a < 2",driver);
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=1) "+ "SELECT a, b where a >= 2",driver);
  execSelectAndDumpData("select * from " + tblName,driver,"Dumping data for " + tblName + " after load:");
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  CompactionInfo ci=new CompactionInfo("default",tblName,"bkt=0",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  Worker.StatsUpdater su=Worker.StatsUpdater.init(ci,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  CompactionInfo ciPart2=new CompactionInfo("default",tblName,"bkt=1",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  su=Worker.StatsUpdater.init(ciPart2,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  Map<String,List<ColumnStatisticsObj>> stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  List<ColumnStatisticsObj> colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  LongColumnStatsData colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",1,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",1,colAStats.getNumDVs());
  StringColumnStatsData colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",3,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",3.0,colBStats.getAvgColLen(),0.01);
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",2,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  LongColumnStatsData colAStatsPart2=colStats.get(0).getStatsData().getLongStats();
  StringColumnStatsData colBStatsPart2=colStats.get(1).getStatsData().getStringStats();
  HiveEndPoint endPt=new HiveEndPoint(null,ci.dbname,ci.tableName,Arrays.asList("0"));
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(true);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  Assert.assertEquals(TransactionBatch.TxnState.OPEN,txnBatch.getCurrentTransactionState());
  txnBatch.write("50,Kiev".getBytes());
  txnBatch.write("51,St. Petersburg".getBytes());
  txnBatch.write("44,Boston".getBytes());
  txnBatch.commit();
  txnBatch.beginNextTransaction();
  txnBatch.write("52,Tel Aviv".getBytes());
  txnBatch.write("53,Atlantis".getBytes());
  txnBatch.write("53,Boston".getBytes());
  txnBatch.commit();
  txnBatch.close();
  connection.close();
  execSelectAndDumpData("select * from " + ci.getFullTableName(),driver,ci.getFullTableName());
  CompactionRequest rqst=new CompactionRequest(ci.dbname,ci.tableName,CompactionType.MAJOR);
  rqst.setPartitionname(ci.partName);
  txnHandler.compact(rqst);
  Worker t=new Worker();
  t.setThreadId((int)t.getId());
  t.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  t.init(stop,looped);
  t.run();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  if (1 != compacts.size()) {
    Assert.fail("Expecting 1 file and found " + compacts.size() + " files "+ compacts.toString());
  }
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",53,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",6,colAStats.getNumDVs());
  colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",14,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",(long)6.1111111111,(long)colBStats.getAvgColLen());
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",10,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colAStatsPart2,colStats.get(0).getStatsData().getLongStats());
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colBStatsPart2,colStats.get(1).getStatsData().getStringStats());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true') ",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000004\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    Assert.assertEquals(name,"base_0000004");
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void minorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MINOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.deltaFileFilter);
    String[] names=new String[stat.length];
    Path resultFile=null;
    for (int i=0; i < names.length; i++) {
      names[i]=stat[i].getPath().getName();
      if (names[i].equals("delta_0000001_0000004")) {
        resultFile=stat[i].getPath();
      }
    }
    Arrays.sort(names);
    String[] expected=new String[]{"delta_0000001_0000002","delta_0000001_0000004","delta_0000003_0000004","delta_0000005_0000006"};
    if (!Arrays.deepEquals(expected,names)) {
      Assert.fail("Expected: " + Arrays.toString(expected) + ", found: "+ Arrays.toString(names));
    }
    checkExpectedTxnsPresent(null,new Path[]{resultFile},columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestInitiator </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recoverFailedLocalWorkers() throws Exception {
  Table t=newTable("default","rflw1",false);
  CompactionRequest rqst=new CompactionRequest("default","rflw1",CompactionType.MINOR);
  txnHandler.compact(rqst);
  t=newTable("default","rflw2",false);
  rqst=new CompactionRequest("default","rflw2",CompactionType.MINOR);
  txnHandler.compact(rqst);
  txnHandler.findNextToCompact(Worker.hostname() + "-193892");
  txnHandler.findNextToCompact("nosuchhost-193892");
  startInitiator();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  boolean sawInitiated=false;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working")) {
      Assert.assertEquals("nosuchhost-193892",c.getWorkerid());
    }
 else     if (c.getState().equals("initiated")) {
      sawInitiated=true;
    }
 else {
      Assert.fail("Unexpected state");
    }
  }
  Assert.assertTrue(sawInitiated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestWorker </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringableList() throws Exception {
  CompactorMR.StringableList ls=new CompactorMR.StringableList();
  String s=ls.toString();
  Assert.assertEquals("0:",s);
  ls=new CompactorMR.StringableList(s);
  Assert.assertEquals(0,ls.size());
  ls=new CompactorMR.StringableList();
  ls.add(new Path("/tmp"));
  ls.add(new Path("/usr"));
  s=ls.toString();
  Assert.assertTrue("Expected 2:4:/tmp4:/usr or 2:4:/usr4:/tmp, got " + s,"2:4:/tmp4:/usr".equals(s) || "2:4:/usr4:/tmp".equals(s));
  ls=new CompactorMR.StringableList(s);
  Assert.assertEquals(2,ls.size());
  boolean sawTmp=false, sawUsr=false;
  for (  Path p : ls) {
    if ("/tmp".equals(p.toString()))     sawTmp=true;
 else     if ("/usr".equals(p.toString()))     sawUsr=true;
 else     Assert.fail("Unexpected path " + p.toString());
  }
  Assert.assertTrue(sawTmp);
  Assert.assertTrue(sawUsr);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableWithBase() throws Exception {
  LOG.debug("Starting minorTableWithBase");
  Table t=newTable("default","mtwb",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mtwb",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBase() throws Exception {
  LOG.debug("Starting majorPartitionWithBase");
  Table t=newTable("default","mapwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mapwb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorPartitionWithBase() throws Exception {
  Table t=newTable("default","mpwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mpwb",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableLegacy() throws Exception {
  LOG.debug("Starting minorTableLegacy");
  Table t=newTable("default","mtl",false);
  addLegacyFile(t,null,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mtl",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableNoBase() throws Exception {
  LOG.debug("Starting minorTableWithBase");
  Table t=newTable("default","mtnb",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(5);
  CompactionRequest rqst=new CompactionRequest("default","mtnb",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(3,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(1,4))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBaseMissingBuckets() throws Exception {
  LOG.debug("Starting majorPartitionWithBaseMissingBuckets");
  Table t=newTable("default","mapwbmb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20,2,false);
  addDeltaFile(t,p,21L,22L,2,2,false);
  addDeltaFile(t,p,23L,26L,4);
  burnThroughTransactions(27);
  CompactionRequest rqst=new CompactionRequest("default","mapwbmb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000026")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(("bucket_00000".equals(buckets[0].getPath().getName()) && 104L == buckets[0].getLen() && "bucket_00001".equals(buckets[1].getPath().getName()) && 676L == buckets[1].getLen()) || ("bucket_00000".equals(buckets[1].getPath().getName()) && 104L == buckets[1].getLen() && "bucket_00001".equals(buckets[0].getPath().getName()) && 676L == buckets[0].getLen()));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableWithBase() throws Exception {
  LOG.debug("Starting majorTableWithBase");
  Table t=newTable("default","matwb",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","matwb",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringableMap() throws Exception {
  CompactorMR.StringableMap m=new CompactorMR.StringableMap(new HashMap<String,String>());
  String s=m.toString();
  Assert.assertEquals("0:",s);
  m=new CompactorMR.StringableMap(s);
  Assert.assertEquals(0,m.size());
  Map<String,String> base=new HashMap<String,String>();
  base.put("mary","poppins");
  base.put("bert",null);
  base.put(null,"banks");
  m=new CompactorMR.StringableMap(base);
  s=m.toString();
  m=new CompactorMR.StringableMap(s);
  Assert.assertEquals(3,m.size());
  Map<String,Boolean> saw=new HashMap<String,Boolean>(3);
  saw.put("mary",false);
  saw.put("bert",false);
  saw.put(null,false);
  for (  Map.Entry<String,String> e : m.entrySet()) {
    saw.put(e.getKey(),true);
    if ("mary".equals(e.getKey()))     Assert.assertEquals("poppins",e.getValue());
 else     if ("bert".equals(e.getKey()))     Assert.assertNull(e.getValue());
 else     if (null == e.getKey())     Assert.assertEquals("banks",e.getValue());
 else     Assert.fail("Unexpected value " + e.getKey());
  }
  Assert.assertEquals(3,saw.size());
  Assert.assertTrue(saw.get("mary"));
  Assert.assertTrue(saw.get("bert"));
  Assert.assertTrue(saw.get(null));
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableLegacy() throws Exception {
  LOG.debug("Starting majorTableLegacy");
  Table t=newTable("default","matl",false);
  addLegacyFile(t,null,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","matl",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableNoBase() throws Exception {
  LOG.debug("Starting majorTableNoBase");
  Table t=newTable("default","matnb",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(4);
  CompactionRequest rqst=new CompactionRequest("default","matnb",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(3,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000004")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(104L,buckets[0].getLen());
      Assert.assertEquals(104L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.xml.TestReusableStringReader </h4><pre class="type-11 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkReset() throws IOException {
  Reader reader=new ReusableStringReader();
  if (reader.markSupported()) {
    ((ReusableStringReader)reader).set(fox);
    assertTrue(reader.ready());
    char[] cc=new char[6];
    int read;
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("Quick ",new String(cc));
    reader.mark(100);
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("brown ",new String(cc));
    reader.reset();
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("brown ",new String(cc));
  }
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeeLineWithArgs </h4><pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Attempt to execute a missing script file with the -f option to BeeLine
 */
@Test public void testNegativeScriptFile() throws Throwable {
  final String EXPECTED_PATTERN=" default ";
  File scriptFile=File.createTempFile("beelinenegative","temp");
  scriptFile.delete();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("-f");
  argList.add(scriptFile.getAbsolutePath());
  try {
    String output=testCommandLineScript(argList,null);
    if (output.contains(EXPECTED_PATTERN)) {
      fail("Output: " + output + " Negative pattern: "+ EXPECTED_PATTERN);
    }
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeelineArgParsing </h4><pre class="type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddLocalJarWithoutAddDriverClazz() throws Exception {
  TestBeeline bl=new TestBeeline();
  LOG.info("Add " + driverJarFileName + " for the driver class "+ driverClazzName);
  bl.addLocalJar(driverJarFileName);
  if (!defaultSupported) {
    Assert.assertNull(bl.findLocalDriver(connectionString));
  }
 else {
    Assert.assertEquals(bl.findLocalDriver(connectionString).getClass().getName(),driverClazzName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClient </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicDDLCommands() throws Exception {
  String db="testdb";
  String tableOne="testTable1";
  String tableTwo="testTable2";
  String tableThree="testTable3";
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  client.dropDatabase(db,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(db).ifNotExists(false).build();
  client.createDatabase(dbDesc);
  List<String> dbNames=client.listDatabaseNamesByPattern("*");
  assertTrue(dbNames.contains("default"));
  assertTrue(dbNames.contains(db));
  HCatDatabase testDb=client.getDatabase(db);
  assertTrue(testDb.getComment() == null);
  assertTrue(testDb.getProperties().size() == 0);
  String warehouseDir=System.getProperty("test.warehouse.dir","/user/hive/warehouse");
  if (useExternalMS) {
    assertTrue(testDb.getLocation().matches(".*" + "/" + db + ".db"));
  }
 else {
    String expectedDir=warehouseDir.replaceFirst("pfile:///","pfile:/");
    assertEquals(expectedDir + "/" + db+ ".db",testDb.getLocation());
  }
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id comment"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"value comment"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(db,tableOne,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  HCatTable table1=client.getTable(db,tableOne);
  assertTrue(table1.getInputFileFormat().equalsIgnoreCase(RCFileInputFormat.class.getName()));
  assertTrue(table1.getOutputFileFormat().equalsIgnoreCase(RCFileOutputFormat.class.getName()));
  assertTrue(table1.getSerdeLib().equalsIgnoreCase(LazyBinaryColumnarSerDe.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  try {
    client.createTable(tableDesc);
    fail("Expected exception");
  }
 catch (  HCatException e) {
    assertTrue(e.getMessage().contains("AlreadyExistsException while creating table."));
  }
  client.dropTable(db,tableOne,true);
  HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(db,tableTwo,cols).fieldsTerminatedBy('\001').escapeChar('\002').linesTerminatedBy('\003').mapKeysTerminatedBy('\004').collectionItemsTerminatedBy('\005').nullDefinedAs('\006').build();
  client.createTable(tableDesc2);
  HCatTable table2=client.getTable(db,tableTwo);
  assertTrue("Expected TextInputFormat, but got: " + table2.getInputFileFormat(),table2.getInputFileFormat().equalsIgnoreCase(TextInputFormat.class.getName()));
  assertTrue(table2.getOutputFileFormat().equalsIgnoreCase(HiveIgnoreKeyTextOutputFormat.class.getName()));
  assertTrue("SerdeParams not found",table2.getSerdeParams() != null);
  assertEquals("checking " + serdeConstants.FIELD_DELIM,Character.toString('\001'),table2.getSerdeParams().get(serdeConstants.FIELD_DELIM));
  assertEquals("checking " + serdeConstants.ESCAPE_CHAR,Character.toString('\002'),table2.getSerdeParams().get(serdeConstants.ESCAPE_CHAR));
  assertEquals("checking " + serdeConstants.LINE_DELIM,Character.toString('\003'),table2.getSerdeParams().get(serdeConstants.LINE_DELIM));
  assertEquals("checking " + serdeConstants.MAPKEY_DELIM,Character.toString('\004'),table2.getSerdeParams().get(serdeConstants.MAPKEY_DELIM));
  assertEquals("checking " + serdeConstants.COLLECTION_DELIM,Character.toString('\005'),table2.getSerdeParams().get(serdeConstants.COLLECTION_DELIM));
  assertEquals("checking " + serdeConstants.SERIALIZATION_NULL_FORMAT,Character.toString('\006'),table2.getSerdeParams().get(serdeConstants.SERIALIZATION_NULL_FORMAT));
  assertTrue(table2.getLocation().toLowerCase().matches(".*" + ("/" + db + ".db/"+ tableTwo).toLowerCase()));
  HCatCreateTableDesc tableDesc3=HCatCreateTableDesc.create(db,tableThree,cols).fileFormat("orcfile").build();
  client.createTable(tableDesc3);
  HCatTable table3=client.getTable(db,tableThree);
  assertTrue(table3.getInputFileFormat().equalsIgnoreCase(OrcInputFormat.class.getName()));
  assertTrue(table3.getOutputFileFormat().equalsIgnoreCase(OrcOutputFormat.class.getName()));
  assertTrue(table3.getSerdeLib().equalsIgnoreCase(OrcSerde.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClientNotification </h4><pre class="type-12 type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  long now=System.currentTimeMillis() / 1000;
  startTime=0;
  if (now > Integer.MAX_VALUE)   fail("Bummer, time has fallen over the edge");
 else   startTime=(int)now;
  firstEventId=hCatClient.getCurrentNotificationEventId();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.cli.TestSemanticAnalysis </h4><pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseOperations() throws MetaException, CommandNeedRetryException {
  List<String> dbs=client.getAllDatabases();
  String testDb1="testdatabaseoperatons1";
  String testDb2="testdatabaseoperatons2";
  if (dbs.contains(testDb1.toLowerCase())) {
    assertEquals(0,hcatDriver.run("drop database " + testDb1).getResponseCode());
  }
  if (dbs.contains(testDb2.toLowerCase())) {
    assertEquals(0,hcatDriver.run("drop database " + testDb2).getResponseCode());
  }
  assertEquals(0,hcatDriver.run("create database " + testDb1).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb1));
  assertEquals(0,hcatDriver.run("create database if not exists " + testDb1).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb1));
  assertEquals(0,hcatDriver.run("create database if not exists " + testDb2).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb2));
  assertEquals(0,hcatDriver.run("drop database " + testDb1).getResponseCode());
  assertEquals(0,hcatDriver.run("drop database " + testDb2).getResponseCode());
  assertFalse(client.getAllDatabases().contains(testDb1));
  assertFalse(client.getAllDatabases().contains(testDb2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.common.TestHCatUtil </h4><pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFsPermissionOperation(){
  HashMap<String,Integer> permsCode=new HashMap<String,Integer>();
  for (int i=0; i < 8; i++) {
    for (int j=0; j < 8; j++) {
      for (int k=0; k < 8; k++) {
        StringBuilder sb=new StringBuilder();
        sb.append("0");
        sb.append(i);
        sb.append(j);
        sb.append(k);
        Integer code=(((i * 8) + j) * 8) + k;
        String perms=(new FsPermission(Short.decode(sb.toString()))).toString();
        if (permsCode.containsKey(perms)) {
          Assert.assertEquals("permissions(" + perms + ") mapped to multiple codes",code,permsCode.get(perms));
        }
        permsCode.put(perms,code);
        assertFsPermissionTransformationIsGood(perms);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.listener.TestDbNotificationListener </h4><pre class="type-12 type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  long now=System.currentTimeMillis() / 1000;
  startTime=0;
  if (now > Integer.MAX_VALUE)   fail("Bummer, time has fallen over the edge");
 else   startTime=(int)now;
  firstEventId=msClient.getCurrentNotificationEventId().getEventId();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatNonPartitioned </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatNonPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  runMRCreate(null,partitionColumns,writeRecords,10,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(null,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_NON_EMPTY_TABLE,((HCatException)exc).getErrorType());
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc != null);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  }
  if (isTableImmutable()) {
    runMRRead(10);
  }
 else {
    runMRRead(30);
  }
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatPartitionPublish </h4><pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionPublish() throws Exception {
  String dbName="default";
  String tableName="testHCatPartitionedTable";
  createTable(null,tableName);
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","p0value1");
  ArrayList<HCatFieldSchema> hcatTableColumns=new ArrayList<HCatFieldSchema>();
  for (  FieldSchema fs : getTableColumns()) {
    hcatTableColumns.add(HCatSchemaUtils.getHCatFieldSchema(fs));
  }
  runMRCreateFail(dbName,tableName,partitionMap,hcatTableColumns);
  List<String> ptns=msc.listPartitionNames(dbName,tableName,(short)10);
  Assert.assertEquals(0,ptns.size());
  Table table=msc.getTable(dbName,tableName);
  Assert.assertTrue(table != null);
  if (!Shell.WINDOWS) {
    Path path=new Path(table.getSd().getLocation() + "/part1=p1value1/part0=p0value1");
    Assert.assertFalse(path.getFileSystem(conf).exists(path));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatPartitioned </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","501");
  runMRCreate(partitionMap,partitionColumns,writeRecords,10,true);
  partitionMap.clear();
  partitionMap.put("PART1","p1value2");
  partitionMap.put("PART0","502");
  runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertTrue(ErrorType.ERROR_DUPLICATE_PARTITION.equals(((HCatException)exc).getErrorType()));
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px1","p1value2");
  partitionMap.put("px0","502");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertNotNull(exc);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_MISSING_PARTITION_KEY,((HCatException)exc).getErrorType());
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","512");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertNotNull(exc);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  exc=null;
  try {
    runMRCreate(null,partitionColumns,writeRecords,20,false);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc == null);
  if (isTableImmutable()) {
    runMRRead(30);
  }
 else {
    runMRRead(50);
  }
  runMRRead(10,"part1 = \"p1value1\"");
  runMRRead(10,"part0 = \"501\"");
  if (isTableImmutable()) {
    runMRRead(20,"part1 = \"p1value2\"");
    runMRRead(30,"part1 = \"p1value1\" or part1 = \"p1value2\"");
    runMRRead(20,"part0 = \"502\"");
    runMRRead(30,"part0 = \"501\" or part0 = \"502\"");
  }
 else {
    runMRRead(40,"part1 = \"p1value2\"");
    runMRRead(50,"part1 = \"p1value1\" or part1 = \"p1value2\"");
    runMRRead(40,"part0 = \"502\"");
    runMRRead(50,"part0 = \"501\" or part0 = \"502\"");
  }
  tableSchemaTest();
  columnOrderChangeTest();
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoader </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadPartitionedBasic() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),valuesReadFromHiveDriver.size());
  server.registerQuery("W = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedWSchema=server.dumpSchema("W");
  List<FieldSchema> Wfields=dumpedWSchema.getFields();
  assertEquals(3,Wfields.size());
  assertTrue(Wfields.get(0).alias.equalsIgnoreCase("a"));
  assertTrue(Wfields.get(0).type == DataType.INTEGER);
  assertTrue(Wfields.get(1).alias.equalsIgnoreCase("b"));
  assertTrue(Wfields.get(1).type == DataType.CHARARRAY);
  assertTrue(Wfields.get(2).alias.equalsIgnoreCase("bkt"));
  assertTrue(Wfields.get(2).type == DataType.CHARARRAY);
  Iterator<Tuple> WIter=server.openIterator("W");
  Collection<Pair<Integer,String>> valuesRead=new ArrayList<Pair<Integer,String>>();
  while (WIter.hasNext()) {
    Tuple t=WIter.next();
    assertTrue(t.size() == 3);
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertNotNull(t.get(2));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertTrue(t.get(2).getClass() == String.class);
    valuesRead.add(new Pair<Integer,String>((Integer)t.get(0),(String)t.get(1)));
    if ((Integer)t.get(0) < 2) {
      assertEquals("0",t.get(2));
    }
 else {
      assertEquals("1",t.get(2));
    }
  }
  assertEquals(valuesReadFromHiveDriver.size(),valuesRead.size());
  server.registerQuery("P1 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P1filter = filter P1 by bkt == '0';");
  Iterator<Tuple> P1Iter=server.openIterator("P1filter");
  int count1=0;
  while (P1Iter.hasNext()) {
    Tuple t=P1Iter.next();
    assertEquals("0",t.get(2));
    assertEquals(1,t.get(0));
    count1++;
  }
  assertEquals(3,count1);
  server.registerQuery("P2 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P2filter = filter P2 by bkt == '1';");
  Iterator<Tuple> P2Iter=server.openIterator("P2filter");
  int count2=0;
  while (P2Iter.hasNext()) {
    Tuple t=P2Iter.next();
    assertEquals("1",t.get(2));
    assertTrue(((Integer)t.get(0)) > 1);
    count2++;
  }
  assertEquals(6,count2);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertBooleanToInt() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  String tbl="test_convert_boolean_to_int";
  String inputFileName=TEST_DATA_DIR + "/testConvertBooleanToInt/data.txt";
  File inputDataDir=new File(inputFileName).getParentFile();
  inputDataDir.mkdir();
  String[] lines=new String[]{"llama\ttrue","alpaca\tfalse"};
  HcatTestUtils.createTestDataFile(inputFileName,lines);
  assertEquals(0,driver.run("drop table if exists " + tbl).getResponseCode());
  assertEquals(0,driver.run("create external table " + tbl + " (a string, b boolean) row format delimited fields terminated by '\t'"+ " stored as textfile location 'file:///"+ inputDataDir.getPath().replaceAll("\\\\","/")+ "'").getResponseCode());
  Properties properties=new Properties();
  properties.setProperty(HCatConstants.HCAT_DATA_CONVERT_BOOLEAN_TO_INTEGER,"true");
  PigServer server=new PigServer(ExecType.LOCAL,properties);
  server.registerQuery("data = load 'test_convert_boolean_to_int' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  assertEquals(2,schema.getFields().size());
  assertEquals("a",schema.getField(0).alias);
  assertEquals(DataType.CHARARRAY,schema.getField(0).type);
  assertEquals("b",schema.getField(1).alias);
  if (PigHCatUtil.pigHasBooleanSupport()) {
    assertEquals(DataType.BOOLEAN,schema.getField(1).type);
  }
 else {
    assertEquals(DataType.INTEGER,schema.getField(1).type);
  }
  Iterator<Tuple> iterator=server.openIterator("data");
  Tuple t=iterator.next();
  assertEquals("llama",t.get(0));
  assertEquals(1,t.get(1));
  t=iterator.next();
  assertEquals("alpaca",t.get(0));
  assertEquals(0,t.get(1));
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorer </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncAllSimpleTypes() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b float, c double, d bigint, e string, h boolean, f binary, g binary) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int i=0;
  String[] input=new String[3];
  input[i++]="0\t\t\t\t\t\t\t";
  input[i++]="\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "true" + "\tbinary-data";
  input[i++]=i + "\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "false" + "\tbinary-data";
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  Iterator<String> itr=res.iterator();
  String next=itr.next();
  assertEquals("0\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL",next);
  assertEquals("NULL\t4.2\t2.2\t4\tlets hcat\ttrue\tbinary-data\tNULL",itr.next());
  assertEquals("3\t6.2999997\t3.3000000000000003\t6\tlets hcat\tfalse\tbinary-data\tNULL",itr.next());
  assertFalse(itr.hasNext());
  server.registerQuery("B = load 'junit_unparted' using " + HCatLoader.class.getName() + ";");
  Iterator<Tuple> iter=server.openIterator("B");
  int count=0;
  int num5nulls=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    if (t.get(6) == null) {
      num5nulls++;
    }
 else {
      assertTrue(t.get(6) instanceof DataByteArray);
    }
    assertNull(t.get(7));
    count++;
  }
  assertEquals(3,count);
  assertEquals(1,num5nulls);
  driver.run("drop table junit_unparted");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestStreaming </h4><pre class="type-12 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testConcurrentTransactionBatchCommits() throws Exception {
  final HiveEndPoint ep=new HiveEndPoint(metaStoreURI,dbName,tblName,partitionVals);
  List<WriterThd> writers=new ArrayList<WriterThd>(3);
  writers.add(new WriterThd(ep,"1,Matrix"));
  writers.add(new WriterThd(ep,"2,Gandhi"));
  writers.add(new WriterThd(ep,"3,Silence"));
  for (  WriterThd w : writers) {
    w.start();
  }
  for (  WriterThd w : writers) {
    w.join();
  }
  for (  WriterThd w : writers) {
    if (w.error != null) {
      Assert.assertFalse("Writer thread" + w.getName() + " died: "+ w.error.getMessage()+ " See log file for stack trace",true);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcDriver2 </h4><pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},8);
  tests.put(new String[]{"testhiveJDBC%",null},8);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,"default",checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniMr </h4><pre class="type-11 type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempTable() throws Exception {
  String tempTableName="tmp1";
  stmt.execute("CREATE TEMPORARY TABLE " + tempTableName + " (key string, value string)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tempTableName);
  String resultVal="val_238";
  String queryStr="SELECT * FROM " + tempTableName + " where value = '"+ resultVal+ "'";
  verifyResult(queryStr,resultVal,2);
  DatabaseMetaData md=hs2Conn.getMetaData();
  assertTrue(md.getConnection() == hs2Conn);
  ResultSet rs=md.getTables(null,null,tempTableName,null);
  boolean foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getTables(null,null,null,null);
  foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getColumns(null,null,tempTableName,null);
  assertTrue("First row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("key"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  assertTrue("Second row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("value"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  boolean gotException=false;
  try {
    ResultSet res;
    res=stmt2.executeQuery(queryStr);
  }
 catch (  SQLException err) {
    assertTrue("Expecting table not found error, instead got: " + err,err.getMessage().contains("Table not found"));
    gotException=true;
  }
  assertTrue("Exception while querying non-existing temp table",gotException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.cbo_rp_TestJdbcDriver2 </h4><pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},7);
  tests.put(new String[]{"testhiveJDBC%",null},7);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,null,checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.TestHS2ImpersonationWithRemoteMS </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImpersonation() throws Exception {
  assertTrue("Test setup failed. MiniHS2 is not initialized",miniHS2 != null && miniHS2.isStarted());
  Class.forName(MiniHS2.getJdbcDriverName());
  Connection hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"foo",null);
  Statement stmt=hs2Conn.createStatement();
  String tableName="foo_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"bar",null);
  stmt=hs2Conn.createStatement();
  tableName="bar_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  MiniDFSShim dfs=miniHS2.getDfs();
  FileSystem fs=dfs.getFileSystem();
  FileStatus[] files=fs.listStatus(miniHS2.getWareHouseDir());
  boolean fooTableValidated=false;
  boolean barTableValidated=false;
  for (  FileStatus file : files) {
    final String name=file.getPath().getName();
    final String owner=file.getOwner();
    if (name.equals("foo_table")) {
      fooTableValidated=owner.equals("foo");
      assertTrue(String.format("User 'foo' table has wrong ownership '%s'",owner),fooTableValidated);
    }
 else     if (name.equals("bar_table")) {
      barTableValidated=owner.equals("bar");
      assertTrue(String.format("User 'bar' table has wrong ownership '%s'",owner),barTableValidated);
    }
 else {
      fail(String.format("Unexpected table directory '%s' in warehouse",name));
    }
    System.out.println(String.format("File: %s, Owner: %s",name,owner));
  }
  assertTrue("User 'foo' table not found in warehouse",fooTableValidated);
  assertTrue("User 'bar' table not found in warehouse",barTableValidated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceTest </h4><pre class="type-11 type-6 type-12 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalCompileLockTimeout() throws Exception {
  String tableName="TEST_COMPILE_LOCK_TIMEOUT";
  String columnDefinitions="(ID STRING)";
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,new HashMap<String,String>());
  assertNotNull(sessionHandle);
  int THREAD_COUNT=3;
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=(FutureTask<Void>[])new FutureTask[THREAD_COUNT];
  long longPollingTimeoutMs=10 * 60 * 1000;
  Map<String,String> confOverlay=getConfOverlay(0,longPollingTimeoutMs);
  confOverlay.put(HiveConf.ConfVars.SEMANTIC_ANALYZER_HOOK.varname,CompileLockTestSleepHook.class.getName());
  String query="SELECT 0 FROM " + tableName;
  tasks[0]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[0]).start();
  Thread.sleep(5 * 1000);
  confOverlay=getConfOverlay(1,longPollingTimeoutMs);
  query="SELECT 1 FROM " + tableName;
  tasks[1]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.ERROR,false,null,null));
  new Thread(tasks[1]).start();
  confOverlay=getConfOverlay(100,longPollingTimeoutMs);
  query="SELECT 2 FROM " + tableName;
  tasks[2]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[2]).start();
  boolean foundExpectedException=false;
  for (int i=0; i < THREAD_COUNT; ++i) {
    try {
      tasks[i].get();
    }
 catch (    Throwable t) {
      if (i == 1) {
        assertTrue(t.getMessage().contains(ErrorMsg.COMPILE_LOCK_TIMED_OUT.getMsg()));
        foundExpectedException=true;
      }
 else {
        throw new RuntimeException(t);
      }
    }
  }
  assertTrue(foundExpectedException);
  client.executeStatement(sessionHandle,"DROP TABLE " + tableName,getConfOverlay(0,longPollingTimeoutMs));
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.OperationLoggingAPITestBase </h4><pre class="type-12 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchResultsOfLogCleanup() throws Exception {
  SessionHandle sessionHandleCleanup=setupSession();
  OperationHandle operationHandle=client.executeStatement(sessionHandleCleanup,sql,null);
  RowSet rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  verifyFetchedLog(rowSetLog,expectedLogsVerbose);
  File sessionLogDir=new File(hiveConf.getVar(HiveConf.ConfVars.HIVE_SERVER2_LOGGING_OPERATION_LOG_LOCATION) + File.separator + sessionHandleCleanup.getHandleIdentifier());
  File operationLogFile=new File(sessionLogDir,operationHandle.getHandleIdentifier().toString());
  client.closeOperation(operationHandle);
  try {
    client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
    Assert.fail("Fetch should fail");
  }
 catch (  HiveSQLException e) {
    Assert.assertTrue(e.getMessage().contains("Invalid OperationHandle:"));
  }
  if (operationLogFile.exists()) {
    Assert.fail("Operation log file should be deleted.");
  }
  client.closeSession(sessionHandleCleanup);
  if (sessionLogDir.exists()) {
    Assert.fail("Session log dir should be deleted.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.session.TestHiveSessionImpl </h4><pre class="type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Verifying OperationManager.closeOperation(opHandle) is invoked when
 * get HiveSQLException during sync query
 * @throws HiveSQLException
 */
@Test public void testLeakOperationHandle() throws HiveSQLException {
  TProtocolVersion protocol=TProtocolVersion.HIVE_CLI_SERVICE_PROTOCOL_V2;
  String username="";
  String password="";
  HiveConf serverhiveConf=new HiveConf();
  String ipAddress=null;
  HiveSessionImpl session=new HiveSessionImpl(protocol,username,password,serverhiveConf,ipAddress){
    @Override protected synchronized void acquire(    boolean userAccess){
    }
    @Override protected synchronized void release(    boolean userAccess){
    }
  }
;
  OperationManager operationManager=Mockito.mock(OperationManager.class);
  session.setOperationManager(operationManager);
  ExecuteStatementOperation operation=Mockito.mock(ExecuteStatementOperation.class);
  OperationHandle opHandle=Mockito.mock(OperationHandle.class);
  Mockito.when(operation.getHandle()).thenReturn(opHandle);
  Map<String,String> confOverlay=new HashMap<String,String>();
  String hql="drop table if exists table_not_exists";
  Mockito.when(operationManager.newExecuteStatementOperation(session,hql,confOverlay,true)).thenReturn(operation);
  try {
    session.open(new HashMap<String,String>());
    session.executeStatementAsync(hql,confOverlay);
    Mockito.verify(operationManager,Mockito.times(0)).closeOperation(opHandle);
    Mockito.doThrow(new HiveSQLException("Fail for clean up test")).when(operation).run();
    session.executeStatementAsync(hql,confOverlay);
    Assert.fail("HiveSqlException expected.");
  }
 catch (  HiveSQLException e) {
    if (!"Fail for clean up test".equals(e.getMessage())) {
      Assert.fail("unexpected exception:" + e.getMessage());
    }
    Mockito.verify(operationManager,Mockito.times(1)).closeOperation(opHandle);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestBitFieldReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testBiggerItems() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  final int COUNT=16384;
  BitFieldWriter out=new BitFieldWriter(new OutStream("test",500,null,collect),3);
  for (int i=0; i < COUNT; ++i) {
    if (i < COUNT / 2) {
      out.write(i & 7);
    }
 else {
      out.write((i / 3) & 7);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  BitFieldReader in=new BitFieldReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,500),3);
  for (int i=0; i < COUNT; ++i) {
    int x=in.next();
    if (i < COUNT / 2) {
      assertEquals(i & 7,x);
    }
 else {
      assertEquals((i / 3) & 7,x);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  BitFieldWriter out=new BitFieldWriter(new OutStream("test",100,null,collect),1);
  final int COUNT=16384;
  for (int i=0; i < COUNT; ++i) {
    if (i < COUNT / 2) {
      out.write(i & 1);
    }
 else {
      out.write((i / 3) & 1);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  BitFieldReader in=new BitFieldReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),1);
  for (int i=0; i < COUNT; i+=5) {
    int x=(int)in.next();
    if (i < COUNT / 2) {
      assertEquals(i & 1,x);
    }
 else {
      assertEquals((i / 3) & 1,x);
    }
    if (i < COUNT - 5) {
      in.skip(4);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestIntegerCompressionReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthIntegerWriterV2 out=new RunLengthIntegerWriterV2(new OutStream("test",100,null,collect),true);
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write(i);
    }
 else {
      out.write(256 * i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthIntegerReaderV2 in=new RunLengthIntegerReaderV2(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),true,false);
  for (int i=0; i < 2048; i+=10) {
    int x=(int)in.next();
    if (i < 1024) {
      assertEquals(i,x);
    }
 else {
      assertEquals(256 * i,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestRunLengthByteReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",100,null,collect));
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write((byte)(i / 16));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100));
  for (int i=0; i < 2048; i+=10) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 16) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testUncompressedSeek() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",100,null,collect));
  TestInStream.PositionCollector[] positions=new TestInStream.PositionCollector[2048];
  for (int i=0; i < 2048; ++i) {
    positions[i]=new TestInStream.PositionCollector();
    out.getPosition(positions[i]);
    if (i < 1024) {
      out.write((byte)(i / 4));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100));
  for (int i=0; i < 2048; ++i) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
  for (int i=2047; i >= 0; --i) {
    in.seek(positions[i]);
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCompressedSeek() throws Exception {
  CompressionCodec codec=new SnappyCodec();
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",500,codec,collect));
  TestInStream.PositionCollector[] positions=new TestInStream.PositionCollector[2048];
  for (int i=0; i < 2048; ++i) {
    positions[i]=new TestInStream.PositionCollector();
    out.getPosition(positions[i]);
    if (i < 1024) {
      out.write((byte)(i / 4));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,500));
  for (int i=0; i < 2048; ++i) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
  for (int i=2047; i >= 0; --i) {
    in.seek(positions[i]);
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestRunLengthIntegerReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthIntegerWriter out=new RunLengthIntegerWriter(new OutStream("test",100,null,collect),true);
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write(i);
    }
 else {
      out.write(256 * i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthIntegerReader in=new RunLengthIntegerReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),true);
  for (int i=0; i < 2048; i+=10) {
    int x=(int)in.next();
    if (i < 1024) {
      assertEquals(i,x);
    }
 else {
      assertEquals(256 * i,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
