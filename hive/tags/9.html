<h3><span class=" glyphicon glyphicon-tag"/>&nbspHybridVerifier</h3><kbd>Contains more than 2 JUnit-based stereotypes</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestAccumuloHiveRow </h4><pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetValueFromColumn(){
  AccumuloHiveRow row=new AccumuloHiveRow("row1");
  assertNull(row.getValue(new Text(""),new Text("")));
  for (int i=1; i <= 5; i++) {
    row.add("cf","cq" + i,Integer.toString(i).getBytes());
  }
  assertNull(row.getValue(new Text("cf"),new Text("cq0")));
  for (int i=1; i <= 5; i++) {
    assertArrayEquals(Integer.toString(i).getBytes(),row.getValue(new Text("cf"),new Text("cq" + i)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestAccumuloStorageHandler </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTablePropertiesPassedToOutputJobProperties(){
  TableDesc tableDesc=Mockito.mock(TableDesc.class);
  Properties props=new Properties();
  Map<String,String> jobProperties=new HashMap<String,String>();
  props.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf:cq1,cf:cq2,cf:cq3");
  props.setProperty(AccumuloSerDeParameters.TABLE_NAME,"table");
  props.setProperty(AccumuloSerDeParameters.VISIBILITY_LABEL_KEY,"foo");
  Mockito.when(tableDesc.getProperties()).thenReturn(props);
  storageHandler.configureOutputJobProperties(tableDesc,jobProperties);
  Assert.assertEquals(3,jobProperties.size());
  Assert.assertTrue("Job properties did not contain column mappings",jobProperties.containsKey(AccumuloSerDeParameters.COLUMN_MAPPINGS));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS),jobProperties.get(AccumuloSerDeParameters.COLUMN_MAPPINGS));
  Assert.assertTrue("Job properties did not contain accumulo table name",jobProperties.containsKey(AccumuloSerDeParameters.TABLE_NAME));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.TABLE_NAME),jobProperties.get(AccumuloSerDeParameters.TABLE_NAME));
  Assert.assertTrue("Job properties did not contain visibility label",jobProperties.containsKey(AccumuloSerDeParameters.VISIBILITY_LABEL_KEY));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.VISIBILITY_LABEL_KEY),jobProperties.get(AccumuloSerDeParameters.VISIBILITY_LABEL_KEY));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTablePropertiesPassedToInputJobProperties(){
  TableDesc tableDesc=Mockito.mock(TableDesc.class);
  Properties props=new Properties();
  Map<String,String> jobProperties=new HashMap<String,String>();
  props.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf:cq1,cf:cq2,cf:cq3");
  props.setProperty(AccumuloSerDeParameters.TABLE_NAME,"table");
  props.setProperty(AccumuloSerDeParameters.ITERATOR_PUSHDOWN_KEY,"true");
  props.setProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,ColumnEncoding.BINARY.getName());
  props.setProperty(AccumuloSerDeParameters.AUTHORIZATIONS_KEY,"foo,bar");
  Mockito.when(tableDesc.getProperties()).thenReturn(props);
  storageHandler.configureInputJobProperties(tableDesc,jobProperties);
  Assert.assertEquals(5,jobProperties.size());
  Assert.assertTrue(jobProperties.containsKey(AccumuloSerDeParameters.COLUMN_MAPPINGS));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS),jobProperties.get(AccumuloSerDeParameters.COLUMN_MAPPINGS));
  Assert.assertTrue(jobProperties.containsKey(AccumuloSerDeParameters.TABLE_NAME));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.TABLE_NAME),jobProperties.get(AccumuloSerDeParameters.TABLE_NAME));
  Assert.assertTrue(jobProperties.containsKey(AccumuloSerDeParameters.ITERATOR_PUSHDOWN_KEY));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.ITERATOR_PUSHDOWN_KEY),jobProperties.get(AccumuloSerDeParameters.ITERATOR_PUSHDOWN_KEY));
  Assert.assertTrue(jobProperties.containsKey(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE),jobProperties.get(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE));
  Assert.assertTrue(jobProperties.containsKey(AccumuloSerDeParameters.AUTHORIZATIONS_KEY));
  Assert.assertEquals(props.getProperty(AccumuloSerDeParameters.AUTHORIZATIONS_KEY),jobProperties.get(AccumuloSerDeParameters.AUTHORIZATIONS_KEY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestLazyAccumuloMap </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinaryIntMap() throws SerDeException, IOException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add(new Text("cf1"),new Text(toBytes(1)),toBytes(2));
  row.add(new Text("cf1"),new Text(toBytes(2)),toBytes(4));
  row.add(new Text("cf1"),new Text(toBytes(3)),toBytes(6));
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.BINARY,ColumnEncoding.BINARY,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,int>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(3,map.getMapSize());
  Object o=map.getMapValueElement(new IntWritable(1));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(2),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(2));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(4),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(3));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(6),((LazyInteger)o).getWritableObject());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringMapWithProjection() throws SerDeException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add("cf1","foo","bar".getBytes());
  row.add("cf1","bar","foo".getBytes());
  row.add("cf2","foo1","bar1".getBytes());
  row.add("cf3","bar1","foo1".getBytes());
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.STRING,ColumnEncoding.STRING,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<string,string>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(2,map.getMapSize());
  Object o=map.getMapValueElement(new Text("foo"));
  Assert.assertNotNull(o);
  Assert.assertEquals(new Text("bar"),((LazyString)o).getWritableObject());
  o=map.getMapValueElement(new Text("bar"));
  Assert.assertNotNull(o);
  Assert.assertEquals(new Text("foo"),((LazyString)o).getWritableObject());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMixedSerializationMap() throws SerDeException, IOException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add(new Text("cf1"),new Text(toBytes(1)),"2".getBytes());
  row.add(new Text("cf1"),new Text(toBytes(2)),"4".getBytes());
  row.add(new Text("cf1"),new Text(toBytes(3)),"6".getBytes());
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.BINARY,ColumnEncoding.STRING,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,int>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(3,map.getMapSize());
  Object o=map.getMapValueElement(new IntWritable(1));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(2),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(2));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(4),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(3));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(6),((LazyInteger)o).getWritableObject());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntMap() throws SerDeException, IOException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add(new Text("cf1"),new Text("1"),"2".getBytes());
  row.add(new Text("cf1"),new Text("2"),"4".getBytes());
  row.add(new Text("cf1"),new Text("3"),"6".getBytes());
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.STRING,ColumnEncoding.STRING,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,int>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(3,map.getMapSize());
  Object o=map.getMapValueElement(new IntWritable(1));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(2),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(2));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(4),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(3));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(6),((LazyInteger)o).getWritableObject());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestLazyAccumuloRow </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeserializationOfBinaryEncoding() throws Exception {
  List<String> columns=Arrays.asList("row","given_name","surname","age","weight","height");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo);
  LazySimpleStructObjectInspector objectInspector=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(columns,types,LazySerDeParameters.DefaultSeparators,new Text("\\N"),false,false,(byte)'\\');
  DefaultAccumuloRowIdFactory rowIdFactory=new DefaultAccumuloRowIdFactory();
  Properties props=new Properties();
  props.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid#s,personal:given_name#s,personal:surname#s,personal:age,personal:weight,personal:height");
  props.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  props.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  props.setProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,ColumnEncoding.BINARY.getName());
  AccumuloSerDeParameters params=new AccumuloSerDeParameters(new Configuration(),props,AccumuloSerDe.class.getName());
  rowIdFactory.init(params,props);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  LazyAccumuloRow lazyRow=new LazyAccumuloRow(objectInspector);
  AccumuloHiveRow hiveRow=new AccumuloHiveRow("1");
  hiveRow.add("personal","given_name","Bob".getBytes());
  hiveRow.add("personal","surname","Stevens".getBytes());
  out.writeInt(30);
  hiveRow.add("personal","age",baos.toByteArray());
  baos.reset();
  out.writeInt(200);
  hiveRow.add("personal","weight",baos.toByteArray());
  baos.reset();
  out.writeInt(72);
  hiveRow.add("personal","height",baos.toByteArray());
  ColumnMapper columnMapper=params.getColumnMapper();
  lazyRow.init(hiveRow,columnMapper.getColumnMappings(),rowIdFactory);
  Object o=lazyRow.getField(0);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("1",((LazyString)o).toString());
  o=lazyRow.getField(1);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("Bob",((LazyString)o).toString());
  o=lazyRow.getField(2);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("Stevens",((LazyString)o).toString());
  o=lazyRow.getField(3);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyDioInteger.class,o.getClass());
  Assert.assertEquals("30",((LazyDioInteger)o).toString());
  o=lazyRow.getField(4);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyDioInteger.class,o.getClass());
  Assert.assertEquals("200",((LazyDioInteger)o).toString());
  o=lazyRow.getField(5);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyDioInteger.class,o.getClass());
  Assert.assertEquals("72",((LazyDioInteger)o).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.columns.TestColumnMapper </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalMapping() throws TooManyAccumuloColumnsException {
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  List<String> columnNames=Arrays.asList("row","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(rawMappings.size(),mappings.size());
  Assert.assertEquals(mappings.size(),mapper.size());
  Iterator<String> rawIter=rawMappings.iterator();
  Iterator<ColumnMapping> iter=mappings.iterator();
  for (int i=0; i < mappings.size() && iter.hasNext(); i++) {
    String rawMapping=rawIter.next();
    ColumnMapping mapping=iter.next();
    ColumnMapping mappingByOffset=mapper.get(i);
    Assert.assertEquals(mapping,mappingByOffset);
    if (AccumuloHiveConstants.ROWID.equals(rawMapping)) {
      Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mapping.getClass());
    }
 else {
      Assert.assertEquals(HiveAccumuloColumnMapping.class,mapping.getClass());
    }
  }
  Assert.assertEquals(0,mapper.getRowIdOffset());
  Assert.assertTrue(mapper.hasRowIdMapping());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTableInputFormat </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProtectedField() throws Exception {
  FileInputFormat.addInputPath(conf,new Path("unused"));
  BatchWriterConfig writerConf=new BatchWriterConfig();
  BatchWriter writer=con.createBatchWriter(TEST_TABLE,writerConf);
  Authorizations origAuths=con.securityOperations().getUserAuthorizations(USER);
  con.securityOperations().changeUserAuthorizations(USER,new Authorizations(origAuths.toString() + ",foo"));
  Mutation m=new Mutation("r4");
  m.put(COLUMN_FAMILY,NAME,new ColumnVisibility("foo"),new Value("frank".getBytes()));
  m.put(COLUMN_FAMILY,SID,new ColumnVisibility("foo"),new Value(parseIntBytes("4")));
  m.put(COLUMN_FAMILY,DEGREES,new ColumnVisibility("foo"),new Value(parseDoubleBytes("60.6")));
  m.put(COLUMN_FAMILY,MILLIS,new ColumnVisibility("foo"),new Value(parseLongBytes("777")));
  writer.addMutation(m);
  writer.close();
  conf.set(AccumuloSerDeParameters.AUTHORIZATIONS_KEY,"foo");
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text rowId=new Text("r1");
  AccumuloHiveRow row=new AccumuloHiveRow();
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"brian".getBytes());
  rowId=new Text("r2");
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"mark".getBytes());
  rowId=new Text("r3");
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"dennis".getBytes());
  rowId=new Text("r4");
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"frank".getBytes());
  assertFalse(reader.next(rowId,row));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapColumnPairs() throws TooManyAccumuloColumnsException {
  ColumnMapper columnMapper=new ColumnMapper(":rowID,cf:*",conf.get(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE),Arrays.asList("row","col"),Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo)));
  Set<Pair<Text,Text>> pairs=inputformat.getPairCollection(columnMapper.getColumnMappings());
  Assert.assertEquals(1,pairs.size());
  Pair<Text,Text> cfCq=pairs.iterator().next();
  Assert.assertEquals("cf",cfCq.getFirst().toString());
  Assert.assertNull(cfCq.getSecond());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNameEqualBrian() throws Exception {
  Connector con=mockInstance.getConnector(USER,new PasswordToken(PASS.getBytes()));
  Scanner scan=con.createScanner(TEST_TABLE,new Authorizations("blah"));
  IteratorSetting is=new IteratorSetting(1,PrimitiveComparisonFilter.FILTER_PREFIX + 1,PrimitiveComparisonFilter.class);
  is.addOption(PrimitiveComparisonFilter.P_COMPARE_CLASS,StringCompare.class.getName());
  is.addOption(PrimitiveComparisonFilter.COMPARE_OPT_CLASS,Equal.class.getName());
  is.addOption(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64("brian".getBytes())));
  is.addOption(PrimitiveComparisonFilter.COLUMN,"cf:name");
  scan.addScanIterator(is);
  boolean foundName=false;
  boolean foundSid=false;
  boolean foundDegrees=false;
  boolean foundMillis=false;
  for (  Map.Entry<Key,Value> kv : scan) {
    SortedMap<Key,Value> items=PrimitiveComparisonFilter.decodeRow(kv.getKey(),kv.getValue());
    for (    Map.Entry<Key,Value> item : items.entrySet()) {
      assertEquals(item.getKey().getRow().toString(),"r1");
      if (item.getKey().getColumnQualifier().equals(NAME)) {
        foundName=true;
        assertArrayEquals(item.getValue().get(),"brian".getBytes());
      }
 else       if (item.getKey().getColumnQualifier().equals(SID)) {
        foundSid=true;
        assertArrayEquals(item.getValue().get(),parseIntBytes("1"));
      }
 else       if (item.getKey().getColumnQualifier().equals(DEGREES)) {
        foundDegrees=true;
        assertArrayEquals(item.getValue().get(),parseDoubleBytes("44.5"));
      }
 else       if (item.getKey().getColumnQualifier().equals(MILLIS)) {
        foundMillis=true;
        assertArrayEquals(item.getValue().get(),parseLongBytes("555"));
      }
    }
  }
  assertTrue(foundDegrees & foundMillis & foundName& foundSid);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGreaterThan1Sid() throws Exception {
  Connector con=mockInstance.getConnector(USER,new PasswordToken(PASS.getBytes()));
  Scanner scan=con.createScanner(TEST_TABLE,new Authorizations("blah"));
  IteratorSetting is=new IteratorSetting(1,PrimitiveComparisonFilter.FILTER_PREFIX + 1,PrimitiveComparisonFilter.class);
  is.addOption(PrimitiveComparisonFilter.P_COMPARE_CLASS,IntCompare.class.getName());
  is.addOption(PrimitiveComparisonFilter.COMPARE_OPT_CLASS,GreaterThan.class.getName());
  is.addOption(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64(parseIntBytes("1"))));
  is.addOption(PrimitiveComparisonFilter.COLUMN,"cf:sid");
  scan.addScanIterator(is);
  boolean foundMark=false;
  boolean foundDennis=false;
  int totalCount=0;
  for (  Map.Entry<Key,Value> kv : scan) {
    boolean foundName=false;
    boolean foundSid=false;
    boolean foundDegrees=false;
    boolean foundMillis=false;
    SortedMap<Key,Value> items=PrimitiveComparisonFilter.decodeRow(kv.getKey(),kv.getValue());
    for (    Map.Entry<Key,Value> item : items.entrySet()) {
      if (item.getKey().getRow().toString().equals("r2")) {
        foundMark=true;
      }
 else       if (item.getKey().getRow().toString().equals("r3")) {
        foundDennis=true;
      }
      if (item.getKey().getColumnQualifier().equals(NAME)) {
        foundName=true;
      }
 else       if (item.getKey().getColumnQualifier().equals(SID)) {
        foundSid=true;
      }
 else       if (item.getKey().getColumnQualifier().equals(DEGREES)) {
        foundDegrees=true;
      }
 else       if (item.getKey().getColumnQualifier().equals(MILLIS)) {
        foundMillis=true;
      }
    }
    totalCount++;
    assertTrue(foundDegrees & foundMillis & foundName& foundSid);
  }
  assertTrue(foundDennis & foundMark);
  assertEquals(totalCount,2);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHiveAccumuloRecord() throws Exception {
  FileInputFormat.addInputPath(conf,new Path("unused"));
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text rowId=new Text("r1");
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.add(COLUMN_FAMILY.toString(),NAME.toString(),"brian".getBytes());
  row.add(COLUMN_FAMILY.toString(),SID.toString(),parseIntBytes("1"));
  row.add(COLUMN_FAMILY.toString(),DEGREES.toString(),parseDoubleBytes("44.5"));
  row.add(COLUMN_FAMILY.toString(),MILLIS.toString(),parseLongBytes("555"));
  assertTrue(reader.next(rowId,row));
  assertEquals(rowId.toString(),row.getRowId());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals("brian".getBytes(),row.getValue(COLUMN_FAMILY,NAME));
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,SID));
  assertArrayEquals(parseIntBytes("1"),row.getValue(COLUMN_FAMILY,SID));
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,DEGREES));
  assertArrayEquals(parseDoubleBytes("44.5"),row.getValue(COLUMN_FAMILY,DEGREES));
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,MILLIS));
  assertArrayEquals(parseLongBytes("555"),row.getValue(COLUMN_FAMILY,MILLIS));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetNone() throws Exception {
  FileInputFormat.addInputPath(conf,new Path("unused"));
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf:f1");
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text rowId=new Text("r1");
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  assertFalse(reader.next(rowId,row));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetOnlyName() throws Exception {
  FileInputFormat.addInputPath(conf,new Path("unused"));
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text rowId=new Text("r1");
  AccumuloHiveRow row=new AccumuloHiveRow();
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"brian".getBytes());
  rowId=new Text("r2");
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"mark".getBytes());
  rowId=new Text("r3");
  assertTrue(reader.next(rowId,row));
  assertEquals(row.getRowId(),rowId.toString());
  assertTrue(row.hasFamAndQual(COLUMN_FAMILY,NAME));
  assertArrayEquals(row.getValue(COLUMN_FAMILY,NAME),"dennis".getBytes());
  assertFalse(reader.next(rowId,row));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDegreesAndMillis() throws Exception {
  Connector con=mockInstance.getConnector(USER,new PasswordToken(PASS.getBytes()));
  Scanner scan=con.createScanner(TEST_TABLE,new Authorizations("blah"));
  IteratorSetting is=new IteratorSetting(1,PrimitiveComparisonFilter.FILTER_PREFIX + 1,PrimitiveComparisonFilter.class);
  is.addOption(PrimitiveComparisonFilter.P_COMPARE_CLASS,DoubleCompare.class.getName());
  is.addOption(PrimitiveComparisonFilter.COMPARE_OPT_CLASS,GreaterThanOrEqual.class.getName());
  is.addOption(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64(parseDoubleBytes("55.6"))));
  is.addOption(PrimitiveComparisonFilter.COLUMN,"cf:dgrs");
  scan.addScanIterator(is);
  IteratorSetting is2=new IteratorSetting(2,PrimitiveComparisonFilter.FILTER_PREFIX + 2,PrimitiveComparisonFilter.class);
  is2.addOption(PrimitiveComparisonFilter.P_COMPARE_CLASS,LongCompare.class.getName());
  is2.addOption(PrimitiveComparisonFilter.COMPARE_OPT_CLASS,LessThan.class.getName());
  is2.addOption(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64(parseLongBytes("778"))));
  is2.addOption(PrimitiveComparisonFilter.COLUMN,"cf:mills");
  scan.addScanIterator(is2);
  boolean foundDennis=false;
  int totalCount=0;
  for (  Map.Entry<Key,Value> kv : scan) {
    boolean foundName=false;
    boolean foundSid=false;
    boolean foundDegrees=false;
    boolean foundMillis=false;
    SortedMap<Key,Value> items=PrimitiveComparisonFilter.decodeRow(kv.getKey(),kv.getValue());
    for (    Map.Entry<Key,Value> item : items.entrySet()) {
      SortedMap<Key,Value> nestedItems=PrimitiveComparisonFilter.decodeRow(item.getKey(),item.getValue());
      for (      Map.Entry<Key,Value> nested : nestedItems.entrySet()) {
        if (nested.getKey().getRow().toString().equals("r3")) {
          foundDennis=true;
        }
        if (nested.getKey().getColumnQualifier().equals(NAME)) {
          foundName=true;
        }
 else         if (nested.getKey().getColumnQualifier().equals(SID)) {
          foundSid=true;
        }
 else         if (nested.getKey().getColumnQualifier().equals(DEGREES)) {
          foundDegrees=true;
        }
 else         if (nested.getKey().getColumnQualifier().equals(MILLIS)) {
          foundMillis=true;
        }
      }
    }
    totalCount++;
    assertTrue(foundDegrees & foundMillis & foundName& foundSid);
  }
  assertTrue(foundDennis);
  assertEquals(totalCount,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTableOutputFormat </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinarySerializationOnStringFallsBackToUtf8() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1","col2");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq1,cf:cq2");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  tableProperties.setProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,ColumnEncoding.BINARY.getName());
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,accumuloSerDeParams.getRowIdFactory());
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(Arrays.asList("row","cq1","cq2"),Arrays.asList(stringTypeInfo,stringTypeInfo,stringTypeInfo),serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row value1 value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,new Authorizations()).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteToMockInstance() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1","col2");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq1,cf:cq2");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,accumuloSerDeParams.getRowIdFactory());
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(Arrays.asList("row","cq1","cq2"),Arrays.asList(stringTypeInfo,stringTypeInfo,stringTypeInfo),serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row value1 value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,new Authorizations()).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteToMockInstanceWithVisibility() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  Authorizations auths=new Authorizations("foo");
  conn.securityOperations().changeUserAuthorizations("root",auths);
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1","col2");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq1,cf:cq2");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility("foo"),accumuloSerDeParams.getRowIdFactory());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(Arrays.asList("row","cq1","cq2"),Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo),serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row value1 value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,auths).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals("foo",k.getColumnVisibility().toString());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals("foo",k.getColumnVisibility().toString());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMap() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:*");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,accumuloSerDeParams.getRowIdFactory());
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazyStringObjectInspector stringOI=(LazyStringObjectInspector)LazyFactory.createLazyObjectInspector(stringTypeInfo,new byte[]{0},0,serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyMapObjectInspector mapOI=LazyObjectInspectorFactory.getLazySimpleMapObjectInspector(stringOI,stringOI,(byte)',',(byte)':',serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(Arrays.asList("row","data"),Arrays.asList(stringOI,mapOI),(byte)' ',serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row cq1:value1,cq2:value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,new Authorizations()).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals(AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,k.getColumnVisibilityParsed());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals(AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,k.getColumnVisibilityParsed());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTypes </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUtf8Types() throws Exception {
  final String tableName=test.getMethodName(), user="root", pass="";
  MockInstance mockInstance=new MockInstance(test.getMethodName());
  Connector conn=mockInstance.getConnector(user,new PasswordToken(pass));
  HiveAccumuloTableInputFormat inputformat=new HiveAccumuloTableInputFormat();
  JobConf conf=new JobConf();
  conf.set(AccumuloSerDeParameters.TABLE_NAME,tableName);
  conf.set(AccumuloSerDeParameters.USE_MOCK_INSTANCE,"true");
  conf.set(AccumuloSerDeParameters.INSTANCE_NAME,test.getMethodName());
  conf.set(AccumuloSerDeParameters.USER_NAME,user);
  conf.set(AccumuloSerDeParameters.USER_PASS,pass);
  conf.set(AccumuloSerDeParameters.ZOOKEEPERS,"localhost:2181");
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,AccumuloHiveConstants.ROWID + ",cf:string,cf:boolean,cf:tinyint,cf:smallint,cf:int,cf:bigint" + ",cf:float,cf:double,cf:decimal,cf:date,cf:timestamp,cf:char,cf:varchar");
  conf.set(serdeConstants.LIST_COLUMNS,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conn.tableOperations().create(tableName);
  BatchWriterConfig writerConf=new BatchWriterConfig();
  BatchWriter writer=conn.createBatchWriter(tableName,writerConf);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  String cf="cf";
  byte[] cfBytes=cf.getBytes();
  ByteArrayRef byteRef=new ByteArrayRef();
  Mutation m=new Mutation("row1");
  String stringValue="string";
  baos.reset();
  JavaStringObjectInspector stringOI=(JavaStringObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,stringOI.create(stringValue),stringOI,false,(byte)0,null);
  m.put(cfBytes,"string".getBytes(),baos.toByteArray());
  boolean booleanValue=true;
  baos.reset();
  JavaBooleanObjectInspector booleanOI=(JavaBooleanObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,booleanOI.create(booleanValue),booleanOI,false,(byte)0,null);
  m.put(cfBytes,"boolean".getBytes(),baos.toByteArray());
  byte tinyintValue=-127;
  baos.reset();
  JavaByteObjectInspector byteOI=(JavaByteObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,tinyintValue,byteOI,false,(byte)0,null);
  m.put(cfBytes,"tinyint".getBytes(),baos.toByteArray());
  short smallintValue=Short.MAX_VALUE;
  baos.reset();
  JavaShortObjectInspector shortOI=(JavaShortObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,smallintValue,shortOI,false,(byte)0,null);
  m.put(cfBytes,"smallint".getBytes(),baos.toByteArray());
  int intValue=Integer.MAX_VALUE;
  baos.reset();
  JavaIntObjectInspector intOI=(JavaIntObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,intValue,intOI,false,(byte)0,null);
  m.put(cfBytes,"int".getBytes(),baos.toByteArray());
  long bigintValue=Long.MAX_VALUE;
  baos.reset();
  JavaLongObjectInspector longOI=(JavaLongObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,bigintValue,longOI,false,(byte)0,null);
  m.put(cfBytes,"bigint".getBytes(),baos.toByteArray());
  float floatValue=Float.MAX_VALUE;
  baos.reset();
  JavaFloatObjectInspector floatOI=(JavaFloatObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,floatValue,floatOI,false,(byte)0,null);
  m.put(cfBytes,"float".getBytes(),baos.toByteArray());
  double doubleValue=Double.MAX_VALUE;
  baos.reset();
  JavaDoubleObjectInspector doubleOI=(JavaDoubleObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,doubleValue,doubleOI,false,(byte)0,null);
  m.put(cfBytes,"double".getBytes(),baos.toByteArray());
  HiveDecimal decimalValue=HiveDecimal.create("1.23");
  baos.reset();
  JavaHiveDecimalObjectInspector decimalOI=(JavaHiveDecimalObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new DecimalTypeInfo(5,2));
  LazyUtils.writePrimitiveUTF8(baos,decimalOI.create(decimalValue),decimalOI,false,(byte)0,null);
  m.put(cfBytes,"decimal".getBytes(),baos.toByteArray());
  Date now=new Date(System.currentTimeMillis());
  DateWritable dateWritable=new DateWritable(now);
  Date dateValue=dateWritable.get();
  baos.reset();
  JavaDateObjectInspector dateOI=(JavaDateObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DATE_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,dateOI.create(dateValue),dateOI,false,(byte)0,null);
  m.put(cfBytes,"date".getBytes(),baos.toByteArray());
  Timestamp timestampValue=new Timestamp(now.getTime());
  baos.reset();
  JavaTimestampObjectInspector timestampOI=(JavaTimestampObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TIMESTAMP_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,timestampOI.create(timestampValue),timestampOI,false,(byte)0,null);
  m.put(cfBytes,"timestamp".getBytes(),baos.toByteArray());
  baos.reset();
  HiveChar charValue=new HiveChar("char",4);
  JavaHiveCharObjectInspector charOI=(JavaHiveCharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new CharTypeInfo(4));
  LazyUtils.writePrimitiveUTF8(baos,charOI.create(charValue),charOI,false,(byte)0,null);
  m.put(cfBytes,"char".getBytes(),baos.toByteArray());
  baos.reset();
  HiveVarchar varcharValue=new HiveVarchar("varchar",7);
  JavaHiveVarcharObjectInspector varcharOI=(JavaHiveVarcharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new VarcharTypeInfo(7));
  LazyUtils.writePrimitiveUTF8(baos,varcharOI.create(varcharValue),varcharOI,false,(byte)0,null);
  m.put(cfBytes,"varchar".getBytes(),baos.toByteArray());
  writer.addMutation(m);
  writer.close();
  for (  Entry<Key,Value> e : conn.createScanner(tableName,new Authorizations())) {
    System.out.println(e);
  }
  FileInputFormat.addInputPath(conf,new Path("unused"));
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text key=reader.createKey();
  AccumuloHiveRow value=reader.createValue();
  reader.next(key,value);
  Assert.assertEquals(13,value.getTuples().size());
  Text cfText=new Text(cf), cqHolder=new Text();
  cqHolder.set("string");
  byte[] valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyStringObjectInspector lazyStringOI=LazyPrimitiveObjectInspectorFactory.getLazyStringObjectInspector(false,(byte)0);
  LazyString lazyString=(LazyString)LazyFactory.createLazyObject(lazyStringOI);
  lazyString.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(new Text(stringValue),lazyString.getWritableObject());
  cqHolder.set("boolean");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyBooleanObjectInspector lazyBooleanOI=(LazyBooleanObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyBoolean lazyBoolean=(LazyBoolean)LazyFactory.createLazyObject(lazyBooleanOI);
  lazyBoolean.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(booleanValue,lazyBoolean.getWritableObject().get());
  cqHolder.set("tinyint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyByteObjectInspector lazyByteOI=(LazyByteObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyByte lazyByte=(LazyByte)LazyFactory.createLazyObject(lazyByteOI);
  lazyByte.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(tinyintValue,lazyByte.getWritableObject().get());
  cqHolder.set("smallint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyShortObjectInspector lazyShortOI=(LazyShortObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyShort lazyShort=(LazyShort)LazyFactory.createLazyObject(lazyShortOI);
  lazyShort.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(smallintValue,lazyShort.getWritableObject().get());
  cqHolder.set("int");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyIntObjectInspector lazyIntOI=(LazyIntObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyInteger lazyInt=(LazyInteger)LazyFactory.createLazyObject(lazyIntOI);
  lazyInt.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(intValue,lazyInt.getWritableObject().get());
  cqHolder.set("bigint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyLongObjectInspector lazyLongOI=(LazyLongObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyLong lazyLong=(LazyLong)LazyFactory.createLazyObject(lazyLongOI);
  lazyLong.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(bigintValue,lazyLong.getWritableObject().get());
  cqHolder.set("float");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyFloatObjectInspector lazyFloatOI=(LazyFloatObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyFloat lazyFloat=(LazyFloat)LazyFactory.createLazyObject(lazyFloatOI);
  lazyFloat.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(floatValue,lazyFloat.getWritableObject().get(),0);
  cqHolder.set("double");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyDoubleObjectInspector lazyDoubleOI=(LazyDoubleObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyDouble lazyDouble=(LazyDouble)LazyFactory.createLazyObject(lazyDoubleOI);
  lazyDouble.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(doubleValue,lazyDouble.getWritableObject().get(),0);
  cqHolder.set("decimal");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveDecimalObjectInspector lazyDecimalOI=(LazyHiveDecimalObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new DecimalTypeInfo(5,2));
  LazyHiveDecimal lazyDecimal=(LazyHiveDecimal)LazyFactory.createLazyObject(lazyDecimalOI);
  lazyDecimal.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(decimalValue,lazyDecimal.getWritableObject().getHiveDecimal());
  cqHolder.set("date");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyDateObjectInspector lazyDateOI=(LazyDateObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DATE_TYPE_NAME));
  LazyDate lazyDate=(LazyDate)LazyFactory.createLazyObject(lazyDateOI);
  lazyDate.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(dateValue,lazyDate.getWritableObject().get());
  cqHolder.set("timestamp");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyTimestampObjectInspector lazyTimestampOI=(LazyTimestampObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TIMESTAMP_TYPE_NAME));
  LazyTimestamp lazyTimestamp=(LazyTimestamp)LazyFactory.createLazyObject(lazyTimestampOI);
  lazyTimestamp.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(timestampValue,lazyTimestamp.getWritableObject().getTimestamp());
  cqHolder.set("char");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveCharObjectInspector lazyCharOI=(LazyHiveCharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new CharTypeInfo(4));
  LazyHiveChar lazyChar=(LazyHiveChar)LazyFactory.createLazyObject(lazyCharOI);
  lazyChar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(charValue,lazyChar.getWritableObject().getHiveChar());
  cqHolder.set("varchar");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveVarcharObjectInspector lazyVarcharOI=(LazyHiveVarcharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new VarcharTypeInfo(7));
  LazyHiveVarchar lazyVarchar=(LazyHiveVarchar)LazyFactory.createLazyObject(lazyVarcharOI);
  lazyVarchar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(varcharValue.toString(),lazyVarchar.getWritableObject().getHiveVarchar().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinaryTypes() throws Exception {
  final String tableName=test.getMethodName(), user="root", pass="";
  MockInstance mockInstance=new MockInstance(test.getMethodName());
  Connector conn=mockInstance.getConnector(user,new PasswordToken(pass));
  HiveAccumuloTableInputFormat inputformat=new HiveAccumuloTableInputFormat();
  JobConf conf=new JobConf();
  conf.set(AccumuloSerDeParameters.TABLE_NAME,tableName);
  conf.set(AccumuloSerDeParameters.USE_MOCK_INSTANCE,"true");
  conf.set(AccumuloSerDeParameters.INSTANCE_NAME,test.getMethodName());
  conf.set(AccumuloSerDeParameters.USER_NAME,user);
  conf.set(AccumuloSerDeParameters.USER_PASS,pass);
  conf.set(AccumuloSerDeParameters.ZOOKEEPERS,"localhost:2181");
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,AccumuloHiveConstants.ROWID + ",cf:string,cf:boolean,cf:tinyint,cf:smallint,cf:int,cf:bigint" + ",cf:float,cf:double,cf:decimal,cf:date,cf:timestamp,cf:char,cf:varchar");
  conf.set(serdeConstants.LIST_COLUMNS,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conf.set(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,"binary");
  conn.tableOperations().create(tableName);
  BatchWriterConfig writerConf=new BatchWriterConfig();
  BatchWriter writer=conn.createBatchWriter(tableName,writerConf);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  String cf="cf";
  byte[] cfBytes=cf.getBytes();
  Mutation m=new Mutation("row1");
  String stringValue="string";
  JavaStringObjectInspector stringOI=(JavaStringObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,stringOI.create(stringValue),stringOI,false,(byte)0,null);
  m.put(cfBytes,"string".getBytes(),baos.toByteArray());
  boolean booleanValue=true;
  baos.reset();
  JavaBooleanObjectInspector booleanOI=(JavaBooleanObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyUtils.writePrimitive(baos,booleanOI.create(booleanValue),booleanOI);
  m.put(cfBytes,"boolean".getBytes(),baos.toByteArray());
  byte tinyintValue=-127;
  baos.reset();
  JavaByteObjectInspector byteOI=(JavaByteObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,tinyintValue,byteOI);
  m.put(cfBytes,"tinyint".getBytes(),baos.toByteArray());
  short smallintValue=Short.MAX_VALUE;
  baos.reset();
  JavaShortObjectInspector shortOI=(JavaShortObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,smallintValue,shortOI);
  m.put(cfBytes,"smallint".getBytes(),baos.toByteArray());
  int intValue=Integer.MAX_VALUE;
  baos.reset();
  JavaIntObjectInspector intOI=(JavaIntObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,intValue,intOI);
  m.put(cfBytes,"int".getBytes(),baos.toByteArray());
  long bigintValue=Long.MAX_VALUE;
  baos.reset();
  JavaLongObjectInspector longOI=(JavaLongObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,bigintValue,longOI);
  m.put(cfBytes,"bigint".getBytes(),baos.toByteArray());
  float floatValue=Float.MAX_VALUE;
  baos.reset();
  JavaFloatObjectInspector floatOI=(JavaFloatObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,floatValue,floatOI);
  m.put(cfBytes,"float".getBytes(),baos.toByteArray());
  double doubleValue=Double.MAX_VALUE;
  baos.reset();
  JavaDoubleObjectInspector doubleOI=(JavaDoubleObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyUtils.writePrimitive(baos,doubleValue,doubleOI);
  m.put(cfBytes,"double".getBytes(),baos.toByteArray());
  baos.reset();
  HiveDecimal decimalValue=HiveDecimal.create(65536l);
  HiveDecimalWritable decimalWritable=new HiveDecimalWritable(decimalValue);
  decimalWritable.write(out);
  m.put(cfBytes,"decimal".getBytes(),baos.toByteArray());
  baos.reset();
  Date now=new Date(System.currentTimeMillis());
  DateWritable dateWritable=new DateWritable(now);
  Date dateValue=dateWritable.get();
  dateWritable.write(out);
  m.put(cfBytes,"date".getBytes(),baos.toByteArray());
  baos.reset();
  Timestamp timestampValue=new Timestamp(now.getTime());
  ByteStream.Output output=new ByteStream.Output();
  TimestampWritable timestampWritable=new TimestampWritable(new Timestamp(now.getTime()));
  timestampWritable.write(output);
  output.close();
  m.put(cfBytes,"timestamp".getBytes(),output.toByteArray());
  baos.reset();
  HiveChar charValue=new HiveChar("char",4);
  JavaHiveCharObjectInspector charOI=(JavaHiveCharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new CharTypeInfo(4));
  LazyUtils.writePrimitiveUTF8(baos,charOI.create(charValue),charOI,false,(byte)0,null);
  m.put(cfBytes,"char".getBytes(),baos.toByteArray());
  baos.reset();
  HiveVarchar varcharValue=new HiveVarchar("varchar",7);
  JavaHiveVarcharObjectInspector varcharOI=(JavaHiveVarcharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new VarcharTypeInfo(7));
  LazyUtils.writePrimitiveUTF8(baos,varcharOI.create(varcharValue),varcharOI,false,(byte)0,null);
  m.put(cfBytes,"varchar".getBytes(),baos.toByteArray());
  writer.addMutation(m);
  writer.close();
  for (  Entry<Key,Value> e : conn.createScanner(tableName,new Authorizations())) {
    System.out.println(e);
  }
  FileInputFormat.addInputPath(conf,new Path("unused"));
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text key=reader.createKey();
  AccumuloHiveRow value=reader.createValue();
  reader.next(key,value);
  Assert.assertEquals(13,value.getTuples().size());
  ByteArrayRef byteRef=new ByteArrayRef();
  Text cfText=new Text(cf), cqHolder=new Text();
  cqHolder.set("string");
  byte[] valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyStringObjectInspector lazyStringOI=LazyPrimitiveObjectInspectorFactory.getLazyStringObjectInspector(false,(byte)0);
  LazyString lazyString=(LazyString)LazyFactory.createLazyObject(lazyStringOI);
  lazyString.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(stringValue,lazyString.getWritableObject().toString());
  cqHolder.set("boolean");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyBooleanObjectInspector lazyBooleanOI=(LazyBooleanObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyBoolean lazyBoolean=(LazyBoolean)LazyFactory.createLazyPrimitiveBinaryClass(lazyBooleanOI);
  lazyBoolean.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(booleanValue,lazyBoolean.getWritableObject().get());
  cqHolder.set("tinyint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyByteObjectInspector lazyByteOI=(LazyByteObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyByte lazyByte=(LazyByte)LazyFactory.createLazyPrimitiveBinaryClass(lazyByteOI);
  lazyByte.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(tinyintValue,lazyByte.getWritableObject().get());
  cqHolder.set("smallint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyShortObjectInspector lazyShortOI=(LazyShortObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyShort lazyShort=(LazyShort)LazyFactory.createLazyPrimitiveBinaryClass(lazyShortOI);
  lazyShort.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(smallintValue,lazyShort.getWritableObject().get());
  cqHolder.set("int");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyIntObjectInspector lazyIntOI=(LazyIntObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyInteger lazyInt=(LazyInteger)LazyFactory.createLazyPrimitiveBinaryClass(lazyIntOI);
  lazyInt.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(intValue,lazyInt.getWritableObject().get());
  cqHolder.set("bigint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyLongObjectInspector lazyLongOI=(LazyLongObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyLong lazyLong=(LazyLong)LazyFactory.createLazyPrimitiveBinaryClass(lazyLongOI);
  lazyLong.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(bigintValue,lazyLong.getWritableObject().get());
  cqHolder.set("float");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyFloatObjectInspector lazyFloatOI=(LazyFloatObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyFloat lazyFloat=(LazyFloat)LazyFactory.createLazyPrimitiveBinaryClass(lazyFloatOI);
  lazyFloat.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(floatValue,lazyFloat.getWritableObject().get(),0);
  cqHolder.set("double");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyDoubleObjectInspector lazyDoubleOI=(LazyDoubleObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyDouble lazyDouble=(LazyDouble)LazyFactory.createLazyPrimitiveBinaryClass(lazyDoubleOI);
  lazyDouble.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(doubleValue,lazyDouble.getWritableObject().get(),0);
  cqHolder.set("decimal");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  ByteArrayInputStream bais=new ByteArrayInputStream(valueBytes);
  DataInputStream in=new DataInputStream(bais);
  decimalWritable.readFields(in);
  Assert.assertEquals(decimalValue,decimalWritable.getHiveDecimal());
  cqHolder.set("date");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  bais=new ByteArrayInputStream(valueBytes);
  in=new DataInputStream(bais);
  dateWritable.readFields(in);
  Assert.assertEquals(dateValue,dateWritable.get());
  cqHolder.set("timestamp");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  bais=new ByteArrayInputStream(valueBytes);
  in=new DataInputStream(bais);
  timestampWritable.readFields(in);
  Assert.assertEquals(timestampValue,timestampWritable.getTimestamp());
  cqHolder.set("char");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveCharObjectInspector lazyCharOI=(LazyHiveCharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new CharTypeInfo(4));
  LazyHiveChar lazyChar=(LazyHiveChar)LazyFactory.createLazyObject(lazyCharOI);
  lazyChar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(charValue,lazyChar.getWritableObject().getHiveChar());
  cqHolder.set("varchar");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveVarcharObjectInspector lazyVarcharOI=(LazyHiveVarcharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new VarcharTypeInfo(7));
  LazyHiveVarchar lazyVarchar=(LazyHiveVarchar)LazyFactory.createLazyObject(lazyVarcharOI);
  lazyVarchar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(varcharValue.toString(),lazyVarchar.getWritableObject().getHiveVarchar().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestAccumuloPredicateHandler </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinaryRangeGeneration() throws Exception {
  List<String> columnNames=Arrays.asList("key","column");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  conf.set(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columnNames));
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"int,string");
  String columnMappingStr=":rowID#b,cf:f1";
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,columnMappingStr);
  columnMapper=new ColumnMapper(columnMappingStr,ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  int intValue=100;
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JavaIntObjectInspector intOI=(JavaIntObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,intValue,intOI);
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"key",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,intValue);
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(constant);
  children.add(column);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<Range> ranges=handler.getRanges(conf,columnMapper);
  Assert.assertEquals(1,ranges.size());
  Assert.assertEquals(new Range(new Text(baos.toByteArray()),false,null,false),ranges.get(0));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRowIDSearchCondition(){
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"hi");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqual(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<IndexSearchCondition> sConditions=handler.getSearchConditions(conf);
  assertEquals(sConditions.size(),1);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rangeLessThan() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertFalse(range.contains(new Key(new Text("aaa"))));
  assertTrue(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aa"))));
  assertTrue(range.afterEndKey(new Key(new Text("aab"))));
  assertTrue(range.afterEndKey(new Key(new Text("aaa"))));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testRangeEqual() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqual(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertTrue(range.contains(new Key(new Text("aaa"))));
  assertTrue(range.afterEndKey(new Key(new Text("aab"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aa"))));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleRanges() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"bbb");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(1,ranges.size());
  Range range=ranges.get(0);
  assertEquals(new Range(new Key("aaa"),true,new Key("bbb"),false),range);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPushdownTuple() throws SerDeException, NoSuchPrimitiveComparisonException, NoSuchCompareOpException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,5);
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqual(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<IndexSearchCondition> sConditions=handler.getSearchConditions(conf);
  assertEquals(sConditions.size(),1);
  IndexSearchCondition sc=sConditions.get(0);
  PushdownTuple tuple=new PushdownTuple(sConditions.get(0),handler.getPrimitiveComparison(sc.getColumnDesc().getTypeString(),sc),handler.getCompareOp(sc.getComparisonOp(),sc));
  byte[] expectedVal=new byte[4];
  ByteBuffer.wrap(expectedVal).putInt(5);
  assertArrayEquals(tuple.getConstVal(),expectedVal);
  assertEquals(tuple.getcOpt().getClass(),Equal.class);
  assertEquals(tuple.getpCompare().getClass(),IntCompare.class);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDisjointRanges() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"bbb");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(0,ranges.size());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowRangeGeneration() throws SerDeException {
  List<String> columnNames=Arrays.asList("key","column");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  conf.set(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columnNames));
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,string");
  String columnMappingStr=":rowID,cf:f1";
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,columnMappingStr);
  columnMapper=new ColumnMapper(columnMappingStr,ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"key",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,100);
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(constant);
  children.add(column);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<Range> ranges=handler.getRanges(conf,columnMapper);
  Assert.assertEquals(1,ranges.size());
  Assert.assertEquals(new Range(new Text("100"),false,null,false),ranges.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rangeLessThanOrEqual() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertTrue(range.contains(new Key(new Text("aaa"))));
  assertTrue(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aa"))));
  assertTrue(range.afterEndKey(new Key(new Text("aab"))));
  assertFalse(range.afterEndKey(new Key(new Text("aaa"))));
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPushdownComparisonOptNotSupported(){
  try {
    ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"field1",null,false);
    List<ExprNodeDesc> children=Lists.newArrayList();
    children.add(column);
    ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPNotNull(),children);
    assertNotNull(node);
    String filterExpr=SerializationUtilities.serializeExpression(node);
    conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
    List<IndexSearchCondition> sConditions=handler.getSearchConditions(conf);
    assertEquals(sConditions.size(),1);
    IndexSearchCondition sc=sConditions.get(0);
    new PushdownTuple(sc,handler.getPrimitiveComparison(sc.getColumnDesc().getTypeString(),sc),handler.getCompareOp(sc.getComparisonOp(),sc));
    fail("Should fail: compare op not registered for index analyzer. Should leave undesirable residual predicate");
  }
 catch (  RuntimeException e) {
    assertTrue(e.getMessage().contains("Unexpected residual predicate: field1 is not null"));
  }
catch (  Exception e) {
    fail(StringUtils.stringifyException(e));
  }
}

</code></pre>

<br>
<pre class="type-12 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateIteratorSettings() throws Exception {
  conf=new JobConf();
  List<String> columnNames=Arrays.asList("field1","field2","rid");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  conf.set(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columnNames));
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,int,string");
  String columnMappingStr="cf:f1,cf:f2,:rowID";
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,columnMappingStr);
  columnMapper=new ColumnMapper(columnMappingStr,ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"field2",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,5);
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<IteratorSetting> iterators=handler.getIterators(conf,columnMapper);
  assertEquals(iterators.size(),2);
  IteratorSetting is1=iterators.get(0);
  IteratorSetting is2=iterators.get(1);
  boolean foundQual=false;
  boolean foundPCompare=false;
  boolean foundCOpt=false;
  boolean foundConst=false;
  for (  Map.Entry<String,String> option : is1.getOptions().entrySet()) {
    String optKey=option.getKey();
    if (optKey.equals(PrimitiveComparisonFilter.COLUMN)) {
      foundQual=true;
      assertEquals(option.getValue(),"cf:f1");
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.CONST_VAL)) {
      foundConst=true;
      assertEquals(option.getValue(),new String(Base64.encodeBase64("aaa".getBytes())));
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.COMPARE_OPT_CLASS)) {
      foundCOpt=true;
      assertEquals(option.getValue(),LessThanOrEqual.class.getName());
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.P_COMPARE_CLASS)) {
      foundPCompare=true;
      assertEquals(option.getValue(),StringCompare.class.getName());
    }
  }
  assertTrue(foundConst & foundCOpt & foundPCompare& foundQual);
  foundQual=false;
  foundPCompare=false;
  foundCOpt=false;
  foundConst=false;
  for (  Map.Entry<String,String> option : is2.getOptions().entrySet()) {
    String optKey=option.getKey();
    if (optKey.equals(PrimitiveComparisonFilter.COLUMN)) {
      foundQual=true;
      assertEquals(option.getValue(),"cf:f2");
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.CONST_VAL)) {
      foundConst=true;
      byte[] intVal=new byte[4];
      ByteBuffer.wrap(intVal).putInt(5);
      assertEquals(option.getValue(),new String(Base64.encodeBase64(intVal)));
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.COMPARE_OPT_CLASS)) {
      foundCOpt=true;
      assertEquals(option.getValue(),GreaterThan.class.getName());
    }
 else     if (optKey.equals(PrimitiveComparisonFilter.P_COMPARE_CLASS)) {
      foundPCompare=true;
      assertEquals(option.getValue(),IntCompare.class.getName());
    }
  }
  assertTrue(foundConst & foundCOpt & foundPCompare& foundQual);
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIgnoreIteratorPushdown() throws TooManyAccumuloColumnsException {
  conf=new JobConf();
  List<String> columnNames=Arrays.asList("field1","field2","rid");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  conf.set(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columnNames));
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,int,string");
  String columnMappingStr="cf:f1,cf:f2,:rowID";
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,columnMappingStr);
  columnMapper=new ColumnMapper(columnMappingStr,ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"field2",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,5);
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  conf.setBoolean(AccumuloSerDeParameters.ITERATOR_PUSHDOWN_KEY,false);
  try {
    List<IteratorSetting> iterators=handler.getIterators(conf,columnMapper);
    assertEquals(iterators.size(),0);
  }
 catch (  Exception e) {
    fail(StringUtils.stringifyException(e));
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=NoSuchPrimitiveComparisonException.class) public void testPushdownColumnTypeNotSupported() throws SerDeException, NoSuchPrimitiveComparisonException, NoSuchCompareOpException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.floatTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.floatTypeInfo,5.5f);
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqual(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<IndexSearchCondition> sConditions=handler.getSearchConditions(conf);
  assertEquals(sConditions.size(),1);
  IndexSearchCondition sc=sConditions.get(0);
  handler.getPrimitiveComparison(sc.getColumnDesc().getTypeString(),sc);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testRangeGreaterThan() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertFalse(range.contains(new Key(new Text("aaa"))));
  assertFalse(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aab"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aa"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aaa"))));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIteratorIgnoreRowIDFields(){
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"bbb");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  try {
    List<IteratorSetting> iterators=handler.getIterators(conf,columnMapper);
    assertEquals(iterators.size(),0);
  }
 catch (  SerDeException e) {
    StringUtils.stringifyException(e);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rangeGreaterThanOrEqual() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertTrue(range.contains(new Key(new Text("aaa"))));
  assertFalse(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aab"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aa"))));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRowRangeIntersection() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"m");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(1,ranges.size());
  assertEquals(new Range(new Key("f"),true,new Key("m\0"),false),ranges.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestAccumuloRangeGenerator </h4><pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeConjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"m");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("f"),true,new Key("m\0"),false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateRangeConjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.dateTypeInfo,Date.valueOf("2014-01-01"));
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.dateTypeInfo,Date.valueOf("2014-07-01"));
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("2014-01-01"),true,new Key("2014-07-01"),false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialRangeConjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"anythingElse",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"foo");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("f"),true,null,false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeConjunctionWithDisjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"h");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"d");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  ExprNodeDesc column3=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant3=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"q");
  List<ExprNodeDesc> children3=Lists.newArrayList();
  children3.add(column3);
  children3.add(constant3);
  ExprNodeDesc node3=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children3);
  assertNotNull(node3);
  List<ExprNodeDesc> orFilters=Lists.newArrayList();
  orFilters.add(node2);
  orFilters.add(node3);
  ExprNodeGenericFuncDesc orNode=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPOr(),orFilters);
  List<ExprNodeDesc> andFilters=Lists.newArrayList();
  andFilters.add(node);
  andFilters.add(orNode);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),andFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("q"),true,null,false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeDisjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"m");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPOr(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range());
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.compare.TestDoubleCompare </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void like(){
  try {
    Like likeObj=new Like(doubleCompare);
    assertTrue(likeObj.accept(new byte[]{}));
    fail("should not accept");
  }
 catch (  UnsupportedOperationException e) {
    assertTrue(e.getMessage().contains("Like not supported for " + doubleCompare.getClass().getName()));
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidSerialization(){
  try {
    byte[] badVal=new byte[4];
    ByteBuffer.wrap(badVal).putInt(1);
    doubleCompare.serialize(badVal);
    fail("Should fail");
  }
 catch (  RuntimeException e) {
    assertTrue(e.getMessage().contains(" occurred trying to build double value"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.compare.TestIntCompare </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void like(){
  try {
    Like likeObj=new Like(intCompare);
    assertTrue(likeObj.accept(new byte[]{}));
    fail("should not accept");
  }
 catch (  UnsupportedOperationException e) {
    assertTrue(e.getMessage().contains("Like not supported for " + intCompare.getClass().getName()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.compare.TestLongComparison </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void like(){
  try {
    Like likeObj=new Like(longComp);
    assertTrue(likeObj.accept(new byte[]{}));
    fail("should not accept");
  }
 catch (  UnsupportedOperationException e) {
    assertTrue(e.getMessage().contains("Like not supported for " + longComp.getClass().getName()));
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidSerialization(){
  try {
    byte[] badVal=new byte[4];
    ByteBuffer.wrap(badVal).putInt(1);
    longComp.serialize(badVal);
    fail("Should fail");
  }
 catch (  RuntimeException e) {
    assertTrue(e.getMessage().contains(" occurred trying to build long value"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestAccumuloSerDe </h4><pre class="type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompositeKeyDeserialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,field1");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"struct<col1:string,col2:string,col3:string>,string");
  properties.setProperty(DelimitedAccumuloRowIdFactory.ACCUMULO_COMPOSITE_DELIMITER,"_");
  properties.setProperty(AccumuloSerDeParameters.COMPOSITE_ROWID_FACTORY,DelimitedAccumuloRowIdFactory.class.getName());
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("p1_p2_p3");
  row.add("cf","f1","v1".getBytes());
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyStruct);
  LazyStruct struct=(LazyStruct)field0;
  List fields=struct.getFieldsAsList();
  assertEquals(3,fields.size());
  for (int i=0; i < fields.size(); i++) {
    assertEquals(LazyString.class,fields.get(i).getClass());
    assertEquals("p" + (i + 1),fields.get(i).toString());
  }
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue("Expected instance of LazyString but was " + field1.getClass(),field1 instanceof LazyString);
  assertEquals(field1.toString(),"v1");
}

</code></pre>

<br>
<pre class="type-4 type-5 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=InvalidColumnMappingException.class) public void invalidColMapping() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"field2,field3,field4");
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  lazyRow.getField(0);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapSerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,map<string,string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  properties.setProperty(serdeConstants.MAPKEY_DELIM,"=");
  char collectionSeparator=':', kvSeparator='=';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("k1" + kvSeparator + "v1"+ collectionSeparator+ "k2"+ kvSeparator+ "v2"+ collectionSeparator+ "k3"+ kvSeparator+ "v3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyMap);
  LazyMap map=(LazyMap)field1;
  Map<Object,Object> untypedMap=map.getMap();
  assertEquals(3,map.getMapSize());
  Set<String> expectedKeys=new HashSet<String>();
  expectedKeys.add("k1");
  expectedKeys.add("k2");
  expectedKeys.add("k3");
  for (  Entry<Object,Object> entry : untypedMap.entrySet()) {
    assertNotNull(entry.getKey());
    assertTrue(entry.getKey() instanceof LazyString);
    LazyString key=(LazyString)entry.getKey();
    assertNotNull(entry.getValue());
    assertTrue(entry.getValue() instanceof LazyString);
    LazyString value=(LazyString)entry.getValue();
    String strKey=key.getWritableObject().toString(), strValue=value.getWritableObject().toString();
    assertTrue(expectedKeys.remove(strKey));
    assertEquals(2,strValue.length());
    assertTrue(strValue.startsWith("v"));
    assertTrue(strValue.endsWith(Character.toString(strKey.charAt(1))));
  }
  assertTrue("Did not find expected keys: " + expectedKeys,expectedKeys.isEmpty());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deserialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"blah,field2,field3,field4");
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","f1","v1".getBytes());
  row.add("cf","f2","v2".getBytes());
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(field0.toString(),"r1");
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue("Expected instance of LazyString but was " + field1.getClass(),field1 instanceof LazyString);
  assertEquals(field1.toString(),"v1");
  Object field2=lazyRow.getField(2);
  assertNotNull(field2);
  assertTrue(field2 instanceof LazyString);
  assertEquals(field2.toString(),"v2");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArraySerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,array<string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  char separator=':';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("value1" + separator + "value2"+ separator+ "value3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyArray);
  LazyArray array=(LazyArray)field1;
  List values=array.getList();
  assertEquals(3,values.size());
  for (int i=0; i < 3; i++) {
    Object o=values.get(i);
    assertNotNull(o);
    assertTrue(o instanceof LazyString);
    assertEquals("value" + (i + 1),((LazyString)o).getWritableObject().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestDefaultAccumuloRowIdFactory </h4><pre class="type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinaryStringRowId() throws SerDeException {
  AccumuloSerDe accumuloSerDe=new AccumuloSerDe();
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,col");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,string");
  properties.setProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,ColumnEncoding.BINARY.getName());
  accumuloSerDe.initialize(conf,properties);
  DefaultAccumuloRowIdFactory rowIdFactory=new DefaultAccumuloRowIdFactory();
  rowIdFactory.init(accumuloSerDe.getParams(),properties);
  LazyStringObjectInspector oi=LazyPrimitiveObjectInspectorFactory.getLazyStringObjectInspector(false,(byte)'\\');
  LazyObjectBase lazyObj=rowIdFactory.createRowId(oi);
  Assert.assertNotNull(lazyObj);
  Assert.assertTrue(LazyString.class.isAssignableFrom(lazyObj.getClass()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.cli.TestOptionsProcessor </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test set fileName
 */
@Test public void testFiles(){
  OptionsProcessor processor=new OptionsProcessor();
  String[] args={"-i","f1","-i","f2","-f","fileName"};
  assertTrue(processor.process_stage1(args));
  CliSessionState sessionState=new CliSessionState(new HiveConf());
  processor.process_stage2(sessionState);
  assertEquals("fileName",sessionState.fileName);
  assertEquals(2,sessionState.initFiles.size());
  assertEquals("f1",sessionState.initFiles.get(0));
  assertEquals("f2",sessionState.initFiles.get(1));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test pase parameters for Hive
 */
@Test public void testOptionsProcessor(){
  OptionsProcessor processor=new OptionsProcessor();
  System.clearProperty("hiveconf");
  System.clearProperty("define");
  System.clearProperty("hivevar");
  assertNull(System.getProperty("_A"));
  String[] args={"-hiveconf","_A=B","-define","C=D","-hivevar","X=Y","-S","true","-database","testDb","-e","execString","-v","true"};
  assertTrue(processor.process_stage1(args));
  assertEquals("B",System.getProperty("_A"));
  assertEquals("D",processor.getHiveVariables().get("C"));
  assertEquals("Y",processor.getHiveVariables().get("X"));
  CliSessionState sessionState=new CliSessionState(new HiveConf());
  processor.process_stage2(sessionState);
  assertEquals("testDb",sessionState.database);
  assertEquals("execString",sessionState.execString);
  assertEquals(0,sessionState.initFiles.size());
  assertTrue(sessionState.getIsVerbose());
  assertTrue(sessionState.getIsSilent());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.cli.TestRCFileCat </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test parse file
 */
@Test public void testRCFileCat() throws Exception {
  File template=File.createTempFile("hive","tmpTest");
  Configuration configuration=new Configuration();
  byte[][] record_1={Bytes.toBytes("123"),Bytes.toBytes("456"),Bytes.toBytes("789"),Bytes.toBytes("1000"),Bytes.toBytes("5.3"),Bytes.toBytes("hive and hadoop"),new byte[0],Bytes.toBytes("NULL")};
  byte[][] record_2={Bytes.toBytes("100"),Bytes.toBytes("200"),Bytes.toBytes("123"),Bytes.toBytes("1000"),Bytes.toBytes("5.3"),Bytes.toBytes("hive and hadoop"),new byte[0],Bytes.toBytes("NULL")};
  byte[][] record_3={Bytes.toBytes("200"),Bytes.toBytes("400"),Bytes.toBytes("678"),Bytes.toBytes("1000"),Bytes.toBytes("4.8"),Bytes.toBytes("hive and hadoop"),new byte[0],Bytes.toBytes("TEST")};
  RCFileOutputFormat.setColumnNumber(configuration,8);
  Path file=new Path(template.getAbsolutePath());
  FileSystem fs=FileSystem.getLocal(configuration);
  RCFile.Writer writer=new RCFile.Writer(fs,configuration,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  write(writer,record_1);
  write(writer,record_2);
  write(writer,record_3);
  writer.close();
  RCFileCat fileCat=new RCFileCat();
  RCFileCat.test=true;
  fileCat.setConf(new Configuration());
  PrintStream oldOutPrintStream=System.out;
  PrintStream oldErrPrintStream=System.err;
  ByteArrayOutputStream dataOut=new ByteArrayOutputStream();
  ByteArrayOutputStream dataErr=new ByteArrayOutputStream();
  System.setOut(new PrintStream(dataOut));
  System.setErr(new PrintStream(dataErr));
  try {
    String[] params={"--verbose","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("123\t456\t789\t1000\t5.3\thive and hadoop\t\tNULL"));
    assertTrue(dataOut.toString().contains("100\t200\t123\t1000\t5.3\thive and hadoop\t\tNULL"));
    assertTrue(dataOut.toString().contains("200\t400\t678\t1000\t4.8\thive and hadoop\t\tTEST"));
    dataOut.reset();
    params=new String[]{"--start=-10","--file-sizes","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("File size (uncompressed): 105. File size (compressed): 134. Number of rows: 3."));
    dataOut.reset();
    params=new String[]{"--start=0","--column-sizes","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("0\t9\t17"));
    assertTrue(dataOut.toString().contains("1\t9\t17"));
    assertTrue(dataOut.toString().contains("2\t9\t17"));
    assertTrue(dataOut.toString().contains("3\t12\t14"));
    assertTrue(dataOut.toString().contains("4\t9\t17"));
    assertTrue(dataOut.toString().contains("5\t45\t26"));
    dataOut.reset();
    params=new String[]{"--start=0","--column-sizes-pretty","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("Column 0: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 1: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 2: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 3: Uncompressed size: 12 Compressed size: 14"));
    assertTrue(dataOut.toString().contains("Column 4: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 5: Uncompressed size: 45 Compressed size: 26"));
    params=new String[]{};
    assertEquals(-1,fileCat.run(params));
    assertTrue(dataErr.toString().contains("RCFileCat [--start=start_offet] [--length=len] [--verbose] " + "[--column-sizes | --column-sizes-pretty] [--file-sizes] fileName"));
    dataErr.reset();
    params=new String[]{"--fakeParameter","file://" + template.toURI().getPath()};
    assertEquals(-1,fileCat.run(params));
    assertTrue(dataErr.toString().contains("RCFileCat [--start=start_offet] [--length=len] [--verbose] " + "[--column-sizes | --column-sizes-pretty] [--file-sizes] fileName"));
  }
  finally {
    System.setOut(oldOutPrintStream);
    System.setErr(oldErrPrintStream);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.TestValidReadTxnList </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void exceptions() throws Exception {
  ValidTxnList txnList=new ValidReadTxnList(new long[]{2L,4L},5);
  String str=txnList.writeToString();
  Assert.assertEquals("5:2:4",str);
  ValidTxnList newList=new ValidReadTxnList();
  newList.readFromString(str);
  Assert.assertTrue(newList.isTxnValid(1));
  Assert.assertFalse(newList.isTxnValid(2));
  Assert.assertTrue(newList.isTxnValid(3));
  Assert.assertFalse(newList.isTxnValid(4));
  Assert.assertTrue(newList.isTxnValid(5));
  Assert.assertFalse(newList.isTxnValid(6));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noExceptions() throws Exception {
  ValidTxnList txnList=new ValidReadTxnList(new long[0],1);
  String str=txnList.writeToString();
  Assert.assertEquals("1:",str);
  ValidTxnList newList=new ValidReadTxnList();
  newList.readFromString(str);
  Assert.assertTrue(newList.isTxnValid(1));
  Assert.assertFalse(newList.isTxnValid(2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.metrics.TestLegacyMetrics </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScopeConcurrency() throws Exception {
  metrics.startStoredScope(scopeName);
  LegacyMetrics.LegacyMetricsScope fooScope=(LegacyMetrics.LegacyMetricsScope)metrics.getStoredScope(scopeName);
  final int threads=10;
  ExecutorService executorService=Executors.newFixedThreadPool(threads);
  for (int i=0; i < threads; i++) {
    final int n=i;
    executorService.submit(new Callable<Void>(){
      @Override public Void call() throws Exception {
        testScopeImpl(n);
        return null;
      }
    }
);
  }
  executorService.shutdown();
  assertTrue(executorService.awaitTermination(periodMs * 3 * threads,TimeUnit.MILLISECONDS));
  fooScope=(LegacyMetrics.LegacyMetricsScope)metrics.getStoredScope(scopeName);
  assertEquals(Long.valueOf(3 * threads),fooScope.getNumCounter());
  assertTrue(fooScope.getTimeCounter().longValue() > 3 * periodMs * threads);
  Double avgT=(Double)metrics.get("foo.avg_t");
  assertTrue(avgT.doubleValue() > periodMs);
  metrics.endStoredScope(scopeName);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricsMBean() throws Exception {
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  final ObjectName oname=new ObjectName("org.apache.hadoop.hive.common.metrics:type=MetricsMBean");
  MBeanInfo mBeanInfo=mbs.getMBeanInfo(oname);
  assertEquals(MetricsMBeanImpl.class.getName(),mBeanInfo.getClassName());
  MBeanOperationInfo[] oops=mBeanInfo.getOperations();
  boolean resetFound=false;
  for (  MBeanOperationInfo op : oops) {
    if ("reset".equals(op.getName())) {
      resetFound=true;
      break;
    }
  }
  assertTrue(resetFound);
  Attribute attr=new Attribute("fooMetric",Long.valueOf(-77));
  mbs.setAttribute(oname,attr);
  mBeanInfo=mbs.getMBeanInfo(oname);
  MBeanAttributeInfo[] attrinuteInfos=mBeanInfo.getAttributes();
  assertEquals(1,attrinuteInfos.length);
  boolean attrFound=false;
  for (  MBeanAttributeInfo info : attrinuteInfos) {
    if ("fooMetric".equals(info.getName())) {
      assertEquals("java.lang.Long",info.getType());
      assertTrue(info.isReadable());
      assertTrue(info.isWritable());
      assertFalse(info.isIs());
      attrFound=true;
      break;
    }
  }
  assertTrue(attrFound);
  Object v=mbs.getAttribute(oname,"fooMetric");
  assertEquals(Long.valueOf(-77),v);
  Object result=mbs.invoke(oname,"reset",new Object[0],new String[0]);
  assertNull(result);
  v=mbs.getAttribute(oname,"fooMetric");
  assertEquals(Long.valueOf(0),v);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScopeSingleThread() throws Exception {
  metrics.startStoredScope(scopeName);
  final LegacyMetrics.LegacyMetricsScope fooScope=(LegacyMetrics.LegacyMetricsScope)metrics.getStoredScope(scopeName);
  expectIOE(new Callable<Long>(){
    @Override public Long call() throws Exception {
      Long num=fooScope.getNumCounter();
      return num;
    }
  }
);
  expectIOE(new Callable<Long>(){
    @Override public Long call() throws Exception {
      Long time=fooScope.getTimeCounter();
      return time;
    }
  }
);
  expectIOE(new Callable<Void>(){
    @Override public Void call() throws Exception {
      fooScope.open();
      return null;
    }
  }
);
  assertSame(fooScope,metrics.getStoredScope(scopeName));
  Thread.sleep(periodMs + 1);
  metrics.endStoredScope(scopeName);
  expectIOE(new Callable<Void>(){
    @Override public Void call() throws Exception {
      metrics.endStoredScope(scopeName);
      return null;
    }
  }
);
  assertEquals(Long.valueOf(1),fooScope.getNumCounter());
  final long t1=fooScope.getTimeCounter().longValue();
  assertTrue(t1 > periodMs);
  assertSame(fooScope,metrics.getStoredScope(scopeName));
  metrics.startStoredScope(scopeName);
  expectIOE(new Callable<Void>(){
    @Override public Void call() throws Exception {
      metrics.startStoredScope(scopeName);
      return null;
    }
  }
);
  assertEquals(Long.valueOf(1),fooScope.getNumCounter());
  assertEquals(t1,fooScope.getTimeCounter().longValue());
  assertSame(fooScope,metrics.getStoredScope(scopeName));
  Thread.sleep(periodMs + 1);
  fooScope.reopen();
  assertEquals(Long.valueOf(2),fooScope.getNumCounter());
  assertTrue(fooScope.getTimeCounter().longValue() > 2 * periodMs);
  Thread.sleep(periodMs + 1);
  fooScope.close();
  assertEquals(Long.valueOf(3),fooScope.getNumCounter());
  assertTrue(fooScope.getTimeCounter().longValue() > 3 * periodMs);
  Double avgT=(Double)metrics.get("foo.avg_t");
  assertTrue(avgT.doubleValue() > periodMs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.metrics.metrics2.TestCodahaleMetrics </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScope() throws Exception {
  int runs=5;
  for (int i=0; i < runs; i++) {
    MetricsFactory.getInstance().startStoredScope("method1");
    MetricsFactory.getInstance().endStoredScope("method1");
  }
  Timer timer=metricRegistry.getTimers().get("api_method1");
  Assert.assertEquals(5,timer.getCount());
  Assert.assertTrue(timer.getMeanRate() > 0);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrency() throws Exception {
  int threads=4;
  ExecutorService executorService=Executors.newFixedThreadPool(threads);
  for (int i=0; i < threads; i++) {
    final int n=i;
    executorService.submit(new Callable<Void>(){
      @Override public Void call() throws Exception {
        MetricsFactory.getInstance().startStoredScope("method2");
        MetricsFactory.getInstance().endStoredScope("method2");
        return null;
      }
    }
);
  }
  executorService.shutdown();
  assertTrue(executorService.awaitTermination(10000,TimeUnit.MILLISECONDS));
  Timer timer=metricRegistry.getTimers().get("api_method2");
  Assert.assertEquals(4,timer.getCount());
  Assert.assertTrue(timer.getMeanRate() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestDecimal128 </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashCode(){
  assertTrue(one.hashCode() != two.hashCode());
  assertTrue(zero.hashCode() != one.hashCode());
  assertTrue(zero.hashCode() != two.hashCode());
  assertEquals(zero.hashCode(),new Decimal128(0).hashCode());
  assertEquals(one.hashCode(),new Decimal128(1).hashCode());
  assertEquals(two.hashCode(),new Decimal128(2).hashCode());
  Decimal128 oneScaled=new Decimal128(1L,(short)3);
  oneScaled.changeScaleDestructive((short)0);
  assertEquals(one.hashCode(),oneScaled.hashCode());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals(){
  assertTrue(!one.equals(two));
  assertTrue(!zero.equals(one));
  assertTrue(!zero.equals(two));
  assertEquals(zero,new Decimal128(0));
  assertEquals(one,new Decimal128(1));
  assertEquals(two,new Decimal128(2));
  Decimal128 oneScaled=new Decimal128(1L,(short)3);
  oneScaled.changeScaleDestructive((short)0);
  assertEquals(one,oneScaled);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveChar </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison(){
  HiveChar hc1=new HiveChar();
  HiveChar hc2=new HiveChar();
  hc1.setValue("abc",3);
  hc2.setValue("abc",3);
  assertEquals(hc1,hc2);
  assertEquals(hc2,hc1);
  assertEquals(0,hc1.compareTo(hc2));
  assertEquals(0,hc2.compareTo(hc1));
  hc1.setValue("abc",3);
  hc1.setValue("123",3);
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
  hc1.setValue("abc",3);
  hc2.setValue("abc",5);
  assertEquals("abc",hc1.toString());
  assertEquals("abc  ",hc2.toString());
  assertEquals(hc1,hc2);
  assertEquals(hc2,hc1);
  assertEquals(0,hc1.compareTo(hc2));
  assertEquals(0,hc2.compareTo(hc1));
  hc1.setValue(" abc",4);
  hc2.setValue("abc",4);
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveDecimal </h4><pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testPlus(){
  HiveDecimal dec1=HiveDecimal.create("99999999999999999999999999999999999");
  HiveDecimal dec2=HiveDecimal.create("1");
  Assert.assertNotNull(dec1.add(dec2));
  dec1=HiveDecimal.create("3.140");
  dec2=HiveDecimal.create("1.00");
  Assert.assertEquals("4.14",dec1.add(dec2).toString());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testPow(){
  HiveDecimal dec=HiveDecimal.create("3.00001415926");
  Assert.assertEquals(dec.pow(2),dec.multiply(dec));
  HiveDecimal dec1=HiveDecimal.create("0.000017861358882");
  dec1=dec1.pow(3);
  Assert.assertNull(dec1);
  dec1=HiveDecimal.create("3.140");
  Assert.assertEquals("9.8596",dec1.pow(2).toString());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testPrecisionScaleEnforcement(){
  String decStr="1786135888657847525803324040144343378.09799306448796128931113691624";
  HiveDecimal dec=HiveDecimal.create(decStr);
  Assert.assertEquals("1786135888657847525803324040144343378.1",dec.toString());
  Assert.assertTrue("Decimal precision should not go above maximum",dec.precision() <= HiveDecimal.MAX_PRECISION);
  Assert.assertTrue("Decimal scale should not go above maximum",dec.scale() <= HiveDecimal.MAX_SCALE);
  decStr="57847525803324040144343378.09799306448796128931113691624";
  HiveDecimal bd=HiveDecimal.create(decStr);
  HiveDecimal bd1=HiveDecimal.enforcePrecisionScale(bd,20,5);
  Assert.assertNull(bd1);
  bd1=HiveDecimal.enforcePrecisionScale(bd,35,5);
  Assert.assertEquals("57847525803324040144343378.09799",bd1.toString());
  bd1=HiveDecimal.enforcePrecisionScale(bd,45,20);
  Assert.assertNull(bd1);
  dec=HiveDecimal.create(new BigDecimal(decStr),false);
  Assert.assertNull(dec);
  dec=HiveDecimal.create("-1786135888657847525803324040144343378.09799306448796128931113691624");
  Assert.assertEquals("-1786135888657847525803324040144343378.1",dec.toString());
  dec=HiveDecimal.create("005.34000");
  Assert.assertEquals(dec.precision(),3);
  Assert.assertEquals(dec.scale(),2);
  dec=HiveDecimal.create("178613588865784752580332404014434337809799306448796128931113691624");
  Assert.assertNull(dec);
  Assert.assertEquals("10",HiveDecimal.enforcePrecisionScale(HiveDecimal.create("9.5"),2,0).toString());
  Assert.assertNull(HiveDecimal.enforcePrecisionScale(HiveDecimal.create("9.5"),1,0));
  Assert.assertEquals("9",HiveDecimal.enforcePrecisionScale(HiveDecimal.create("9.4"),1,0).toString());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testDivide(){
  HiveDecimal dec1=HiveDecimal.create("3.14");
  HiveDecimal dec2=HiveDecimal.create("3");
  Assert.assertNotNull(dec1.divide(dec2));
  dec1=HiveDecimal.create("15");
  dec2=HiveDecimal.create("5");
  Assert.assertEquals("3",dec1.divide(dec2).toString());
  dec1=HiveDecimal.create("3.140");
  dec2=HiveDecimal.create("1.00");
  Assert.assertEquals("3.14",dec1.divide(dec2).toString());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testMultiply(){
  HiveDecimal dec1=HiveDecimal.create("0.00001786135888657847525803");
  HiveDecimal dec2=HiveDecimal.create("3.0000123456789");
  Assert.assertNull(dec1.multiply(dec2));
  dec1=HiveDecimal.create("178613588865784752580323232232323444.4");
  dec2=HiveDecimal.create("178613588865784752580302323232.3");
  Assert.assertNull(dec1.multiply(dec2));
  dec1=HiveDecimal.create("47.324");
  dec2=HiveDecimal.create("9232.309");
  Assert.assertEquals("436909.791116",dec1.multiply(dec2).toString());
  dec1=HiveDecimal.create("3.140");
  dec2=HiveDecimal.create("1.00");
  Assert.assertEquals("3.14",dec1.multiply(dec2).toString());
  dec1=HiveDecimal.create("43.010");
  dec2=HiveDecimal.create("2");
  Assert.assertEquals("86.02",dec1.multiply(dec2).toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveIntervalDayTime </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testValueOf() throws Exception {
  HiveIntervalDayTime i1=HiveIntervalDayTime.valueOf("3 04:05:06.123456");
  assertEquals(3,i1.getDays());
  assertEquals(4,i1.getHours());
  assertEquals(5,i1.getMinutes());
  assertEquals(6,i1.getSeconds());
  assertEquals(123456000,i1.getNanos());
  HiveIntervalDayTime i2=HiveIntervalDayTime.valueOf("+3 04:05:06");
  assertEquals(3,i2.getDays());
  assertEquals(4,i2.getHours());
  assertEquals(5,i2.getMinutes());
  assertEquals(6,i2.getSeconds());
  assertEquals(0,i2.getNanos());
  HiveIntervalDayTime i3=HiveIntervalDayTime.valueOf("-12 13:14:15.987654321");
  assertEquals(-12,i3.getDays());
  assertEquals(-13,i3.getHours());
  assertEquals(-14,i3.getMinutes());
  assertEquals(-15,i3.getSeconds());
  assertEquals(-987654321,i3.getNanos());
  HiveIntervalDayTime i4=HiveIntervalDayTime.valueOf("-0 0:0:0.000000012");
  assertEquals(0,i4.getDays());
  assertEquals(0,i4.getHours());
  assertEquals(0,i4.getMinutes());
  assertEquals(0,i4.getSeconds());
  assertEquals(-12,i4.getNanos());
  String[] invalidValues={null,"abc","0-11","0 60:0:0","0 0:60:0"};
  for (  String invalidValue : invalidValues) {
    boolean caughtException=false;
    try {
      HiveIntervalDayTime.valueOf(invalidValue);
      fail("Expected exception");
    }
 catch (    IllegalArgumentException err) {
      caughtException=true;
    }
    assertTrue("Expected exception",caughtException);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testCompare() throws Exception {
  HiveIntervalDayTime i1=new HiveIntervalDayTime(3,4,5,6,7);
  HiveIntervalDayTime i2=new HiveIntervalDayTime(3,4,5,6,7);
  HiveIntervalDayTime i3=new HiveIntervalDayTime(3,4,8,9,10);
  HiveIntervalDayTime i4=new HiveIntervalDayTime(3,4,8,9,5);
  assertEquals(i1 + " compareTo " + i1,0,i1.compareTo(i1));
  assertEquals(i1 + " compareTo " + i2,0,i1.compareTo(i2));
  assertEquals(i2 + " compareTo " + i1,0,i2.compareTo(i1));
  assertEquals(i3 + " compareTo " + i3,0,i3.compareTo(i3));
  assertTrue(i1 + " compareTo " + i3,0 > i1.compareTo(i3));
  assertTrue(i3 + " compareTo " + i1,0 < i3.compareTo(i1));
  assertTrue(i1 + " equals " + i1,i1.equals(i1));
  assertTrue(i1 + " equals " + i2,i1.equals(i2));
  assertFalse(i1 + " equals " + i3,i1.equals(i3));
  assertFalse(i3 + " equals " + i1,i3.equals(i1));
  assertFalse(i3 + " equals " + i4,i3.equals(i4));
  assertEquals(i1 + " hashCode " + i1,i1.hashCode(),i1.hashCode());
  assertEquals(i1 + " hashCode " + i1,i1.hashCode(),i2.hashCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveIntervalYearMonth </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testCompare() throws Exception {
  HiveIntervalYearMonth i1=new HiveIntervalYearMonth(1,2);
  HiveIntervalYearMonth i2=new HiveIntervalYearMonth(1,2);
  HiveIntervalYearMonth i3=new HiveIntervalYearMonth(1,3);
  assertEquals(i1 + " compareTo " + i1,0,i1.compareTo(i1));
  assertEquals(i1 + " compareTo " + i2,0,i1.compareTo(i2));
  assertEquals(i2 + " compareTo " + i1,0,i2.compareTo(i1));
  assertEquals(i3 + " compareTo " + i3,0,i3.compareTo(i3));
  assertTrue(i1 + " compareTo " + i3,0 > i1.compareTo(i3));
  assertTrue(i3 + " compareTo " + i1,0 < i3.compareTo(i1));
  assertTrue(i1 + " equals " + i1,i1.equals(i1));
  assertTrue(i1 + " equals " + i2,i1.equals(i2));
  assertFalse(i1 + " equals " + i3,i1.equals(i3));
  assertFalse(i3 + " equals " + i1,i3.equals(i1));
  assertEquals(i1 + " hashCode " + i1,i1.hashCode(),i1.hashCode());
  assertEquals(i1 + " hashCode " + i1,i1.hashCode(),i2.hashCode());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testValueOf() throws Exception {
  HiveIntervalYearMonth i1=HiveIntervalYearMonth.valueOf("1-2");
  assertEquals(1,i1.getYears());
  assertEquals(2,i1.getMonths());
  HiveIntervalYearMonth i2=HiveIntervalYearMonth.valueOf("+8-9");
  assertEquals(8,i2.getYears());
  assertEquals(9,i2.getMonths());
  HiveIntervalYearMonth i3=HiveIntervalYearMonth.valueOf("-10-11");
  assertEquals(-10,i3.getYears());
  assertEquals(-11,i3.getMonths());
  HiveIntervalYearMonth i4=HiveIntervalYearMonth.valueOf("-0-0");
  assertEquals(0,i4.getYears());
  assertEquals(0,i4.getMonths());
  String[] invalidValues={null,"abc","0-12","0 1:2:3"};
  for (  String invalidValue : invalidValues) {
    boolean caughtException=false;
    try {
      HiveIntervalYearMonth.valueOf(invalidValue);
      fail("Expected exception");
    }
 catch (    IllegalArgumentException err) {
      caughtException=true;
    }
    assertTrue("Expected exception",caughtException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveVarchar </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison() throws Exception {
  HiveVarchar hc1=new HiveVarchar("abcd",20);
  HiveVarchar hc2=new HiveVarchar("abcd",20);
  assertTrue(hc1.equals(hc2));
  assertTrue(hc2.equals(hc1));
  assertEquals(0,hc1.compareTo(hc2));
  assertEquals(0,hc2.compareTo(hc1));
  hc2=new HiveVarchar("abcde",20);
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
  hc2=new HiveVarchar("abcd  ",30);
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
  hc2=new HiveVarchar("  abcd",20);
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestSignedInt128 </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZeroClear(){
  assertFalse(one.isZero());
  assertFalse(two.isZero());
  assertTrue(0L != one.longValue());
  assertTrue(0L != two.longValue());
  two.zeroClear();
  assertTrue(0L != one.longValue());
  assertEquals(0L,two.longValue());
  assertFalse(one.isZero());
  assertTrue(two.isZero());
  one.zeroClear();
  assertEquals(0L,one.longValue());
  assertEquals(0L,two.longValue());
  assertTrue(one.isZero());
  assertTrue(two.isZero());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashCode(){
  assertTrue(one.hashCode() != two.hashCode());
  assertTrue(zero.hashCode() != one.hashCode());
  assertTrue(zero.hashCode() != two.hashCode());
  assertTrue(one.hashCode() != negativeOne.hashCode());
  assertTrue(two.hashCode() != negativeTwo.hashCode());
  assertEquals(zero.hashCode(),new SignedInt128(-0).hashCode());
  assertEquals(zero.hashCode(),new SignedInt128(0).hashCode());
  assertEquals(one.hashCode(),new SignedInt128(1).hashCode());
  assertEquals(two.hashCode(),new SignedInt128(2).hashCode());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveInt(){
  two.divideDestructive(1);
  assertEquals(1L,one.longValue());
  assertEquals(2L,two.longValue());
  one.divideDestructive(2);
  assertEquals(0L,one.longValue());
  assertEquals(2L,two.longValue());
  SignedInt128 var1=new SignedInt128(1234234662345L);
  var1.divideDestructive(642337);
  assertEquals(1234234662345L / 642337L,var1.longValue());
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  complicated1.divideDestructive(1534223465);
  BigInteger bigInteger2=BigInteger.valueOf(1534223465);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(0);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveSignedInt128(){
  SignedInt128 remainder=new SignedInt128();
  two.divideDestructive(one,remainder);
  assertEquals(1L,one.longValue());
  assertEquals(2L,two.longValue());
  assertEquals(zero,remainder);
  one.divideDestructive(two,remainder);
  assertEquals(0L,one.longValue());
  assertEquals(2L,two.longValue());
  assertEquals(new SignedInt128(1),remainder);
  SignedInt128 var1=new SignedInt128(1234234662345L);
  var1.divideDestructive(new SignedInt128(642337),remainder);
  assertEquals(1234234662345L / 642337L,var1.longValue());
  assertEquals(1234234662345L % 642337L,remainder.longValue());
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0x42395ADC);
  SignedInt128 complicated2=new SignedInt128(0xF09DC19A,0x00001234,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,remainder);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(zero,remainder);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveInt(){
  two.multiplyDestructive(1);
  assertEquals(2L,two.longValue());
  assertEquals(1L,one.longValue());
  two.multiplyDestructive(2);
  assertEquals(4L,two.longValue());
  SignedInt128 five=new SignedInt128(5);
  five.multiplyDestructive(6432346);
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  SignedInt128 big=new SignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(96);
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  SignedInt128 tmp=new SignedInt128(1);
  tmp.shiftLeftDestructive(126);
  try {
    tmp.multiplyDestructive(2);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveSignedInt128(){
  two.multiplyDestructive(one);
  assertEquals(2L,two.longValue());
  assertEquals(1L,one.longValue());
  two.multiplyDestructive(two);
  assertEquals(4L,two.longValue());
  SignedInt128 five=new SignedInt128(5);
  five.multiplyDestructive(new SignedInt128(6432346));
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  SignedInt128 big=new SignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(new SignedInt128(96));
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  SignedInt128 tmp=new SignedInt128(1);
  tmp.shiftLeftDestructive(126);
  try {
    tmp.multiplyDestructive(new SignedInt128(2));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  SignedInt128 complicated2=new SignedInt128(54234234,9,0,0);
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.multiplyDestructive(complicated2);
  BigInteger ans=bigInteger1.multiply(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    SignedInt128 complicated3=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
    complicated3.multiplyDestructive(new SignedInt128(54234234,9845,0,0));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDestructive(){
  one.addDestructive(two);
  assertEquals(3L,one.longValue());
  assertEquals(2L,two.longValue());
  SignedInt128 big=new SignedInt128((1L << 62) + 3L);
  SignedInt128 tmp=new SignedInt128(0L);
  for (int i=0; i < 54; ++i) {
    tmp.addDestructive(big);
  }
  assertEquals(3 * 54,tmp.getV0());
  assertEquals(0x80000000,tmp.getV1());
  assertEquals(13,tmp.getV2());
  assertEquals(0,tmp.getV3());
  assertEquals((1L << 62) + 3L,big.longValue());
  SignedInt128 huge=new SignedInt128(one);
  huge.shiftLeftDestructive(125);
  SignedInt128 huge2=new SignedInt128(one);
  huge2.shiftLeftDestructive(125);
  try {
    huge2.addDestructive(huge);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals(){
  assertTrue(!one.equals(two));
  assertTrue(!zero.equals(one));
  assertTrue(!zero.equals(two));
  assertEquals(zero,new SignedInt128(0));
  assertEquals(one,new SignedInt128(1));
  assertEquals(two,new SignedInt128(2));
  assertTrue(!one.equals(negativeOne));
  assertTrue(!two.equals(negativeTwo));
  assertEquals(zero,new SignedInt128(-0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestUnsignedInt128 </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveUnsignedInt128(){
  two.multiplyDestructive(one);
  assertEquals(2L,two.asLong());
  assertEquals(1L,one.asLong());
  two.multiplyDestructive(two);
  assertEquals(4L,two.asLong());
  UnsignedInt128 five=new UnsignedInt128(5);
  five.multiplyDestructive(new UnsignedInt128(6432346));
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(new UnsignedInt128(96));
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  UnsignedInt128 tmp=new UnsignedInt128(1);
  tmp.shiftLeftDestructive(126);
  tmp.multiplyDestructive(new UnsignedInt128(2));
  try {
    tmp.multiplyDestructive(new UnsignedInt128(2));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  UnsignedInt128 complicated2=new UnsignedInt128(54234234,9,0,0);
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.multiplyDestructive(complicated2);
  BigInteger ans=bigInteger1.multiply(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    UnsignedInt128 complicated3=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
    complicated3.multiplyDestructive(new UnsignedInt128(54234234,9845,0,0));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtractDestructive(){
  two.subtractDestructive(one);
  assertEquals(1L,one.asLong());
  assertEquals(1L,one.asLong());
  try {
    one.subtractDestructive(new UnsignedInt128(10L));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.shiftLeftDestructive(6);
  UnsignedInt128 tmp=new UnsignedInt128((1L << 61) + 5L);
  tmp.shiftLeftDestructive(6);
  big.subtractDestructive(tmp);
  big.subtractDestructive(tmp);
  assertEquals((3 << 6) - 2 * (5 << 6),big.getV0());
  assertEquals((3 << 8) - 1,big.getV1());
  assertEquals(0,big.getV2());
  assertEquals(0,big.getV3());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveUnsignedInt128(){
  UnsignedInt128 remainder=new UnsignedInt128();
  two.divideDestructive(one,remainder);
  assertEquals(1L,one.asLong());
  assertEquals(2L,two.asLong());
  assertEquals(zero,remainder);
  one.divideDestructive(two,remainder);
  assertEquals(0L,one.asLong());
  assertEquals(2L,two.asLong());
  assertEquals(new UnsignedInt128(1),remainder);
  UnsignedInt128 var1=new UnsignedInt128(1234234662345L);
  var1.divideDestructive(new UnsignedInt128(642337),remainder);
  assertEquals(1234234662345L / 642337L,var1.asLong());
  assertEquals(1234234662345L % 642337L,remainder.asLong());
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0x42395ADC);
  UnsignedInt128 complicated2=new UnsignedInt128(0xF09DC19A,0x00001234,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,remainder);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(zero,remainder);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveInt(){
  two.multiplyDestructive(1);
  assertEquals(2L,two.asLong());
  assertEquals(1L,one.asLong());
  two.multiplyDestructive(2);
  assertEquals(4L,two.asLong());
  UnsignedInt128 five=new UnsignedInt128(5);
  five.multiplyDestructive(6432346);
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(96);
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  UnsignedInt128 tmp=new UnsignedInt128(1);
  tmp.shiftLeftDestructive(126);
  tmp.multiplyDestructive(2);
  try {
    tmp.multiplyDestructive(2);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDestructive(){
  one.addDestructive(two);
  assertEquals(3L,one.asLong());
  assertEquals(2L,two.asLong());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + 3L);
  UnsignedInt128 tmp=new UnsignedInt128(0L);
  for (int i=0; i < 54; ++i) {
    tmp.addDestructive(big);
  }
  assertEquals(3 * 54,tmp.getV0());
  assertEquals(0x80000000,tmp.getV1());
  assertEquals(13,tmp.getV2());
  assertEquals(0,tmp.getV3());
  assertEquals((1L << 62) + 3L,big.asLong());
  UnsignedInt128 huge=one.shiftLeftConstructive(127);
  UnsignedInt128 huge2=one.shiftLeftConstructive(127);
  try {
    huge2.addDestructive(huge);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testZeroClear(){
  assertFalse(one.isZero());
  assertFalse(two.isZero());
  assertNotEquals(0L,one.asLong());
  assertNotEquals(0L,two.asLong());
  two.zeroClear();
  assertNotEquals(0L,one.asLong());
  assertEquals(0L,two.asLong());
  assertFalse(one.isZero());
  assertTrue(two.isZero());
  one.zeroClear();
  assertEquals(0L,one.asLong());
  assertEquals(0L,two.asLong());
  assertTrue(one.isZero());
  assertTrue(two.isZero());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveInt(){
  two.divideDestructive(1);
  assertEquals(1L,one.asLong());
  assertEquals(2L,two.asLong());
  one.divideDestructive(2);
  assertEquals(0L,one.asLong());
  assertEquals(2L,two.asLong());
  UnsignedInt128 var1=new UnsignedInt128(1234234662345L);
  var1.divideDestructive(642337);
  assertEquals(1234234662345L / 642337L,var1.asLong());
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  complicated1.divideDestructive(1534223465);
  BigInteger bigInteger2=BigInteger.valueOf(1534223465);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(0);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.conf.TestHiveConf </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHiddenConfig() throws Exception {
  HiveConf conf=new HiveConf();
  Assert.assertTrue(conf.isHiddenConfig(HiveConf.ConfVars.METASTOREPWD.varname));
  Assert.assertTrue(conf.isHiddenConfig(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname));
  try {
    final String name=HiveConf.ConfVars.HIVE_CONF_HIDDEN_LIST.varname;
    conf.verifyAndSet(name,"");
    Assert.fail("Setting config property " + name + " should fail");
  }
 catch (  IllegalArgumentException e) {
  }
  Configuration conf2=new Configuration(conf);
  conf2.set(HiveConf.ConfVars.METASTOREPWD.varname,"password");
  conf2.set(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname,"password");
  conf.stripHiddenConfigurations(conf2);
  Assert.assertEquals("",conf2.get(HiveConf.ConfVars.METASTOREPWD.varname));
  Assert.assertEquals("",conf2.get(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.hooks.TestHs2Hooks </h4><pre class="type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that hook context properties are correctly set.
 */
@Test public void testHookContexts() throws Throwable {
  Properties connProp=new Properties();
  connProp.setProperty("user",System.getProperty("user.name"));
  connProp.setProperty("password","");
  HiveConnection connection=new HiveConnection("jdbc:hive2://localhost:10000/default",connProp);
  Statement stmt=connection.createStatement();
  stmt.executeQuery("show databases");
  stmt.executeQuery("show tables");
  Throwable error=PostExecHook.error;
  if (error != null) {
    throw error;
  }
  error=PreExecHook.error;
  if (error != null) {
    throw error;
  }
  Assert.assertEquals(System.getProperty("user.name"),PostExecHook.userName);
  Assert.assertNotNull(PostExecHook.ipAddress,"ipaddress is null");
  Assert.assertNotNull(PostExecHook.userName,"userName is null");
  Assert.assertNotNull(PostExecHook.operation,"operation is null");
  Assert.assertTrue(PostExecHook.ipAddress,PostExecHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals("SHOWTABLES",PostExecHook.operation);
  Assert.assertEquals(System.getProperty("user.name"),PreExecHook.userName);
  Assert.assertNotNull(PreExecHook.ipAddress,"ipaddress is null");
  Assert.assertNotNull(PreExecHook.userName,"userName is null");
  Assert.assertNotNull(PreExecHook.operation,"operation is null");
  Assert.assertTrue(PreExecHook.ipAddress,PreExecHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals("SHOWTABLES",PreExecHook.operation);
  error=SemanticAnalysisHook.preAnalyzeError;
  if (error != null) {
    throw error;
  }
  error=SemanticAnalysisHook.postAnalyzeError;
  if (error != null) {
    throw error;
  }
  Assert.assertNotNull(SemanticAnalysisHook.ipAddress,"semantic hook context ipaddress is null");
  Assert.assertNotNull(SemanticAnalysisHook.userName,"semantic hook context userName is null");
  Assert.assertNotNull(SemanticAnalysisHook.command,"semantic hook context command is null");
  Assert.assertTrue(SemanticAnalysisHook.ipAddress,SemanticAnalysisHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals("show tables",SemanticAnalysisHook.command);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelCacheImpl </h4><pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPut(){
  LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,-1);
  long fn1=1, fn2=2;
  MemoryBuffer[] fakes=new MemoryBuffer[]{fb(),fb(),fb(),fb(),fb(),fb()};
  verifyRefcount(fakes,1,1,1,1,1,1);
  assertNull(cache.putFileData(fn1,drs(1,2),fbs(fakes,0,1),0,Priority.NORMAL,null));
  assertNull(cache.putFileData(fn2,drs(1,2),fbs(fakes,2,3),0,Priority.NORMAL,null));
  verifyCacheGet(cache,fn1,1,3,fakes[0],fakes[1]);
  verifyCacheGet(cache,fn2,1,3,fakes[2],fakes[3]);
  verifyCacheGet(cache,fn1,2,4,fakes[1],dr(3,4));
  verifyRefcount(fakes,3,4,3,3,1,1);
  MemoryBuffer[] bufsDiff=fbs(fakes,4,5);
  long[] mask=cache.putFileData(fn1,drs(3,1),bufsDiff,0,Priority.NORMAL,null);
  assertEquals(1,mask.length);
  assertEquals(2,mask[0]);
  assertSame(fakes[0],bufsDiff[1]);
  verifyRefcount(fakes,4,4,3,3,2,1);
  verifyCacheGet(cache,fn1,1,4,fakes[0],fakes[1],fakes[4]);
  verifyRefcount(fakes,5,5,3,3,3,1);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStaleValueReplace(){
  LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,-1);
  long fn1=1, fn2=2;
  MemoryBuffer[] fakes=new MemoryBuffer[]{fb(),fb(),fb(),fb(),fb(),fb(),fb(),fb(),fb()};
  assertNull(cache.putFileData(fn1,drs(1,2,3),fbs(fakes,0,1,2),0,Priority.NORMAL,null));
  assertNull(cache.putFileData(fn2,drs(1),fbs(fakes,3),0,Priority.NORMAL,null));
  evict(cache,fakes[0]);
  evict(cache,fakes[3]);
  long[] mask=cache.putFileData(fn1,drs(1,2,3,4),fbs(fakes,4,5,6,7),0,Priority.NORMAL,null);
  assertEquals(1,mask.length);
  assertEquals(6,mask[0]);
  assertNull(cache.putFileData(fn2,drs(1),fbs(fakes,8),0,Priority.NORMAL,null));
  verifyCacheGet(cache,fn1,1,5,fakes[4],fakes[1],fakes[2],fakes[7]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelLrfuCachePolicy </h4><pre class="type-4 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegression_HIVE_12178() throws Exception {
  LOG.info("Testing wrong list status after eviction");
  EvictionTracker et=new EvictionTracker();
  int memSize=2;
  Configuration conf=new Configuration();
  conf.setDouble(HiveConf.ConfVars.LLAP_LRFU_LAMBDA.varname,1.0f);
  final LowLevelLrfuCachePolicy lrfu=new LowLevelLrfuCachePolicy(1,memSize,conf);
  Field f=LowLevelLrfuCachePolicy.class.getDeclaredField("listLock");
  f.setAccessible(true);
  ReentrantLock listLock=(ReentrantLock)f.get(lrfu);
  LowLevelCacheMemoryManager mm=new LowLevelCacheMemoryManager(memSize,lrfu,LlapDaemonCacheMetrics.create("test","1"));
  lrfu.setEvictionListener(et);
  final LlapDataBuffer buffer1=LowLevelCacheImpl.allocateFake();
  LlapDataBuffer buffer2=LowLevelCacheImpl.allocateFake();
  assertTrue(cache(mm,lrfu,et,buffer1));
  assertTrue(cache(mm,lrfu,et,buffer2));
  buffer1.incRef();
  assertEquals(LlapCacheableBuffer.IN_LIST,buffer1.indexInHeap);
  listLock.lock();
  try {
    Thread otherThread=new Thread(new Runnable(){
      public void run(){
        lrfu.notifyLock(buffer1);
      }
    }
);
    otherThread.start();
    otherThread.join();
  }
  finally {
    listLock.unlock();
  }
  mm.reserveMemory(1,false);
  assertSame(buffer2,et.evicted.get(0));
  unlock(lrfu,buffer1);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeadlockResolution(){
  int heapSize=4;
  LOG.info("Testing deadlock resolution");
  ArrayList<LlapDataBuffer> inserted=new ArrayList<LlapDataBuffer>(heapSize);
  EvictionTracker et=new EvictionTracker();
  Configuration conf=new Configuration();
  LowLevelLrfuCachePolicy lrfu=new LowLevelLrfuCachePolicy(1,heapSize,conf);
  LowLevelCacheMemoryManager mm=new LowLevelCacheMemoryManager(heapSize,lrfu,LlapDaemonCacheMetrics.create("test","1"));
  lrfu.setEvictionListener(et);
  for (int i=0; i < heapSize; ++i) {
    LlapDataBuffer buffer=LowLevelCacheImpl.allocateFake();
    assertTrue(cache(mm,lrfu,et,buffer));
    inserted.add(buffer);
  }
  LlapDataBuffer locked=inserted.get(0);
  lock(lrfu,locked);
  mm.reserveMemory(1,false);
  LlapDataBuffer evicted=et.evicted.get(0);
  assertNotNull(evicted);
  assertTrue(evicted.isInvalid());
  assertNotSame(locked,evicted);
  unlock(lrfu,locked);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestOrcMetadataCache </h4><pre class="type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPut() throws Exception {
  DummyMemoryManager mm=new DummyMemoryManager();
  DummyCachePolicy cp=new DummyCachePolicy();
  OrcMetadataCache cache=new OrcMetadataCache(mm,cp);
  OrcFileMetadata ofm1=OrcFileMetadata.createDummy(1), ofm2=OrcFileMetadata.createDummy(2);
  assertSame(ofm1,cache.putFileMetadata(ofm1));
  assertEquals(1,mm.allocs);
  assertSame(ofm2,cache.putFileMetadata(ofm2));
  assertEquals(2,mm.allocs);
  assertSame(ofm1,cache.getFileMetadata(1));
  assertSame(ofm2,cache.getFileMetadata(2));
  OrcFileMetadata ofm3=OrcFileMetadata.createDummy(1);
  assertSame(ofm1,cache.putFileMetadata(ofm3));
  assertEquals(2,mm.allocs);
  assertSame(ofm1,cache.getFileMetadata(1));
  OrcStripeMetadata osm1=OrcStripeMetadata.createDummy(1), osm2=OrcStripeMetadata.createDummy(2);
  assertSame(osm1,cache.putStripeMetadata(osm1));
  assertEquals(3,mm.allocs);
  assertSame(osm2,cache.putStripeMetadata(osm2));
  assertEquals(4,mm.allocs);
  assertSame(osm1,cache.getStripeMetadata(osm1.getKey()));
  assertSame(osm2,cache.getStripeMetadata(osm2.getKey()));
  OrcStripeMetadata osm3=OrcStripeMetadata.createDummy(1);
  assertSame(osm1,cache.putStripeMetadata(osm3));
  assertEquals(4,mm.allocs);
  assertSame(osm1,cache.getStripeMetadata(osm3.getKey()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.daemon.impl.TestTaskExecutorService </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testFinishablePreeptsNonFinishable() throws InterruptedException {
  MockRequest r1=createMockRequest(1,1,100,false,5000l);
  MockRequest r2=createMockRequest(2,1,100,true,1000l);
  TaskExecutorServiceForTest taskExecutorService=new TaskExecutorServiceForTest(1,2,ShortestJobFirstComparator.class.getName(),true);
  taskExecutorService.init(new Configuration());
  taskExecutorService.start();
  try {
    taskExecutorService.schedule(r1);
    r1.awaitStart();
    taskExecutorService.schedule(r2);
    r2.awaitStart();
    r1.awaitEnd();
    assertTrue(r1.wasPreempted());
    assertTrue(r1.hasFinished());
    r2.complete();
    r2.awaitEnd();
    TaskExecutorServiceForTest.InternalCompletionListenerForTest icl1=taskExecutorService.getInternalCompletionListenerForTest(r1.getRequestId());
    TaskExecutorServiceForTest.InternalCompletionListenerForTest icl2=taskExecutorService.getInternalCompletionListenerForTest(r2.getRequestId());
    icl1.awaitCompletion();
    icl2.awaitCompletion();
    assertEquals(0,taskExecutorService.knownTasks.size());
  }
  finally {
    taskExecutorService.shutDown(false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testWaitQueuePreemption() throws InterruptedException {
  MockRequest r1=createMockRequest(1,1,100,true,20000l);
  MockRequest r2=createMockRequest(2,1,200,false,20000l);
  MockRequest r3=createMockRequest(3,1,300,false,20000l);
  MockRequest r4=createMockRequest(4,1,400,false,20000l);
  MockRequest r5=createMockRequest(5,1,500,true,20000l);
  TaskExecutorServiceForTest taskExecutorService=new TaskExecutorServiceForTest(1,2,ShortestJobFirstComparator.class.getName(),true);
  taskExecutorService.init(new Configuration());
  taskExecutorService.start();
  try {
    taskExecutorService.schedule(r1);
    r1.awaitStart();
    Scheduler.SubmissionState submissionState=taskExecutorService.schedule(r2);
    assertEquals(Scheduler.SubmissionState.ACCEPTED,submissionState);
    submissionState=taskExecutorService.schedule(r3);
    assertEquals(Scheduler.SubmissionState.ACCEPTED,submissionState);
    submissionState=taskExecutorService.schedule(r4);
    assertEquals(Scheduler.SubmissionState.REJECTED,submissionState);
    submissionState=taskExecutorService.schedule(r5);
    assertEquals(Scheduler.SubmissionState.EVICTED_OTHER,submissionState);
    assertEquals(true,r3.wasPreempted());
    TaskExecutorServiceForTest.InternalCompletionListenerForTest icl1=taskExecutorService.getInternalCompletionListenerForTest(r1.getRequestId());
    assertEquals(3,taskExecutorService.knownTasks.size());
    assertTrue(taskExecutorService.knownTasks.containsKey(r1.getRequestId()));
    assertTrue(taskExecutorService.knownTasks.containsKey(r2.getRequestId()));
    assertTrue(taskExecutorService.knownTasks.containsKey(r5.getRequestId()));
    r1.complete();
    r1.awaitEnd();
    icl1.awaitCompletion();
    assertEquals(2,taskExecutorService.knownTasks.size());
    assertTrue(taskExecutorService.knownTasks.containsKey(r2.getRequestId()));
    assertTrue(taskExecutorService.knownTasks.containsKey(r5.getRequestId()));
    r5.awaitStart();
    TaskExecutorServiceForTest.InternalCompletionListenerForTest icl5=taskExecutorService.getInternalCompletionListenerForTest(r5.getRequestId());
    r5.complete();
    r5.awaitEnd();
    icl5.awaitCompletion();
    assertEquals(1,taskExecutorService.knownTasks.size());
    assertTrue(taskExecutorService.knownTasks.containsKey(r2.getRequestId()));
    r2.awaitStart();
    TaskExecutorServiceForTest.InternalCompletionListenerForTest icl2=taskExecutorService.getInternalCompletionListenerForTest(r2.getRequestId());
    r2.complete();
    r2.awaitEnd();
    icl2.awaitCompletion();
    assertEquals(0,taskExecutorService.knownTasks.size());
  }
  finally {
    taskExecutorService.shutDown(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.daemon.impl.comparator.TestFirstInFirstOutComparator </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWaitQueueComparator() throws InterruptedException {
  TaskWrapper r1=createTaskWrapper(createRequest(1,2,5,100),false,100000);
  TaskWrapper r2=createTaskWrapper(createRequest(2,4,4,200),false,100000);
  TaskWrapper r3=createTaskWrapper(createRequest(3,6,3,300),false,1000000);
  TaskWrapper r4=createTaskWrapper(createRequest(4,8,2,400),false,1000000);
  TaskWrapper r5=createTaskWrapper(createRequest(5,10,1,500),false,1000000);
  EvictingPriorityBlockingQueue<TaskWrapper> queue=new EvictingPriorityBlockingQueue<>(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r2,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r3,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r4,queue.peek());
  assertEquals(r1,queue.offer(r5));
  assertEquals(r5,queue.take());
  assertEquals(r4,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r2,queue.take());
  r1=createTaskWrapper(createRequest(1,2,5,100),true,100000);
  r2=createTaskWrapper(createRequest(2,4,4,200),true,100000);
  r3=createTaskWrapper(createRequest(3,6,3,300),true,1000000);
  r4=createTaskWrapper(createRequest(4,8,2,400),true,1000000);
  r5=createTaskWrapper(createRequest(5,10,1,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r2,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r3,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r4,queue.peek());
  assertEquals(r1,queue.offer(r5));
  assertEquals(r5,queue.take());
  assertEquals(r4,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r2,queue.take());
  r1=createTaskWrapper(createRequest(1,1,5,100),true,100000);
  r2=createTaskWrapper(createRequest(2,1,4,200),false,100000);
  r3=createTaskWrapper(createRequest(3,1,3,300),true,1000000);
  r4=createTaskWrapper(createRequest(4,1,2,400),false,1000000);
  r5=createTaskWrapper(createRequest(5,10,1,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r3,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r3,queue.peek());
  assertEquals(r2,queue.offer(r5));
  assertEquals(r5,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r1,queue.take());
  assertEquals(r4,queue.take());
  r1=createTaskWrapper(createRequest(1,2,5,100),true,100000);
  r2=createTaskWrapper(createRequest(2,4,4,200),false,100000);
  r3=createTaskWrapper(createRequest(3,6,3,300),true,1000000);
  r4=createTaskWrapper(createRequest(4,8,2,400),false,1000000);
  r5=createTaskWrapper(createRequest(5,10,1,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r3,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r3,queue.peek());
  assertEquals(r2,queue.offer(r5));
  assertEquals(r5,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r1,queue.take());
  assertEquals(r4,queue.take());
  r1=createTaskWrapper(createRequest(1,2,5,100),true,100000);
  r2=createTaskWrapper(createRequest(2,4,4,200),false,100000);
  r3=createTaskWrapper(createRequest(3,6,3,300),false,1000000);
  r4=createTaskWrapper(createRequest(4,8,2,400),false,1000000);
  r5=createTaskWrapper(createRequest(5,10,1,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r1,queue.peek());
  assertEquals(r2,queue.offer(r5));
  assertEquals(r5,queue.take());
  assertEquals(r1,queue.take());
  assertEquals(r4,queue.take());
  assertEquals(r3,queue.take());
  r1=createTaskWrapper(createRequest(1,2,5,100),false,100000);
  r2=createTaskWrapper(createRequest(2,4,4,200),true,100000);
  r3=createTaskWrapper(createRequest(3,6,3,300),true,1000000);
  r4=createTaskWrapper(createRequest(4,8,2,400),true,1000000);
  r5=createTaskWrapper(createRequest(5,10,1,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r2,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r3,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r4,queue.peek());
  assertEquals(r1,queue.offer(r5));
  assertEquals(r5,queue.take());
  assertEquals(r4,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r2,queue.take());
  r1=createTaskWrapper(createRequest(1,2,5,100),false,100000);
  r2=createTaskWrapper(createRequest(2,4,4,200),true,100000);
  r3=createTaskWrapper(createRequest(3,6,3,300),true,1000000);
  r4=createTaskWrapper(createRequest(4,8,2,400),true,1000000);
  r5=createTaskWrapper(createRequest(5,10,2,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r2,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r3,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r4,queue.peek());
  assertEquals(r1,queue.offer(r5));
  assertEquals(r4,queue.take());
  assertEquals(r5,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r2,queue.take());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testWaitQueueComparatorWithinDagPriority() throws InterruptedException {
  TaskWrapper r1=createTaskWrapper(createRequest(1,1,0,100,100,10),false,100000);
  TaskWrapper r2=createTaskWrapper(createRequest(2,1,0,100,100,1),false,100000);
  TaskWrapper r3=createTaskWrapper(createRequest(3,1,0,100,100,5),false,100000);
  EvictingPriorityBlockingQueue<TaskWrapper> queue=new EvictingPriorityBlockingQueue<>(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertNull(queue.offer(r2));
  assertNull(queue.offer(r3));
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r1,queue.take());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testWaitQueueComparatorParallelism() throws InterruptedException {
  TaskWrapper r1=createTaskWrapper(createRequest(1,10,3,100,100,1),false,100000);
  TaskWrapper r2=createTaskWrapper(createRequest(2,10,7,100,100,1),false,100000);
  TaskWrapper r3=createTaskWrapper(createRequest(3,10,5,100,100,1),false,100000);
  EvictingPriorityBlockingQueue<TaskWrapper> queue=new EvictingPriorityBlockingQueue<>(new FirstInFirstOutComparator(),4);
  assertNull(queue.offer(r1));
  assertNull(queue.offer(r2));
  assertNull(queue.offer(r3));
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r1,queue.take());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.daemon.impl.comparator.TestShortestJobFirstComparator </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testWaitQueueComparator() throws InterruptedException {
  TaskWrapper r1=createTaskWrapper(createSubmitWorkRequestProto(1,2,100),false,100000);
  TaskWrapper r2=createTaskWrapper(createSubmitWorkRequestProto(2,4,200),false,100000);
  TaskWrapper r3=createTaskWrapper(createSubmitWorkRequestProto(3,6,300),false,1000000);
  TaskWrapper r4=createTaskWrapper(createSubmitWorkRequestProto(4,8,400),false,1000000);
  TaskWrapper r5=createTaskWrapper(createSubmitWorkRequestProto(5,10,500),false,1000000);
  EvictingPriorityBlockingQueue<TaskWrapper> queue=new EvictingPriorityBlockingQueue<>(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r1,queue.peek());
  assertEquals(r5,queue.offer(r5));
  assertEquals(r1,queue.take());
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r4,queue.take());
  r1=createTaskWrapper(createSubmitWorkRequestProto(1,2,100),true,100000);
  r2=createTaskWrapper(createSubmitWorkRequestProto(2,4,200),true,100000);
  r3=createTaskWrapper(createSubmitWorkRequestProto(3,6,300),true,1000000);
  r4=createTaskWrapper(createSubmitWorkRequestProto(4,8,400),true,1000000);
  r5=createTaskWrapper(createSubmitWorkRequestProto(5,10,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r1,queue.peek());
  assertEquals(r5,queue.offer(r5));
  assertEquals(r1,queue.take());
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r4,queue.take());
  r1=createTaskWrapper(createSubmitWorkRequestProto(1,1,100),true,100000);
  r2=createTaskWrapper(createSubmitWorkRequestProto(2,1,200),false,100000);
  r3=createTaskWrapper(createSubmitWorkRequestProto(3,1,300),true,1000000);
  r4=createTaskWrapper(createSubmitWorkRequestProto(4,1,400),false,1000000);
  r5=createTaskWrapper(createSubmitWorkRequestProto(5,10,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r1,queue.peek());
  assertEquals(r4,queue.offer(r5));
  assertEquals(r1,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r5,queue.take());
  assertEquals(r2,queue.take());
  r1=createTaskWrapper(createSubmitWorkRequestProto(1,2,100),true,100000);
  r2=createTaskWrapper(createSubmitWorkRequestProto(2,4,200),false,100000);
  r3=createTaskWrapper(createSubmitWorkRequestProto(3,6,300),true,1000000);
  r4=createTaskWrapper(createSubmitWorkRequestProto(4,8,400),false,1000000);
  r5=createTaskWrapper(createSubmitWorkRequestProto(5,10,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r1,queue.peek());
  assertEquals(r4,queue.offer(r5));
  assertEquals(r1,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r5,queue.take());
  assertEquals(r2,queue.take());
  r1=createTaskWrapper(createSubmitWorkRequestProto(1,2,100),true,100000);
  r2=createTaskWrapper(createSubmitWorkRequestProto(2,4,200),false,100000);
  r3=createTaskWrapper(createSubmitWorkRequestProto(3,6,300),false,1000000);
  r4=createTaskWrapper(createSubmitWorkRequestProto(4,8,400),false,1000000);
  r5=createTaskWrapper(createSubmitWorkRequestProto(5,10,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r1,queue.peek());
  assertEquals(r4,queue.offer(r5));
  assertEquals(r1,queue.take());
  assertEquals(r5,queue.take());
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  r1=createTaskWrapper(createSubmitWorkRequestProto(1,2,100),false,100000);
  r2=createTaskWrapper(createSubmitWorkRequestProto(2,4,200),true,100000);
  r3=createTaskWrapper(createSubmitWorkRequestProto(3,6,300),true,1000000);
  r4=createTaskWrapper(createSubmitWorkRequestProto(4,8,400),true,1000000);
  r5=createTaskWrapper(createSubmitWorkRequestProto(5,10,500),true,1000000);
  queue=new EvictingPriorityBlockingQueue(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertEquals(r1,queue.peek());
  assertNull(queue.offer(r2));
  assertEquals(r2,queue.peek());
  assertNull(queue.offer(r3));
  assertEquals(r2,queue.peek());
  assertNull(queue.offer(r4));
  assertEquals(r2,queue.peek());
  assertEquals(r1,queue.offer(r5));
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r4,queue.take());
  assertEquals(r5,queue.take());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testWaitQueueComparatorWithinDagPriority() throws InterruptedException {
  TaskWrapper r1=createTaskWrapper(createSubmitWorkRequestProto(1,1,0,100,10),false,100000);
  TaskWrapper r2=createTaskWrapper(createSubmitWorkRequestProto(2,1,0,100,1),false,100000);
  TaskWrapper r3=createTaskWrapper(createSubmitWorkRequestProto(3,1,0,100,5),false,100000);
  EvictingPriorityBlockingQueue<TaskWrapper> queue=new EvictingPriorityBlockingQueue<>(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertNull(queue.offer(r2));
  assertNull(queue.offer(r3));
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r1,queue.take());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testWaitQueueComparatorParallelism() throws InterruptedException {
  TaskWrapper r1=createTaskWrapper(createSubmitWorkRequestProto(1,10,3,100,1),false,100000);
  TaskWrapper r2=createTaskWrapper(createSubmitWorkRequestProto(2,10,7,100,1),false,100000);
  TaskWrapper r3=createTaskWrapper(createSubmitWorkRequestProto(3,10,5,100,1),false,100000);
  EvictingPriorityBlockingQueue<TaskWrapper> queue=new EvictingPriorityBlockingQueue<>(new ShortestJobFirstComparator(),4);
  assertNull(queue.offer(r1));
  assertNull(queue.offer(r2));
  assertNull(queue.offer(r3));
  assertEquals(r2,queue.take());
  assertEquals(r3,queue.take());
  assertEquals(r1,queue.take());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.tez.TestLlapDaemonProtocolClientProxy </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testMultipleNodes(){
  RequestManagerForTest requestManager=new RequestManagerForTest(1);
  LlapNodeId nodeId1=LlapNodeId.getInstance("host1",1025);
  LlapNodeId nodeId2=LlapNodeId.getInstance("host2",1025);
  Message mockMessage=mock(Message.class);
  LlapProtocolClientProxy.ExecuteRequestCallback mockExecuteRequestCallback=mock(LlapProtocolClientProxy.ExecuteRequestCallback.class);
  requestManager.queueRequest(new CallableRequestForTest(nodeId1,mockMessage,mockExecuteRequestCallback));
  requestManager.queueRequest(new CallableRequestForTest(nodeId2,mockMessage,mockExecuteRequestCallback));
  requestManager.process();
  assertEquals(2,requestManager.numSubmissionsCounters);
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId1));
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId2));
  Assert.assertEquals(1,requestManager.numInvocationsPerNode.get(nodeId1).getValue().intValue());
  Assert.assertEquals(1,requestManager.numInvocationsPerNode.get(nodeId2).getValue().intValue());
  assertEquals(0,requestManager.currentLoopSkippedRequests.size());
  assertEquals(0,requestManager.currentLoopSkippedRequests.size());
  assertEquals(0,requestManager.currentLoopDisabledNodes.size());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testSingleInvocationPerNode(){
  RequestManagerForTest requestManager=new RequestManagerForTest(1);
  LlapNodeId nodeId1=LlapNodeId.getInstance("host1",1025);
  Message mockMessage=mock(Message.class);
  LlapProtocolClientProxy.ExecuteRequestCallback mockExecuteRequestCallback=mock(LlapProtocolClientProxy.ExecuteRequestCallback.class);
  requestManager.queueRequest(new CallableRequestForTest(nodeId1,mockMessage,mockExecuteRequestCallback));
  requestManager.process();
  assertEquals(1,requestManager.numSubmissionsCounters);
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId1));
  Assert.assertEquals(1,requestManager.numInvocationsPerNode.get(nodeId1).getValue().intValue());
  assertEquals(0,requestManager.currentLoopSkippedRequests.size());
  requestManager.queueRequest(new CallableRequestForTest(nodeId1,mockMessage,mockExecuteRequestCallback));
  requestManager.process();
  assertEquals(1,requestManager.numSubmissionsCounters);
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId1));
  Assert.assertEquals(1,requestManager.numInvocationsPerNode.get(nodeId1).getValue().intValue());
  assertEquals(1,requestManager.currentLoopSkippedRequests.size());
  assertEquals(1,requestManager.currentLoopDisabledNodes.size());
  assertTrue(requestManager.currentLoopDisabledNodes.contains(nodeId1));
  requestManager.requestFinished(nodeId1);
  requestManager.process();
  assertEquals(2,requestManager.numSubmissionsCounters);
  assertNotNull(requestManager.numInvocationsPerNode.get(nodeId1));
  Assert.assertEquals(2,requestManager.numInvocationsPerNode.get(nodeId1).getValue().intValue());
  assertEquals(0,requestManager.currentLoopSkippedRequests.size());
  assertEquals(0,requestManager.currentLoopDisabledNodes.size());
  assertFalse(requestManager.currentLoopDisabledNodes.contains(nodeId1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskCommunicator </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testEntityTracker1(){
  LlapTaskCommunicator.EntityTracker entityTracker=new LlapTaskCommunicator.EntityTracker();
  String host1="host1";
  String host2="host2";
  String host3="host3";
  int port=1451;
  ContainerId containerId101=constructContainerId(101);
  entityTracker.registerContainer(containerId101,host1,port);
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForContainer(containerId101));
  entityTracker.unregisterContainer(containerId101);
  assertNull(entityTracker.getContainerAttemptMapForNode(LlapNodeId.getInstance(host1,port)));
  assertNull(entityTracker.getNodeIdForContainer(containerId101));
  assertEquals(0,entityTracker.nodeMap.size());
  assertEquals(0,entityTracker.attemptToNodeMap.size());
  assertEquals(0,entityTracker.containerToNodeMap.size());
  ContainerId containerId1=constructContainerId(1);
  TezTaskAttemptID taskAttemptId1=constructTaskAttemptId(1);
  entityTracker.registerTaskAttempt(containerId1,taskAttemptId1,host1,port);
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForContainer(containerId1));
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForTaskAttempt(taskAttemptId1));
  entityTracker.unregisterTaskAttempt(taskAttemptId1);
  assertNull(entityTracker.getContainerAttemptMapForNode(LlapNodeId.getInstance(host1,port)));
  assertNull(entityTracker.getNodeIdForContainer(containerId1));
  assertNull(entityTracker.getNodeIdForTaskAttempt(taskAttemptId1));
  assertEquals(0,entityTracker.nodeMap.size());
  assertEquals(0,entityTracker.attemptToNodeMap.size());
  assertEquals(0,entityTracker.containerToNodeMap.size());
  ContainerId containerId201=constructContainerId(201);
  TezTaskAttemptID taskAttemptId201=constructTaskAttemptId(201);
  entityTracker.registerTaskAttempt(containerId201,taskAttemptId201,host1,port);
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForContainer(containerId201));
  assertEquals(LlapNodeId.getInstance(host1,port),entityTracker.getNodeIdForTaskAttempt(taskAttemptId201));
  entityTracker.unregisterContainer(containerId201);
  assertNull(entityTracker.getContainerAttemptMapForNode(LlapNodeId.getInstance(host1,port)));
  assertNull(entityTracker.getNodeIdForContainer(containerId201));
  assertNull(entityTracker.getNodeIdForTaskAttempt(taskAttemptId201));
  assertEquals(0,entityTracker.nodeMap.size());
  assertEquals(0,entityTracker.attemptToNodeMap.size());
  assertEquals(0,entityTracker.containerToNodeMap.size());
  entityTracker.unregisterTaskAttempt(taskAttemptId201);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService </h4><pre class="type-5 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testNodeDisabled() throws IOException, InterruptedException {
  TestTaskSchedulerServiceWrapper tsWrapper=new TestTaskSchedulerServiceWrapper(10000l);
  try {
    Priority priority1=Priority.newInstance(1);
    String[] hosts1=new String[]{HOST1};
    Object task1=new Object();
    Object clientCookie1=new Object();
    tsWrapper.controlScheduler(true);
    tsWrapper.allocateTask(task1,hosts1,priority1,clientCookie1);
    while (true) {
      tsWrapper.signalSchedulerRun();
      tsWrapper.awaitSchedulerRun();
      if (tsWrapper.ts.dagStats.numTotalAllocations == 1) {
        break;
      }
    }
    verify(tsWrapper.mockAppCallback).taskAllocated(eq(task1),eq(clientCookie1),any(Container.class));
    assertEquals(1,tsWrapper.ts.dagStats.numLocalAllocations);
    assertEquals(0,tsWrapper.ts.dagStats.numAllocationsNoLocalityRequest);
    assertEquals(0,tsWrapper.ts.dagStats.numNonLocalAllocations);
    assertEquals(1,tsWrapper.ts.dagStats.numTotalAllocations);
    tsWrapper.resetAppCallback();
    tsWrapper.clock.setTime(10000l);
    tsWrapper.rejectExecution(task1);
    assertEquals(1,tsWrapper.ts.dagStats.numRejectedTasks);
    assertEquals(3,tsWrapper.ts.instanceToNodeMap.size());
    LlapTaskSchedulerService.NodeInfo disabledNodeInfo=tsWrapper.ts.disabledNodesQueue.peek();
    assertNotNull(disabledNodeInfo);
    assertEquals(HOST1,disabledNodeInfo.serviceInstance.getHost());
    assertEquals((10000l),disabledNodeInfo.getDelay(TimeUnit.MILLISECONDS));
    assertEquals((10000l + 10000l),disabledNodeInfo.expireTimeMillis);
    Object task2=new Object();
    Object clientCookie2=new Object();
    tsWrapper.allocateTask(task2,hosts1,priority1,clientCookie2);
    while (true) {
      tsWrapper.signalSchedulerRun();
      tsWrapper.awaitSchedulerRun();
      if (tsWrapper.ts.dagStats.numTotalAllocations == 2) {
        break;
      }
    }
    verify(tsWrapper.mockAppCallback).taskAllocated(eq(task2),eq(clientCookie2),any(Container.class));
    assertEquals(1,tsWrapper.ts.dagStats.numLocalAllocations);
    assertEquals(0,tsWrapper.ts.dagStats.numAllocationsNoLocalityRequest);
    assertEquals(1,tsWrapper.ts.dagStats.numNonLocalAllocations);
    assertEquals(2,tsWrapper.ts.dagStats.numTotalAllocations);
  }
  finally {
    tsWrapper.shutdown();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestAggregateStatsCache </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicAddAndGet() throws Exception {
  List<String> partNames=preparePartNames(tables.get(0),1,9);
  BloomFilter bloomFilter=prepareBloomFilter(partNames);
  String tblName=tables.get(0);
  String colName=tabCols.get(0);
  int highVal=100, lowVal=10, numDVs=50, numNulls=5;
  ColumnStatisticsObj aggrColStats=getDummyLongColStat(colName,highVal,lowVal,numDVs,numNulls);
  cache.add(DB_NAME,tblName,colName,10,aggrColStats,bloomFilter);
  AggrColStats aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNotNull(aggrStatsCached);
  ColumnStatisticsObj aggrColStatsCached=aggrStatsCached.getColStats();
  Assert.assertEquals(aggrColStats,aggrColStatsCached);
  aggrStatsCached=cache.get("dbNotThere",tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddGetWithVariance() throws Exception {
  List<String> partNames=preparePartNames(tables.get(0),1,9);
  BloomFilter bloomFilter=prepareBloomFilter(partNames);
  String tblName=tables.get(0);
  String colName=tabCols.get(0);
  int highVal=100, lowVal=10, numDVs=50, numNulls=5;
  ColumnStatisticsObj aggrColStats=getDummyLongColStat(colName,highVal,lowVal,numDVs,numNulls);
  cache.add(DB_NAME,tblName,colName,10,aggrColStats,bloomFilter);
  partNames=preparePartNames(tables.get(0),1,5);
  AggrColStats aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
  partNames=preparePartNames(tables.get(0),11,20);
  aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
  partNames=preparePartNames(tables.get(0),1,8);
  aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNotNull(aggrStatsCached);
  ColumnStatisticsObj aggrColStatsCached=aggrStatsCached.getColStats();
  Assert.assertEquals(aggrColStats,aggrColStatsCached);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestFilterHooks </h4><pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForPartition() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    assertNotNull(msc.getPartition(DBNAME1,TAB2,"name=value1"));
    fail("getPartition() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
  assertEquals(0,msc.getPartitionsByNames(DBNAME1,TAB2,Lists.newArrayList("name=value1")).size());
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForDb() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    assertNotNull(msc.getDatabase(DBNAME1));
    fail("getDatabase() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
  assertEquals(0,msc.getDatabases("*").size());
  assertEquals(0,msc.getAllDatabases().size());
  assertEquals(0,msc.getDatabases(DBNAME1).size());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultFilter() throws Exception {
  assertNotNull(msc.getTable(DBNAME1,TAB1));
  assertEquals(3,msc.getTables(DBNAME1,"*").size());
  assertEquals(3,msc.getAllTables(DBNAME1).size());
  assertEquals(1,msc.getTables(DBNAME1,TAB2).size());
  assertEquals(0,msc.getAllTables(DBNAME2).size());
  assertNotNull(msc.getDatabase(DBNAME1));
  assertEquals(3,msc.getDatabases("*").size());
  assertEquals(3,msc.getAllDatabases().size());
  assertEquals(1,msc.getDatabases(DBNAME1).size());
  assertNotNull(msc.getPartition(DBNAME1,TAB2,"name=value1"));
  assertEquals(1,msc.getPartitionsByNames(DBNAME1,TAB2,Lists.newArrayList("name=value1")).size());
  assertNotNull(msc.getIndex(DBNAME1,TAB1,INDEX1));
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForTables() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    msc.getTable(DBNAME1,TAB1);
    fail("getTable() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
  assertEquals(0,msc.getTables(DBNAME1,"*").size());
  assertEquals(0,msc.getAllTables(DBNAME1).size());
  assertEquals(0,msc.getTables(DBNAME1,TAB2).size());
}

</code></pre>

<br>
<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyFilterForIndex() throws Exception {
  DummyMetaStoreFilterHookImpl.blockResults=true;
  try {
    assertNotNull(msc.getIndex(DBNAME1,TAB1,INDEX1));
    fail("getPartition() should fail with blocking mode");
  }
 catch (  NoSuchObjectException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStore </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test table objects can be retrieved in batches
 * @throws Exception
 */
@Test public void testGetTableObjects() throws Exception {
  String dbName="db";
  List<String> tableNames=Arrays.asList("table1","table2","table3","table4","table5");
  silentDropDatabase(dbName);
  Database db=new Database();
  db.setName(dbName);
  client.createDatabase(db);
  for (  String tableName : tableNames) {
    createTable(dbName,tableName);
  }
  List<Table> tableObjs=client.getTableObjectsByName(dbName,tableNames);
  assertEquals(tableNames.size(),tableObjs.size());
  for (  Table table : tableObjs) {
    assertTrue(tableNames.contains(table.getTableName().toLowerCase()));
  }
  client.dropDatabase(dbName,true,true,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStorePartitionSpecs </h4><pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to confirm that partitions can be added using PartitionSpecs.
 */
@Test public void testAddPartitions(){
  try {
    HiveMetaStoreClient hmsc=new HiveMetaStoreClient(hiveConf);
    clearAndRecreateDB(hmsc);
    createTable(hmsc,true);
    Table table=hmsc.getTable(dbName,tableName);
    populatePartitions(hmsc,table,Arrays.asList("isLocatedInTablePath","isLocatedOutsideTablePath"));
    String targetTableName="cloned_" + tableName;
    Table targetTable=new Table(table);
    targetTable.setTableName(targetTableName);
    StorageDescriptor targetTableSd=new StorageDescriptor(targetTable.getSd());
    targetTableSd.setLocation(targetTableSd.getLocation().replace(tableName,targetTableName));
    hmsc.createTable(targetTable);
    PartitionSpecProxy partitionsForAddition=hmsc.listPartitionSpecsByFilter(dbName,tableName,"blurb = \"isLocatedInTablePath\"",-1);
    partitionsForAddition.setTableName(targetTableName);
    partitionsForAddition.setRootLocation(targetTableSd.getLocation());
    Assert.assertEquals("Unexpected number of partitions added. ",partitionsForAddition.size(),hmsc.add_partitions_pspec(partitionsForAddition));
    PartitionSpecProxy clonedPartitions=hmsc.listPartitionSpecs(dbName,targetTableName,-1);
    Assert.assertEquals("Unexpected number of partitions returned. ",partitionsForAddition.size(),clonedPartitions.size());
    PartitionSpecProxy.PartitionIterator sourceIterator=partitionsForAddition.getPartitionIterator(), targetIterator=clonedPartitions.getPartitionIterator();
    while (targetIterator.hasNext()) {
      Partition sourcePartition=sourceIterator.next(), targetPartition=targetIterator.next();
      Assert.assertEquals("Mismatched values.",sourcePartition.getValues(),targetPartition.getValues());
      Assert.assertEquals("Mismatched locations.",sourcePartition.getSd().getLocation(),targetPartition.getSd().getLocation());
    }
  }
 catch (  Throwable t) {
    LOG.error("Unexpected Exception!",t);
    t.printStackTrace();
    Assert.assertTrue("Unexpected Exception!",false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test to confirm that Partition-grouping behaves correctly when Table-schemas evolve.
 * Partitions must be grouped by location and schema.
 */
@Test public void testFetchingPartitionsWithDifferentSchemas(){
  try {
    HiveMetaStoreClient hmsc=new HiveMetaStoreClient(hiveConf);
    clearAndRecreateDB(hmsc);
    createTable(hmsc,true);
    Table table=hmsc.getTable(dbName,tableName);
    populatePartitions(hmsc,table,Arrays.asList("isLocatedInTablePath","isLocatedOutsideTablePath"));
    List<FieldSchema> fields=table.getSd().getCols();
    fields.add(new FieldSchema("goo","string","Entirely new column. Doesn't apply to older partitions."));
    table.getSd().setCols(fields);
    hmsc.alter_table(dbName,tableName,table);
    table=hmsc.getTable(dbName,tableName);
    Assert.assertEquals("Unexpected number of table columns.",3,table.getSd().getColsSize());
    populatePartitions(hmsc,table,Arrays.asList("hasNewColumn"));
    PartitionSpecProxy partitionSpecProxy=hmsc.listPartitionSpecs(dbName,tableName,-1);
    Assert.assertEquals("Unexpected number of partitions.",nDates * 3,partitionSpecProxy.size());
    Assert.assertTrue("Unexpected type of PartitionSpecProxy.",partitionSpecProxy instanceof CompositePartitionSpecProxy);
    CompositePartitionSpecProxy compositePartitionSpecProxy=(CompositePartitionSpecProxy)partitionSpecProxy;
    List<PartitionSpec> partitionSpecs=compositePartitionSpecProxy.toPartitionSpec();
    Assert.assertTrue("PartitionSpec[0] should have been a SharedSDPartitionSpec.",partitionSpecs.get(0).isSetSharedSDPartitionSpec());
    Assert.assertEquals("PartitionSpec[0] should use the table-path as the common root location. ",table.getSd().getLocation(),partitionSpecs.get(0).getRootPath());
    Assert.assertTrue("PartitionSpec[1] should have been a SharedSDPartitionSpec.",partitionSpecs.get(1).isSetSharedSDPartitionSpec());
    Assert.assertEquals("PartitionSpec[1] should use the table-path as the common root location. ",table.getSd().getLocation(),partitionSpecs.get(1).getRootPath());
    Assert.assertTrue("PartitionSpec[2] should have been a ListComposingPartitionSpec.",partitionSpecs.get(2).isSetPartitionList());
    PartitionSpecProxy.PartitionIterator iterator=partitionSpecProxy.getPartitionIterator();
    Map<String,List<Partition>> blurbToPartitionList=new HashMap<String,List<Partition>>(3);
    while (iterator.hasNext()) {
      Partition partition=iterator.next();
      String blurb=partition.getValues().get(1);
      if (!blurbToPartitionList.containsKey(blurb)) {
        blurbToPartitionList.put(blurb,new ArrayList<Partition>(nDates));
      }
      blurbToPartitionList.get(blurb).add(partition);
    }
    for (    Partition partition : blurbToPartitionList.get("isLocatedOutsideTablePath")) {
      Assert.assertEquals("Unexpected number of columns.",2,partition.getSd().getCols().size());
      Assert.assertEquals("Unexpected first column.","foo",partition.getSd().getCols().get(0).getName());
      Assert.assertEquals("Unexpected second column.","bar",partition.getSd().getCols().get(1).getName());
      String partitionLocation=partition.getSd().getLocation();
      String tableLocation=table.getSd().getLocation();
      Assert.assertTrue("Unexpected partition location: " + partitionLocation + ". "+ "Partition should have been outside table location: "+ tableLocation,!partitionLocation.startsWith(tableLocation));
    }
    for (    Partition partition : blurbToPartitionList.get("isLocatedInTablePath")) {
      Assert.assertEquals("Unexpected number of columns.",2,partition.getSd().getCols().size());
      Assert.assertEquals("Unexpected first column.","foo",partition.getSd().getCols().get(0).getName());
      Assert.assertEquals("Unexpected second column.","bar",partition.getSd().getCols().get(1).getName());
      String partitionLocation=partition.getSd().getLocation();
      String tableLocation=table.getSd().getLocation();
      Assert.assertTrue("Unexpected partition location: " + partitionLocation + ". "+ "Partition should have been within table location: "+ tableLocation,partitionLocation.startsWith(tableLocation));
    }
    for (    Partition partition : blurbToPartitionList.get("hasNewColumn")) {
      Assert.assertEquals("Unexpected number of columns.",3,partition.getSd().getCols().size());
      Assert.assertEquals("Unexpected first column.","foo",partition.getSd().getCols().get(0).getName());
      Assert.assertEquals("Unexpected second column.","bar",partition.getSd().getCols().get(1).getName());
      Assert.assertEquals("Unexpected third column.","goo",partition.getSd().getCols().get(2).getName());
      String partitionLocation=partition.getSd().getLocation();
      String tableLocation=table.getSd().getLocation();
      Assert.assertTrue("Unexpected partition location: " + partitionLocation + ". "+ "Partition should have been within table location: "+ tableLocation,partitionLocation.startsWith(tableLocation));
    }
  }
 catch (  Throwable t) {
    LOG.error("Unexpected Exception!",t);
    t.printStackTrace();
    Assert.assertTrue("Unexpected Exception!",false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStoreTimeout </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeout() throws Exception {
  HiveMetaStore.TEST_TIMEOUT_VALUE=15 * 1000;
  String dbName="db";
  client.dropDatabase(dbName,true,true);
  Database db=new Database();
  db.setName(dbName);
  try {
    client.createDatabase(db);
    Assert.fail("should throw timeout exception.");
  }
 catch (  MetaException e) {
    Assert.assertTrue("unexpected MetaException",e.getMessage().contains("Timeout when " + "executing method: create_database"));
  }
  HiveMetaStore.TEST_TIMEOUT_VALUE=5 * 1000;
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResetTimeout() throws Exception {
  HiveMetaStore.TEST_TIMEOUT_VALUE=5 * 1000;
  String dbName="db";
  client.dropDatabase(dbName,true,true);
  Database db=new Database();
  db.setName(dbName);
  try {
    client.createDatabase(db);
  }
 catch (  MetaException e) {
    Assert.fail("should not throw timeout exception: " + e.getMessage());
  }
  client.dropDatabase(dbName,true,true);
  client.setMetaConf(HiveConf.ConfVars.METASTORE_CLIENT_SOCKET_TIMEOUT.varname,"3s");
  try {
    client.createDatabase(db);
    Assert.fail("should throw timeout exception.");
  }
 catch (  MetaException e) {
    Assert.assertTrue("unexpected MetaException",e.getMessage().contains("Timeout when " + "executing method: create_database"));
  }
  client.dropDatabase(dbName,true,true);
  client.setMetaConf(HiveConf.ConfVars.METASTORE_CLIENT_SOCKET_TIMEOUT.varname,"10s");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTxns() throws Exception {
  List<Long> tids=client.openTxns("me",3).getTxn_ids();
  Assert.assertEquals(1L,(long)tids.get(0));
  Assert.assertEquals(2L,(long)tids.get(1));
  Assert.assertEquals(3L,(long)tids.get(2));
  client.rollbackTxn(1);
  client.commitTxn(2);
  ValidTxnList validTxns=client.getValidTxns();
  Assert.assertFalse(validTxns.isTxnValid(1));
  Assert.assertTrue(validTxns.isTxnValid(2));
  Assert.assertFalse(validTxns.isTxnValid(3));
  Assert.assertFalse(validTxns.isTxnValid(4));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpenTxnNotExcluded() throws Exception {
  List<Long> tids=client.openTxns("me",3).getTxn_ids();
  Assert.assertEquals(1L,(long)tids.get(0));
  Assert.assertEquals(2L,(long)tids.get(1));
  Assert.assertEquals(3L,(long)tids.get(2));
  client.rollbackTxn(1);
  client.commitTxn(2);
  ValidTxnList validTxns=client.getValidTxns(3);
  Assert.assertFalse(validTxns.isTxnValid(1));
  Assert.assertTrue(validTxns.isTxnValid(2));
  Assert.assertTrue(validTxns.isTxnValid(3));
  Assert.assertFalse(validTxns.isTxnValid(4));
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringifyValidTxns() throws Exception {
  ValidTxnList validTxns=new ValidReadTxnList("1:");
  String asString=validTxns.toString();
  Assert.assertEquals("1:",asString);
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(1,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(0,validTxns.getInvalidTransactions().length);
  asString=validTxns.toString();
  Assert.assertEquals("1:",asString);
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(1,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(0,validTxns.getInvalidTransactions().length);
  validTxns=new ValidReadTxnList("10:5:3");
  asString=validTxns.toString();
  if (!asString.equals("10:3:5") && !asString.equals("10:5:3")) {
    Assert.fail("Unexpected string value " + asString);
  }
  validTxns=new ValidReadTxnList(asString);
  Assert.assertEquals(10,validTxns.getHighWatermark());
  Assert.assertNotNull(validTxns.getInvalidTransactions());
  Assert.assertEquals(2,validTxns.getInvalidTransactions().length);
  boolean sawThree=false, sawFive=false;
  for (  long tid : validTxns.getInvalidTransactions()) {
    if (tid == 3)     sawThree=true;
 else     if (tid == 5)     sawFive=true;
 else     Assert.fail("Unexpected value " + tid);
  }
  Assert.assertTrue(sawThree);
  Assert.assertTrue(sawFive);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestLockRequestBuilder </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noUser(){
  LockRequestBuilder bldr=new LockRequestBuilder();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  bldr.addLockComponent(comp);
  comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  bldr.addLockComponent(comp);
  boolean caughtException=false;
  try {
    LockRequest req=bldr.build();
  }
 catch (  RuntimeException e) {
    Assert.assertEquals("Cannot build a lock without giving a user",e.getMessage());
    caughtException=true;
  }
  Assert.assertTrue(caughtException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestServerSpecificConfig </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure that system properties still get precedence. Config params set as
 * -hiveconf on commandline get set as system properties They should have the
 * final say
 */
@Test public void testSystemPropertyPrecedence(){
  final String OVERRIDE_KEY="hive.conf.restricted.list";
  try {
    HiveConf.setHiveSiteLocation(oldDefaultHiveSite);
    System.setProperty(OVERRIDE_KEY,"from.sysprop");
    HiveConf conf=new HiveConf();
    assertEquals("from.sysprop",conf.get(OVERRIDE_KEY));
    new HiveServer2();
    conf=new HiveConf();
    assertTrue(HiveConf.isLoadHiveServer2Config());
    assertEquals("from.sysprop",conf.get(OVERRIDE_KEY));
  }
  finally {
    System.getProperties().remove(OVERRIDE_KEY);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify if appropriate server configuration (metastore, hiveserver2) get
 * loaded when the embedded clients are loaded
 * Checks values used in the configs used for testing.
 * @throws IOException
 * @throws Throwable
 */
@Test public void testServerConfigsEmbeddedMetastore() throws IOException, Throwable {
  HiveConf.setHiveSiteLocation(oldDefaultHiveSite);
  HiveConf conf=new HiveConf();
  assertTrue(HiveConf.isLoadMetastoreConfig());
  assertEquals("from.hivemetastore-site.xml",conf.get("hive.dummyparam.test.server.specific.config.override"));
  assertEquals("from.hivemetastore-site.xml",conf.get("hive.dummyparam.test.server.specific.config.metastoresite"));
  assertEquals("from.hive-site.xml",conf.get("hive.dummyparam.test.server.specific.config.hivesite"));
  assertFalse(HiveConf.isLoadHiveServer2Config());
  assertNull(conf.get("hive.dummyparam.test.server.specific.config.hiveserver2site"));
  new HiveServer2();
  conf=new HiveConf();
  verifyHS2ConfParams(conf);
  assertEquals("from.hivemetastore-site.xml",conf.get("hive.dummyparam.test.server.specific.config.metastoresite"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseFilterPlanUtil </h4><pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionKeyScannerMixedType() throws Exception {
  List<FieldSchema> parts=new ArrayList<FieldSchema>();
  parts.add(new FieldSchema("year","int",null));
  parts.add(new FieldSchema("month","int",null));
  parts.add(new FieldSchema("state","string",null));
  ExpressionTree exprTree=PartFilterExprUtil.getFilterParser("year = 2015 and state = 'CA'").tree;
  PlanResult planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  ScanPlan sp=planRes.plan.getPlans().get(0);
  byte[] startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  byte[] endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  RowFilter filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,Shorts.toByteArray((short)2015)));
  Assert.assertTrue(Bytes.contains(endRowSuffix,Shorts.toByteArray((short)2016)));
  PartitionKeyComparator comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ranges.size(),1);
  Assert.assertEquals(comparator.ranges.get(0).keyName,"state");
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionKeyScannerAllString() throws Exception {
  List<FieldSchema> parts=new ArrayList<FieldSchema>();
  parts.add(new FieldSchema("year","string",null));
  parts.add(new FieldSchema("month","string",null));
  parts.add(new FieldSchema("state","string",null));
  ExpressionTree exprTree=PartFilterExprUtil.getFilterParser("year = 2015 and state = 'CA'").tree;
  PlanResult planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  ScanPlan sp=planRes.plan.getPlans().get(0);
  byte[] startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  byte[] endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  RowFilter filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2015".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2015".getBytes()));
  Assert.assertFalse(Bytes.contains(startRowSuffix,"CA".getBytes()));
  Assert.assertFalse(Bytes.contains(endRowSuffix,"CA".getBytes()));
  PartitionKeyComparator comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ranges.size(),1);
  Assert.assertEquals(comparator.ranges.get(0).keyName,"state");
  exprTree=PartFilterExprUtil.getFilterParser("year = 2015 and month > 10 " + "and month <= 11 and state like 'C%'").tree;
  planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  sp=planRes.plan.getPlans().get(0);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2015".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2015".getBytes()));
  Assert.assertTrue(Bytes.contains(startRowSuffix,"10".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"11".getBytes()));
  comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ops.size(),1);
  Assert.assertEquals(comparator.ops.get(0).keyName,"state");
  exprTree=PartFilterExprUtil.getFilterParser("year >= 2014 and month > 10 " + "and month <= 11 and state like 'C%'").tree;
  planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  sp=planRes.plan.getPlans().get(0);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2014".getBytes()));
  comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ranges.size(),1);
  Assert.assertEquals(comparator.ranges.get(0).keyName,"month");
  Assert.assertEquals(comparator.ops.size(),1);
  Assert.assertEquals(comparator.ops.get(0).keyName,"state");
  exprTree=PartFilterExprUtil.getFilterParser("year = 2014 and (month > 10 " + "or month < 3)").tree;
  planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  sp=planRes.plan.getPlans().get(0);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(startRowSuffix,"10".getBytes()));
  sp=planRes.plan.getPlans().get(1);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"3".getBytes()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseImport </h4><pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importSecurity() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"securitydb1","securitydb2"};
  String[] roles=new String[]{"securityrole1","securityrole2"};
  String[] tokenIds=new String[]{"securitytokenid1","securitytokenid2"};
  String[] tokens=new String[]{"securitytoken1","securitytoken2"};
  String[] masterKeys=new String[]{"securitymk1","securitymk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  HBaseImport importer=new HBaseImport("-k");
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Assert.assertEquals(baseNumDbs,store.getAllDatabases().size());
  for (int i=0; i < tokenIds.length; i++) {
    Assert.assertEquals(tokens[i],store.getToken(tokenIds[i]));
  }
  String[] hbaseKeys=store.getMasterKeys();
  Set<String> keys=new HashSet<>(Arrays.asList(hbaseKeys));
  for (int i=0; i < masterKeys.length; i++) {
    Assert.assertTrue(keys.contains(masterKeys[i]));
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneRole() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"oneroledb1","oneroledb2"};
  String[] roles=new String[]{"onerolerole1","onerolerole2"};
  String[] tokenIds=new String[]{"oneroletokenid1","oneroletokenid2"};
  String[] tokens=new String[]{"oneroletoken1","oneroletoken2"};
  String[] masterKeys=new String[]{"onerolemk1","onerolemk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  HBaseImport importer=new HBaseImport("-r",roles[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Role role=store.getRole(roles[0]);
  Assert.assertNotNull(role);
  Assert.assertEquals(roles[0],role.getRoleName());
  Assert.assertEquals(baseNumRoles + 1,store.listRoleNames().size());
  Assert.assertEquals(baseNumDbs,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
  thrown.expect(NoSuchObjectException.class);
  store.getRole(roles[1]);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importAll() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"alldb1","alldb2"};
  String[] roles=new String[]{"allrole1","allrole2"};
  String[] tokenIds=new String[]{"alltokenid1","alltokenid2"};
  String[] tokens=new String[]{"alltoken1","alltoken2"};
  String[] masterKeys=new String[]{"allmk1","allmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  HBaseImport importer=new HBaseImport("-a");
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < roles.length; i++) {
    Role role=store.getRole(roles[i]);
    Assert.assertNotNull(role);
    Assert.assertEquals(roles[i],role.getRoleName());
  }
  Assert.assertEquals(baseNumRoles + 2,store.listRoleNames().size());
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    Assert.assertEquals("file:/tmp",db.getLocationUri());
    Table table=store.getTable(db.getName(),tableNames[0]);
    Assert.assertNotNull(table);
    Assert.assertEquals(now,table.getLastAccessTime());
    Assert.assertEquals("input",table.getSd().getInputFormat());
    table=store.getTable(db.getName(),tableNames[1]);
    Assert.assertNotNull(table);
    for (int j=0; j < partVals.length; j++) {
      Partition part=store.getPartition(dbNames[i],tableNames[1],Arrays.asList(partVals[j]));
      Assert.assertNotNull(part);
      Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
    }
    Assert.assertEquals(4,store.getPartitions(dbNames[i],tableNames[1],-1).size());
    Assert.assertEquals(2,store.getAllTables(dbNames[i]).size());
    Assert.assertEquals(2,store.getFunctions(dbNames[i],"*").size());
    for (int j=0; j < funcNames.length; j++) {
      Assert.assertNotNull(store.getFunction(dbNames[i],funcNames[j]));
    }
  }
  Assert.assertEquals(baseNumDbs + 2,store.getAllDatabases().size());
  for (int i=0; i < tokenIds.length; i++) {
    Assert.assertEquals(tokens[i],store.getToken(tokenIds[i]));
  }
  String[] hbaseKeys=store.getMasterKeys();
  Set<String> keys=new HashSet<>(Arrays.asList(hbaseKeys));
  for (int i=0; i < masterKeys.length; i++) {
    Assert.assertTrue(keys.contains(masterKeys[i]));
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneFunc() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onefuncdb1","onefuncdb2"};
  String[] roles=new String[]{"onefuncrole1","onefuncrole2"};
  String[] tokenIds=new String[]{"onefunctokenid1","onefunctokenid2"};
  String[] tokens=new String[]{"onefunctoken1","onefunctoken2"};
  String[] masterKeys=new String[]{"onefuncmk1","onefuncmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-f",dbNames[0] + "." + funcNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Assert.assertEquals(0,store.getAllTables(dbNames[0]).size());
  Assert.assertEquals(1,store.getFunctions(dbNames[0],"*").size());
  Assert.assertNotNull(store.getFunction(dbNames[0],funcNames[0]));
  Assert.assertNull(store.getFunction(dbNames[0],funcNames[1]));
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneTableNonPartitioned() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onetabdb1","onetabdb2"};
  String[] roles=new String[]{"onetabrole1","onetabrole2"};
  String[] tokenIds=new String[]{"onetabtokenid1","onetabtokenid2"};
  String[] tokens=new String[]{"onetabtoken1","onetabtoken2"};
  String[] masterKeys=new String[]{"onetabmk1","onetabmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-t",dbNames[0] + "." + tableNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Table table=store.getTable(db.getName(),tableNames[0]);
  Assert.assertNotNull(table);
  Assert.assertEquals(1,store.getAllTables(db.getName()).size());
  Assert.assertNull(store.getTable(db.getName(),tableNames[1]));
  Assert.assertEquals(0,store.getFunctions(dbNames[0],"*").size());
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parallel() throws Exception {
  int parallelFactor=10;
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"paralleldb1"};
  int now=(int)System.currentTimeMillis() / 1000;
  for (int i=0; i < dbNames.length; i++) {
    rdbms.createDatabase(new Database(dbNames[i],"no description","file:/tmp",emptyParameters));
    List<FieldSchema> cols=new ArrayList<>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    List<FieldSchema> partCols=new ArrayList<>();
    partCols.add(new FieldSchema("region","string",""));
    for (int j=0; j < parallelFactor; j++) {
      rdbms.createTable(new Table("t" + j,dbNames[i],"me",now,now,0,sd,partCols,emptyParameters,null,null,null));
      for (int k=0; k < parallelFactor; k++) {
        StorageDescriptor psd=new StorageDescriptor(sd);
        psd.setLocation("file:/tmp/region=" + k);
        Partition part=new Partition(Arrays.asList("p" + k),dbNames[i],"t" + j,now,now,psd,emptyParameters);
        rdbms.addPartition(part);
      }
    }
  }
  HBaseImport importer=new HBaseImport("-p","2","-b","2","-d",dbNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    for (int j=0; j < parallelFactor; j++) {
      Table table=store.getTable(db.getName(),"t" + j);
      Assert.assertNotNull(table);
      Assert.assertEquals(now,table.getLastAccessTime());
      Assert.assertEquals("input",table.getSd().getInputFormat());
      for (int k=0; k < parallelFactor; k++) {
        Partition part=store.getPartition(dbNames[i],"t" + j,Arrays.asList("p" + k));
        Assert.assertNotNull(part);
        Assert.assertEquals("file:/tmp/region=" + k,part.getSd().getLocation());
      }
      Assert.assertEquals(parallelFactor,store.getPartitions(dbNames[i],"t" + j,-1).size());
    }
    Assert.assertEquals(parallelFactor,store.getAllTables(dbNames[i]).size());
  }
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneTablePartitioned() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onetabpartdb1","onetabpartodb2"};
  String[] roles=new String[]{"onetabpartorole1","onetabpartorole2"};
  String[] tokenIds=new String[]{"onetabpartotokenid1","onetabpartotokenid2"};
  String[] tokens=new String[]{"onetabpartotoken1","onetabpartotoken2"};
  String[] masterKeys=new String[]{"onetabpartomk1","onetabpartomk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  store.createDatabase(new Database(dbNames[0],"no description","file:/tmp",emptyParameters));
  HBaseImport importer=new HBaseImport("-t",dbNames[0] + "." + tableNames[1]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Table table=store.getTable(db.getName(),tableNames[1]);
  Assert.assertNotNull(table);
  Assert.assertEquals(1,store.getAllTables(db.getName()).size());
  for (int j=0; j < partVals.length; j++) {
    Partition part=store.getPartition(dbNames[0],tableNames[1],Arrays.asList(partVals[j]));
    Assert.assertNotNull(part);
    Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
  }
  Assert.assertEquals(4,store.getPartitions(dbNames[0],tableNames[1],-1).size());
  Assert.assertNull(store.getTable(db.getName(),tableNames[0]));
  Assert.assertEquals(0,store.getFunctions(dbNames[0],"*").size());
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importOneDb() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"onedbdb1","onedbdb2"};
  String[] roles=new String[]{"onedbrole1","onedbrole2"};
  String[] tokenIds=new String[]{"onedbtokenid1","onedbtokenid2"};
  String[] tokens=new String[]{"onedbtoken1","onedbtoken2"};
  String[] masterKeys=new String[]{"onedbmk1","onedbmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  int baseNumToks=store.getAllTokenIdentifiers() == null ? 0 : store.getAllTokenIdentifiers().size();
  int baseNumKeys=store.getMasterKeys() == null ? 0 : store.getMasterKeys().length;
  HBaseImport importer=new HBaseImport("-d",dbNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Database db=store.getDatabase(dbNames[0]);
  Assert.assertNotNull(db);
  Assert.assertEquals("file:/tmp",db.getLocationUri());
  Table table=store.getTable(db.getName(),tableNames[0]);
  Assert.assertNotNull(table);
  Assert.assertEquals(now,table.getLastAccessTime());
  Assert.assertEquals("input",table.getSd().getInputFormat());
  table=store.getTable(db.getName(),tableNames[1]);
  Assert.assertNotNull(table);
  for (int j=0; j < partVals.length; j++) {
    Partition part=store.getPartition(dbNames[0],tableNames[1],Arrays.asList(partVals[j]));
    Assert.assertNotNull(part);
    Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
  }
  Assert.assertEquals(4,store.getPartitions(dbNames[0],tableNames[1],-1).size());
  Assert.assertEquals(2,store.getAllTables(dbNames[0]).size());
  Assert.assertEquals(2,store.getFunctions(dbNames[0],"*").size());
  for (int j=0; j < funcNames.length; j++) {
    Assert.assertNotNull(store.getFunction(dbNames[0],funcNames[j]));
  }
  Assert.assertEquals(baseNumDbs + 1,store.getAllDatabases().size());
  Assert.assertEquals(baseNumToks,store.getAllTokenIdentifiers().size());
  String[] hbaseKeys=store.getMasterKeys();
  Assert.assertEquals(baseNumKeys,hbaseKeys.length);
  thrown.expect(NoSuchObjectException.class);
  store.getDatabase(dbNames[1]);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parallelOdd() throws Exception {
  int parallelFactor=9;
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"oddparalleldb1"};
  int now=(int)System.currentTimeMillis() / 1000;
  for (int i=0; i < dbNames.length; i++) {
    rdbms.createDatabase(new Database(dbNames[i],"no description","file:/tmp",emptyParameters));
    List<FieldSchema> cols=new ArrayList<>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    List<FieldSchema> partCols=new ArrayList<>();
    partCols.add(new FieldSchema("region","string",""));
    for (int j=0; j < parallelFactor; j++) {
      rdbms.createTable(new Table("t" + j,dbNames[i],"me",now,now,0,sd,partCols,emptyParameters,null,null,null));
      for (int k=0; k < parallelFactor; k++) {
        StorageDescriptor psd=new StorageDescriptor(sd);
        psd.setLocation("file:/tmp/region=" + k);
        Partition part=new Partition(Arrays.asList("p" + k),dbNames[i],"t" + j,now,now,psd,emptyParameters);
        rdbms.addPartition(part);
      }
    }
  }
  HBaseImport importer=new HBaseImport("-p","2","-b","2","-d",dbNames[0]);
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    for (int j=0; j < parallelFactor; j++) {
      Table table=store.getTable(db.getName(),"t" + j);
      Assert.assertNotNull(table);
      Assert.assertEquals(now,table.getLastAccessTime());
      Assert.assertEquals("input",table.getSd().getInputFormat());
      for (int k=0; k < parallelFactor; k++) {
        Partition part=store.getPartition(dbNames[i],"t" + j,Arrays.asList("p" + k));
        Assert.assertNotNull(part);
        Assert.assertEquals("file:/tmp/region=" + k,part.getSd().getLocation());
      }
      Assert.assertEquals(parallelFactor,store.getPartitions(dbNames[i],"t" + j,-1).size());
    }
    Assert.assertEquals(parallelFactor,store.getAllTables(dbNames[i]).size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStore </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void binaryPartitionStatistics() throws Exception {
  createMockTableAndPartition(BINARY_TYPE,BINARY_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,BINARY_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=binaryColStatsObjs.get(0);
  BinaryColumnStatsData binaryData=obj.getStatsData().getBinaryStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(BINARY_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,dataFromDB.getSetField());
  BinaryColumnStatsData binaryDataFromDB=dataFromDB.getBinaryStats();
  Assert.assertEquals(binaryData.getMaxColLen(),binaryDataFromDB.getMaxColLen());
  Assert.assertEquals(binaryData.getAvgColLen(),binaryDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(binaryData.getNumNulls(),binaryDataFromDB.getNumNulls());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doubleTableStatistics() throws Exception {
  createMockTable(DOUBLE_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DOUBLE_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalTableStatistics() throws Exception {
  createMockTable(DECIMAL_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DECIMAL_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringPartitionStatistics() throws Exception {
  createMockTableAndPartition(STRING_TYPE,STRING_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,STRING_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(STRING_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void booleanTableStatistics() throws Exception {
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=booleanColStatsObjs.get(0);
  BooleanColumnStatsData boolData=obj.getStatsData().getBooleanStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(BOOLEAN_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,dataFromDB.getSetField());
  BooleanColumnStatsData boolDataFromDB=dataFromDB.getBooleanStats();
  Assert.assertEquals(boolData.getNumTrues(),boolDataFromDB.getNumTrues());
  Assert.assertEquals(boolData.getNumFalses(),boolDataFromDB.getNumFalses());
  Assert.assertEquals(boolData.getNumNulls(),boolDataFromDB.getNumNulls());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void hashSd() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",true,0,serde,null,null,emptyParameters);
  Map<List<String>,String> map=new HashMap<List<String>,String>();
  map.put(Arrays.asList("col3"),"col4");
  SkewedInfo skew=new SkewedInfo(Arrays.asList("col1"),Arrays.asList(Arrays.asList("col2")),map);
  sd.setSkewedInfo(skew);
  MessageDigest md=MessageDigest.getInstance("MD5");
  byte[] baseHash=HBaseUtils.hashStorageDescriptor(sd,md);
  StorageDescriptor changeSchema=new StorageDescriptor(sd);
  changeSchema.getCols().add(new FieldSchema("col2","varchar(32)","a comment"));
  byte[] schemaHash=HBaseUtils.hashStorageDescriptor(changeSchema,md);
  Assert.assertFalse(Arrays.equals(baseHash,schemaHash));
  StorageDescriptor changeLocation=new StorageDescriptor(sd);
  changeLocation.setLocation("file:/somewhere/else");
  byte[] locationHash=HBaseUtils.hashStorageDescriptor(changeLocation,md);
  Assert.assertArrayEquals(baseHash,locationHash);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void alterPartition() throws Exception {
  String tableName="alterparttable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,DB,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> vals=Arrays.asList("fred");
  StorageDescriptor psd=new StorageDescriptor(sd);
  psd.setLocation("file:/tmp/pc=fred");
  Partition part=new Partition(vals,DB,tableName,startTime,startTime,psd,emptyParameters);
  store.addPartition(part);
  part.setLastAccessTime(startTime + 10);
  store.alterPartition(DB,tableName,vals,part);
  Partition p=store.getPartition(DB,tableName,vals);
  Assert.assertEquals(1,p.getSd().getColsSize());
  Assert.assertEquals("col1",p.getSd().getCols().get(0).getName());
  Assert.assertEquals("int",p.getSd().getCols().get(0).getType());
  Assert.assertEquals("nocomment",p.getSd().getCols().get(0).getComment());
  Assert.assertEquals("serde",p.getSd().getSerdeInfo().getName());
  Assert.assertEquals("seriallib",p.getSd().getSerdeInfo().getSerializationLib());
  Assert.assertEquals("file:/tmp/pc=fred",p.getSd().getLocation());
  Assert.assertEquals("input",p.getSd().getInputFormat());
  Assert.assertEquals("output",p.getSd().getOutputFormat());
  Assert.assertEquals(DB,p.getDbName());
  Assert.assertEquals(tableName,p.getTableName());
  Assert.assertEquals(1,p.getValuesSize());
  Assert.assertEquals("fred",p.getValues().get(0));
  Assert.assertEquals(startTime + 10,p.getLastAccessTime());
  Assert.assertTrue(store.doesPartitionExist(DB,tableName,vals));
  Assert.assertFalse(store.doesPartitionExist(DB,tableName,Arrays.asList("bob")));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longTableStatistics() throws Exception {
  createMockTable(LONG_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(LONG_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringTableStatistics() throws Exception {
  createMockTable(STRING_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(STRING_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longPartitionStatistics() throws Exception {
  createMockTableAndPartition(INT_TYPE,INT_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,INT_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(INT_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createRole() throws Exception {
  int now=(int)System.currentTimeMillis() / 1000;
  String roleName="myrole";
  store.addRole(roleName,"me");
  Role r=store.getRole(roleName);
  Assert.assertEquals(roleName,r.getRoleName());
  Assert.assertEquals("me",r.getOwnerName());
  Assert.assertTrue(now <= r.getCreateTime());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTable() throws Exception {
  String tableName="mytable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  Map<String,String> params=new HashMap<String,String>();
  params.put("key","value");
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,17,serde,Arrays.asList("bucketcol"),Arrays.asList(new Order("sortcol",1)),params);
  Table table=new Table(tableName,"default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  Table t=store.getTable("default",tableName);
  Assert.assertEquals(1,t.getSd().getColsSize());
  Assert.assertEquals("col1",t.getSd().getCols().get(0).getName());
  Assert.assertEquals("int",t.getSd().getCols().get(0).getType());
  Assert.assertEquals("",t.getSd().getCols().get(0).getComment());
  Assert.assertEquals("serde",t.getSd().getSerdeInfo().getName());
  Assert.assertEquals("seriallib",t.getSd().getSerdeInfo().getSerializationLib());
  Assert.assertEquals("file:/tmp",t.getSd().getLocation());
  Assert.assertEquals("input",t.getSd().getInputFormat());
  Assert.assertEquals("output",t.getSd().getOutputFormat());
  Assert.assertFalse(t.getSd().isCompressed());
  Assert.assertEquals(17,t.getSd().getNumBuckets());
  Assert.assertEquals(1,t.getSd().getBucketColsSize());
  Assert.assertEquals("bucketcol",t.getSd().getBucketCols().get(0));
  Assert.assertEquals(1,t.getSd().getSortColsSize());
  Assert.assertEquals("sortcol",t.getSd().getSortCols().get(0).getCol());
  Assert.assertEquals(1,t.getSd().getSortCols().get(0).getOrder());
  Assert.assertEquals(1,t.getSd().getParametersSize());
  Assert.assertEquals("value",t.getSd().getParameters().get("key"));
  Assert.assertEquals("me",t.getOwner());
  Assert.assertEquals("default",t.getDbName());
  Assert.assertEquals(tableName,t.getTableName());
  Assert.assertEquals(0,t.getParametersSize());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalPartitionStatistics() throws Exception {
  createMockTableAndPartition(DECIMAL_TYPE,DECIMAL_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DECIMAL_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DECIMAL_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createPartition() throws Exception {
  String tableName="myparttable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,DB,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> vals=Arrays.asList("fred");
  StorageDescriptor psd=new StorageDescriptor(sd);
  psd.setLocation("file:/tmp/pc=fred");
  Partition part=new Partition(vals,DB,tableName,startTime,startTime,psd,emptyParameters);
  store.addPartition(part);
  Partition p=store.getPartition(DB,tableName,vals);
  Assert.assertEquals(1,p.getSd().getColsSize());
  Assert.assertEquals("col1",p.getSd().getCols().get(0).getName());
  Assert.assertEquals("int",p.getSd().getCols().get(0).getType());
  Assert.assertEquals("nocomment",p.getSd().getCols().get(0).getComment());
  Assert.assertEquals("serde",p.getSd().getSerdeInfo().getName());
  Assert.assertEquals("seriallib",p.getSd().getSerdeInfo().getSerializationLib());
  Assert.assertEquals("file:/tmp/pc=fred",p.getSd().getLocation());
  Assert.assertEquals("input",p.getSd().getInputFormat());
  Assert.assertEquals("output",p.getSd().getOutputFormat());
  Assert.assertEquals(DB,p.getDbName());
  Assert.assertEquals(tableName,p.getTableName());
  Assert.assertEquals(1,p.getValuesSize());
  Assert.assertEquals("fred",p.getValues().get(0));
  Assert.assertTrue(store.doesPartitionExist(DB,tableName,vals));
  Assert.assertFalse(store.doesPartitionExist(DB,tableName,Arrays.asList("bob")));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createFunction() throws Exception {
  String funcName="createfunc";
  int now=(int)(System.currentTimeMillis() / 1000);
  Function func=new Function(funcName,DB,"o.a.h.h.myfunc","me",PrincipalType.USER,now,FunctionType.JAVA,Arrays.asList(new ResourceUri(ResourceType.JAR,"file:/tmp/somewhere")));
  store.createFunction(func);
  Function f=store.getFunction(DB,funcName);
  Assert.assertEquals(DB,f.getDbName());
  Assert.assertEquals(funcName,f.getFunctionName());
  Assert.assertEquals("o.a.h.h.myfunc",f.getClassName());
  Assert.assertEquals("me",f.getOwnerName());
  Assert.assertEquals(PrincipalType.USER,f.getOwnerType());
  Assert.assertTrue(now <= f.getCreateTime());
  Assert.assertEquals(FunctionType.JAVA,f.getFunctionType());
  Assert.assertEquals(1,f.getResourceUrisSize());
  Assert.assertEquals(ResourceType.JAR,f.getResourceUris().get(0).getResourceType());
  Assert.assertEquals("file:/tmp/somewhere",f.getResourceUris().get(0).getUri());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void skewInfo() throws Exception {
  String tableName="mytable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",true,0,serde,null,null,emptyParameters);
  Map<List<String>,String> map=new HashMap<List<String>,String>();
  map.put(Arrays.asList("col3"),"col4");
  SkewedInfo skew=new SkewedInfo(Arrays.asList("col1"),Arrays.asList(Arrays.asList("col2")),map);
  sd.setSkewedInfo(skew);
  Table table=new Table(tableName,"default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  Table t=store.getTable("default",tableName);
  Assert.assertEquals(1,t.getSd().getColsSize());
  Assert.assertEquals("col1",t.getSd().getCols().get(0).getName());
  Assert.assertEquals("int",t.getSd().getCols().get(0).getType());
  Assert.assertEquals("",t.getSd().getCols().get(0).getComment());
  Assert.assertEquals("serde",t.getSd().getSerdeInfo().getName());
  Assert.assertEquals("seriallib",t.getSd().getSerdeInfo().getSerializationLib());
  Assert.assertEquals("file:/tmp",t.getSd().getLocation());
  Assert.assertEquals("input",t.getSd().getInputFormat());
  Assert.assertEquals("output",t.getSd().getOutputFormat());
  Assert.assertTrue(t.getSd().isCompressed());
  Assert.assertEquals(0,t.getSd().getNumBuckets());
  Assert.assertEquals(0,t.getSd().getSortColsSize());
  Assert.assertEquals("me",t.getOwner());
  Assert.assertEquals("default",t.getDbName());
  Assert.assertEquals(tableName,t.getTableName());
  Assert.assertEquals(0,t.getParametersSize());
  skew=t.getSd().getSkewedInfo();
  Assert.assertNotNull(skew);
  Assert.assertEquals(1,skew.getSkewedColNamesSize());
  Assert.assertEquals("col1",skew.getSkewedColNames().get(0));
  Assert.assertEquals(1,skew.getSkewedColValuesSize());
  Assert.assertEquals("col2",skew.getSkewedColValues().get(0).get(0));
  Assert.assertEquals(1,skew.getSkewedColValueLocationMapsSize());
  Assert.assertEquals("col4",skew.getSkewedColValueLocationMaps().get(Arrays.asList("col3")));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doublePartitionStatistics() throws Exception {
  createMockTableAndPartition(DOUBLE_TYPE,DOUBLE_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DOUBLE_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DOUBLE_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void binaryTableStatistics() throws Exception {
  createMockTable(BINARY_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=binaryColStatsObjs.get(0);
  BinaryColumnStatsData binaryData=obj.getStatsData().getBinaryStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(BINARY_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,dataFromDB.getSetField());
  BinaryColumnStatsData binaryDataFromDB=dataFromDB.getBinaryStats();
  Assert.assertEquals(binaryData.getMaxColLen(),binaryDataFromDB.getMaxColLen());
  Assert.assertEquals(binaryData.getAvgColLen(),binaryDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(binaryData.getNumNulls(),binaryDataFromDB.getNumNulls());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void booleanPartitionStatistics() throws Exception {
  createMockTableAndPartition(BOOLEAN_TYPE,BOOLEAN_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,BOOLEAN_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=booleanColStatsObjs.get(0);
  BooleanColumnStatsData boolData=obj.getStatsData().getBooleanStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(BOOLEAN_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,dataFromDB.getSetField());
  BooleanColumnStatsData boolDataFromDB=dataFromDB.getBooleanStats();
  Assert.assertEquals(boolData.getNumTrues(),boolDataFromDB.getNumTrues());
  Assert.assertEquals(boolData.getNumFalses(),boolDataFromDB.getNumFalses());
  Assert.assertEquals(boolData.getNumNulls(),boolDataFromDB.getNumNulls());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreBitVector </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalPartitionStatistics() throws Exception {
  createMockTableAndPartition(DECIMAL_TYPE,DECIMAL_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DECIMAL_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DECIMAL_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
  Assert.assertEquals(decimalData.getBitVectors(),decimalDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longTableStatistics() throws Exception {
  createMockTable(LONG_COL,LONG_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(LONG_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
  Assert.assertEquals(longData.getBitVectors(),longDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doubleTableStatistics() throws Exception {
  createMockTable(DOUBLE_COL,DOUBLE_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DOUBLE_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
  Assert.assertEquals(doubleData.getBitVectors(),doubleDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalTableStatistics() throws Exception {
  createMockTable(DECIMAL_COL,DECIMAL_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DECIMAL_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
  Assert.assertEquals(decimalData.getBitVectors(),decimalDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longPartitionStatistics() throws Exception {
  createMockTableAndPartition(INT_TYPE,INT_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,INT_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(INT_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
  Assert.assertEquals(longData.getBitVectors(),longDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringTableStatistics() throws Exception {
  createMockTable(STRING_COL,STRING_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(STRING_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
  Assert.assertEquals(stringData.getBitVectors(),stringDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doublePartitionStatistics() throws Exception {
  createMockTableAndPartition(DOUBLE_TYPE,DOUBLE_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DOUBLE_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DOUBLE_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
  Assert.assertEquals(doubleData.getBitVectors(),doubleDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringPartitionStatistics() throws Exception {
  createMockTableAndPartition(STRING_TYPE,STRING_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,STRING_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(STRING_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
  Assert.assertEquals(stringData.getBitVectors(),stringDataFromDB.getBitVectors());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreCached </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void booleanTableStatistics() throws Exception {
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String boolcol="boolcol";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema(boolcol,"boolean","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table(tableName,dbname,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  long trues=37;
  long falses=12;
  long booleanNulls=2;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(boolcol);
  obj.setColType("boolean");
  ColumnStatisticsData data=new ColumnStatisticsData();
  BooleanColumnStatsData boolData=new BooleanColumnStatsData();
  boolData.setNumTrues(trues);
  boolData.setNumFalses(falses);
  boolData.setNumNulls(booleanNulls);
  data.setBooleanStats(boolData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,colData.getSetField());
  boolData=colData.getBooleanStats();
  Assert.assertEquals(trues,boolData.getNumTrues());
  Assert.assertEquals(falses,boolData.getNumFalses());
  Assert.assertEquals(booleanNulls,boolData.getNumNulls());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreIntegration </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tableStatistics() throws Exception {
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String boolcol="boolcol";
  String longcol="longcol";
  String doublecol="doublecol";
  String stringcol="stringcol";
  String binarycol="bincol";
  String decimalcol="deccol";
  long trues=37;
  long falses=12;
  long booleanNulls=2;
  long longHigh=120938479124L;
  long longLow=-12341243213412124L;
  long longNulls=23;
  long longDVs=213L;
  double doubleHigh=123423.23423;
  double doubleLow=0.00001234233;
  long doubleNulls=92;
  long doubleDVs=1234123421L;
  long strMaxLen=1234;
  double strAvgLen=32.3;
  long strNulls=987;
  long strDVs=906;
  long binMaxLen=123412987L;
  double binAvgLen=76.98;
  long binNulls=976998797L;
  Decimal decHigh=new Decimal();
  decHigh.setScale((short)3);
  decHigh.setUnscaled("3876".getBytes());
  Decimal decLow=new Decimal();
  decLow.setScale((short)3);
  decLow.setUnscaled("38".getBytes());
  long decNulls=13;
  long decDVs=923947293L;
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema(boolcol,"boolean","nocomment"));
  cols.add(new FieldSchema(longcol,"long","nocomment"));
  cols.add(new FieldSchema(doublecol,"double","nocomment"));
  cols.add(new FieldSchema(stringcol,"varchar(32)","nocomment"));
  cols.add(new FieldSchema(binarycol,"binary","nocomment"));
  cols.add(new FieldSchema(decimalcol,"decimal(5, 3)","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table(tableName,dbname,"me",(int)now / 1000,(int)now / 1000,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(boolcol);
  obj.setColType("boolean");
  ColumnStatisticsData data=new ColumnStatisticsData();
  BooleanColumnStatsData boolData=new BooleanColumnStatsData();
  boolData.setNumTrues(trues);
  boolData.setNumFalses(falses);
  boolData.setNumNulls(booleanNulls);
  data.setBooleanStats(boolData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(longcol);
  obj.setColType("long");
  data=new ColumnStatisticsData();
  LongColumnStatsData longData=new LongColumnStatsData();
  longData.setHighValue(longHigh);
  longData.setLowValue(longLow);
  longData.setNumNulls(longNulls);
  longData.setNumDVs(longDVs);
  data.setLongStats(longData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(doublecol);
  obj.setColType("double");
  data=new ColumnStatisticsData();
  DoubleColumnStatsData doubleData=new DoubleColumnStatsData();
  doubleData.setHighValue(doubleHigh);
  doubleData.setLowValue(doubleLow);
  doubleData.setNumNulls(doubleNulls);
  doubleData.setNumDVs(doubleDVs);
  data.setDoubleStats(doubleData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol,longcol,doublecol));
  Assert.assertEquals(3,stats.getStatsObjSize());
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol));
  Assert.assertEquals(1,stats.getStatsObjSize());
  stats=new ColumnStatistics();
  stats.setStatsDesc(desc);
  obj=new ColumnStatisticsObj();
  obj.setColName(stringcol);
  obj.setColType("string");
  data=new ColumnStatisticsData();
  StringColumnStatsData strData=new StringColumnStatsData();
  strData.setMaxColLen(strMaxLen);
  strData.setAvgColLen(strAvgLen);
  strData.setNumNulls(strNulls);
  strData.setNumDVs(strDVs);
  data.setStringStats(strData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(binarycol);
  obj.setColType("binary");
  data=new ColumnStatisticsData();
  BinaryColumnStatsData binData=new BinaryColumnStatsData();
  binData.setMaxColLen(binMaxLen);
  binData.setAvgColLen(binAvgLen);
  binData.setNumNulls(binNulls);
  data.setBinaryStats(binData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(decimalcol);
  obj.setColType("decimal(5,3)");
  data=new ColumnStatisticsData();
  DecimalColumnStatsData decData=new DecimalColumnStatsData();
  LOG.debug("Setting decimal high value to " + decHigh.getScale() + " <"+ new String(decHigh.getUnscaled())+ ">");
  decData.setHighValue(decHigh);
  decData.setLowValue(decLow);
  decData.setNumNulls(decNulls);
  decData.setNumDVs(decDVs);
  data.setDecimalStats(decData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol,longcol,doublecol,stringcol,binarycol,decimalcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(6,stats.getStatsObjSize());
  ColumnStatisticsData colData=stats.getStatsObj().get(0).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,colData.getSetField());
  boolData=colData.getBooleanStats();
  Assert.assertEquals(trues,boolData.getNumTrues());
  Assert.assertEquals(falses,boolData.getNumFalses());
  Assert.assertEquals(booleanNulls,boolData.getNumNulls());
  colData=stats.getStatsObj().get(1).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,colData.getSetField());
  longData=colData.getLongStats();
  Assert.assertEquals(longHigh,longData.getHighValue());
  Assert.assertEquals(longLow,longData.getLowValue());
  Assert.assertEquals(longNulls,longData.getNumNulls());
  Assert.assertEquals(longDVs,longData.getNumDVs());
  colData=stats.getStatsObj().get(2).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,colData.getSetField());
  doubleData=colData.getDoubleStats();
  Assert.assertEquals(doubleHigh,doubleData.getHighValue(),0.01);
  Assert.assertEquals(doubleLow,doubleData.getLowValue(),0.01);
  Assert.assertEquals(doubleNulls,doubleData.getNumNulls());
  Assert.assertEquals(doubleDVs,doubleData.getNumDVs());
  colData=stats.getStatsObj().get(3).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,colData.getSetField());
  strData=colData.getStringStats();
  Assert.assertEquals(strMaxLen,strData.getMaxColLen());
  Assert.assertEquals(strAvgLen,strData.getAvgColLen(),0.01);
  Assert.assertEquals(strNulls,strData.getNumNulls());
  Assert.assertEquals(strDVs,strData.getNumDVs());
  colData=stats.getStatsObj().get(4).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,colData.getSetField());
  binData=colData.getBinaryStats();
  Assert.assertEquals(binMaxLen,binData.getMaxColLen());
  Assert.assertEquals(binAvgLen,binData.getAvgColLen(),0.01);
  Assert.assertEquals(binNulls,binData.getNumNulls());
  colData=stats.getStatsObj().get(5).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,colData.getSetField());
  decData=colData.getDecimalStats();
  Assert.assertEquals(decHigh,decData.getHighValue());
  Assert.assertEquals(decLow,decData.getLowValue());
  Assert.assertEquals(decNulls,decData.getNumNulls());
  Assert.assertEquals(decDVs,decData.getNumDVs());
}

</code></pre>

<br>
<pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listGlobalGrants() throws Exception {
  String[] roleNames=new String[]{"lgg_role1","lgg_role2"};
  String[] userNames=new String[]{"merry","pippen"};
  store.addRole(roleNames[0],"me");
  store.addRole(roleNames[1],"me");
  int now=(int)(System.currentTimeMillis() / 1000);
  Role role1=store.getRole(roleNames[0]);
  Role role2=store.getRole(roleNames[1]);
  store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
  List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
  HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.GLOBAL,null,null,null,null);
  PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
  HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
  privileges.add(hop);
  grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
  hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
  privileges.add(hop);
  PrivilegeBag pBag=new PrivilegeBag(privileges);
  store.grantPrivileges(pBag);
  List<HiveObjectPrivilege> hops=store.listPrincipalGlobalGrants(roleNames[0],PrincipalType.ROLE);
  Assert.assertEquals(1,hops.size());
  Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
  Assert.assertEquals(HiveObjectType.GLOBAL,hops.get(0).getHiveObject().getObjectType());
  Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
  hops=store.listPrincipalGlobalGrants(userNames[0],PrincipalType.USER);
  Assert.assertEquals(1,hops.size());
  Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
  Assert.assertEquals(HiveObjectType.GLOBAL,hops.get(0).getHiveObject().getObjectType());
  Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
  hops=store.listPrincipalGlobalGrants(roleNames[1],PrincipalType.ROLE);
  Assert.assertEquals(0,hops.size());
  hops=store.listPrincipalGlobalGrants(userNames[1],PrincipalType.USER);
  Assert.assertEquals(0,hops.size());
  hops=store.listGlobalGrantsAll();
  Assert.assertEquals(2,hops.size());
  boolean sawUser=false, sawRole=false;
  for (  HiveObjectPrivilege h : hops) {
    if (h.getPrincipalName().equals(userNames[0])) {
      Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
      Assert.assertEquals(HiveObjectType.GLOBAL,h.getHiveObject().getObjectType());
      Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
      sawUser=true;
    }
 else     if (h.getPrincipalName().equals(roleNames[0])) {
      Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
      Assert.assertEquals(HiveObjectType.GLOBAL,h.getHiveObject().getObjectType());
      Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
      sawRole=true;
    }
  }
  Assert.assertTrue(sawUser && sawRole);
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void delegationToken() throws Exception {
  store.addToken("abc","def");
  store.addToken("ghi","jkl");
  Assert.assertEquals("def",store.getToken("abc"));
  Assert.assertEquals("jkl",store.getToken("ghi"));
  Assert.assertNull(store.getToken("wabawaba"));
  String[] allToks=store.getAllTokenIdentifiers().toArray(new String[2]);
  Arrays.sort(allToks);
  Assert.assertArrayEquals(new String[]{"abc","ghi"},allToks);
  store.removeToken("abc");
  store.removeToken("wabawaba");
  Assert.assertNull(store.getToken("abc"));
  Assert.assertEquals("jkl",store.getToken("ghi"));
  allToks=store.getAllTokenIdentifiers().toArray(new String[1]);
  Assert.assertArrayEquals(new String[]{"ghi"},allToks);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listTableGrants() throws Exception {
  String dbName="ltg_db";
  String[] tableNames=new String[]{"ltg_t1","ltg_t2"};
  try {
    Database db=new Database(dbName,"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    int startTime=(int)(System.currentTimeMillis() / 1000);
    List<FieldSchema> cols=new ArrayList<FieldSchema>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    Table table=new Table(tableNames[0],dbName,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
    store.createTable(table);
    table=new Table(tableNames[1],dbName,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
    store.createTable(table);
    String[] roleNames=new String[]{"ltg_role1","ltg_role2"};
    String[] userNames=new String[]{"gandalf","radagast"};
    store.addRole(roleNames[0],"me");
    store.addRole(roleNames[1],"me");
    int now=(int)(System.currentTimeMillis() / 1000);
    Role role1=store.getRole(roleNames[0]);
    Role role2=store.getRole(roleNames[1]);
    store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
    store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
    store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
    List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
    HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.TABLE,dbName,tableNames[0],null,null);
    PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
    HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
    privileges.add(hop);
    grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
    hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
    privileges.add(hop);
    PrivilegeBag pBag=new PrivilegeBag(privileges);
    store.grantPrivileges(pBag);
    List<HiveObjectPrivilege> hops=store.listAllTableGrants(roleNames[0],PrincipalType.ROLE,dbName,tableNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listAllTableGrants(userNames[0],PrincipalType.USER,dbName,tableNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listAllTableGrants(roleNames[1],PrincipalType.ROLE,dbName,tableNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(userNames[1],PrincipalType.USER,dbName,tableNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(roleNames[0],PrincipalType.ROLE,dbName,tableNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(userNames[0],PrincipalType.USER,dbName,tableNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listTableGrantsAll(dbName,tableNames[0]);
    Assert.assertEquals(2,hops.size());
    boolean sawUser=false, sawRole=false;
    for (    HiveObjectPrivilege h : hops) {
      if (h.getPrincipalName().equals(userNames[0])) {
        Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.TABLE,h.getHiveObject().getObjectType());
        Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
        sawUser=true;
      }
 else       if (h.getPrincipalName().equals(roleNames[0])) {
        Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.TABLE,h.getHiveObject().getObjectType());
        Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
        sawRole=true;
      }
    }
    Assert.assertTrue(sawUser && sawRole);
    hops=store.listPrincipalTableGrantsAll(roleNames[0],PrincipalType.ROLE);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalTableGrantsAll(userNames[0],PrincipalType.USER);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(roleNames[1],PrincipalType.ROLE);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrantsAll(userNames[1],PrincipalType.USER);
    Assert.assertEquals(0,hops.size());
  }
  finally {
    store.dropTable(dbName,tableNames[0]);
    store.dropTable(dbName,tableNames[1]);
    store.dropDatabase(dbName);
  }
}

</code></pre>

<br>
<pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listDbGrants() throws Exception {
  String dbNames[]=new String[]{"ldbg_db1","ldbg_db2"};
  try {
    Database db=new Database(dbNames[0],"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    db=new Database(dbNames[1],"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    String[] roleNames=new String[]{"ldbg_role1","ldbg_role2"};
    String[] userNames=new String[]{"frodo","sam"};
    store.addRole(roleNames[0],"me");
    store.addRole(roleNames[1],"me");
    int now=(int)(System.currentTimeMillis() / 1000);
    Role role1=store.getRole(roleNames[0]);
    Role role2=store.getRole(roleNames[1]);
    store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
    store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
    store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
    List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
    HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.DATABASE,dbNames[0],null,null,null);
    PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
    HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
    privileges.add(hop);
    grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
    hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
    privileges.add(hop);
    PrivilegeBag pBag=new PrivilegeBag(privileges);
    store.grantPrivileges(pBag);
    List<HiveObjectPrivilege> hops=store.listPrincipalDBGrants(roleNames[0],PrincipalType.ROLE,dbNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrants(userNames[0],PrincipalType.USER,dbNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrants(roleNames[1],PrincipalType.ROLE,dbNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrants(userNames[1],PrincipalType.USER,dbNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrants(roleNames[0],PrincipalType.ROLE,dbNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrants(userNames[0],PrincipalType.USER,dbNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listDBGrantsAll(dbNames[0]);
    Assert.assertEquals(2,hops.size());
    boolean sawUser=false, sawRole=false;
    for (    HiveObjectPrivilege h : hops) {
      if (h.getPrincipalName().equals(userNames[0])) {
        Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.DATABASE,h.getHiveObject().getObjectType());
        Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
        sawUser=true;
      }
 else       if (h.getPrincipalName().equals(roleNames[0])) {
        Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.DATABASE,h.getHiveObject().getObjectType());
        Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
        sawRole=true;
      }
    }
    Assert.assertTrue(sawUser && sawRole);
    hops=store.listPrincipalDBGrantsAll(roleNames[0],PrincipalType.ROLE);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(userNames[0],PrincipalType.USER);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.DATABASE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(roleNames[1],PrincipalType.ROLE);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrantsAll(userNames[1],PrincipalType.USER);
    Assert.assertEquals(0,hops.size());
  }
  finally {
    store.dropDatabase(dbNames[0]);
    store.dropDatabase(dbNames[1]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createRole() throws Exception {
  int now=(int)System.currentTimeMillis() / 1000;
  String roleName="myrole";
  store.addRole(roleName,"me");
  Role r=store.getRole(roleName);
  Assert.assertEquals(roleName,r.getRoleName());
  Assert.assertEquals("me",r.getOwnerName());
  Assert.assertTrue(now <= r.getCreateTime());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void grantRevokeRoles() throws Exception {
  int now=(int)(System.currentTimeMillis() / 1000);
  String roleName1="role1";
  store.addRole(roleName1,"me");
  String roleName2="role2";
  store.addRole(roleName2,"me");
  Role role1=store.getRole(roleName1);
  Role role2=store.getRole(roleName2);
  store.grantRole(role1,"fred",PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role2,roleName1,PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role2,"fred",PrincipalType.USER,"admin",PrincipalType.ROLE,false);
  List<Role> roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(3,roles.size());
  boolean sawRole1=false, sawRole2=false, sawPublic=false;
  for (  Role role : roles) {
    if (role.getRoleName().equals(roleName1)) {
      sawRole1=true;
    }
 else     if (role.getRoleName().equals(roleName2)) {
      sawRole2=true;
    }
 else     if (role.getRoleName().equals(HiveMetaStore.PUBLIC)) {
      sawPublic=true;
    }
 else {
      Assert.fail("Unknown role name " + role.getRoleName());
    }
  }
  Assert.assertTrue(sawRole1 && sawRole2 && sawPublic);
  roles=store.listRoles("fred",PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Role role=roles.get(0);
  Assert.assertEquals(roleName2,role.getRoleName());
  List<RolePrincipalGrant> grants=store.listRoleMembers(roleName1);
  Assert.assertEquals(1,grants.size());
  Assert.assertEquals("fred",grants.get(0).getPrincipalName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getPrincipalType());
  Assert.assertTrue("Expected grant time of " + now + " got "+ grants.get(0).getGrantTime(),grants.get(0).getGrantTime() >= now);
  Assert.assertEquals("bob",grants.get(0).getGrantorName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getGrantorPrincipalType());
  Assert.assertFalse(grants.get(0).isGrantOption());
  grants=store.listRoleMembers(roleName2);
  Assert.assertEquals(2,grants.size());
  boolean sawFred=false;
  sawRole1=false;
  for (  RolePrincipalGrant m : grants) {
    if ("fred".equals(m.getPrincipalName()))     sawFred=true;
 else     if (roleName1.equals(m.getPrincipalName()))     sawRole1=true;
 else     Assert.fail("Unexpected principal " + m.getPrincipalName());
  }
  Assert.assertTrue(sawFred && sawRole1);
  store.revokeRole(role2,roleName1,PrincipalType.ROLE,true);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName2,roles.get(0).getRoleName());
  grants=store.listRoleMembers(roleName1);
  Assert.assertFalse(grants.get(0).isGrantOption());
  store.removeRole(roleName1);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(2,roles.size());
  sawRole2=sawPublic=false;
  for (  Role m : roles) {
    if (m.getRoleName().equals(roleName2))     sawRole2=true;
 else     if (m.getRoleName().equals(HiveMetaStore.PUBLIC))     sawPublic=true;
 else     Assert.fail("Unknown role " + m.getRoleName());
  }
  Assert.assertTrue(sawRole2 && sawPublic);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  store.revokeRole(role2,"fred",PrincipalType.USER,false);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(HiveMetaStore.PUBLIC,roles.get(0).getRoleName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestSharedStorageDescriptor </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void changeOrder(){
  StorageDescriptor sd=new StorageDescriptor();
  sd.addToSortCols(new Order("fred",1));
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  ssd.getSortCols().get(0).setOrder(2);
  Assert.assertFalse(sd.getSortCols() == ssd.getSortCols());
  Assert.assertEquals(2,ssd.getSortCols().get(0).getOrder());
  Assert.assertEquals(1,sd.getSortCols().get(0).getOrder());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void colIterator(){
  StorageDescriptor sd=new StorageDescriptor();
  sd.addToCols(new FieldSchema("fred","string",""));
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  Iterator<FieldSchema> iter=ssd.getColsIterator();
  Assert.assertTrue(iter.hasNext());
  Assert.assertEquals("fred",iter.next().getName());
  Assert.assertFalse(sd.getCols() == ssd.getCols());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void changeBucketList(){
  StorageDescriptor sd=new StorageDescriptor();
  sd.addToBucketCols(new String("fred"));
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  List<String> list=ssd.getBucketCols();
  list.add(new String("bob"));
  Assert.assertFalse(sd.getBucketCols() == ssd.getBucketCols());
  Assert.assertEquals(2,ssd.getBucketColsSize());
  Assert.assertEquals(1,sd.getBucketColsSize());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addToColList(){
  StorageDescriptor sd=new StorageDescriptor();
  sd.addToCols(new FieldSchema("fred","string",""));
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  ssd.addToCols(new FieldSchema("joe","int",""));
  Assert.assertFalse(sd.getCols() == ssd.getCols());
  Assert.assertEquals(2,ssd.getColsSize());
  Assert.assertEquals(1,sd.getColsSize());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void changeOnSerde(){
  StorageDescriptor sd=new StorageDescriptor();
  SerDeInfo serde=new SerDeInfo();
  serde.setName("serde");
  sd.setSerdeInfo(serde);
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  ssd.getSerdeInfo().setName("different");
  Assert.assertFalse(sd.getSerdeInfo() == ssd.getSerdeInfo());
  Assert.assertEquals("serde",serde.getName());
  Assert.assertEquals("different",ssd.getSerdeInfo().getName());
  Assert.assertEquals("serde",sd.getSerdeInfo().getName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void unsetOrder(){
  StorageDescriptor sd=new StorageDescriptor();
  sd.addToSortCols(new Order("fred",1));
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  ssd.unsetSortCols();
  Assert.assertFalse(sd.getSortCols() == ssd.getSortCols());
  Assert.assertEquals(0,ssd.getSortColsSize());
  Assert.assertEquals(1,sd.getSortColsSize());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void setReadOnly(){
  StorageDescriptor sd=new StorageDescriptor();
  sd.addToCols(new FieldSchema("fred","string",""));
  SharedStorageDescriptor ssd=new SharedStorageDescriptor();
  ssd.setShared(sd);
  ssd.setReadOnly();
  List<FieldSchema> cols=ssd.getCols();
  Assert.assertEquals(1,cols.size());
  Assert.assertTrue(sd.getCols() == ssd.getCols());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestStorageDescriptorSharing </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createManyPartitions() throws Exception {
  String dbName="default";
  String tableName="manyParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> partVals=Arrays.asList("alan","bob","carl","doug","ethan");
  for (  String val : partVals) {
    List<String> vals=new ArrayList<String>();
    vals.add(val);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + val);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
    Partition p=store.getPartition(dbName,tableName,vals);
    Assert.assertEquals("file:/tmp/pc=" + val,p.getSd().getLocation());
  }
  Assert.assertEquals(1,HBaseReadWrite.getInstance().countStorageDescriptor());
  String tableName2="differentTable";
  sd=new StorageDescriptor(cols,"file:/tmp","input2","output",false,0,serde,null,null,emptyParameters);
  table=new Table(tableName2,"default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  store.dropPartition(dbName,tableName,Arrays.asList(partVals.get(0)));
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  table=store.getTable(dbName,tableName2);
  byte[] sdHash=HBaseUtils.hashStorageDescriptor(table.getSd(),md);
  table.setLastAccessTime(startTime + 1);
  store.alterTable(dbName,tableName2,table);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  table=store.getTable(dbName,tableName2);
  byte[] alteredHash=HBaseUtils.hashStorageDescriptor(table.getSd(),md);
  Assert.assertArrayEquals(sdHash,alteredHash);
  table.getSd().setOutputFormat("output_changed");
  store.alterTable(dbName,tableName2,table);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  table=store.getTable(dbName,tableName2);
  alteredHash=HBaseUtils.hashStorageDescriptor(table.getSd(),md);
  Assert.assertFalse(Arrays.equals(sdHash,alteredHash));
  Partition part=store.getPartition(dbName,tableName,Arrays.asList(partVals.get(1)));
  sdHash=HBaseUtils.hashStorageDescriptor(part.getSd(),md);
  part.setLastAccessTime(part.getLastAccessTime() + 1);
  store.alterPartition(dbName,tableName,Arrays.asList(partVals.get(1)),part);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  part=store.getPartition(dbName,tableName,Arrays.asList(partVals.get(1)));
  alteredHash=HBaseUtils.hashStorageDescriptor(part.getSd(),md);
  Assert.assertArrayEquals(sdHash,alteredHash);
  part.getSd().setOutputFormat("output_changed_some_more");
  store.alterPartition(dbName,tableName,Arrays.asList(partVals.get(1)),part);
  Assert.assertEquals(3,HBaseReadWrite.getInstance().countStorageDescriptor());
  part=store.getPartition(dbName,tableName,Arrays.asList(partVals.get(1)));
  alteredHash=HBaseUtils.hashStorageDescriptor(part.getSd(),md);
  Assert.assertFalse(Arrays.equals(sdHash,alteredHash));
  List<Partition> parts=store.getPartitions(dbName,tableName,-1);
  sdHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  for (int i=1; i < 3; i++) {
    parts.get(i).setLastAccessTime(97);
  }
  List<List<String>> listPartVals=new ArrayList<List<String>>();
  for (  String pv : partVals.subList(1,partVals.size())) {
    listPartVals.add(Arrays.asList(pv));
  }
  store.alterPartitions(dbName,tableName,listPartVals,parts);
  Assert.assertEquals(3,HBaseReadWrite.getInstance().countStorageDescriptor());
  parts=store.getPartitions(dbName,tableName,-1);
  alteredHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  Assert.assertArrayEquals(sdHash,alteredHash);
  parts=store.getPartitions(dbName,tableName,-1);
  sdHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  for (int i=1; i < 3; i++) {
    parts.get(i).getSd().setOutputFormat("yet_a_different_of");
  }
  store.alterPartitions(dbName,tableName,listPartVals,parts);
  Assert.assertEquals(4,HBaseReadWrite.getInstance().countStorageDescriptor());
  parts=store.getPartitions(dbName,tableName,-1);
  alteredHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  Assert.assertFalse(Arrays.equals(sdHash,alteredHash));
  for (  String partVal : partVals.subList(1,partVals.size())) {
    store.dropPartition(dbName,tableName,Arrays.asList(partVal));
  }
  store.dropTable(dbName,tableName);
  store.dropTable(dbName,tableName2);
  Assert.assertEquals(0,HBaseReadWrite.getInstance().countStorageDescriptor());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkCompacted() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  txnHandler.markCompacted(ci);
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("ready for cleaning",c.getState());
  assertNull(c.getWorkerid());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkCleanedCleansTxnsAndTxnComponents() throws Exception {
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.abortTxn(new AbortTxnRequest(txnid));
  txnid=openTxn();
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("yourtable");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.abortTxn(new AbortTxnRequest(txnid));
  txnid=openTxn();
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("foo");
  comp.setPartitionname("bar");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("foo");
  comp.setPartitionname("baz");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.abortTxn(new AbortTxnRequest(txnid));
  CompactionInfo ci=new CompactionInfo();
  CompactionRequest rqst=new CompactionRequest("mydb","mytable",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  assertEquals(0,txnHandler.findReadyToClean().size());
  ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  txnHandler.markCompacted(ci);
  List<CompactionInfo> toClean=txnHandler.findReadyToClean();
  assertEquals(1,toClean.size());
  txnHandler.markCleaned(ci);
  GetOpenTxnsResponse txnList=txnHandler.getOpenTxns();
  assertEquals(3,txnList.getOpen_txnsSize());
  txnHandler.cleanEmptyAbortedTxns();
  txnList=txnHandler.getOpenTxns();
  assertEquals(2,txnList.getOpen_txnsSize());
  rqst=new CompactionRequest("mydb","foo",CompactionType.MAJOR);
  rqst.setPartitionname("bar");
  txnHandler.compact(rqst);
  assertEquals(0,txnHandler.findReadyToClean().size());
  ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  txnHandler.markCompacted(ci);
  toClean=txnHandler.findReadyToClean();
  assertEquals(1,toClean.size());
  txnHandler.markCleaned(ci);
  txnHandler.openTxns(new OpenTxnRequest(1,"me","localhost"));
  txnHandler.cleanEmptyAbortedTxns();
  txnList=txnHandler.getOpenTxns();
  assertEquals(3,txnList.getOpen_txnsSize());
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeFromLocalWorkers() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","baz",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","bazzoo",CompactionType.MINOR);
  txnHandler.compact(rqst);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  assertNotNull(txnHandler.findNextToCompact("bob-193892"));
  assertNotNull(txnHandler.findNextToCompact("fred-193893"));
  txnHandler.revokeFromLocalWorkers("fred");
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(3,compacts.size());
  boolean sawWorkingBob=false;
  int initiatedCount=0;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working")) {
      assertEquals("bob-193892",c.getWorkerid());
      sawWorkingBob=true;
    }
 else     if (c.getState().equals("initiated")) {
      initiatedCount++;
    }
 else {
      fail("Unexpected state");
    }
  }
  assertTrue(sawWorkingBob);
  assertEquals(2,initiatedCount);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkCleaned() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  assertEquals(0,txnHandler.findReadyToClean().size());
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals(0,txnHandler.findReadyToClean().size());
  txnHandler.markCompacted(ci);
  assertNull(txnHandler.findNextToCompact("fred"));
  List<CompactionInfo> toClean=txnHandler.findReadyToClean();
  assertEquals(1,toClean.size());
  assertNull(txnHandler.findNextToCompact("fred"));
  txnHandler.markCleaned(ci);
  assertNull(txnHandler.findNextToCompact("fred"));
  assertEquals(0,txnHandler.findReadyToClean().size());
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  assertEquals(1,rsp.getCompactsSize());
  assertTrue(TxnHandler.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToClean() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  assertEquals(0,txnHandler.findReadyToClean().size());
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals(0,txnHandler.findReadyToClean().size());
  txnHandler.markCompacted(ci);
  assertNull(txnHandler.findNextToCompact("fred"));
  List<CompactionInfo> toClean=txnHandler.findReadyToClean();
  assertEquals(1,toClean.size());
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("ready for cleaning",c.getState());
  assertNull(c.getWorkerid());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindPotentialCompactions() throws Exception {
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("yourtable");
  comp.setPartitionname("mypartition");
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.commitTxn(new CommitTxnRequest(txnid));
  assertEquals(0,txnHandler.numLocksInLockTable());
  Set<CompactionInfo> potentials=txnHandler.findPotentialCompactions(100);
  assertEquals(2,potentials.size());
  boolean sawMyTable=false, sawYourTable=false;
  for (  CompactionInfo ci : potentials) {
    sawMyTable|=(ci.dbname.equals("mydb") && ci.tableName.equals("mytable") && ci.partName == null);
    sawYourTable|=(ci.dbname.equals("mydb") && ci.tableName.equals("yourtable") && ci.partName.equals("mypartition"));
  }
  assertTrue(sawMyTable);
  assertTrue(sawYourTable);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToCompact() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  long now=System.currentTimeMillis();
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  assertEquals("ds=today",ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  assertNull(ci.runAs);
  assertNull(txnHandler.findNextToCompact("fred"));
  txnHandler.setRunAs(ci.id,"bob");
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("working",c.getState());
  assertTrue(c.getStart() - 5000 < now && c.getStart() + 5000 > now);
  assertEquals("fred",c.getWorkerid());
  assertEquals("bob",c.getRunAs());
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRevokeTimedOutWorkers() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","baz",CompactionType.MINOR);
  txnHandler.compact(rqst);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  Thread.sleep(200);
  assertNotNull(txnHandler.findNextToCompact("fred-193892"));
  txnHandler.revokeTimedoutWorkers(100);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(2,compacts.size());
  boolean sawWorking=false, sawInitiated=false;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working"))     sawWorking=true;
 else     if (c.getState().equals("initiated"))     sawInitiated=true;
 else     fail("Unexpected state");
  }
  assertTrue(sawWorking);
  assertTrue(sawInitiated);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToCompact2() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=yesterday");
  txnHandler.compact(rqst);
  long now=System.currentTimeMillis();
  boolean expectToday=false;
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  if ("ds=today".equals(ci.partName))   expectToday=false;
 else   if ("ds=yesterday".equals(ci.partName))   expectToday=true;
 else   fail("partition name should have been today or yesterday but was " + ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  if (expectToday)   assertEquals("ds=today",ci.partName);
 else   assertEquals("ds=yesterday",ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(2,compacts.size());
  for (  ShowCompactResponseElement e : compacts) {
    assertEquals("working",e.getState());
    assertTrue(e.getStart() - 5000 < now && e.getStart() + 5000 > now);
    assertEquals("fred",e.getWorkerid());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestTxnHandler </h4><pre class="type-6 type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void showLocks() throws Exception {
  long begining=System.currentTimeMillis();
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  txnid=openTxn();
  comp=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"mydb");
  comp.setTablename("mytable");
  components=new ArrayList<LockComponent>(1);
  components.add(comp);
  req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  res=txnHandler.lock(req);
  components=new ArrayList<LockComponent>(1);
  comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.PARTITION,"yourdb");
  comp.setTablename("yourtable");
  comp.setPartitionname("yourpartition");
  components.add(comp);
  req=new LockRequest(components,"you","remotehost");
  res=txnHandler.lock(req);
  ShowLocksResponse rsp=txnHandler.showLocks(new ShowLocksRequest());
  List<ShowLocksResponseElement> locks=rsp.getLocks();
  assertEquals(3,locks.size());
  boolean[] saw=new boolean[locks.size()];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  ShowLocksResponseElement lock : locks) {
    if (lock.getLockid() == 1) {
      assertEquals(1,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertNull(lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.EXCLUSIVE,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertTrue("Expected acquired at " + lock.getAcquiredat() + " to be between "+ begining+ " and "+ System.currentTimeMillis(),begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[0]=true;
    }
 else     if (lock.getLockid() == 2) {
      assertEquals(2,lock.getTxnid());
      assertEquals("mydb",lock.getDbname());
      assertEquals("mytable",lock.getTablename());
      assertNull(lock.getPartname());
      assertEquals(LockState.WAITING,lock.getState());
      assertEquals(LockType.SHARED_READ,lock.getType());
      assertTrue(lock.toString(),0 == lock.getLastheartbeat() && lock.getTxnid() != 0);
      assertEquals(0,lock.getAcquiredat());
      assertEquals("me",lock.getUser());
      assertEquals("localhost",lock.getHostname());
      saw[1]=true;
    }
 else     if (lock.getLockid() == 3) {
      assertEquals(0,lock.getTxnid());
      assertEquals("yourdb",lock.getDbname());
      assertEquals("yourtable",lock.getTablename());
      assertEquals("yourpartition",lock.getPartname());
      assertEquals(LockState.ACQUIRED,lock.getState());
      assertEquals(LockType.SHARED_WRITE,lock.getType());
      assertTrue(lock.toString(),begining <= lock.getLastheartbeat() && System.currentTimeMillis() >= lock.getLastheartbeat());
      assertTrue(begining <= lock.getAcquiredat() && System.currentTimeMillis() >= lock.getAcquiredat());
      assertEquals("you",lock.getUser());
      assertEquals("remotehost",lock.getHostname());
      saw[2]=true;
    }
 else {
      fail("Unknown lock id");
    }
  }
  for (int i=0; i < saw.length; i++)   assertTrue("Didn't see lock id " + i,saw[i]);
}

</code></pre>

<br>
<pre class="type-12 type-4 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void deadlockDetected() throws Exception {
  LOG.debug("Starting deadlock test");
  if (txnHandler instanceof TxnHandler) {
    final TxnHandler tHndlr=(TxnHandler)txnHandler;
    Connection conn=tHndlr.getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    Statement stmt=conn.createStatement();
    long now=tHndlr.getDbTime(conn);
    stmt.executeUpdate("insert into TXNS (txn_id, txn_state, txn_started, txn_last_heartbeat, " + "txn_user, txn_host) values (1, 'o', " + now + ", "+ now+ ", 'shagy', "+ "'scooby.com')");
    stmt.executeUpdate("insert into HIVE_LOCKS (hl_lock_ext_id, hl_lock_int_id, hl_txnid, " + "hl_db, hl_table, hl_partition, hl_lock_state, hl_lock_type, hl_last_heartbeat, " + "hl_user, hl_host) values (1, 1, 1, 'mydb', 'mytable', 'mypartition', '" + tHndlr.LOCK_WAITING + "', '"+ tHndlr.LOCK_EXCLUSIVE+ "', "+ now+ ", 'fred', "+ "'scooby.com')");
    conn.commit();
    tHndlr.closeDbConn(conn);
    final AtomicBoolean sawDeadlock=new AtomicBoolean();
    final Connection conn1=tHndlr.getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    final Connection conn2=tHndlr.getDbConn(Connection.TRANSACTION_SERIALIZABLE);
    try {
      for (int i=0; i < 5; i++) {
        Thread t1=new Thread(){
          @Override public void run(){
            try {
              try {
                updateTxns(conn1);
                updateLocks(conn1);
                Thread.sleep(1000);
                conn1.commit();
                LOG.debug("no exception, no deadlock");
              }
 catch (              SQLException e) {
                try {
                  tHndlr.checkRetryable(conn1,e,"thread t1");
                  LOG.debug("Got an exception, but not a deadlock, SQLState is " + e.getSQLState() + " class of exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                }
 catch (                TxnHandler.RetryException de) {
                  LOG.debug("Forced a deadlock, SQLState is " + e.getSQLState() + " class of "+ "exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                  sawDeadlock.set(true);
                }
              }
              conn1.rollback();
            }
 catch (            Exception e) {
              throw new RuntimeException(e);
            }
          }
        }
;
        Thread t2=new Thread(){
          @Override public void run(){
            try {
              try {
                updateLocks(conn2);
                updateTxns(conn2);
                Thread.sleep(1000);
                conn2.commit();
                LOG.debug("no exception, no deadlock");
              }
 catch (              SQLException e) {
                try {
                  tHndlr.checkRetryable(conn2,e,"thread t2");
                  LOG.debug("Got an exception, but not a deadlock, SQLState is " + e.getSQLState() + " class of exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                }
 catch (                TxnHandler.RetryException de) {
                  LOG.debug("Forced a deadlock, SQLState is " + e.getSQLState() + " class of "+ "exception is "+ e.getClass().getName()+ " msg is <"+ e.getMessage()+ ">");
                  sawDeadlock.set(true);
                }
              }
              conn2.rollback();
            }
 catch (            Exception e) {
              throw new RuntimeException(e);
            }
          }
        }
;
        t1.start();
        t2.start();
        t1.join();
        t2.join();
        if (sawDeadlock.get())         break;
      }
      assertTrue(sawDeadlock.get());
    }
  finally {
      conn1.rollback();
      tHndlr.closeDbConn(conn1);
      conn2.rollback();
      tHndlr.closeDbConn(conn2);
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidTxnsEmpty() throws Exception {
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(0L,txnsInfo.getTxn_high_water_mark());
  assertTrue(txnsInfo.getOpen_txns().isEmpty());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(0L,txns.getTxn_high_water_mark());
  assertTrue(txns.getOpen_txns().isEmpty());
}

</code></pre>

<br>
<pre class="type-6 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeatLock() throws Exception {
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TXN_TIMEOUT,1,TimeUnit.SECONDS);
  HeartbeatRequest h=new HeartbeatRequest();
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("mypartition");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  h.setLockid(res.getLockid());
  for (int i=0; i < 30; i++) {
    try {
      txnHandler.heartbeat(h);
    }
 catch (    NoSuchLockException e) {
      fail("Told there was no lock, when the heartbeat should have kept it.");
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnlockOnCommit() throws Exception {
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.commitTxn(new CommitTxnRequest(txnid));
  assertEquals(0,txnHandler.numLocksInLockTable());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLockTimeout() throws Exception {
  long timeout=txnHandler.setTimeout(1);
  try {
    LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
    comp.setTablename("mytable");
    comp.setPartitionname("mypartition");
    List<LockComponent> components=new ArrayList<LockComponent>(1);
    components.add(comp);
    LockRequest req=new LockRequest(components,"me","localhost");
    LockResponse res=txnHandler.lock(req);
    assertTrue(res.getState() == LockState.ACQUIRED);
    Thread.sleep(10);
    txnHandler.performTimeOuts();
    txnHandler.checkLock(new CheckLockRequest(res.getLockid()));
    fail("Told there was a lock, when it should have timed out.");
  }
 catch (  NoSuchLockException e) {
  }
 finally {
    txnHandler.setTimeout(timeout);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortTxn() throws Exception {
  OpenTxnsResponse openedTxns=txnHandler.openTxns(new OpenTxnRequest(2,"me","localhost"));
  List<Long> txnList=openedTxns.getTxn_ids();
  long first=txnList.get(0);
  assertEquals(1L,first);
  long second=txnList.get(1);
  assertEquals(2L,second);
  txnHandler.abortTxn(new AbortTxnRequest(1));
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(2L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.ABORTED,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(2L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(2L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[3];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  for (int i=1; i < saw.length; i++)   assertTrue(saw[i]);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactMinorNoPartition() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setRunas("fred");
  txnHandler.compact(rqst);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertNull(c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("initiated",c.getState());
  assertEquals(0L,c.getStart());
  assertEquals("fred",c.getRunAs());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnlockOnAbort() throws Exception {
  long txnid=openTxn();
  LockComponent comp=new LockComponent(LockType.SHARED_WRITE,LockLevel.DB,"mydb");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  req.setTxnid(txnid);
  LockResponse res=txnHandler.lock(req);
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.abortTxn(new AbortTxnRequest(txnid));
  assertEquals(0,txnHandler.numLocksInLockTable());
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpenTxn() throws Exception {
  long first=openTxn();
  assertEquals(1L,first);
  long second=openTxn();
  assertEquals(2L,second);
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(2L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(2L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  assertEquals("me",txnsInfo.getOpen_txns().get(1).getUser());
  assertEquals("localhost",txnsInfo.getOpen_txns().get(1).getHostname());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(2L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[3];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  for (int i=1; i < saw.length; i++)   assertTrue(saw[i]);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleLock() throws Exception {
  LockComponent comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("mypartition");
  List<LockComponent> components=new ArrayList<LockComponent>(2);
  components.add(comp);
  comp=new LockComponent(LockType.EXCLUSIVE,LockLevel.DB,"mydb");
  comp.setTablename("mytable");
  comp.setPartitionname("anotherpartition");
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  LockResponse res=txnHandler.lock(req);
  long lockid=res.getLockid();
  assertTrue(res.getState() == LockState.ACQUIRED);
  res=txnHandler.checkLock(new CheckLockRequest(lockid));
  assertTrue(res.getState() == LockState.ACQUIRED);
  txnHandler.unlock(new UnlockRequest(lockid));
  assertEquals(0,txnHandler.numLocksInLockTable());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testValidTxnsSomeOpen() throws Exception {
  txnHandler.openTxns(new OpenTxnRequest(3,"me","localhost"));
  txnHandler.abortTxn(new AbortTxnRequest(1));
  txnHandler.commitTxn(new CommitTxnRequest(2));
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(3L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.ABORTED,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(3L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(3L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[4];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  assertTrue(saw[1]);
  assertFalse(saw[2]);
  assertTrue(saw[3]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.TestTxnCommands2 </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the query correctness and directory layout after ACID table conversion and MAJOR compaction
 * @throws Exception
 */
@Test public void testNonAcidToAcidConversionAndMajorCompaction() throws Exception {
  FileSystem fs=FileSystem.get(hiveConf);
  FileStatus[] status;
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(1,2)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  List<String> rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  int[][] resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  int resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " SET TBLPROPERTIES ('transactional'='true')");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(3,4)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(3,status.length);
  boolean sawNewDelta=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("delta_.*")) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
    }
  }
  Assert.assertTrue(sawNewDelta);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " compact 'MAJOR'");
  Worker w=new Worker();
  w.setThreadId((int)w.getId());
  w.setHiveConf(hiveConf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  w.init(stop,looped);
  w.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(4,status.length);
  boolean sawNewBase=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("base_.*")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
  }
  Assert.assertTrue(sawNewBase);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  String fakeFile0=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_0";
  String fakeFile1=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_1";
  fs.create(new Path(fakeFile0));
  fs.create(new Path(fakeFile1));
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(5,status.length);
  Cleaner c=new Cleaner();
  c.setThreadId((int)c.getId());
  c.setHiveConf(hiveConf);
  stop=new AtomicBoolean();
  looped=new AtomicBoolean();
  stop.set(true);
  c.init(stop,looped);
  c.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(1,status.length);
  Assert.assertTrue(status[0].getPath().getName().matches("base_.*"));
  FileStatus[] buckets=fs.listStatus(status[0].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,buckets.length);
  Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
  Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.errors.TestTaskLogProcessor </h4><pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataCorruptErrorHeuristic() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  String badFile1="hdfs://localhost/foo1/moo1/zoo1";
  String badFile2="hdfs://localhost/foo2/moo2/zoo2";
  String content="line a\nlineb\n" + "split: " + badFile1 + " is very bad.\n"+ " line c\nlineD\n"+ "split: "+ badFile2+ " is also very bad.\n"+ " java.io.EOFException: null \n"+ "line E\n";
  File log3File=writeTestLog("1",content);
  taskLogProcessor.addTaskAttemptLogUrl(log3File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.contains(badFile1) || error.contains(badFile2));
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggrMemErrorHeuristic() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  Throwable oome=new OutOfMemoryError("java heap space");
  File log1File=writeTestLog("1",toString(oome));
  taskLogProcessor.addTaskAttemptLogUrl(log1File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.contains("memory"));
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
  String confName=HiveConf.ConfVars.HIVEMAPAGGRHASHMEMORY.toString();
  assertTrue(solution.contains(confName));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScriptErrorHeuristic() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  String errorCode="7874";
  String content="line a\nlineb\n" + "Script failed with code " + errorCode + " line c\nlineD\n";
  File log3File=writeTestLog("1",content);
  taskLogProcessor.addTaskAttemptLogUrl(log3File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.indexOf(errorCode) >= 0);
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.persistence.TestMapJoinEqualityTableContainer </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testContainerBasics() throws Exception {
  container.put(KEY1,rowContainer);
  container.put(KEY2,rowContainer);
  container.put(KEY3,rowContainer);
  container.put(KEY4,rowContainer);
  Assert.assertEquals(4,container.size());
  Map<MapJoinKey,MapJoinRowContainer> localContainer=new HashMap<MapJoinKey,MapJoinRowContainer>();
  for (  Entry<MapJoinKey,MapJoinRowContainer> entry : container.entrySet()) {
    localContainer.put(entry.getKey(),entry.getValue());
  }
  Utilities.testEquality(container.get(KEY1),localContainer.get(KEY1));
  Utilities.testEquality(container.get(KEY2),localContainer.get(KEY2));
  Utilities.testEquality(container.get(KEY3),localContainer.get(KEY3));
  Utilities.testEquality(container.get(KEY4),localContainer.get(KEY4));
  container.clear();
  Assert.assertEquals(0,container.size());
  Assert.assertTrue(container.entrySet().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.persistence.TestMapJoinTableContainer </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyContainer() throws Exception {
  MapJoinTableContainerSerDe.persistDummyTable(out);
  out.close();
  in=new ObjectInputStream(new ByteArrayInputStream(baos.toByteArray()));
  container=containerSerde.load(in);
  Assert.assertEquals(0,container.size());
  Assert.assertTrue(container.entrySet().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests multi-user scenario (like HiveServer2) where each user gets a session
 * and uses it multiple times.
 */
@Test public void testMultiSessionMultipleUse() throws Exception {
  sessionManagerHS2=SparkSessionManagerImpl.getInstance();
  sessionManagerHS2.shutdown();
  HiveConf hiveConf=new HiveConf();
  hiveConf.set("spark.master","local");
  sessionManagerHS2.setup(hiveConf);
  List<Thread> threadList=new ArrayList<Thread>();
  for (int i=0; i < 10; i++) {
    Thread t=new Thread(new SessionThread(),"Session thread " + i);
    t.start();
    threadList.add(t);
  }
  for (  Thread t : threadList) {
    try {
      t.join();
    }
 catch (    InterruptedException e) {
      String msg="Interrupted while waiting for test session threads.";
      LOG.error(msg,e);
      fail(msg);
    }
  }
  assertFalse("At least one of the session threads failed. See the test output for details.",anyFailedSessionThread);
  System.out.println("Ending SessionManagerHS2");
  sessionManagerHS2.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestDynamicPartitionPruner </h4><pre class="type-4 type-5 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000,expected=IllegalStateException.class) public void testExtraEvents() throws InterruptedException, IOException, HiveException, SerDeException {
  InputInitializerContext mockInitContext=mock(InputInitializerContext.class);
  doReturn(1).when(mockInitContext).getVertexNumTasks("v1");
  MapWork mapWork=createMockMapWork(new TestSource("v1",1));
  DynamicPartitionPruner pruner=new DynamicPartitionPrunerForEventTesting(mockInitContext,mapWork);
  PruneRunnable pruneRunnable=new PruneRunnable(pruner);
  Thread t=new Thread(pruneRunnable);
  t.start();
  try {
    pruneRunnable.start();
    InputInitializerEvent event=InputInitializerEvent.create("FakeTarget","TargetInput",ByteBuffer.allocate(0));
    event.setSourceVertexName("v1");
    pruner.addEvent(event);
    pruner.addEvent(event);
    pruner.processVertex("v1");
    pruneRunnable.awaitEnd();
    assertFalse(pruneRunnable.inError.get());
  }
  finally {
    t.interrupt();
    t.join();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestHostAffinitySplitLocationProvider </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testOrcSplitsLocationAffinity() throws IOException {
  HostAffinitySplitLocationProvider locationProvider=new HostAffinitySplitLocationProvider(executorLocations);
  InputSplit os11=createMockFileSplit(true,"path1",0,15000,new String[]{locations[0],locations[1]});
  InputSplit os12=createMockFileSplit(true,"path1",0,30000,new String[]{locations[0],locations[1]});
  InputSplit os13=createMockFileSplit(true,"path1",15000,30000,new String[]{locations[0],locations[1]});
  String[] retLoc11=locationProvider.getLocations(os11);
  String[] retLoc12=locationProvider.getLocations(os12);
  String[] retLoc13=locationProvider.getLocations(os13);
  assertEquals(1,retLoc11.length);
  assertFalse(locationsSet.contains(retLoc11[0]));
  assertTrue(executorLocationsSet.contains(retLoc11[0]));
  assertEquals(1,retLoc12.length);
  assertFalse(locationsSet.contains(retLoc12[0]));
  assertTrue(executorLocationsSet.contains(retLoc12[0]));
  assertEquals(1,retLoc13.length);
  assertFalse(locationsSet.contains(retLoc13[0]));
  assertTrue(executorLocationsSet.contains(retLoc13[0]));
  assertEquals(retLoc11[0],retLoc12[0]);
  assertNotEquals(retLoc11[0],retLoc13[0]);
  String[] retLoc112=locationProvider.getLocations(os11);
  String[] retLoc122=locationProvider.getLocations(os12);
  String[] retLoc132=locationProvider.getLocations(os13);
  assertArrayEquals(retLoc11,retLoc112);
  assertArrayEquals(retLoc12,retLoc122);
  assertArrayEquals(retLoc13,retLoc132);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testOrcSplitsBasic() throws IOException {
  HostAffinitySplitLocationProvider locationProvider=new HostAffinitySplitLocationProvider(executorLocations);
  InputSplit os1=createMockFileSplit(true,"path1",0,1000,new String[]{locations[0],locations[1]});
  InputSplit os2=createMockFileSplit(true,"path2",0,2000,new String[]{locations[2],locations[3]});
  InputSplit os3=createMockFileSplit(true,"path3",1000,2000,new String[]{locations[0],locations[3]});
  String[] retLoc1=locationProvider.getLocations(os1);
  String[] retLoc2=locationProvider.getLocations(os2);
  String[] retLoc3=locationProvider.getLocations(os3);
  assertEquals(1,retLoc1.length);
  assertFalse(locationsSet.contains(retLoc1[0]));
  assertTrue(executorLocationsSet.contains(retLoc1[0]));
  assertEquals(1,retLoc2.length);
  assertFalse(locationsSet.contains(retLoc2[0]));
  assertTrue(executorLocationsSet.contains(retLoc2[0]));
  assertEquals(1,retLoc3.length);
  assertFalse(locationsSet.contains(retLoc3[0]));
  assertTrue(executorLocationsSet.contains(retLoc3[0]));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestTezSessionPool </h4><pre class="type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionPoolThreads(){
  try {
    conf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"0,1,2");
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,4);
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSION_MAX_INIT_THREADS,16);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState[] sessions=new TezSessionState[12];
    int[] queueCounts=new int[3];
    for (int i=0; i < sessions.length; ++i) {
      sessions[i]=poolManager.getSession(null,conf,true,false);
      queueCounts[Integer.parseInt(sessions[i].getQueueName())]+=1;
    }
    for (int i=0; i < queueCounts.length; ++i) {
      assertEquals(4,queueCounts[i]);
    }
    for (int i=0; i < sessions.length; ++i) {
      poolManager.returnSession(sessions[i],false);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionPoolGetInOrder(){
  try {
    conf.setBoolVar(ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
    conf.setVar(ConfVars.HIVE_SERVER2_TEZ_DEFAULT_QUEUES,"a,b,c");
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSIONS_PER_DEFAULT_QUEUE,2);
    conf.setIntVar(ConfVars.HIVE_SERVER2_TEZ_SESSION_MAX_INIT_THREADS,1);
    poolManager=new TestTezSessionPoolManager();
    poolManager.setupPool(conf);
    poolManager.startPool();
    TezSessionState sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("a",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("b",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    assertEquals("c",sessionState.getQueueName());
    poolManager.returnSession(sessionState,false);
    sessionState=poolManager.getSession(null,conf,true,false);
    if (sessionState.getQueueName().compareTo("a") != 0) {
      fail();
    }
    poolManager.returnSession(sessionState,false);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.tez.TestTezTask </h4><pre class="type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBuildDag() throws IllegalArgumentException, IOException, Exception {
  DAG dag=task.build(conf,work,path,appLr,null,new Context(conf));
  for (  BaseWork w : work.getAllWork()) {
    Vertex v=dag.getVertex(w.getName());
    assertNotNull(v);
    List<Vertex> outs=v.getOutputVertices();
    for (    BaseWork x : work.getChildren(w)) {
      boolean found=false;
      for (      Vertex u : outs) {
        if (u.getName().equals(x.getName())) {
          found=true;
          break;
        }
      }
      assertTrue(found);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestListColumnVector </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  ListColumnVector vector=new ListColumnVector(10,col1);
  vector.init();
  col1.isRepeating=true;
  vector.isRepeating=true;
  vector.noNulls=false;
  vector.isNull[0]=true;
  vector.childCount=0;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i + 3;
    vector.offsets[i]=i;
    vector.lengths[i]=10 + i;
  }
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertTrue("isNull at " + i,vector.isNull[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("null",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(vector.isRepeating);
  Arrays.fill(vector.isNull,1,10,false);
  int[] sel=new int[]{3,5,7};
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    assertEquals("failure at " + i,i == 3 || i == 5 || i == 7,vector.isNull[i]);
  }
  vector.unFlatten();
  vector.noNulls=true;
  vector.isRepeating=true;
  vector.offsets[0]=0;
  vector.lengths[0]=3;
  vector.childCount=3;
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertFalse(col1.isRepeating);
  assertFalse(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertEquals("offset at " + i,0,vector.offsets[i]);
    assertEquals("length at " + i,3,vector.lengths[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[3, 3, 3]",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertTrue(vector.isRepeating);
  assertTrue(vector.noNulls);
  Arrays.fill(vector.offsets,1,10,-1);
  Arrays.fill(vector.lengths,1,10,-1);
  Arrays.fill(col1.vector,1,10,-1);
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    if (i == 3 || i == 5 || i == 7) {
      assertEquals("failure at " + i,0,vector.offsets[i]);
      assertEquals("failure at " + i,3,vector.lengths[i]);
    }
 else {
      assertEquals("failure at " + i,-1,vector.offsets[i]);
      assertEquals("failure at " + i,-1,vector.lengths[i]);
    }
  }
  for (int i=0; i < 3; ++i) {
    assertEquals("failure at " + i,3,col1.vector[i]);
  }
  for (int i=3; i < 10; ++i) {
    assertEquals("failure at " + i,-1,col1.vector[i]);
  }
  vector.unFlatten();
  vector.reset();
  assertFalse(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertFalse(vector.isRepeating);
  assertTrue(vector.noNulls);
  assertEquals(0,vector.childCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestMapColumnVector </h4><pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  DoubleColumnVector col2=new DoubleColumnVector(10);
  MapColumnVector vector=new MapColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  vector.isRepeating=true;
  vector.noNulls=false;
  vector.isNull[0]=true;
  vector.childCount=0;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i + 3;
    col2.vector[i]=i * 10;
    vector.offsets[i]=i;
    vector.lengths[i]=10 + i;
  }
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  for (int i=0; i < 10; ++i) {
    assertTrue("isNull at " + i,vector.isNull[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("null",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(vector.isRepeating);
  Arrays.fill(vector.isNull,1,10,false);
  int[] sel=new int[]{3,5,7};
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    assertEquals("failure at " + i,i == 3 || i == 5 || i == 7,vector.isNull[i]);
  }
  vector.unFlatten();
  vector.noNulls=true;
  vector.isRepeating=true;
  vector.offsets[0]=0;
  vector.lengths[0]=3;
  vector.childCount=3;
  vector.flatten(false,null,10);
  assertFalse(vector.isRepeating);
  assertFalse(vector.noNulls);
  assertFalse(col1.isRepeating);
  assertFalse(col1.noNulls);
  assertFalse(col2.isRepeating);
  assertFalse(col2.noNulls);
  for (int i=0; i < 10; ++i) {
    assertEquals("offset at " + i,0,vector.offsets[i]);
    assertEquals("length at " + i,3,vector.lengths[i]);
  }
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[{\"key\": 3, \"value\": 0.0}," + " {\"key\": 3, \"value\": 10.0}," + " {\"key\": 3, \"value\": 20.0}]",buf.toString());
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertTrue(vector.isRepeating);
  assertFalse(col2.isRepeating);
  assertTrue(col2.noNulls);
  assertTrue(vector.noNulls);
  Arrays.fill(vector.offsets,1,10,-1);
  Arrays.fill(vector.lengths,1,10,-1);
  Arrays.fill(col1.vector,1,10,-1);
  vector.flatten(true,sel,3);
  for (int i=1; i < 10; i++) {
    if (i == 3 || i == 5 || i == 7) {
      assertEquals("failure at " + i,0,vector.offsets[i]);
      assertEquals("failure at " + i,3,vector.lengths[i]);
    }
 else {
      assertEquals("failure at " + i,-1,vector.offsets[i]);
      assertEquals("failure at " + i,-1,vector.lengths[i]);
    }
  }
  for (int i=0; i < 3; ++i) {
    assertEquals("failure at " + i,3,col1.vector[i]);
  }
  for (int i=3; i < 10; ++i) {
    assertEquals("failure at " + i,-1,col1.vector[i]);
  }
  vector.unFlatten();
  vector.reset();
  assertFalse(col1.isRepeating);
  assertTrue(col1.noNulls);
  assertFalse(col2.isRepeating);
  assertTrue(col2.noNulls);
  assertFalse(vector.isRepeating);
  assertTrue(vector.noNulls);
  assertEquals(0,vector.childCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestStructColumnVector </h4><pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  LongColumnVector col2=new LongColumnVector(10);
  StructColumnVector vector=new StructColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  for (int i=0; i < 10; ++i) {
    col1.vector[i]=i;
    col2.vector[i]=2 * i;
  }
  vector.flatten(false,null,10);
  assertFalse(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    assertEquals("col1 at " + i,0,col1.vector[i]);
    assertEquals("col2 at " + i,2 * i,col2.vector[i]);
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("[0, " + (2 * i) + "]",buf.toString());
  }
  vector.reset();
  assertFalse(col1.isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestUnionColumnVector </h4><pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFlatten() throws Exception {
  LongColumnVector col1=new LongColumnVector(10);
  LongColumnVector col2=new LongColumnVector(10);
  UnionColumnVector vector=new UnionColumnVector(10,col1,col2);
  vector.init();
  col1.isRepeating=true;
  for (int i=0; i < 10; ++i) {
    vector.tags[i]=i % 2;
    col1.vector[i]=i;
    col2.vector[i]=2 * i;
  }
  vector.flatten(false,null,10);
  assertFalse(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    assertEquals(i % 2,vector.tags[i]);
    assertEquals("col1 at " + i,0,col1.vector[i]);
    assertEquals("col2 at " + i,2 * i,col2.vector[i]);
  }
  vector.unFlatten();
  assertTrue(col1.isRepeating);
  for (int i=0; i < 10; ++i) {
    StringBuilder buf=new StringBuilder();
    vector.stringifyValue(buf,i);
    assertEquals("{\"tag\": " + (i % 2) + ", \"value\": "+ (i % 2 == 0 ? 0 : 2 * i)+ "}",buf.toString());
  }
  vector.reset();
  assertFalse(col1.isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestVectorizationContext </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMathFunctions() throws HiveException {
  ExprNodeGenericFuncDesc mathFuncExpr=new ExprNodeGenericFuncDesc();
  mathFuncExpr.setTypeInfo(TypeInfoFactory.doubleTypeInfo);
  ExprNodeColumnDesc colDesc1=new ExprNodeColumnDesc(Integer.class,"a","table",false);
  ExprNodeColumnDesc colDesc2=new ExprNodeColumnDesc(Double.class,"b","table",false);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>();
  children1.add(colDesc1);
  children2.add(colDesc2);
  List<String> columns=new ArrayList<String>();
  columns.add("b");
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  GenericUDFBridge gudfBridge=new GenericUDFBridge("sin",false,UDFSin.class.getName());
  mathFuncExpr.setGenericUDF(gudfBridge);
  mathFuncExpr.setChildren(children2);
  VectorExpression ve=vc.getVectorExpression(mathFuncExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  Assert.assertEquals(FuncSinDoubleToDouble.class,ve.getClass());
  GenericUDFRound udfRound=new GenericUDFRound();
  mathFuncExpr.setGenericUDF(udfRound);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncRoundDoubleToDouble.class,ve.getClass());
  GenericUDFBRound udfBRound=new GenericUDFBRound();
  mathFuncExpr.setGenericUDF(udfBRound);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncBRoundDoubleToDouble.class,ve.getClass());
  mathFuncExpr.setGenericUDF(udfRound);
  children2.add(new ExprNodeConstantDesc(4));
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(RoundWithNumDigitsDoubleToDouble.class,ve.getClass());
  Assert.assertEquals(4,((RoundWithNumDigitsDoubleToDouble)ve).getDecimalPlaces().get());
  mathFuncExpr.setGenericUDF(udfBRound);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(BRoundWithNumDigitsDoubleToDouble.class,ve.getClass());
  Assert.assertEquals(4,((BRoundWithNumDigitsDoubleToDouble)ve).getDecimalPlaces().get());
  gudfBridge=new GenericUDFBridge("log",false,UDFLog.class.getName());
  mathFuncExpr.setGenericUDF(gudfBridge);
  children2.clear();
  children2.add(new ExprNodeConstantDesc(4.0));
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLogWithBaseDoubleToDouble.class,ve.getClass());
  Assert.assertTrue(4 == ((FuncLogWithBaseDoubleToDouble)ve).getBase());
  children2.clear();
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLnDoubleToDouble.class,ve.getClass());
  children2.clear();
  children2.add(new ExprNodeConstantDesc(4.5));
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLogWithBaseDoubleToDouble.class,ve.getClass());
  Assert.assertTrue(4.5 == ((FuncLogWithBaseDoubleToDouble)ve).getBase());
  children2.clear();
  children2.add(new ExprNodeConstantDesc(4.5));
  children2.add(colDesc1);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLogWithBaseLongToDouble.class,ve.getClass());
  Assert.assertTrue(4.5 == ((FuncLogWithBaseLongToDouble)ve).getBase());
  children2.clear();
  children2.add(colDesc2);
  children2.add(new ExprNodeConstantDesc(4.5));
  mathFuncExpr.setGenericUDF(new GenericUDFPower());
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncPowerDoubleToDouble.class,ve.getClass());
  Assert.assertTrue(4.5 == ((FuncPowerDoubleToDouble)ve).getPower());
  mathFuncExpr.setGenericUDF(udfRound);
  children2.clear();
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncRoundDoubleToDouble.class,ve.getClass());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBetweenFilters() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(String.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc("Alpha");
  ExprNodeConstantDesc constDesc2=new ExprNodeConstantDesc("Bravo");
  GenericUDFBetween udf=new GenericUDFBetween();
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  children1.add(new ExprNodeConstantDesc(new Boolean(false)));
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringColumnNotBetween);
  CharTypeInfo charTypeInfo=new CharTypeInfo(10);
  col1Expr=new ExprNodeColumnDesc(charTypeInfo,"col1","table",false);
  constDesc=new ExprNodeConstantDesc(charTypeInfo,new HiveChar("Alpha",10));
  constDesc2=new ExprNodeConstantDesc(charTypeInfo,new HiveChar("Bravo",10));
  udf=new GenericUDFBetween();
  children1=new ArrayList<ExprNodeDesc>();
  children1.add(new ExprNodeConstantDesc(new Boolean(false)));
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterCharColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterCharColumnNotBetween);
  VarcharTypeInfo varcharTypeInfo=new VarcharTypeInfo(10);
  col1Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col1","table",false);
  constDesc=new ExprNodeConstantDesc(varcharTypeInfo,new HiveVarchar("Alpha",10));
  constDesc2=new ExprNodeConstantDesc(varcharTypeInfo,new HiveVarchar("Bravo",10));
  udf=new GenericUDFBetween();
  children1=new ArrayList<ExprNodeDesc>();
  children1.add(new ExprNodeConstantDesc(new Boolean(false)));
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterVarCharColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterVarCharColumnNotBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(false)));
  children1.set(1,new ExprNodeColumnDesc(Long.class,"col1","table",false));
  children1.set(2,new ExprNodeConstantDesc(10));
  children1.set(3,new ExprNodeConstantDesc(20));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterLongColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterLongColumnNotBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(false)));
  children1.set(1,new ExprNodeColumnDesc(Double.class,"col1","table",false));
  children1.set(2,new ExprNodeConstantDesc(10.0d));
  children1.set(3,new ExprNodeConstantDesc(20.0d));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterDoubleColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterDoubleColumnNotBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(false)));
  children1.set(1,new ExprNodeColumnDesc(Timestamp.class,"col1","table",false));
  children1.set(2,new ExprNodeConstantDesc("2013-11-05 00:00:00.000"));
  children1.set(3,new ExprNodeConstantDesc("2013-11-06 00:00:00.000"));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(FilterStringColumnBetween.class,ve.getClass());
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(FilterStringColumnNotBetween.class,ve.getClass());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticExpressionVectorization() throws HiveException {
  GenericUDFOPPlus udf1=new GenericUDFOPPlus();
  GenericUDFOPMinus udf2=new GenericUDFOPMinus();
  GenericUDFOPMultiply udf3=new GenericUDFOPMultiply();
  GenericUDFOPPlus udf4=new GenericUDFOPPlus();
  GenericUDFOPMod udf5=new GenericUDFOPMod();
  ExprNodeGenericFuncDesc sumExpr=new ExprNodeGenericFuncDesc();
  sumExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  sumExpr.setGenericUDF(udf1);
  ExprNodeGenericFuncDesc minusExpr=new ExprNodeGenericFuncDesc();
  minusExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  minusExpr.setGenericUDF(udf2);
  ExprNodeGenericFuncDesc multiplyExpr=new ExprNodeGenericFuncDesc();
  multiplyExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  multiplyExpr.setGenericUDF(udf3);
  ExprNodeGenericFuncDesc sum2Expr=new ExprNodeGenericFuncDesc();
  sum2Expr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  sum2Expr.setGenericUDF(udf4);
  ExprNodeGenericFuncDesc modExpr=new ExprNodeGenericFuncDesc();
  modExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  modExpr.setGenericUDF(udf5);
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Long.class,"col1","table",false);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Long.class,"col2","table",false);
  ExprNodeColumnDesc col3Expr=new ExprNodeColumnDesc(Long.class,"col3","table",false);
  ExprNodeColumnDesc col4Expr=new ExprNodeColumnDesc(Long.class,"col4","table",false);
  ExprNodeColumnDesc col5Expr=new ExprNodeColumnDesc(Long.class,"col5","table",false);
  ExprNodeColumnDesc col6Expr=new ExprNodeColumnDesc(Long.class,"col6","table",false);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children3=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children4=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children5=new ArrayList<ExprNodeDesc>(2);
  children1.add(minusExpr);
  children1.add(multiplyExpr);
  sumExpr.setChildren(children1);
  children2.add(sum2Expr);
  children2.add(col3Expr);
  minusExpr.setChildren(children2);
  children3.add(col1Expr);
  children3.add(col2Expr);
  sum2Expr.setChildren(children3);
  children4.add(col4Expr);
  children4.add(modExpr);
  multiplyExpr.setChildren(children4);
  children5.add(col5Expr);
  children5.add(col6Expr);
  modExpr.setChildren(children5);
  VectorizationContext vc=new VectorizationContext("name");
  vc.addInitialColumn("col1");
  vc.addInitialColumn("col2");
  vc.addInitialColumn("col3");
  vc.addInitialColumn("col4");
  vc.addInitialColumn("col5");
  vc.addInitialColumn("col6");
  vc.finishedAddingInitialColumns();
  VectorExpression ve=vc.getVectorExpression(sumExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof LongColAddLongColumn);
  assertEquals(2,ve.getChildExpressions().length);
  VectorExpression childExpr1=ve.getChildExpressions()[0];
  VectorExpression childExpr2=ve.getChildExpressions()[1];
  System.out.println(ve.toString());
  assertEquals(6,ve.getOutputColumn());
  assertTrue(childExpr1 instanceof LongColSubtractLongColumn);
  assertEquals(1,childExpr1.getChildExpressions().length);
  assertTrue(childExpr1.getChildExpressions()[0] instanceof LongColAddLongColumn);
  assertEquals(7,childExpr1.getOutputColumn());
  assertEquals(6,childExpr1.getChildExpressions()[0].getOutputColumn());
  assertTrue(childExpr2 instanceof LongColMultiplyLongColumn);
  assertEquals(1,childExpr2.getChildExpressions().length);
  assertTrue(childExpr2.getChildExpressions()[0] instanceof LongColModuloLongColumn);
  assertEquals(8,childExpr2.getOutputColumn());
  assertEquals(6,childExpr2.getChildExpressions()[0].getOutputColumn());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestConstantVectorExpression </h4><pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstantExpression(){
  ConstantVectorExpression longCve=new ConstantVectorExpression(0,17);
  ConstantVectorExpression doubleCve=new ConstantVectorExpression(1,17.34);
  String str="alpha";
  ConstantVectorExpression bytesCve=new ConstantVectorExpression(2,str.getBytes());
  HiveDecimal decVal=HiveDecimal.create("25.8");
  ConstantVectorExpression decimalCve=new ConstantVectorExpression(3,decVal);
  ConstantVectorExpression nullCve=new ConstantVectorExpression(4,"string",true);
  int size=20;
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(size,5,0);
  LongColumnVector lcv=(LongColumnVector)vrg.cols[0];
  DoubleColumnVector dcv=new DoubleColumnVector(size);
  BytesColumnVector bcv=new BytesColumnVector(size);
  DecimalColumnVector dv=new DecimalColumnVector(5,1);
  BytesColumnVector bcvn=new BytesColumnVector(size);
  vrg.cols[1]=dcv;
  vrg.cols[2]=bcv;
  vrg.cols[3]=dv;
  vrg.cols[4]=bcvn;
  longCve.evaluate(vrg);
  doubleCve.evaluate(vrg);
  bytesCve.evaluate(vrg);
  decimalCve.evaluate(vrg);
  nullCve.evaluate(vrg);
  assertTrue(lcv.isRepeating);
  assertTrue(dcv.isRepeating);
  assertTrue(bcv.isRepeating);
  assertEquals(17,lcv.vector[0]);
  assertTrue(17.34 == dcv.vector[0]);
  assertTrue(bcvn.isRepeating);
  assertTrue(bcvn.isNull[0]);
  assertTrue(!bcvn.noNulls);
  byte[] alphaBytes="alpha".getBytes();
  assertTrue(bcv.length[0] == alphaBytes.length);
  assertTrue(sameFirstKBytes(alphaBytes,bcv.vector[0],alphaBytes.length));
  ((BytesColumnVector)(vrg.cols[2])).vector[0]="beta".getBytes();
  bytesCve.evaluate(vrg);
  assertTrue(bcv.length[0] == alphaBytes.length);
  assertTrue(sameFirstKBytes(alphaBytes,bcv.vector[0],alphaBytes.length));
  assertTrue(25.8 == dv.vector[0].getHiveDecimal().doubleValue());
  ((DecimalColumnVector)(vrg.cols[3])).vector[0].set(HiveDecimal.create("39.7"));
  decimalCve.evaluate(vrg);
  assertTrue(25.8 == dv.vector[0].getHiveDecimal().doubleValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorArithmeticExpressions </h4><pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongScalarWithRepeating(){
  LongColumnVector in, out;
  VectorizedRowBatch batch;
  LongColAddLongScalar expr;
  batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  in=(LongColumnVector)batch.cols[0];
  in.isRepeating=true;
  out=(LongColumnVector)batch.cols[1];
  out.isRepeating=false;
  expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(batch);
  Assert.assertTrue(out.isRepeating);
  Assert.assertTrue(out.noNulls);
  Assert.assertEquals(out.vector[0],0 * 37 + 23);
  batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  in=(LongColumnVector)batch.cols[0];
  in.isRepeating=true;
  in.noNulls=false;
  in.isNull[0]=true;
  out=(LongColumnVector)batch.cols[1];
  out.isRepeating=false;
  out.isNull[0]=false;
  out.noNulls=true;
  expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(batch);
  Assert.assertTrue(out.isRepeating);
  Assert.assertFalse(out.noNulls);
  Assert.assertEquals(true,out.isNull[0]);
  verifyLongNullDataVectorEntries(out,batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongScalarWithNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColumnVector lcv=(LongColumnVector)batch.cols[0];
  LongColumnVector lcvOut=(LongColumnVector)batch.cols[1];
  TestVectorizedRowBatch.addRandomNulls(lcv);
  LongColAddLongScalar expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    if (!lcv.isNull[i]) {
      Assert.assertEquals(i * 37 + 23,lcvOut.vector[i]);
    }
 else {
      Assert.assertTrue(lcvOut.isNull[i]);
    }
  }
  Assert.assertFalse(lcvOut.noNulls);
  Assert.assertFalse(lcvOut.isRepeating);
  verifyLongNullDataVectorEntries(lcvOut,batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongColumn(){
  int seed=17;
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(VectorizedRowBatch.DEFAULT_SIZE,6,seed);
  LongColumnVector lcv0=(LongColumnVector)vrg.cols[0];
  LongColumnVector lcv1=(LongColumnVector)vrg.cols[1];
  LongColumnVector lcv2=(LongColumnVector)vrg.cols[2];
  LongColumnVector lcv3=(LongColumnVector)vrg.cols[3];
  LongColumnVector lcv4=(LongColumnVector)vrg.cols[4];
  LongColumnVector lcv5=(LongColumnVector)vrg.cols[5];
  LongColAddLongColumn expr=new LongColAddLongColumn(0,1,2);
  expr.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    assertEquals((i + 1) * seed * 3,lcv2.vector[i]);
  }
  assertTrue(lcv2.noNulls);
  lcv1.noNulls=false;
  lcv1.isNull[1]=true;
  lcv2.isRepeating=true;
  lcv2.noNulls=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.isNull[1]);
  assertFalse(lcv2.noNulls);
  assertFalse(lcv2.isRepeating);
  verifyLongNullDataVectorEntries(lcv2,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv0.noNulls=false;
  lcv0.isNull[1]=true;
  lcv0.isNull[3]=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.isNull[1]);
  assertTrue(lcv2.isNull[3]);
  assertFalse(lcv2.noNulls);
  verifyLongNullDataVectorEntries(lcv2,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv3.isRepeating=true;
  LongColAddLongColumn expr2=new LongColAddLongColumn(3,4,5);
  expr2.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    assertEquals(seed * (4 + 5 * (i + 1)),lcv5.vector[i]);
  }
  lcv4.noNulls=false;
  lcv4.isNull[0]=true;
  expr2.evaluate(vrg);
  assertTrue(lcv5.isNull[0]);
  assertFalse(lcv5.noNulls);
  verifyLongNullDataVectorEntries(lcv5,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv3.isRepeating=true;
  lcv3.noNulls=false;
  lcv3.isNull[0]=true;
  expr2.evaluate(vrg);
  assertFalse(lcv5.noNulls);
  assertTrue(lcv5.isRepeating);
  assertTrue(lcv5.isNull[0]);
  verifyLongNullDataVectorEntries(lcv5,vrg.selected,vrg.selectedInUse,vrg.size);
  vrg.selectedInUse=false;
  lcv0.noNulls=true;
  lcv1.noNulls=true;
  lcv0.isRepeating=false;
  lcv1.isRepeating=false;
  lcv2.noNulls=false;
  lcv2.isRepeating=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.noNulls);
  assertFalse(lcv2.isRepeating);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongScalarNoNulls(){
  VectorizedRowBatch vrg=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColAddLongScalar expr=new LongColAddLongScalar(0,23,1);
  expr.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertEquals(i * 37 + 23,((LongColumnVector)vrg.cols[1]).vector[i]);
  }
  Assert.assertTrue(((LongColumnVector)vrg.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)vrg.cols[1]).isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorDateExpressions </h4><pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=5000) public void testMultiThreadedVectorUDFDate(){
  List<Callable<Void>> tasks=new ArrayList<Callable<Void>>();
  for (int i=0; i < 200; i++) {
    tasks.add(new MultiThreadedDateFormatTest());
  }
  try {
    List<Future<Void>> results=runner.invokeAll(tasks);
    for (    Future<Void> f : results) {
      Assert.assertNull(f.get());
    }
  }
 catch (  InterruptedException ioe) {
    Assert.fail("Interrupted while running tests");
  }
catch (  Exception e) {
    Assert.fail("Multi threaded operations threw unexpected Exception: " + e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorFilterExpressions </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColOpScalarNumericFilterNullAndRepeatingLogic(){
  FilterLongColGreaterLongScalar f=new FilterLongColGreaterLongScalar(0,1);
  VectorizedRowBatch batch=this.getSimpleLongBatch();
  batch.cols[0].noNulls=true;
  batch.cols[0].isRepeating=false;
  f.evaluate(batch);
  Assert.assertEquals(2,batch.size);
  Assert.assertTrue(batch.selectedInUse);
  Assert.assertEquals(2,batch.selected[0]);
  Assert.assertEquals(3,batch.selected[1]);
  f=new FilterLongColGreaterLongScalar(0,-1);
  batch=getSimpleLongBatch();
  f.evaluate(batch);
  Assert.assertFalse(batch.selectedInUse);
  Assert.assertEquals(4,batch.size);
  batch=getSimpleLongBatch();
  f=new FilterLongColGreaterLongScalar(0,1);
  batch.cols[0].noNulls=false;
  batch.cols[0].isRepeating=false;
  batch.cols[0].isNull[3]=true;
  f.evaluate(batch);
  Assert.assertTrue(batch.selectedInUse);
  Assert.assertEquals(1,batch.size);
  Assert.assertEquals(2,batch.selected[0]);
  batch=getSimpleLongBatch();
  f=new FilterLongColGreaterLongScalar(0,-1);
  batch.cols[0].noNulls=true;
  batch.cols[0].isRepeating=true;
  f.evaluate(batch);
  Assert.assertFalse(batch.selectedInUse);
  Assert.assertEquals(4,batch.size);
  batch=getSimpleLongBatch();
  batch.cols[0].noNulls=false;
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  f.evaluate(batch);
  Assert.assertEquals(0,batch.size);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Spot check col < scalar for decimal.
 */
@Test public void testFilterDecimalColLessScalar(){
  VectorizedRowBatch b=getVectorizedRowBatch1DecimalCol();
  HiveDecimal scalar=HiveDecimal.create("0");
  VectorExpression expr=new FilterDecimalColLessDecimalScalar(0,scalar);
  expr.evaluate(b);
  assertTrue(b.selectedInUse);
  assertEquals(1,b.selected[0]);
  assertEquals(1,b.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterStringIn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(3,2,seed);
  vrb.cols[0]=new BytesColumnVector();
  BytesColumnVector bcv=(BytesColumnVector)vrb.cols[0];
  bcv.initBuffer();
  bcv.setVal(0,a,0,1);
  bcv.setVal(1,b,0,1);
  bcv.setVal(2,c,0,1);
  VectorExpression expr=new FilterStringColumnInList(0);
  byte[][] inList={b,c};
  ((FilterStringColumnInList)expr).setInListValues(inList);
  expr.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isNull[2]=true;
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertEquals(1,vrb.selected[0]);
  assertTrue(vrb.selectedInUse);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=true;
  bcv.isRepeating=true;
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isRepeating=true;
  bcv.isNull[0]=true;
  bcv.setVal(0,b,0,1);
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests the template for Decimal Column-Column comparison filters,
 * called FilterDecimalColumnCompareColumn.txt. Only equal is tested for multiple
 * cases because the logic is the same for <, >, <=, >=, == and !=.
 */
@Test public void testFilterDecimalColumnEqualDecimalColumn(){
  VectorizedRowBatch b=getVectorizedRowBatch2DecimalCol();
  VectorExpression expr=new FilterDecimalColEqualDecimalColumn(0,1);
  expr.evaluate(b);
  assertTrue(b.selectedInUse);
  assertEquals(1,b.selected[0]);
  assertEquals(1,b.size);
  b=getVectorizedRowBatch2DecimalCol();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[1]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch2DecimalCol();
  b.cols[0].isRepeating=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch2DecimalCol();
  b.cols[0].isRepeating=true;
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch2DecimalCol();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  b.cols[1].noNulls=false;
  b.cols[1].isNull[2]=true;
  expr.evaluate(b);
  assertEquals(1,b.size);
  b=getVectorizedRowBatch2DecimalCol();
  b.cols[0].isRepeating=true;
  b.cols[1].isRepeating=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests the template for Decimal Column-Scalar comparison filters,
 * called FilterDecimalColumnCompareScalar.txt. Only equal is tested for
 * multiple cases because the logic is the same for <, >, <=, >=, == and !=.
 */
@Test public void testFilterDecimalColEqualDecimalScalar(){
  VectorizedRowBatch b=getVectorizedRowBatch1DecimalCol();
  HiveDecimal scalar=HiveDecimal.create("-3.30");
  VectorExpression expr=new FilterDecimalColEqualDecimalScalar(0,scalar);
  expr.evaluate(b);
  assertTrue(b.selectedInUse);
  assertEquals(1,b.selected[0]);
  assertEquals(1,b.size);
  b=getVectorizedRowBatch1DecimalCol();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[1]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch1DecimalCol();
  b.cols[0].isRepeating=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch1DecimalCol();
  b.cols[0].isRepeating=true;
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterLongNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  VectorExpression expr=new FilterLongColumnNotBetween(0,10,20);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDoubleNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  vrb.cols[0]=new DoubleColumnVector();
  DoubleColumnVector dcv=(DoubleColumnVector)vrb.cols[0];
  dcv.vector[0]=5;
  dcv.vector[1]=20;
  dcv.vector[2]=17;
  dcv.vector[3]=15;
  dcv.vector[4]=10;
  VectorExpression expr=new FilterDoubleColumnNotBetween(0,10,20);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterStringBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(3,2,seed);
  vrb.cols[0]=new BytesColumnVector();
  BytesColumnVector bcv=(BytesColumnVector)vrb.cols[0];
  bcv.initBuffer();
  bcv.setVal(0,a,0,1);
  bcv.setVal(1,b,0,1);
  bcv.setVal(2,c,0,1);
  VectorExpression expr=new FilterStringColumnBetween(0,b,c);
  expr.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isNull[2]=true;
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertEquals(1,vrb.selected[0]);
  assertTrue(vrb.selectedInUse);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=true;
  bcv.isRepeating=true;
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isRepeating=true;
  bcv.isNull[0]=true;
  bcv.setVal(0,b,0,1);
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Spot check scalar > col for decimal.
 */
@Test public void testFilterDecimalScalarGreaterThanColumn(){
  VectorizedRowBatch b=getVectorizedRowBatch1DecimalCol();
  HiveDecimal scalar=HiveDecimal.create("0");
  VectorExpression expr=new FilterDecimalScalarGreaterDecimalColumn(scalar,0);
  expr.evaluate(b);
  assertTrue(b.selectedInUse);
  assertEquals(1,b.selected[0]);
  assertEquals(1,b.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterStringNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(3,2,seed);
  vrb.cols[0]=new BytesColumnVector();
  BytesColumnVector bcv=(BytesColumnVector)vrb.cols[0];
  bcv.initBuffer();
  bcv.setVal(0,a,0,1);
  bcv.setVal(1,b,0,1);
  bcv.setVal(2,c,0,1);
  VectorExpression expr=new FilterStringColumnNotBetween(0,b,c);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests the template for Decimal Scalar-Column comparison filters,
 * called FilterDecimalScalarCompareColumn.txt. Only equal is tested for multiple
 * cases because the logic is the same for <, >, <=, >=, == and !=.
 */
@Test public void testFilterDecimalScalarEqualDecimalColumn(){
  VectorizedRowBatch b=getVectorizedRowBatch1DecimalCol();
  HiveDecimal scalar=HiveDecimal.create("-3.30");
  VectorExpression expr=new FilterDecimalScalarEqualDecimalColumn(scalar,0);
  expr.evaluate(b);
  assertTrue(b.selectedInUse);
  assertEquals(1,b.selected[0]);
  assertEquals(1,b.size);
  b=getVectorizedRowBatch1DecimalCol();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[1]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch1DecimalCol();
  b.cols[0].isRepeating=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b=getVectorizedRowBatch1DecimalCol();
  b.cols[0].isRepeating=true;
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterLongBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  VectorExpression expr1=new FilterLongColumnBetween(0,15,17);
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(2,vrb.selected[0]);
  assertEquals(3,vrb.selected[1]);
  VectorizedRowBatch vrb1=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  lcv0=(LongColumnVector)vrb1.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  expr1.evaluate(vrb1);
  assertEquals(1,vrb1.size);
  assertTrue(vrb1.selectedInUse);
  assertEquals(3,vrb1.selected[0]);
  VectorizedRowBatch vrb2=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  vrb2.selectedInUse=true;
  vrb2.selected[0]=1;
  vrb2.selected[1]=2;
  vrb2.selected[2]=4;
  vrb2.size=3;
  lcv0=(LongColumnVector)vrb2.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.vector[5]=19;
  lcv0.vector[6]=21;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  lcv0.isNull[5]=true;
  expr1.evaluate(vrb2);
  assertEquals(0,vrb2.size);
  VectorizedRowBatch vrb3=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  lcv0=(LongColumnVector)vrb3.cols[0];
  lcv0.isRepeating=true;
  lcv0.vector[0]=17;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb3);
  assertEquals(7,vrb3.size);
  assertFalse(vrb3.selectedInUse);
  assertTrue(lcv0.isRepeating);
  lcv0.noNulls=false;
  lcv0.vector[0]=17;
  lcv0.isNull[0]=true;
  expr1.evaluate(vrb3);
  assertEquals(0,vrb3.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the IN filter VectorExpression classes.
 */
@Test public void testFilterLongIn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  long[] inList={5,20};
  FilterLongColumnInList f=new FilterLongColumnInList(0);
  f.setInListValues(inList);
  VectorExpression expr1=f;
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
  assertEquals(1,vrb.selected[1]);
  VectorizedRowBatch vrb1=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  lcv0=(LongColumnVector)vrb1.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  expr1.evaluate(vrb1);
  assertEquals(1,vrb1.size);
  assertTrue(vrb1.selectedInUse);
  assertEquals(1,vrb1.selected[0]);
  VectorizedRowBatch vrb2=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  vrb2.selectedInUse=true;
  vrb2.selected[0]=1;
  vrb2.selected[1]=2;
  vrb2.selected[2]=4;
  vrb2.size=3;
  lcv0=(LongColumnVector)vrb2.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.vector[5]=19;
  lcv0.vector[6]=21;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  lcv0.isNull[5]=true;
  expr1.evaluate(vrb2);
  assertEquals(1,vrb2.size);
  assertEquals(1,vrb2.selected[0]);
  VectorizedRowBatch vrb3=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  lcv0=(LongColumnVector)vrb3.cols[0];
  lcv0.isRepeating=true;
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb3);
  assertEquals(7,vrb3.size);
  assertFalse(vrb3.selectedInUse);
  assertTrue(lcv0.isRepeating);
  lcv0.noNulls=false;
  lcv0.vector[0]=5;
  lcv0.isNull[0]=true;
  expr1.evaluate(vrb3);
  assertEquals(0,vrb3.size);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Spot check col >= col for decimal.
 */
@Test public void testFilterDecimalColGreaterEqualCol(){
  VectorizedRowBatch b=getVectorizedRowBatch2DecimalCol();
  VectorExpression expr=new FilterDecimalColGreaterEqualDecimalColumn(0,1);
  expr.evaluate(b);
  assertTrue(b.selectedInUse);
  assertEquals(0,b.selected[0]);
  assertEquals(1,b.selected[1]);
  assertEquals(2,b.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDoubleBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  DoubleColumnVector dcv0=new DoubleColumnVector();
  vrb.cols[0]=dcv0;
  dcv0.vector[0]=5;
  dcv0.vector[1]=20;
  dcv0.vector[2]=17;
  dcv0.vector[3]=15;
  dcv0.vector[4]=10;
  VectorExpression expr=new FilterDoubleColumnBetween(0,20,21);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDoubleIn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  DoubleColumnVector dcv0=new DoubleColumnVector();
  vrb.cols[0]=dcv0;
  double[] inList={5.0,20.2};
  FilterDoubleColumnInList f=new FilterDoubleColumnInList(0);
  f.setInListValues(inList);
  VectorExpression expr1=f;
  dcv0.vector[0]=5.0;
  dcv0.vector[1]=20.2;
  dcv0.vector[2]=17.0;
  dcv0.vector[3]=15.0;
  dcv0.vector[4]=10.0;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
  assertEquals(1,vrb.selected[1]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterLongScalarLessLongColumn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  FilterLongScalarLessLongColumn expr1=new FilterLongScalarLessLongColumn(15,0);
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
  FilterLongScalarGreaterLongColumn expr2=new FilterLongScalarGreaterLongColumn(18,0);
  expr2.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(2,vrb.selected[0]);
  VectorizedRowBatch vrb1=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  lcv0=(LongColumnVector)vrb1.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  expr1.evaluate(vrb1);
  assertEquals(1,vrb1.size);
  assertTrue(vrb1.selectedInUse);
  assertEquals(1,vrb1.selected[0]);
  VectorizedRowBatch vrb2=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  vrb2.selectedInUse=true;
  vrb2.selected[0]=1;
  vrb2.selected[1]=2;
  vrb2.selected[2]=4;
  vrb2.size=3;
  lcv0=(LongColumnVector)vrb2.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.vector[5]=19;
  lcv0.vector[6]=21;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  lcv0.isNull[5]=true;
  expr1.evaluate(vrb2);
  assertEquals(1,vrb2.size);
  assertTrue(vrb2.selectedInUse);
  assertEquals(1,vrb2.selected[0]);
  VectorizedRowBatch vrb3=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  lcv0=(LongColumnVector)vrb3.cols[0];
  lcv0.isRepeating=true;
  lcv0.vector[0]=17;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb3);
  assertEquals(7,vrb3.size);
  assertFalse(vrb3.selectedInUse);
  assertTrue(lcv0.isRepeating);
  lcv0.noNulls=false;
  lcv0.vector[0]=17;
  lcv0.isNull[0]=true;
  expr1.evaluate(vrb3);
  assertEquals(0,vrb3.size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorLogicalExpressions </h4><pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsNotNullExpr(){
  VectorizedRowBatch batch=getBatchThreeBooleanCols();
  IsNotNull expr=new IsNotNull(0,2);
  LongColumnVector outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertEquals(1,outCol.vector[0]);
  Assert.assertEquals(0,outCol.vector[4]);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(1,outCol.vector[0]);
  batch=getBatchThreeBooleanCols();
  outCol=(LongColumnVector)batch.cols[2];
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertTrue(outCol.noNulls);
  batch=getBatchThreeBooleanCols();
  outCol=(LongColumnVector)batch.cols[2];
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(1,outCol.vector[0]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsNullExpr(){
  VectorizedRowBatch batch=getBatchThreeBooleanCols();
  IsNull expr=new IsNull(0,2);
  LongColumnVector outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(1,outCol.vector[4]);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(0,outCol.vector[0]);
  batch=getBatchThreeBooleanCols();
  outCol=(LongColumnVector)batch.cols[2];
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertEquals(1,outCol.vector[0]);
  Assert.assertTrue(outCol.noNulls);
  batch=getBatchThreeBooleanCols();
  outCol=(LongColumnVector)batch.cols[2];
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(0,outCol.vector[0]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColOrLongCol(){
  VectorizedRowBatch batch=getBatchThreeBooleanCols();
  ColOrCol expr=new ColOrCol(0,1,2);
  LongColumnVector outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(1,outCol.vector[1]);
  Assert.assertEquals(1,outCol.vector[2]);
  Assert.assertEquals(1,outCol.vector[3]);
  Assert.assertFalse(outCol.isNull[3]);
  Assert.assertTrue(outCol.isNull[4]);
  Assert.assertEquals(1,outCol.vector[5]);
  Assert.assertTrue(outCol.isNull[6]);
  Assert.assertEquals(1,outCol.vector[7]);
  Assert.assertTrue(outCol.isNull[8]);
  Assert.assertEquals(batch.size,9);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=getBatchThreeBooleanCols();
  batch.cols[0].noNulls=true;
  batch.cols[1].noNulls=true;
  batch.cols[2].noNulls=false;
  outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(1,outCol.vector[1]);
  Assert.assertEquals(1,outCol.vector[2]);
  Assert.assertEquals(1,outCol.vector[3]);
  batch=getBatchThreeBooleanCols();
  batch.cols[0].noNulls=true;
  batch.cols[0].isRepeating=true;
  batch.cols[1].noNulls=true;
  batch.cols[1].isRepeating=false;
  batch.cols[2].noNulls=false;
  batch.cols[2].isRepeating=true;
  outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(1,outCol.vector[1]);
  Assert.assertEquals(0,outCol.vector[2]);
  Assert.assertEquals(1,outCol.vector[3]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAndLongCol(){
  VectorizedRowBatch batch=getBatchThreeBooleanCols();
  ColAndCol expr=new ColAndCol(0,1,2);
  LongColumnVector outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(0,outCol.vector[1]);
  Assert.assertEquals(0,outCol.vector[2]);
  Assert.assertEquals(1,outCol.vector[3]);
  Assert.assertEquals(0,outCol.vector[4]);
  Assert.assertFalse(outCol.isNull[4]);
  Assert.assertTrue(outCol.isNull[5]);
  Assert.assertEquals(0,outCol.vector[6]);
  Assert.assertFalse(outCol.isNull[6]);
  Assert.assertTrue(outCol.isNull[7]);
  Assert.assertTrue(outCol.isNull[8]);
  Assert.assertEquals(batch.size,9);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=getBatchThreeBooleanCols();
  batch.cols[0].noNulls=true;
  batch.cols[1].noNulls=true;
  batch.cols[2].noNulls=false;
  outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(0,outCol.vector[1]);
  Assert.assertEquals(0,outCol.vector[2]);
  Assert.assertEquals(1,outCol.vector[3]);
  batch=getBatchThreeBooleanCols();
  ((LongColumnVector)batch.cols[0]).vector[0]=1;
  batch.cols[0].noNulls=true;
  batch.cols[0].isRepeating=true;
  batch.cols[1].noNulls=true;
  batch.cols[1].isRepeating=false;
  batch.cols[2].noNulls=false;
  batch.cols[2].isRepeating=true;
  outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,outCol.vector[0]);
  Assert.assertEquals(1,outCol.vector[1]);
  Assert.assertEquals(0,outCol.vector[2]);
  Assert.assertEquals(1,outCol.vector[3]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBooleanNot(){
  VectorizedRowBatch batch=getBatchThreeBooleanCols();
  NotCol expr=new NotCol(0,2);
  LongColumnVector outCol=(LongColumnVector)batch.cols[2];
  expr.evaluate(batch);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(1,outCol.vector[0]);
  Assert.assertFalse(outCol.isNull[0]);
  Assert.assertEquals(0,outCol.vector[2]);
  Assert.assertFalse(outCol.isNull[0]);
  Assert.assertTrue(outCol.isNull[4]);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(1,outCol.vector[0]);
  Assert.assertEquals(0,outCol.vector[2]);
  batch=getBatchThreeBooleanCols();
  outCol=(LongColumnVector)batch.cols[2];
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.isNull[0]);
  batch=getBatchThreeBooleanCols();
  outCol=(LongColumnVector)batch.cols[2];
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(1,outCol.vector[0]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorMathFunctions </h4><pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVectorPosMod(){
  VectorizedRowBatch b=getVectorizedRowBatchDoubleInDoubleOut();
  DoubleColumnVector inV=(DoubleColumnVector)b.cols[0];
  DoubleColumnVector resultV=(DoubleColumnVector)b.cols[1];
  b.cols[0].noNulls=true;
  inV.vector[4]=-4.0;
  VectorExpression expr=new PosModDoubleToDouble(0,0.3d,1);
  expr.evaluate(b);
  Assert.assertTrue(equalsWithinTolerance(((-4.0d % 0.3d) + 0.3d) % 0.3d,resultV.vector[4]));
  b=getVectorizedRowBatchLongInLongOut();
  LongColumnVector resV2=(LongColumnVector)b.cols[1];
  b.cols[0].noNulls=true;
  expr=new PosModLongToLong(0,3,1);
  expr.evaluate(b);
  Assert.assertEquals(((-2 % 3) + 3) % 3,resV2.vector[0]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVectorLog10(){
  VectorizedRowBatch b=getVectorizedRowBatchDoubleInDoubleOut();
  DoubleColumnVector resultV=(DoubleColumnVector)b.cols[1];
  b.cols[0].noNulls=true;
  VectorExpression expr=new FuncLog10DoubleToDouble(0,1);
  expr.evaluate(b);
  Assert.assertTrue(equalsWithinTolerance(Math.log(0.5d) / Math.log(10),resultV.vector[4]));
  b=getVectorizedRowBatchLongInDoubleOut();
  resultV=(DoubleColumnVector)b.cols[1];
  b.cols[0].noNulls=true;
  expr=new FuncLog10LongToDouble(0,1);
  expr.evaluate(b);
  Assert.assertEquals(Math.log(1) / Math.log(10),resultV.vector[3]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorScalarColArithmetic </h4><pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarSubtractLongColNoNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongScalarSubtractLongColumn expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertEquals(100 - i * 37,((LongColumnVector)batch.cols[1]).vector[i]);
  }
  Assert.assertTrue(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarSubtractLongColWithRepeating(){
  LongColumnVector in, out;
  VectorizedRowBatch batch;
  LongScalarSubtractLongColumn expr;
  batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  in=(LongColumnVector)batch.cols[0];
  in.isRepeating=true;
  out=(LongColumnVector)batch.cols[1];
  out.isRepeating=false;
  expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  Assert.assertTrue(out.isRepeating);
  Assert.assertTrue(out.noNulls);
  Assert.assertEquals(out.vector[0],100 - 0 * 37);
  batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  in=(LongColumnVector)batch.cols[0];
  in.isRepeating=true;
  in.noNulls=false;
  in.isNull[0]=true;
  out=(LongColumnVector)batch.cols[1];
  out.isRepeating=false;
  out.isNull[0]=false;
  out.noNulls=true;
  expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  Assert.assertTrue(out.isRepeating);
  Assert.assertFalse(out.noNulls);
  Assert.assertEquals(true,out.isNull[0]);
  TestVectorArithmeticExpressions.verifyLongNullDataVectorEntries(out,batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarSubtractLongColWithNulls(){
  VectorizedRowBatch batch=getVectorizedRowBatchSingleLongVector(VectorizedRowBatch.DEFAULT_SIZE);
  LongColumnVector lcv=(LongColumnVector)batch.cols[0];
  TestVectorizedRowBatch.addRandomNulls(lcv);
  LongScalarSubtractLongColumn expr=new LongScalarSubtractLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    if (!lcv.isNull[i]) {
      Assert.assertEquals(100 - i * 37,((LongColumnVector)batch.cols[1]).vector[i]);
    }
 else {
      Assert.assertTrue(((LongColumnVector)batch.cols[1]).isNull[i]);
    }
  }
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
  TestVectorArithmeticExpressions.verifyLongNullDataVectorEntries((LongColumnVector)batch.cols[1],batch.selected,batch.selectedInUse,batch.size);
}

</code></pre>

<br>
<pre class="type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongScalarModuloLongColNoNulls(){
  VectorizedRowBatch batch=getBatchSingleLongVectorPositiveNonZero();
  LongScalarModuloLongColumn expr=new LongScalarModuloLongColumn(100,0,1);
  expr.evaluate(batch);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertEquals(100 % ((i + 1) * 37),((LongColumnVector)batch.cols[1]).vector[i]);
  }
  Assert.assertTrue(((LongColumnVector)batch.cols[1]).noNulls);
  Assert.assertFalse(((LongColumnVector)batch.cols[1]).isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorStringExpressions </h4><pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringColCompareStringColProjection(){
  VectorizedRowBatch batch;
  VectorExpression expr;
  long[] outVector;
  batch=makeStringBatchForColColCompare();
  expr=new StringGroupColLessStringGroupColumn(0,1,3);
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].noNulls=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[3]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(0,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].noNulls=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertTrue(batch.cols[3].isNull[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertTrue(batch.cols[3].isNull[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isNull[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  Assert.assertFalse(batch.cols[3].isNull[1]);
  Assert.assertEquals(1,outVector[1]);
  Assert.assertFalse(batch.cols[3].isNull[2]);
  Assert.assertEquals(0,outVector[2]);
  Assert.assertFalse(batch.cols[3].isNull[3]);
  Assert.assertEquals(1,outVector[3]);
  batch=makeStringBatchForColColCompare();
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertTrue(batch.cols[3].isNull[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  outVector=((LongColumnVector)batch.cols[3]).vector;
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertFalse(batch.cols[3].isNull[0]);
  Assert.assertEquals(1,outVector[0]);
  batch=makeStringBatchForColColCompare();
  batch.cols[0].isRepeating=true;
  batch.cols[1].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(4,batch.size);
  Assert.assertFalse(batch.cols[3].noNulls);
  Assert.assertTrue(batch.cols[3].isRepeating);
  Assert.assertTrue(batch.cols[3].isNull[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColLower(){
  VectorizedRowBatch batch=makeStringBatchMixedCase();
  StringLower expr=new StringLower(0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(green,0,green.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  batch=makeStringBatchMixedCase();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.noNulls);
  batch=makeStringBatchMixedCase();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatchMixedCase();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatCharScalar(){
  VectorizedRowBatch batch=makeStringBatch();
  StringGroupColConcatCharScalar expr=new StringGroupColConcatCharScalar(0,new HiveChar(new String(red),6),1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColUpper(){
  VectorizedRowBatch batch=makeStringBatchMixedCase();
  StringUpper expr=new StringUpper(0,1);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(mixedUpUpper,0,mixedUpUpper.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstrStartLen() throws UnsupportedEncodingException {
  VectorizedRowBatch batch=new VectorizedRowBatch(2);
  BytesColumnVector v=new BytesColumnVector();
  batch.cols[0]=v;
  BytesColumnVector outV=new BytesColumnVector();
  batch.cols[1]=outV;
  byte[] data1="abcd string".getBytes("UTF-8");
  byte[] data2="efgh string".getBytes("UTF-8");
  byte[] data3="efgh".getBytes("UTF-8");
  batch.size=3;
  v.noNulls=true;
  v.setRef(0,data1,0,data1.length);
  v.isNull[0]=false;
  v.setRef(1,data2,0,data2.length);
  v.isNull[1]=false;
  v.setRef(2,data3,0,data3.length);
  v.isNull[2]=false;
  outV.isRepeating=true;
  outV.noNulls=false;
  StringSubstrColStartLen expr=new StringSubstrColStartLen(0,6,6,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  byte[] expected="string".getBytes("UTF-8");
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStartLen(0,-6,6,1);
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStartLen(0,1,0,1);
  outCol=(BytesColumnVector)batch.cols[1];
  expr.evaluate(batch);
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(data1,1,0,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(data2,1,0,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(data3,1,0,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStartLen(0,0,11,1);
  outCol=(BytesColumnVector)batch.cols[1];
  expr.evaluate(batch);
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(data1,0,data1.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(data2,0,data2.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(data3,0,data3.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStartLen(0,6,10,1);
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV.isRepeating=true;
  outV.noNulls=true;
  v.noNulls=false;
  v.isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(3,batch.size);
  Assert.assertFalse(outV.noNulls);
  Assert.assertTrue(outV.isNull[0]);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV=new BytesColumnVector();
  v=new BytesColumnVector();
  outV.isRepeating=false;
  outV.noNulls=true;
  v.isRepeating=true;
  v.noNulls=false;
  v.setRef(0,data1,0,data1.length);
  batch=new VectorizedRowBatch(2);
  batch.cols[0]=v;
  batch.cols[1]=outV;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertTrue(outCol.noNulls);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  v=new BytesColumnVector();
  v.isRepeating=false;
  v.noNulls=true;
  batch.size=1;
  v.setRef(0,multiByte,0,10);
  batch.cols[0]=v;
  batch.cols[1]=outV;
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStartLen(0,3,2,1);
  expr.evaluate(batch);
  Assert.assertEquals(1,batch.size);
  Assert.assertFalse(outV.isRepeating);
  Assert.assertTrue(outV.noNulls);
  Assert.assertEquals(0,StringExpr.compare(multiByte,3,10 - 3,outCol.vector[0],outCol.start[0],outCol.length[0]));
  v=new BytesColumnVector();
  v.isRepeating=false;
  v.noNulls=true;
  outV=new BytesColumnVector();
  batch.size=1;
  v.setRef(0,multiByte,3,7);
  batch.cols[0]=v;
  batch.cols[1]=outV;
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStartLen(0,2,2,1);
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertEquals(1,batch.size);
  Assert.assertFalse(outV.isRepeating);
  Assert.assertTrue(outV.noNulls);
  Assert.assertEquals(0,StringExpr.compare(multiByte,6,10 - 6,outCol.vector[0],outCol.start[0],outCol.length[0]));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatVarCharScalar(){
  VectorizedRowBatch batch=makeStringBatch();
  StringGroupColConcatVarCharScalar expr=new StringGroupColConcatVarCharScalar(0,new HiveVarchar(new String(red),14),1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test vectorized regex expression.
 */
@Test public void testRegex() throws HiveException {
  VectorizedRowBatch b=makeStringBatch();
  FilterStringColRegExpStringScalar expr=new FilterStringColRegExpStringScalar(0,"a.*".getBytes());
  b.size=5;
  b.selectedInUse=false;
  BytesColumnVector v=(BytesColumnVector)b.cols[0];
  v.isRepeating=false;
  v.noNulls=false;
  String s1="4kMasVoB7lX1wc5i64bNk";
  String s2="a27V63IL7jK3o";
  String s3="27V63IL7jK3oa";
  String s4="27V63IL7jK3o";
  v.isNull[0]=false;
  v.setRef(0,s1.getBytes(),0,s1.getBytes().length);
  v.isNull[1]=true;
  v.vector[1]=null;
  v.isNull[2]=false;
  v.setRef(2,s2.getBytes(),0,s2.getBytes().length);
  v.isNull[3]=false;
  v.setRef(3,s3.getBytes(),0,s3.getBytes().length);
  v.isNull[4]=false;
  v.setRef(4,s4.getBytes(),0,s4.getBytes().length);
  expr.evaluate(b);
  Assert.assertTrue(b.selectedInUse);
  Assert.assertEquals(3,b.size);
  Assert.assertEquals(0,b.selected[0]);
  Assert.assertEquals(2,b.selected[1]);
  Assert.assertEquals(3,b.selected[2]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatStringScalar(){
  VectorizedRowBatch batch=makeStringBatch();
  StringGroupColConcatStringScalar expr=new StringGroupColConcatStringScalar(0,red,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharScalarConcatCol(){
  VectorizedRowBatch batch=makeStringBatch();
  CharScalarConcatStringGroupCol expr=new CharScalarConcatStringGroupCol(new HiveChar(new String(red),6),0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubstrStart() throws UnsupportedEncodingException {
  VectorizedRowBatch batch=new VectorizedRowBatch(2);
  BytesColumnVector v=new BytesColumnVector();
  batch.cols[0]=v;
  BytesColumnVector outV=new BytesColumnVector();
  batch.cols[1]=outV;
  byte[] data1="abcd string".getBytes("UTF-8");
  byte[] data2="efgh string".getBytes("UTF-8");
  byte[] data3="efgh".getBytes("UTF-8");
  batch.size=3;
  v.noNulls=true;
  v.setRef(0,data1,0,data1.length);
  v.isNull[0]=false;
  v.setRef(1,data2,0,data2.length);
  v.isNull[1]=false;
  v.setRef(2,data3,0,data3.length);
  v.isNull[2]=false;
  StringSubstrColStart expr=new StringSubstrColStart(0,6,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  byte[] expected="string".getBytes("UTF-8");
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outCol.noNulls=false;
  outCol.isRepeating=true;
  expr=new StringSubstrColStart(0,-6,1);
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outCol.noNulls=false;
  outCol.isRepeating=true;
  expr=new StringSubstrColStart(0,1,1);
  expr.evaluate(batch);
  Assert.assertEquals(3,batch.size);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  Assert.assertEquals(0,StringExpr.compare(data1,0,data1.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  Assert.assertEquals(0,StringExpr.compare(data2,0,data2.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(data3,0,data3.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outV.noNulls=false;
  outV.isRepeating=true;
  expr=new StringSubstrColStart(0,6,1);
  v.noNulls=false;
  v.isNull[0]=true;
  expr.evaluate(batch);
  Assert.assertEquals(3,batch.size);
  Assert.assertFalse(outV.noNulls);
  Assert.assertTrue(outV.isNull[0]);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[1],outCol.start[1],outCol.length[1]));
  Assert.assertEquals(0,StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]));
  outCol.noNulls=false;
  outCol.isRepeating=false;
  outV=new BytesColumnVector();
  v=new BytesColumnVector();
  v.isRepeating=true;
  v.noNulls=true;
  v.setRef(0,data1,0,data1.length);
  batch=new VectorizedRowBatch(2);
  batch.cols[0]=v;
  batch.cols[1]=outV;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  expected="string".getBytes("UTF-8");
  Assert.assertTrue(outV.isRepeating);
  Assert.assertTrue(outV.noNulls);
  Assert.assertEquals(0,StringExpr.compare(expected,0,expected.length,outCol.vector[0],outCol.start[0],outCol.length[0]));
  v=new BytesColumnVector();
  v.isRepeating=false;
  v.noNulls=true;
  v.setRef(0,multiByte,0,10);
  batch.cols[0]=v;
  batch.cols[1]=outV;
  outV.isRepeating=true;
  outV.noNulls=false;
  expr=new StringSubstrColStart(0,3,1);
  batch.size=1;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  Assert.assertFalse(outV.isRepeating);
  Assert.assertTrue(outV.noNulls);
  Assert.assertEquals(0,StringExpr.compare(multiByte,3,10 - 3,outCol.vector[0],outCol.start[0],outCol.length[0]));
  v=new BytesColumnVector();
  v.isRepeating=false;
  v.noNulls=true;
  v.setRef(0,multiByte,3,7);
  batch.cols[0]=v;
  batch.cols[1]=outV;
  outV.isRepeating=true;
  outV.noNulls=false;
  outCol=(BytesColumnVector)batch.cols[1];
  expr=new StringSubstrColStart(0,2,1);
  expr.evaluate(batch);
  Assert.assertFalse(outV.isRepeating);
  Assert.assertTrue(outV.noNulls);
  Assert.assertEquals(0,StringExpr.compare(multiByte,6,4,outCol.vector[0],outCol.start[0],outCol.length[0]));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringScalarConcatCol(){
  VectorizedRowBatch batch=makeStringBatch();
  StringScalarConcatStringGroupCol expr=new StringScalarConcatStringGroupCol(red,0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVarCharScalarConcatCol(){
  VectorizedRowBatch batch=makeStringBatch();
  VarCharScalarConcatStringGroupCol expr=new VarCharScalarConcatStringGroupCol(new HiveVarchar(new String(red),14),0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringLength(){
  VectorizedRowBatch batch=makeStringBatchMixedCharSize();
  StringLength expr=new StringLength(0,1);
  expr.evaluate(batch);
  LongColumnVector outCol=(LongColumnVector)batch.cols[1];
  Assert.assertEquals(5,outCol.vector[1]);
  Assert.assertTrue(outCol.isNull[2]);
  Assert.assertEquals(4,outCol.vector[3]);
  batch=makeStringBatchMixedCharSize();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(LongColumnVector)batch.cols[1];
  Assert.assertTrue(outCol.noNulls);
  Assert.assertEquals(4,outCol.vector[3]);
  batch=makeStringBatchMixedCharSize();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(LongColumnVector)batch.cols[1];
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertEquals(7,outCol.vector[0]);
  batch=makeStringBatchMixedCharSize();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(LongColumnVector)batch.cols[1];
  Assert.assertEquals(7,outCol.vector[0]);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatCol(){
  VectorizedRowBatch batch=makeStringBatch2In1Out();
  StringGroupConcatColCol expr=new StringGroupConcatColCol(0,1,2);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[2];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greengreen,0,greengreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch2In1Out();
  batch.cols[0].noNulls=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greengreen,0,greengreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(true,outCol.isNull[0]);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(false,outCol.isRepeating);
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertEquals(true,outCol.isNull[2]);
  batch=makeStringBatch2In1Out();
  batch.cols[1].isRepeating=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(true,outCol.isNull[0]);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  batch.cols[1].isRepeating=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(true,outCol.isNull[0]);
  batch=makeStringBatch2In1Out();
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(false,outCol.isRepeating);
  Assert.assertEquals(false,outCol.isNull[0]);
  Assert.assertEquals(false,outCol.noNulls);
  Assert.assertEquals(true,outCol.isNull[2]);
  cmp=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(false,outCol.isRepeating);
  Assert.assertEquals(true,outCol.noNulls);
  cmp=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(false,outCol.isRepeating);
  Assert.assertEquals(false,outCol.isNull[0]);
  Assert.assertEquals(false,outCol.noNulls);
  Assert.assertEquals(true,outCol.isNull[2]);
  cmp=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(false,outCol.isNull[0]);
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorTypeCasts </h4><pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCastDecimalToDouble(){
  final double eps=0.000001d;
  VectorizedRowBatch b=getBatchDecimalDouble();
  VectorExpression expr=new CastDecimalToDouble(0,1);
  expr.evaluate(b);
  DoubleColumnVector r=(DoubleColumnVector)b.cols[1];
  assertEquals(1.1d,r.vector[0],eps);
  assertEquals(-2.2d,r.vector[1],eps);
  assertEquals(9999999999999999.0d,r.vector[2],eps);
  b=getBatchDecimalDouble();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[1]=true;
  expr.evaluate(b);
  r=(DoubleColumnVector)b.cols[1];
  assertFalse(r.noNulls);
  assertTrue(r.isNull[1]);
  assertFalse(r.isNull[0]);
  assertEquals(1.1d,r.vector[0],eps);
  b=getBatchDecimalDouble();
  b.cols[0].isRepeating=true;
  expr.evaluate(b);
  r=(DoubleColumnVector)b.cols[1];
  assertTrue(r.isRepeating);
  assertEquals(1.1d,r.vector[0],eps);
  b=getBatchDecimalDouble();
  b.cols[0].isRepeating=true;
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  expr.evaluate(b);
  r=(DoubleColumnVector)b.cols[1];
  assertTrue(r.isRepeating);
  assertTrue(r.isNull[0]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCastDecimalToLong(){
  VectorizedRowBatch b=getBatchDecimalLong();
  VectorExpression expr=new CastDecimalToLong(0,1);
  expr.evaluate(b);
  LongColumnVector r=(LongColumnVector)b.cols[1];
  assertEquals(1,r.vector[0]);
  assertEquals(-2,r.vector[1]);
  assertEquals(9999999999999999L,r.vector[2]);
  b=getBatchDecimalLong();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[1]=true;
  expr.evaluate(b);
  r=(LongColumnVector)b.cols[1];
  assertFalse(r.noNulls);
  assertTrue(r.isNull[1]);
  assertFalse(r.isNull[0]);
  assertEquals(1,r.vector[0]);
  b=getBatchDecimalLong();
  b.cols[0].isRepeating=true;
  expr.evaluate(b);
  r=(LongColumnVector)b.cols[1];
  assertTrue(r.isRepeating);
  assertEquals(1,r.vector[0]);
  b=getBatchDecimalLong();
  b.cols[0].isRepeating=true;
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  expr.evaluate(b);
  r=(LongColumnVector)b.cols[1];
  assertTrue(r.isRepeating);
  assertTrue(r.isNull[0]);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCastDecimalToString(){
  VectorizedRowBatch b=getBatchDecimalString();
  VectorExpression expr=new CastDecimalToString(0,1);
  expr.evaluate(b);
  BytesColumnVector r=(BytesColumnVector)b.cols[1];
  byte[] v=toBytes("1.1");
  assertTrue(((Integer)v.length).toString() + " " + r.length[0],v.length == r.length[0]);
  Assert.assertEquals(0,StringExpr.compare(v,0,v.length,r.vector[0],r.start[0],r.length[0]));
  v=toBytes("-2.2");
  Assert.assertEquals(0,StringExpr.compare(v,0,v.length,r.vector[1],r.start[1],r.length[1]));
  v=toBytes("9999999999999999");
  Assert.assertEquals(0,StringExpr.compare(v,0,v.length,r.vector[2],r.start[2],r.length[2]));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.udf.TestVectorUDFAdaptor </h4><pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUDF(){
  ExprNodeGenericFuncDesc funcDesc;
  GenericUDF genericUDF=new GenericUDFIsNull();
  TypeInfo typeInfoStr=TypeInfoFactory.stringTypeInfo;
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  children.add(new ExprNodeColumnDesc(typeInfoStr,"col0","tablename",false));
  children.add(new ExprNodeConstantDesc(typeInfoStr,"UNKNOWN"));
  VectorUDFArgDesc[] argDescs=new VectorUDFArgDesc[2];
  for (int i=0; i < 2; i++) {
    argDescs[i]=new VectorUDFArgDesc();
  }
  argDescs[0].setVariable(0);
  argDescs[1].setConstant((ExprNodeConstantDesc)children.get(1));
  funcDesc=new ExprNodeGenericFuncDesc(typeInfoStr,genericUDF,"myisnull",children);
  VectorUDFAdaptor vudf=null;
  try {
    vudf=new VectorUDFAdaptor(funcDesc,3,"String",argDescs);
  }
 catch (  HiveException e) {
    assertTrue(false);
  }
  VectorizedRowBatch b;
  byte[] red=null;
  byte[] unknown=null;
  try {
    red="red".getBytes("UTF-8");
    unknown="UNKNOWN".getBytes("UTF-8");
  }
 catch (  Exception e) {
    ;
  }
  BytesColumnVector out;
  b=getBatchStrDblLongWithStrOut();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  vudf.evaluate(b);
  out=(BytesColumnVector)b.cols[3];
  int cmp=StringExpr.compare(red,0,red.length,out.vector[1],out.start[1],out.length[1]);
  assertEquals(0,cmp);
  cmp=StringExpr.compare(unknown,0,unknown.length,out.vector[0],out.start[0],out.length[0]);
  assertEquals(0,cmp);
  assertTrue(out.noNulls || !out.isNull[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiArgumentUDF(){
  ExprNodeGenericFuncDesc funcDesc;
  TypeInfo typeInfoStr=TypeInfoFactory.stringTypeInfo;
  TypeInfo typeInfoLong=TypeInfoFactory.longTypeInfo;
  TypeInfo typeInfoDbl=TypeInfoFactory.doubleTypeInfo;
  GenericUDFBridge genericUDFBridge=new GenericUDFBridge("testudf",false,ConcatTextLongDoubleUDF.class.getName());
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  children.add(new ExprNodeColumnDesc(typeInfoStr,"col0","tablename",false));
  children.add(new ExprNodeColumnDesc(typeInfoLong,"col1","tablename",false));
  children.add(new ExprNodeColumnDesc(typeInfoDbl,"col2","tablename",false));
  VectorUDFArgDesc[] argDescs=new VectorUDFArgDesc[3];
  for (int i=0; i < 3; i++) {
    argDescs[i]=new VectorUDFArgDesc();
    argDescs[i].setVariable(i);
  }
  funcDesc=new ExprNodeGenericFuncDesc(typeInfoStr,genericUDFBridge,genericUDFBridge.getUdfName(),children);
  VectorUDFAdaptor vudf=null;
  try {
    vudf=new VectorUDFAdaptor(funcDesc,3,"String",argDescs);
  }
 catch (  HiveException e) {
    assertTrue(false);
    throw new RuntimeException(e);
  }
  VectorizedRowBatch b=getBatchStrDblLongWithStrOut();
  vudf.evaluate(b);
  byte[] result=null;
  byte[] result2=null;
  try {
    result="red:1:1.0".getBytes("UTF-8");
    result2="blue:0:0.0".getBytes("UTF-8");
  }
 catch (  Exception e) {
    ;
  }
  BytesColumnVector out=(BytesColumnVector)b.cols[3];
  int cmp=StringExpr.compare(result,0,result.length,out.vector[1],out.start[1],out.length[1]);
  assertEquals(0,cmp);
  assertTrue(out.noNulls);
  b=getBatchStrDblLongWithStrOut();
  b.cols[1].noNulls=false;
  vudf.evaluate(b);
  out=(BytesColumnVector)b.cols[3];
  assertFalse(out.noNulls);
  assertTrue(out.isNull[1]);
  b=getBatchStrDblLongWithStrOut();
  b.cols[0].isRepeating=true;
  b.cols[1].isRepeating=true;
  b.cols[2].isRepeating=true;
  vudf.evaluate(b);
  out=(BytesColumnVector)b.cols[3];
  assertTrue(out.isRepeating);
  cmp=StringExpr.compare(result2,0,result2.length,out.vector[0],out.start[0],out.length[0]);
  assertEquals(0,cmp);
  assertTrue(out.noNulls);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongUDF(){
  ExprNodeGenericFuncDesc funcDesc;
  TypeInfo typeInfo=TypeInfoFactory.longTypeInfo;
  GenericUDFBridge genericUDFBridge=new GenericUDFBridge("longudf",false,LongUDF.class.getName());
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  ExprNodeColumnDesc colDesc=new ExprNodeColumnDesc(typeInfo,"col0","tablename",false);
  children.add(colDesc);
  VectorUDFArgDesc[] argDescs=new VectorUDFArgDesc[1];
  argDescs[0]=new VectorUDFArgDesc();
  argDescs[0].setVariable(0);
  funcDesc=new ExprNodeGenericFuncDesc(typeInfo,genericUDFBridge,genericUDFBridge.getUdfName(),children);
  VectorUDFAdaptor vudf=null;
  try {
    vudf=new VectorUDFAdaptor(funcDesc,1,"Long",argDescs);
  }
 catch (  HiveException e) {
    assertTrue(false);
  }
  VectorizedRowBatch b=getBatchLongInLongOut();
  vudf.evaluate(b);
  LongColumnVector out=(LongColumnVector)b.cols[1];
  assertEquals(1000,out.vector[0]);
  assertEquals(1001,out.vector[1]);
  assertEquals(1002,out.vector[2]);
  assertTrue(out.noNulls);
  assertFalse(out.isRepeating);
  b=getBatchLongInLongOut();
  out=(LongColumnVector)b.cols[1];
  b.cols[0].noNulls=false;
  vudf.evaluate(b);
  assertFalse(out.noNulls);
  assertEquals(1000,out.vector[0]);
  assertEquals(1001,out.vector[1]);
  assertTrue(out.isNull[2]);
  assertFalse(out.isRepeating);
  b=getBatchLongInLongOut();
  out=(LongColumnVector)b.cols[1];
  b.cols[0].isRepeating=true;
  vudf.evaluate(b);
  assertTrue(b.cols[1].isRepeating && out.vector[0] == 1000 || !b.cols[1].isRepeating && out.vector[2] == 1000);
  assertEquals(3,b.size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestIOContextMap </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezLlapAttemptMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000, ATTEMPT_COUNT=3;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT * ATTEMPT_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        final Configuration conf=new Configuration(), conf2=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          String input1="Input " + nextIx;
          conf.set(Utilities.INPUT_NAME,input1);
          for (int j=0; j < ATTEMPT_COUNT; ++j) {
            String attemptId="Attempt " + nextIx + ":"+ j;
            IOContextMap.setThreadAttemptId(attemptId);
            final IOContext r1=results[(nextIx * ATTEMPT_COUNT) + j]=IOContextMap.get(conf);
            if ((nextIx % (ITER_COUNT / 10)) == 0) {
              String input2="Input2 " + nextIx;
              conf2.set(Utilities.INPUT_NAME,input2);
              final AtomicReference<IOContext> ref2=new AtomicReference<>();
              Thread t=new Thread(new Runnable(){
                public void run(){
                  assertSame(r1,IOContextMap.get(conf));
                  ref2.set(IOContextMap.get(conf2));
                }
              }
);
              t.start();
              t.join();
              assertSame(ref2.get(),IOContextMap.get(conf2));
            }
          }
          if (nextIx == 0)           break;
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Configuration conf=new Configuration();
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < ITER_COUNT; ++i) {
    conf.set(Utilities.INPUT_NAME,"Input " + i);
    for (int j=0; j < ATTEMPT_COUNT; ++j) {
      String attemptId="Attempt " + i + ":"+ j;
      IOContext result=results[(i * ATTEMPT_COUNT) + j];
      assertTrue(resultSet.add(result));
      IOContextMap.setThreadAttemptId(attemptId);
      assertSame(result,IOContextMap.get(conf));
      IOContextMap.clearThreadAttempt(attemptId);
      IOContextMap.setThreadAttemptId(attemptId);
      assertNotSame(result,IOContextMap.get(conf));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMRTezGlobalMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final CountDownLatch phase1End=new CountDownLatch(THREAD_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        Configuration conf=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          conf.set(Utilities.INPUT_NAME,"Input " + nextIx);
          results[nextIx]=IOContextMap.get(conf);
          if (nextIx == 0)           break;
        }
        phase1End.countDown();
        phase1End.await();
        for (int i=0; i < ITER_COUNT; ++i) {
          conf.set(Utilities.INPUT_NAME,"Input " + i);
          IOContext ctx=IOContextMap.get(conf);
          assertSame(results[i],ctx);
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < results.length; ++i) {
    assertTrue(resultSet.add(results[i]));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparkThreadLocal() throws Exception {
  final Configuration conf1=new Configuration();
  conf1.set(HiveConf.ConfVars.HIVE_EXECUTION_ENGINE.varname,"spark");
  final Configuration conf2=new Configuration(conf1);
  conf2.set(Utilities.INPUT_NAME,"Other input");
  final int THREAD_COUNT=2;
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<IOContext>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<IOContext>(new Callable<IOContext>(){
      public IOContext call() throws Exception {
        syncThreadStart(cdlIn,cdlOut);
        IOContext c1=IOContextMap.get(conf1), c2=IOContextMap.get(conf2);
        assertSame(c1,c2);
        return c1;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  Set<IOContext> results=Sets.newIdentityHashSet();
  for (int i=0; i < tasks.length; ++i) {
    assertTrue(results.add(tasks[i].get()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestRCFile </h4><pre class="type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseForErroneousRCFile() throws IOException {
  Configuration conf=new Configuration();
  LocalFileSystem fs=FileSystem.getLocal(conf);
  Path path=new Path(System.getProperty("test.tmp.dir",".") + "/broken.rcfile");
  fs.create(path).close();
  final TestFSDataInputStream[] openedFile=new TestFSDataInputStream[1];
  try {
    new RCFile.Reader(fs,path,conf){
      @Override protected FSDataInputStream openFile(      FileSystem fs,      Path file,      int bufferSize,      long length) throws IOException {
        final InputStream in=super.openFile(fs,file,bufferSize,length);
        openedFile[0]=new TestFSDataInputStream(in);
        return openedFile[0];
      }
    }
;
    fail("IOException expected.");
  }
 catch (  IOException expected) {
  }
  assertNotNull(path + " should have been opened.",openedFile[0]);
  assertTrue("InputStream for " + path + " should have been closed.",openedFile[0].isClosed());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link RCFile.Reader#getColumn(int,BytesRefArrayWritable) } method.
 * @throws IOException
 */
@Test public void testGetColumn() throws IOException {
  cleanup();
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  LongWritable rowID=new LongWritable();
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),0L);
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),1L);
  BytesRefArrayWritable result=null;
  BytesRefWritable brw;
  for (int col=0; col < 8; col++) {
    BytesRefArrayWritable result2=reader.getColumn(col,result);
    if (result == null) {
      assertNotNull(result2);
      result=result2;
    }
 else {
      assertSame(result2,result);
    }
    assertEquals(2,result.size());
    for (int row=0; row < result.size(); row++) {
      brw=result.get(row);
      int start=brw.getStart();
      int len=brw.getLength();
      byte[] actualData=Arrays.copyOfRange(brw.getData(),start,start + len);
      byte[] expectedData=(row == 0) ? record_1[col] : record_2[col];
      assertArrayEquals("col=" + col + " : row="+ row,expectedData,actualData);
    }
    result.clear();
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadOldFileHeader() throws IOException {
  String[] row=new String[]{"Tester","Bart","333 X St.","Reno","NV","USA"};
  RCFile.Reader reader=new RCFile.Reader(fs,new Path("src/test/data/rc-file-v0.rc"),conf);
  LongWritable rowID=new LongWritable();
  BytesRefArrayWritable cols=new BytesRefArrayWritable();
  assertTrue("old file reader first row",reader.next(rowID));
  reader.getCurrentRow(cols);
  assertEquals(row.length,cols.size());
  for (int i=0; i < cols.size(); ++i) {
    assertEquals(row[i],new String(cols.get(i).getBytesCopy()));
  }
  assertFalse("old file reader end",reader.next(rowID));
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyFile() throws Exception {
  Properties properties=new Properties();
  properties.setProperty("columns","x,y");
  properties.setProperty("columns.types","int:int");
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.close(true);
  SerDe serde=new OrcSerde();
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertTrue(0 == splits.length);
  assertEquals(null,serde.getSerDeStats());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=RuntimeException.class) public void testSplitGenFailure() throws IOException {
  Properties properties=new Properties();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.close(true);
  InputFormat<?,?> in=new OrcInputFormat();
  fs.setPermission(testFilePath,FsPermission.createImmutable((short)0333));
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  try {
    in.getSplits(conf,1);
  }
 catch (  RuntimeException e) {
    assertEquals(true,e.getMessage().contains("Permission denied"));
    throw e;
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombinationInputFormat() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"combination",inspector,false,1);
  Path partDir=new Path(conf.get("mapred.input.dir"));
  Writer writer=OrcFile.createWriter(new Path(partDir,"0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  MockOutputStream outputStream=(MockOutputStream)((WriterImpl)writer).getStream();
  outputStream.setBlocks(new MockBlock("host0","host1"));
  int length0=outputStream.file.length;
  writer=OrcFile.createWriter(new Path(partDir,"1_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=10; i < 20; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  outputStream=(MockOutputStream)((WriterImpl)writer).getStream();
  outputStream.setBlocks(new MockBlock("host1","host2"));
  HiveInputFormat<?,?> inputFormat=new CombineHiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,1);
  assertEquals(1,splits.length);
  CombineHiveInputFormat.CombineHiveInputSplit split=(CombineHiveInputFormat.CombineHiveInputSplit)splits[0];
  assertEquals(2,split.getNumPaths());
  assertEquals(partDir.toString() + "/0_0",split.getPath(0).toString());
  assertEquals(partDir.toString() + "/1_0",split.getPath(1).toString());
  assertEquals(length0,split.getLength(0));
  assertEquals(outputStream.file.length,split.getLength(1));
  assertEquals(0,split.getOffset(0));
  assertEquals(0,split.getOffset(1));
  assertTrue(3 >= split.getLocations().length);
  org.apache.hadoop.mapred.RecordReader<CombineHiveKey,OrcStruct> reader=inputFormat.getRecordReader(split,conf,Reporter.NULL);
  CombineHiveKey key=reader.createKey();
  OrcStruct value=reader.createValue();
  for (int i=0; i < 20; i++) {
    assertEquals(true,reader.next(key,value));
    assertEquals(i,((IntWritable)value.getFieldValue(0)).get());
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-14 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEtlCombinedStrategy() throws Exception {
  conf.set(HiveConf.ConfVars.HIVE_ORC_SPLIT_STRATEGY.varname,"ETL");
  conf.set(HiveConf.ConfVars.HIVE_ORC_SPLIT_DIRECTORY_BATCH_MS.varname,"1000000");
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/1/part-00",1000,new byte[0]),new MockFile("mock:/a/1/part-01",1000,new byte[0]),new MockFile("mock:/a/2/part-00",1000,new byte[0]),new MockFile("mock:/a/2/part-01",1000,new byte[0]),new MockFile("mock:/a/3/base_0/1",1000,new byte[0]),new MockFile("mock:/a/4/base_0/1",1000,new byte[0]),new MockFile("mock:/a/5/base_0/1",1000,new byte[0]),new MockFile("mock:/a/5/delta_0_25/1",1000,new byte[0]));
  OrcInputFormat.CombinedCtx combineCtx=new OrcInputFormat.CombinedCtx();
  SplitStrategy<?> ss=createOrCombineStrategy(context,fs,"mock:/a/1",combineCtx);
  assertNull(ss);
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  OrcInputFormat.ETLSplitStrategy etlSs=(OrcInputFormat.ETLSplitStrategy)combineCtx.combined;
  assertEquals(2,etlSs.files.size());
  assertTrue(etlSs.isOriginal);
  assertEquals(1,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/2",combineCtx);
  assertNull(ss);
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  assertEquals(4,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/3",combineCtx);
  assertSame(etlSs,ss);
  assertEquals(4,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  etlSs=(OrcInputFormat.ETLSplitStrategy)combineCtx.combined;
  assertEquals(1,etlSs.files.size());
  assertFalse(etlSs.isOriginal);
  assertEquals(1,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/1",combineCtx);
  assertTrue(ss instanceof OrcInputFormat.ETLSplitStrategy);
  assertNotSame(etlSs,ss);
  OrcInputFormat.ETLSplitStrategy rejectedEtlSs=(OrcInputFormat.ETLSplitStrategy)ss;
  assertEquals(2,rejectedEtlSs.files.size());
  assertEquals(1,rejectedEtlSs.dirs.size());
  assertTrue(rejectedEtlSs.isOriginal);
  assertEquals(1,etlSs.files.size());
  assertEquals(1,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/4",combineCtx);
  assertNull(ss);
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  assertEquals(2,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/5",combineCtx);
  assertTrue(ss instanceof OrcInputFormat.ETLSplitStrategy);
  assertNotSame(etlSs,ss);
  assertEquals(2,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestNewInputOutputFormat </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInputFormat() throws Exception {
  Job job=new Job(conf,"orc test");
  job.setInputFormatClass(OrcNewInputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper1.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  FileInputFormat.addInputPath(job,new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc")));
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  localFs.delete(outputPath,true);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  assertTrue(localFs.exists(outputFilePath));
  BufferedReader reader=new BufferedReader(new InputStreamReader(localFs.open(outputFilePath)));
  int count=0;
  String line;
  String lastLine=null;
  while ((line=reader.readLine()) != null) {
    count++;
    lastLine=line;
  }
  reader.close();
  assertEquals(count,7500);
  assertEquals(lastLine,"{true, 100, 2048, 65536," + " 9223372036854775807, 2.0, -5.0" + ", , bye, {[{1, bye}, {2, sigh}]}, [{100000000, cat},"+ " {-100000, in}, {1234, hat}],"+ " {chani={5, chani}, mauddib={1, mauddib}},"+ " 2000-03-12 15:00:01, 12345678.6547457}");
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewOutputFormat() throws Exception {
  int rownum=1000;
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  Random r=new Random(1000L);
  boolean firstRow=true;
  int firstIntValue=0;
  String firstStringValue=null;
  for (int i=0; i < rownum; i++) {
    int intValue=r.nextInt();
    String stringValue=UUID.randomUUID().toString();
    if (firstRow) {
      firstRow=false;
      firstIntValue=intValue;
      firstStringValue=stringValue;
    }
    pw.println(intValue + "," + stringValue);
  }
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper2.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(Writable.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  assertTrue(localFs.exists(outputFilePath));
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  assertTrue(reader.getNumberOfRows() == rownum);
  assertEquals(reader.getCompression(),CompressionKind.ZLIB);
  StructObjectInspector soi=(StructObjectInspector)reader.getObjectInspector();
  StructTypeInfo ti=(StructTypeInfo)TypeInfoUtils.getTypeInfoFromObjectInspector(soi);
  assertEquals(((PrimitiveTypeInfo)ti.getAllStructFieldTypeInfos().get(0)).getPrimitiveCategory(),PrimitiveObjectInspector.PrimitiveCategory.INT);
  assertEquals(((PrimitiveTypeInfo)ti.getAllStructFieldTypeInfos().get(1)).getPrimitiveCategory(),PrimitiveObjectInspector.PrimitiveCategory.STRING);
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  IntWritable intWritable=(IntWritable)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(0));
  Text text=(Text)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(1));
  assertEquals(intWritable.get(),firstIntValue);
  assertEquals(text.toString(),firstStringValue);
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInputFormatPruning() throws Exception {
  conf.set("hive.io.file.read.all.columns","false");
  conf.set("hive.io.file.readcolumn.ids","1,3");
  Job job=new Job(conf,"orc test");
  job.setInputFormatClass(OrcNewInputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper1.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  FileInputFormat.addInputPath(job,new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc")));
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  localFs.delete(outputPath,true);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  BufferedReader reader=new BufferedReader(new InputStreamReader(localFs.open(outputFilePath)));
  String line=reader.readLine();
  assertEquals(line,"{null, 1, null, 65536, null, null, null, " + "null, null, null, null, null, null, null}");
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewOutputFormatWithCompression() throws Exception {
  conf.set("hive.exec.orc.default.compress","SNAPPY");
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  pw.println("1,hello");
  pw.println("2,world");
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper2.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(OrcSerdeRow.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  assertEquals(reader.getCompression(),CompressionKind.SNAPPY);
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testNewOutputFormatComplex() throws Exception {
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  pw.println("I have eaten");
  pw.println("the plums");
  pw.println("that were in");
  pw.println("the icebox");
  pw.println("and which");
  pw.println("you were probably");
  pw.println("saving");
  pw.println("for breakfast");
  pw.println("Forgive me");
  pw.println("they were delicious");
  pw.println("so sweet");
  pw.println("and so cold");
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper3.class);
  job.setReducerClass(OrcTestReducer3.class);
  job.setMapOutputKeyClass(IntWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(OrcSerdeRow.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-r-00000");
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  RecordReader rows=reader.rows();
  ObjectInspector orcOi=reader.getObjectInspector();
  ObjectInspector stoi=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(OrcTestReducer3.typeInfo);
  ObjectInspectorConverters.Converter converter=ObjectInspectorConverters.getConverter(orcOi,stoi);
  Object row=rows.next(null);
  List converted=(List)converter.convert(row);
  assertEquals(1,converted.get(0));
  assertEquals(1,converted.get(1));
  List list=(List)converted.get(2);
  assertEquals(list.size(),1);
  assertEquals("saving",((List)list.get(0)).get(0));
  assertEquals(6,((List)list.get(0)).get(1));
  Map<String,Integer> map=(Map<String,Integer>)converted.get(3);
  assertEquals(map.size(),1);
  assertEquals(map.get("saving"),new Integer(1));
  row=rows.next(null);
  converted=(List)converter.convert(row);
  assertEquals(2,converted.get(0));
  assertEquals(6,converted.get(1));
  list=(List)converted.get(2);
  assertEquals(list.size(),6);
  assertEquals("breakfast",((List)list.get(0)).get(0));
  assertEquals(9,((List)list.get(0)).get(1));
  map=(Map<String,Integer>)converted.get(3);
  assertEquals(map.size(),11);
  assertEquals(map.get("the"),new Integer(2));
  row=rows.next(null);
  converted=(List)converter.convert(row);
  assertEquals(3,converted.get(0));
  assertEquals(5,converted.get(1));
  list=(List)converted.get(2);
  assertEquals(list.size(),5);
  assertEquals("cold",((List)list.get(0)).get(0));
  assertEquals(4,((List)list.get(0)).get(1));
  map=(Map<String,Integer>)converted.get(3);
  assertEquals(map.size(),13);
  assertEquals(map.get("were"),new Integer(3));
  assertFalse(rows.hasNext());
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcFile </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringAndBinaryStatistics() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(SimpleStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4),"foo"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3),"bar"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4,5),null));
  writer.addRow(new SimpleStruct(null,"hi"));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(2,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,true};
  boolean[] included=OrcUtils.includeColumns("string1",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns(null,schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4,stats[0].getNumberOfValues());
  assertEquals("count: 4 hasNull: false",stats[0].toString());
  assertEquals(3,stats[1].getNumberOfValues());
  assertEquals(15,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals("count: 3 hasNull: true sum: 15",stats[1].toString());
  assertEquals(3,stats[2].getNumberOfValues());
  assertEquals("bar",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals(8,((StringColumnStatistics)stats[2]).getSum());
  assertEquals("count: 3 hasNull: true min: bar max: hi sum: 8",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<bytes1:binary,string1:string>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("foo",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("bar",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3,4,5),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertNull(st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertNull(bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV12() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).batchSize(100).version(OrcFile.Version.V_0_12));
  assertEquals(testFilePath,memory.path);
  for (int i=0; i < 2500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(3,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPredicatePushdown() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(fs,testFilePath,conf,inspector,400000L,CompressionKind.NONE,500,1000);
  for (int i=0; i < 3500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(3500,reader.getNumberOfRows());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().startNot().lessThan("int1",PredicateLeaf.Type.LONG,300000L).end().lessThan("int1",PredicateLeaf.Type.LONG,600000L).end().build();
  RecordReader rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(1000L,rows.getRowNumber());
  OrcStruct row=null;
  for (int i=1000; i < 2000; ++i) {
    assertTrue(rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
  sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("int1",PredicateLeaf.Type.LONG,0L).end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(3500L,rows.getRowNumber());
  assertTrue(!rows.hasNext());
  sarg=SearchArgumentFactory.newBuilder().startOr().lessThan("int1",PredicateLeaf.Type.LONG,300L * 100).startNot().lessThan("int1",PredicateLeaf.Type.LONG,300L * 3400).end().end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  row=null;
  for (int i=0; i < 1000; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  for (int i=3000; i < 3500; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void metaData() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100));
  writer.addUserMetadata("my.meta",byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128));
  writer.addUserMetadata("clobber",byteBuf(1,2,3));
  writer.addUserMetadata("clobber",byteBuf(4,3,2,1));
  ByteBuffer bigBuf=ByteBuffer.allocate(40000);
  Random random=new Random(0);
  random.nextBytes(bigBuf.array());
  writer.addUserMetadata("big",bigBuf);
  bigBuf.position(0);
  writer.addRow(new BigRow(true,(byte)127,(short)1024,42,42L * 1024 * 1024* 1024,(float)3.1415,-2.713,null,null,null,null,null));
  writer.addUserMetadata("clobber",byteBuf(5,7,11,13,17,19));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(byteBuf(5,7,11,13,17,19),reader.getMetadataValue("clobber"));
  assertEquals(byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128),reader.getMetadataValue("my.meta"));
  assertEquals(bigBuf,reader.getMetadataValue("big"));
  try {
    reader.getMetadataValue("unknown");
    assertTrue(false);
  }
 catch (  IllegalArgumentException iae) {
  }
  int i=0;
  for (  String key : reader.getMetadataKeys()) {
    if ("my.meta".equals(key) || "clobber".equals(key) || "big".equals(key)) {
      i+=1;
    }
 else {
      throw new IllegalArgumentException("unknown key " + key);
    }
  }
  assertEquals(3,i);
  int numStripes=reader.getStripeStatistics().size();
  assertEquals(1,numStripes);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new BigRow(false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map()));
  writer.addRow(new BigRow(true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib"))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(23,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,byte1,short1,int1,long1,float1,double1,bytes1,string1,middle,list,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  StripeStatistics ss=reader.getStripeStatistics().get(0);
  assertEquals(2,ss.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)ss.getColumnStatistics()[1]).getTrueCount());
  assertEquals(1024,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMinimum());
  assertEquals(2048,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMaximum());
  assertEquals(3072,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getSum());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFormat_0_11() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>,ts:timestamp,"+ "decimal1:decimal(38,18)>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  HiveDecimalObjectInspector dco=(HiveDecimalObjectInspector)readerInspector.getStructFieldRef("decimal1").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547456"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547457"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV11() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).batchSize(100).version(OrcFile.Version.V_0_11));
  assertEquals(testFilePath,memory.path);
  for (int i=0; i < 2500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(25,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcNullOptimization </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnsWithNullAndCompression() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcNullOptimization.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new MyStruct(3,"a",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(null,"b",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(3,null,false,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(3,"d",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"e",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"f",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"g",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"h",true,Lists.newArrayList(new InnerStruct(100))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(8,reader.getNumberOfRows());
  assertEquals(8,stats[0].getNumberOfValues());
  assertEquals(3,((IntegerColumnStatistics)stats[1]).getMaximum());
  assertEquals(2,((IntegerColumnStatistics)stats[1]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[1]).isSumDefined());
  assertEquals(17,((IntegerColumnStatistics)stats[1]).getSum());
  assertEquals("count: 7 hasNull: true min: 2 max: 3 sum: 17",stats[1].toString());
  assertEquals("h",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals(7,stats[2].getNumberOfValues());
  assertEquals("count: 7 hasNull: true min: a max: h sum: 7",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<a:int,b:string,c:boolean,list:array<struct<z:int>>>",readerInspector.getTypeName());
  RecordReader rows=reader.rows();
  List<Boolean> expected=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    expected.add(false);
  }
  expected.set(expected.size() - 1,true);
  List<Boolean> got=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    OrcProto.StripeFooter sf=((RecordReaderImpl)rows).readStripeFooter(sinfo);
    got.add(sf.toString().indexOf(OrcProto.Stream.Kind.PRESENT.toString()) != -1);
  }
  assertEquals(expected,got);
  OrcStruct row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertEquals(new IntWritable(3),row.getFieldValue(0));
  assertEquals("a",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNull(row.getFieldValue(0));
  assertEquals("b",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNull(row.getFieldValue(1));
  assertEquals(new IntWritable(3),row.getFieldValue(0));
  assertEquals(new BooleanWritable(false),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiStripeWithoutNull() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcNullOptimization.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(100);
  for (int i=1; i < 20000; i++) {
    writer.addRow(new MyStruct(rand.nextInt(1),"a",true,Lists.newArrayList(new InnerStruct(100))));
  }
  writer.addRow(new MyStruct(0,"b",true,Lists.newArrayList(new InnerStruct(100))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(20000,reader.getNumberOfRows());
  assertEquals(20000,stats[0].getNumberOfValues());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMaximum());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[1]).isSumDefined());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getSum());
  assertEquals("count: 20000 hasNull: false min: 0 max: 0 sum: 0",stats[1].toString());
  assertEquals("b",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals(20000,stats[2].getNumberOfValues());
  assertEquals("count: 20000 hasNull: false min: a max: b sum: 20000",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<a:int,b:string,c:boolean,list:array<struct<z:int>>>",readerInspector.getTypeName());
  RecordReader rows=reader.rows();
  List<Boolean> expected=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    expected.add(false);
  }
  List<Boolean> got=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    OrcProto.StripeFooter sf=((RecordReaderImpl)rows).readStripeFooter(sinfo);
    got.add(sf.toString().indexOf(OrcProto.Stream.Kind.PRESENT.toString()) != -1);
  }
  assertEquals(expected,got);
  rows.seekToRow(19998);
  OrcStruct row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertNotNull(row.getFieldValue(1));
  assertEquals(new IntWritable(0),row.getFieldValue(0));
  assertEquals("a",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNotNull(row.getFieldValue(0));
  assertNotNull(row.getFieldValue(1));
  assertEquals("b",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiStripeWithNull() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcNullOptimization.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(100);
  writer.addRow(new MyStruct(null,null,true,Lists.newArrayList(new InnerStruct(100))));
  for (int i=2; i < 20000; i++) {
    writer.addRow(new MyStruct(rand.nextInt(1),"a",true,Lists.newArrayList(new InnerStruct(100))));
  }
  writer.addRow(new MyStruct(null,null,true,Lists.newArrayList(new InnerStruct(100))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(20000,reader.getNumberOfRows());
  assertEquals(20000,stats[0].getNumberOfValues());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMaximum());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[1]).isSumDefined());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getSum());
  assertEquals("count: 19998 hasNull: true min: 0 max: 0 sum: 0",stats[1].toString());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals(19998,stats[2].getNumberOfValues());
  assertEquals("count: 19998 hasNull: true min: a max: a sum: 19998",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<a:int,b:string,c:boolean,list:array<struct<z:int>>>",readerInspector.getTypeName());
  RecordReader rows=reader.rows();
  List<Boolean> expected=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    expected.add(false);
  }
  expected.set(0,true);
  expected.set(expected.size() - 1,true);
  List<Boolean> got=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    OrcProto.StripeFooter sf=((RecordReaderImpl)rows).readStripeFooter(sinfo);
    got.add(sf.toString().indexOf(OrcProto.Stream.Kind.PRESENT.toString()) != -1);
  }
  assertEquals(expected,got);
  OrcStruct row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertNull(row.getFieldValue(0));
  assertNull(row.getFieldValue(1));
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.seekToRow(19998);
  row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertNotNull(row.getFieldValue(1));
  assertEquals(new IntWritable(0),row.getFieldValue(0));
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNull(row.getFieldValue(0));
  assertNull(row.getFieldValue(1));
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcRawRecordMerger </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrdering() throws Exception {
  ReaderKey left=new ReaderKey(100,200,1200,300);
  ReaderKey right=new ReaderKey();
  right.setValues(100,200,1000,200,1);
  assertTrue(right.compareTo(left) < 0);
  assertTrue(left.compareTo(right) > 0);
  assertEquals(false,left.equals(right));
  left.set(right);
  assertTrue(right.compareTo(left) == 0);
  assertEquals(true,right.equals(left));
  right.setRowId(2000);
  assertTrue(right.compareTo(left) > 0);
  left.setValues(1,2,3,4,-1);
  right.setValues(100,2,3,4,-1);
  assertTrue(left.compareTo(right) < 0);
  assertTrue(right.compareTo(left) > 0);
  left.setValues(1,2,3,4,-1);
  right.setValues(1,100,3,4,-1);
  assertTrue(left.compareTo(right) < 0);
  assertTrue(right.compareTo(left) > 0);
  left.setValues(1,2,3,100,-1);
  right.setValues(1,2,3,4,-1);
  assertTrue(left.compareTo(right) < 0);
  assertTrue(right.compareTo(left) > 0);
  RecordIdentifier ri=new RecordIdentifier(1,2,3);
  assertEquals(1,ri.compareTo(left));
  assertEquals(-1,left.compareTo(ri));
  assertEquals(false,ri.equals(left));
  assertEquals(false,left.equals(ri));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcRecordUpdater </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdates() throws Exception {
  Path root=new Path(workDir,"testUpdates");
  Configuration conf=new Configuration();
  FileSystem fs=root.getFileSystem(conf);
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  int bucket=20;
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).filesystem(fs).bucket(bucket).writingBase(false).minimumTransactionId(100).maximumTransactionId(100).inspector(inspector).reporter(Reporter.NULL).recordIdColumn(1).finalDestination(root);
  RecordUpdater updater=new OrcRecordUpdater(root,options);
  updater.update(100,new MyRow("update",30,10,bucket));
  updater.delete(100,new MyRow("",60,40,bucket));
  assertEquals(-1L,updater.getStats().getRowCount());
  updater.close(false);
  Path bucketPath=AcidUtils.createFilename(root,options);
  Reader reader=OrcFile.createReader(bucketPath,new OrcFile.ReaderOptions(conf).filesystem(fs));
  assertEquals(2,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  assertEquals(true,rows.hasNext());
  OrcStruct row=(OrcStruct)rows.next(null);
  assertEquals(OrcRecordUpdater.UPDATE_OPERATION,OrcRecordUpdater.getOperation(row));
  assertEquals(100,OrcRecordUpdater.getCurrentTransaction(row));
  assertEquals(10,OrcRecordUpdater.getOriginalTransaction(row));
  assertEquals(20,OrcRecordUpdater.getBucket(row));
  assertEquals(30,OrcRecordUpdater.getRowId(row));
  assertEquals("update",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(100,OrcRecordUpdater.getCurrentTransaction(row));
  assertEquals(40,OrcRecordUpdater.getOriginalTransaction(row));
  assertEquals(20,OrcRecordUpdater.getBucket(row));
  assertEquals(60,OrcRecordUpdater.getRowId(row));
  assertNull(OrcRecordUpdater.getRow(row));
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcSerDeStats </h4><pre class="type-11 type-12 type-5 type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ClassCastException.class) public void testSerdeStatsOldFormat() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(6300000,reader.getRawDataSize());
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("bye",((StringColumnStatistics)stats[9]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[9]).getMaximum());
  assertEquals(0,((StringColumnStatistics)stats[9]).getSum());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  assertEquals("count: 7500 hasNull: true",stats[8].toString());
  assertEquals(5,((BinaryColumnStatistics)stats[8]).getSum());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringAndBinaryStatistics() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(SimpleStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4),"foo"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3),"bar"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4,5),null));
  writer.addRow(new SimpleStruct(null,"hi"));
  writer.close();
  assertEquals(4,writer.getNumberOfRows());
  assertEquals(273,writer.getRawDataSize());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(4,reader.getNumberOfRows());
  assertEquals(273,reader.getRawDataSize());
  assertEquals(15,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1")));
  assertEquals(258,reader.getRawDataSizeOfColumns(Lists.newArrayList("string1")));
  assertEquals(273,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1","string1")));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4,stats[0].getNumberOfValues());
  assertEquals("count: 4 hasNull: false",stats[0].toString());
  assertEquals(3,stats[1].getNumberOfValues());
  assertEquals(15,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals("count: 3 hasNull: true sum: 15",stats[1].toString());
  assertEquals(3,stats[2].getNumberOfValues());
  assertEquals("bar",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals(8,((StringColumnStatistics)stats[2]).getSum());
  assertEquals("count: 3 hasNull: true min: bar max: hi sum: 8",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<bytes1:binary,string1:string>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("foo",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("bar",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3,4,5),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertNull(st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertNull(bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcTimezone1 </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadTimestampFormat_0_11() throws Exception {
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestRecordReaderImpl </h4><pre class="type-11 type-8 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialPlan() throws Exception {
  DiskRangeList result;
  List<OrcProto.Stream> streams=new ArrayList<OrcProto.Stream>();
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(1).setLength(1000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(1).setLength(99000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(2).setLength(2000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(2).setLength(98000).build());
  boolean[] columns=new boolean[]{true,true,false};
  boolean[] rowGroups=new boolean[]{true,true,false,false,true,false};
  OrcProto.RowIndex[] indexes=new OrcProto.RowIndex[columns.length];
  indexes[1]=OrcProto.RowIndex.newBuilder().addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(0).addPositions(-1).addPositions(-1).addPositions(0).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(100).addPositions(-1).addPositions(-1).addPositions(10000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(200).addPositions(-1).addPositions(-1).addPositions(20000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(300).addPositions(-1).addPositions(-1).addPositions(30000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(400).addPositions(-1).addPositions(-1).addPositions(40000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(500).addPositions(-1).addPositions(-1).addPositions(50000).build()).build();
  List<OrcProto.ColumnEncoding> encodings=new ArrayList<OrcProto.ColumnEncoding>();
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addSubtypes(1).addSubtypes(2).addFieldNames("x").addFieldNames("y").build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(0,1000,100,1000,400,1000,1000,11000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,11000,21000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,41000,51000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(0,21000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,41000,51000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  rowGroups=new boolean[]{false,false,false,false,false,false};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertNull(result);
  rowGroups=null;
  columns=new boolean[]{true,false,true};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,null,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(100000,102000,102000,200000)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,null,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(100000,200000)));
  rowGroups=new boolean[]{false,true,false,false,false,false};
  indexes[2]=indexes[1];
  indexes[1]=null;
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(100100,102000,112000,122000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(100100,102000,112000,122000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  rowGroups=new boolean[]{false,false,false,false,false,true};
  indexes[1]=indexes[2];
  columns=new boolean[]{true,true,true};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(500,1000,51000,100000,100500,102000,152000,200000)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(500,1000,51000,100000,100500,102000,152000,200000)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestVectorOrcFile </h4><pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFormat_0_11() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>,ts:timestamp,"+ "decimal1:decimal(38,18)>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  HiveDecimalObjectInspector dco=(HiveDecimalObjectInspector)readerInspector.getStructFieldRef("decimal1").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547456"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547457"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV12() throws Exception {
  TypeDescription schema=createInnerSchema();
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).version(OrcFile.Version.V_0_12));
  VectorizedRowBatch batch=schema.createRowBatch();
  assertEquals(testFilePath,memory.path);
  batch.size=1;
  for (int i=0; i < 2500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[0]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(0,Integer.toHexString(10 * i).getBytes());
    writer.addRowBatch(batch);
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(3,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringAndBinaryStatistics() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("bytes1",TypeDescription.createBinary()).addField("string1",TypeDescription.createString());
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=4;
  BytesColumnVector field1=(BytesColumnVector)batch.cols[0];
  BytesColumnVector field2=(BytesColumnVector)batch.cols[1];
  field1.setVal(0,bytesArray(0,1,2,3,4));
  field1.setVal(1,bytesArray(0,1,2,3));
  field1.setVal(2,bytesArray(0,1,2,3,4,5));
  field1.noNulls=false;
  field1.isNull[3]=true;
  field2.setVal(0,"foo".getBytes());
  field2.setVal(1,"bar".getBytes());
  field2.noNulls=false;
  field2.isNull[2]=true;
  field2.setVal(3,"hi".getBytes());
  writer.addRowBatch(batch);
  writer.close();
  schema=writer.getSchema();
  assertEquals(2,schema.getMaximumId());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  boolean[] expected=new boolean[]{false,false,true};
  boolean[] included=OrcUtils.includeColumns("string1",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns(null,schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4,stats[0].getNumberOfValues());
  assertEquals("count: 4 hasNull: false",stats[0].toString());
  assertEquals(3,stats[1].getNumberOfValues());
  assertEquals(15,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals("count: 3 hasNull: true sum: 15",stats[1].toString());
  assertEquals(3,stats[2].getNumberOfValues());
  assertEquals("bar",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals(8,((StringColumnStatistics)stats[2]).getSum());
  assertEquals("count: 3 hasNull: true min: bar max: hi sum: 8",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<bytes1:binary,string1:string>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("foo",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("bar",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3,4,5),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertNull(st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertNull(bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV11() throws Exception {
  TypeDescription schema=createInnerSchema();
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).version(OrcFile.Version.V_0_11));
  assertEquals(testFilePath,memory.path);
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1;
  for (int i=0; i < 2500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[0]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(0,Integer.toHexString(10 * i).getBytes());
    writer.addRowBatch(batch);
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(25,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void metaData() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100));
  writer.addUserMetadata("my.meta",byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128));
  writer.addUserMetadata("clobber",byteBuf(1,2,3));
  writer.addUserMetadata("clobber",byteBuf(4,3,2,1));
  ByteBuffer bigBuf=ByteBuffer.allocate(40000);
  Random random=new Random(0);
  random.nextBytes(bigBuf.array());
  writer.addUserMetadata("big",bigBuf);
  bigBuf.position(0);
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1;
  setBigRow(batch,0,true,(byte)127,(short)1024,42,42L * 1024 * 1024* 1024,(float)3.1415,-2.713,null,null,null,null,null);
  writer.addRowBatch(batch);
  writer.addUserMetadata("clobber",byteBuf(5,7,11,13,17,19));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(byteBuf(5,7,11,13,17,19),reader.getMetadataValue("clobber"));
  assertEquals(byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128),reader.getMetadataValue("my.meta"));
  assertEquals(bigBuf,reader.getMetadataValue("big"));
  try {
    reader.getMetadataValue("unknown");
    assertTrue(false);
  }
 catch (  IllegalArgumentException iae) {
  }
  int i=0;
  for (  String key : reader.getMetadataKeys()) {
    if ("my.meta".equals(key) || "clobber".equals(key) || "big".equals(key)) {
      i+=1;
    }
 else {
      throw new IllegalArgumentException("unknown key " + key);
    }
  }
  assertEquals(3,i);
  int numStripes=reader.getStripeStatistics().size();
  assertEquals(1,numStripes);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=2;
  setBigRow(batch,0,false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map());
  setBigRow(batch,1,true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib")));
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(23,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertArrayEquals(expected,included);
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertArrayEquals(expected,included);
  expected=new boolean[]{false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,byte1,short1,int1,long1,float1,double1,bytes1,string1,middle,list,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  StripeStatistics ss=reader.getStripeStatistics().get(0);
  assertEquals(2,ss.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)ss.getColumnStatistics()[1]).getTrueCount());
  assertEquals(1024,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMinimum());
  assertEquals(2048,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMaximum());
  assertEquals(3072,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getSum());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPredicatePushdown() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(400000L).compress(CompressionKind.NONE).bufferSize(500).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.ensureSize(3500);
  batch.size=3500;
  for (int i=0; i < 3500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[i]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(i,Integer.toHexString(10 * i).getBytes());
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(3500,reader.getNumberOfRows());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().startNot().lessThan("int1",PredicateLeaf.Type.LONG,300000L).end().lessThan("int1",PredicateLeaf.Type.LONG,600000L).end().build();
  RecordReader rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(1000L,rows.getRowNumber());
  OrcStruct row=null;
  for (int i=1000; i < 2000; ++i) {
    assertTrue(rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
  sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("int1",PredicateLeaf.Type.LONG,0L).end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(3500L,rows.getRowNumber());
  assertTrue(!rows.hasNext());
  sarg=SearchArgumentFactory.newBuilder().startOr().lessThan("int1",PredicateLeaf.Type.LONG,300L * 100).startNot().lessThan("int1",PredicateLeaf.Type.LONG,300L * 3400).end().end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  row=null;
  for (int i=0; i < 1000; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  for (int i=3000; i < 3500; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestDataWritableWriter </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedStructTypeOnRecord() throws Exception {
  String columnNames="structCol";
  String columnTypes="int";
  ArrayWritable hiveRecord=createGroup(createInt(1));
  String fileSchema="message hive_schema {\n" + "  optional group structCol {\n" + "      optional int32 int;\n"+ "    }\n"+ "}\n";
  try {
    writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Invalid data type: expected STRUCT type, but found: PRIMITIVE",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedMapTypeOnRecord() throws Exception {
  String columnNames="mapCol";
  String columnTypes="int";
  ArrayWritable hiveRecord=createGroup(createInt(1));
  String fileSchema="message hive_schema {\n" + "  optional group mapCol (MAP) {\n" + "    repeated group map (MAP_KEY_VALUE) {\n"+ "      required binary key;\n"+ "      optional int32 value;\n"+ "    }\n"+ "  }\n"+ "}\n";
  try {
    writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Invalid data type: expected MAP type, but found: PRIMITIVE",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedArrayTypeOnRecord() throws Exception {
  String columnNames="arrayCol";
  String columnTypes="int";
  ArrayWritable hiveRecord=createGroup(createInt(1));
  String fileSchema="message hive_schema {\n" + "  optional group arrayCol (LIST) {\n" + "    repeated group bag {\n"+ "      optional int32 array_element;\n"+ "    }\n"+ "  }\n"+ "}\n";
  try {
    writeParquetRecord(fileSchema,getParquetWritable(columnNames,columnTypes,hiveRecord));
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals("Parquet record is malformed: Invalid data type: expected LIST type, but found: PRIMITIVE",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestMapredParquetOutputFormat </h4><pre class="type-3 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testGetHiveRecordWriter() throws IOException {
  Properties tableProps=new Properties();
  tableProps.setProperty("columns","foo,bar");
  tableProps.setProperty("columns.types","int:int");
  final Progressable mockProgress=mock(Progressable.class);
  final ParquetOutputFormat<ParquetHiveRecord> outputFormat=(ParquetOutputFormat<ParquetHiveRecord>)mock(ParquetOutputFormat.class);
  JobConf jobConf=new JobConf();
  try {
    new MapredParquetOutputFormat(outputFormat){
      @Override protected ParquetRecordWriterWrapper getParquerRecordWriterWrapper(      ParquetOutputFormat<ParquetHiveRecord> realOutputFormat,      JobConf jobConf,      String finalOutPath,      Progressable progress,      Properties tableProperties) throws IOException {
        assertEquals(outputFormat,realOutputFormat);
        assertNotNull(jobConf.get(DataWritableWriteSupport.PARQUET_HIVE_SCHEMA));
        assertEquals("/foo",finalOutPath.toString());
        assertEquals(mockProgress,progress);
        throw new RuntimeException("passed tests");
      }
    }
.getHiveRecordWriter(jobConf,new Path("/foo"),null,false,tableProps,mockProgress);
    fail("should throw runtime exception.");
  }
 catch (  RuntimeException e) {
    assertEquals("passed tests",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetRecordWriterThrowsException(){
  try {
    new MapredParquetOutputFormat().getRecordWriter(null,null,null,null);
    fail("should throw runtime exception.");
  }
 catch (  Exception e) {
    assertEquals("Should never be used",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.serde.TestAbstractParquetMapInspector </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyContainer(){
  final ArrayWritable map=new ArrayWritable(ArrayWritable.class,new ArrayWritable[0]);
  assertEquals("Wrong size",-1,inspector.getMapSize(map));
  assertNull("Should be null",inspector.getMap(map));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullMap(){
  assertEquals("Wrong size",-1,inspector.getMapSize(null));
  assertNull("Should be null",inspector.getMap(null));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullContainer(){
  final ArrayWritable map=new ArrayWritable(ArrayWritable.class,null);
  assertEquals("Wrong size",-1,inspector.getMapSize(map));
  assertNull("Should be null",inspector.getMap(map));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.serde.TestParquetHiveArrayInspector </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyContainer(){
  final ArrayWritable list=new ArrayWritable(ArrayWritable.class,new ArrayWritable[0]);
  assertEquals("Wrong size",-1,inspector.getListLength(list));
  assertNull("Should be null",inspector.getList(list));
  assertNull("Should be null",inspector.getListElement(list,0));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullArray(){
  assertEquals("Wrong size",-1,inspector.getListLength(null));
  assertNull("Should be null",inspector.getList(null));
  assertNull("Should be null",inspector.getListElement(null,0));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullContainer(){
  final ArrayWritable list=new ArrayWritable(ArrayWritable.class,null);
  assertEquals("Wrong size",-1,inspector.getListLength(list));
  assertNull("Should be null",inspector.getList(list));
  assertNull("Should be null",inspector.getListElement(list,0));
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegularList(){
  final ArrayWritable list=new ArrayWritable(Writable.class,new Writable[]{new IntWritable(3),new IntWritable(5),new IntWritable(1)});
  final List<Writable> expected=new ArrayList<Writable>();
  expected.add(new IntWritable(3));
  expected.add(new IntWritable(5));
  expected.add(new IntWritable(1));
  assertEquals("Wrong size",3,inspector.getListLength(list));
  assertEquals("Wrong result of inspection",expected,inspector.getList(list));
  for (int i=0; i < expected.size(); ++i) {
    assertEquals("Wrong result of inspection",expected.get(i),inspector.getListElement(list,i));
  }
  assertNull("Should be null",inspector.getListElement(list,3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.serde.TestStandardParquetHiveMapInspector </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHashMap(){
  final Map<Writable,Writable> map=new HashMap<Writable,Writable>();
  map.put(new IntWritable(0),new IntWritable(1));
  map.put(new IntWritable(2),new IntWritable(3));
  map.put(new IntWritable(4),new IntWritable(5));
  map.put(new IntWritable(6),new IntWritable(7));
  assertEquals("Wrong result of inspection",new IntWritable(1),inspector.getMapValueElement(map,new IntWritable(0)));
  assertEquals("Wrong result of inspection",new IntWritable(3),inspector.getMapValueElement(map,new IntWritable(2)));
  assertEquals("Wrong result of inspection",new IntWritable(5),inspector.getMapValueElement(map,new IntWritable(4)));
  assertEquals("Wrong result of inspection",new IntWritable(7),inspector.getMapValueElement(map,new IntWritable(6)));
  assertNull("Wrong result of inspection",inspector.getMapValueElement(map,new ShortWritable((short)0)));
  assertNull("Wrong result of inspection",inspector.getMapValueElement(map,new ShortWritable((short)2)));
  assertNull("Wrong result of inspection",inspector.getMapValueElement(map,new ShortWritable((short)4)));
  assertNull("Wrong result of inspection",inspector.getMapValueElement(map,new ShortWritable((short)6)));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegularMap(){
  final Writable[] entry1=new Writable[]{new IntWritable(0),new IntWritable(1)};
  final Writable[] entry2=new Writable[]{new IntWritable(2),new IntWritable(3)};
  final ArrayWritable map=new ArrayWritable(ArrayWritable.class,new Writable[]{new ArrayWritable(Writable.class,entry1),new ArrayWritable(Writable.class,entry2)});
  assertEquals("Wrong result of inspection",new IntWritable(1),inspector.getMapValueElement(map,new IntWritable(0)));
  assertEquals("Wrong result of inspection",new IntWritable(3),inspector.getMapValueElement(map,new IntWritable(2)));
  assertNull("Wrong result of inspection",inspector.getMapValueElement(map,new ShortWritable((short)0)));
  assertNull("Wrong result of inspection",inspector.getMapValueElement(map,new ShortWritable((short)2)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpression8() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "      <void property=\"column\"> \n"+ "       <string>first_name</string> \n"+ "      </void> \n"+ "      <void property=\"tabAlias\"> \n"+ "       <string>orc_people</string> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "        <void property=\"typeName\"> \n"+ "         <string>string</string> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "      <void property=\"column\"> \n"+ "       <string>last_name</string> \n"+ "      </void> \n"+ "      <void property=\"tabAlias\"> \n"+ "       <string>orc_people</string> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "    <void property=\"typeName\"> \n"+ "     <string>boolean</string> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ " </object> \n"+ "</java> ";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(0,leaves.size());
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  assertNull(p);
  assertEquals("YES_NO_NULL",sarg.getExpression().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.sarg.TestSearchArgumentImpl </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimestampSerialization() throws Exception {
  Timestamp now=new Timestamp(new java.util.Date().getTime());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("x",PredicateLeaf.Type.TIMESTAMP,now).end().build();
  String serializedSarg=TestInputOutputFormat.toKryo(sarg);
  SearchArgument sarg2=ConvertAstToSearchArg.create(serializedSarg);
  Field literalField=PredicateLeafImpl.class.getDeclaredField("literal");
  literalField.setAccessible(true);
  assertTrue(literalField.get(sarg2.getLeaves().get(0)) instanceof java.util.Date);
  Timestamp ts=(Timestamp)sarg2.getLeaves().get(0).getLiteral();
  assertEquals(ts,now);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lib.TestRuleRegExp </h4><pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPatternWithWildCardChar(){
  RuleRegExp rule1=new RuleRegExp("R1","(" + TableScanOperator.getOperatorName() + "%"+ FilterOperator.getOperatorName()+ "%)|("+ TableScanOperator.getOperatorName()+ "%"+ FileSinkOperator.getOperatorName()+ "%)");
  assertEquals(rule1.rulePatternIsValidWithoutWildCardChar(),false);
  assertEquals(rule1.rulePatternIsValidWithWildCardChar(),true);
  Stack<Node> ns1=new Stack<Node>();
  ns1.push(new TestNode(TableScanOperator.getOperatorName()));
  ns1.push(new TestNode(FilterOperator.getOperatorName()));
  Stack<Node> ns2=new Stack<Node>();
  ns2.push(new TestNode(TableScanOperator.getOperatorName()));
  ns2.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertNotEquals(rule1.cost(ns1),-1);
    assertNotEquals(rule1.cost(ns2),-1);
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
  Stack<Node> ns3=new Stack<Node>();
  ns3.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns3.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns3.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertEquals(rule1.cost(ns3),-1);
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPatternWithoutWildCardChar(){
  String patternStr=ReduceSinkOperator.getOperatorName() + "%" + SelectOperator.getOperatorName()+ "%"+ FileSinkOperator.getOperatorName()+ "%";
  RuleRegExp rule1=new RuleRegExp("R1",patternStr);
  assertEquals(rule1.rulePatternIsValidWithoutWildCardChar(),true);
  assertEquals(rule1.rulePatternIsValidWithWildCardChar(),false);
  Stack<Node> ns1=new Stack<Node>();
  ns1.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns1.push(new TestNode(SelectOperator.getOperatorName()));
  ns1.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertEquals(rule1.cost(ns1),patternStr.length());
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
  Stack<Node> ns2=new Stack<Node>();
  ns2.push(new TestNode(ReduceSinkOperator.getOperatorName()));
  ns1.push(new TestNode(TableScanOperator.getOperatorName()));
  ns1.push(new TestNode(FileSinkOperator.getOperatorName()));
  try {
    assertEquals(rule1.cost(ns2),-1);
  }
 catch (  SemanticException e) {
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.TestDbTxnManager </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteDynamicPartition() throws Exception {
  WriteEntity we=addDynamicPartitionedOutput(newTable(true),WriteEntity.WriteType.INSERT);
  QueryPlan qp=new MockQueryPlan(this);
  txnMgr.openTxn("fred");
  txnMgr.acquireLocks(qp,ctx,"fred");
  List<HiveLock> locks=ctx.getHiveLocks();
  Assert.assertEquals(1,locks.size());
  ShowLocksResponse rsp=((DbLockManager)txnMgr.getLockManager()).getLocks();
  List<ShowLocksResponseElement> elms=rsp.getLocks();
  Assert.assertEquals(1,elms.size());
  Assert.assertNotNull(elms.get(0).getTablename());
  Assert.assertNull(elms.get(0).getPartname());
  txnMgr.commitTxn();
  locks=txnMgr.getLockManager().getLocks(false,false);
  Assert.assertEquals(0,locks.size());
}

</code></pre>

<br>
<pre class="type-11 type-10 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  TxnDbUtil.prepDb();
  txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  txnMgr.getLockManager();
  Assert.assertTrue(txnMgr instanceof DbTxnManager);
  nextInput=1;
  readEntities=new HashSet<ReadEntity>();
  writeEntities=new HashSet<WriteEntity>();
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TIMEDOUT_TXN_REAPER_START,0,TimeUnit.SECONDS);
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TXN_TIMEOUT,1,TimeUnit.SECONDS);
  houseKeeperService=new AcidHouseKeeperService();
}

</code></pre>

<br>
<pre class="type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeater() throws Exception {
  Assert.assertTrue(txnMgr instanceof DbTxnManager);
  addTableInput();
  LockException exception=null;
  QueryPlan qp=new MockQueryPlan(this);
  txnMgr.openTxn("fred");
  txnMgr.acquireLocks(qp,ctx,"fred");
  runReaper();
  try {
    txnMgr.commitTxn();
  }
 catch (  LockException e) {
    exception=e;
  }
  Assert.assertNull("Txn commit should be successful",exception);
  exception=null;
  txnMgr.openTxn("tom");
  ((DbTxnManager)txnMgr).acquireLocksWithHeartbeatDelay(qp,ctx,"tom",HiveConf.getTimeVar(conf,HiveConf.ConfVars.HIVE_TXN_TIMEOUT,TimeUnit.MILLISECONDS) / 2);
  runReaper();
  try {
    txnMgr.commitTxn();
  }
 catch (  LockException e) {
    exception=e;
  }
  Assert.assertNull("Txn commit should also be successful",exception);
  exception=null;
  txnMgr.openTxn("jerry");
  ((DbTxnManager)txnMgr).acquireLocks(qp,ctx,"jerry",true);
  Thread.sleep(HiveConf.getTimeVar(conf,HiveConf.ConfVars.HIVE_TXN_TIMEOUT,TimeUnit.MILLISECONDS));
  runReaper();
  try {
    txnMgr.commitTxn();
  }
 catch (  LockException e) {
    exception=e;
  }
  Assert.assertNotNull("Txn should have been aborted",exception);
  Assert.assertEquals(ErrorMsg.TXN_ABORTED,exception.getCanonicalErrorMsg());
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExceptions() throws Exception {
  addPartitionOutput(newTable(true),WriteEntity.WriteType.INSERT);
  QueryPlan qp=new MockQueryPlan(this);
  txnMgr.openTxn("NicholasII");
  Thread.sleep(HiveConf.getTimeVar(conf,HiveConf.ConfVars.HIVE_TXN_TIMEOUT,TimeUnit.MILLISECONDS));
  runReaper();
  LockException exception=null;
  try {
    txnMgr.commitTxn();
  }
 catch (  LockException ex) {
    exception=ex;
  }
  Assert.assertNotNull("Expected exception1",exception);
  Assert.assertEquals("Wrong Exception1",ErrorMsg.TXN_ABORTED,exception.getCanonicalErrorMsg());
  exception=null;
  txnMgr.openTxn("AlexanderIII");
  Thread.sleep(HiveConf.getTimeVar(conf,HiveConf.ConfVars.HIVE_TXN_TIMEOUT,TimeUnit.MILLISECONDS));
  runReaper();
  try {
    txnMgr.rollbackTxn();
  }
 catch (  LockException ex) {
    exception=ex;
  }
  Assert.assertNotNull("Expected exception2",exception);
  Assert.assertEquals("Wrong Exception2",ErrorMsg.TXN_NO_SUCH_TRANSACTION,exception.getCanonicalErrorMsg());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.TestDbTxnManager2 </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyTxnManagerOnAcidTable() throws Exception {
  CommandProcessorResponse cpr=driver.run("create table T10 (a int, b int) clustered by(b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')");
  checkCmdOnDriver(cpr);
  cpr=driver.run("create table T11 (a int, b int) clustered by(b) into 2 buckets stored as orc");
  checkCmdOnDriver(cpr);
  conf.setVar(HiveConf.ConfVars.HIVE_TXN_MANAGER,"org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager");
  txnMgr=SessionState.get().initTxnMgr(conf);
  Assert.assertTrue(txnMgr instanceof DummyTxnManager);
  cpr=driver.compileAndRespond("select * from T10");
  Assert.assertEquals(ErrorMsg.TXNMGR_NOT_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("This command is not allowed on an ACID table"));
  cpr=driver.compileAndRespond("insert into table T10 values (1, 2)");
  Assert.assertEquals(ErrorMsg.TXNMGR_NOT_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("This command is not allowed on an ACID table"));
  cpr=driver.compileAndRespond("insert overwrite table T10 select a, b from T11");
  Assert.assertEquals(ErrorMsg.NO_INSERT_OVERWRITE_WITH_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("INSERT OVERWRITE not allowed on table with OutputFormat" + " that implements AcidOutputFormat while transaction manager that supports ACID is in use"));
  cpr=driver.compileAndRespond("update T10 set a=0 where b=1");
  Assert.assertEquals(ErrorMsg.ACID_OP_ON_NONACID_TXNMGR.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("Attempt to do update or delete using transaction manager that does not support these operations."));
  cpr=driver.compileAndRespond("delete from T10");
  Assert.assertEquals(ErrorMsg.ACID_OP_ON_NONACID_TXNMGR.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("Attempt to do update or delete using transaction manager that does not support these operations."));
}

</code></pre>

<br>
<pre class="type-11 type-10 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  SessionState.start(conf);
  ctx=new Context(conf);
  driver=new Driver(conf);
  driver.init();
  TxnDbUtil.cleanDb();
  TxnDbUtil.prepDb();
  txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  Assert.assertTrue(txnMgr instanceof DbTxnManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.TestDummyTxnManager </h4><pre class="type-11 type-10 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  conf.setBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY,true);
  conf.setVar(HiveConf.ConfVars.HIVE_TXN_MANAGER,DummyTxnManager.class.getName());
  SessionState.start(conf);
  ctx=new Context(conf);
  txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  Assert.assertTrue(txnMgr instanceof DummyTxnManager);
  Field field=DummyTxnManager.class.getDeclaredField("lockMgr");
  field.setAccessible(true);
  field.set(txnMgr,mockLockManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.zookeeper.TestZookeeperLockManager </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteNoChildren() throws Exception {
  client.create().creatingParentsIfNeeded().forPath(TABLE_LOCK_PATH,lockObjData.toString().getBytes());
  byte[] data=client.getData().forPath(TABLE_LOCK_PATH);
  Assert.assertArrayEquals(lockObjData.toString().getBytes(),data);
  ZooKeeperHiveLockManager.unlockPrimitive(zLock,PARENT,client);
  try {
    data=client.getData().forPath(TABLE_LOCK_PATH);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertEquals(e instanceof KeeperException.NoNodeException,true);
  }
  try {
    data=client.getData().forPath(PARENT_LOCK_PATH);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertEquals(e instanceof KeeperException.NoNodeException,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.listbucketingpruner.TestListBucketingPrunner </h4><pre class="type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOrBoolOperand(){
  Assert.assertTrue(ListBucketingPrunerUtils.orBoolOperand(null,Boolean.TRUE));
  Assert.assertNull(ListBucketingPrunerUtils.orBoolOperand(null,Boolean.FALSE));
  Assert.assertNull(ListBucketingPrunerUtils.orBoolOperand(null,Boolean.FALSE));
  Assert.assertTrue(ListBucketingPrunerUtils.orBoolOperand(Boolean.TRUE,Boolean.TRUE));
  Assert.assertTrue(ListBucketingPrunerUtils.orBoolOperand(Boolean.TRUE,Boolean.FALSE));
  Assert.assertNull(ListBucketingPrunerUtils.orBoolOperand(Boolean.TRUE,null));
  Assert.assertTrue(ListBucketingPrunerUtils.orBoolOperand(Boolean.FALSE,Boolean.TRUE));
  Assert.assertFalse(ListBucketingPrunerUtils.orBoolOperand(Boolean.FALSE,Boolean.FALSE));
  Assert.assertNull(ListBucketingPrunerUtils.orBoolOperand(Boolean.FALSE,null));
}

</code></pre>

<br>
<pre class="type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAndBoolOperand(){
  Assert.assertNull(ListBucketingPrunerUtils.andBoolOperand(null,Boolean.TRUE));
  Assert.assertFalse(ListBucketingPrunerUtils.andBoolOperand(null,Boolean.FALSE));
  Assert.assertNull(ListBucketingPrunerUtils.andBoolOperand(null,null));
  Assert.assertTrue(ListBucketingPrunerUtils.andBoolOperand(Boolean.TRUE,Boolean.TRUE));
  Assert.assertFalse(ListBucketingPrunerUtils.andBoolOperand(Boolean.TRUE,Boolean.FALSE));
  Assert.assertNull(ListBucketingPrunerUtils.andBoolOperand(Boolean.TRUE,null));
  Assert.assertFalse(ListBucketingPrunerUtils.andBoolOperand(Boolean.FALSE,Boolean.TRUE));
  Assert.assertFalse(ListBucketingPrunerUtils.andBoolOperand(Boolean.FALSE,Boolean.FALSE));
  Assert.assertFalse(ListBucketingPrunerUtils.andBoolOperand(Boolean.FALSE,null));
}

</code></pre>

<br>
<pre class="type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNotBoolOperand(){
  Assert.assertFalse(ListBucketingPrunerUtils.notBoolOperand(Boolean.TRUE));
  Assert.assertTrue(ListBucketingPrunerUtils.notBoolOperand(Boolean.FALSE));
  Assert.assertNull(ListBucketingPrunerUtils.notBoolOperand(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.physical.TestVectorizer </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregateOnUDF() throws HiveException {
  AggregationDesc aggDesc=new AggregationDesc();
  aggDesc.setGenericUDAFName("sum");
  ExprNodeGenericFuncDesc exprNodeDesc=new ExprNodeGenericFuncDesc();
  exprNodeDesc.setTypeInfo(TypeInfoFactory.intTypeInfo);
  ArrayList<ExprNodeDesc> params=new ArrayList<ExprNodeDesc>();
  params.add(exprNodeDesc);
  aggDesc.setParameters(params);
  GenericUDFAbs absUdf=new GenericUDFAbs();
  exprNodeDesc.setGenericUDF(absUdf);
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  ExprNodeColumnDesc colExprA=new ExprNodeColumnDesc(Integer.class,"col1","T",false);
  ExprNodeColumnDesc colExprB=new ExprNodeColumnDesc(Integer.class,"col2","T",false);
  children.add(colExprA);
  exprNodeDesc.setChildren(children);
  ArrayList<String> outputColumnNames=new ArrayList<String>();
  outputColumnNames.add("_col0");
  GroupByDesc desc=new GroupByDesc();
  desc.setOutputColumnNames(outputColumnNames);
  ArrayList<AggregationDesc> aggDescList=new ArrayList<AggregationDesc>();
  aggDescList.add(aggDesc);
  desc.setAggregators(aggDescList);
  ArrayList<ExprNodeDesc> grpByKeys=new ArrayList<ExprNodeDesc>();
  grpByKeys.add(colExprB);
  desc.setKeys(grpByKeys);
  GroupByOperator gbyOp=new GroupByOperator(new CompilationOpContext());
  gbyOp.setConf(desc);
  Vectorizer v=new Vectorizer();
  Assert.assertTrue(v.validateMapWorkOperator(gbyOp,null,false));
  VectorGroupByOperator vectorOp=(VectorGroupByOperator)v.vectorizeOperator(gbyOp,vContext,false);
  Assert.assertEquals(VectorUDAFSumLong.class,vectorOp.getAggregators()[0].getClass());
  VectorUDAFSumLong udaf=(VectorUDAFSumLong)vectorOp.getAggregators()[0];
  Assert.assertEquals(FuncAbsLongToLong.class,udaf.getInputExpression().getClass());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.ppr.TestPositivePartitionPrunerCompactExpr </h4><pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactExpr(){
  ExprNodeDesc actual=PartitionPruner.compactExpr(expression);
  if (expected == null) {
    assertNull(actual);
  }
 else {
    assertNotNull("Expected not NULL expression",actual);
    assertNotNull("Expected not NULL expression string",actual.getExprString());
    assertEquals(expected,actual.getExprString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestColumnAccess </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinTable1AndTable2() throws ParseException {
  String query="select * from t1 join t2 on (t1.id1 = t2.id1)";
  Driver driver=createDriver();
  int rc=driver.compile(query);
  Assert.assertEquals("Checking command success",0,rc);
  QueryPlan plan=driver.getPlan();
  ColumnAccessInfo columnAccessInfo=plan.getColumnAccessInfo();
  List<String> cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  Map<String,List<String>> tableColsMap=getColsFromReadEntity(plan.getInputs());
  cols=tableColsMap.get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=tableColsMap.get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryTable1() throws ParseException {
  String query="select * from t1";
  Driver driver=createDriver();
  int rc=driver.compile(query);
  Assert.assertEquals("Checking command success",0,rc);
  QueryPlan plan=driver.getPlan();
  ColumnAccessInfo columnAccessInfo=plan.getColumnAccessInfo();
  List<String> cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  Map<String,List<String>> tableColsMap=getColsFromReadEntity(plan.getInputs());
  cols=tableColsMap.get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinView1AndTable2() throws ParseException {
  String query="select * from v1 join t2 on (v1.id1 = t2.id1)";
  Driver driver=createDriver();
  int rc=driver.compile(query);
  Assert.assertEquals("Checking command success",0,rc);
  QueryPlan plan=driver.getPlan();
  ColumnAccessInfo columnAccessInfo=plan.getColumnAccessInfo();
  List<String> cols=columnAccessInfo.getTableToColumnAccessMap().get("default@v1");
  Assert.assertNull(cols);
  cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  Map<String,List<String>> tableColsMap=getColsFromReadEntity(plan.getInputs());
  cols=tableColsMap.get("default@v1");
  Assert.assertNull(cols);
  cols=tableColsMap.get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=tableColsMap.get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestGenTezWork </h4><pre class="type-4 type-5 type-14 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateReduce() throws SemanticException {
  proc.process(rs,null,ctx,(Object[])null);
  proc.process(fs,null,ctx,(Object[])null);
  TezWork work=ctx.currentTask.getWork();
  assertEquals(work.getAllWork().size(),2);
  BaseWork w=work.getAllWork().get(1);
  assertTrue(w instanceof ReduceWork);
  assertTrue(work.getParents(w).contains(work.getAllWork().get(0)));
  ReduceWork rw=(ReduceWork)w;
  assertNotNull(w.getName());
  assertSame(rw.getReducer(),fs);
  assertEquals(fs.getParentOperators().size(),0);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-14 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateMap() throws SemanticException {
  proc.process(rs,null,ctx,(Object[])null);
  assertNotNull(ctx.currentTask);
  assertTrue(ctx.rootTasks.contains(ctx.currentTask));
  TezWork work=ctx.currentTask.getWork();
  assertEquals(work.getAllWork().size(),1);
  BaseWork w=work.getAllWork().get(0);
  assertTrue(w instanceof MapWork);
  MapWork mw=(MapWork)w;
  assertNotNull(w.getName());
  assertSame(mw.getAliasToWork().entrySet().iterator().next().getValue(),ts);
  assertSame(ctx.preceedingWork,mw);
  assertSame(ctx.currentRootOperator,fs);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestIUD </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSelectStarFromAnonymousVirtTable1Row() throws ParseException {
  try {
    parse("select * from `values` (3,4)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:23 missing EOF at '(' near 'values'",ex.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestQBCompact </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBogusLevel() throws Exception {
  boolean sawException=false;
  try {
    parseAndAnalyze("alter table foo partition(ds = 'today') compact 'bogus'");
  }
 catch (  SemanticException e) {
    sawException=true;
    Assert.assertEquals(ErrorMsg.INVALID_COMPACTION_TYPE.getMsg(),e.getMessage());
  }
  Assert.assertTrue(sawException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestSQL11ReservedKeyWordsNegative </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_REGEXP(){
  try {
    parse("CREATE TABLE REGEXP (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'REGEXP'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_FOR(){
  try {
    parse("CREATE TABLE FOR (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'FOR'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_RIGHT(){
  try {
    parse("CREATE TABLE RIGHT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'RIGHT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_RANGE(){
  try {
    parse("CREATE TABLE RANGE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'RANGE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_CREATE(){
  try {
    parse("CREATE TABLE CREATE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'CREATE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_READS(){
  try {
    parse("CREATE TABLE READS (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'READS'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_LATERAL(){
  try {
    parse("CREATE TABLE LATERAL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'LATERAL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_FULL(){
  try {
    parse("CREATE TABLE FULL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'FULL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_PROCEDURE(){
  try {
    parse("CREATE TABLE PROCEDURE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'PROCEDURE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_EXTERNAL(){
  try {
    parse("CREATE TABLE EXTERNAL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'EXTERNAL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_PERCENT(){
  try {
    parse("CREATE TABLE PERCENT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'PERCENT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_BY(){
  try {
    parse("CREATE TABLE BY (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'BY'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_SMALLINT(){
  try {
    parse("CREATE TABLE SMALLINT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'SMALLINT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_INTERSECT(){
  try {
    parse("CREATE TABLE INTERSECT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'INTERSECT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ALTER(){
  try {
    parse("CREATE TABLE ALTER (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ALTER'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_FLOAT(){
  try {
    parse("CREATE TABLE FLOAT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'FLOAT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_LIKE(){
  try {
    parse("CREATE TABLE LIKE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'LIKE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_FALSE(){
  try {
    parse("CREATE TABLE FALSE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'FALSE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_LOCAL(){
  try {
    parse("CREATE TABLE LOCAL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'LOCAL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_EXISTS(){
  try {
    parse("CREATE TABLE EXISTS (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'EXISTS'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_INNER(){
  try {
    parse("CREATE TABLE INNER (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'INNER'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_CURRENT_DATE(){
  try {
    parse("CREATE TABLE CURRENT_DATE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'CURRENT_DATE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_DECIMAL(){
  try {
    parse("CREATE TABLE DECIMAL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'DECIMAL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_FETCH(){
  try {
    parse("CREATE TABLE FETCH (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'FETCH'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_DESCRIBE(){
  try {
    parse("CREATE TABLE DESCRIBE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'DESCRIBE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_IS(){
  try {
    parse("CREATE TABLE IS (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'IS'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ROWS(){
  try {
    parse("CREATE TABLE ROWS (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ROWS'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_GROUP(){
  try {
    parse("CREATE TABLE GROUP (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'GROUP'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_CUBE(){
  try {
    parse("CREATE TABLE CUBE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'CUBE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_TABLE(){
  try {
    parse("CREATE TABLE TABLE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'TABLE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_AS(){
  try {
    parse("CREATE TABLE AS (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'AS'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_USING(){
  try {
    parse("CREATE TABLE USING (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'USING'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_TRUNCATE(){
  try {
    parse("CREATE TABLE TRUNCATE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'TRUNCATE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ORDER(){
  try {
    parse("CREATE TABLE ORDER (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ORDER'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_REVOKE(){
  try {
    parse("CREATE TABLE REVOKE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'REVOKE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_BETWEEN(){
  try {
    parse("CREATE TABLE BETWEEN (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'BETWEEN'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_PARTITION(){
  try {
    parse("CREATE TABLE PARTITION (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'PARTITION'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_LEFT(){
  try {
    parse("CREATE TABLE LEFT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'LEFT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_IMPORT(){
  try {
    parse("CREATE TABLE IMPORT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'IMPORT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_TO(){
  try {
    parse("CREATE TABLE TO (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'TO'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_SET(){
  try {
    parse("CREATE TABLE SET (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'SET'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_CURRENT_TIMESTAMP(){
  try {
    parse("CREATE TABLE CURRENT_TIMESTAMP (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'CURRENT_TIMESTAMP'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ROW(){
  try {
    parse("CREATE TABLE ROW (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ROW'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_DROP(){
  try {
    parse("CREATE TABLE DROP (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'DROP'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_OUTER(){
  try {
    parse("CREATE TABLE OUTER (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'OUTER'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_NULL(){
  try {
    parse("CREATE TABLE NULL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'NULL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_UNION(){
  try {
    parse("CREATE TABLE UNION (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'UNION'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_TRUE(){
  try {
    parse("CREATE TABLE TRUE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'TRUE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_BINARY(){
  try {
    parse("CREATE TABLE BINARY (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'BINARY'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_BOOLEAN(){
  try {
    parse("CREATE TABLE BOOLEAN (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'BOOLEAN'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_BIGINT(){
  try {
    parse("CREATE TABLE BIGINT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'BIGINT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_DELETE(){
  try {
    parse("CREATE TABLE DELETE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'DELETE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_AUTHORIZATION(){
  try {
    parse("CREATE TABLE AUTHORIZATION (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'AUTHORIZATION'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_USER(){
  try {
    parse("CREATE TABLE USER (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'USER'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_NONE(){
  try {
    parse("CREATE TABLE NONE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'NONE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_CURSOR(){
  try {
    parse("CREATE TABLE CURSOR (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'CURSOR'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_GRANT(){
  try {
    parse("CREATE TABLE GRANT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'GRANT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_INSERT(){
  try {
    parse("CREATE TABLE INSERT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'INSERT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_VALUES(){
  try {
    parse("CREATE TABLE VALUES (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'VALUES'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ARRAY(){
  try {
    parse("CREATE TABLE ARRAY (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ARRAY'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_BOTH(){
  try {
    parse("CREATE TABLE BOTH (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'BOTH'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_RLIKE(){
  try {
    parse("CREATE TABLE RLIKE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'RLIKE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_UPDATE(){
  try {
    parse("CREATE TABLE UPDATE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'UPDATE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ALL(){
  try {
    parse("CREATE TABLE ALL (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ALL'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_ROLLUP(){
  try {
    parse("CREATE TABLE ROLLUP (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'ROLLUP'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_TRIGGER(){
  try {
    parse("CREATE TABLE TRIGGER (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'TRIGGER'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_OF(){
  try {
    parse("CREATE TABLE OF (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'OF'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_INTO(){
  try {
    parse("CREATE TABLE INTO (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'INTO'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_OUT(){
  try {
    parse("CREATE TABLE OUT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'OUT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_DOUBLE(){
  try {
    parse("CREATE TABLE DOUBLE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'DOUBLE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_WITH(){
  try {
    parse("CREATE TABLE WITH (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'WITH'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_GROUPING(){
  try {
    parse("CREATE TABLE GROUPING (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'GROUPING'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_DATE(){
  try {
    parse("CREATE TABLE DATE (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'DATE'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_IN(){
  try {
    parse("CREATE TABLE IN (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'IN'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_TIMESTAMP(){
  try {
    parse("CREATE TABLE TIMESTAMP (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'TIMESTAMP'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSQL11ReservedKeyWords_INT(){
  try {
    parse("CREATE TABLE INT (col STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:13 Failed to recognize predicate 'INT'. Failed rule: 'identifier' in table name",ex.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestUnpermittedCharsInColumnNameCreateTableNegative </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColonInCreateTable(){
  try {
    parse("CREATE TABLE testTable (`emp:no` STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:39 Failed to recognize predicate ')'. Failed rule: '[., :] can not be used in column name in create table statement.' in column specification",ex.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDotInCreateTable(){
  try {
    parse("CREATE TABLE testTable (`emp.no` STRING)");
    Assert.assertFalse("Expected ParseException",true);
  }
 catch (  ParseException ex) {
    Assert.assertEquals("Failure didn't match.","line 1:39 Failed to recognize predicate ')'. Failed rule: '[., :] can not be used in column name in create table statement.' in column specification",ex.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.authorization.TestHiveAuthorizationTaskFactory </h4><pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ROLE ... TO ROLE ...
 */
@Test public void testGrantRoleRole() throws Exception {
  DDLWork work=analyze("GRANT ROLE " + ROLE + " TO ROLE "+ ROLE);
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertTrue("Expected grant ",grantDesc.getGrant());
  Assert.assertFalse("With admin option is not specified",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : ListSizeMatcher.inList(grantDesc.getRoles()).ofSize(1)) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipalDesc()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ROLE ... FROM GROUP ...
 */
@Test public void testRevokeRoleGroup() throws Exception {
  DDLWork work=analyze("REVOKE ROLE " + ROLE + " FROM GROUP "+ GROUP);
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertFalse("Did not expect grant ",grantDesc.getGrant());
  Assert.assertFalse("With admin option is not specified",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : ListSizeMatcher.inList(grantDesc.getRoles()).ofSize(1)) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipalDesc()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.GROUP,principal.getType());
    Assert.assertEquals(GROUP,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * CREATE ROLE ...
 */
@Test public void testCreateRole() throws Exception {
  DDLWork work=analyze("CREATE ROLE " + ROLE);
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.CREATE_ROLE,roleDesc.getOperation());
  Assert.assertFalse("Did not expect a group",roleDesc.getGroup());
  Assert.assertEquals(ROLE,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW GRANT USER ... ON TABLE ...
 */
@Test public void testShowGrantUserOnTable() throws Exception {
  DDLWork work=analyze("SHOW GRANT USER " + USER + " ON TABLE "+ TABLE);
  ShowGrantDesc grantDesc=work.getShowGrantDesc();
  Assert.assertNotNull("Show grant should not be null",grantDesc);
  Assert.assertEquals(PrincipalType.USER,grantDesc.getPrincipalDesc().getType());
  Assert.assertEquals(USER,grantDesc.getPrincipalDesc().getName());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getHiveObj().getObject());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW ROLE GRANT ROLE ...
 */
@Test public void testShowRoleGrantRole() throws Exception {
  DDLWork work=analyze("SHOW ROLE GRANT ROLE " + ROLE);
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.SHOW_ROLE_GRANT,roleDesc.getOperation());
  Assert.assertEquals(PrincipalType.ROLE,roleDesc.getPrincipalType());
  Assert.assertEquals(ROLE,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ALL ON SERVER
 */
@Test public void testGrantServer() throws Exception {
  String serverName="foo";
  try {
    analyze("GRANT ALL ON SERVER " + serverName + " TO USER user2");
    Assert.fail("Grant on Server should fail");
  }
 catch (  SemanticException e) {
    Assert.assertEquals(serverName,DummyHiveAuthorizationTaskFactoryImpl.serverName);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ROLE ... TO USER ...
 */
@Test public void testGrantRoleUser() throws Exception {
  DDLWork work=analyze("GRANT ROLE " + ROLE + " TO USER "+ USER);
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertTrue("Expected grant ",grantDesc.getGrant());
  Assert.assertFalse("With admin option is not specified",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : ListSizeMatcher.inList(grantDesc.getRoles()).ofSize(1)) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipalDesc()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.USER,principal.getType());
    Assert.assertEquals(USER,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ... ON TABLE ... FROM ROLE ...
 */
@Test public void testRevokeRoleTable() throws Exception {
  DDLWork work=analyze("REVOKE " + SELECT + " ON TABLE "+ TABLE+ " FROM ROLE "+ ROLE);
  RevokeDesc grantDesc=work.getRevokeDesc();
  Assert.assertNotNull("Revoke should not be null",grantDesc);
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipals()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : ListSizeMatcher.inList(grantDesc.getPrivileges()).ofSize(1)) {
    Assert.assertEquals(Privilege.SELECT,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW GRANT ROLE ... ON TABLE ...
 */
@Test public void testShowGrantRoleOnTable() throws Exception {
  DDLWork work=analyze("SHOW GRANT ROLE " + ROLE + " ON TABLE "+ TABLE);
  ShowGrantDesc grantDesc=work.getShowGrantDesc();
  Assert.assertNotNull("Show grant should not be null",grantDesc);
  Assert.assertEquals(PrincipalType.ROLE,grantDesc.getPrincipalDesc().getType());
  Assert.assertEquals(ROLE,grantDesc.getPrincipalDesc().getName());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getHiveObj().getObject());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ... ON TABLE ... TO GROUP ...
 */
@Test public void testGrantGroupTable() throws Exception {
  DDLWork work=analyze("GRANT " + SELECT + " ON TABLE "+ TABLE+ " TO GROUP "+ GROUP);
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipals()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.GROUP,principal.getType());
    Assert.assertEquals(GROUP,principal.getName());
  }
  for (  PrivilegeDesc privilege : ListSizeMatcher.inList(grantDesc.getPrivileges()).ofSize(1)) {
    Assert.assertEquals(Privilege.SELECT,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ROLE ... TO GROUP ...
 */
@Test public void testGrantRoleGroup() throws Exception {
  DDLWork work=analyze("GRANT ROLE " + ROLE + " TO GROUP "+ GROUP);
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertTrue("Expected grant ",grantDesc.getGrant());
  Assert.assertFalse("With admin option is not specified",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : ListSizeMatcher.inList(grantDesc.getRoles()).ofSize(1)) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipalDesc()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.GROUP,principal.getType());
    Assert.assertEquals(GROUP,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ... ON TABLE ... FROM GROUP ...
 */
@Test public void testRevokeGroupTable() throws Exception {
  DDLWork work=analyze("REVOKE " + SELECT + " ON TABLE "+ TABLE+ " FROM GROUP "+ GROUP);
  RevokeDesc grantDesc=work.getRevokeDesc();
  Assert.assertNotNull("Revoke should not be null",grantDesc);
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipals()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.GROUP,principal.getType());
    Assert.assertEquals(GROUP,principal.getName());
  }
  for (  PrivilegeDesc privilege : ListSizeMatcher.inList(grantDesc.getPrivileges()).ofSize(1)) {
    Assert.assertEquals(Privilege.SELECT,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ALL ON URI
 */
@Test public void testGrantUri() throws Exception {
  String uriPath="/tmp";
  try {
    analyze("GRANT ALL ON URI '" + uriPath + "' TO USER user2");
    Assert.fail("Grant on URI should fail");
  }
 catch (  SemanticException e) {
    Assert.assertEquals(uriPath,DummyHiveAuthorizationTaskFactoryImpl.uriPath);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW GRANT GROUP ... ON TABLE ...
 */
@Test public void testShowGrantGroupOnTable() throws Exception {
  DDLWork work=analyze("SHOW GRANT GROUP " + GROUP + " ON TABLE "+ TABLE);
  ShowGrantDesc grantDesc=work.getShowGrantDesc();
  Assert.assertNotNull("Show grant should not be null",grantDesc);
  Assert.assertEquals(PrincipalType.GROUP,grantDesc.getPrincipalDesc().getType());
  Assert.assertEquals(GROUP,grantDesc.getPrincipalDesc().getName());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getHiveObj().getObject());
  Assert.assertTrue("Expected table",grantDesc.getHiveObj().getTable());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ROLE ... FROM ROLE ...
 */
@Test public void testRevokeRoleRole() throws Exception {
  DDLWork work=analyze("REVOKE ROLE " + ROLE + " FROM ROLE "+ ROLE);
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertFalse("Did not expect grant ",grantDesc.getGrant());
  Assert.assertFalse("With admin option is not specified",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : ListSizeMatcher.inList(grantDesc.getRoles()).ofSize(1)) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipalDesc()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ... ON TABLE ... TO ROLE ...
 */
@Test public void testGrantRoleTable() throws Exception {
  DDLWork work=analyze("GRANT " + SELECT + " ON TABLE "+ TABLE+ " TO ROLE "+ ROLE);
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipals()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.ROLE,principal.getType());
    Assert.assertEquals(ROLE,principal.getName());
  }
  for (  PrivilegeDesc privilege : ListSizeMatcher.inList(grantDesc.getPrivileges()).ofSize(1)) {
    Assert.assertEquals(Privilege.SELECT,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ... ON TABLE ... FROM USER ...
 */
@Test public void testRevokeUserTable() throws Exception {
  DDLWork work=analyze("REVOKE " + SELECT + " ON TABLE "+ TABLE+ " FROM USER "+ USER);
  RevokeDesc grantDesc=work.getRevokeDesc();
  Assert.assertNotNull("Revoke should not be null",grantDesc);
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipals()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.USER,principal.getType());
    Assert.assertEquals(USER,principal.getName());
  }
  for (  PrivilegeDesc privilege : ListSizeMatcher.inList(grantDesc.getPrivileges()).ofSize(1)) {
    Assert.assertEquals(Privilege.SELECT,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * DROP ROLE ...
 */
@Test public void testDropRole() throws Exception {
  DDLWork work=analyze("DROp ROLE " + ROLE);
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.DROP_ROLE,roleDesc.getOperation());
  Assert.assertFalse("Did not expect a group",roleDesc.getGroup());
  Assert.assertEquals(ROLE,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * GRANT ... ON TABLE ... TO USER ...
 */
@Test public void testGrantUserTable() throws Exception {
  DDLWork work=analyze("GRANT " + SELECT + " ON TABLE "+ TABLE+ " TO USER "+ USER);
  GrantDesc grantDesc=work.getGrantDesc();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipals()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.USER,principal.getType());
    Assert.assertEquals(USER,principal.getName());
  }
  for (  PrivilegeDesc privilege : ListSizeMatcher.inList(grantDesc.getPrivileges()).ofSize(1)) {
    Assert.assertEquals(Privilege.SELECT,privilege.getPrivilege());
  }
  Assert.assertTrue("Expected table",grantDesc.getPrivilegeSubjectDesc().getTable());
  Assert.assertEquals(TABLE_QNAME,grantDesc.getPrivilegeSubjectDesc().getObject());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * REVOKE ROLE ... FROM USER ...
 */
@Test public void testRevokeRoleUser() throws Exception {
  DDLWork work=analyze("REVOKE ROLE " + ROLE + " FROM USER "+ USER);
  GrantRevokeRoleDDL grantDesc=work.getGrantRevokeRoleDDL();
  Assert.assertNotNull("Grant should not be null",grantDesc);
  Assert.assertFalse("Did not expect grant ",grantDesc.getGrant());
  Assert.assertFalse("With admin option is not specified",grantDesc.isGrantOption());
  Assert.assertEquals(currentUser,grantDesc.getGrantor());
  Assert.assertEquals(PrincipalType.USER,grantDesc.getGrantorType());
  for (  String role : ListSizeMatcher.inList(grantDesc.getRoles()).ofSize(1)) {
    Assert.assertEquals(ROLE,role);
  }
  for (  PrincipalDesc principal : ListSizeMatcher.inList(grantDesc.getPrincipalDesc()).ofSize(1)) {
    Assert.assertEquals(PrincipalType.USER,principal.getType());
    Assert.assertEquals(USER,principal.getName());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW ROLE GRANT USER ...
 */
@Test public void testShowRoleGrantUser() throws Exception {
  DDLWork work=analyze("SHOW ROLE GRANT USER " + USER);
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.SHOW_ROLE_GRANT,roleDesc.getOperation());
  Assert.assertEquals(PrincipalType.USER,roleDesc.getPrincipalType());
  Assert.assertEquals(USER,roleDesc.getName());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * SHOW ROLE GRANT GROUP ...
 */
@Test public void testShowRoleGrantGroup() throws Exception {
  DDLWork work=analyze("SHOW ROLE GRANT GROUP " + GROUP);
  RoleDDLDesc roleDesc=work.getRoleDDLDesc();
  Assert.assertNotNull("Role should not be null",roleDesc);
  Assert.assertEquals(RoleOperation.SHOW_ROLE_GRANT,roleDesc.getOperation());
  Assert.assertEquals(PrincipalType.GROUP,roleDesc.getPrincipalType());
  Assert.assertEquals(GROUP,roleDesc.getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.authorization.plugin.sqlstd.TestOperation2Privilege </h4><pre class="type-12 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test that all enums in {@link HiveOperationType} match one map entry in
 * Operation2Privilege
 */
@Test public void checkHiveOperationTypeMatch(){
  Set<HiveOperationType> operationMapKeys=Operation2Privilege.getOperationTypes();
  for (  HiveOperationType operationType : HiveOperationType.values()) {
    if (!operationMapKeys.contains(operationType)) {
      fail("Unable to find corresponding entry in Operation2Privilege map for HiveOperationType " + operationType);
    }
  }
  assertEquals("Check if Operation2Privilege, HiveOperationType have same number of instances",operationMapKeys.size(),HiveOperationType.values().length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestConditionalResolverCommonJoin </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResolvingDriverAlias() throws Exception {
  ConditionalResolverCommonJoin resolver=new ConditionalResolverCommonJoin();
  HashMap<String,ArrayList<String>> pathToAliases=new HashMap<String,ArrayList<String>>();
  pathToAliases.put("path1",new ArrayList<String>(Arrays.asList("alias1","alias2")));
  pathToAliases.put("path2",new ArrayList<String>(Arrays.asList("alias3")));
  HashMap<String,Long> aliasToKnownSize=new HashMap<String,Long>();
  aliasToKnownSize.put("alias1",1024l);
  aliasToKnownSize.put("alias2",2048l);
  aliasToKnownSize.put("alias3",4096l);
  DDLTask task1=new DDLTask();
  task1.setId("alias2");
  DDLTask task2=new DDLTask();
  task2.setId("alias3");
  HashMap<Task<? extends Serializable>,Set<String>> taskToAliases=new LinkedHashMap<Task<? extends Serializable>,Set<String>>();
  taskToAliases.put(task1,new HashSet<String>(Arrays.asList("alias2")));
  taskToAliases.put(task2,new HashSet<String>(Arrays.asList("alias3")));
  ConditionalResolverCommonJoin.ConditionalResolverCommonJoinCtx ctx=new ConditionalResolverCommonJoin.ConditionalResolverCommonJoinCtx();
  ctx.setPathToAliases(pathToAliases);
  ctx.setTaskToAliases(taskToAliases);
  ctx.setAliasToKnownSize(aliasToKnownSize);
  HiveConf conf=new HiveConf();
  conf.setLongVar(HiveConf.ConfVars.HIVESMALLTABLESFILESIZE,4096);
  Task resolved=resolver.resolveMapJoinTask(ctx,conf);
  Assert.assertEquals("alias3",resolved.getId());
  conf.setLongVar(HiveConf.ConfVars.HIVESMALLTABLESFILESIZE,65536);
  resolved=resolver.resolveMapJoinTask(ctx,conf);
  Assert.assertEquals("alias3",resolved.getId());
  conf.setLongVar(HiveConf.ConfVars.HIVESMALLTABLESFILESIZE,2048);
  resolved=resolver.resolveMapJoinTask(ctx,conf);
  Assert.assertNull(resolved);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestReadEntityDirect </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as direct, as it is also accessed
 * directly in the join query
 * @throws ParseException
 */
@Test public void testSelectEntityViewDirectJoin() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1 join t1 on (v1.i = t1.i)");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * No views in the query so it should be a direct entity
 * @throws ParseException
 */
@Test public void testSelectEntityDirect() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from t1");
  assertEquals("Checking command success",0,ret);
  assertEquals(1,CheckInputReadEntityDirect.readEntities.size());
  assertTrue("isDirect",CheckInputReadEntityDirect.readEntities.iterator().next().isDirect());
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as indirect
 * @throws ParseException
 */
@Test public void testSelectEntityInDirect() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertFalse("not direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as direct, as it is also accessed
 * directly in the union-all query
 * @throws ParseException
 */
@Test public void testSelectEntityViewDirectUnion() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from ( select * from v1 union all select * from t1) uv1t1");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Underlying table of view should be marked as indirect. Query with join of views and aliases
 * @throws ParseException
 */
@Test public void testSelectEntityInDirectJoinAlias() throws ParseException {
  Driver driver=createDriver();
  int ret=driver.compile("select * from v1 as a join v1 as b on (a.i = b.i)");
  assertEquals("Checking command success",0,ret);
  assertEquals(2,CheckInputReadEntityDirect.readEntities.size());
  for (  ReadEntity readEntity : CheckInputReadEntityDirect.readEntities) {
    if (readEntity.getName().equals("default@t1")) {
      assertFalse("not direct",readEntity.isDirect());
    }
 else     if (readEntity.getName().equals("default@v1")) {
      assertTrue("direct",readEntity.isDirect());
    }
 else {
      fail("unexpected entity name " + readEntity.getName());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestTezWork </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBroadcastConnect() throws Exception {
  BaseWork parent=nodes.get(0);
  BaseWork child=nodes.get(1);
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.BROADCAST_EDGE);
  work.connect(parent,child,edgeProp);
  Assert.assertEquals(work.getParents(child).size(),1);
  Assert.assertEquals(work.getChildren(parent).size(),1);
  Assert.assertEquals(work.getChildren(parent).get(0),child);
  Assert.assertEquals(work.getParents(child).get(0),parent);
  Assert.assertTrue(work.getRoots().contains(parent) && !work.getRoots().contains(child));
  Assert.assertTrue(!work.getLeaves().contains(parent) && work.getLeaves().contains(child));
  for (  BaseWork w : nodes) {
    if (w == parent || w == child) {
      continue;
    }
    Assert.assertEquals(work.getParents(w).size(),0);
    Assert.assertEquals(work.getChildren(w).size(),0);
  }
  Assert.assertEquals(work.getEdgeProperty(parent,child).getEdgeType(),EdgeType.BROADCAST_EDGE);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnect() throws Exception {
  BaseWork parent=nodes.get(0);
  BaseWork child=nodes.get(1);
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.SIMPLE_EDGE);
  work.connect(parent,child,edgeProp);
  Assert.assertEquals(work.getParents(child).size(),1);
  Assert.assertEquals(work.getChildren(parent).size(),1);
  Assert.assertEquals(work.getChildren(parent).get(0),child);
  Assert.assertEquals(work.getParents(child).get(0),parent);
  Assert.assertTrue(work.getRoots().contains(parent) && !work.getRoots().contains(child));
  Assert.assertTrue(!work.getLeaves().contains(parent) && work.getLeaves().contains(child));
  for (  BaseWork w : nodes) {
    if (w == parent || w == child) {
      continue;
    }
    Assert.assertEquals(work.getParents(w).size(),0);
    Assert.assertEquals(work.getChildren(w).size(),0);
  }
  Assert.assertEquals(work.getEdgeProperty(parent,child).getEdgeType(),EdgeType.SIMPLE_EDGE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestViewEntity </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the parent entities are captured correctly for union views
 * @throws Exception
 */
@Test public void testUnionView() throws Exception {
  String prefix="tunionview" + NAME_PREFIX;
  final String tab1=prefix + "t1";
  final String tab2=prefix + "t2";
  final String view1=prefix + "v1";
  int ret=driver.run("create table " + tab1 + "(id int)").getResponseCode();
  assertEquals("Checking command success",0,ret);
  ret=driver.run("create table " + tab2 + "(id int)").getResponseCode();
  assertEquals("Checking command success",0,ret);
  ret=driver.run("create view " + view1 + " as select t.id from "+ "(select "+ tab1+ ".id from "+ tab1+ " union all select "+ tab2+ ".id from "+ tab2+ ") as t").getResponseCode();
  assertEquals("Checking command success",0,ret);
  driver.compile("select * from " + view1);
  assertEquals("default@" + view1,CheckInputReadEntity.readEntities[0].getName());
  assertEquals("default@" + tab1,CheckInputReadEntity.readEntities[1].getName());
  assertFalse("Table is not direct input",CheckInputReadEntity.readEntities[1].isDirect());
  assertEquals("default@" + view1,CheckInputReadEntity.readEntities[1].getParents().iterator().next().getName());
  assertEquals("default@" + tab2,CheckInputReadEntity.readEntities[2].getName());
  assertFalse("Table is not direct input",CheckInputReadEntity.readEntities[2].isDirect());
  assertEquals("default@" + view1,CheckInputReadEntity.readEntities[2].getParents().iterator().next().getName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that the parent entities are captured correctly for view in subquery
 * @throws Exception
 */
@Test public void testViewInSubQuery() throws Exception {
  String prefix="tvsubquery" + NAME_PREFIX;
  final String tab1=prefix + "t";
  final String view1=prefix + "v";
  int ret=driver.run("create table " + tab1 + "(id int)").getResponseCode();
  assertEquals("Checking command success",0,ret);
  ret=driver.run("create view " + view1 + " as select * from "+ tab1).getResponseCode();
  assertEquals("Checking command success",0,ret);
  driver.compile("select * from " + view1);
  assertEquals("default@" + view1,CheckInputReadEntity.readEntities[0].getName());
  assertEquals("default@" + tab1,CheckInputReadEntity.readEntities[1].getName());
  assertFalse("Table is not direct input",CheckInputReadEntity.readEntities[1].isDirect());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.processors.TestCommandProcessorFactory </h4><pre class="type-11 type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAvailableCommands() throws Exception {
  enableTestOnlyCmd(conf);
  SessionState.start(conf);
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    String cmdInLowerCase=cmd.toLowerCase();
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting()));
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmdInLowerCase},conf,command.isOnlyForTesting()));
  }
  conf.set(HiveConf.ConfVars.HIVE_SECURITY_COMMAND_WHITELIST.toString(),"");
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    try {
      CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting());
      Assert.fail("Expected SQLException for " + cmd + " as available commands is empty");
    }
 catch (    SQLException e) {
      Assert.assertEquals("Insufficient privileges to execute " + cmd,e.getMessage());
      Assert.assertEquals("42000",e.getSQLState());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.processors.TestCompileProcessor </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSyntax() throws Exception {
  CompileProcessor cp=new CompileProcessor();
  Assert.assertEquals(0,cp.run("` public class x { \n }` AS GROOVY NAMED x.groovy").getResponseCode());
  Assert.assertEquals("GROOVY",cp.getLang());
  Assert.assertEquals(" public class x { \n }",cp.getCode());
  Assert.assertEquals("x.groovy",cp.getNamed());
  Assert.assertEquals(1,cp.run("").getResponseCode());
  Assert.assertEquals(1,cp.run("bla bla ").getResponseCode());
  CompileProcessor cp2=new CompileProcessor();
  CommandProcessorResponse response=cp2.run("` import org.apache.hadoop.hive.ql.exec.UDF \n public class x { \n }` AS GROOVY NAMED x.groovy");
  Assert.assertEquals(0,response.getResponseCode());
  File f=new File(response.getErrorMessage());
  Assert.assertTrue(f.exists());
  f.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.security.FolderPermissionBase </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCtas() throws Exception {
  String testDb="ctasdb";
  String tableName="createtable";
  CommandProcessorResponse ret=driver.run("CREATE DATABASE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db");
  setPermission(warehouseDir + "/" + testDb+ ".db");
  verifyPermission(warehouseDir + "/" + testDb+ ".db");
  ret=driver.run("USE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("create table " + tableName + " as select key,value from default.mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  verifyPermission(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  Assert.assertTrue(listStatus(warehouseDir + "/" + testDb+ ".db/"+ tableName).size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + testDb+ ".db/"+ tableName)) {
    verifyPermission(child);
  }
  ret=driver.run("USE default");
  Assert.assertEquals(0,ret.getResponseCode());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoad() throws Exception {
  String tableName="load";
  String location="/hdfsPath";
  fs.copyFromLocalFile(dataFilePath,new Path(location));
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  String tableLoc=warehouseDir + "/" + tableName;
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("load data inpath '" + location + "' into table "+ tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child);
  }
  setPermission(warehouseDir + "/" + tableName,1);
  for (  String child : listStatus(tableLoc)) {
    setPermission(child,1);
  }
  fs.copyFromLocalFile(dataFilePath,new Path(location));
  ret=driver.run("load data inpath '" + location + "' overwrite into table "+ tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child,1);
  }
  tableName="loadpartition";
  ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 int, part2 int)");
  Assert.assertEquals(0,ret.getResponseCode());
  tableLoc=warehouseDir + "/" + tableName;
  assertExistence(tableLoc);
  setPermission(tableLoc);
  fs.copyFromLocalFile(dataFilePath,new Path(location));
  ret=driver.run("LOAD DATA INPATH '" + location + "' INTO TABLE "+ tableName+ " PARTITION (part1='1',part2='1')");
  Assert.assertEquals(0,ret.getResponseCode());
  String partLoc=warehouseDir + "/" + tableName+ "/part1=1/part2=1";
  Assert.assertTrue(listStatus(partLoc).size() > 0);
  for (  String child : listStatus(partLoc)) {
    verifyPermission(child);
  }
  setPermission(tableLoc,1);
  setPermission(partLoc,1);
  Assert.assertTrue(listStatus(partLoc).size() > 0);
  for (  String child : listStatus(partLoc)) {
    setPermission(child,1);
  }
  fs.copyFromLocalFile(dataFilePath,new Path(location));
  ret=driver.run("LOAD DATA INPATH '" + location + "' OVERWRITE INTO TABLE "+ tableName+ " PARTITION (part1='1',part2='1')");
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(partLoc)) {
    verifyPermission(child,1);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsertStaticSinglePartition() throws Exception {
  String tableName="singlestaticpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 string)");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " partition(part1='1') select key,value from mysrc where part1='1' and part2='1'");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=1");
  Assert.assertTrue(listStatus(warehouseDir + "/" + tableName+ "/part1=1").size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + tableName+ "/part1=1")) {
    verifyPermission(child);
  }
  setPermission(warehouseDir + "/" + tableName,1);
  setPermission(warehouseDir + "/" + tableName+ "/part1=1",1);
  ret=driver.run("insert overwrite table " + tableName + " partition(part1='1') select key,value from mysrc where part1='1' and part2='1'");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName,1);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=1",1);
  Assert.assertTrue(listStatus(warehouseDir + "/" + tableName+ "/part1=1").size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + tableName+ "/part1=1")) {
    verifyPermission(child,1);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsertStaticDualPartition() throws Exception {
  String tableName="dualstaticpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 string, part2 string)");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " partition(part1='1', part2='1') select key,value from mysrc where part1='1' and part2='1'");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=1");
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=1/part2=1");
  Assert.assertTrue(listStatus(warehouseDir + "/" + tableName+ "/part1=1/part2=1").size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + tableName+ "/part1=1/part2=1")) {
    verifyPermission(child);
  }
  setPermission(warehouseDir + "/" + tableName,1);
  setPermission(warehouseDir + "/" + tableName+ "/part1=1",1);
  setPermission(warehouseDir + "/" + tableName+ "/part1=1/part2=1",1);
  ret=driver.run("insert overwrite table " + tableName + " partition(part1='1', part2='1') select key,value from mysrc where part1='1' and part2='1'");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName,1);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=1",1);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=1/part2=1",1);
  Assert.assertTrue(listStatus(warehouseDir + "/" + tableName+ "/part1=1/part2=1").size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + tableName+ "/part1=1/part2=1")) {
    verifyPermission(child,1);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateDb() throws Exception {
  String testDb="mydb";
  String tableName="createtable";
  setPermission(warehouseDir.toString());
  verifyPermission(warehouseDir.toString());
  CommandProcessorResponse ret=driver.run("CREATE DATABASE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db");
  verifyPermission(warehouseDir + "/" + testDb+ ".db");
  ret=driver.run("USE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  ret=driver.run("insert into table " + tableName + " select key,value from default.mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  verifyPermission(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  Assert.assertTrue(listStatus(warehouseDir + "/" + testDb+ ".db/"+ tableName).size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + testDb+ ".db/"+ tableName)) {
    verifyPermission(child);
  }
  ret=driver.run("USE default");
  Assert.assertEquals(0,ret.getResponseCode());
  fs.delete(warehouseDir,true);
  fs.mkdirs(warehouseDir);
  Assert.assertEquals(listStatus(warehouseDir.toString()).size(),0);
  setupDataTable();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadLocal() throws Exception {
  String tableName="loadlocal";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  String tableLoc=warehouseDir + "/" + tableName;
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("load data local inpath '" + dataFilePath + "' into table "+ tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child);
  }
  setPermission(warehouseDir + "/" + tableName,1);
  for (  String child : listStatus(tableLoc)) {
    setPermission(child,1);
  }
  ret=driver.run("load data local inpath '" + dataFilePath + "' overwrite into table "+ tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child,1);
  }
  tableName="loadlocalpartition";
  ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 int, part2 int)");
  Assert.assertEquals(0,ret.getResponseCode());
  tableLoc=warehouseDir + "/" + tableName;
  assertExistence(tableLoc);
  setPermission(tableLoc);
  ret=driver.run("LOAD DATA LOCAL INPATH '" + dataFilePath + "' INTO TABLE "+ tableName+ " PARTITION (part1='1',part2='1')");
  Assert.assertEquals(0,ret.getResponseCode());
  String partLoc=warehouseDir + "/" + tableName+ "/part1=1/part2=1";
  Assert.assertTrue(listStatus(partLoc).size() > 0);
  for (  String child : listStatus(partLoc)) {
    verifyPermission(child);
  }
  setPermission(tableLoc,1);
  setPermission(partLoc,1);
  for (  String child : listStatus(partLoc)) {
    setPermission(child,1);
  }
  ret=driver.run("LOAD DATA LOCAL INPATH '" + dataFilePath + "' OVERWRITE INTO TABLE "+ tableName+ " PARTITION (part1='1',part2='1')");
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(partLoc)) {
    verifyPermission(child,1);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInsertNonPartTable() throws Exception {
  String tableName="nonpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  String tableLoc=warehouseDir + "/" + tableName;
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " select key,value from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName);
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child);
  }
  setPermission(warehouseDir + "/" + tableName,1);
  ret=driver.run("insert overwrite table " + tableName + " select key,value from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName,1);
  Assert.assertTrue(listStatus(tableLoc).size() > 0);
  for (  String child : listStatus(tableLoc)) {
    verifyPermission(child,1);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTable() throws Exception {
  String testDb="mydb2";
  String tableName="createtable";
  CommandProcessorResponse ret=driver.run("CREATE DATABASE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db");
  setPermission(warehouseDir + "/" + testDb+ ".db");
  verifyPermission(warehouseDir + "/" + testDb+ ".db");
  ret=driver.run("USE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("CREATE TABLE " + tableName + " (key string, value string)");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  ret=driver.run("insert into table " + tableName + " select key,value from default.mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  verifyPermission(warehouseDir + "/" + testDb+ ".db/"+ tableName);
  Assert.assertTrue(listStatus(warehouseDir + "/" + testDb+ ".db/"+ tableName).size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + testDb+ ".db/"+ tableName)) {
    verifyPermission(child);
  }
  ret=driver.run("USE default");
  Assert.assertEquals(0,ret.getResponseCode());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartition() throws Exception {
  String tableName="alterpart";
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) partitioned by (part1 int, part2 int, part3 int)");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName);
  ret=driver.run("insert into table " + tableName + " partition(part1='1',part2='1',part3='1') select key,value from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName);
  setPermission(warehouseDir + "/" + tableName,1);
  ret=driver.run("alter table " + tableName + " partition (part1='1',part2='1',part3='1') rename to partition (part1='2',part2='2',part3='2')");
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=2",1);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=2/part2=2",1);
  verifyPermission(warehouseDir + "/" + tableName+ "/part1=2/part2=2/part3=2",1);
  Assert.assertTrue(listStatus(warehouseDir + "/" + tableName+ "/part1=2/part2=2/part3=2").size() > 0);
  for (  String child : listStatus(warehouseDir + "/" + tableName+ "/part1=2/part2=2/part3=2")) {
    verifyPermission(child,1);
  }
  String tableName2="alterpart2";
  ret=driver.run("CREATE TABLE " + tableName2 + " (key string, value string) partitioned by (part1 int, part2 int, part3 int)");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + tableName2);
  setPermission(warehouseDir + "/" + tableName2);
  ret=driver.run("alter table " + tableName2 + " exchange partition (part1='2',part2='2',part3='2') with table "+ tableName);
  Assert.assertEquals(0,ret.getResponseCode());
  verifyPermission(warehouseDir + "/" + tableName2+ "/part1=2",0);
  verifyPermission(warehouseDir + "/" + tableName2+ "/part1=2/part2=2",0);
  verifyPermission(warehouseDir + "/" + tableName2+ "/part1=2/part2=2/part3=2",1);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExternalTable() throws Exception {
  String tableName="externaltable";
  String myLocation=warehouseDir + "/myfolder";
  FileSystem fs=FileSystem.get(new URI(myLocation),conf);
  fs.mkdirs(new Path(myLocation));
  setPermission(myLocation);
  CommandProcessorResponse ret=driver.run("CREATE TABLE " + tableName + " (key string, value string) LOCATION '"+ myLocation+ "'");
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("insert into table " + tableName + " select key,value from mysrc");
  Assert.assertEquals(0,ret.getResponseCode());
  Assert.assertTrue(listStatus(myLocation).size() > 0);
  for (  String child : listStatus(myLocation)) {
    verifyPermission(child);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExim() throws Exception {
  String myLocation=warehouseDir + "/exim";
  FileSystem fs=FileSystem.get(new URI(myLocation),conf);
  fs.mkdirs(new Path(myLocation));
  setPermission(myLocation);
  myLocation=myLocation + "/temp";
  CommandProcessorResponse ret=driver.run("export table mysrc to '" + myLocation + "'");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(myLocation);
  verifyPermission(myLocation);
  assertExistence(myLocation + "/part1=1/part2=1");
  verifyPermission(myLocation + "/part1=1/part2=1");
  Assert.assertTrue(listStatus(myLocation + "/part1=1/part2=1").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=1/part2=1")) {
    verifyPermission(child);
  }
  assertExistence(myLocation + "/part1=2/part2=2");
  verifyPermission(myLocation + "/part1=2/part2=2");
  Assert.assertTrue(listStatus(myLocation + "/part1=2/part2=2").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=2/part2=2")) {
    verifyPermission(child);
  }
  String testDb="eximdb";
  ret=driver.run("CREATE DATABASE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db");
  setPermission(warehouseDir + "/" + testDb+ ".db",1);
  ret=driver.run("USE " + testDb);
  Assert.assertEquals(0,ret.getResponseCode());
  ret=driver.run("import from '" + myLocation + "'");
  Assert.assertEquals(0,ret.getResponseCode());
  assertExistence(warehouseDir + "/" + testDb+ ".db/mysrc");
  verifyPermission(warehouseDir + "/" + testDb+ ".db/mysrc",1);
  myLocation=warehouseDir + "/" + testDb+ ".db/mysrc";
  assertExistence(myLocation);
  verifyPermission(myLocation,1);
  assertExistence(myLocation + "/part1=1/part2=1");
  verifyPermission(myLocation + "/part1=1/part2=1",1);
  Assert.assertTrue(listStatus(myLocation + "/part1=1/part2=1").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=1/part2=1")) {
    verifyPermission(child,1);
  }
  assertExistence(myLocation + "/part1=2/part2=2");
  verifyPermission(myLocation + "/part1=2/part2=2",1);
  Assert.assertTrue(listStatus(myLocation + "/part1=2/part2=2").size() > 0);
  for (  String child : listStatus(myLocation + "/part1=2/part2=2")) {
    verifyPermission(child,1);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.security.TestPasswordWithConfig </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassword() throws Exception {
  String key1="key1";
  String key2="key2";
  String val1="value1";
  Configuration conf=new Configuration();
  conf.set(key1,val1);
  assertEquals("key1 should exist in config",val1,ShimLoader.getHadoopShims().getPassword(conf,key1));
  assertNull("key2 should not exist in config",ShimLoader.getHadoopShims().getPassword(conf,key2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.security.TestPasswordWithCredentialProvider </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassword() throws Exception {
  if (!doesHadoopPasswordAPIExist()) {
    System.out.println("Skipping Password API test" + " because this version of hadoop-2 does not support the password API.");
    return;
  }
  String credName="my.password";
  String credName2="my.password2";
  String credName3="my.password3";
  String hiveConfPassword="conf value";
  String credPassword="cred value";
  String confOnlyPassword="abcdefg";
  String credOnlyPassword="12345";
  Configuration conf=new Configuration();
  conf.set(credName,hiveConfPassword);
  conf.set(credName2,confOnlyPassword);
  assertEquals(hiveConfPassword,conf.get(credName));
  assertEquals(confOnlyPassword,conf.get(credName2));
  assertNull("credName3 should not exist in HiveConf",conf.get(credName3));
  conf.set("hadoop.security.credential.clear-text-fallback","true");
  conf.set("hadoop.security.credential.provider.path","jceks://file/" + tmpDir.toURI().getPath() + "/test.jks");
  Class credentialProviderClass=Class.forName("org.apache.hadoop.security.alias.CredentialProvider");
  Class credentialProviderFactoryClass=Class.forName("org.apache.hadoop.security.alias.CredentialProviderFactory");
  Object provider=((List)invoke(credentialProviderFactoryClass,null,"getProviders",conf)).get(0);
  invoke(credentialProviderClass,provider,"createCredentialEntry",credName,credPassword.toCharArray());
  invoke(credentialProviderClass,provider,"createCredentialEntry",credName3,credOnlyPassword.toCharArray());
  invoke(credentialProviderClass,provider,"flush");
  assertEquals("getPassword() should use match value in credential provider",credPassword,ShimLoader.getHadoopShims().getPassword(conf,credName));
  assertEquals("getPassword() should match value from conf",confOnlyPassword,ShimLoader.getHadoopShims().getPassword(conf,credName2));
  assertEquals("getPassword() should use credential provider if conf has no value",credOnlyPassword,ShimLoader.getHadoopShims().getPassword(conf,credName3));
  assertNull("null if neither cred provider or conf have entry",ShimLoader.getHadoopShims().getPassword(conf,"nonexistentkey"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.security.authorization.plugin.TestHiveAuthorizerCheckInvocation </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputNoColumnsUsed() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("describe " + tableName);
  assertEquals(0,status);
  List<HivePrivilegeObject> inputs=getHivePrivilegeObjectInputs().getLeft();
  checkSingleTableInput(inputs);
  HivePrivilegeObject tableObj=inputs.get(0);
  assertNull("columns used",tableObj.getColumns());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempFunction() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  final String funcName="testAuthFunc2";
  int status=driver.compile("create temporary function " + funcName + " as 'org.apache.hadoop.hive.ql.udf.UDFPI'");
  assertEquals(0,status);
  List<HivePrivilegeObject> outputs=getHivePrivilegeObjectInputs().getRight();
  HivePrivilegeObject funcObj=outputs.get(0);
  assertEquals("input type",HivePrivilegeObjectType.FUNCTION,funcObj.getType());
  assertTrue("function name",funcName.equalsIgnoreCase(funcObj.getObjectName()));
  assertEquals("db name",null,funcObj.getDbname());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPermFunction() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  final String funcName="testauthfunc1";
  int status=driver.compile("create function " + dbName + "."+ funcName+ " as 'org.apache.hadoop.hive.ql.udf.UDFPI'");
  assertEquals(0,status);
  List<HivePrivilegeObject> outputs=getHivePrivilegeObjectInputs().getRight();
  HivePrivilegeObject funcObj;
  HivePrivilegeObject dbObj;
  assertEquals("number of output object",2,outputs.size());
  if (outputs.get(0).getType() == HivePrivilegeObjectType.FUNCTION) {
    funcObj=outputs.get(0);
    dbObj=outputs.get(1);
  }
 else {
    funcObj=outputs.get(1);
    dbObj=outputs.get(0);
  }
  assertEquals("input type",HivePrivilegeObjectType.FUNCTION,funcObj.getType());
  assertTrue("function name",funcName.equalsIgnoreCase(funcObj.getObjectName()));
  assertTrue("db name",dbName.equalsIgnoreCase(funcObj.getDbname()));
  assertEquals("input type",HivePrivilegeObjectType.DATABASE,dbObj.getType());
  assertTrue("db name",dbName.equalsIgnoreCase(dbObj.getDbname()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.session.TestSessionState </h4><pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReloadExistingAuxJars2(){
  HiveConf conf=new HiveConf();
  HiveConf.setVar(conf,ConfVars.HIVERELOADABLEJARS,hiveReloadPath);
  SessionState ss=new SessionState(conf);
  SessionState.start(ss);
  File dist=null;
  try {
    ss=SessionState.get();
    LOG.info("copy jar file 1");
    dist=new File(reloadFolder.getAbsolutePath() + File.separator + reloadClazzFileName);
    Files.copy(new File(HiveTestUtils.getFileFromClasspath(clazzDistFileName)),dist);
    ss.reloadAuxJars();
    Assert.assertEquals("version1",getReloadedClazzVersion(ss.getConf().getClassLoader()));
    LOG.info("copy jar file 2");
    FileUtils.deleteQuietly(dist);
    Files.copy(new File(HiveTestUtils.getFileFromClasspath(clazzV2FileName)),dist);
    ss.reloadAuxJars();
    Assert.assertEquals("version2",getReloadedClazzVersion(ss.getConf().getClassLoader()));
    FileUtils.deleteQuietly(dist);
    ss.reloadAuxJars();
  }
 catch (  Exception e) {
    LOG.error("refresh existing jar file case failed with message: ",e);
    Assert.fail(e.getMessage());
  }
 finally {
    FileUtils.deleteQuietly(dist);
    try {
      ss.close();
    }
 catch (    IOException ioException) {
      Assert.fail(ioException.getMessage());
      LOG.error("Fail to close the created session: ",ioException);
    }
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp(){
  HiveConf conf=new HiveConf();
  String tmp=System.getProperty("java.io.tmpdir");
  File tmpDir=new File(tmp);
  if (!tmpDir.exists()) {
    tmpDir.mkdir();
  }
  hiveReloadPath=Files.createTempDir().getAbsolutePath();
  reloadFolder=new File(hiveReloadPath);
  if (!reloadFolder.exists()) {
    reloadFolder.mkdir();
  }
  try {
    generateRefreshJarFiles(V2);
    generateRefreshJarFiles(V1);
  }
 catch (  Throwable e) {
    Assert.fail("fail to generate refresh jar file due to the error " + e);
  }
  if (prewarm) {
    HiveConf.setBoolVar(conf,ConfVars.HIVE_PREWARM_ENABLED,true);
    HiveConf.setIntVar(conf,ConfVars.HIVE_PREWARM_NUM_CONTAINERS,1);
  }
  SessionState.start(conf);
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReloadAuxJars2(){
  HiveConf conf=new HiveConf();
  HiveConf.setVar(conf,ConfVars.HIVERELOADABLEJARS,hiveReloadPath);
  SessionState ss=new SessionState(conf);
  SessionState.start(ss);
  ss=SessionState.get();
  File dist=null;
  try {
    dist=new File(reloadFolder.getAbsolutePath() + File.separator + reloadClazzFileName);
    Files.copy(new File(HiveTestUtils.getFileFromClasspath(clazzDistFileName)),dist);
    ss.reloadAuxJars();
    Assert.assertEquals("version1",getReloadedClazzVersion(ss.getConf().getClassLoader()));
  }
 catch (  Exception e) {
    LOG.error("Reload auxiliary jar test fail with message: ",e);
    Assert.fail(e.getMessage());
  }
 finally {
    FileUtils.deleteQuietly(dist);
    try {
      ss.close();
    }
 catch (    IOException ioException) {
      Assert.fail(ioException.getMessage());
      LOG.error("Fail to close the created session: ",ioException);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCleaner </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMajorPartitionCompactionNoBase() throws Exception {
  Table t=newTable("default","campcnb",true);
  Partition p=newPartition(t,"today");
  addDeltaFile(t,p,1L,22L,22);
  addDeltaFile(t,p,23L,24L,2);
  addBaseFile(t,p,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","campcnb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notBlockedBySubsequentLock() throws Exception {
  Table t=newTable("default","bblt",false);
  conf.setTimeVar(HiveConf.ConfVars.HIVE_COMPACTOR_CLEANER_RUN_INTERVAL,100,TimeUnit.MILLISECONDS);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addDeltaFile(t,null,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","bblt",CompactionType.MINOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  LockComponent comp=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"default");
  comp.setTablename("bblt");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  LockResponse res=txnHandler.lock(req);
  AtomicBoolean looped=new AtomicBoolean();
  looped.set(false);
  startCleaner(looped);
  while (!looped.get()) {
    Thread.currentThread().sleep(100);
  }
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  LockComponent comp2=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"default");
  comp2.setTablename("bblt");
  List<LockComponent> components2=new ArrayList<LockComponent>(1);
  components2.add(comp2);
  LockRequest req2=new LockRequest(components,"me","localhost");
  LockResponse res2=txnHandler.lock(req2);
  txnHandler.unlock(new UnlockRequest(res.getLockid()));
  looped.set(false);
  while (!looped.get()) {
    Thread.currentThread().sleep(100);
  }
  stopThread();
  Thread.currentThread().sleep(200);
  rsp=txnHandler.showCompact(new ShowCompactRequest());
  compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void partitionNotBlockedBySubsequentLock() throws Exception {
  Table t=newTable("default","bblt",true);
  Partition p=newPartition(t,"today");
  conf.setTimeVar(HiveConf.ConfVars.HIVE_COMPACTOR_CLEANER_RUN_INTERVAL,100,TimeUnit.MILLISECONDS);
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addDeltaFile(t,p,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","bblt",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  LockComponent comp=new LockComponent(LockType.SHARED_READ,LockLevel.PARTITION,"default");
  comp.setTablename("bblt");
  comp.setPartitionname("ds=today");
  List<LockComponent> components=new ArrayList<LockComponent>(1);
  components.add(comp);
  LockRequest req=new LockRequest(components,"me","localhost");
  LockResponse res=txnHandler.lock(req);
  AtomicBoolean looped=new AtomicBoolean();
  looped.set(false);
  startCleaner(looped);
  while (!looped.get()) {
    Thread.currentThread().sleep(100);
  }
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  LockComponent comp2=new LockComponent(LockType.SHARED_READ,LockLevel.PARTITION,"default");
  comp2.setTablename("bblt");
  comp2.setPartitionname("ds=today");
  List<LockComponent> components2=new ArrayList<LockComponent>(1);
  components2.add(comp2);
  LockRequest req2=new LockRequest(components,"me","localhost");
  LockResponse res2=txnHandler.lock(req2);
  txnHandler.unlock(new UnlockRequest(res.getLockid()));
  looped.set(false);
  while (!looped.get()) {
    Thread.currentThread().sleep(100);
  }
  stopThread();
  Thread.currentThread().sleep(200);
  rsp=txnHandler.showCompact(new ShowCompactRequest());
  compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void droppedPartition() throws Exception {
  Table t=newTable("default","dp",true);
  Partition p=newPartition(t,"today");
  addDeltaFile(t,p,1L,22L,22);
  addDeltaFile(t,p,23L,24L,2);
  addBaseFile(t,p,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","dp",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  ms.dropPartition("default","dp",Collections.singletonList("today"),true);
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMajorPartitionCompaction() throws Exception {
  Table t=newTable("default","campc",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addBaseFile(t,p,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","campc",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMajorTableCompaction() throws Exception {
  Table t=newTable("default","camtc",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addBaseFile(t,null,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camtc",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorTableCompaction() throws Exception {
  Table t=newTable("default","camitc",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addDeltaFile(t,null,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camitc",CompactionType.MINOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path p : paths) {
    if (p.getName().equals("base_20"))     sawBase=true;
 else     if (p.getName().equals(makeDeltaDirName(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + p.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void droppedTable() throws Exception {
  Table t=newTable("default","dt",false);
  addDeltaFile(t,null,1L,22L,22);
  addDeltaFile(t,null,23L,24L,2);
  addBaseFile(t,null,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","dt",CompactionType.MINOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  ms.dropTable("default","dt");
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorPartitionCompaction() throws Exception {
  Table t=newTable("default","camipc",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addDeltaFile(t,p,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camipc",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path path : paths) {
    if (path.getName().equals("base_20"))     sawBase=true;
 else     if (path.getName().equals(makeDeltaDirNameCompacted(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + path.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCompactor </h4><pre class="type-11 type-12 type-3 type-5 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * After each major compaction, stats need to be updated on each column of the
 * table/partition which previously had stats.
 * 1. create a bucketed ORC backed table (Orc is currently required by ACID)
 * 2. populate 2 partitions with data
 * 3. compute stats
 * 4. insert some data into the table using StreamingAPI
 * 5. Trigger major compaction (which should update stats)
 * 6. check that stats have been updated
 * @throws Exceptiontodo:
 * 2. add non-partitioned test
 * 4. add a test with sorted table?
 */
@Test public void testStatsAfterCompactionPartTbl() throws Exception {
  String tblName="compaction_test";
  String tblNameStg=tblName + "_stg";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("drop table if exists " + tblNameStg,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(bkt INT)"+ " CLUSTERED BY(a) INTO 4 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("CREATE EXTERNAL TABLE " + tblNameStg + "(a INT, b STRING)"+ " ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t' LINES TERMINATED BY '\\n'"+ " STORED AS TEXTFILE"+ " LOCATION '"+ stagingFolder.newFolder().toURI().getPath()+ "'"+ " TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("load data local inpath '" + BASIC_FILE_NAME + "' overwrite into table "+ tblNameStg,driver);
  execSelectAndDumpData("select * from " + tblNameStg,driver,"Dumping data for " + tblNameStg + " after load:");
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=0) "+ "SELECT a, b where a < 2",driver);
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=1) "+ "SELECT a, b where a >= 2",driver);
  execSelectAndDumpData("select * from " + tblName,driver,"Dumping data for " + tblName + " after load:");
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  CompactionInfo ci=new CompactionInfo("default",tblName,"bkt=0",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  Worker.StatsUpdater su=Worker.StatsUpdater.init(ci,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  CompactionInfo ciPart2=new CompactionInfo("default",tblName,"bkt=1",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  su=Worker.StatsUpdater.init(ciPart2,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  Map<String,List<ColumnStatisticsObj>> stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  List<ColumnStatisticsObj> colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  LongColumnStatsData colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",1,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",1,colAStats.getNumDVs());
  StringColumnStatsData colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",3,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",3.0,colBStats.getAvgColLen(),0.01);
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",2,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  LongColumnStatsData colAStatsPart2=colStats.get(0).getStatsData().getLongStats();
  StringColumnStatsData colBStatsPart2=colStats.get(1).getStatsData().getStringStats();
  HiveEndPoint endPt=new HiveEndPoint(null,ci.dbname,ci.tableName,Arrays.asList("0"));
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(true);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  Assert.assertEquals(TransactionBatch.TxnState.OPEN,txnBatch.getCurrentTransactionState());
  txnBatch.write("50,Kiev".getBytes());
  txnBatch.write("51,St. Petersburg".getBytes());
  txnBatch.write("44,Boston".getBytes());
  txnBatch.commit();
  txnBatch.beginNextTransaction();
  txnBatch.write("52,Tel Aviv".getBytes());
  txnBatch.write("53,Atlantis".getBytes());
  txnBatch.write("53,Boston".getBytes());
  txnBatch.commit();
  txnBatch.close();
  connection.close();
  execSelectAndDumpData("select * from " + ci.getFullTableName(),driver,ci.getFullTableName());
  CompactionRequest rqst=new CompactionRequest(ci.dbname,ci.tableName,CompactionType.MAJOR);
  rqst.setPartitionname(ci.partName);
  txnHandler.compact(rqst);
  Worker t=new Worker();
  t.setThreadId((int)t.getId());
  t.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  t.init(stop,looped);
  t.run();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  if (1 != compacts.size()) {
    Assert.fail("Expecting 1 file and found " + compacts.size() + " files "+ compacts.toString());
  }
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",53,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",6,colAStats.getNumDVs());
  colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",14,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",(long)6.1111111111,(long)colBStats.getAvgColLen());
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",10,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colAStatsPart2,colStats.get(0).getStatsData().getLongStats());
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colBStatsPart2,colStats.get(1).getStatsData().getStringStats());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true') ",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000004\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    Assert.assertEquals(name,"base_0000004");
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestInitiator </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recoverFailedLocalWorkers() throws Exception {
  Table t=newTable("default","rflw1",false);
  CompactionRequest rqst=new CompactionRequest("default","rflw1",CompactionType.MINOR);
  txnHandler.compact(rqst);
  t=newTable("default","rflw2",false);
  rqst=new CompactionRequest("default","rflw2",CompactionType.MINOR);
  txnHandler.compact(rqst);
  txnHandler.findNextToCompact(Worker.hostname() + "-193892");
  txnHandler.findNextToCompact("nosuchhost-193892");
  startInitiator();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  boolean sawInitiated=false;
  for (  ShowCompactResponseElement c : compacts) {
    if (c.getState().equals("working")) {
      Assert.assertEquals("nosuchhost-193892",c.getWorkerid());
    }
 else     if (c.getState().equals("initiated")) {
      sawInitiated=true;
    }
 else {
      Assert.fail("Unexpected state");
    }
  }
  Assert.assertTrue(sawInitiated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestWorker </h4><pre class="type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringableList() throws Exception {
  CompactorMR.StringableList ls=new CompactorMR.StringableList();
  String s=ls.toString();
  Assert.assertEquals("0:",s);
  ls=new CompactorMR.StringableList(s);
  Assert.assertEquals(0,ls.size());
  ls=new CompactorMR.StringableList();
  ls.add(new Path("/tmp"));
  ls.add(new Path("/usr"));
  s=ls.toString();
  Assert.assertTrue("Expected 2:4:/tmp4:/usr or 2:4:/usr4:/tmp, got " + s,"2:4:/tmp4:/usr".equals(s) || "2:4:/usr4:/tmp".equals(s));
  ls=new CompactorMR.StringableList(s);
  Assert.assertEquals(2,ls.size());
  boolean sawTmp=false, sawUsr=false;
  for (  Path p : ls) {
    if ("/tmp".equals(p.toString()))     sawTmp=true;
 else     if ("/usr".equals(p.toString()))     sawUsr=true;
 else     Assert.fail("Unexpected path " + p.toString());
  }
  Assert.assertTrue(sawTmp);
  Assert.assertTrue(sawUsr);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableWithBase() throws Exception {
  LOG.debug("Starting minorTableWithBase");
  Table t=newTable("default","mtwb",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mtwb",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBase() throws Exception {
  LOG.debug("Starting majorPartitionWithBase");
  Table t=newTable("default","mapwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mapwb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void droppedTable() throws Exception {
  Table t=newTable("default","dt",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(4);
  CompactionRequest rqst=new CompactionRequest("default","dt",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  ms.dropTable("default","dt");
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(compacts.get(0).getState()));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorPartitionWithBase() throws Exception {
  Table t=newTable("default","mpwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mpwb",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableLegacy() throws Exception {
  LOG.debug("Starting minorTableLegacy");
  Table t=newTable("default","mtl",false);
  addLegacyFile(t,null,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mtl",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void inputSplitNullBase() throws Exception {
  String delta1="/warehouse/foo/delta_2_3";
  String delta2="/warehouse/foo/delta_4_7";
  HiveConf conf=new HiveConf();
  Path file=new Path(System.getProperty("java.io.tmpdir") + System.getProperty("file.separator") + "newWriteInputSplitTest");
  FileSystem fs=FileSystem.get(conf);
  FSDataOutputStream os=fs.create(file);
  for (int i=0; i < 10; i++) {
    os.writeBytes("mary had a little lamb its fleece was white as snow\n");
  }
  os.close();
  List<Path> files=new ArrayList<Path>(1);
  files.add(file);
  Path[] deltas=new Path[2];
  deltas[0]=new Path(delta1);
  deltas[1]=new Path(delta2);
  CompactorMR.CompactorInputSplit split=new CompactorMR.CompactorInputSplit(conf,3,files,null,deltas);
  ByteArrayOutputStream buf=new ByteArrayOutputStream();
  DataOutput out=new DataOutputStream(buf);
  split.write(out);
  split=new CompactorMR.CompactorInputSplit();
  DataInput in=new DataInputStream(new ByteArrayInputStream(buf.toByteArray()));
  split.readFields(in);
  Assert.assertEquals(3,split.getBucket());
  Assert.assertNull(split.getBaseDir());
  deltas=split.getDeltaDirs();
  Assert.assertEquals(2,deltas.length);
  Assert.assertEquals(delta1,deltas[0].toString());
  Assert.assertEquals(delta2,deltas[1].toString());
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorTableNoBase() throws Exception {
  LOG.debug("Starting minorTableWithBase");
  Table t=newTable("default","mtnb",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(5);
  CompactionRequest rqst=new CompactionRequest("default","mtnb",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(3,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(1,4))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBaseMissingBuckets() throws Exception {
  LOG.debug("Starting majorPartitionWithBaseMissingBuckets");
  Table t=newTable("default","mapwbmb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20,2,false);
  addDeltaFile(t,p,21L,22L,2,2,false);
  addDeltaFile(t,p,23L,26L,4);
  burnThroughTransactions(27);
  CompactionRequest rqst=new CompactionRequest("default","mapwbmb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000026")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(("bucket_00000".equals(buckets[0].getPath().getName()) && 104L == buckets[0].getLen() && "bucket_00001".equals(buckets[1].getPath().getName()) && 676L == buckets[1].getLen()) || ("bucket_00000".equals(buckets[1].getPath().getName()) && 104L == buckets[1].getLen() && "bucket_00001".equals(buckets[0].getPath().getName()) && 676L == buckets[0].getLen()));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableWithBase() throws Exception {
  LOG.debug("Starting majorTableWithBase");
  Table t=newTable("default","matwb",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","matwb",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-12 type-3 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringableMap() throws Exception {
  CompactorMR.StringableMap m=new CompactorMR.StringableMap(new HashMap<String,String>());
  String s=m.toString();
  Assert.assertEquals("0:",s);
  m=new CompactorMR.StringableMap(s);
  Assert.assertEquals(0,m.size());
  Map<String,String> base=new HashMap<String,String>();
  base.put("mary","poppins");
  base.put("bert",null);
  base.put(null,"banks");
  m=new CompactorMR.StringableMap(base);
  s=m.toString();
  m=new CompactorMR.StringableMap(s);
  Assert.assertEquals(3,m.size());
  Map<String,Boolean> saw=new HashMap<String,Boolean>(3);
  saw.put("mary",false);
  saw.put("bert",false);
  saw.put(null,false);
  for (  Map.Entry<String,String> e : m.entrySet()) {
    saw.put(e.getKey(),true);
    if ("mary".equals(e.getKey()))     Assert.assertEquals("poppins",e.getValue());
 else     if ("bert".equals(e.getKey()))     Assert.assertNull(e.getValue());
 else     if (null == e.getKey())     Assert.assertEquals("banks",e.getValue());
 else     Assert.fail("Unexpected value " + e.getKey());
  }
  Assert.assertEquals(3,saw.size());
  Assert.assertTrue(saw.get("mary"));
  Assert.assertTrue(saw.get("bert"));
  Assert.assertTrue(saw.get(null));
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableLegacy() throws Exception {
  LOG.debug("Starting majorTableLegacy");
  Table t=newTable("default","matl",false);
  addLegacyFile(t,null,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","matl",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void droppedPartition() throws Exception {
  Table t=newTable("default","dp",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","dp",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  ms.dropPartition("default","dp",Collections.singletonList("today"),true);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
}

</code></pre>

<br>
<pre class="type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorTableNoBase() throws Exception {
  LOG.debug("Starting majorTableNoBase");
  Table t=newTable("default","matnb",false);
  addDeltaFile(t,null,1L,2L,2);
  addDeltaFile(t,null,3L,4L,2);
  burnThroughTransactions(4);
  CompactionRequest rqst=new CompactionRequest("default","matnb",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(3,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000004")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(104L,buckets[0].getLen());
      Assert.assertEquals(104L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.TestBlockedUdf </h4><pre class="type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that UDF in blacklist can't be accessed
 * @throws Exception
 */
@Test(expected=SemanticException.class) public void testUdfInBlackList() throws Exception {
  FunctionRegistry.setupPermissionsForBuiltinUDFs("","reflect");
  assertEquals("reflect",FunctionRegistry.getFunctionInfo("reflect").getDisplayName());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that UDF in whitelist and blacklist can't be accessed
 * @throws Exception
 */
@Test(expected=SemanticException.class) public void testUdfInBlackAndWhiteList() throws Exception {
  FunctionRegistry.setupPermissionsForBuiltinUDFs("reflect","reflect");
  assertEquals("reflect",FunctionRegistry.getFunctionInfo("reflect").getDisplayName());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that UDF not in whitelist can't be accessed
 * @throws Exception
 */
@Test(expected=SemanticException.class) public void testUdfNotInWhiteList() throws Exception {
  Set<String> funcNames=FunctionRegistry.getFunctionNames();
  funcNames.remove("reflect");
  FunctionRegistry.setupPermissionsForBuiltinUDFs(funcNames.toString(),"");
  assertEquals("reflect",FunctionRegistry.getFunctionInfo("reflect").getDisplayName());
}

</code></pre>

<br>
<pre class="type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test malformatted udf  list setting
 */
@Test(expected=SemanticException.class) public void testMalformattedListProperty() throws Exception {
  FunctionRegistry.setupPermissionsForBuiltinUDFs(",,"," ,reflect,");
  assertEquals("reflect",FunctionRegistry.getFunctionInfo("reflect").getDisplayName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.TestToInteger </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextToInteger() throws Exception {
  UDFToInteger ti=new UDFToInteger();
  Text t1=new Text("-1");
  IntWritable i1=ti.evaluate(t1);
  assertEquals(-1,i1.get());
  Text t2=new Text("0");
  IntWritable i2=ti.evaluate(t2);
  assertEquals(0,i2.get());
  Text t3=new Text("A");
  IntWritable i3=ti.evaluate(t3);
  assertNull(i3);
  Text t4=new Text("1.1");
  IntWritable i4=ti.evaluate(t4);
  assertEquals(1,i4.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.generic.TestGenericUDFMacro </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUDF() throws Exception {
  udf=new GenericUDFMacro(name,bodyDesc,colNames,colTypes);
  udf.initialize(inspectors);
  Object actual=udf.evaluate(arguments);
  Assert.assertEquals(bodyDesc.getValue(),((IntWritable)actual).get());
  Assert.assertTrue(udf.isDeterministic());
  Assert.assertFalse(udf.isStateful());
  Assert.assertEquals(name,udf.getMacroName());
  Assert.assertEquals(bodyDesc,udf.getBody());
  Assert.assertEquals(colNames,udf.getColNames());
  Assert.assertEquals(colTypes,udf.getColTypes());
  Assert.assertEquals(name + "(x, y)",udf.getDisplayString(new String[]{"x","y"}));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.xml.TestReusableStringReader </h4><pre class="type-11 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkReset() throws IOException {
  Reader reader=new ReusableStringReader();
  if (reader.markSupported()) {
    ((ReusableStringReader)reader).set(fox);
    assertTrue(reader.ready());
    char[] cc=new char[6];
    int read;
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("Quick ",new String(cc));
    reader.mark(100);
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("brown ",new String(cc));
    reader.reset();
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("brown ",new String(cc));
  }
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.xml.TestUDFXPathUtil </h4><pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEvalPositive(){
  UDFXPathUtil util=new UDFXPathUtil();
  Object result=util.eval("<a><b>b1</b><b>b2</b><b>b3</b><c>c1</c><c>c2</c></a>","a/c[2]/text()",XPathConstants.STRING);
  assertEquals("c2",result);
  result=util.evalBoolean("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>c2</c></a>","a/b[1]/text()");
  assertEquals(Boolean.TRUE,result);
  result=util.evalBoolean("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>c2</c></a>","a/b[4]");
  assertEquals(Boolean.FALSE,result);
  result=util.evalString("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>c2</c></a>","a/b[3]/text()");
  assertEquals("b3",result);
  result=util.evalString("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>c2</c></a>","a/b[4]/text()");
  assertEquals("",result);
  result=util.evalString("<a><b>true</b><b k=\"foo\">FALSE</b><b>b3</b><c>c1</c><c>c2</c></a>","a/b[2]/@k");
  assertEquals("foo",result);
  result=util.evalNumber("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>-77</c></a>","a/c[2]");
  assertEquals(-77.0d,result);
  result=util.evalNumber("<a><b>true</b><b k=\"foo\">FALSE</b><b>b3</b><c>c1</c><c>c2</c></a>","a/b[2]/@k");
  assertEquals(Double.NaN,result);
  result=util.evalNode("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>-77</c></a>","a/c[2]");
  assertNotNull(result);
  assertTrue(result instanceof Node);
  result=util.evalNodeList("<a><b>true</b><b>false</b><b>b3</b><c>c1</c><c>-77</c></a>","a/*");
  assertNotNull(result);
  assertTrue(result instanceof NodeList);
  assertEquals(5,((NodeList)result).getLength());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.TestColumnProjectionUtils </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadColumnIds(){
  List<Integer> columnIds=new ArrayList<Integer>();
  List<Integer> actual;
  assertEquals(Collections.EMPTY_LIST,ColumnProjectionUtils.getReadColumnIDs(conf));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  ColumnProjectionUtils.appendReadColumns(conf,columnIds);
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  assertFalse(ColumnProjectionUtils.isReadAllColumns(conf));
  columnIds.add(1);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(1));
  assertEquals(columnIds,ColumnProjectionUtils.getReadColumnIDs(conf));
  columnIds.add(2);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(2));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  columnIds.add(3);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(3));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  assertFalse(ColumnProjectionUtils.isReadAllColumns(conf));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeprecatedMethods(){
  List<Integer> columnIds=new ArrayList<Integer>();
  List<Integer> actual;
  assertEquals(Collections.EMPTY_LIST,ColumnProjectionUtils.getReadColumnIDs(conf));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  ColumnProjectionUtils.setReadColumnIDs(conf,columnIds);
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  columnIds.add(1);
  ColumnProjectionUtils.setReadColumnIDs(conf,Collections.singletonList(1));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  columnIds.add(2);
  ColumnProjectionUtils.appendReadColumnIDs(conf,Collections.singletonList(2));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  assertFalse(ColumnProjectionUtils.isReadAllColumns(conf));
  ColumnProjectionUtils.setFullyReadColumns(conf);
  assertTrue(ColumnProjectionUtils.isReadAllColumns(conf));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAllColumns(){
  assertTrue(ColumnProjectionUtils.isReadAllColumns(conf));
  ColumnProjectionUtils.appendReadColumns(conf,Arrays.asList(new Integer[]{0,1,2}));
  ColumnProjectionUtils.setReadAllColumns(conf);
  assertEquals(Collections.EMPTY_LIST,ColumnProjectionUtils.getReadColumnIDs(conf));
  assertTrue(ColumnProjectionUtils.isReadAllColumns(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroDeserializer </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeMapsWithJavaLangStringKeys() throws IOException, SerDeException {
  String schemaString="{\n" + "  \"namespace\": \"testing\",\n" + "  \"name\": \"oneMap\",\n"+ "  \"type\": \"record\",\n"+ "  \"fields\": [\n"+ "    {\n"+ "      \"name\":\"aMap\",\n"+ "      \"type\":{\"type\":\"map\",\n"+ "      \"avro.java.string\":\"String\",\n"+ "      \"values\":\"long\"}\n"+ "\t}\n"+ "  ]\n"+ "}";
  Schema s=AvroSerdeUtils.getSchemaFor(schemaString);
  GenericData.Record record=new GenericData.Record(s);
  Map<String,Long> m=new Hashtable<String,Long>();
  m.put("one",1l);
  m.put("two",2l);
  m.put("three",3l);
  record.put("aMap",m);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theMapObject=row.get(0);
  assertTrue(theMapObject instanceof Map);
  Map theMap=(Map)theMapObject;
  assertEquals(1l,theMap.get("one"));
  assertEquals(2l,theMap.get("two"));
  assertEquals(3l,theMap.get("three"));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List z=oi.getStructFieldsDataAsList(row);
  assertEquals(1,z.size());
  StructField fieldRef=oi.getStructFieldRef("amap");
  Map theMap2=(Map)oi.getStructFieldData(row,fieldRef);
  assertEquals(1l,theMap2.get("one"));
  assertEquals(2l,theMap2.get("two"));
  assertEquals(3l,theMap2.get("three"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeEnums() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.ENUM_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  record.put("baddies",new GenericData.EnumSymbol(s.getField("baddies").schema(),"DALEKS"));
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  assertEquals(1,fieldRefs.size());
  StructField fieldRef=fieldRefs.get(0);
  assertEquals("baddies",fieldRef.getFieldName());
  Object theStringObject=oi.getStructFieldData(row,fieldRef);
  assertTrue(fieldRef.getFieldObjectInspector() instanceof StringObjectInspector);
  StringObjectInspector soi=(StringObjectInspector)fieldRef.getFieldObjectInspector();
  String finalValue=soi.getPrimitiveJavaObject(theStringObject);
  assertEquals("DALEKS",finalValue);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeBytes() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.BYTES_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  byte[] bytes="ANANCIENTBLUEBOX".getBytes();
  ByteBuffer bb=ByteBuffer.wrap(bytes);
  bb.rewind();
  record.put("bytesField",bb);
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object byteObject=row.get(0);
  assertTrue(byteObject instanceof byte[]);
  byte[] outBytes=(byte[])byteObject;
  for (int i=0; i < bytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef("bytesField");
  outBytes=(byte[])oi.getStructFieldData(row,fieldRef);
  for (int i=0; i < outBytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeVoidType() throws IOException, SerDeException {
  String schemaString="{\n" + "  \"type\": \"record\", \n" + "  \"name\": \"nullTest\",\n"+ "  \"fields\" : [\n"+ "    {\"name\": \"isANull\", \"type\": \"null\"}\n"+ "  ]\n"+ "}";
  Schema s=AvroSerdeUtils.getSchemaFor(schemaString);
  GenericData.Record record=new GenericData.Record(s);
  record.put("isANull",null);
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theVoidObject=row.get(0);
  assertNull(theVoidObject);
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  StructField fieldRef=oi.getStructFieldRef("isANull");
  Object shouldBeNull=oi.getStructFieldData(row,fieldRef);
  assertNull(shouldBeNull);
  assertTrue(fieldRef.getFieldObjectInspector() instanceof VoidObjectInspector);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeFixed() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.FIXED_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  byte[] bytes="ANANCIENTBLUEBOX".getBytes();
  record.put("hash",new GenericData.Fixed(s,bytes));
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object byteObject=row.get(0);
  assertTrue(byteObject instanceof byte[]);
  byte[] outBytes=(byte[])byteObject;
  for (int i=0; i < bytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef("hash");
  outBytes=(byte[])oi.getStructFieldData(row,fieldRef);
  for (int i=0; i < outBytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeEvolvedUnions2() throws SerDeException, IOException {
  Schema ws=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_3);
  Schema rs=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_4);
  GenericData.Record record=new GenericData.Record(ws);
  record.put("aUnion",90);
  ResultPair result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(90,result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(0,uoi.getTag(result.unionObject));
  record=new GenericData.Record(ws);
  record.put("aUnion",99.9f);
  result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Float);
  assertEquals(99.9f,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeEvolvedUnions1() throws SerDeException, IOException {
  Schema ws=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA);
  Schema rs=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_2);
  GenericData.Record record=new GenericData.Record(ws);
  record.put("aUnion","this is a string");
  ResultPair result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof String);
  assertEquals("this is a string",result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(2,uoi.getTag(result.unionObject));
  record=new GenericData.Record(ws);
  record.put("aUnion",99);
  result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(99,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeArrays() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.ARRAY_WITH_PRIMITIVE_ELEMENT_TYPE);
  GenericData.Record record=new GenericData.Record(s);
  List<String> list=new ArrayList<String>();
  list.add("Eccleston");
  list.add("Tennant");
  list.add("Smith");
  record.put("anArray",list);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("Array-backed record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theArrayObject=row.get(0);
  assertTrue(theArrayObject instanceof List);
  List theList=(List)theArrayObject;
  assertEquals("Eccleston",theList.get(0));
  assertEquals("Tennant",theList.get(1));
  assertEquals("Smith",theList.get(2));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  StructField fieldRefToArray=oi.getStructFieldRef("anArray");
  Object anArrayData=oi.getStructFieldData(row,fieldRefToArray);
  StandardListObjectInspector anArrayOI=(StandardListObjectInspector)fieldRefToArray.getFieldObjectInspector();
  assertEquals(3,anArrayOI.getListLength(anArrayData));
  JavaStringObjectInspector elementOI=(JavaStringObjectInspector)anArrayOI.getListElementObjectInspector();
  Object firstElement=anArrayOI.getListElement(anArrayData,0);
  assertEquals("Eccleston",elementOI.getPrimitiveJavaObject(firstElement));
  assertTrue(firstElement instanceof String);
  Object secondElement=anArrayOI.getListElement(anArrayData,1);
  assertEquals("Tennant",elementOI.getPrimitiveJavaObject(secondElement));
  assertTrue(secondElement instanceof String);
  Object thirdElement=anArrayOI.getListElement(anArrayData,2);
  assertEquals("Smith",elementOI.getPrimitiveJavaObject(thirdElement));
  assertTrue(thirdElement instanceof String);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeMapWithNullablePrimitiveValues() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.MAP_WITH_NULLABLE_PRIMITIVE_VALUE_TYPE_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  Map<String,Long> m=new HashMap<String,Long>();
  m.put("one",1l);
  m.put("two",2l);
  m.put("three",3l);
  m.put("mu",null);
  record.put("aMap",m);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theMapObject=row.get(0);
  assertTrue(theMapObject instanceof Map);
  Map theMap=(Map)theMapObject;
  assertEquals(1l,theMap.get("one"));
  assertEquals(2l,theMap.get("two"));
  assertEquals(3l,theMap.get("three"));
  assertTrue(theMap.containsKey("mu"));
  assertEquals(null,theMap.get("mu"));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List z=oi.getStructFieldsDataAsList(row);
  assertEquals(1,z.size());
  StructField fieldRef=oi.getStructFieldRef("amap");
  Map theMap2=(Map)oi.getStructFieldData(row,fieldRef);
  assertEquals(1l,theMap2.get("one"));
  assertEquals(2l,theMap2.get("two"));
  assertEquals(3l,theMap2.get("three"));
  assertTrue(theMap2.containsKey("mu"));
  assertEquals(null,theMap2.get("mu"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeUnions() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  record.put("aUnion","this is a string");
  ResultPair result=unionTester(s,record);
  assertTrue(result.value instanceof String);
  assertEquals("this is a string",result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
  record=new GenericData.Record(s);
  record.put("aUnion",99);
  result=unionTester(s,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(99,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(0,uoi.getTag(result.unionObject));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeMapsWithPrimitiveKeys() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.MAP_WITH_PRIMITIVE_VALUE_TYPE);
  GenericData.Record record=new GenericData.Record(s);
  Map<String,Long> m=new Hashtable<String,Long>();
  m.put("one",1l);
  m.put("two",2l);
  m.put("three",3l);
  record.put("aMap",m);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theMapObject=row.get(0);
  assertTrue(theMapObject instanceof Map);
  Map theMap=(Map)theMapObject;
  assertEquals(1l,theMap.get("one"));
  assertEquals(2l,theMap.get("two"));
  assertEquals(3l,theMap.get("three"));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List z=oi.getStructFieldsDataAsList(row);
  assertEquals(1,z.size());
  StructField fieldRef=oi.getStructFieldRef("amap");
  Map theMap2=(Map)oi.getStructFieldData(row,fieldRef);
  assertEquals(1l,theMap2.get("one"));
  assertEquals(2l,theMap2.get("two"));
  assertEquals(3l,theMap2.get("three"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyCaching() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.RECORD_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  GenericData.Record innerRecord=new GenericData.Record(s.getField("aRecord").schema());
  innerRecord.put("int1",42);
  innerRecord.put("boolean1",true);
  innerRecord.put("long1",42432234234l);
  record.put("aRecord",innerRecord);
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  UID recordReaderID=new UID();
  garw.setRecordReaderID(recordReaderID);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,de.getNoEncodingNeeded().size());
  assertEquals(0,de.getReEncoderCache().size());
  row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,de.getNoEncodingNeeded().size());
  assertEquals(0,de.getReEncoderCache().size());
  garw.setRecordReaderID(new UID());
  row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(2,de.getNoEncodingNeeded().size());
  assertEquals(0,de.getReEncoderCache().size());
  Schema evolvedSchema=AvroSerdeUtils.getSchemaFor(s.toString());
  evolvedSchema.getField("aRecord").schema().addProp("Testing","meaningless");
  garw.setRecordReaderID(recordReaderID=new UID());
  row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,evolvedSchema);
  assertEquals(2,de.getNoEncodingNeeded().size());
  assertEquals(1,de.getReEncoderCache().size());
  garw.setRecordReaderID(recordReaderID);
  row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,evolvedSchema);
  assertEquals(2,de.getNoEncodingNeeded().size());
  assertEquals(1,de.getReEncoderCache().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroObjectInspectorGenerator </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void convertsNullableEnum() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(NULLABLE_ENUM_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("nullableEnum",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  PrimitiveTypeInfo pti=(PrimitiveTypeInfo)typeInfo;
  assertEquals(PrimitiveObjectInspector.PrimitiveCategory.STRING,pti.getPrimitiveCategory());
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void failOnNonRecords() throws Exception {
  String nonRecordSchema="{ \"type\": \"enum\",\n" + "  \"name\": \"Suit\",\n" + "  \"symbols\" : [\"SPADES\", \"HEARTS\", \"DIAMONDS\", \"CLUBS\"]\n"+ "}";
  Schema s=AvroSerdeUtils.getSchemaFor(nonRecordSchema);
  try {
    new AvroObjectInspectorGenerator(s);
    fail("Should not be able to handle non-record Avro types");
  }
 catch (  SerDeException sde) {
    assertTrue(sde.getMessage().startsWith("Schema for table must be of type RECORD"));
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleArrays() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(ARRAY_WITH_PRIMITIVE_ELEMENT_TYPE);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("anArray",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertEquals(ObjectInspector.Category.LIST,typeInfo.getCategory());
  assertTrue(typeInfo instanceof ListTypeInfo);
  ListTypeInfo listTypeInfo=(ListTypeInfo)typeInfo;
  assertEquals("string",listTypeInfo.getListElementTypeInfo().getTypeName());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void primitiveTypesWorkCorrectly() throws SerDeException {
  final String bunchOfPrimitives="{\n" + "  \"namespace\": \"testing\",\n" + "  \"name\": \"PrimitiveTypes\",\n"+ "  \"type\": \"record\",\n"+ "  \"fields\": [\n"+ "    {\n"+ "      \"name\":\"aString\",\n"+ "      \"type\":\"string\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"anInt\",\n"+ "      \"type\":\"int\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aBoolean\",\n"+ "      \"type\":\"boolean\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aLong\",\n"+ "      \"type\":\"long\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aFloat\",\n"+ "      \"type\":\"float\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aDouble\",\n"+ "      \"type\":\"double\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aNull\",\n"+ "      \"type\":\"null\"\n"+ "    }\n"+ "  ]\n"+ "}";
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(AvroSerdeUtils.getSchemaFor(bunchOfPrimitives));
  String[] expectedColumnNames={"aString","anInt","aBoolean","aLong","aFloat","aDouble","aNull"};
  verifyColumnNames(expectedColumnNames,aoig.getColumnNames());
  TypeInfo[] expectedColumnTypes={STRING,INT,BOOLEAN,LONG,FLOAT,DOUBLE,VOID};
  verifyColumnTypes(expectedColumnTypes,aoig.getColumnTypes());
  final ObjectInspector oi=aoig.getObjectInspector();
  assertTrue(oi instanceof StandardStructObjectInspector);
  final StandardStructObjectInspector ssoi=(StandardStructObjectInspector)oi;
  List<? extends StructField> structFields=ssoi.getAllStructFieldRefs();
  assertEquals(expectedColumnNames.length,structFields.size());
  for (int i=0; i < expectedColumnNames.length; i++) {
    assertEquals("Column names don't match",expectedColumnNames[i].toLowerCase(),structFields.get(i).getFieldName());
    assertEquals("Column types don't match",expectedColumnTypes[i].getTypeName(),structFields.get(i).getFieldObjectInspector().getTypeName());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleRecords() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(RECORD_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("aRecord",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertEquals(ObjectInspector.Category.STRUCT,typeInfo.getCategory());
  assertTrue(typeInfo instanceof StructTypeInfo);
  StructTypeInfo structTypeInfo=(StructTypeInfo)typeInfo;
  ArrayList<String> allStructFieldNames=structTypeInfo.getAllStructFieldNames();
  ArrayList<TypeInfo> allStructFieldTypeInfos=structTypeInfo.getAllStructFieldTypeInfos();
  assertEquals(allStructFieldNames.size(),3);
  String[] names=new String[]{"int1","boolean1","long1"};
  String[] typeInfoStrings=new String[]{"int","boolean","bigint"};
  for (int i=0; i < allStructFieldNames.size(); i++) {
    assertEquals("Fieldname " + allStructFieldNames.get(i) + " doesn't match expected "+ names[i],names[i],allStructFieldNames.get(i));
    assertEquals("Typeinfo " + allStructFieldTypeInfos.get(i) + " doesn't match expected "+ typeInfoStrings[i],typeInfoStrings[i],allStructFieldTypeInfos.get(i).getTypeName());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleBytes() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(BYTES_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("bytesField",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  assertEquals(((PrimitiveTypeInfo)typeInfo).getPrimitiveCategory(),PrimitiveCategory.BINARY);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleFixed() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(FIXED_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("hash",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  assertEquals(((PrimitiveTypeInfo)typeInfo).getPrimitiveCategory(),PrimitiveCategory.BINARY);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleUnions() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(UNION_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("aUnion",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof UnionTypeInfo);
  UnionTypeInfo uti=(UnionTypeInfo)typeInfo;
  List<TypeInfo> typeInfos=uti.getAllUnionObjectTypeInfos();
  assertEquals(2,typeInfos.size());
  assertEquals(INT,typeInfos.get(0));
  assertEquals(STRING,typeInfos.get(1));
  assertEquals("uniontype<int,string>",uti.getTypeName());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void convertsNullableTypes() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(NULLABLE_STRING_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("nullableString",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  PrimitiveTypeInfo pti=(PrimitiveTypeInfo)typeInfo;
  assertEquals(PrimitiveObjectInspector.PrimitiveCategory.STRING,pti.getPrimitiveCategory());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void objectInspectorsAreCached() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(KITCHEN_SINK_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  Schema s2=AvroSerdeUtils.getSchemaFor(KITCHEN_SINK_SCHEMA);
  AvroObjectInspectorGenerator aoig2=new AvroObjectInspectorGenerator(s2);
  assertEquals(aoig.getObjectInspector(),aoig2.getObjectInspector());
  assertTrue(aoig.getObjectInspector() == aoig2.getObjectInspector());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroSerdeUtils </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void detemineSchemaTriesToOpenUrl() throws AvroSerdeException, IOException {
  Configuration conf=new Configuration();
  Properties props=new Properties();
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),"not:///a.real.url");
  try {
    AvroSerdeUtils.determineSchemaOrThrowException(conf,props);
    fail("Should have tried to open that URL");
  }
 catch (  AvroSerdeException e) {
    assertEquals("Unable to read schema from given path: not:///a.real.url",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noneOptionWorksForSpecifyingSchemas() throws IOException, AvroSerdeException {
  Configuration conf=new Configuration();
  Properties props=new Properties();
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),SCHEMA_NONE);
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),SCHEMA_NONE);
  try {
    determineSchemaOrThrowException(conf,props);
    fail("Should have thrown exception with none set for both url and literal");
  }
 catch (  AvroSerdeException he) {
    assertEquals(EXCEPTION_MESSAGE,he.getMessage());
  }
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),TestAvroObjectInspectorGenerator.RECORD_SCHEMA);
  Schema s;
  try {
    s=determineSchemaOrThrowException(conf,props);
    assertNotNull(s);
    assertEquals(AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.RECORD_SCHEMA),s);
  }
 catch (  AvroSerdeException he) {
    fail("Should have parsed schema literal, not thrown exception.");
  }
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),SCHEMA_NONE);
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),"not:///a.real.url");
  try {
    determineSchemaOrThrowException(conf,props);
    fail("Should have tried to open that bogus URL");
  }
 catch (  AvroSerdeException e) {
    assertEquals("Unable to read schema from given path: not:///a.real.url",e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroSerializer </h4><pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableEnums() throws SerDeException, IOException {
  String type="{\"type\": \"enum\", \"name\": \"enum1_values\",\n" + "  \"namespace\": \"org.apache.hadoop.hive\",\n" + "  \"symbols\":[\"BLUE\",\"RED\",\"GREEN\"]}";
  Schema schema=AvroSerdeUtils.getSchemaFor(type);
  String field="{ \"name\":\"nullableenum\", \"type\": [\"null\", " + schema + "] }";
  GenericEnumSymbol symbol=new GenericData.EnumSymbol(schema,enum1.BLUE.toString());
  GenericRecord r=serializeAndDeserialize(field,"nullableenum",symbol);
  assertEquals(enum1.BLUE,enum1.valueOf(r.get("nullableenum").toString()));
  r=serializeAndDeserialize(field,"nullableenum",null);
  assertNull(r.get("nullableenum"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeArraysWithNullablePrimitiveElements() throws SerDeException, IOException {
  final String field="{ \"name\":\"listWithNulls\", \"type\": " + "{\"type\":\"array\", \"items\": [\"null\", \"int\"]} }";
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,null,3);
  GenericRecord r=serializeAndDeserialize(field,"listWithNulls",intList);
  Object result=r.get("listWithNulls");
  assertNotSame(intList,result);
  assertEquals(intList,result);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableLists() throws SerDeException, IOException {
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  String field="{ \"name\":\"nullableList\", \"type\": [\"null\", " + "{\"type\":\"array\", \"items\":\"int\"}] }";
  GenericRecord r=serializeAndDeserialize(field,"nullableList",intList);
  Object result=r.get("nullableList");
  assertNotSame(intList,result);
  assertEquals(intList,result);
  r=serializeAndDeserialize(field,"nullableList",null);
  assertNull(r.get("nullableList"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableDecimals() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableBytes\", \"type\":[\"null\", " + "{\"type\":\"bytes\", \"logicalType\":\"decimal\", \"precision\":5, \"scale\":4}] }";
  Buffer bb=AvroSerdeUtils.getBufferFromDecimal(HiveDecimal.create("3.1416"),4);
  GenericRecord r=serializeAndDeserialize(field,"nullableBytes",bb);
  Object result=r.get("nullableBytes");
  assertNotSame(bb,result);
  assertEquals(bb,result);
  r=serializeAndDeserialize(field,"nullableBytes",null);
  assertNull(r.get("nullableBytes"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeArraysWithNullableComplexElements() throws SerDeException, IOException {
  final String field="{ \"name\":\"listOfNullableLists\", \"type\": " + "{\"type\":\"array\", \"items\": [\"null\", " + "{\"type\": \"array\", \"items\": \"int\"}]} }";
  List<List<Integer>> intListList=new ArrayList<List<Integer>>();
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  Collections.addAll(intListList,intList,null);
  GenericRecord r=serializeAndDeserialize(field,"listOfNullableLists",intListList);
  Object result=r.get("listOfNullableLists");
  assertNotSame(intListList,result);
  assertEquals(intListList,result);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableFixed() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableFixed\", \"type\": [\"null\", " + "{\"type\":\"fixed\", \"name\":\"threebytes\", \"size\":3}] }";
  Schema s=buildSchema(field);
  Schema nullable=s.getField("nullableFixed").schema();
  assertTrue(AvroSerdeUtils.isNullableType(nullable));
  GenericData.Fixed fixed=new GenericData.Fixed(AvroSerdeUtils.getOtherTypeFromNullableType(nullable),"k9@".getBytes());
  GenericRecord r=serializeAndDeserialize(field,"nullableFixed",fixed);
  GenericData.Fixed result=(GenericData.Fixed)r.get("nullableFixed");
  assertNotSame(fixed,result);
  assertArrayEquals(fixed.bytes(),result.bytes());
  r=serializeAndDeserialize(field,"nullableFixed",null);
  assertNull(r.get("nullableFixed"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableBytes() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableBytes\", \"type\":[\"null\", \"bytes\"] }";
  ByteBuffer bb=ByteBuffer.wrap("easy as one two three".getBytes());
  bb.rewind();
  GenericRecord r=serializeAndDeserialize(field,"nullableBytes",bb);
  Object result=r.get("nullableBytes");
  assertNotSame(bb,result);
  assertEquals(bb,result);
  r=serializeAndDeserialize(field,"nullableBytes",null);
  assertNull(r.get("nullableBytes"));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullablePrimitiveTypes() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableint\", \"type\":[\"int\", \"null\"] }";
  GenericRecord r=serializeAndDeserialize(field,"nullableint",42);
  assertEquals(42,r.get("nullableint"));
  r=serializeAndDeserialize(field,"nullableint",null);
  assertNull(r.get("nullableint"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeRecordsWithNullableComplexElements() throws SerDeException, IOException {
  String field="{ \"name\":\"struct1\", \"type\":{\"type\":\"record\", " + "\"name\":\"struct1_name\", \"fields\": [\n" + "{ \"name\":\"sInt\", \"type\":\"int\" }, { \"name\""+ ":\"sBoolean\", \"type\":\"boolean\" }, { \"name\":\"nullableList\", \"type\":[\"null\", "+ "{ \"type\":\"array\", \"items\":\"int\"}] } ] } }";
  Schema s=buildSchema(field);
  GenericData.Record innerRecord=new GenericData.Record(s.getField("struct1").schema());
  innerRecord.put("sInt",77);
  innerRecord.put("sBoolean",false);
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  innerRecord.put("nullableList",intList);
  GenericRecord r=serializeAndDeserialize(field,"struct1",innerRecord);
  Object result=r.get("struct1");
  assertNotSame(innerRecord,result);
  assertEquals(innerRecord,result);
  innerRecord.put("nullableList",null);
  r=serializeAndDeserialize(field,"struct1",innerRecord);
  result=r.get("struct1");
  assertNotSame(innerRecord,result);
  assertEquals(innerRecord,result);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableMaps() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableMap\", \"type\": [\"null\", " + "{\"type\":\"map\", \"values\":\"boolean\"}] }";
  Map<String,Boolean> m=new HashMap<String,Boolean>();
  m.put("yes",true);
  m.put("no",false);
  GenericRecord r=serializeAndDeserialize(field,"nullableMap",m);
  Object result=r.get("nullableMap");
  assertNotSame(m,result);
  assertEquals(m,result);
  r=serializeAndDeserialize(field,"nullableMap",null);
  assertNull(r.get("nullableMap"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeStructs() throws SerDeException {
  String field="{ \"name\":\"struct1\", \"type\":{\"type\":\"record\", " + "\"name\":\"struct1_name\", \"fields\": [\n" + "{ \"name\":\"sInt\", \"type\":\"int\" }, { \"name\""+ ":\"sBoolean\", \"type\":\"boolean\" }, { \"name\":\"sString\", \"type\":\"string\" } ] } }";
  Schema s=buildSchema(field);
  GenericData.Record innerRecord=new GenericData.Record(s.getField("struct1").schema());
  innerRecord.put("sInt",77);
  innerRecord.put("sBoolean",false);
  innerRecord.put("sString","tedious");
  GenericData.Record r=new GenericData.Record(s);
  r.put("struct1",innerRecord);
  AvroSerializer as=new AvroSerializer();
  AvroDeserializer ad=new AvroDeserializer();
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  ObjectInspector oi=aoig.getObjectInspector();
  List<String> columnNames=aoig.getColumnNames();
  List<TypeInfo> columnTypes=aoig.getColumnTypes();
  AvroGenericRecordWritable agrw=new AvroGenericRecordWritable(r);
  agrw.setFileSchema(r.getSchema());
  Object obj=ad.deserialize(columnNames,columnTypes,agrw,s);
  Writable result=as.serialize(obj,oi,columnNames,columnTypes,s);
  assertTrue(result instanceof AvroGenericRecordWritable);
  GenericRecord r2=((AvroGenericRecordWritable)result).getRecord();
  assertEquals(s,r2.getSchema());
  GenericRecord r3=(GenericRecord)r2.get("struct1");
  assertEquals(77,r3.get("sInt"));
  assertEquals(false,r3.get("sBoolean"));
  assertEquals("tedious",r3.get("sString"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeCyclesInSchema() throws SerDeException, IOException {
  AvroCycleParent parent=new AvroCycleParent();
  AvroCycleChild child=new AvroCycleChild();
  parent.setChild(child);
  Schema parentS=ReflectData.AllowNull.get().getSchema(AvroCycleParent.class);
  GenericData.Record parentRec=new GenericData.Record(parentS);
  Schema childS=ReflectData.AllowNull.get().getSchema(AvroCycleChild.class);
  GenericData.Record childRec=new GenericData.Record(childS);
  parentRec.put("child",childRec);
  AvroSerializer as=new AvroSerializer();
  AvroDeserializer ad=new AvroDeserializer();
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(parentS);
  ObjectInspector oi=aoig.getObjectInspector();
  List<String> columnNames=aoig.getColumnNames();
  List<TypeInfo> columnTypes=aoig.getColumnTypes();
  AvroGenericRecordWritable agrw=Utils.serializeAndDeserializeRecord(parentRec);
  Object obj=ad.deserialize(columnNames,columnTypes,agrw,parentS);
  Writable result=as.serialize(obj,oi,columnNames,columnTypes,parentS);
  assertTrue(result instanceof AvroGenericRecordWritable);
  GenericRecord r2=((AvroGenericRecordWritable)result).getRecord();
  assertEquals(parentS,r2.getSchema());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableRecords() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableStruct\", \"type\": [\"null\", {\"type\":\"record\", " + "\"name\":\"struct1_name\", \"fields\": [\n" + "{ \"name\":\"sInt\", \"type\":\"int\" }, "+ "{ \"name\":\"sBoolean\", \"type\":\"boolean\" }, "+ "{ \"name\":\"sString\", \"type\":\"string\" } ] }] }";
  Schema s=buildSchema(field);
  Schema nullable=s.getField("nullableStruct").schema();
  assertTrue(AvroSerdeUtils.isNullableType(nullable));
  GenericData.Record innerRecord=new GenericData.Record(AvroSerdeUtils.getOtherTypeFromNullableType(nullable));
  innerRecord.put("sInt",77);
  innerRecord.put("sBoolean",false);
  innerRecord.put("sString","tedious");
  GenericRecord r=serializeAndDeserialize(field,"nullableStruct",innerRecord);
  Object result=r.get("nullableStruct");
  assertNotSame(innerRecord,result);
  assertEquals(innerRecord,result);
  r=serializeAndDeserialize(field,"nullableStruct",null);
  assertNull(r.get("nullableStruct"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeMapsWithNullableComplexValues() throws SerDeException, IOException {
  String field="{ \"name\":\"mapWithNullableLists\", \"type\": " + "{\"type\":\"map\", \"values\": [\"null\", " + "{\"type\": \"array\", \"items\": \"int\"}]} }";
  Map<String,List<Integer>> m=new HashMap<String,List<Integer>>();
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  m.put("list",intList);
  m.put("null",null);
  GenericRecord r=serializeAndDeserialize(field,"mapWithNullableLists",m);
  Object result=r.get("mapWithNullableLists");
  assertNotSame(m,result);
  assertEquals(m,result);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeLists() throws SerDeException, IOException {
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  String field="{ \"name\":\"list1\", \"type\":{\"type\":\"array\", \"items\":\"int\"} }";
  GenericRecord r=serializeAndDeserialize(field,"list1",intList);
  final Object list1=r.get("list1");
  Assert.assertTrue(list1 instanceof GenericArray);
  Assert.assertTrue(list1 instanceof List);
  assertEquals(intList,list1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestSchemaReEncoder </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void schemasCanAddFields() throws SerDeException {
  String original="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"Line\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"text\",\n"+ "            \"type\":\"string\"\n"+ "        }\n"+ "    ]\n"+ "}";
  String evolved="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"Line\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"text\",\n"+ "            \"type\":\"string\"\n"+ "        },\n"+ "        {\n"+ "            \"name\":\"new_kid\",\n"+ "            \"type\":\"string\",\n"+ "            \"default\":\"Hi!\"\n"+ "        }\n"+ "    ]\n"+ "}";
  Schema originalSchema=AvroSerdeUtils.getSchemaFor(original);
  Schema evolvedSchema=AvroSerdeUtils.getSchemaFor(evolved);
  GenericRecord record=new GenericData.Record(originalSchema);
  record.put("text","it is a far better thing I do, yadda, yadda");
  assertTrue(GenericData.get().validate(originalSchema,record));
  AvroDeserializer.SchemaReEncoder schemaReEncoder=new AvroDeserializer.SchemaReEncoder(record.getSchema(),evolvedSchema);
  GenericRecord r2=schemaReEncoder.reencode(record);
  assertTrue(GenericData.get().validate(evolvedSchema,r2));
  assertEquals("Hi!",r2.get("new_kid").toString());
  String original2="{\n" + "    \"namespace\": \"somebody.else\",\n" + "    \"name\": \"something_else\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"a\",\n"+ "            \"type\":\"int\"\n"+ "        }\n"+ "    ]\n"+ "}";
  String evolved2="{\n" + "    \"namespace\": \"somebody.else\",\n" + "    \"name\": \"something_else\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"a\",\n"+ "            \"type\":\"int\"\n"+ "        },\n"+ "        {\n"+ "            \"name\":\"b\",\n"+ "            \"type\":\"long\",\n"+ "            \"default\":42\n"+ "        }\n"+ "    ]\n"+ "}";
  Schema originalSchema2=AvroSerdeUtils.getSchemaFor(original2);
  Schema evolvedSchema2=AvroSerdeUtils.getSchemaFor(evolved2);
  record=new GenericData.Record(originalSchema2);
  record.put("a",19);
  assertTrue(GenericData.get().validate(originalSchema2,record));
  schemaReEncoder=new AvroDeserializer.SchemaReEncoder(record.getSchema(),evolvedSchema2);
  r2=schemaReEncoder.reencode(record);
  assertTrue(GenericData.get().validate(evolvedSchema2,r2));
  assertEquals(42l,r2.get("b"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestThatEvolvedSchemasActAsWeWant </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void resolvedSchemasShouldReturnReaderSchema() throws IOException {
  String v0="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"SomeStuff\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"v0\",\n"+ "            \"type\":\"string\"\n"+ "        }\n"+ "    ]\n"+ "}";
  String v1="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"SomeStuff\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"v0\",\n"+ "            \"type\":\"string\"\n"+ "        },\n"+ "        {\n"+ "            \"name\":\"v1\",\n"+ "            \"type\":\"string\",\n"+ "            \"default\":\"v1_default\""+ "        }\n"+ "    ]\n"+ "}";
  Schema[] schemas={AvroSerdeUtils.getSchemaFor(v0),AvroSerdeUtils.getSchemaFor(v1)};
  GenericRecord record=new GenericData.Record(schemas[0]);
  record.put("v0","v0 value");
  assertTrue(GenericData.get().validate(schemas[0],record));
  GenericDatumWriter<GenericRecord> gdw=new GenericDatumWriter<GenericRecord>(schemas[0]);
  DataFileWriter<GenericRecord> dfw=new DataFileWriter<GenericRecord>(gdw);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  dfw.create(schemas[0],baos);
  dfw.append(record);
  dfw.close();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  GenericDatumReader<GenericRecord> gdr=new GenericDatumReader<GenericRecord>();
  gdr.setExpected(schemas[1]);
  DataFileStream<GenericRecord> dfs=new DataFileStream<GenericRecord>(bais,gdr);
  assertTrue(dfs.hasNext());
  GenericRecord next=dfs.next();
  assertEquals("v0 value",next.get("v0").toString());
  assertEquals("v1_default",next.get("v1").toString());
  assertEquals(schemas[1],next.getSchema());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestDateWritable </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison(){
  Date date1=Date.valueOf(getRandomDateString());
  Date date2=Date.valueOf(getRandomDateString());
  while (date1.equals(date2)) {
    date2=Date.valueOf(getRandomDateString());
  }
  DateWritable dw1=new DateWritable(date1);
  DateWritable dw2=new DateWritable(date2);
  DateWritable dw3=new DateWritable(date1);
  assertTrue("Dates should be equal",dw1.equals(dw1));
  assertTrue("Dates should be equal",dw1.equals(dw3));
  assertTrue("Dates should be equal",dw3.equals(dw1));
  assertEquals("Dates should be equal",0,dw1.compareTo(dw1));
  assertEquals("Dates should be equal",0,dw1.compareTo(dw3));
  assertEquals("Dates should be equal",0,dw3.compareTo(dw1));
  assertFalse("Dates not should be equal",dw1.equals(dw2));
  assertFalse("Dates not should be equal",dw2.equals(dw1));
  assertTrue("Dates not should be equal",0 != dw1.compareTo(dw2));
  assertTrue("Dates not should be equal",0 != dw2.compareTo(dw1));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDaylightSavingsTime() throws InterruptedException, ExecutionException {
  String[] timeZones={"GMT","UTC","America/Godthab","America/Los_Angeles","Asia/Jerusalem","Australia/Melbourne","Europe/London","America/St_Johns","Asia/Tehran"};
  for (  String timeZone : timeZones) {
    TimeZone previousDefault=TimeZone.getDefault();
    TimeZone.setDefault(TimeZone.getTimeZone(timeZone));
    assertEquals("Default timezone should now be " + timeZone,timeZone,TimeZone.getDefault().getID());
    ExecutorService threadPool=Executors.newFixedThreadPool(1);
    try {
      Future<String> future=threadPool.submit(new DateTestCallable());
      String result=future.get();
      assertNull("Failed at timezone " + timeZone + ", date "+ result,result);
    }
  finally {
      threadPool.shutdown();
      TimeZone.setDefault(previousDefault);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestHiveCharWritable </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison() throws Exception {
  HiveCharWritable hcw1=new HiveCharWritable();
  HiveCharWritable hcw2=new HiveCharWritable();
  hcw1.set("abcd",4);
  hcw2.set("abcd",4);
  assertEquals(hcw1,hcw2);
  assertEquals(hcw2,hcw1);
  assertEquals(0,hcw1.compareTo(hcw2));
  assertEquals(0,hcw2.compareTo(hcw1));
  hcw1.set("abcd",4);
  hcw2.set("abc",4);
  assertFalse(hcw1.equals(hcw2));
  assertFalse(hcw2.equals(hcw1));
  assertFalse(0 == hcw1.compareTo(hcw2));
  assertFalse(0 == hcw2.compareTo(hcw1));
  hcw1.set("abcd ",10);
  hcw2.set("abcd",4);
  assertEquals("abcd      ",hcw1.toString());
  assertEquals(hcw1,hcw2);
  assertEquals(hcw2,hcw1);
  assertEquals(0,hcw1.compareTo(hcw2));
  assertEquals(0,hcw2.compareTo(hcw1));
  hcw1.set(" abcd",5);
  hcw2.set("abcd",5);
  assertFalse(hcw1.equals(hcw2));
  assertFalse(hcw2.equals(hcw1));
  assertFalse(0 == hcw1.compareTo(hcw2));
  assertFalse(0 == hcw2.compareTo(hcw1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestHiveIntervalDayTimeWritable </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison() throws Exception {
  HiveIntervalDayTimeWritable hiw0=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:2:2.22222"));
  HiveIntervalDayTimeWritable hiw1=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:2:2.22222"));
  HiveIntervalDayTimeWritable hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("3 2:2:2.22222"));
  assertTrue(hiw1 + " equals " + hiw1,hiw1.equals(hiw1));
  assertTrue(hiw1 + " equals " + hiw0,hiw1.equals(hiw0));
  assertFalse(hiw1 + " equals " + hiw2,hiw1.equals(hiw2));
  assertTrue(hiw1 + " compare " + hiw1,0 == hiw1.compareTo(hiw1));
  assertTrue(hiw1 + " compare " + hiw0,0 == hiw1.compareTo(hiw0));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("3 2:2:2.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("1 2:2:2.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 3:2:2.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 1:2:2.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:3:2.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:1:2.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:2:3.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:2:1.22222"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:2:2.33333"));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalDayTimeWritable(HiveIntervalDayTime.valueOf("2 2:2:2.11111"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  assertEquals(hiw0.hashCode(),hiw1.hashCode());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testWritableMethods() throws Exception {
  HiveIntervalDayTimeWritable hiw1=new HiveIntervalDayTimeWritable();
  HiveIntervalDayTimeWritable hiw2=new HiveIntervalDayTimeWritable();
  hiw1.set(3,4,5,6,7);
  hiw2.set(5,4,3,2,1);
  assertFalse(hiw1.equals(hiw2));
  ByteArrayOutputStream byteStream=new ByteArrayOutputStream();
  DataOutput out=new DataOutputStream(byteStream);
  hiw1.write(out);
  hiw2.readFields(new DataInputStream(new ByteArrayInputStream(byteStream.toByteArray())));
  assertEquals(hiw1,hiw2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestHiveIntervalYearMonthWritable </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison() throws Exception {
  HiveIntervalYearMonthWritable hiw0=new HiveIntervalYearMonthWritable(HiveIntervalYearMonth.valueOf("2-2"));
  HiveIntervalYearMonthWritable hiw1=new HiveIntervalYearMonthWritable(HiveIntervalYearMonth.valueOf("2-2"));
  HiveIntervalYearMonthWritable hiw2=new HiveIntervalYearMonthWritable(HiveIntervalYearMonth.valueOf("3-2"));
  assertTrue(hiw1 + " equals " + hiw1,hiw1.equals(hiw1));
  assertTrue(hiw1 + " equals " + hiw0,hiw1.equals(hiw0));
  assertFalse(hiw1 + " equals " + hiw2,hiw1.equals(hiw2));
  assertTrue(hiw1 + " compare " + hiw1,0 == hiw1.compareTo(hiw1));
  assertTrue(hiw1 + " compare " + hiw0,0 == hiw1.compareTo(hiw0));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalYearMonthWritable(HiveIntervalYearMonth.valueOf("1-2"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalYearMonthWritable(HiveIntervalYearMonth.valueOf("2-3"));
  assertTrue(hiw1 + " compare " + hiw2,0 > hiw1.compareTo(hiw2));
  hiw2=new HiveIntervalYearMonthWritable(HiveIntervalYearMonth.valueOf("2-1"));
  assertTrue(hiw1 + " compare " + hiw2,0 < hiw1.compareTo(hiw2));
  assertEquals(hiw0.hashCode(),hiw1.hashCode());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testWritableMethods() throws Exception {
  HiveIntervalYearMonthWritable hiw1=new HiveIntervalYearMonthWritable();
  HiveIntervalYearMonthWritable hiw2=new HiveIntervalYearMonthWritable();
  hiw1.set(1,2);
  hiw2.set(7,6);
  assertFalse(hiw1.equals(hiw2));
  ByteArrayOutputStream byteStream=new ByteArrayOutputStream();
  DataOutput out=new DataOutputStream(byteStream);
  hiw1.write(out);
  hiw2.readFields(new DataInputStream(new ByteArrayInputStream(byteStream.toByteArray())));
  assertEquals(hiw1,hiw2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestHiveVarcharWritable </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testComparison() throws Exception {
  HiveVarcharWritable hc1=new HiveVarcharWritable(new HiveVarchar("abcd",20));
  HiveVarcharWritable hc2=new HiveVarcharWritable(new HiveVarchar("abcd",20));
  assertTrue(hc1.equals(hc2));
  assertTrue(hc2.equals(hc1));
  assertEquals(0,hc1.compareTo(hc2));
  assertEquals(0,hc2.compareTo(hc1));
  hc2=new HiveVarcharWritable(new HiveVarchar("abcde",20));
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
  hc2=new HiveVarcharWritable(new HiveVarchar("abcd  ",30));
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
  hc2=new HiveVarcharWritable(new HiveVarchar("  abcd",20));
  assertFalse(hc1.equals(hc2));
  assertFalse(hc2.equals(hc1));
  assertFalse(0 == hc1.compareTo(hc2));
  assertFalse(0 == hc2.compareTo(hc1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestTimestampWritable </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testMaxSize(){
  assertEquals(5,WritableUtils.getVIntSize(999999999));
  assertEquals(5,WritableUtils.getVIntSize(-2 - 999999999));
  assertEquals(3,WritableUtils.getVIntSize(Short.MAX_VALUE));
  assertEquals(3,WritableUtils.getVIntSize(Short.MIN_VALUE));
  assertTrue((((long)MAX_ADDITIONAL_SECONDS_BITS) << 31) * 1000 < Long.MAX_VALUE);
  assertTrue((((double)MAX_ADDITIONAL_SECONDS_BITS + 1) * (1L << 31)) * 1000 > Long.MAX_VALUE);
  assertEquals(4,WritableUtils.getVIntSize(MAX_ADDITIONAL_SECONDS_BITS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeelineArgParsing </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test setting hive conf and hive vars with --hiveconf and --hivevar
 */
@Test public void testHiveConfAndVars() throws Exception {
  TestBeeline bl=new TestBeeline();
  String args[]=new String[]{"-u","url","-n","name","-p","password","-d","driver","--hiveconf","a=avalue","--hiveconf","b=bvalue","--hivevar","c=cvalue","--hivevar","d=dvalue"};
  Assert.assertEquals(0,bl.initArgs(args));
  Assert.assertTrue(bl.connectArgs.equals("url name password driver"));
  Assert.assertTrue(bl.getOpts().getHiveConfVariables().get("a").equals("avalue"));
  Assert.assertTrue(bl.getOpts().getHiveConfVariables().get("b").equals("bvalue"));
  Assert.assertTrue(bl.getOpts().getHiveVariables().get("c").equals("cvalue"));
  Assert.assertTrue(bl.getOpts().getHiveVariables().get("d").equals("dvalue"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryScripts() throws Exception {
  TestBeeline bl=new TestBeeline();
  String args[]=new String[]{"-u","url","-n","name","-p","password","-d","driver","-e","select1","-e","select2"};
  Assert.assertEquals(0,bl.initArgs(args));
  Assert.assertTrue(bl.connectArgs.equals("url name password driver"));
  Assert.assertTrue(bl.queries.contains("select1"));
  Assert.assertTrue(bl.queries.contains("select2"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBeelineOpts() throws Exception {
  TestBeeline bl=new TestBeeline();
  String args[]=new String[]{"-u","url","-n","name","-p","password","-d","driver","--autoCommit=true","--verbose","--truncateTable"};
  Assert.assertEquals(0,bl.initArgs(args));
  Assert.assertTrue(bl.connectArgs.equals("url name password driver"));
  Assert.assertTrue(bl.getOpts().getAutoCommit());
  Assert.assertTrue(bl.getOpts().getVerbose());
  Assert.assertTrue(bl.getOpts().getTruncateTable());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The first flag is taken by the parser.
 */
@Test public void testDuplicateArgs() throws Exception {
  TestBeeline bl=new TestBeeline();
  String args[]=new String[]{"-u","url","-u","url2","-n","name","-p","password","-d","driver"};
  Assert.assertEquals(0,bl.initArgs(args));
  Assert.assertTrue(bl.connectArgs.equals("url name password driver"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleArgs() throws Exception {
  TestBeeline bl=new TestBeeline();
  String args[]=new String[]{"-u","url","-n","name","-p","password","-d","driver","-a","authType"};
  org.junit.Assert.assertEquals(0,bl.initArgs(args));
  Assert.assertTrue(bl.connectArgs.equals("url name password driver"));
  Assert.assertTrue(bl.getOpts().getAuthType().equals("authType"));
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddLocalJarWithoutAddDriverClazz() throws Exception {
  TestBeeline bl=new TestBeeline();
  LOG.info("Add " + driverJarFileName + " for the driver class "+ driverClazzName);
  bl.addLocalJar(driverJarFileName);
  if (!defaultSupported) {
    Assert.assertNull(bl.findLocalDriver(connectionString));
  }
 else {
    Assert.assertEquals(bl.findLocalDriver(connectionString).getClass().getName(),driverClazzName);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test setting script file with -f option.
 */
@Test public void testScriptFile() throws Exception {
  TestBeeline bl=new TestBeeline();
  String args[]=new String[]{"-u","url","-n","name","-p","password","-d","driver","-f","myscript"};
  Assert.assertEquals(0,bl.initArgs(args));
  Assert.assertTrue(bl.connectArgs.equals("url name password driver"));
  Assert.assertTrue(bl.getOpts().getScriptFile().equals("myscript"));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddLocalJar() throws Exception {
  TestBeeline bl=new TestBeeline();
  Assert.assertNull(bl.findLocalDriver(connectionString));
  LOG.info("Add " + driverJarFileName + " for the driver class "+ driverClazzName);
  bl.addLocalJar(driverJarFileName);
  bl.addlocaldrivername(driverClazzName);
  Assert.assertEquals(bl.findLocalDriver(connectionString).getClass().getName(),driverClazzName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestClientCommandHookFactory </h4><pre class="type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHook(){
  Assert.assertNull(ClientCommandHookFactory.get().getHook("set a;"));
  Assert.assertTrue(ClientCommandHookFactory.get().getHook("set a=b;") instanceof ClientCommandHookFactory.SetCommandHook);
  Assert.assertTrue(ClientCommandHookFactory.get().getHook("USE a.b") instanceof ClientCommandHookFactory.UseCommandHook);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.common.util.TestFixedSizedObjectPool </h4><pre class="type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFullEmpty(){
  final int SIZE=8;
  HashSet offered=new HashSet<>();
  FixedSizedObjectPool pool=new FixedSizedObjectPool<>(SIZE,new DummyHelper(),true);
  Object newObj=pool.take();
  for (int i=0; i < SIZE; ++i) {
    Object obj=new Object();
    offered.add(obj);
    assertTrue(pool.tryOffer(obj));
  }
  assertFalse(pool.tryOffer(newObj));
  for (int i=0; i < SIZE; ++i) {
    Object obj=pool.take();
    assertTrue(offered.remove(obj));
  }
  assertTrue(offered.isEmpty());
  Object newObj2=pool.take();
  assertNotSame(newObj,newObj2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.common.util.TestShutdownHookManager </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void shutdownHookManager(){
  Assert.assertEquals(1,ShutdownHookManager.getShutdownHooksInOrder().size());
  Runnable hook1=new Runnable(){
    @Override public void run(){
    }
  }
;
  Runnable hook2=new Runnable(){
    @Override public void run(){
    }
  }
;
  ShutdownHookManager.addShutdownHook(hook1,0);
  Assert.assertTrue(ShutdownHookManager.hasShutdownHook(hook1));
  Assert.assertEquals(2,ShutdownHookManager.getShutdownHooksInOrder().size());
  Assert.assertEquals(hook1,ShutdownHookManager.getShutdownHooksInOrder().get(0));
  ShutdownHookManager.removeShutdownHook(hook1);
  Assert.assertFalse(ShutdownHookManager.hasShutdownHook(hook1));
  ShutdownHookManager.addShutdownHook(hook1,0);
  Assert.assertTrue(ShutdownHookManager.hasShutdownHook(hook1));
  Assert.assertEquals(2,ShutdownHookManager.getShutdownHooksInOrder().size());
  Assert.assertTrue(ShutdownHookManager.hasShutdownHook(hook1));
  Assert.assertEquals(2,ShutdownHookManager.getShutdownHooksInOrder().size());
  ShutdownHookManager.addShutdownHook(hook2,1);
  Assert.assertTrue(ShutdownHookManager.hasShutdownHook(hook1));
  Assert.assertTrue(ShutdownHookManager.hasShutdownHook(hook2));
  Assert.assertEquals(3,ShutdownHookManager.getShutdownHooksInOrder().size());
  Assert.assertEquals(hook2,ShutdownHookManager.getShutdownHooksInOrder().get(0));
  Assert.assertEquals(hook1,ShutdownHookManager.getShutdownHooksInOrder().get(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClient </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicDDLCommands() throws Exception {
  String db="testdb";
  String tableOne="testTable1";
  String tableTwo="testTable2";
  String tableThree="testTable3";
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  client.dropDatabase(db,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(db).ifNotExists(false).build();
  client.createDatabase(dbDesc);
  List<String> dbNames=client.listDatabaseNamesByPattern("*");
  assertTrue(dbNames.contains("default"));
  assertTrue(dbNames.contains(db));
  HCatDatabase testDb=client.getDatabase(db);
  assertTrue(testDb.getComment() == null);
  assertTrue(testDb.getProperties().size() == 0);
  String warehouseDir=System.getProperty("test.warehouse.dir","/user/hive/warehouse");
  if (useExternalMS) {
    assertTrue(testDb.getLocation().matches(".*" + "/" + db + ".db"));
  }
 else {
    String expectedDir=warehouseDir.replaceFirst("pfile:///","pfile:/");
    assertEquals(expectedDir + "/" + db+ ".db",testDb.getLocation());
  }
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id comment"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"value comment"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(db,tableOne,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  HCatTable table1=client.getTable(db,tableOne);
  assertTrue(table1.getInputFileFormat().equalsIgnoreCase(RCFileInputFormat.class.getName()));
  assertTrue(table1.getOutputFileFormat().equalsIgnoreCase(RCFileOutputFormat.class.getName()));
  assertTrue(table1.getSerdeLib().equalsIgnoreCase(LazyBinaryColumnarSerDe.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  try {
    client.createTable(tableDesc);
    fail("Expected exception");
  }
 catch (  HCatException e) {
    assertTrue(e.getMessage().contains("AlreadyExistsException while creating table."));
  }
  client.dropTable(db,tableOne,true);
  HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(db,tableTwo,cols).fieldsTerminatedBy('\001').escapeChar('\002').linesTerminatedBy('\003').mapKeysTerminatedBy('\004').collectionItemsTerminatedBy('\005').nullDefinedAs('\006').build();
  client.createTable(tableDesc2);
  HCatTable table2=client.getTable(db,tableTwo);
  assertTrue("Expected TextInputFormat, but got: " + table2.getInputFileFormat(),table2.getInputFileFormat().equalsIgnoreCase(TextInputFormat.class.getName()));
  assertTrue(table2.getOutputFileFormat().equalsIgnoreCase(HiveIgnoreKeyTextOutputFormat.class.getName()));
  assertTrue("SerdeParams not found",table2.getSerdeParams() != null);
  assertEquals("checking " + serdeConstants.FIELD_DELIM,Character.toString('\001'),table2.getSerdeParams().get(serdeConstants.FIELD_DELIM));
  assertEquals("checking " + serdeConstants.ESCAPE_CHAR,Character.toString('\002'),table2.getSerdeParams().get(serdeConstants.ESCAPE_CHAR));
  assertEquals("checking " + serdeConstants.LINE_DELIM,Character.toString('\003'),table2.getSerdeParams().get(serdeConstants.LINE_DELIM));
  assertEquals("checking " + serdeConstants.MAPKEY_DELIM,Character.toString('\004'),table2.getSerdeParams().get(serdeConstants.MAPKEY_DELIM));
  assertEquals("checking " + serdeConstants.COLLECTION_DELIM,Character.toString('\005'),table2.getSerdeParams().get(serdeConstants.COLLECTION_DELIM));
  assertEquals("checking " + serdeConstants.SERIALIZATION_NULL_FORMAT,Character.toString('\006'),table2.getSerdeParams().get(serdeConstants.SERIALIZATION_NULL_FORMAT));
  assertTrue(table2.getLocation().toLowerCase().matches(".*" + ("/" + db + ".db/"+ tableTwo).toLowerCase()));
  HCatCreateTableDesc tableDesc3=HCatCreateTableDesc.create(db,tableThree,cols).fileFormat("orcfile").build();
  client.createTable(tableDesc3);
  HCatTable table3=client.getTable(db,tableThree);
  assertTrue(table3.getInputFileFormat().equalsIgnoreCase(OrcInputFormat.class.getName()));
  assertTrue(table3.getOutputFileFormat().equalsIgnoreCase(OrcOutputFormat.class.getName()));
  assertTrue(table3.getSerdeLib().equalsIgnoreCase(OrcSerde.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  client.close();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionSchema() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,columnSchema).partCols(partitionSchema).build());
    HCatTable table=client.getTable(dbName,tableName);
    List<HCatFieldSchema> partitionColumns=table.getPartCols();
    assertArrayEquals("Didn't get expected partition-schema back from the HCatTable.",partitionSchema.toArray(),partitionColumns.toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that partition-definitions can be replicated between HCat-instances,
 * independently of table-metadata replication, using PartitionSpec interfaces.
 * (This is essentially the same test as testPartitionRegistrationWithCustomSchema(),
 * transliterated to use the PartitionSpec APIs.)
 * 2 identical tables are created on 2 different HCat instances ("source" and "target").
 * On the source instance,
 * 1. One partition is added with the old format ("TEXTFILE").
 * 2. The table is updated with an additional column and the data-format changed to ORC.
 * 3. Another partition is added with the new format.
 * 4. The partitions' metadata is copied to the target HCat instance, without updating the target table definition.
 * 5. The partitions' metadata is tested to be an exact replica of that on the source.
 * @throws Exception
 */
@Test public void testPartitionSpecRegistrationWithCustomSchema() throws Exception {
  try {
    startReplicationTargetMetaStoreIfRequired();
    HCatClient sourceMetaStore=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    sourceMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,"")));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable sourceTable=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema).comment("Source table.");
    sourceMetaStore.createTable(HCatCreateTableDesc.create(sourceTable).build());
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",sourceTable);
    Map<String,String> partitionSpec_1=new HashMap<String,String>();
    partitionSpec_1.put("grid","AB");
    partitionSpec_1.put("dt","2011_12_31");
    HCatPartition sourcePartition_1=new HCatPartition(sourceTable,partitionSpec_1,makePartLocation(sourceTable,partitionSpec_1));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_1).build());
    assertEquals("Unexpected number of partitions. ",1,sourceMetaStore.getPartitions(dbName,tableName).size());
    HCatPartition addedPartition_1=sourceMetaStore.getPartition(dbName,tableName,partitionSpec_1);
    assertEquals("Column schema doesn't match.",sourceTable.getCols(),addedPartition_1.getColumns());
    assertEquals("InputFormat doesn't match.",sourceTable.getInputFileFormat(),addedPartition_1.getInputFormat());
    assertEquals("OutputFormat doesn't match.",sourceTable.getOutputFileFormat(),addedPartition_1.getOutputFormat());
    assertEquals("SerDe doesn't match.",sourceTable.getSerdeLib(),addedPartition_1.getSerDe());
    assertEquals("SerDe params don't match.",sourceTable.getSerdeParams(),addedPartition_1.getSerdeParams());
    HCatClient targetMetaStore=HCatClient.create(new Configuration(replicationTargetHCatConf));
    targetMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    targetMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    HCatTable targetTable=targetMetaStore.deserializeTable(sourceMetaStore.serializeTable(sourceTable));
    targetMetaStore.createTable(HCatCreateTableDesc.create(targetTable).build());
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("Created table doesn't match the source.",HCatTable.NO_DIFF,targetTable.diff(sourceTable));
    List<HCatFieldSchema> newColumnSchema=new ArrayList<HCatFieldSchema>(columnSchema);
    newColumnSchema.add(new HCatFieldSchema("goo_new",Type.DOUBLE,""));
    Map<String,String> tableParams=new HashMap<String,String>(1);
    tableParams.put("orc.compress","ZLIB");
    sourceTable.cols(newColumnSchema).fileFormat("orcfile").tblProps(tableParams).serdeParam(serdeConstants.FIELD_DELIM,Character.toString('\001'));
    sourceMetaStore.updateTableSchema(dbName,tableName,sourceTable);
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    Map<String,String> partitionSpec_2=new HashMap<String,String>();
    partitionSpec_2.put("grid","AB");
    partitionSpec_2.put("dt","2012_01_01");
    HCatPartition sourcePartition_2=new HCatPartition(sourceTable,partitionSpec_2,makePartLocation(sourceTable,partitionSpec_2));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_2).build());
    HCatPartitionSpec sourcePartitionSpec=sourceMetaStore.getPartitionSpecs(dbName,tableName,-1);
    assertEquals("Unexpected number of source partitions.",2,sourcePartitionSpec.size());
    List<String> partitionSpecString=sourceMetaStore.serializePartitionSpec(sourcePartitionSpec);
    HCatPartitionSpec targetPartitionSpec=targetMetaStore.deserializePartitionSpec(partitionSpecString);
    assertEquals("Could not add the expected number of partitions.",sourcePartitionSpec.size(),targetMetaStore.addPartitionSpec(targetPartitionSpec));
    targetPartitionSpec=targetMetaStore.getPartitionSpecs(dbName,tableName,-1);
    assertEquals("Could not retrieve the expected number of partitions.",sourcePartitionSpec.size(),targetPartitionSpec.size());
    HCatPartitionSpec.HCatPartitionIterator sourceIterator=sourcePartitionSpec.getPartitionIterator();
    HCatPartitionSpec.HCatPartitionIterator targetIterator=targetPartitionSpec.getPartitionIterator();
    while (targetIterator.hasNext()) {
      assertTrue("Fewer target partitions than source.",sourceIterator.hasNext());
      HCatPartition sourcePartition=sourceIterator.next();
      HCatPartition targetPartition=targetIterator.next();
      assertEquals("Column schema doesn't match.",sourcePartition.getColumns(),targetPartition.getColumns());
      assertEquals("InputFormat doesn't match.",sourcePartition.getInputFormat(),targetPartition.getInputFormat());
      assertEquals("OutputFormat doesn't match.",sourcePartition.getOutputFormat(),targetPartition.getOutputFormat());
      assertEquals("SerDe doesn't match.",sourcePartition.getSerDe(),targetPartition.getSerDe());
      assertEquals("SerDe params don't match.",sourcePartition.getSerdeParams(),targetPartition.getSerdeParams());
    }
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception! ",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that partition-definitions can be replicated between HCat-instances,
 * independently of table-metadata replication.
 * 2 identical tables are created on 2 different HCat instances ("source" and "target").
 * On the source instance,
 * 1. One partition is added with the old format ("TEXTFILE").
 * 2. The table is updated with an additional column and the data-format changed to ORC.
 * 3. Another partition is added with the new format.
 * 4. The partitions' metadata is copied to the target HCat instance, without updating the target table definition.
 * 5. The partitions' metadata is tested to be an exact replica of that on the source.
 * @throws Exception
 */
@Test public void testPartitionRegistrationWithCustomSchema() throws Exception {
  try {
    startReplicationTargetMetaStoreIfRequired();
    HCatClient sourceMetaStore=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    sourceMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,"")));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable sourceTable=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema).comment("Source table.");
    sourceMetaStore.createTable(HCatCreateTableDesc.create(sourceTable).build());
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",sourceTable);
    Map<String,String> partitionSpec_1=new HashMap<String,String>();
    partitionSpec_1.put("grid","AB");
    partitionSpec_1.put("dt","2011_12_31");
    HCatPartition sourcePartition_1=new HCatPartition(sourceTable,partitionSpec_1,makePartLocation(sourceTable,partitionSpec_1));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_1).build());
    assertEquals("Unexpected number of partitions. ",1,sourceMetaStore.getPartitions(dbName,tableName).size());
    HCatPartition addedPartition_1=sourceMetaStore.getPartition(dbName,tableName,partitionSpec_1);
    assertEquals("Column schema doesn't match.",sourceTable.getCols(),addedPartition_1.getColumns());
    assertEquals("InputFormat doesn't match.",sourceTable.getInputFileFormat(),addedPartition_1.getInputFormat());
    assertEquals("OutputFormat doesn't match.",sourceTable.getOutputFileFormat(),addedPartition_1.getOutputFormat());
    assertEquals("SerDe doesn't match.",sourceTable.getSerdeLib(),addedPartition_1.getSerDe());
    assertEquals("SerDe params don't match.",sourceTable.getSerdeParams(),addedPartition_1.getSerdeParams());
    HCatClient targetMetaStore=HCatClient.create(new Configuration(replicationTargetHCatConf));
    targetMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    targetMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    HCatTable targetTable=targetMetaStore.deserializeTable(sourceMetaStore.serializeTable(sourceTable));
    targetMetaStore.createTable(HCatCreateTableDesc.create(targetTable).build());
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("Created table doesn't match the source.",HCatTable.NO_DIFF,targetTable.diff(sourceTable));
    List<HCatFieldSchema> newColumnSchema=new ArrayList<HCatFieldSchema>(columnSchema);
    newColumnSchema.add(new HCatFieldSchema("goo_new",Type.DOUBLE,""));
    Map<String,String> tableParams=new HashMap<String,String>(1);
    tableParams.put("orc.compress","ZLIB");
    sourceTable.cols(newColumnSchema).fileFormat("orcfile").tblProps(tableParams).serdeParam(serdeConstants.FIELD_DELIM,Character.toString('\001'));
    sourceMetaStore.updateTableSchema(dbName,tableName,sourceTable);
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    Map<String,String> partitionSpec_2=new HashMap<String,String>();
    partitionSpec_2.put("grid","AB");
    partitionSpec_2.put("dt","2012_01_01");
    HCatPartition sourcePartition_2=new HCatPartition(sourceTable,partitionSpec_2,makePartLocation(sourceTable,partitionSpec_2));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_2).build());
    List<HCatPartition> sourcePartitions=sourceMetaStore.getPartitions(dbName,tableName);
    assertEquals("Unexpected number of source partitions.",2,sourcePartitions.size());
    List<HCatAddPartitionDesc> addPartitionDescs=new ArrayList<HCatAddPartitionDesc>(sourcePartitions.size());
    for (    HCatPartition partition : sourcePartitions) {
      addPartitionDescs.add(HCatAddPartitionDesc.create(partition).build());
    }
    targetMetaStore.addPartitions(addPartitionDescs);
    List<HCatPartition> targetPartitions=targetMetaStore.getPartitions(dbName,tableName);
    assertEquals("Expected the same number of partitions. ",sourcePartitions.size(),targetPartitions.size());
    for (int i=0; i < targetPartitions.size(); ++i) {
      HCatPartition sourcePartition=sourcePartitions.get(i), targetPartition=targetPartitions.get(i);
      assertEquals("Column schema doesn't match.",sourcePartition.getColumns(),targetPartition.getColumns());
      assertEquals("InputFormat doesn't match.",sourcePartition.getInputFormat(),targetPartition.getInputFormat());
      assertEquals("OutputFormat doesn't match.",sourcePartition.getOutputFormat(),targetPartition.getOutputFormat());
      assertEquals("SerDe doesn't match.",sourcePartition.getSerDe(),targetPartition.getSerDe());
      assertEquals("SerDe params don't match.",sourcePartition.getSerdeParams(),targetPartition.getSerdeParams());
    }
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception! ",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPartitionsWithPartialSpec() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable table=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema);
    client.createTable(HCatCreateTableDesc.create(table,false).build());
    table=client.getTable(dbName,tableName);
    assertNotNull("The created just now can't be null.",table);
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2011_12_31");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2012_01_01");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","OB");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","XB");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    Map<String,String> partialPartitionSpec=new HashMap<String,String>();
    partialPartitionSpec.put("dt","2012_01_01");
    List<HCatPartition> partitions=client.getPartitions(dbName,tableName,partialPartitionSpec);
    assertEquals("Unexpected number of partitions.",3,partitions.size());
    assertArrayEquals("Mismatched partition.",new String[]{"2012_01_01","AB"},partitions.get(0).getValues().toArray());
    assertArrayEquals("Mismatched partition.",new String[]{"2012_01_01","OB"},partitions.get(1).getValues().toArray());
    assertArrayEquals("Mismatched partition.",new String[]{"2012_01_01","XB"},partitions.get(2).getValues().toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testObjectNotFoundException() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    String dbName="testObjectNotFoundException_DBName";
    String tableName="testObjectNotFoundException_TableName";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    try {
      client.getDatabase(dbName);
      assertTrue("Expected ObjectNotFoundException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected ObjectNotFoundException. Got:" + exception.getClass(),exception instanceof ObjectNotFoundException);
    }
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    try {
      client.getTable(dbName,tableName);
      assertTrue("Expected ObjectNotFoundException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected ObjectNotFoundException. Got:" + exception.getClass(),exception instanceof ObjectNotFoundException);
    }
    String partitionColumn="part";
    List<HCatFieldSchema> columns=Arrays.asList(new HCatFieldSchema("col",Type.STRING,""));
    ArrayList<HCatFieldSchema> partitionColumns=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema(partitionColumn,Type.STRING,"")));
    HCatTable table=new HCatTable(dbName,tableName).cols(columns).partCols(partitionColumns);
    client.createTable(HCatCreateTableDesc.create(table,false).build());
    HCatTable createdTable=client.getTable(dbName,tableName);
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put(partitionColumn,"foobar");
    try {
      client.getPartition(dbName,tableName,partitionSpec);
      assertTrue("Expected ObjectNotFoundException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected ObjectNotFoundException. Got:" + exception.getClass(),exception instanceof ObjectNotFoundException);
    }
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(createdTable,partitionSpec,makePartLocation(createdTable,partitionSpec))).build());
    assertEquals("Expected empty set of partitions.",0,client.listPartitionsByFilter(dbName,tableName,partitionColumn + " < 'foobar'").size());
    try {
      partitionSpec.put("NonExistentKey","foobar");
      client.getPartition(dbName,tableName,partitionSpec);
      assertTrue("Expected HCatException.",false);
    }
 catch (    Exception exception) {
      LOG.info("Got exception: ",exception);
      assertTrue("Expected HCatException. Got:" + exception.getClass(),exception instanceof HCatException);
      assertFalse("Did not expect ObjectNotFoundException.",exception instanceof ObjectNotFoundException);
    }
  }
 catch (  Throwable t) {
    LOG.error("Unexpected exception!",t);
    assertTrue("Unexpected exception! " + t.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTransportFailure() throws Exception {
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  boolean isExceptionCaught=false;
  final String tableName="Temptable" + new BigInteger(200,new Random()).toString(2);
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id columns"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"id columns"));
  try {
    HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(null,tableName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc);
  }
 catch (  Exception exp) {
    isExceptionCaught=true;
    assertEquals("Unexpected exception type.",HCatException.class,exp.getClass());
    client=HCatClient.create(new Configuration(hcatConf));
    String newName="goodTable";
    client.dropTable(null,newName,true);
    HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(null,newName,cols).fileFormat("rcfile").build();
    client.createTable(tableDesc2);
    HCatTable newTable=client.getTable(null,newName);
    assertTrue(newTable != null);
    assertTrue(newTable.getTableName().equalsIgnoreCase(newName));
  }
 finally {
    client.close();
    assertTrue("The expected exception was never thrown.",isExceptionCaught);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMessageBusTopicName() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    String dbName="testGetMessageBusTopicName_DBName";
    String tableName="testGetMessageBusTopicName_TableName";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    String messageBusTopicName="MY.topic.name";
    Map<String,String> tableProperties=new HashMap<String,String>(1);
    tableProperties.put(HCatConstants.HCAT_MSGBUS_TOPIC_NAME,messageBusTopicName);
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,Arrays.asList(new HCatFieldSchema("foo",Type.STRING,""))).tblProps(tableProperties).build());
    assertEquals("MessageBus topic-name doesn't match!",messageBusTopicName,client.getMessageBusTopicName(dbName,tableName));
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.close();
  }
 catch (  Exception exception) {
    LOG.error("Unexpected exception.",exception);
    assertTrue("Unexpected exception:" + exception.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateTableSchema() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="testUpdateTableSchema_DBName";
    final String tableName="testUpdateTableSchema_TableName";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> oldSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    client.createTable(HCatCreateTableDesc.create(dbName,tableName,oldSchema).build());
    List<HCatFieldSchema> newSchema=Arrays.asList(new HCatFieldSchema("completely",Type.DOUBLE,""),new HCatFieldSchema("new",Type.STRING,""),new HCatFieldSchema("fields",Type.STRING,""));
    client.updateTableSchema(dbName,tableName,newSchema);
    assertArrayEquals(newSchema.toArray(),client.getTable(dbName,tableName).getCols().toArray());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception exception) {
    LOG.error("Unexpected exception.",exception);
    assertTrue("Unexpected exception: " + exception.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for detecting schema-changes for an HCatalog table, across 2 different HCat instances.
 * A table is created with the same schema on 2 HCat instances. The table-schema is modified on the source HCat
 * instance (columns, I/O formats, SerDe definitions, etc.). The table metadata is compared between source
 * and target, the changes are detected and propagated to target.
 * @throws Exception
 */
@Test public void testTableSchemaPropagation() throws Exception {
  try {
    startReplicationTargetMetaStoreIfRequired();
    HCatClient sourceMetaStore=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    sourceMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable sourceTable=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema);
    sourceMetaStore.createTable(HCatCreateTableDesc.create(sourceTable).build());
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",sourceTable);
    String tableStringRep=sourceMetaStore.serializeTable(sourceTable);
    HCatClient targetMetaStore=HCatClient.create(new Configuration(replicationTargetHCatConf));
    targetMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    targetMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    HCatTable targetTable=targetMetaStore.deserializeTable(tableStringRep);
    assertEquals("Table after deserialization should have been identical to sourceTable.",HCatTable.NO_DIFF,sourceTable.diff(targetTable));
    targetMetaStore.createTable(HCatCreateTableDesc.create(targetTable).build());
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("Table after deserialization should have been identical to sourceTable.",HCatTable.NO_DIFF,sourceTable.diff(targetTable));
    List<HCatFieldSchema> newColumnSchema=new ArrayList<HCatFieldSchema>(columnSchema);
    newColumnSchema.add(new HCatFieldSchema("goo_new",Type.DOUBLE,""));
    Map<String,String> tableParams=new HashMap<String,String>(1);
    tableParams.put("orc.compress","ZLIB");
    sourceTable.cols(newColumnSchema).fileFormat("orcfile").tblProps(tableParams).serdeParam(serdeConstants.FIELD_DELIM,Character.toString('\001'));
    sourceMetaStore.updateTableSchema(dbName,tableName,sourceTable);
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    EnumSet<HCatTable.TableAttribute> diff=targetTable.diff(sourceTable);
    assertTrue("Couldn't find change in column-schema.",diff.contains(HCatTable.TableAttribute.COLUMNS));
    assertTrue("Couldn't find change in InputFormat.",diff.contains(HCatTable.TableAttribute.INPUT_FORMAT));
    assertTrue("Couldn't find change in OutputFormat.",diff.contains(HCatTable.TableAttribute.OUTPUT_FORMAT));
    assertTrue("Couldn't find change in SerDe.",diff.contains(HCatTable.TableAttribute.SERDE));
    assertTrue("Couldn't find change in SerDe parameters.",diff.contains(HCatTable.TableAttribute.SERDE_PROPERTIES));
    assertTrue("Couldn't find change in Table parameters.",diff.contains(HCatTable.TableAttribute.TABLE_PROPERTIES));
    targetMetaStore.updateTableSchema(dbName,tableName,targetTable.resolve(sourceTable,diff));
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("After propagating schema changes, source and target tables should have been equivalent.",HCatTable.NO_DIFF,targetTable.diff(sourceTable));
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropPartitionsWithPartialSpec() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable table=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema);
    client.createTable(HCatCreateTableDesc.create(table,false).build());
    table=client.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",table);
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2011_12_31");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2012_01_01");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","OB");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","XB");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    Map<String,String> partialPartitionSpec=new HashMap<String,String>();
    partialPartitionSpec.put("dt","2012_01_01");
    client.dropPartitions(dbName,tableName,partialPartitionSpec,true);
    List<HCatPartition> partitions=client.getPartitions(dbName,tableName);
    assertEquals("Unexpected number of partitions.",1,partitions.size());
    assertArrayEquals("Mismatched partition.",new String[]{"2011_12_31","AB"},partitions.get(0).getValues().toArray());
    List<HCatFieldSchema> partColumns=partitions.get(0).getPartColumns();
    assertEquals(2,partColumns.size());
    assertEquals("dt",partColumns.get(0).getName());
    assertEquals("grid",partColumns.get(1).getName());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClientNotification </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropTable() throws Exception {
  String dbName="default";
  String tableName="hcatdroptable";
  HCatTable table=new HCatTable(dbName,tableName);
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  hCatClient.dropTable(dbName,tableName,false);
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,events.size());
  HCatNotificationEvent event=events.get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_TABLE_EVENT,event.getEventType());
  assertEquals(dbName,event.getDbName());
  assertEquals(tableName,event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"hcatdroptable\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropDatabase() throws Exception {
  String dbname="hcatdropdb";
  hCatClient.createDatabase(HCatCreateDBDesc.create(dbname).build());
  hCatClient.dropDatabase(dbname,false,HCatClient.DropDBMode.RESTRICT);
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,events.size());
  HCatNotificationEvent event=events.get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_DATABASE_EVENT,event.getEventType());
  assertEquals(dbname,event.getDbName());
  assertNull(event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_DATABASE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"hcatdropdb\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-12 type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  long now=System.currentTimeMillis() / 1000;
  startTime=0;
  if (now > Integer.MAX_VALUE)   fail("Bummer, time has fallen over the edge");
 else   startTime=(int)now;
  firstEventId=hCatClient.getCurrentNotificationEventId();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addPartition() throws Exception {
  String dbName="default";
  String tableName="hcataddparttable";
  String partColName="pc";
  HCatTable table=new HCatTable(dbName,tableName);
  table.partCol(new HCatFieldSchema(partColName,TypeInfoFactory.stringTypeInfo,""));
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  String partName="testpart";
  Map<String,String> partSpec=new HashMap<String,String>(1);
  partSpec.put(partColName,partName);
  hCatClient.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partSpec,null)).build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,events.size());
  HCatNotificationEvent event=events.get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals(tableName,event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"ADD_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"hcataddparttable\",\"timestamp\":[0-9]+,\"partitions\":\\[\\{\"pc\":\"testpart\"}]}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTable() throws Exception {
  String dbName="default";
  String tableName="hcatcreatetable";
  HCatTable table=new HCatTable(dbName,tableName);
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,events.size());
  HCatNotificationEvent event=events.get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  assertEquals(dbName,event.getDbName());
  assertEquals("hcatcreatetable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"CREATE_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":\"hcatcreatetable\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createDatabase() throws Exception {
  hCatClient.createDatabase(HCatCreateDBDesc.create("myhcatdb").build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,events.size());
  HCatNotificationEvent event=events.get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_DATABASE_EVENT,event.getEventType());
  assertEquals("myhcatdb",event.getDbName());
  assertNull(event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"CREATE_DATABASE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"myhcatdb\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropPartition() throws Exception {
  String dbName="default";
  String tableName="hcatdropparttable";
  String partColName="pc";
  HCatTable table=new HCatTable(dbName,tableName);
  table.partCol(new HCatFieldSchema(partColName,TypeInfoFactory.stringTypeInfo,""));
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  String partName="testpart";
  Map<String,String> partSpec=new HashMap<String,String>(1);
  partSpec.put(partColName,partName);
  hCatClient.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partSpec,null)).build());
  hCatClient.dropPartitions(dbName,tableName,partSpec,false);
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(3,events.size());
  HCatNotificationEvent event=events.get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals(tableName,event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"hcatdropparttable\",\"timestamp\":[0-9]+,\"partitions\":\\[\\{\"pc\":\"testpart\"}]}"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.repl.commands.TestCommands </h4><pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicReplEximCommands() throws IOException, CommandNeedRetryException {
  int evid=111;
  String exportLocation=TEST_PATH + File.separator + "testBasicReplExim";
  Path tempPath=new Path(TEST_PATH,"testBasicReplEximTmp");
  String tempLocation=tempPath.toUri().getPath();
  String dbName="exim";
  String tableName="basicSrc";
  String importedTableName="basicDst";
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("b:string").getFields();
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  HCatTable table=(new HCatTable(dbName,tableName)).cols(cols).fileFormat("textfile");
  client.createTable(HCatCreateTableDesc.create(table).build());
  HCatTable t=client.getTable(dbName,tableName);
  assertNotNull(t);
  String[] data=new String[]{"eleven","twelve"};
  HcatTestUtils.createTestDataFile(tempLocation,data);
  CommandProcessorResponse ret=driver.run("LOAD DATA LOCAL INPATH '" + tempLocation + "' OVERWRITE INTO TABLE "+ dbName+ "."+ tableName);
  assertEquals(ret.getResponseCode() + ":" + ret.getErrorMessage(),null,ret.getException());
  CommandProcessorResponse selectRet=driver.run("SELECT * from " + dbName + "."+ tableName);
  assertEquals(selectRet.getResponseCode() + ":" + selectRet.getErrorMessage(),null,selectRet.getException());
  List<String> values=new ArrayList<String>();
  driver.getResults(values);
  assertEquals(2,values.size());
  assertEquals(data[0],values.get(0));
  assertEquals(data[1],values.get(1));
  ExportCommand exportCmd=new ExportCommand(dbName,tableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + exportCmd.get().get(0));
  CommandProcessorResponse ret2=driver.run(exportCmd.get().get(0));
  assertEquals(ret2.getResponseCode() + ":" + ret2.getErrorMessage(),null,ret2.getException());
  List<String> exportPaths=exportCmd.cleanupLocationsAfterEvent();
  assertEquals(1,exportPaths.size());
  String metadata=getMetadataContents(exportPaths.get(0));
  LOG.info("Export returned the following _metadata contents:");
  LOG.info(metadata);
  assertTrue(metadata + "did not match \"repl.scope\"=\"all\"",metadata.matches(".*\"repl.scope\":\"all\".*"));
  assertTrue(metadata + "has \"repl.last.id\"",metadata.matches(".*\"repl.last.id\":.*"));
  ImportCommand importCmd=new ImportCommand(dbName,importedTableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + importCmd.get().get(0));
  CommandProcessorResponse ret3=driver.run(importCmd.get().get(0));
  assertEquals(ret3.getResponseCode() + ":" + ret3.getErrorMessage(),null,ret3.getException());
  CommandProcessorResponse selectRet2=driver.run("SELECT * from " + dbName + "."+ importedTableName);
  assertEquals(selectRet2.getResponseCode() + ":" + selectRet2.getErrorMessage(),null,selectRet2.getException());
  List<String> values2=new ArrayList<String>();
  driver.getResults(values2);
  assertEquals(2,values2.size());
  assertEquals(data[0],values2.get(0));
  assertEquals(data[1],values2.get(1));
  HCatTable importedTable=client.getTable(dbName,importedTableName);
  assertNotNull(importedTable);
  assertTrue(importedTable.getTblProps().containsKey("repl.last.id"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoopReplEximCommands() throws CommandNeedRetryException, IOException {
  int evid=333;
  String exportLocation=TEST_PATH + File.separator + "testNoopReplExim";
  String dbName="doesNotExist" + System.currentTimeMillis();
  String tableName="nope" + System.currentTimeMillis();
  ExportCommand noopExportCmd=new ExportCommand(dbName,tableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + noopExportCmd.get().get(0));
  CommandProcessorResponse ret=driver.run(noopExportCmd.get().get(0));
  assertEquals(ret.getResponseCode() + ":" + ret.getErrorMessage(),null,ret.getException());
  List<String> exportPaths=noopExportCmd.cleanupLocationsAfterEvent();
  assertEquals(1,exportPaths.size());
  String metadata=getMetadataContents(exportPaths.get(0));
  LOG.info("Export returned the following _metadata contents:");
  LOG.info(metadata);
  assertTrue(metadata + "did not match \"repl.noop\"=\"true\"",metadata.matches(".*\"repl.noop\":\"true\".*"));
  ImportCommand noopImportCmd=new ImportCommand(dbName,tableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + noopImportCmd.get().get(0));
  CommandProcessorResponse ret2=driver.run(noopImportCmd.get().get(0));
  assertEquals(ret2.getResponseCode() + ":" + ret2.getErrorMessage(),null,ret2.getException());
  Exception onfe=null;
  try {
    HCatDatabase d_doesNotExist=client.getDatabase(dbName);
  }
 catch (  Exception e) {
    onfe=e;
  }
  assertNotNull(onfe);
  assertTrue(onfe instanceof ObjectNotFoundException);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropTableCommand() throws HCatException, CommandNeedRetryException {
  String dbName="cmd_testdb";
  String tableName="cmd_testtable";
  int evid=789;
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields();
  Command testReplicatedDropCmd=new DropTableCommand(dbName,tableName,true,evid);
  assertEquals(evid,testReplicatedDropCmd.getEventId());
  assertEquals(1,testReplicatedDropCmd.get().size());
  assertEquals(true,testReplicatedDropCmd.isRetriable());
  assertEquals(false,testReplicatedDropCmd.isUndoable());
  CommandTestUtils.testCommandSerialization(testReplicatedDropCmd);
  Command testNormalDropCmd=new DropTableCommand(dbName,tableName,false,evid);
  assertEquals(evid,testNormalDropCmd.getEventId());
  assertEquals(1,testNormalDropCmd.get().size());
  assertEquals(true,testNormalDropCmd.isRetriable());
  assertEquals(false,testNormalDropCmd.isUndoable());
  CommandTestUtils.testCommandSerialization(testNormalDropCmd);
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  Map<String,String> tprops=new HashMap<String,String>();
  tprops.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid + 5));
  HCatTable tableToCreate=(new HCatTable(dbName,tableName)).tblProps(tprops).cols(cols);
  client.createTable(HCatCreateTableDesc.create(tableToCreate).build());
  HCatTable t1=client.getTable(dbName,tableName);
  assertNotNull(t1);
  LOG.info("About to run :" + testReplicatedDropCmd.get().get(0));
  driver.run(testReplicatedDropCmd.get().get(0));
  HCatTable t2=client.getTable(dbName,tableName);
  assertNotNull(t2);
  LOG.info("About to run :" + testNormalDropCmd.get().get(0));
  driver.run(testNormalDropCmd.get().get(0));
  Exception onfe=null;
  try {
    HCatTable t_del=client.getTable(dbName,tableName);
  }
 catch (  Exception e) {
    onfe=e;
  }
  assertNotNull(onfe);
  assertTrue(onfe instanceof ObjectNotFoundException);
  Map<String,String> tprops2=new HashMap<String,String>();
  tprops2.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid - 5));
  HCatTable tableToCreate2=(new HCatTable(dbName,tableName)).tblProps(tprops2).cols(cols);
  client.createTable(HCatCreateTableDesc.create(tableToCreate2).build());
  HCatTable t3=client.getTable(dbName,tableName);
  assertNotNull(t3);
  LOG.info("About to run :" + testReplicatedDropCmd.get().get(0));
  driver.run(testReplicatedDropCmd.get().get(0));
  Exception onfe2=null;
  try {
    HCatTable t_del=client.getTable(dbName,tableName);
  }
 catch (  Exception e) {
    onfe2=e;
  }
  assertNotNull(onfe2);
  assertTrue(onfe2 instanceof ObjectNotFoundException);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetadataReplEximCommands() throws IOException, CommandNeedRetryException {
  int evid=222;
  String exportLocation=TEST_PATH + File.separator + "testMetadataReplExim";
  Path tempPath=new Path(TEST_PATH,"testMetadataReplEximTmp");
  String tempLocation=tempPath.toUri().getPath();
  String dbName="exim";
  String tableName="basicSrc";
  String importedTableName="basicDst";
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("b:string").getFields();
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  HCatTable table=(new HCatTable(dbName,tableName)).cols(cols).fileFormat("textfile");
  client.createTable(HCatCreateTableDesc.create(table).build());
  HCatTable t=client.getTable(dbName,tableName);
  assertNotNull(t);
  String[] data=new String[]{"eleven","twelve"};
  HcatTestUtils.createTestDataFile(tempLocation,data);
  CommandProcessorResponse ret=driver.run("LOAD DATA LOCAL INPATH '" + tempLocation + "' OVERWRITE INTO TABLE "+ dbName+ "."+ tableName);
  assertEquals(ret.getResponseCode() + ":" + ret.getErrorMessage(),null,ret.getException());
  CommandProcessorResponse selectRet=driver.run("SELECT * from " + dbName + "."+ tableName);
  assertEquals(selectRet.getResponseCode() + ":" + selectRet.getErrorMessage(),null,selectRet.getException());
  List<String> values=new ArrayList<String>();
  driver.getResults(values);
  assertEquals(2,values.size());
  assertEquals(data[0],values.get(0));
  assertEquals(data[1],values.get(1));
  ExportCommand exportMdCmd=new ExportCommand(dbName,tableName,null,exportLocation,true,evid);
  LOG.info("About to run :" + exportMdCmd.get().get(0));
  CommandProcessorResponse ret2=driver.run(exportMdCmd.get().get(0));
  assertEquals(ret2.getResponseCode() + ":" + ret2.getErrorMessage(),null,ret2.getException());
  List<String> exportPaths=exportMdCmd.cleanupLocationsAfterEvent();
  assertEquals(1,exportPaths.size());
  String metadata=getMetadataContents(exportPaths.get(0));
  LOG.info("Export returned the following _metadata contents:");
  LOG.info(metadata);
  assertTrue(metadata + "did not match \"repl.scope\"=\"metadata\"",metadata.matches(".*\"repl.scope\":\"metadata\".*"));
  assertTrue(metadata + "has \"repl.last.id\"",metadata.matches(".*\"repl.last.id\":.*"));
  ImportCommand importMdCmd=new ImportCommand(dbName,importedTableName,null,exportLocation,true,evid);
  LOG.info("About to run :" + importMdCmd.get().get(0));
  CommandProcessorResponse ret3=driver.run(importMdCmd.get().get(0));
  assertEquals(ret3.getResponseCode() + ":" + ret3.getErrorMessage(),null,ret3.getException());
  CommandProcessorResponse selectRet2=driver.run("SELECT * from " + dbName + "."+ importedTableName);
  assertEquals(selectRet2.getResponseCode() + ":" + selectRet2.getErrorMessage(),null,selectRet2.getException());
  List<String> values2=new ArrayList<String>();
  driver.getResults(values2);
  assertEquals(0,values2.size());
  HCatTable importedTable=client.getTable(dbName,importedTableName);
  assertNotNull(importedTable);
  assertTrue(importedTable.getTblProps().containsKey("repl.last.id"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropTableCommand2() throws HCatException, CommandNeedRetryException, MetaException {
  String dbName="cmd_testdb";
  String tableName="cmd_testtable";
  int evid=157;
  List<HCatFieldSchema> pcols=HCatSchemaUtils.getHCatSchema("b:string").getFields();
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("a:int").getFields();
  Command testReplicatedDropCmd=new DropTableCommand(dbName,tableName,true,evid);
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  Map<String,String> tprops=new HashMap<String,String>();
  tprops.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid + 2));
  HCatTable table=(new HCatTable(dbName,tableName)).tblProps(tprops).cols(cols).partCols(pcols);
  client.createTable(HCatCreateTableDesc.create(table).build());
  HCatTable tableCreated=client.getTable(dbName,tableName);
  assertNotNull(tableCreated);
  Map<String,String> ptnDesc1=new HashMap<String,String>();
  ptnDesc1.put("b","test-older");
  Map<String,String> props1=new HashMap<String,String>();
  props1.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid - 5));
  HCatPartition ptnToAdd1=(new HCatPartition(tableCreated,ptnDesc1,TestHCatClient.makePartLocation(tableCreated,ptnDesc1))).parameters(props1);
  client.addPartition(HCatAddPartitionDesc.create(ptnToAdd1).build());
  Map<String,String> ptnDesc2=new HashMap<String,String>();
  ptnDesc2.put("b","test-newer");
  Map<String,String> props2=new HashMap<String,String>();
  props2.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid + 5));
  HCatPartition ptnToAdd2=(new HCatPartition(tableCreated,ptnDesc2,TestHCatClient.makePartLocation(tableCreated,ptnDesc2))).parameters(props2);
  client.addPartition(HCatAddPartitionDesc.create(ptnToAdd2).build());
  HCatPartition p1=client.getPartition(dbName,tableName,ptnDesc1);
  assertNotNull(p1);
  HCatPartition p2=client.getPartition(dbName,tableName,ptnDesc2);
  assertNotNull(p2);
  LOG.info("About to run :" + testReplicatedDropCmd.get().get(0));
  driver.run(testReplicatedDropCmd.get().get(0));
  HCatTable t_stillExists=client.getTable(dbName,tableName);
  assertNotNull(t_stillExists);
  HCatPartition p2_stillExists=client.getPartition(dbName,tableName,ptnDesc2);
  Exception onfe=null;
  try {
    HCatPartition p1_del=client.getPartition(dbName,tableName,ptnDesc1);
  }
 catch (  Exception e) {
    onfe=e;
  }
  assertNotNull(onfe);
  assertTrue(onfe instanceof ObjectNotFoundException);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropDatabaseCommand() throws HCatException, CommandNeedRetryException {
  String dbName="cmd_testdb";
  int evid=999;
  Command testCmd=new DropDatabaseCommand(dbName,evid);
  assertEquals(evid,testCmd.getEventId());
  assertEquals(1,testCmd.get().size());
  assertEquals(true,testCmd.isRetriable());
  assertEquals(false,testCmd.isUndoable());
  CommandTestUtils.testCommandSerialization(testCmd);
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  HCatDatabase db=client.getDatabase(dbName);
  assertNotNull(db);
  LOG.info("About to run :" + testCmd.get().get(0));
  driver.run(testCmd.get().get(0));
  Exception onfe=null;
  try {
    HCatDatabase db_del=client.getDatabase(dbName);
  }
 catch (  Exception e) {
    onfe=e;
  }
  assertNotNull(onfe);
  assertTrue(onfe instanceof ObjectNotFoundException);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropPartitionCommand() throws HCatException, CommandNeedRetryException, MetaException {
  String dbName="cmd_testdb";
  String tableName="cmd_testtable";
  int evid=789;
  List<HCatFieldSchema> pcols=HCatSchemaUtils.getHCatSchema("b:string").getFields();
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("a:int").getFields();
  Map<String,String> ptnDesc=new HashMap<String,String>();
  ptnDesc.put("b","test");
  Command testReplicatedDropPtnCmd=new DropPartitionCommand(dbName,tableName,ptnDesc,true,evid);
  assertEquals(evid,testReplicatedDropPtnCmd.getEventId());
  assertEquals(1,testReplicatedDropPtnCmd.get().size());
  assertEquals(true,testReplicatedDropPtnCmd.isRetriable());
  assertEquals(false,testReplicatedDropPtnCmd.isUndoable());
  CommandTestUtils.testCommandSerialization(testReplicatedDropPtnCmd);
  Command testNormalDropPtnCmd=new DropPartitionCommand(dbName,tableName,ptnDesc,false,evid);
  assertEquals(evid,testNormalDropPtnCmd.getEventId());
  assertEquals(1,testNormalDropPtnCmd.get().size());
  assertEquals(true,testNormalDropPtnCmd.isRetriable());
  assertEquals(false,testNormalDropPtnCmd.isUndoable());
  CommandTestUtils.testCommandSerialization(testNormalDropPtnCmd);
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  Map<String,String> props=new HashMap<String,String>();
  props.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid + 5));
  HCatTable table=(new HCatTable(dbName,tableName)).tblProps(props).cols(cols).partCols(pcols);
  client.createTable(HCatCreateTableDesc.create(table).build());
  HCatTable tableCreated=client.getTable(dbName,tableName);
  assertNotNull(tableCreated);
  HCatPartition ptnToAdd=(new HCatPartition(tableCreated,ptnDesc,TestHCatClient.makePartLocation(tableCreated,ptnDesc))).parameters(props);
  client.addPartition(HCatAddPartitionDesc.create(ptnToAdd).build());
  HCatPartition p1=client.getPartition(dbName,tableName,ptnDesc);
  assertNotNull(p1);
  LOG.info("About to run :" + testReplicatedDropPtnCmd.get().get(0));
  driver.run(testReplicatedDropPtnCmd.get().get(0));
  HCatPartition p2=client.getPartition(dbName,tableName,ptnDesc);
  assertNotNull(p2);
  LOG.info("About to run :" + testNormalDropPtnCmd.get().get(0));
  driver.run(testNormalDropPtnCmd.get().get(0));
  Exception onfe=null;
  try {
    HCatPartition p_del=client.getPartition(dbName,tableName,ptnDesc);
  }
 catch (  Exception e) {
    onfe=e;
  }
  assertNotNull(onfe);
  assertTrue(onfe instanceof ObjectNotFoundException);
  Map<String,String> props2=new HashMap<String,String>();
  props2.put(ReplicationUtils.REPL_STATE_ID,String.valueOf(evid - 5));
  HCatPartition ptnToAdd2=(new HCatPartition(tableCreated,ptnDesc,TestHCatClient.makePartLocation(tableCreated,ptnDesc))).parameters(props2);
  client.addPartition(HCatAddPartitionDesc.create(ptnToAdd2).build());
  HCatPartition p3=client.getPartition(dbName,tableName,ptnDesc);
  assertNotNull(p3);
  LOG.info("About to run :" + testReplicatedDropPtnCmd.get().get(0));
  driver.run(testReplicatedDropPtnCmd.get().get(0));
  Exception onfe2=null;
  try {
    HCatPartition p_del=client.getPartition(dbName,tableName,ptnDesc);
  }
 catch (  Exception e) {
    onfe2=e;
  }
  assertNotNull(onfe2);
  assertTrue(onfe2 instanceof ObjectNotFoundException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.cli.TestSemanticAnalysis </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddPartPass() throws IOException, CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  hcatDriver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as RCFILE");
  CommandProcessorResponse response=hcatDriver.run("alter table junit_sem_analysis add partition (b='2') location '" + TEST_DATA_DIR + "'");
  assertEquals(0,response.getResponseCode());
  assertNull(response.getErrorMessage());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTableIfNotExists() throws MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table " + TBL_NAME);
  hcatDriver.run("create table " + TBL_NAME + " (a int) stored as RCFILE");
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  List<FieldSchema> cols=tbl.getSd().getCols();
  assertEquals(1,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a","int",null)));
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  CommandProcessorResponse resp=hcatDriver.run("create table if not exists junit_sem_analysis (a int) stored as RCFILE");
  assertEquals(0,resp.getResponseCode());
  assertNull(resp.getErrorMessage());
  tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  cols=tbl.getSd().getCols();
  assertEquals(1,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a","int",null)));
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCTAS() throws CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  query="create table junit_sem_analysis (a int) as select * from tbl2";
  CommandProcessorResponse response=hcatDriver.run(query);
  assertEquals(40000,response.getResponseCode());
  assertTrue(response.getErrorMessage().contains("FAILED: SemanticException Operation not supported. Create table as Select is not a valid operation."));
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseOperations() throws MetaException, CommandNeedRetryException {
  List<String> dbs=client.getAllDatabases();
  String testDb1="testdatabaseoperatons1";
  String testDb2="testdatabaseoperatons2";
  if (dbs.contains(testDb1.toLowerCase())) {
    assertEquals(0,hcatDriver.run("drop database " + testDb1).getResponseCode());
  }
  if (dbs.contains(testDb2.toLowerCase())) {
    assertEquals(0,hcatDriver.run("drop database " + testDb2).getResponseCode());
  }
  assertEquals(0,hcatDriver.run("create database " + testDb1).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb1));
  assertEquals(0,hcatDriver.run("create database if not exists " + testDb1).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb1));
  assertEquals(0,hcatDriver.run("create database if not exists " + testDb2).getResponseCode());
  assertTrue(client.getAllDatabases().contains(testDb2));
  assertEquals(0,hcatDriver.run("drop database " + testDb1).getResponseCode());
  assertEquals(0,hcatDriver.run("drop database " + testDb2).getResponseCode());
  assertFalse(client.getAllDatabases().contains(testDb1));
  assertFalse(client.getAllDatabases().contains(testDb2));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescDB() throws CommandNeedRetryException, IOException {
  hcatDriver.run("drop database mydb cascade");
  assertEquals(0,hcatDriver.run("create database mydb").getResponseCode());
  CommandProcessorResponse resp=hcatDriver.run("describe database mydb");
  assertEquals(0,resp.getResponseCode());
  ArrayList<String> result=new ArrayList<String>();
  hcatDriver.getResults(result);
  assertTrue(result.get(0).contains("mydb"));
  hcatDriver.run("drop database mydb cascade");
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddReplaceCols() throws IOException, MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  hcatDriver.run("create table junit_sem_analysis (a int, c string) partitioned by (b string) stored as RCFILE");
  CommandProcessorResponse response=hcatDriver.run("alter table junit_sem_analysis replace columns (a1 tinyint)");
  assertEquals(0,response.getResponseCode());
  response=hcatDriver.run("alter table junit_sem_analysis add columns (d tinyint)");
  assertEquals(0,response.getResponseCode());
  assertNull(response.getErrorMessage());
  response=hcatDriver.run("describe extended junit_sem_analysis");
  assertEquals(0,response.getResponseCode());
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  List<FieldSchema> cols=tbl.getSd().getCols();
  assertEquals(2,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a1","tinyint",null)));
  assertTrue(cols.get(1).equals(new FieldSchema("d","tinyint",null)));
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.common.TestHiveClientCache </h4><pre class="type-5 type-14 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheMiss() throws IOException, MetaException, LoginException {
  HiveClientCache cache=new HiveClientCache(1000);
  IMetaStoreClient client=cache.get(hiveConf);
  assertNotNull(client);
  hiveConf.setVar(HiveConf.ConfVars.METASTOREURIS," ");
  IMetaStoreClient client2=cache.get(hiveConf);
  assertNotNull(client2);
  assertNotSame(client,client2);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that a long table name actually breaks the HMSC. Subsequently check that isOpen() reflects
 * and tells if the client is broken
 */
@Ignore("hangs indefinitely") @Test public void testHMSCBreakability() throws IOException, MetaException, LoginException, TException, AlreadyExistsException, InvalidObjectException, NoSuchObjectException, InterruptedException {
  LocalMetaServer metaServer=new LocalMetaServer();
  metaServer.start();
  final HiveClientCache cache=new HiveClientCache(1000);
  HiveClientCache.CacheableHiveMetaStoreClient client=(HiveClientCache.CacheableHiveMetaStoreClient)cache.get(metaServer.getHiveConf());
  assertTrue(client.isOpen());
  final String DB_NAME="test_db";
  final String LONG_TABLE_NAME="long_table_name_" + new BigInteger(200,new Random()).toString(2);
  try {
    client.dropTable(DB_NAME,LONG_TABLE_NAME);
  }
 catch (  Exception e) {
  }
  try {
    client.dropDatabase(DB_NAME);
  }
 catch (  Exception e) {
  }
  client.createDatabase(new Database(DB_NAME,"",null,null));
  List<FieldSchema> fields=new ArrayList<FieldSchema>();
  fields.add(new FieldSchema("colname",serdeConstants.STRING_TYPE_NAME,""));
  Table tbl=new Table();
  tbl.setDbName(DB_NAME);
  tbl.setTableName(LONG_TABLE_NAME);
  StorageDescriptor sd=new StorageDescriptor();
  sd.setCols(fields);
  tbl.setSd(sd);
  sd.setSerdeInfo(new SerDeInfo());
  try {
    client.createTable(tbl);
    fail("Exception was expected while creating table with long name");
  }
 catch (  Exception e) {
  }
  assertFalse(client.isOpen());
  metaServer.shutDown();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-14 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that a new client is returned for the same configuration after the expiry time.
 * Also verify that the expiry time configuration is honoured
 */
@Test public void testCacheExpiry() throws IOException, MetaException, LoginException, InterruptedException {
  HiveClientCache cache=new HiveClientCache(1);
  HiveClientCache.ICacheableMetaStoreClient client=cache.get(hiveConf);
  assertNotNull(client);
  Thread.sleep(2500);
  HiveClientCache.ICacheableMetaStoreClient client2=cache.get(hiveConf);
  client.close();
  assertTrue(client.isClosed());
  assertNotNull(client2);
  assertNotSame(client,client2);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCacheHit() throws IOException, MetaException, LoginException {
  HiveClientCache cache=new HiveClientCache(1000);
  HiveClientCache.ICacheableMetaStoreClient client=cache.get(hiveConf);
  assertNotNull(client);
  client.close();
  hiveConf.setIntVar(HiveConf.ConfVars.DYNAMICPARTITIONMAXPARTS,10);
  HiveClientCache.ICacheableMetaStoreClient client2=cache.get(hiveConf);
  assertNotNull(client2);
  assertEquals(client.getUsers(),client2.getUsers());
  client2.close();
}

</code></pre>

<br>
<pre class="type-11 type-14 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that a *new* client is created if asked from different threads even with
 * the same hive configuration
 * @throws ExecutionException
 * @throws InterruptedException
 */
@Test public void testMultipleThreadAccess() throws ExecutionException, InterruptedException {
  final HiveClientCache cache=new HiveClientCache(1000);
class GetHiveClient implements Callable<IMetaStoreClient> {
    @Override public IMetaStoreClient call() throws IOException, MetaException, LoginException {
      return cache.get(hiveConf);
    }
  }
  ExecutorService executor=Executors.newFixedThreadPool(2);
  Callable<IMetaStoreClient> worker1=new GetHiveClient();
  Callable<IMetaStoreClient> worker2=new GetHiveClient();
  Future<IMetaStoreClient> clientFuture1=executor.submit(worker1);
  Future<IMetaStoreClient> clientFuture2=executor.submit(worker2);
  IMetaStoreClient client1=clientFuture1.get();
  IMetaStoreClient client2=clientFuture2.get();
  assertNotNull(client1);
  assertNotNull(client2);
  assertNotSame(client1,client2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.hbase.TestPigHBaseStorageHandler </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigFilterProjection() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.default.storage.type'='binary')";
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  populateHBaseTable(hbaseTableName);
  Configuration conf=new Configuration(getHbaseConf());
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes("testFamily"));
  ResultScanner scanner=table.getScanner(scan);
  int index=1;
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + databaseName + "."+ tableName+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("B = filter A by key < 5;");
  server.registerQuery("C = foreach B generate key,testqualifier2;");
  Iterator<Tuple> itr=server.openIterator("C");
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertTrue(t.size() == 2);
    assertTrue(t.get(0).getClass() == Integer.class);
    assertEquals(index,t.get(0));
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals("textB-" + index,t.get(1));
    index++;
  }
  assertEquals(index - 1,4);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigPopulation() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String POPTXT_FILE_NAME=db_dir + "testfile.txt";
  float f=-100.1f;
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, testqualifier1 float, testqualifier2 string) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.default.storage.type'='binary')";
  String selectQuery="SELECT * from " + databaseName.toLowerCase() + "."+ tableName.toLowerCase();
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  createTestDataFile(POPTXT_FILE_NAME);
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + POPTXT_FILE_NAME + "' using PigStorage() as (key:int, testqualifier1:float, testqualifier2:chararray);");
  server.registerQuery("B = filter A by (key > 2) AND (key < 8) ;");
  server.registerQuery("store B into '" + databaseName.toLowerCase() + "."+ tableName.toLowerCase()+ "' using  org.apache.hive.hcatalog.pig.HCatStorer();");
  server.registerQuery("C = load '" + databaseName.toLowerCase() + "."+ tableName.toLowerCase()+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedBSchema=server.dumpSchema("C");
  List<FieldSchema> fields=dumpedBSchema.getFields();
  assertEquals(3,fields.size());
  assertEquals(DataType.INTEGER,fields.get(0).type);
  assertEquals("key",fields.get(0).alias.toLowerCase());
  assertEquals(DataType.FLOAT,fields.get(1).type);
  assertEquals("testQualifier1".toLowerCase(),fields.get(1).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,fields.get(2).type);
  assertEquals("testQualifier2".toLowerCase(),fields.get(2).alias.toLowerCase());
  Configuration conf=new Configuration(getHbaseConf());
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes("testFamily"));
  byte[] familyNameBytes=Bytes.toBytes("testFamily");
  ResultScanner scanner=table.getScanner(scan);
  int index=3;
  int count=0;
  for (  Result result : scanner) {
    assertEquals(index,Bytes.toInt(result.getRow()));
    assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes("testQualifier1")));
    assertEquals((index + f),Bytes.toFloat(result.getValue(familyNameBytes,Bytes.toBytes("testQualifier1"))),0);
    assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes("testQualifier2")));
    assertEquals(("textB-" + index).toString(),Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes("testQualifier2"))));
    index++;
    count++;
  }
  assertEquals(count,5);
  driver.run(selectQuery);
  ArrayList<String> result=new ArrayList<String>();
  driver.getResults(result);
  assertEquals(5,result.size());
  Iterator<String> itr=result.iterator();
  for (int i=3; i <= 7; i++) {
    String tokens[]=itr.next().split("\\s+");
    assertEquals(i,Integer.parseInt(tokens[0]));
    assertEquals(i + f,Float.parseFloat(tokens[1]),0);
    assertEquals(("textB-" + i).toString(),tokens[2]);
  }
  CommandProcessorResponse responseFour=driver.run(deleteQuery);
  assertEquals(0,responseFour.getResponseCode());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigHBaseSchema() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName="testTable";
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key float, testqualifier1 string, testqualifier2 int) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.name'='"+ hbaseTableName+ "')";
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + databaseName + "."+ tableName+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedASchema=server.dumpSchema("A");
  List<FieldSchema> fields=dumpedASchema.getFields();
  assertEquals(3,fields.size());
  assertEquals(DataType.FLOAT,fields.get(0).type);
  assertEquals("key",fields.get(0).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,fields.get(1).type);
  assertEquals("testQualifier1".toLowerCase(),fields.get(1).alias.toLowerCase());
  assertEquals(DataType.INTEGER,fields.get(2).type);
  assertEquals("testQualifier2".toLowerCase(),fields.get(2).alias.toLowerCase());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.listener.TestDbNotificationListener </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropPartition() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("dropPartTable","default","me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  msClient.createTable(table);
  Partition partition=new Partition(Arrays.asList("today"),"default","dropPartTable",startTime,startTime,sd,emptyParameters);
  msClient.add_partition(partition);
  msClient.dropPartition("default","dropparttable",Arrays.asList("today"),false);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(3,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("dropparttable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"dropparttable\",\"timestamp\":[0-9]+,\"partitions\":\\[\\{\"ds\":\"today\"}]}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addPartition() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("addPartTable","default","me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  msClient.createTable(table);
  Partition partition=new Partition(Arrays.asList("today"),"default","addPartTable",startTime,startTime,sd,emptyParameters);
  msClient.add_partition(partition);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("addparttable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"ADD_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"addparttable\",\"timestamp\":[0-9]+,\"partitions\":\\[\\{\"ds\":\"today\"}]}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sqlCTAS() throws Exception {
  driver.run("create table ctas_source (c int)");
  driver.run("insert into table ctas_source values (1)");
  driver.run("create table ctas_target as select c from ctas_source");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(6,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  event=rsp.getEvents().get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(4);
  assertEquals(firstEventId + 5,event.getEventId());
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createDatabase() throws Exception {
  Database db=new Database("mydb","no description","file:/tmp",emptyParameters);
  msClient.createDatabase(db);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_DATABASE_EVENT,event.getEventType());
  assertEquals("mydb",event.getDbName());
  assertNull(event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"CREATE_DATABASE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"mydb\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void alterPartition() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("alterparttable","default","me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  msClient.createTable(table);
  Partition partition=new Partition(Arrays.asList("today"),"default","alterparttable",startTime,startTime,sd,emptyParameters);
  msClient.add_partition(partition);
  Partition newPart=new Partition(Arrays.asList("today"),"default","alterparttable",startTime,startTime + 1,sd,emptyParameters);
  msClient.alter_partition("default","alterparttable",newPart);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(3,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_ALTER_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("alterparttable",event.getTableName());
  assertTrue(event.getMessage(),event.getMessage().matches("\\{\"eventType\":\"ALTER_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":\"alterparttable\"," + "\"timestamp\":[0-9]+,\"keyValues\":\\{\"ds\":\"today\"}}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void insertPartition() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("insertPartition","default","me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  msClient.createTable(table);
  Partition partition=new Partition(Arrays.asList("today"),"default","insertPartition",startTime,startTime,sd,emptyParameters);
  msClient.add_partition(partition);
  FireEventRequestData data=new FireEventRequestData();
  InsertEventRequestData insertData=new InsertEventRequestData();
  data.setInsertData(insertData);
  insertData.addToFilesAdded("/warehouse/mytable/today/b1");
  FireEventRequest rqst=new FireEventRequest(true,data);
  rqst.setDbName("default");
  rqst.setTableName("insertPartition");
  rqst.setPartitionVals(Arrays.asList("today"));
  msClient.fireListenerEvent(rqst);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(3,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("insertPartition",event.getTableName());
  assertTrue(event.getMessage(),event.getMessage().matches("\\{\"eventType\":\"INSERT\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"insertPartition\",\"timestamp\":[0-9]+,"+ "\"files\":\\[\"/warehouse/mytable/today/b1\"],\"partKeyVals\":\\{\"ds\":\"today\"},"+ "\"partitionKeyValues\":\\{\"ds\":\"today\"}}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTable() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("mytable","default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  msClient.createTable(table);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("mytable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"CREATE_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":\"mytable\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-12 type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  long now=System.currentTimeMillis() / 1000;
  startTime=0;
  if (now > Integer.MAX_VALUE)   fail("Bummer, time has fallen over the edge");
 else   startTime=(int)now;
  firstEventId=msClient.getCurrentNotificationEventId().getEventId();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropTable() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("droptable","default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  msClient.createTable(table);
  msClient.dropTable("default","droptable");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_TABLE_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("droptable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"droptable\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void insertTable() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("insertTable","default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  msClient.createTable(table);
  FireEventRequestData data=new FireEventRequestData();
  InsertEventRequestData insertData=new InsertEventRequestData();
  data.setInsertData(insertData);
  insertData.addToFilesAdded("/warehouse/mytable/b1");
  FireEventRequest rqst=new FireEventRequest(true,data);
  rqst.setDbName("default");
  rqst.setTableName("insertTable");
  msClient.fireListenerEvent(rqst);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("insertTable",event.getTableName());
  assertTrue(event.getMessage(),event.getMessage().matches("\\{\"eventType\":\"INSERT\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"insertTable\",\"timestamp\":[0-9]+,\"files\":\\[\"/warehouse/mytable/b1\"],"+ "\"partKeyVals\":\\{},\"partitionKeyValues\":\\{}}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sqlInsertPartition() throws Exception {
  driver.run("create table sip (c int) partitioned by (ds string)");
  driver.run("insert into table sip partition (ds = 'today') values (1)");
  driver.run("insert into table sip partition (ds = 'today') values (2)");
  driver.run("insert into table sip partition (ds) values (3, 'today')");
  driver.run("alter table sip add partition (ds = 'yesterday')");
  driver.run("insert into table sip partition (ds = 'yesterday') values (2)");
  driver.run("insert into table sip partition (ds) values (3, 'yesterday')");
  driver.run("insert into table sip partition (ds) values (3, 'tomorrow')");
  driver.run("alter table sip drop partition (ds = 'tomorrow')");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  for (  NotificationEvent ne : rsp.getEvents())   LOG.debug("EVENT: " + ne.getMessage());
  assertEquals(19,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  event=rsp.getEvents().get(3);
  assertEquals(firstEventId + 4,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(6);
  assertEquals(firstEventId + 7,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(9);
  assertEquals(firstEventId + 10,event.getEventId());
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  event=rsp.getEvents().get(10);
  assertEquals(firstEventId + 11,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(13);
  assertEquals(firstEventId + 14,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(16);
  assertEquals(firstEventId + 17,event.getEventId());
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  event=rsp.getEvents().get(18);
  assertEquals(firstEventId + 19,event.getEventId());
  assertEquals(HCatConstants.HCAT_DROP_PARTITION_EVENT,event.getEventType());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropDatabase() throws Exception {
  Database db=new Database("dropdb","no description","file:/tmp",emptyParameters);
  msClient.createDatabase(db);
  msClient.dropDatabase("dropdb");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_DATABASE_EVENT,event.getEventType());
  assertEquals("dropdb",event.getDbName());
  assertNull(event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_DATABASE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"dropdb\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sqlInsertTable() throws Exception {
  driver.run("create table sit (c int)");
  driver.run("insert into table sit values (1)");
  driver.run("alter table sit add columns (c2 int)");
  driver.run("drop table sit");
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(6,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  event=rsp.getEvents().get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertEquals(HCatConstants.HCAT_INSERT_EVENT,event.getEventType());
  assertTrue(event.getMessage().matches(".*\"files\":\\[\"pfile.*"));
  event=rsp.getEvents().get(4);
  assertEquals(firstEventId + 5,event.getEventId());
  assertEquals(HCatConstants.HCAT_ALTER_TABLE_EVENT,event.getEventType());
  event=rsp.getEvents().get(5);
  assertEquals(firstEventId + 6,event.getEventId());
  assertEquals(HCatConstants.HCAT_DROP_TABLE_EVENT,event.getEventType());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void alterTable() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table("alttable","default","me",startTime,startTime,0,sd,new ArrayList<FieldSchema>(),emptyParameters,null,null,null);
  msClient.createTable(table);
  cols.add(new FieldSchema("col2","int",""));
  table=new Table("alttable","default","me",startTime,startTime,0,sd,new ArrayList<FieldSchema>(),emptyParameters,null,null,null);
  msClient.alter_table("default","alttable",table);
  NotificationEventResponse rsp=msClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,rsp.getEventsSize());
  NotificationEvent event=rsp.getEvents().get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_ALTER_TABLE_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals("alttable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"ALTER_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":\"alttable\"," + "\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.listener.TestNotificationListener </h4><pre class="type-13 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  List<String> expectedMessages=Arrays.asList(HCatConstants.HCAT_CREATE_DATABASE_EVENT,HCatConstants.HCAT_CREATE_TABLE_EVENT,HCatConstants.HCAT_ADD_PARTITION_EVENT,HCatConstants.HCAT_ALTER_PARTITION_EVENT,HCatConstants.HCAT_DROP_PARTITION_EVENT,HCatConstants.HCAT_ALTER_TABLE_EVENT,HCatConstants.HCAT_DROP_TABLE_EVENT,HCatConstants.HCAT_DROP_DATABASE_EVENT);
  Assert.assertEquals(expectedMessages,actualMessages);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.HCatMapReduceTest </h4><pre class="type-10 type-21 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void createTable() throws Exception {
  Assume.assumeTrue(!DISABLED_SERDES.contains(serdeClass));
  String databaseName=(dbName == null) ? MetaStoreUtils.DEFAULT_DATABASE_NAME : dbName;
  try {
    client.dropTable(databaseName,tableName);
  }
 catch (  Exception e) {
  }
  Table tbl=new Table();
  tbl.setDbName(databaseName);
  tbl.setTableName(tableName);
  if (isTableExternal()) {
    tbl.setTableType(TableType.EXTERNAL_TABLE.toString());
  }
 else {
    tbl.setTableType(TableType.MANAGED_TABLE.toString());
  }
  StorageDescriptor sd=new StorageDescriptor();
  sd.setCols(getTableColumns());
  tbl.setPartitionKeys(getPartitionKeys());
  tbl.setSd(sd);
  sd.setBucketCols(new ArrayList<String>(2));
  sd.setSerdeInfo(new SerDeInfo());
  sd.getSerdeInfo().setName(tbl.getTableName());
  sd.getSerdeInfo().setParameters(new HashMap<String,String>());
  sd.getSerdeInfo().getParameters().put(serdeConstants.SERIALIZATION_FORMAT,"1");
  if (isTableExternal()) {
    sd.getSerdeInfo().getParameters().put("EXTERNAL","TRUE");
  }
  sd.getSerdeInfo().setSerializationLib(serdeClass);
  sd.setInputFormat(inputFormatClass);
  sd.setOutputFormat(outputFormatClass);
  Map<String,String> tableParams=new HashMap<String,String>();
  if (isTableExternal()) {
    tableParams.put("EXTERNAL","TRUE");
  }
  if (isTableImmutable()) {
    tableParams.put(hive_metastoreConstants.IS_IMMUTABLE,"true");
  }
  tbl.setParameters(tableParams);
  client.createTable(tbl);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatHiveCompatibility </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnpartedReadWrite() throws Exception {
  driver.run("drop table if exists junit_unparted_noisd");
  String createTable="create table junit_unparted_noisd(a int) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_unparted_noisd' using org.apache.hive.hcatalog.pig.HCatStorer();");
  logAndRegister(server,"B = load 'default.junit_unparted_noisd' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(1,t.size());
    Assert.assertEquals(t.get(0),i);
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartedRead() throws Exception {
  driver.run("drop table if exists junit_parted_noisd");
  String createTable="create table junit_parted_noisd(a int) partitioned by (b string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_parted_noisd' using org.apache.hive.hcatalog.pig.HCatStorer('b=42');");
  logAndRegister(server,"B = load 'default.junit_parted_noisd' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(2,t.size());
    Assert.assertEquals(t.get(0),i);
    Assert.assertEquals(t.get(1),"42");
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  Partition ptn=client.getPartition("default","junit_parted_noisd",Arrays.asList("42"));
  Assert.assertNotNull(ptn);
  Assert.assertTrue(ptn.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatHiveThriftCompatibility </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a table with no explicit schema and ensure its correctly
 * discovered from the thrift struct.
 */
@Test public void testDynamicCols() throws Exception {
  Assert.assertEquals(0,driver.run("drop table if exists test_thrift").getResponseCode());
  Assert.assertEquals(0,driver.run("create external table test_thrift " + "partitioned by (year string) " + "row format serde 'org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer' "+ "with serdeproperties ( "+ "  'serialization.class'='org.apache.hadoop.hive.serde2.thrift.test.IntString', "+ "  'serialization.format'='org.apache.thrift.protocol.TBinaryProtocol') "+ "stored as"+ "  inputformat 'org.apache.hadoop.mapred.SequenceFileInputFormat'"+ "  outputformat 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'").getResponseCode());
  Assert.assertEquals(0,driver.run("alter table test_thrift add partition (year = '2012') location '" + intStringSeq.getParent() + "'").getResponseCode());
  PigServer pigServer=new PigServer(ExecType.LOCAL);
  pigServer.registerQuery("A = load 'test_thrift' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema expectedSchema=new Schema();
  expectedSchema.add(new Schema.FieldSchema("myint",DataType.INTEGER));
  expectedSchema.add(new Schema.FieldSchema("mystring",DataType.CHARARRAY));
  expectedSchema.add(new Schema.FieldSchema("underscore_int",DataType.INTEGER));
  expectedSchema.add(new Schema.FieldSchema("year",DataType.CHARARRAY));
  Assert.assertEquals(expectedSchema,pigServer.dumpSchema("A"));
  Iterator<Tuple> iterator=pigServer.openIterator("A");
  Tuple t=iterator.next();
  Assert.assertEquals(1,t.get(0));
  Assert.assertEquals("one",t.get(1));
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals("2012",t.get(3));
  Assert.assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatInputFormat </h4><pre class="type-10 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create an input sequence file with 100 records; every 10th record is bad.
 * Load this table into Hive.
 */
@Before @Override public void setUp() throws Exception {
  super.setUp();
  if (setUpComplete) {
    return;
  }
  Path intStringSeq=new Path(TEST_DATA_DIR + "/data/intString.seq");
  LOG.info("Creating data file: " + intStringSeq);
  SequenceFile.Writer seqFileWriter=SequenceFile.createWriter(intStringSeq.getFileSystem(hiveConf),hiveConf,intStringSeq,NullWritable.class,BytesWritable.class);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  TIOStreamTransport transport=new TIOStreamTransport(out);
  TBinaryProtocol protocol=new TBinaryProtocol(transport);
  for (int i=1; i <= 100; i++) {
    if (i % 10 == 0) {
      seqFileWriter.append(NullWritable.get(),new BytesWritable("bad record".getBytes()));
    }
 else {
      out.reset();
      IntString intString=new IntString(i,Integer.toString(i),i);
      intString.write(protocol);
      BytesWritable bytesWritable=new BytesWritable(out.toByteArray());
      seqFileWriter.append(NullWritable.get(),bytesWritable);
    }
  }
  seqFileWriter.close();
  Assert.assertEquals(0,driver.run("drop table if exists test_bad_records").getResponseCode());
  Assert.assertEquals(0,driver.run("create table test_bad_records " + "row format serde 'org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer' " + "with serdeproperties ( "+ "  'serialization.class'='org.apache.hadoop.hive.serde2.thrift.test.IntString', "+ "  'serialization.format'='org.apache.thrift.protocol.TBinaryProtocol') "+ "stored as"+ "  inputformat 'org.apache.hadoop.mapred.SequenceFileInputFormat'"+ "  outputformat 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'").getResponseCode());
  Assert.assertEquals(0,driver.run("load data local inpath '" + intStringSeq.getParent() + "' into table test_bad_records").getResponseCode());
  setUpComplete=true;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatInputFormatMethods </h4><pre class="type-10 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before @Override public void setUp() throws Exception {
  super.setUp();
  if (setUpComplete) {
    return;
  }
  Assert.assertEquals(0,driver.run("drop table if exists testHCIFMethods").getResponseCode());
  Assert.assertEquals(0,driver.run("create table testHCIFMethods (a string, b int) partitioned by (x string, y string)").getResponseCode());
  setUpComplete=true;
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPartitionAndDataColumns() throws Exception {
  Configuration conf=new Configuration();
  Job myJob=new Job(conf,"hcatTest");
  HCatInputFormat.setInput(myJob,"default","testHCIFMethods");
  HCatSchema cols=HCatInputFormat.getDataColumns(myJob.getConfiguration());
  Assert.assertTrue(cols.getFields() != null);
  Assert.assertEquals(cols.getFields().size(),2);
  Assert.assertTrue(cols.getFields().get(0).getName().equals("a"));
  Assert.assertTrue(cols.getFields().get(1).getName().equals("b"));
  Assert.assertTrue(cols.getFields().get(0).getType().equals(HCatFieldSchema.Type.STRING));
  Assert.assertTrue(cols.getFields().get(1).getType().equals(HCatFieldSchema.Type.INT));
  HCatSchema pcols=HCatInputFormat.getPartitionColumns(myJob.getConfiguration());
  Assert.assertTrue(pcols.getFields() != null);
  Assert.assertEquals(pcols.getFields().size(),2);
  Assert.assertTrue(pcols.getFields().get(0).getName().equals("x"));
  Assert.assertTrue(pcols.getFields().get(1).getName().equals("y"));
  Assert.assertTrue(pcols.getFields().get(0).getType().equals(HCatFieldSchema.Type.STRING));
  Assert.assertTrue(pcols.getFields().get(1).getType().equals(HCatFieldSchema.Type.STRING));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatMultiOutputFormat </h4><pre class="type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Simple test case.
 * <ol>
 * <li>Submits a mapred job which writes out one fixed line to each of the tables</li>
 * <li>uses hive fetch task to read the data and see if it matches what was written</li>
 * </ol>
 * @throws Exception if any error occurs
 */
@Test public void testOutputFormat() throws Throwable {
  HashMap<String,String> partitionValues=new HashMap<String,String>();
  partitionValues.put("ds","1");
  partitionValues.put("cluster","ag");
  ArrayList<OutputJobInfo> infoList=new ArrayList<OutputJobInfo>();
  infoList.add(OutputJobInfo.create("default",tableNames[0],partitionValues));
  infoList.add(OutputJobInfo.create("default",tableNames[1],partitionValues));
  infoList.add(OutputJobInfo.create("default",tableNames[2],partitionValues));
  Job job=new Job(hiveConf,"SampleJob");
  job.setMapperClass(MyMapper.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  for (int i=0; i < tableNames.length; i++) {
    configurer.addOutputFormat(tableNames[i],HCatOutputFormat.class,BytesWritable.class,HCatRecord.class);
    HCatOutputFormat.setOutput(configurer.getJob(tableNames[i]),infoList.get(i));
    HCatOutputFormat.setSchema(configurer.getJob(tableNames[i]),schemaMap.get(tableNames[i]));
  }
  configurer.configure();
  Path filePath=createInputFile();
  FileInputFormat.addInputPath(job,filePath);
  Assert.assertTrue(job.waitForCompletion(true));
  ArrayList<String> outputs=new ArrayList<String>();
  for (  String tbl : tableNames) {
    outputs.add(getTableData(tbl,"default").get(0));
  }
  Assert.assertEquals("Comparing output of table " + tableNames[0] + " is not correct",outputs.get(0),"a,a,1,ag");
  Assert.assertEquals("Comparing output of table " + tableNames[1] + " is not correct",outputs.get(1),"a,1,ag");
  Assert.assertEquals("Comparing output of table " + tableNames[2] + " is not correct",outputs.get(2),"a,a,extra,1,ag");
  for (int i=0; i < tableNames.length; i++) {
    Path partitionFile=new Path(warehousedir + "/" + tableNames[i]+ "/ds=1/cluster=ag/part-m-00000");
    FileSystem fs=partitionFile.getFileSystem(mrConf);
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile).getPermission(),new FsPermission(tablePerms[i]));
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile.getParent()).getPermission(),new FsPermission(tablePerms[i]));
    Assert.assertEquals("File permissions of table " + tableNames[i] + " is not correct",fs.getFileStatus(partitionFile.getParent().getParent()).getPermission(),new FsPermission(tablePerms[i]));
  }
  LOG.info("File permissions verified");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatNonPartitioned </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatNonPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  runMRCreate(null,partitionColumns,writeRecords,10,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(null,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_NON_EMPTY_TABLE,((HCatException)exc).getErrorType());
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc != null);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  }
  if (isTableImmutable()) {
    runMRRead(10);
  }
 else {
    runMRRead(30);
  }
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatPartitionPublish </h4><pre class="type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionPublish() throws Exception {
  String dbName="default";
  String tableName="testHCatPartitionedTable";
  createTable(null,tableName);
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","p0value1");
  ArrayList<HCatFieldSchema> hcatTableColumns=new ArrayList<HCatFieldSchema>();
  for (  FieldSchema fs : getTableColumns()) {
    hcatTableColumns.add(HCatSchemaUtils.getHCatFieldSchema(fs));
  }
  runMRCreateFail(dbName,tableName,partitionMap,hcatTableColumns);
  List<String> ptns=msc.listPartitionNames(dbName,tableName,(short)10);
  Assert.assertEquals(0,ptns.size());
  Table table=msc.getTable(dbName,tableName);
  Assert.assertTrue(table != null);
  if (!Shell.WINDOWS) {
    Path path=new Path(table.getSd().getLocation() + "/part1=p1value1/part0=p0value1");
    Assert.assertFalse(path.getFileSystem(conf).exists(path));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatPartitioned </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","501");
  runMRCreate(partitionMap,partitionColumns,writeRecords,10,true);
  partitionMap.clear();
  partitionMap.put("PART1","p1value2");
  partitionMap.put("PART0","502");
  runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertTrue(ErrorType.ERROR_DUPLICATE_PARTITION.equals(((HCatException)exc).getErrorType()));
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px1","p1value2");
  partitionMap.put("px0","502");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertNotNull(exc);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_MISSING_PARTITION_KEY,((HCatException)exc).getErrorType());
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","512");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertNotNull(exc);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  exc=null;
  try {
    runMRCreate(null,partitionColumns,writeRecords,20,false);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc == null);
  if (isTableImmutable()) {
    runMRRead(30);
  }
 else {
    runMRRead(50);
  }
  runMRRead(10,"part1 = \"p1value1\"");
  runMRRead(10,"part0 = \"501\"");
  if (isTableImmutable()) {
    runMRRead(20,"part1 = \"p1value2\"");
    runMRRead(30,"part1 = \"p1value1\" or part1 = \"p1value2\"");
    runMRRead(20,"part0 = \"502\"");
    runMRRead(30,"part0 = \"501\" or part0 = \"502\"");
  }
 else {
    runMRRead(40,"part1 = \"p1value2\"");
    runMRRead(50,"part1 = \"p1value1\" or part1 = \"p1value2\"");
    runMRRead(40,"part0 = \"502\"");
    runMRRead(50,"part0 = \"501\" or part0 = \"502\"");
  }
  tableSchemaTest();
  columnOrderChangeTest();
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestMultiOutputFormat </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A test job that reads a input file and outputs each word and the index of
 * the word encountered to a text file and sequence file with different key
 * values.
 */
@Test public void testMultiOutputFormatWithoutReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutNoReduce");
  job.setMapperClass(MultiOutWordIndexMapper.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  String fileContent="Hello World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  DistributedCache.addFileToClassPath(new Path(inputFile),job.getConfiguration(),fs);
  String dummyFile=createInputFile("dummy file");
  DistributedCache.addFileToClassPath(new Path(dummyFile),configurer.getJob("out1").getConfiguration(),fs);
  DistributedCache.addFileToClassPath(new Path(inputFile),configurer.getJob("out2").getConfiguration(),fs);
  configurer.configure();
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(job.getConfiguration());
  List<Path> fileClassPathsList=Arrays.asList(fileClassPaths);
  Assert.assertTrue("Cannot find " + (new Path(inputFile)) + " in "+ fileClassPathsList,fileClassPathsList.contains(new Path(inputFile)));
  Assert.assertTrue("Cannot find " + (new Path(dummyFile)) + " in "+ fileClassPathsList,fileClassPathsList.contains(new Path(dummyFile)));
  URI[] cacheFiles=DistributedCache.getCacheFiles(job.getConfiguration());
  List<URI> cacheFilesList=Arrays.asList(cacheFiles);
  URI inputFileURI=new Path(inputFile).makeQualified(fs).toUri();
  Assert.assertTrue("Cannot find " + inputFileURI + " in "+ cacheFilesList,cacheFilesList.contains(inputFileURI));
  URI dummyFileURI=new Path(dummyFile).makeQualified(fs).toUri();
  Assert.assertTrue("Cannot find " + dummyFileURI + " in "+ cacheFilesList,cacheFilesList.contains(dummyFileURI));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-m-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-m-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words=fileContent.split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  LOG.info("Verifying file contents");
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 1) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 1),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word count test job that reads a input file and outputs the count of
 * words to a text file and sequence file with different key values.
 */
@Test public void testMultiOutputFormatWithReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutWithReduce");
  job.setMapperClass(WordCountMapper.class);
  job.setReducerClass(MultiOutWordCountReducer.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(IntWritable.class);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  configurer.addOutputFormat("out3",NullOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  configurer.configure();
  String fileContent="Hello World Hello World World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-r-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-r-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words="Hello World".split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 2) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 2),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestSequenceFileReadWrite </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteRead() throws Exception {
  String createTable="CREATE TABLE demo_table(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + inputFileName + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteReadMR() throws Exception {
  String createTable="CREATE TABLE demo_table_2(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table_2");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-seq-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,inputFileName);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_2",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("C = load 'default.demo_table_2' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("C");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteReadMR() throws Exception {
  String createTable="CREATE TABLE demo_table_3(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_3");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-text-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setNumReduceTasks(0);
  TextInputFormat.setInputPaths(job,inputFileName);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_3",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("D = load 'default.demo_table_3' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("D");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteRead() throws Exception {
  String createTable="CREATE TABLE demo_table_1(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_1");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + inputFileName + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table_1' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table_1' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoader </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectionsBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("Y1 = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("Y2 = foreach Y1 generate a;");
  server.registerQuery("Y3 = foreach Y1 generate b,a;");
  Schema dumpedY2Schema=server.dumpSchema("Y2");
  Schema dumpedY3Schema=server.dumpSchema("Y3");
  List<FieldSchema> Y2fields=dumpedY2Schema.getFields();
  List<FieldSchema> Y3fields=dumpedY3Schema.getFields();
  assertEquals(1,Y2fields.size());
  assertEquals("a",Y2fields.get(0).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Y2fields.get(0).type);
  assertEquals(2,Y3fields.size());
  assertEquals("b",Y3fields.get(0).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,Y3fields.get(0).type);
  assertEquals("a",Y3fields.get(1).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Y3fields.get(1).type);
  int numTuplesRead=0;
  Iterator<Tuple> Y2Iter=server.openIterator("Y2");
  while (Y2Iter.hasNext()) {
    Tuple t=Y2Iter.next();
    assertEquals(t.size(),1);
    assertNotNull(t.get(0));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    numTuplesRead++;
  }
  numTuplesRead=0;
  Iterator<Tuple> Y3Iter=server.openIterator("Y3");
  while (Y3Iter.hasNext()) {
    Tuple t=Y3Iter.next();
    assertEquals(t.size(),2);
    assertNotNull(t.get(0));
    assertTrue(t.get(0).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).second);
    assertNotNull(t.get(1));
    assertTrue(t.get(1).getClass() == Integer.class);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).first);
    numTuplesRead++;
  }
  assertEquals(basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInputBytes() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  File file=new File(TEST_WAREHOUSE_DIR + "/" + SPECIFIC_SIZE_TABLE+ "/part-m-00000");
  file.deleteOnExit();
  RandomAccessFile randomAccessFile=new RandomAccessFile(file,"rw");
  randomAccessFile.setLength(2L * 1024 * 1024* 1024);
  randomAccessFile.close();
  Job job=new Job();
  HCatLoader hCatLoader=new HCatLoader();
  hCatLoader.setUDFContextSignature("testGetInputBytes");
  hCatLoader.setLocation(SPECIFIC_SIZE_TABLE,job);
  ResourceStatistics statistics=hCatLoader.getStatistics(file.getAbsolutePath(),job);
  assertEquals(2048,(long)statistics.getmBytes());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaLoadComplex() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("K = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedKSchema=server.dumpSchema("K");
  List<FieldSchema> Kfields=dumpedKSchema.getFields();
  assertEquals(6,Kfields.size());
  assertEquals(DataType.CHARARRAY,Kfields.get(0).type);
  assertEquals("name",Kfields.get(0).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Kfields.get(1).type);
  assertEquals("studentid",Kfields.get(1).alias.toLowerCase());
  assertEquals(DataType.TUPLE,Kfields.get(2).type);
  assertEquals("contact",Kfields.get(2).alias.toLowerCase());
{
    assertNotNull(Kfields.get(2).schema);
    assertTrue(Kfields.get(2).schema.getFields().size() == 2);
    assertTrue(Kfields.get(2).schema.getFields().get(0).type == DataType.CHARARRAY);
    assertTrue(Kfields.get(2).schema.getFields().get(0).alias.equalsIgnoreCase("phno"));
    assertTrue(Kfields.get(2).schema.getFields().get(1).type == DataType.CHARARRAY);
    assertTrue(Kfields.get(2).schema.getFields().get(1).alias.equalsIgnoreCase("email"));
  }
  assertEquals(DataType.BAG,Kfields.get(3).type);
  assertEquals("currently_registered_courses",Kfields.get(3).alias.toLowerCase());
{
    assertNotNull(Kfields.get(3).schema);
    assertEquals(1,Kfields.get(3).schema.getFields().size());
    assertEquals(DataType.TUPLE,Kfields.get(3).schema.getFields().get(0).type);
    assertNotNull(Kfields.get(3).schema.getFields().get(0).schema);
    assertEquals(1,Kfields.get(3).schema.getFields().get(0).schema.getFields().size());
    assertEquals(DataType.CHARARRAY,Kfields.get(3).schema.getFields().get(0).schema.getFields().get(0).type);
  }
  assertEquals(DataType.MAP,Kfields.get(4).type);
  assertEquals("current_grades",Kfields.get(4).alias.toLowerCase());
  assertEquals(DataType.BAG,Kfields.get(5).type);
  assertEquals("phnos",Kfields.get(5).alias.toLowerCase());
{
    assertNotNull(Kfields.get(5).schema);
    assertEquals(1,Kfields.get(5).schema.getFields().size());
    assertEquals(DataType.TUPLE,Kfields.get(5).schema.getFields().get(0).type);
    assertNotNull(Kfields.get(5).schema.getFields().get(0).schema);
    assertTrue(Kfields.get(5).schema.getFields().get(0).schema.getFields().size() == 2);
    assertEquals(DataType.CHARARRAY,Kfields.get(5).schema.getFields().get(0).schema.getFields().get(0).type);
    assertEquals("phno",Kfields.get(5).schema.getFields().get(0).schema.getFields().get(0).alias.toLowerCase());
    assertEquals(DataType.CHARARRAY,Kfields.get(5).schema.getFields().get(0).schema.getFields().get(1).type);
    assertEquals("type",Kfields.get(5).schema.getFields().get(0).schema.getFields().get(1).alias.toLowerCase());
  }
}

</code></pre>

<br>
<pre class="type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSchemaLoadBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedXSchema=server.dumpSchema("X");
  List<FieldSchema> Xfields=dumpedXSchema.getFields();
  assertEquals(2,Xfields.size());
  assertTrue(Xfields.get(0).alias.equalsIgnoreCase("a"));
  assertTrue(Xfields.get(0).type == DataType.INTEGER);
  assertTrue(Xfields.get(1).alias.equalsIgnoreCase("b"));
  assertTrue(Xfields.get(1).type == DataType.CHARARRAY);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the failure case caused by HIVE-10752
 * @throws Exception
 */
@Test public void testColumnarStorePushdown2() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("B = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("C = join A by name, B by name;");
  server.registerQuery("D = foreach C generate B::studentid;");
  server.registerQuery("E = ORDER D by studentid asc;");
  Iterator<Tuple> iter=server.openIterator("E");
  Tuple t=iter.next();
  assertEquals(42,t.get(0));
  t=iter.next();
  assertEquals(1337,t.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadPartitionedBasic() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),valuesReadFromHiveDriver.size());
  server.registerQuery("W = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedWSchema=server.dumpSchema("W");
  List<FieldSchema> Wfields=dumpedWSchema.getFields();
  assertEquals(3,Wfields.size());
  assertTrue(Wfields.get(0).alias.equalsIgnoreCase("a"));
  assertTrue(Wfields.get(0).type == DataType.INTEGER);
  assertTrue(Wfields.get(1).alias.equalsIgnoreCase("b"));
  assertTrue(Wfields.get(1).type == DataType.CHARARRAY);
  assertTrue(Wfields.get(2).alias.equalsIgnoreCase("bkt"));
  assertTrue(Wfields.get(2).type == DataType.CHARARRAY);
  Iterator<Tuple> WIter=server.openIterator("W");
  Collection<Pair<Integer,String>> valuesRead=new ArrayList<Pair<Integer,String>>();
  while (WIter.hasNext()) {
    Tuple t=WIter.next();
    assertTrue(t.size() == 3);
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertNotNull(t.get(2));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertTrue(t.get(2).getClass() == String.class);
    valuesRead.add(new Pair<Integer,String>((Integer)t.get(0),(String)t.get(1)));
    if ((Integer)t.get(0) < 2) {
      assertEquals("0",t.get(2));
    }
 else {
      assertEquals("1",t.get(2));
    }
  }
  assertEquals(valuesReadFromHiveDriver.size(),valuesRead.size());
  server.registerQuery("P1 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P1filter = filter P1 by bkt == '0';");
  Iterator<Tuple> P1Iter=server.openIterator("P1filter");
  int count1=0;
  while (P1Iter.hasNext()) {
    Tuple t=P1Iter.next();
    assertEquals("0",t.get(2));
    assertEquals(1,t.get(0));
    count1++;
  }
  assertEquals(3,count1);
  server.registerQuery("P2 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P2filter = filter P2 by bkt == '1';");
  Iterator<Tuple> P2Iter=server.openIterator("P2filter");
  int count2=0;
  while (P2Iter.hasNext()) {
    Tuple t=P2Iter.next();
    assertEquals("1",t.get(2));
    assertTrue(((Integer)t.get(0)) > 1);
    count2++;
  }
  assertEquals(6,count2);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertBooleanToInt() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  String tbl="test_convert_boolean_to_int";
  String inputFileName=TEST_DATA_DIR + "/testConvertBooleanToInt/data.txt";
  File inputDataDir=new File(inputFileName).getParentFile();
  inputDataDir.mkdir();
  String[] lines=new String[]{"llama\ttrue","alpaca\tfalse"};
  HcatTestUtils.createTestDataFile(inputFileName,lines);
  assertEquals(0,driver.run("drop table if exists " + tbl).getResponseCode());
  assertEquals(0,driver.run("create external table " + tbl + " (a string, b boolean) row format delimited fields terminated by '\t'"+ " stored as textfile location 'file:///"+ inputDataDir.getPath().replaceAll("\\\\","/")+ "'").getResponseCode());
  Properties properties=new Properties();
  properties.setProperty(HCatConstants.HCAT_DATA_CONVERT_BOOLEAN_TO_INTEGER,"true");
  PigServer server=new PigServer(ExecType.LOCAL,properties);
  server.registerQuery("data = load 'test_convert_boolean_to_int' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  assertEquals(2,schema.getFields().size());
  assertEquals("a",schema.getField(0).alias);
  assertEquals(DataType.CHARARRAY,schema.getField(0).type);
  assertEquals("b",schema.getField(1).alias);
  if (PigHCatUtil.pigHasBooleanSupport()) {
    assertEquals(DataType.BOOLEAN,schema.getField(1).type);
  }
 else {
    assertEquals(DataType.INTEGER,schema.getField(1).type);
  }
  Iterator<Tuple> iterator=server.openIterator("data");
  Tuple t=iterator.next();
  assertEquals("llama",t.get(0));
  assertEquals(1,t.get(1));
  t=iterator.next();
  assertEquals("alpaca",t.get(0));
  assertEquals(0,t.get(1));
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("X");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(2,t.size());
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals(basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnarStorePushdown() throws Exception {
  String PIGOUTPUT_DIR=TEST_DATA_DIR + "/colpushdownop";
  String PIG_FILE="test.pig";
  String expectedCols="0,1";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  w.println("B = foreach A generate name,studentid;");
  w.println("C = filter B by name is not null;");
  w.println("store C into '" + PIGOUTPUT_DIR + "' using PigStorage();");
  w.close();
  try {
    String[] args={"-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    OutputStats outstats=stats.getOutputStats().get(0);
    assertTrue(outstats != null);
    assertEquals(expectedCols,outstats.getConf().get(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR));
    FileSystem fs=FileSystem.get(outstats.getConf());
    if (fs.exists(new Path(PIGOUTPUT_DIR))) {
      fs.delete(new Path(PIGOUTPUT_DIR),true);
    }
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoaderEncryption </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataFromEncryptedHiveTableByPig() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + ENCRYPTED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("X");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(2,t.size());
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals("failed with storage format: " + this.storageFormat,basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataFromEncryptedHiveTableByHCatMR() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  readRecords.clear();
  Configuration conf=new Configuration();
  Job job=new Job(conf,"hcat mapreduce read encryption test");
  job.setJarByClass(this.getClass());
  job.setMapperClass(TestHCatLoaderEncryption.MapRead.class);
  job.setInputFormatClass(HCatInputFormat.class);
  job.setOutputFormatClass(TextOutputFormat.class);
  HCatInputFormat.setInput(job,MetaStoreUtils.DEFAULT_DATABASE_NAME,ENCRYPTED_TABLE,null);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setNumReduceTasks(0);
  FileSystem fs=new LocalFileSystem();
  String pathLoc=TEST_DATA_DIR + "/testHCatMREncryptionOutput";
  Path path=new Path(pathLoc);
  if (fs.exists(path)) {
    fs.delete(path,true);
  }
  TextOutputFormat.setOutputPath(job,new Path(WindowsPathUtil.getHdfsUriString(pathLoc)));
  job.waitForCompletion(true);
  int numTuplesRead=0;
  for (  HCatRecord hCatRecord : readRecords) {
    assertEquals(2,hCatRecord.size());
    assertNotNull(hCatRecord.get(0));
    assertNotNull(hCatRecord.get(1));
    assertTrue(hCatRecord.get(0).getClass() == Integer.class);
    assertTrue(hCatRecord.get(1).getClass() == String.class);
    assertEquals(hCatRecord.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(hCatRecord.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals("failed HCat MR read with storage format: " + this.storageFormat,basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoaderStorer </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test round trip of smallint/tinyint: Hive->Pig->Hive.  This is a more general use case in HCatalog:
 * 'read some data from Hive, process it in Pig, write result back to a Hive table'
 */
@Test public void testReadWrite() throws Exception {
  final String tblName="small_ints_table";
  final String tblName2="pig_hcatalog_1";
  File dataDir=new File(TEST_DATA_DIR + File.separator + "testReadWrite");
  FileUtil.fullyDelete(dataDir);
  Assert.assertTrue(dataDir.mkdir());
  final String INPUT_FILE_NAME=dataDir + "/inputtrw.data";
  TestHCatLoader.dropTable(tblName,driver);
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,new String[]{"40\t1"});
  TestHCatLoader.executeStatementOnDriver("create external table " + tblName + " (my_small_int smallint, my_tiny_int tinyint)"+ " row format delimited fields terminated by '\t' stored as textfile location '"+ dataDir.toURI().getPath()+ "'",driver);
  TestHCatLoader.dropTable(tblName2,driver);
  TestHCatLoader.createTable(tblName2,"my_small_int smallint, my_tiny_int tinyint",null,driver,"textfile");
  LOG.debug("File=" + INPUT_FILE_NAME);
  TestHCatStorer.dumpFile(INPUT_FILE_NAME);
  PigServer server=createPigServer(true);
  try {
    int queryNumber=1;
    logAndRegister(server,"A = load '" + tblName + "' using org.apache.hive.hcatalog.pig.HCatLoader() as (my_small_int:int, my_tiny_int:int);",queryNumber++);
    logAndRegister(server,"b = foreach A generate my_small_int + my_tiny_int as my_small_int, my_tiny_int;",queryNumber++);
    logAndRegister(server,"store b into '" + tblName2 + "' using org.apache.hive.hcatalog.pig.HCatStorer();",queryNumber);
    TestHCatLoader.executeStatementOnDriver("select my_small_int from " + tblName2,driver);
    ArrayList l=new ArrayList();
    driver.getResults(l);
    for (    Object t : l) {
      LOG.debug("t=" + t);
    }
    Assert.assertEquals("Expected '1' rows; got '" + l.size() + "'",1,l.size());
    int result=Integer.parseInt((String)l.get(0));
    Assert.assertEquals("Expected value '41'; got '" + result + "'",41,result);
  }
  finally {
    server.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure Pig can read/write tinyint/smallint columns.
 */
@Test public void testSmallTinyInt() throws Exception {
  String readTblName="test_small_tiny_int";
  File dataDir=new File(TEST_DATA_DIR + "/testSmallTinyIntData");
  File dataFile=new File(dataDir,"testSmallTinyInt.tsv");
  String writeTblName="test_small_tiny_int_write";
  File writeDataFile=new File(TEST_DATA_DIR,writeTblName + ".tsv");
  FileUtil.fullyDelete(dataDir);
  Assert.assertTrue(dataDir.mkdir());
  HcatTestUtils.createTestDataFile(dataFile.getAbsolutePath(),new String[]{String.format("%d\t%d",Short.MIN_VALUE,Byte.MIN_VALUE),String.format("%d\t%d",Short.MAX_VALUE,Byte.MAX_VALUE)});
  Assert.assertEquals(0,driver.run("drop table if exists " + readTblName).getResponseCode());
  Assert.assertEquals(0,driver.run("create external table " + readTblName + " (my_small_int smallint, my_tiny_int tinyint)"+ " row format delimited fields terminated by '\t' stored as textfile").getResponseCode());
  Assert.assertEquals(0,driver.run("load data local inpath '" + dataDir.getPath().replaceAll("\\\\","/") + "' into table "+ readTblName).getResponseCode());
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("data = load '" + readTblName + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  Assert.assertEquals(2,schema.getFields().size());
  Assert.assertEquals("my_small_int",schema.getField(0).alias);
  Assert.assertEquals(DataType.INTEGER,schema.getField(0).type);
  Assert.assertEquals("my_tiny_int",schema.getField(1).alias);
  Assert.assertEquals(DataType.INTEGER,schema.getField(1).type);
  Iterator<Tuple> it=server.openIterator("data");
  Tuple t=it.next();
  Assert.assertEquals(new Integer(Short.MIN_VALUE),t.get(0));
  Assert.assertEquals(new Integer(Byte.MIN_VALUE),t.get(1));
  t=it.next();
  Assert.assertEquals(new Integer(Short.MAX_VALUE),t.get(0));
  Assert.assertEquals(new Integer(Byte.MAX_VALUE),t.get(1));
  Assert.assertFalse(it.hasNext());
  Assert.assertEquals(0,driver.run("drop table if exists " + writeTblName).getResponseCode());
  Assert.assertEquals(0,driver.run("create table " + writeTblName + " (my_small_int smallint, my_tiny_int tinyint) stored as rcfile").getResponseCode());
  HcatTestUtils.createTestDataFile(writeDataFile.getAbsolutePath(),new String[]{String.format("%d\t%d",Short.MIN_VALUE,Byte.MIN_VALUE),String.format("%d\t%d",Short.MAX_VALUE,Byte.MAX_VALUE)});
  smallTinyIntBoundsCheckHelper(writeDataFile.getPath().replaceAll("\\\\","/"),ExecJob.JOB_STATUS.COMPLETED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/shortTooSmall.tsv",new String[]{String.format("%d\t%d",Short.MIN_VALUE - 1,0)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/shortTooSmall.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/shortTooBig.tsv",new String[]{String.format("%d\t%d",Short.MAX_VALUE + 1,0)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/shortTooBig.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/byteTooSmall.tsv",new String[]{String.format("%d\t%d",0,Byte.MIN_VALUE - 1)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/byteTooSmall.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/byteTooBig.tsv",new String[]{String.format("%d\t%d",0,Byte.MAX_VALUE + 1)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/byteTooBig.tsv",ExecJob.JOB_STATUS.FAILED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorer </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartColsInData() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "\t1";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertEquals(2,t.size());
    assertEquals(t.get(0),i);
    assertEquals(t.get(1),"1");
    i++;
  }
  assertFalse(itr.hasNext());
  assertEquals(LOOP_SIZE,i);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagNStruct() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(b string,a struct<a1:int>,  arr_of_struct array<string>, " + "arr_of_struct2 array<struct<s1:string,s2:string>>,  arr_of_struct3 array<struct<s3:string>>) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData=new String[]{"zookeeper\t(2)\t{(pig)}\t{(pnuts,hdfs)}\t{(hadoop),(hcat)}","chubby\t(2)\t{(sawzall)}\t{(bigtable,gfs)}\t{(mapreduce),(hcat)}"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (b:chararray, a:tuple(a1:int), arr_of_struct:bag{mytup:tuple(s1:chararray)}, arr_of_struct2:bag{mytup:tuple(s1:chararray,s2:chararray)}, arr_of_struct3:bag{t3:tuple(s3:chararray)});");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','b:chararray, a:tuple(a1:int),"+ " arr_of_struct:bag{mytup:tuple(s1:chararray)}, arr_of_struct2:bag{mytup:tuple(s1:chararray,s2:chararray)}, arr_of_struct3:bag{t3:tuple(s3:chararray)}');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  assertEquals("zookeeper\t{\"a1\":2}\t[\"pig\"]\t[{\"s1\":\"pnuts\",\"s2\":\"hdfs\"}]\t[{\"s3\":\"hadoop\"},{\"s3\":\"hcat\"}]",itr.next());
  assertEquals("chubby\t{\"a1\":2}\t[\"sawzall\"]\t[{\"s1\":\"bigtable\",\"s2\":\"gfs\"}]\t[{\"s3\":\"mapreduce\"},{\"s3\":\"hcat\"}]",itr.next());
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-6 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a data file with datatypes added in 0.13.  Read it with Pig and use
 * Pig + HCatStorer to write to a Hive table.  Then read it using Pig and Hive
 * and make sure results match.
 */
@Test public void testDateCharTypes() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  final String tblName="junit_date_char";
  TestHCatLoader.dropTable(tblName,driver);
  TestHCatLoader.createTable(tblName,"id int, char5 char(5), varchar10 varchar(10), dec52 decimal(5,2)",null,driver,storageFormat);
  int NUM_ROWS=5;
  String[] rows=new String[NUM_ROWS];
  for (int i=0; i < NUM_ROWS; i++) {
    rows[i]=i + "\txxxxx\tyyy\t" + 5.2;
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,rows);
  LOG.debug("File=" + INPUT_FILE_NAME);
  PigServer server=createPigServer(true);
  int queryNumber=1;
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (id:int, char5:chararray, varchar10:chararray, dec52:bigdecimal);",queryNumber++);
  logAndRegister(server,"store A into '" + tblName + "' using "+ HCatStorer.class.getName()+ "();",queryNumber++);
  logAndRegister(server,"B = load '" + tblName + "' using "+ HCatLoader.class.getName()+ "();",queryNumber);
  CommandProcessorResponse cpr=driver.run("select * from " + tblName);
  LOG.debug("cpr.respCode=" + cpr.getResponseCode() + " cpr.errMsg="+ cpr.getErrorMessage());
  List l=new ArrayList();
  driver.getResults(l);
  LOG.debug("Dumping rows via SQL from " + tblName);
  for (  Object t : l) {
    LOG.debug(t == null ? null : t.toString());
  }
  Iterator<Tuple> itr=server.openIterator("B");
  int numRowsRead=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    StringBuilder rowFromPig=new StringBuilder();
    for (int i=0; i < t.size(); i++) {
      rowFromPig.append(t.get(i)).append("\t");
    }
    rowFromPig.setLength(rowFromPig.length() - 1);
    assertEquals("Comparing Pig to Raw data",rows[numRowsRead],rowFromPig.toString());
    numRowsRead++;
  }
  assertEquals("Expected " + NUM_ROWS + " rows; got "+ numRowsRead+ " file="+ INPUT_FILE_NAME,NUM_ROWS,numRowsRead);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-21 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyStore() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a > 100;");
  server.registerQuery("store B into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreMultiTables() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  driver.run("drop table junit_unparted2");
  createTable="create table junit_unparted2(a int, b string) stored as RCFILE";
  retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a < 2;");
  server.registerQuery("store B into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.registerQuery("C = filter A by a >= 2;");
  server.registerQuery("store C into 'junit_unparted2' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("select * from junit_unparted2");
  ArrayList<String> res2=new ArrayList<String>();
  driver.getResults(res2);
  res.addAll(res2);
  driver.run("drop table junit_unparted");
  driver.run("drop table junit_unparted2");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncSimple() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      assertEquals(si + "\t" + j,itr.next());
    }
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoSchema() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDynamicPartitioningMultiPartColsInDataNoSpec() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table if exists employee");
  String createTable="CREATE TABLE employee (emp_id INT, emp_name STRING, emp_start_date STRING , emp_gender STRING ) " + " PARTITIONED BY (emp_country STRING , emp_state STRING ) STORED AS " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData={"111237\tKrishna\t01/01/1990\tM\tIN\tTN","111238\tKalpana\t01/01/2000\tF\tIN\tKA","111239\tSatya\t01/01/2001\tM\tIN\tKL","111240\tKavya\t01/01/2002\tF\tIN\tAP"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.setBatchOn();
  pig.registerQuery("A = LOAD '" + INPUT_FILE_NAME + "' USING PigStorage() AS (emp_id:int,emp_name:chararray,emp_start_date:chararray,"+ "emp_gender:chararray,emp_country:chararray,emp_state:chararray);");
  pig.registerQuery("IN = FILTER A BY emp_country == 'IN';");
  pig.registerQuery("STORE IN INTO 'employee' USING " + HCatStorer.class.getName() + "();");
  pig.executeBatch();
  driver.run("select * from employee");
  ArrayList<String> results=new ArrayList<String>();
  driver.getResults(results);
  assertEquals(4,results.size());
  Collections.sort(results);
  assertEquals(inputData[0],results.get(0));
  assertEquals(inputData[1],results.get(1));
  assertEquals(inputData[2],results.get(2));
  assertEquals(inputData[3],results.get(3));
  driver.run("drop table employee");
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoAlias() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_parted");
  String createTable="create table junit_parted(a int, b string) partitioned by (ds string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  PigServer server=new PigServer(ExecType.LOCAL);
  boolean errCaught=false;
  try {
    server.setBatchOn();
    server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
    server.registerQuery("B = foreach A generate a+10, b;");
    server.registerQuery("store B into 'junit_parted' using " + HCatStorer.class.getName() + "('ds=20100101');");
    server.executeBatch();
  }
 catch (  PigException fe) {
    PigException pe=LogUtils.getPigException(fe);
    assertTrue(pe instanceof FrontendException);
    assertEquals(PigHCatUtil.PIG_EXCEPTION_CODE,pe.getErrorCode());
    assertTrue(pe.getMessage().contains("Column name for a field is not specified. Please provide the full schema as an argument to HCatStorer."));
    errCaught=true;
  }
  assertTrue(errCaught);
  errCaught=false;
  try {
    server.setBatchOn();
    server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, B:chararray);");
    server.registerQuery("B = foreach A generate a, B;");
    server.registerQuery("store B into 'junit_parted' using " + HCatStorer.class.getName() + "('ds=20100101');");
    server.executeBatch();
  }
 catch (  PigException fe) {
    PigException pe=LogUtils.getPigException(fe);
    assertTrue(pe instanceof FrontendException);
    assertEquals(PigHCatUtil.PIG_EXCEPTION_CODE,pe.getErrorCode());
    assertTrue(pe.getMessage().contains("Column names should all be in lowercase. Invalid name found: B"));
    errCaught=true;
  }
  driver.run("drop table junit_parted");
  assertTrue(errCaught);
}

</code></pre>

<br>
<pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDynamicPartitioningMultiPartColsInDataPartialSpec() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table if exists employee");
  String createTable="CREATE TABLE employee (emp_id INT, emp_name STRING, emp_start_date STRING , emp_gender STRING ) " + " PARTITIONED BY (emp_country STRING , emp_state STRING ) STORED AS " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData={"111237\tKrishna\t01/01/1990\tM\tIN\tTN","111238\tKalpana\t01/01/2000\tF\tIN\tKA","111239\tSatya\t01/01/2001\tM\tIN\tKL","111240\tKavya\t01/01/2002\tF\tIN\tAP"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.setBatchOn();
  pig.registerQuery("A = LOAD '" + INPUT_FILE_NAME + "' USING PigStorage() AS (emp_id:int,emp_name:chararray,emp_start_date:chararray,"+ "emp_gender:chararray,emp_country:chararray,emp_state:chararray);");
  pig.registerQuery("IN = FILTER A BY emp_country == 'IN';");
  pig.registerQuery("STORE IN INTO 'employee' USING " + HCatStorer.class.getName() + "('emp_country=IN');");
  pig.executeBatch();
  driver.run("select * from employee");
  ArrayList<String> results=new ArrayList<String>();
  driver.getResults(results);
  assertEquals(4,results.size());
  Collections.sort(results);
  assertEquals(inputData[0],results.get(0));
  assertEquals(inputData[1],results.get(1));
  assertEquals(inputData[2],results.get(2));
  assertEquals(inputData[3],results.get(3));
  driver.run("drop table employee");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncAllSimpleTypes() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b float, c double, d bigint, e string, h boolean, f binary, g binary) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int i=0;
  String[] input=new String[3];
  input[i++]="0\t\t\t\t\t\t\t";
  input[i++]="\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "true" + "\tbinary-data";
  input[i++]=i + "\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "false" + "\tbinary-data";
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  Iterator<String> itr=res.iterator();
  String next=itr.next();
  assertEquals("0\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL",next);
  assertEquals("NULL\t4.2\t2.2\t4\tlets hcat\ttrue\tbinary-data\tNULL",itr.next());
  assertEquals("3\t6.2999997\t3.3000000000000003\t6\tlets hcat\tfalse\tbinary-data\tNULL",itr.next());
  assertFalse(itr.hasNext());
  server.registerQuery("B = load 'junit_unparted' using " + HCatLoader.class.getName() + ";");
  Iterator<Tuple> iter=server.openIterator("B");
  int count=0;
  int num5nulls=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    if (t.get(6) == null) {
      num5nulls++;
    }
 else {
      assertTrue(t.get(6) instanceof DataByteArray);
    }
    assertNull(t.get(7));
    count++;
  }
  assertEquals(3,count);
  assertEquals(1,num5nulls);
  driver.run("drop table junit_unparted");
}

</code></pre>

<br>
<pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiPartColsInData() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table employee");
  String createTable="CREATE TABLE employee (emp_id INT, emp_name STRING, emp_start_date STRING , emp_gender STRING ) " + " PARTITIONED BY (emp_country STRING , emp_state STRING ) STORED AS " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData={"111237\tKrishna\t01/01/1990\tM\tIN\tTN","111238\tKalpana\t01/01/2000\tF\tIN\tKA","111239\tSatya\t01/01/2001\tM\tIN\tKL","111240\tKavya\t01/01/2002\tF\tIN\tAP"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.setBatchOn();
  pig.registerQuery("A = LOAD '" + INPUT_FILE_NAME + "' USING PigStorage() AS (emp_id:int,emp_name:chararray,emp_start_date:chararray,"+ "emp_gender:chararray,emp_country:chararray,emp_state:chararray);");
  pig.registerQuery("TN = FILTER A BY emp_state == 'TN';");
  pig.registerQuery("KA = FILTER A BY emp_state == 'KA';");
  pig.registerQuery("KL = FILTER A BY emp_state == 'KL';");
  pig.registerQuery("AP = FILTER A BY emp_state == 'AP';");
  pig.registerQuery("STORE TN INTO 'employee' USING " + HCatStorer.class.getName() + "('emp_country=IN,emp_state=TN');");
  pig.registerQuery("STORE KA INTO 'employee' USING " + HCatStorer.class.getName() + "('emp_country=IN,emp_state=KA');");
  pig.registerQuery("STORE KL INTO 'employee' USING " + HCatStorer.class.getName() + "('emp_country=IN,emp_state=KL');");
  pig.registerQuery("STORE AP INTO 'employee' USING " + HCatStorer.class.getName() + "('emp_country=IN,emp_state=AP');");
  pig.executeBatch();
  driver.run("select * from employee");
  ArrayList<String> results=new ArrayList<String>();
  driver.getResults(results);
  assertEquals(4,results.size());
  Collections.sort(results);
  assertEquals(inputData[0],results.get(0));
  assertEquals(inputData[1],results.get(1));
  assertEquals(inputData[2],results.get(2));
  assertEquals(inputData[3],results.get(3));
  driver.run("drop table employee");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreInPartiitonedTbl() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertEquals(2,t.size());
    assertEquals(t.get(0),i);
    assertEquals(t.get(1),"1");
    i++;
  }
  assertFalse(itr.hasNext());
  assertEquals(11,i);
}

</code></pre>

<br>
<pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDynamicPartitioningMultiPartColsNoDataInDataNoSpec() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table if exists employee");
  String createTable="CREATE TABLE employee (emp_id INT, emp_name STRING, emp_start_date STRING , emp_gender STRING ) " + " PARTITIONED BY (emp_country STRING , emp_state STRING ) STORED AS " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData={};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer pig=new PigServer(ExecType.LOCAL);
  pig.setBatchOn();
  pig.registerQuery("A = LOAD '" + INPUT_FILE_NAME + "' USING PigStorage() AS (emp_id:int,emp_name:chararray,emp_start_date:chararray,"+ "emp_gender:chararray,emp_country:chararray,emp_state:chararray);");
  pig.registerQuery("IN = FILTER A BY emp_country == 'IN';");
  pig.registerQuery("STORE IN INTO 'employee' USING " + HCatStorer.class.getName() + "();");
  pig.executeBatch();
  driver.run("select * from employee");
  ArrayList<String> results=new ArrayList<String>();
  driver.getResults(results);
  assertEquals(0,results.size());
  driver.run("drop table employee");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoCtorArgs() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionPublish() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table ptn_fail");
  String createTable="create table ptn_fail(a int, c string) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "\tmath";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, c:chararray);");
  server.registerQuery("B = filter A by " + FailEvalFunc.class.getName() + "($0);");
  server.registerQuery("store B into 'ptn_fail' using " + HCatStorer.class.getName() + "('b=math');");
  server.executeBatch();
  String query="show partitions ptn_fail";
  retCode=driver.run(query).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Error " + retCode + " running query "+ query);
  }
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  assertEquals(0,res.size());
  assertTrue((new File(TEST_WAREHOUSE_DIR + "/ptn_fail")).exists());
  assertFalse((new File(TEST_WAREHOUSE_DIR + "/ptn_fail/b=math")).exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorerMulti </h4><pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStorePartitionedTable() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  createTable(PARTITIONED_TABLE,"a int, b string","bkt string");
  populateBasicFile();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B2 = filter A by a < 2;");
  server.registerQuery("store B2 into '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatStorer('bkt=0');");
  server.registerQuery("C2 = filter A by a >= 2;");
  server.registerQuery("store C2 into '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatStorer('bkt=1');");
  server.executeBatch();
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> partitionedTableValuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(partitionedTableValuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),partitionedTableValuesReadFromHiveDriver.size());
}

</code></pre>

<br>
<pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreBasicTable() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  createTable(BASIC_TABLE,"a int, b string");
  populateBasicFile();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  driver.run("select * from " + BASIC_TABLE);
  ArrayList<String> unpartitionedTableValuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(unpartitionedTableValuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),unpartitionedTableValuesReadFromHiveDriver.size());
}

</code></pre>

<br>
<pre class="type-10 type-21 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  if (driver == null) {
    HiveConf hiveConf=new HiveConf(this.getClass());
    hiveConf.set(HiveConf.ConfVars.PREEXECHOOKS.varname,"");
    hiveConf.set(HiveConf.ConfVars.POSTEXECHOOKS.varname,"");
    hiveConf.set(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname,"false");
    hiveConf.set(HiveConf.ConfVars.METASTOREWAREHOUSE.varname,TEST_WAREHOUSE_DIR);
    hiveConf.setVar(HiveConf.ConfVars.HIVEMAPREDMODE,"nonstrict");
    driver=new Driver(hiveConf);
    SessionState.start(new CliSessionState(hiveConf));
  }
  cleanup();
}

</code></pre>

<br>
<pre class="type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreTableMulti() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  createTable(BASIC_TABLE,"a int, b string");
  createTable(PARTITIONED_TABLE,"a int, b string","bkt string");
  populateBasicFile();
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.registerQuery("B2 = filter A by a < 2;");
  server.registerQuery("store B2 into '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatStorer('bkt=0');");
  server.registerQuery("C2 = filter A by a >= 2;");
  server.registerQuery("store C2 into '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatStorer('bkt=1');");
  server.executeBatch();
  driver.run("select * from " + BASIC_TABLE);
  ArrayList<String> unpartitionedTableValuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(unpartitionedTableValuesReadFromHiveDriver);
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> partitionedTableValuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(partitionedTableValuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),unpartitionedTableValuesReadFromHiveDriver.size());
  assertEquals(basicInputData.size(),partitionedTableValuesReadFromHiveDriver.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorerWrapper </h4><pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreExternalTableWithExternalDir() throws IOException, CommandNeedRetryException {
  File tmpExternalDir=new File(TEST_DATA_DIR,UUID.randomUUID().toString());
  tmpExternalDir.deleteOnExit();
  String part_val="100";
  driver.run("drop table junit_external");
  String createTable="create external table junit_external(a int, b string) partitioned by (c string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  logAndRegister(server,"store A into 'default.junit_external' using " + HCatStorerWrapper.class.getName() + "('c="+ part_val+ "','"+ tmpExternalDir.getPath().replaceAll("\\\\","/")+ "');");
  server.executeBatch();
  Assert.assertTrue(tmpExternalDir.exists());
  boolean found=false;
  File[] f=tmpExternalDir.listFiles();
  if (f != null) {
    for (    File fin : f) {
      if (fin.getPath().contains("part-m-00000")) {
        found=true;
      }
    }
  }
  Assert.assertTrue(found);
  driver.run("select * from junit_external");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_external");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      Assert.assertEquals(si + "\t" + j+ "\t"+ part_val,itr.next());
    }
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestDelimitedInputWriter </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFieldReordering() throws Exception {
  ArrayList<String> colNames=Lists.newArrayList(new String[]{"col1","col2","col3","col4","col5"});
{
    String[] fieldNames={null,"col2",null,"col4",null};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{-1,1,-1,3,-1}));
  }
{
    String[] fieldNames={"col5","col4","col3","col2","col1"};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{4,3,2,1,0}));
  }
{
    String[] fieldNames={"xyz","abc","col3","col4","as"};
    try {
      DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
      Assert.fail();
    }
 catch (    InvalidColumn e) {
    }
  }
{
    String[] fieldNames={"col3","col4"};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{2,3}));
  }
{
    String[] fieldNames={"col5","col4","col3","col2","col1","col1"};
    try {
      DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
      Assert.fail();
    }
 catch (    InvalidColumn e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestStreaming </h4><pre class="type-4 type-5 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddPartition() throws Exception {
  List<String> newPartVals=new ArrayList<String>(2);
  newPartVals.add(PART1_CONTINENT);
  newPartVals.add("Nepal");
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName,tblName,newPartVals);
  try {
    msClient.getPartition(endPt.database,endPt.table,endPt.partitionVals);
    Assert.assertTrue("Partition already exists",false);
  }
 catch (  NoSuchObjectException e) {
  }
  Assert.assertNotNull(endPt.newConnection(true,null));
  Partition p=msClient.getPartition(endPt.database,endPt.table,endPt.partitionVals);
  Assert.assertNotNull("Did not find added partition",p);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHeartbeat() throws Exception {
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName2,tblName2,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(fieldNames2,",",endPt);
  StreamingConnection connection=endPt.newConnection(false,null);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(5,writer);
  txnBatch.beginNextTransaction();
  ShowLocksResponse response=msClient.showLocks();
  Assert.assertEquals("Wrong nubmer of locks: " + response,1,response.getLocks().size());
  ShowLocksResponseElement lock=response.getLocks().get(0);
  long acquiredAt=lock.getAcquiredat();
  long heartbeatAt=lock.getLastheartbeat();
  txnBatch.heartbeat();
  response=msClient.showLocks();
  Assert.assertEquals("Wrong number of locks2: " + response,1,response.getLocks().size());
  lock=response.getLocks().get(0);
  Assert.assertEquals("Acquired timestamp didn't match",acquiredAt,lock.getAcquiredat());
  Assert.assertTrue("Expected new heartbeat (" + lock.getLastheartbeat() + ") == old heartbeat("+ heartbeatAt+ ")",lock.getLastheartbeat() == heartbeatAt);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorHandling() throws Exception {
  runCmdOnDriver("create database testErrors");
  runCmdOnDriver("use testErrors");
  runCmdOnDriver("create table T(a int, b int) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')");
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,"testErrors","T",null);
  DelimitedInputWriter innerWriter=new DelimitedInputWriter("a,b".split(","),",",endPt);
  FaultyWriter writer=new FaultyWriter(innerWriter);
  StreamingConnection connection=endPt.newConnection(false);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.close();
  txnBatch.heartbeat();
  txnBatch.abort();
  GetOpenTxnsInfoResponse r=msClient.showTxns();
  Assert.assertEquals("HWM didn't match",2,r.getTxn_high_water_mark());
  List<TxnInfo> ti=r.getOpen_txns();
  Assert.assertEquals("wrong status ti(0)",TxnState.ABORTED,ti.get(0).getState());
  Assert.assertEquals("wrong status ti(1)",TxnState.ABORTED,ti.get(1).getState());
  Exception expectedEx=null;
  try {
    txnBatch.beginNextTransaction();
  }
 catch (  IllegalStateException ex) {
    expectedEx=ex;
  }
  Assert.assertTrue("beginNextTransaction() should have failed",expectedEx != null && expectedEx.getMessage().contains("has been closed()"));
  expectedEx=null;
  try {
    txnBatch.write("name0,1,Hello streaming".getBytes());
  }
 catch (  IllegalStateException ex) {
    expectedEx=ex;
  }
  Assert.assertTrue("write()  should have failed",expectedEx != null && expectedEx.getMessage().contains("has been closed()"));
  expectedEx=null;
  try {
    txnBatch.commit();
  }
 catch (  IllegalStateException ex) {
    expectedEx=ex;
  }
  Assert.assertTrue("commit() should have failed",expectedEx != null && expectedEx.getMessage().contains("has been closed()"));
  txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("name2,2,Welcome to streaming".getBytes());
  txnBatch.write("name4,2,more Streaming unlimited".getBytes());
  txnBatch.write("name5,2,even more Streaming unlimited".getBytes());
  txnBatch.commit();
  expectedEx=null;
  txnBatch.beginNextTransaction();
  writer.enableErrors();
  try {
    txnBatch.write("name6,2,Doh!".getBytes());
  }
 catch (  StreamingIOFailure ex) {
    expectedEx=ex;
  }
  Assert.assertTrue("Wrong exception: " + (expectedEx != null ? expectedEx.getMessage() : "?"),expectedEx != null && expectedEx.getMessage().contains("Simulated fault occurred"));
  expectedEx=null;
  try {
    txnBatch.commit();
  }
 catch (  IllegalStateException ex) {
    expectedEx=ex;
  }
  Assert.assertTrue("commit() should have failed",expectedEx != null && expectedEx.getMessage().contains("has been closed()"));
  r=msClient.showTxns();
  Assert.assertEquals("HWM didn't match",4,r.getTxn_high_water_mark());
  ti=r.getOpen_txns();
  Assert.assertEquals("wrong status ti(0)",TxnState.ABORTED,ti.get(0).getState());
  Assert.assertEquals("wrong status ti(1)",TxnState.ABORTED,ti.get(1).getState());
  Assert.assertEquals("wrong status ti(2)",TxnState.ABORTED,ti.get(2).getState());
  writer.disableErrors();
  txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("name2,2,Welcome to streaming".getBytes());
  writer.enableErrors();
  expectedEx=null;
  try {
    txnBatch.commit();
  }
 catch (  StreamingIOFailure ex) {
    expectedEx=ex;
  }
  Assert.assertTrue("Wrong exception: " + (expectedEx != null ? expectedEx.getMessage() : "?"),expectedEx != null && expectedEx.getMessage().contains("Simulated fault occurred"));
  r=msClient.showTxns();
  Assert.assertEquals("HWM didn't match",6,r.getTxn_high_water_mark());
  ti=r.getOpen_txns();
  Assert.assertEquals("wrong status ti(3)",TxnState.ABORTED,ti.get(3).getState());
  Assert.assertEquals("wrong status ti(4)",TxnState.ABORTED,ti.get(4).getState());
  txnBatch.abort();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.mutate.client.TestMutatorClient </h4><pre class="type-3 type-5 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaStoreFailsOnConnect() throws Exception {
  when(mockMetaStoreClient.getTable(anyString(),anyString())).thenThrow(new TException());
  try {
    client.connect();
    fail();
  }
 catch (  ConnectionException e) {
  }
  assertThat(client.isConnected(),is(false));
}

</code></pre>

<br>
<pre class="type-3 type-5 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckNonTransactionalTableConnect() throws Exception {
  when(mockParameters.get("transactional")).thenReturn(Boolean.FALSE.toString());
  try {
    client.connect();
    fail();
  }
 catch (  ConnectionException e) {
  }
  assertThat(client.isConnected(),is(false));
}

</code></pre>

<br>
<pre class="type-3 type-5 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckUnBucketedTableConnect() throws Exception {
  when(mockSd.getNumBuckets()).thenReturn(0);
  try {
    client.connect();
    fail();
  }
 catch (  ConnectionException e) {
  }
  assertThat(client.isConnected(),is(false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.mutate.client.lock.TestLock </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAcquireReadLockWithNoIssues() throws Exception {
  readLock.acquire();
  assertEquals(Long.valueOf(LOCK_ID),readLock.getLockId());
  assertNull(readLock.getTransactionId());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAcquireReadLockCheckLocks() throws Exception {
  readLock.acquire();
  verify(mockMetaStoreClient).lock(requestCaptor.capture());
  LockRequest request=requestCaptor.getValue();
  assertEquals(0,request.getTxnid());
  assertEquals(USER,request.getUser());
  assertEquals(InetAddress.getLocalHost().getHostName(),request.getHostname());
  List<LockComponent> components=request.getComponent();
  assertEquals(2,components.size());
  LockComponent expected1=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"DB");
  expected1.setTablename("SOURCE_1");
  assertTrue(components.contains(expected1));
  LockComponent expected2=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"DB");
  expected2.setTablename("SOURCE_2");
  assertTrue(components.contains(expected2));
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAcquireTxnLockCheckLocks() throws Exception {
  writeLock.acquire(TRANSACTION_ID);
  verify(mockMetaStoreClient).lock(requestCaptor.capture());
  LockRequest request=requestCaptor.getValue();
  assertEquals(TRANSACTION_ID,request.getTxnid());
  assertEquals(USER,request.getUser());
  assertEquals(InetAddress.getLocalHost().getHostName(),request.getHostname());
  List<LockComponent> components=request.getComponent();
  assertEquals(3,components.size());
  LockComponent expected1=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"DB");
  expected1.setTablename("SOURCE_1");
  assertTrue(components.contains(expected1));
  LockComponent expected2=new LockComponent(LockType.SHARED_READ,LockLevel.TABLE,"DB");
  expected2.setTablename("SOURCE_2");
  assertTrue(components.contains(expected2));
  LockComponent expected3=new LockComponent(LockType.SHARED_WRITE,LockLevel.TABLE,"DB");
  expected3.setTablename("SINK");
  assertTrue(components.contains(expected3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.TestWebHCatE2e </h4><pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void describeNoSuchTable() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/no_such_table",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.NOT_FOUND_404,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),ErrorMsg.INVALID_TABLE.getErrorCode(),getErrorCode(p.responseBody));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getHiveVersion() throws Exception {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/version/hive",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(HttpStatus.OK_200,p.httpStatusCode);
  Map<String,Object> props=JsonBuilder.jsonToMap(p.responseBody);
  Assert.assertEquals("hive",props.get("module"));
  Assert.assertTrue(p.getAssertMsg(),((String)props.get("version")).matches("[0-9]+.[0-9]+.[0-9]+.*"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getStatus() throws IOException {
  LOG.debug("+getStatus()");
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/status",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
  Assert.assertTrue(p.getAssertMsg(),jsonStringToSortedMap("{\"status\":\"ok\",\"version\":\"v1\"}").equals(jsonStringToSortedMap(p.responseBody)));
  LOG.debug("-getStatus()");
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void createTable() throws IOException {
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("comment","Table in default db");
  Map<String,Object> col=new HashMap<String,Object>();
  col.put("name","col1");
  col.put("type","string");
  List<Map<String,Object>> colList=new ArrayList<Map<String,Object>>(1);
  colList.add(col);
  props.put("columns",colList);
  Map<String,Object> format=new HashMap<String,Object>();
  format.put("storedAs","rcfile");
  props.put("format",format);
  MethodCallRetVal createTbl=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/test_table",HTTP_METHOD_TYPE.PUT,props,null);
  Assert.assertEquals(createTbl.getAssertMsg(),HttpStatus.OK_200,createTbl.httpStatusCode);
  LOG.info("createTable() resp: " + createTbl.responseBody);
  MethodCallRetVal descTbl=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/test_table",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(descTbl.getAssertMsg(),HttpStatus.OK_200,descTbl.httpStatusCode);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void listDataBases() throws IOException {
  LOG.debug("+listDataBases()");
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),"{\"databases\":[\"default\"]}",p.responseBody);
  LOG.debug("-listDataBases()");
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void createDataBase() throws IOException {
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("comment","Hello, there");
  props.put("location",System.getProperty("test.warehouse.dir"));
  Map<String,String> props2=new HashMap<String,String>();
  props2.put("prop","val");
  props.put("properties",props2);
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/newdb",HTTP_METHOD_TYPE.PUT,props,null);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tries to drop table in a DB that doesn't exist
 */
@Ignore("not ready due to HIVE-4824") @Test public void dropTableNoSuchDB() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/no_such_db/table/t1",HTTP_METHOD_TYPE.DELETE);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.NOT_FOUND_404,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),ErrorMsg.DATABASE_NOT_EXISTS.getErrorCode(),getErrorCode(p.responseBody));
}

</code></pre>

<br>
<pre class="type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tries to drop table that doesn't exist (with ifExists=true)
 */
@Ignore("not ready due to HIVE-4824") @Test public void dropTableIfExists() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/no_such_table",HTTP_METHOD_TYPE.DELETE,null,new NameValuePair[]{new NameValuePair("ifExists","true")});
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
}

</code></pre>

<br>
<pre class="type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getHadoopVersion() throws Exception {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/version/hadoop",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(HttpStatus.OK_200,p.httpStatusCode);
  Map<String,Object> props=JsonBuilder.jsonToMap(p.responseBody);
  Assert.assertEquals("hadoop",props.get("module"));
  Assert.assertTrue(p.getAssertMsg(),((String)props.get("version")).matches("[1-2].[0-9]+.[0-9]+.*"));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tries to drop table in a DB that doesn't exist
 */
@Ignore("not ready due to HIVE-4824") @Test public void dropTableNoSuchDbIfExists() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/no_such_db/table/t1",HTTP_METHOD_TYPE.DELETE,null,new NameValuePair[]{new NameValuePair("ifExists","true")});
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.NOT_FOUND_404,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),ErrorMsg.DATABASE_NOT_EXISTS.getErrorCode(),getErrorCode(p.responseBody));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTempletonUtils </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncodeArray(){
  Assert.assertEquals(null,TempletonUtils.encodeArray((String[])null));
  String[] tmp=new String[0];
  Assert.assertTrue(TempletonUtils.encodeArray(new String[0]).length() == 0);
  tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  Assert.assertEquals("fred,,peter" + StringUtils.ESCAPE_CHAR + ",lisa"+ StringUtils.ESCAPE_CHAR+ ","+ StringUtils.ESCAPE_CHAR+ ", barney",TempletonUtils.encodeArray(tmp));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecodeArray(){
  Assert.assertTrue(TempletonUtils.encodeArray((String[])null) == null);
  String[] tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  String[] tmp2=TempletonUtils.decodeArray(TempletonUtils.encodeArray(tmp));
  try {
    for (int i=0; i < tmp.length; i++) {
      Assert.assertEquals((String)tmp[i],(String)tmp2[i]);
    }
  }
 catch (  Exception e) {
    Assert.fail("Arrays were not equal" + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtractPercentComplete(){
  Assert.assertNull(TempletonUtils.extractPercentComplete("fred"));
  for (  String line : CONTROLLER_LINES) {
    Assert.assertNull(TempletonUtils.extractPercentComplete(line));
  }
  String fifty="2011-12-15 18:12:36,333 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 50% complete";
  Assert.assertEquals("50% complete",TempletonUtils.extractPercentComplete(fifty));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstructingUserHomeDirectory() throws Exception {
  String[] sources=new String[]{"output+","/user/hadoop/output","hdfs://container","hdfs://container/","hdfs://container/path","output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  String[] expectedResults=new String[]{"/user/webhcat/output+","/user/hadoop/output","hdfs://container/user/webhcat","hdfs://container/","hdfs://container/path","/user/webhcat/output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  for (int i=0; i < sources.length; i++) {
    String source=sources[i];
    String expectedResult=expectedResults[i];
    String result=TempletonUtils.addUserHomeDirectoryIfApplicable(source,"webhcat");
    Assert.assertEquals(result,expectedResult);
  }
  String badUri="c:\\some\\path";
  try {
    TempletonUtils.addUserHomeDirectoryIfApplicable(badUri,"webhcat");
    Assert.fail("addUserHomeDirectoryIfApplicable should fail for bad URI: " + badUri);
  }
 catch (  URISyntaxException ex) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsListAsString(){
  try {
    String tmpFileName1="/tmp/testHadoopFsListAsString1";
    String tmpFileName2="/tmp/testHadoopFsListAsString2";
    File tmpFile1=new File(tmpFileName1);
    File tmpFile2=new File(tmpFileName2);
    tmpFile1.createNewFile();
    tmpFile2.createNewFile();
    Assert.assertTrue(TempletonUtils.hadoopFsListAsString(null,null,null) == null);
    Assert.assertTrue(TempletonUtils.hadoopFsListAsString("/tmp,/usr",null,null) == null);
    Assert.assertEquals("file:" + tmpFileName1 + ",file:"+ tmpFileName2,TempletonUtils.hadoopFsListAsString(tmpFileName1 + "," + tmpFileName2,new Configuration(),null));
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsListAsString("/scoobydoo/teddybear,joe",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsFilename(){
  try {
    String tmpFileName1="/tmp/testHadoopFsListAsArray1";
    String tmpFileName2="/tmp/testHadoopFsListAsArray2";
    File tmpFile1=new File(tmpFileName1);
    File tmpFile2=new File(tmpFileName2);
    tmpFile1.createNewFile();
    tmpFile2.createNewFile();
    Assert.assertEquals(null,TempletonUtils.hadoopFsFilename(null,null,null));
    Assert.assertEquals(null,TempletonUtils.hadoopFsFilename(tmpFile.toURI().toString(),null,null));
    Assert.assertEquals(tmpFile.toURI().toString(),TempletonUtils.hadoopFsFilename(tmpFile.toURI().toString(),new Configuration(),null));
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for /tmp");
    Assert.fail("Couldn't find name for " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsFilename("/scoobydoo/teddybear",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsPath(){
  try {
    TempletonUtils.hadoopFsPath(null,null,null);
    TempletonUtils.hadoopFsPath(tmpFile.toURI().toString(),null,null);
    TempletonUtils.hadoopFsPath(tmpFile.toURI().toString(),new Configuration(),null);
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsPath("/scoobydoo/teddybear",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsPath("a",new Configuration(),"teddybear");
    Assert.fail("Should not have found /user/teddybear/a");
  }
 catch (  FileNotFoundException e) {
    Assert.assertTrue(e.getMessage().contains("/user/teddybear/a"));
  }
catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Get wrong exception: " + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHadoopFsListAsArray(){
  try {
    String tmpFileName1="/tmp/testHadoopFsListAsArray1";
    String tmpFileName2="/tmp/testHadoopFsListAsArray2";
    File tmpFile1=new File(tmpFileName1);
    File tmpFile2=new File(tmpFileName2);
    tmpFile1.createNewFile();
    tmpFile2.createNewFile();
    Assert.assertTrue(TempletonUtils.hadoopFsListAsArray(null,null,null) == null);
    Assert.assertTrue(TempletonUtils.hadoopFsListAsArray(tmpFileName1 + "," + tmpFileName2,null,null) == null);
    String[] tmp2=TempletonUtils.hadoopFsListAsArray(tmpFileName1 + "," + tmpFileName2,new Configuration(),null);
    Assert.assertEquals("file:" + tmpFileName1,tmp2[0]);
    Assert.assertEquals("file:" + tmpFileName2,tmp2[1]);
    tmpFile1.delete();
    tmpFile2.delete();
  }
 catch (  FileNotFoundException e) {
    Assert.fail("Couldn't find name for " + tmpFile.toURI().toString());
  }
catch (  Exception e) {
    e.printStackTrace();
  }
  try {
    TempletonUtils.hadoopFsListAsArray("/scoobydoo/teddybear,joe",new Configuration(),null);
    Assert.fail("Should not have found /scoobydoo/teddybear");
  }
 catch (  FileNotFoundException e) {
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<pre class="type-10 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup(){
  try {
    tmpFile=new File(testDataDir,"tmp");
    tmpFile.createNewFile();
    usrFile=new File(testDataDir,"usr");
    usrFile.createNewFile();
  }
 catch (  IOException ex) {
    Assert.fail(ex.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTrivialExecService </h4><pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  ArrayList<String> list=new ArrayList<String>();
  list.add("echo");
  list.add("success");
  BufferedReader out=null;
  BufferedReader err=null;
  try {
    Process process=TrivialExecService.getInstance().run(list,new ArrayList<String>(),new HashMap<String,String>());
    out=new BufferedReader(new InputStreamReader(process.getInputStream()));
    err=new BufferedReader(new InputStreamReader(process.getErrorStream()));
    Assert.assertEquals("success",out.readLine());
    out.close();
    String line;
    while ((line=err.readLine()) != null) {
      Assert.fail(line);
    }
    process.waitFor();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Process caused exception.");
  }
 finally {
    try {
      out.close();
    }
 catch (    Exception ex) {
    }
    try {
      err.close();
    }
 catch (    Exception ex) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcDriver2 </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify 'explain ...' resultset
 * @throws SQLException
 */
@Test public void testExplainStmt() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("explain select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),1);
  assertEquals(md.getColumnLabel(1),EXPL_COLUMN_NAME);
  assertTrue("Nothing returned explain",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-10 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  con=getConnection("default");
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("set hive.support.concurrency = false");
  createTestTables(stmt,"",true);
  createTestTables(stmt,"testdb.",false);
  stmt.execute("drop table " + externalTable);
  stmt.execute("create external table " + externalTable + " (a int) comment '"+ externalTableComment+ "' location '"+ dataFileDir+ "'");
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("c12_1",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeTable() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("describe " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  assertEquals("Column type 'under_col' for column under_col not found","int",res.getString(2));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertEquals("Column type 'string' for column key not found","string",res.getString(2));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.1234560",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the cancellation of a query that is running.
 * We spawn 2 threads - one running the query and
 * the other attempting to cancel.
 * We're using a dummy udf to simulate a query,
 * that runs for a sufficiently long time.
 * @throws Exception
 */
@Test public void testQueryCancel() throws Exception {
  String udfName=SleepUDF.class.getName();
  Statement stmt1=con.createStatement();
  stmt1.execute("create temporary function sleepUDF as '" + udfName + "'");
  stmt1.close();
  final Statement stmt=con.createStatement();
  Thread tExecute=new Thread(new Runnable(){
    @Override public void run(){
      try {
        System.out.println("Executing query: ");
        stmt.executeQuery("select sleepUDF(t1.under_col) as u0, t1.under_col as u1, " + "t2.under_col as u2 from " + tableName + "t1 join "+ tableName+ " t2 on t1.under_col = t2.under_col");
        fail("Expecting SQLException");
      }
 catch (      SQLException e) {
        assertNotNull(e);
        System.out.println(e.toString());
      }
    }
  }
);
  Thread tCancel=new Thread(new Runnable(){
    @Override public void run(){
      try {
        Thread.sleep(1000);
        System.out.println("Cancelling query: ");
        stmt.cancel();
      }
 catch (      Exception e) {
      }
    }
  }
);
  tExecute.start();
  tCancel.start();
  tExecute.join();
  tCancel.join();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-13 type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  dropTestTables(stmt,"");
  dropTestTables(stmt,"testdb.");
  con.close();
  assertTrue("Connection should be closed",con.isClosed());
  Exception expectedException=null;
  try {
    con.createStatement();
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("createStatement() on closed connection should throw exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getProcedureColumns()
 * @throws SQLException
 */
@Test public void testProcCols() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedureColumns(null,null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),20);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting using builtin UDFs
 * @throws SQLException
 */
@Test public void testBuiltInUDFCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c12, bin(c12) from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(2),"c1");
  assertTrue(res.next());
  assertEquals(res.getLong(1),1);
  assertEquals(res.getString(2),"1");
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log when HS2 disable logging.
 * @throws Exception
 */
@Test public void testGetQueryLogOnDisabledLog() throws Exception {
  Statement setStmt=con.createStatement();
  setStmt.execute("set hive.server2.logging.operation.enabled = false");
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10);
  stmt.close();
  assertTrue(logs.size() == 0);
  setStmt.execute("set hive.server2.logging.operation.enabled = true");
  setStmt.close();
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset methods
 * @throws Exception
 */
@Test public void testFetchFirstError() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  try {
    res.beforeFirst();
    fail("beforeFirst() should fail for normal resultset");
  }
 catch (  SQLException e) {
    assertEquals("Method not supported for TYPE_FORWARD_ONLY resultset",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetSchemas() throws SQLException {
  ResultSet rs=con.getMetaData().getSchemas();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(2,resMeta.getColumnCount());
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(1));
  assertEquals("TABLE_CATALOG",resMeta.getColumnName(2));
  assertTrue(rs.next());
  assertEquals("default",rs.getString(1));
  assertTrue(rs.next());
  assertEquals("testdb",rs.getString(1));
  assertFalse(rs.next());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test testProccedures()
 * @throws SQLException
 */
@Test public void testProccedures() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedures(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),9);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetExternalTables() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("set " + HiveConf.ConfVars.HIVE_SERVER2_TABLE_TYPE_MAPPING.varname + " = "+ TableTypeMappings.HIVE.toString());
  stmt.close();
  ResultSet rs=con.getMetaData().getTables(null,null,null,new String[]{TableType.EXTERNAL_TABLE.toString()});
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(10,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(2));
  assertEquals("TABLE_NAME",resMeta.getColumnName(3));
  assertEquals("TABLE_TYPE",resMeta.getColumnName(4));
  assertEquals("REMARKS",resMeta.getColumnName(5));
  rs.next();
  String resultDbName=rs.getString("TABLE_SCHEM");
  assertEquals(resultDbName,"default");
  String resultTableName=rs.getString("TABLE_NAME");
  assertEquals(resultTableName,externalTable.toLowerCase());
  String resultTableComment=rs.getString("REMARKS");
  assertTrue("Missing comment on the table.",resultTableComment.length() > 0);
  String tableType=rs.getString("TABLE_TYPE");
  assertEquals(TableType.EXTERNAL_TABLE.toString(),tableType);
  assertFalse("Unexpected table",rs.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting named expression columns
 * @throws SQLException
 */
@Test public void testExprCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1+1 as col1, length(c4) as len from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(1),"col1");
  assertEquals(md.getColumnLabel(2),"len");
  assertTrue(res.next());
  assertEquals(res.getInt(1),2);
  assertEquals(res.getInt(2),1);
  res.close();
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorDiag() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("select from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
  try {
    stmt.executeQuery("select * from nonTable");
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42S02",e.getSQLState());
  }
  try {
    stmt.executeQuery("select zzzz from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetCatalogs() throws SQLException {
  ResultSet rs=con.getMetaData().getCatalogs();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(1,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertFalse(rs.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseMetaData() throws SQLException {
  DatabaseMetaData meta=con.getMetaData();
  assertEquals("Apache Hive",meta.getDatabaseProductName());
  assertEquals(HiveVersionInfo.getVersion(),meta.getDatabaseProductVersion());
  assertEquals(System.getProperty("hive.version"),meta.getDatabaseProductVersion());
  assertTrue("verifying hive version pattern. got " + meta.getDatabaseProductVersion(),Pattern.matches("\\d+\\.\\d+\\.\\d+.*",meta.getDatabaseProductVersion()));
  assertEquals(DatabaseMetaData.sqlStateSQL99,meta.getSQLStateType());
  assertFalse(meta.supportsCatalogsInTableDefinitions());
  assertTrue(meta.supportsSchemasInTableDefinitions());
  assertTrue(meta.supportsSchemasInDataManipulation());
  assertFalse(meta.supportsMultipleResultSets());
  assertFalse(meta.supportsStoredProcedures());
  assertTrue(meta.supportsAlterTableWithAddColumn());
  assertTrue(meta.getDatabaseMajorVersion() > -1);
  assertTrue(meta.getDatabaseMinorVersion() > -1);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getPrimaryKeys()
 * @throws SQLException
 */
@Test public void testPrimaryKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getPrimaryKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),6);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetColumnNameCaseInsensitive() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res;
  res=stmt.executeQuery("select c1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
  res=stmt.executeQuery("select c1 C1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowGrant() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("grant select on table " + dataTypeTableName + " to user hive_test_user");
  stmt.execute("show grant user hive_test_user on table " + dataTypeTableName);
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("default",res.getString(1));
  assertEquals(dataTypeTableName,res.getString(2));
  assertEquals("",res.getString(3));
  assertEquals("",res.getString(4));
  assertEquals("hive_test_user",res.getString(5));
  assertEquals("USER",res.getString(6));
  assertEquals("SELECT",res.getString(7));
  assertEquals(false,res.getBoolean(8));
  assertEquals(-1,res.getLong(9));
  assertNotNull(res.getString(10));
  assertFalse(res.next());
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParentReferences() throws Exception {
  Statement s=this.con.createStatement();
  ResultSet rs=s.executeQuery("SELECT * FROM " + dataTypeTableName);
  assertTrue(s.getConnection() == this.con);
  assertTrue(rs.getStatement() == s);
  rs.close();
  s.close();
  PreparedStatement ps=this.con.prepareStatement("SELECT * FROM " + dataTypeTableName);
  rs=ps.executeQuery();
  assertTrue(ps.getConnection() == this.con);
  assertTrue(rs.getStatement() == ps);
  rs.close();
  ps.close();
  DatabaseMetaData md=this.con.getMetaData();
  assertTrue(md.getConnection() == this.con);
  rs=md.getCatalogs();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getFunctions(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getImportedKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getPrimaryKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedureColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedures(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getSchemas();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTableTypes();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTables(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTypeInfo();
  assertNull(rs.getStatement());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getImportedKeys()
 * @throws SQLException
 */
@Test public void testImportedKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getImportedKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),14);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateColumnNameOrder() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet rs=stmt.executeQuery("SELECT 1 AS a, 2 AS a from " + tableName);
  assertTrue(rs.next());
  assertEquals(1,rs.getInt("a"));
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * validate schema generated by "set" command
 * @throws SQLException
 */
@Test public void testSetCommand() throws SQLException {
  String sql="set -v";
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery(sql);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(1,md.getColumnCount());
  assertEquals(SET_COLUMN_NAME,md.getColumnLabel(1));
  int numLines=0;
  while (res.next()) {
    numLines++;
    String rline=res.getString(1);
    assertFalse("set output must not contain hidden variables such as the metastore password:" + rline,rline.contains(HiveConf.ConfVars.METASTOREPWD.varname) && !(rline.contains(HiveConf.ConfVars.HIVE_CONF_HIDDEN_LIST.varname)));
  }
  assertTrue("Nothing returned by set -v",numLines > 0);
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutoCommit() throws Exception {
  con.clearWarnings();
  con.setAutoCommit(true);
  assertNull(con.getWarnings());
  con.setAutoCommit(false);
  SQLWarning warning=con.getWarnings();
  assertNotNull(warning);
  assertEquals("Hive does not support autoCommit=false",warning.getMessage());
  assertNull(warning.getNextWarning());
  con.clearWarnings();
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset attributes
 * @throws Exception
 */
@Test public void testUnsupportedFetchTypes() throws Exception {
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_READ_ONLY);
    fail("createStatement with TYPE_SCROLL_SENSITIVE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
    fail("createStatement with CONCUR_UPDATABLE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullType() throws Exception {
  Statement stmt=con.createStatement();
  try {
    ResultSet res=stmt.executeQuery("select null from " + dataTypeTableName);
    assertTrue(res.next());
    assertNull(res.getObject(1));
  }
  finally {
    stmt.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.execute("drop role role1");
  }
 catch (  Exception ex) {
    LOG.warn("Ignoring error during drop role: " + ex);
  }
  stmt.execute("create role role1");
  stmt.execute("grant role role1 to user hive_test_user");
  stmt.execute("show role grant user hive_test_user");
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("public",res.getString(1));
  assertTrue(res.next());
  assertEquals("role1",res.getString(1));
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetTimestamp() throws SQLException, ParseException {
  String sql=String.format("SELECT * FROM %s WHERE c17 = ?",dataTypeTableName);
  try (PreparedStatement ps=con.prepareStatement(sql)){
    Timestamp timestamp=Timestamp.valueOf("2012-04-22 09:00:00.123456789");
    ps.setTimestamp(1,timestamp);
    try (ResultSet resultSet=ps.executeQuery()){
      assertTrue(resultSet.next());
      assertEquals(1,resultSet.getInt(1));
      assertFalse(resultSet.next());
    }
   }
 }

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowColumns() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show columns in " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaDataDuplicateColumnNames() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1 as c2_1, c2, c1*2 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(3,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c2_1",meta.getColumnName(1));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertTrue(colRS.next());
  assertEquals("c2_2",meta.getColumnName(3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithLocalClusterSpark </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPermFunc() throws Exception {
  String udfClassName="org.apache.hadoop.hive.contrib.udf.example.UDFExampleAdd";
  String mvnRepo=System.getProperty("maven.local.repository");
  String hiveVersion=System.getProperty("hive.version");
  String jarFileName="hive-contrib-" + hiveVersion + ".jar";
  String[] pathParts={"org","apache","hive","hive-contrib",hiveVersion,jarFileName};
  Path contribJarPath=new Path(mvnRepo);
  for (  String pathPart : pathParts) {
    contribJarPath=new Path(contribJarPath,pathPart);
  }
  FileSystem localFs=FileSystem.getLocal(conf);
  assertTrue("Hive contrib JAR exists at " + contribJarPath,localFs.exists(contribJarPath));
  String hdfsJarPathStr="hdfs:///" + jarFileName;
  Path hdfsJarPath=new Path(hdfsJarPathStr);
  FileSystem dfs=miniHS2.getDFS().getFileSystem();
  dfs.copyFromLocalFile(contribJarPath,hdfsJarPath);
  assertTrue("Verify contrib JAR copied to HDFS at " + hdfsJarPath,dfs.exists(hdfsJarPath));
  String queryStr="CREATE FUNCTION example_add AS '" + udfClassName + "'"+ " USING JAR '"+ hdfsJarPathStr+ "'";
  stmt.execute(queryStr);
  ResultSet res;
  res=stmt.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  String tableName="testTab3";
  setupKv1Tabs(tableName);
  res=stmt.executeQuery("SELECT EXAMPLE_ADD(1, 2) FROM " + tableName + " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(3,res.getInt(1));
  assertFalse("no more results",res.next());
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  res=stmt2.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  res=stmt2.executeQuery("SELECT " + dbName + ".example_add(1, 1) FROM "+ tableName+ " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(2,res.getInt(1));
  assertFalse("no more results",res.next());
  stmt.execute("DROP TABLE " + tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniHS2 </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionSchemaAPIs() throws Exception {
  String db1="DB1";
  HiveConnection hiveConn=(HiveConnection)hs2Conn;
  assertEquals("default",hiveConn.getSchema());
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("DROP DATABASE IF EXISTS " + db1 + " CASCADE");
  stmt.execute("CREATE DATABASE " + db1);
  assertEquals("default",hiveConn.getSchema());
  stmt.execute("USE " + db1);
  assertEquals(db1,hiveConn.getSchema());
  stmt.execute("USE default");
  assertEquals("default",hiveConn.getSchema());
  hiveConn.setSchema(db1);
  assertEquals(db1,hiveConn.getSchema());
  hiveConn.setSchema("default");
  assertEquals("default",hiveConn.getSchema());
  assertTrue(hiveConn.getCatalog().isEmpty());
  hiveConn.setCatalog("foo");
  assertTrue(hiveConn.getCatalog().isEmpty());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentStatements() throws Exception {
  String tableName="testConcurrentStatements";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("DROP TABLE IF EXISTS " + tableName);
  stmt.execute("CREATE TABLE " + tableName + " (under_col INT COMMENT 'the under column', value STRING) COMMENT ' test table'");
  stmt.execute("load data local inpath '" + kvDataFilePath.toString() + "' into table "+ tableName);
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  assertTrue(res.next());
  res.close();
  stmt.close();
  int POOL_SIZE=100;
  int TASK_COUNT=300;
  SynchronousQueue<Runnable> executorQueue=new SynchronousQueue<Runnable>();
  ExecutorService workers=new ThreadPoolExecutor(1,POOL_SIZE,20,TimeUnit.SECONDS,executorQueue);
  List<Future<Boolean>> list=new ArrayList<Future<Boolean>>();
  int i=0;
  while (i < TASK_COUNT) {
    try {
      Future<Boolean> future=workers.submit(new JDBCTask(hs2Conn,i,tableName));
      list.add(future);
      i++;
    }
 catch (    RejectedExecutionException ree) {
      try {
        TimeUnit.MILLISECONDS.sleep(100);
      }
 catch (      InterruptedException e) {
        Thread.currentThread().interrupt();
      }
    }
  }
  for (  Future<Boolean> future : list) {
    try {
      Boolean result=future.get(30,TimeUnit.SECONDS);
      assertTrue(result);
    }
 catch (    ExecutionException ee) {
      fail("Concurrent Statement failed: " + ee.getCause());
    }
catch (    TimeoutException te) {
      System.out.println("Task was timeout after 30 second: " + te);
    }
catch (    CancellationException ce) {
      System.out.println("Task was interrupted: " + ce);
    }
catch (    InterruptedException ie) {
      System.out.println("Thread was interrupted: " + ie);
    }
  }
  workers.shutdown();
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for http header size
 * @throws Exception
 */
@Test public void testHttpHeaderSize() throws Exception {
  if (miniHS2.isStarted()) {
    miniHS2.stop();
  }
  HiveConf conf=new HiveConf();
  conf.set("hive.server2.transport.mode","http");
  conf.setInt("hive.server2.thrift.http.request.header.size",1024);
  conf.setInt("hive.server2.thrift.http.response.header.size",1024);
  miniHS2=new MiniHS2(conf);
  Map<String,String> confOverlay=new HashMap<String,String>();
  miniHS2.start(confOverlay);
  String userName=StringUtils.leftPad("*",100);
  try {
    hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  }
 catch (  Exception e) {
    fail("Not expecting exception: " + e);
  }
  userName=StringUtils.leftPad("*",2000);
  try {
    hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  }
 catch (  Exception e) {
    assertTrue("Header exception thrown",e != null);
    assertTrue(e.getMessage().contains("HTTP Response code: 413"));
  }
  if (miniHS2.isStarted()) {
    miniHS2.stop();
  }
  conf.setInt("hive.server2.thrift.http.request.header.size",3000);
  conf.setInt("hive.server2.thrift.http.response.header.size",3000);
  miniHS2=new MiniHS2(conf);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=getConnection(miniHS2.getJdbcURL(),userName,"password");
  }
 catch (  Exception e) {
    fail("Not expecting exception: " + e);
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test UDF blacklist
 * - verify default value
 * - verify udfs allowed with default blacklist
 * - verify udf disallowed when in blacklist
 * @throws Exception
 */
@Test public void testUdfBlackList() throws Exception {
  HiveConf testConf=new HiveConf();
  assertTrue(testConf.getVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_BLACKLIST).isEmpty());
  Statement stmt=hs2Conn.createStatement();
  stmt.executeQuery("SELECT substr('foobar', 4) ");
  miniHS2.stop();
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_BLACKLIST,"reflect");
  miniHS2=new MiniHS2(testConf);
  miniHS2.start(new HashMap<String,String>());
  hs2Conn=getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  try {
    stmt.executeQuery("SELECT reflect('java.lang.String', 'valueOf', 1) ");
    fail("reflect() udf invocation should fail");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnection() throws Exception {
  String tableName="testTab1";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("DROP TABLE IF EXISTS " + tableName);
  stmt.execute("CREATE TABLE " + tableName + " (under_col INT COMMENT 'the under column', value STRING) COMMENT ' test table'");
  stmt.execute("load data local inpath '" + kvDataFilePath.toString() + "' into table "+ tableName);
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  assertTrue(res.next());
  assertEquals("val_238",res.getString(2));
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test is to connect to any database without using the command "Use <<DB>>"
 * 1)connect to default database.
 * 2) Create a new DB test_default.
 * 3) Connect to test_default database.
 * 4) Connect and create table under test_default_test.
 * 5) Connect and display all tables.
 * 6) Connect to default database and shouldn't find table test_default_test.
 * 7) Connect and drop test_default_test.
 * 8) drop test_default database.
 */
@Test public void testURIDatabaseName() throws Exception {
  String jdbcUri=miniHS2.getJdbcURL().substring(0,miniHS2.getJdbcURL().indexOf("default"));
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  String dbName="test_connection_non_default_db";
  String tableInNonDefaultSchema="table_in_non_default_schema";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("create database  if not exists " + dbName);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  boolean expected=stmt.execute(" create table " + tableInNonDefaultSchema + " (x int)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name  " + tableInNonDefaultSchema + "   found in SHOW TABLES result set",testTableExists);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  res=stmt.executeQuery("show tables");
  testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertFalse("table name " + tableInNonDefaultSchema + "  NOT  found in SHOW TABLES result set",testTableExists);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  res=stmt.executeQuery("show tables");
  stmt.execute(" drop table if exists table_in_non_default_schema");
  expected=stmt.execute("DROP DATABASE " + dbName);
  stmt.close();
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  res=stmt.executeQuery("show tables");
  testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  hs2Conn=getConnection(jdbcUri,System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + ";",System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + ";/foo=bar;foo1=bar1",System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test UDF whitelist
 * - verify default value
 * - verify udf allowed with default whitelist
 * - verify udf allowed with specific whitelist
 * - verify udf disallowed when not in whitelist
 * @throws Exception
 */
@Test public void testUdfWhiteList() throws Exception {
  HiveConf testConf=new HiveConf();
  assertTrue(testConf.getVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_WHITELIST).isEmpty());
  Statement stmt=hs2Conn.createStatement();
  stmt.executeQuery("SELECT substr('foobar', 4) ");
  hs2Conn.close();
  miniHS2.stop();
  Set<String> funcNames=FunctionRegistry.getFunctionNames();
  funcNames.remove("reflect");
  String funcNameStr="";
  for (  String funcName : funcNames) {
    funcNameStr+="," + funcName;
  }
  funcNameStr=funcNameStr.substring(1);
  testConf.setVar(ConfVars.HIVE_SERVER2_BUILTIN_UDF_WHITELIST,funcNameStr);
  miniHS2=new MiniHS2(testConf);
  miniHS2.start(new HashMap<String,String>());
  hs2Conn=getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  stmt.executeQuery("SELECT substr('foobar', 3) ");
  try {
    stmt.executeQuery("SELECT reflect('java.lang.String', 'valueOf', 1) ");
    fail("reflect() udf invocation should fail");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniMr </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPermFunc() throws Exception {
  String udfClassName="org.apache.hadoop.hive.contrib.udf.example.UDFExampleAdd";
  String mvnRepo=System.getProperty("maven.local.repository");
  String hiveVersion=System.getProperty("hive.version");
  String jarFileName="hive-contrib-" + hiveVersion + ".jar";
  String[] pathParts={"org","apache","hive","hive-contrib",hiveVersion,jarFileName};
  Path contribJarPath=new Path(mvnRepo);
  for (  String pathPart : pathParts) {
    contribJarPath=new Path(contribJarPath,pathPart);
  }
  FileSystem localFs=FileSystem.getLocal(conf);
  assertTrue("Hive contrib JAR exists at " + contribJarPath,localFs.exists(contribJarPath));
  String hdfsJarPathStr="hdfs:///" + jarFileName;
  Path hdfsJarPath=new Path(hdfsJarPathStr);
  FileSystem dfs=miniHS2.getDFS().getFileSystem();
  dfs.copyFromLocalFile(contribJarPath,hdfsJarPath);
  assertTrue("Verify contrib JAR copied to HDFS at " + hdfsJarPath,dfs.exists(hdfsJarPath));
  String queryStr="CREATE FUNCTION example_add AS '" + udfClassName + "'"+ " USING JAR '"+ hdfsJarPathStr+ "'";
  stmt.execute(queryStr);
  ResultSet res;
  res=stmt.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  String tableName="testTab3";
  setupKv1Tabs(tableName);
  res=stmt.executeQuery("SELECT EXAMPLE_ADD(1, 2) FROM " + tableName + " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(3,res.getInt(1));
  assertFalse("no more results",res.next());
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  res=stmt2.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  res=stmt2.executeQuery("SELECT " + dbName + ".example_add(1, 1) FROM "+ tableName+ " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(2,res.getInt(1));
  assertFalse("no more results",res.next());
  stmt.execute("DROP TABLE " + tableName);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempTable() throws Exception {
  String tempTableName="tmp1";
  stmt.execute("CREATE TEMPORARY TABLE " + tempTableName + " (key string, value string)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tempTableName);
  String resultVal="val_238";
  String queryStr="SELECT * FROM " + tempTableName + " where value = '"+ resultVal+ "'";
  verifyResult(queryStr,resultVal,2);
  DatabaseMetaData md=hs2Conn.getMetaData();
  assertTrue(md.getConnection() == hs2Conn);
  ResultSet rs=md.getTables(null,null,tempTableName,null);
  boolean foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getTables(null,null,null,null);
  foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getColumns(null,null,tempTableName,null);
  assertTrue("First row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("key"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  assertTrue("Second row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("value"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  boolean gotException=false;
  try {
    ResultSet res;
    res=stmt2.executeQuery(queryStr);
  }
 catch (  SQLException err) {
    assertTrue("Expecting table not found error, instead got: " + err,err.getMessage().contains("Table not found"));
    gotException=true;
  }
  assertTrue("Exception while querying non-existing temp table",gotException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestSSL </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test non-SSL client with SSL server fails
 * @throws Exception
 */
@Test public void testConnectionMismatch() throws Exception {
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=false",System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  miniHS2.stop();
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",";ssl=false"),System.getProperty("user.name"),"bar");
    fail("NON SSL connection should fail with SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test SSL client with non-SSL server fails
 * @throws Exception
 */
@Test public void testInvalidConfig() throws Exception {
  clearSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  DriverManager.setLoginTimeout(4);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
    fail("SSL connection should fail with NON-SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  System.setProperty(JAVA_TRUST_STORE_PROP,dataFileDir + File.separator + TRUST_STORE_NAME);
  System.setProperty(JAVA_TRUST_STORE_PASS_PROP,KEY_STORE_PASSWORD);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true",System.getProperty("user.name"),"bar");
    fail("SSL connection should fail with NON-SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
  miniHS2.stop();
  System.clearProperty(JAVA_TRUST_STORE_PROP);
  System.clearProperty(JAVA_TRUST_STORE_PASS_PROP);
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
    fail("SSL connection should fail with NON-SSL server");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests to ensure SSLv2 and SSLv3 are disabled
 */
@Test public void testSSLVersion() throws Exception {
  Assume.assumeTrue(execCommand("which openssl") == 0);
  Assume.assumeTrue(System.getProperty("os.name").toLowerCase().contains("linux"));
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD,System.getProperty("user.name"),"bar");
  hs2Conn.close();
  Assert.assertEquals("Expected exit code of 1",1,execCommand("openssl s_client -connect " + miniHS2.getHost() + ":"+ miniHS2.getBinaryPort()+ " -ssl2 < /dev/null"));
  Assert.assertEquals("Expected exit code of 1",1,execCommand("openssl s_client -connect " + miniHS2.getHost() + ":"+ miniHS2.getBinaryPort()+ " -ssl3 < /dev/null"));
  miniHS2.stop();
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD,System.getProperty("user.name"),"bar");
    Assert.fail("Expected SQLException during connect");
  }
 catch (  SQLException e) {
    LOG.info("Expected exception: " + e,e);
    Assert.assertEquals("08S01",e.getSQLState().trim());
    Throwable cause=e.getCause();
    Assert.assertNotNull(cause);
    while (cause.getCause() != null) {
      cause=cause.getCause();
    }
    Assert.assertEquals("org.apache.http.NoHttpResponseException",cause.getClass().getName());
    Assert.assertTrue(cause.getMessage().contains("failed to respond"));
  }
  miniHS2.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestCLIAuthzSessionContext </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthzSessionContextContents() throws Exception {
  driver.processCmd("show tables");
  assertTrue("session string size check",sessionCtx.getSessionString().length() > 10);
  assertEquals("Client type ",HiveAuthzSessionContext.CLIENT_TYPE.HIVECLI,sessionCtx.getClientType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestHS2AuthzSessionContext </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthzSessionContextContents() throws Exception {
  assertTrue("session string size check",sessionCtx.getSessionString().length() > 10);
  assertEquals("Client type ",HiveAuthzSessionContext.CLIENT_TYPE.HIVESERVER2,sessionCtx.getClientType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthorization </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorization1() throws Exception {
  String tableName1="test_jdbc_sql_auth1";
  String tableName2="test_jdbc_sql_auth2";
{
    Connection hs2Conn=getConnection("user1");
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("create table " + tableName1 + "(i int) ");
    stmt.execute("create table " + tableName2 + "(i int) ");
    stmt.close();
    hs2Conn.close();
  }
{
    Connection hs2Conn=getConnection("user1");
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("drop table " + tableName1);
  }
{
    Connection hs2Conn=getConnection("user2");
    try {
      hs2Conn.getMetaData().getColumns(null,"default",tableName2,null);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("SELECT"));
    }
  }
{
    Connection hs2Conn=getConnection("user2");
    try {
      Statement stmt=hs2Conn.createStatement();
      stmt.execute("drop table " + tableName2);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("OBJECT OWNERSHIP"));
    }
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigWhiteList() throws Exception {
  Connection hs2Conn=getConnection("user1");
  Statement stmt=hs2Conn.createStatement();
  try {
    stmt.execute("set hive.metastore.uris=x");
    fail("exception expected");
  }
 catch (  SQLException e) {
    String msg="Cannot modify hive.metastore.uris at runtime. " + "It is not in list of params that are allowed to be modified at runtime";
    assertTrue(e.getMessage().contains(msg));
  }
  stmt.execute("set hive.exec.reducers.bytes.per.reducer=10000");
  stmt.close();
  hs2Conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.cbo_rp_TestJdbcDriver2 </h4><pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowColumns() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show columns in " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting using builtin UDFs
 * @throws SQLException
 */
@Test public void testBuiltInUDFCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c12, bin(c12) from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(2),"_c1");
  assertTrue(res.next());
  assertEquals(res.getLong(1),1);
  assertEquals(res.getString(2),"1");
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.execute("drop role role1");
  }
 catch (  Exception ex) {
    LOG.warn("Ignoring error during drop role: " + ex);
  }
  stmt.execute("create role role1");
  stmt.execute("grant role role1 to user hive_test_user");
  stmt.execute("show role grant user hive_test_user");
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("public",res.getString(1));
  assertTrue(res.next());
  assertEquals("role1",res.getString(1));
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getProcedureColumns()
 * @throws SQLException
 */
@Test public void testProcCols() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedureColumns(null,null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),20);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-10 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  con=getConnection("default");
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("set hive.cbo.returnpath.hiveop = true");
  try {
    stmt.execute("drop table " + tableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + tableName + " (under_col int comment 'the under column', value string) comment '"+ tableComment+ "'");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tableName);
  try {
    stmt.execute("drop table " + partitionedTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + partitionedTableName + " (under_col int, value string) comment '"+ partitionedTableComment+ "' partitioned by ("+ partitionedColumnName+ " STRING)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ partitionedTableName+ " PARTITION ("+ partitionedColumnName+ "="+ partitionedColumnValue+ ")");
  try {
    stmt.execute("drop table " + dataTypeTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + dataTypeTableName + " (c1 int, c2 boolean, c3 double, c4 string,"+ " c5 array<int>, c6 map<int,string>, c7 map<string,string>,"+ " c8 struct<r:string,s:int,t:double>,"+ " c9 tinyint, c10 smallint, c11 float, c12 bigint,"+ " c13 array<array<string>>,"+ " c14 map<int, map<int,int>>,"+ " c15 struct<r:int,s:struct<a:int,b:string>>,"+ " c16 array<struct<m:map<string,string>,n:int>>,"+ " c17 timestamp, "+ " c18 decimal(16,7), "+ " c19 binary, "+ " c20 date,"+ " c21 varchar(20),"+ " c22 char(15),"+ " c23 binary"+ ") comment'"+ dataTypeTableComment+ "' partitioned by (dt STRING)");
  stmt.execute("load data local inpath '" + dataTypeDataFilePath.toString() + "' into table "+ dataTypeTableName+ " PARTITION (dt='20090619')");
  try {
    stmt.execute("drop view " + viewName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create view " + viewName + " comment '"+ viewComment+ "' as select * from "+ tableName);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseMetaData() throws SQLException {
  DatabaseMetaData meta=con.getMetaData();
  assertEquals("Apache Hive",meta.getDatabaseProductName());
  assertEquals(HiveVersionInfo.getVersion(),meta.getDatabaseProductVersion());
  assertEquals(System.getProperty("hive.version"),meta.getDatabaseProductVersion());
  assertTrue("verifying hive version pattern. got " + meta.getDatabaseProductVersion(),Pattern.matches("\\d+\\.\\d+\\.\\d+.*",meta.getDatabaseProductVersion()));
  assertEquals(DatabaseMetaData.sqlStateSQL99,meta.getSQLStateType());
  assertFalse(meta.supportsCatalogsInTableDefinitions());
  assertTrue(meta.supportsSchemasInTableDefinitions());
  assertTrue(meta.supportsSchemasInDataManipulation());
  assertFalse(meta.supportsMultipleResultSets());
  assertFalse(meta.supportsStoredProcedures());
  assertTrue(meta.supportsAlterTableWithAddColumn());
  assertTrue(meta.getDatabaseMajorVersion() > -1);
  assertTrue(meta.getDatabaseMinorVersion() > -1);
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetColumnNameCaseInsensitive() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res;
  res=stmt.executeQuery("select c1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
  res=stmt.executeQuery("select c1 C1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset methods
 * @throws Exception
 */
@Test public void testFetchFirstError() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  try {
    res.beforeFirst();
    fail("beforeFirst() should fail for normal resultset");
  }
 catch (  SQLException e) {
    assertEquals("Method not supported for TYPE_FORWARD_ONLY resultset",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("_c12",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify 'explain ...' resultset
 * @throws SQLException
 */
@Test public void testExplainStmt() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("explain select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),1);
  assertEquals(md.getColumnLabel(1),EXPL_COLUMN_NAME);
  assertTrue("Nothing returned explain",res.next());
}

</code></pre>

<br>
<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the cancellation of a query that is running.
 * We spawn 2 threads - one running the query and
 * the other attempting to cancel.
 * We're using a dummy udf to simulate a query,
 * that runs for a sufficiently long time.
 * @throws Exception
 */
@Test public void testQueryCancel() throws Exception {
  String udfName=SleepUDF.class.getName();
  Statement stmt1=con.createStatement();
  stmt1.execute("create temporary function sleepUDF as '" + udfName + "'");
  stmt1.close();
  final Statement stmt=con.createStatement();
  Thread tExecute=new Thread(new Runnable(){
    @Override public void run(){
      try {
        System.out.println("Executing query: ");
        stmt.executeQuery("select sleepUDF(t1.under_col) as u0, t1.under_col as u1, " + "t2.under_col as u2 from " + tableName + "t1 join "+ tableName+ " t2 on t1.under_col = t2.under_col");
        fail("Expecting SQLException");
      }
 catch (      SQLException e) {
        assertNotNull(e);
        System.out.println(e.toString());
      }
    }
  }
);
  Thread tCancel=new Thread(new Runnable(){
    @Override public void run(){
      try {
        Thread.sleep(1000);
        System.out.println("Cancelling query: ");
        stmt.cancel();
      }
 catch (      Exception e) {
      }
    }
  }
);
  tExecute.start();
  tCancel.start();
  tExecute.join();
  tCancel.join();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeTable() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("describe " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  assertEquals("Column type 'under_col' for column under_col not found","int",res.getString(2));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertEquals("Column type 'string' for column key not found","string",res.getString(2));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test testProccedures()
 * @throws SQLException
 */
@Test public void testProccedures() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedures(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),9);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetCatalogs() throws SQLException {
  ResultSet rs=con.getMetaData().getCatalogs();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(1,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertFalse(rs.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.0123456",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateColumnNameOrder() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet rs=stmt.executeQuery("SELECT 1 AS a, 2 AS a from " + tableName);
  assertTrue(rs.next());
  assertEquals(1,rs.getInt("a"));
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting named expression columns
 * @throws SQLException
 */
@Test public void testExprCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1+1 as col1, length(c4) as len from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(1),"col1");
  assertEquals(md.getColumnLabel(2),"len");
  assertTrue(res.next());
  assertEquals(res.getInt(1),2);
  assertEquals(res.getInt(2),1);
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetSchemas() throws SQLException {
  ResultSet rs=con.getMetaData().getSchemas();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(2,resMeta.getColumnCount());
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(1));
  assertEquals("TABLE_CATALOG",resMeta.getColumnName(2));
  assertTrue(rs.next());
  assertEquals("default",rs.getString(1));
  assertFalse(rs.next());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getPrimaryKeys()
 * @throws SQLException
 */
@Test public void testPrimaryKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getPrimaryKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),6);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaDataDuplicateColumnNames() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1 as c2_1, c2, c1*2 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(3,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c2_1",meta.getColumnName(1));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertTrue(colRS.next());
  assertEquals("_c2",meta.getColumnName(3));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * validate schema generated by "set" command
 * @throws SQLException
 */
@Test public void testSetCommand() throws SQLException {
  String sql="set -v";
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery(sql);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(1,md.getColumnCount());
  assertEquals(SET_COLUMN_NAME,md.getColumnLabel(1));
  assertTrue("Nothing returned by set -v",res.next());
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowGrant() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("grant select on table " + dataTypeTableName + " to user hive_test_user");
  stmt.execute("show grant user hive_test_user on table " + dataTypeTableName);
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("default",res.getString(1));
  assertEquals(dataTypeTableName,res.getString(2));
  assertEquals("",res.getString(3));
  assertEquals("",res.getString(4));
  assertEquals("hive_test_user",res.getString(5));
  assertEquals("USER",res.getString(6));
  assertEquals("SELECT",res.getString(7));
  assertEquals(false,res.getBoolean(8));
  assertEquals(-1,res.getLong(9));
  assertNotNull(res.getString(10));
  assertFalse(res.next());
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetTimestamp() throws SQLException, ParseException {
  String sql=String.format("SELECT * FROM %s WHERE c17 = ?",dataTypeTableName);
  try (PreparedStatement ps=con.prepareStatement(sql)){
    Timestamp timestamp=Timestamp.valueOf("2012-04-22 09:00:00.123456789");
    ps.setTimestamp(1,timestamp);
    try (ResultSet resultSet=ps.executeQuery()){
      assertTrue(resultSet.next());
      assertEquals(1,resultSet.getInt(1));
      assertFalse(resultSet.next());
    }
   }
 }

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParentReferences() throws Exception {
  Statement s=this.con.createStatement();
  ResultSet rs=s.executeQuery("SELECT * FROM " + dataTypeTableName);
  assertTrue(s.getConnection() == this.con);
  assertTrue(rs.getStatement() == s);
  rs.close();
  s.close();
  PreparedStatement ps=this.con.prepareStatement("SELECT * FROM " + dataTypeTableName);
  rs=ps.executeQuery();
  assertTrue(ps.getConnection() == this.con);
  assertTrue(rs.getStatement() == ps);
  rs.close();
  ps.close();
  DatabaseMetaData md=this.con.getMetaData();
  assertTrue(md.getConnection() == this.con);
  rs=md.getCatalogs();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getFunctions(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getImportedKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getPrimaryKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedureColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedures(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getSchemas();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTableTypes();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTables(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTypeInfo();
  assertNull(rs.getStatement());
  rs.close();
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorDiag() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("select from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
  try {
    stmt.executeQuery("select * from nonTable");
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42S02",e.getSQLState());
  }
  try {
    stmt.executeQuery("select zzzz from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
}

</code></pre>

<br>
<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset attributes
 * @throws Exception
 */
@Test public void testUnsupportedFetchTypes() throws Exception {
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_READ_ONLY);
    fail("createStatement with TYPE_SCROLL_SENSITIVE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
    fail("createStatement with CONCUR_UPDATABLE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getImportedKeys()
 * @throws SQLException
 */
@Test public void testImportedKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getImportedKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),14);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullType() throws Exception {
  Statement stmt=con.createStatement();
  try {
    ResultSet res=stmt.executeQuery("select null from " + dataTypeTableName);
    assertTrue(res.next());
    assertNull(res.getObject(1));
  }
  finally {
    stmt.close();
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("drop table " + tableName);
  stmt.execute("drop table " + partitionedTableName);
  stmt.execute("drop table " + dataTypeTableName);
  con.close();
  assertTrue("Connection should be closed",con.isClosed());
  Exception expectedException=null;
  try {
    con.createStatement();
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("createStatement() on closed connection should throw exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log when HS2 disable logging.
 * @throws Exception
 */
@Test public void testGetQueryLogOnDisabledLog() throws Exception {
  Statement setStmt=con.createStatement();
  setStmt.execute("set hive.server2.logging.operation.enabled = false");
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10);
  stmt.close();
  assertTrue(logs.size() == 0);
  setStmt.execute("set hive.server2.logging.operation.enabled = true");
  setStmt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.miniHS2.TestHiveServer2SessionTimeout </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnection() throws Exception {
  CLIServiceClient serviceClient=miniHS2.getServiceClient();
  SessionHandle sessHandle=serviceClient.openSession("foo","bar");
  OperationHandle handle=serviceClient.executeStatement(sessHandle,"SELECT 1",confOverlay);
  Thread.sleep(7000);
  try {
    serviceClient.closeOperation(handle);
    fail("Operation should have been closed by timeout!");
  }
 catch (  HiveSQLException e) {
    assertTrue(StringUtils.stringifyException(e),e.getMessage().contains("Invalid OperationHandle"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.JdbcWithMiniKdcSQLAuthTest </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorization1() throws Exception {
  String tableName1="test_jdbc_sql_auth1";
  String tableName2="test_jdbc_sql_auth2";
{
    Connection hs2Conn=getConnection(MiniHiveKdc.HIVE_TEST_USER_1);
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("create table " + tableName1 + "(i int) ");
    stmt.execute("create table " + tableName2 + "(i int) ");
    stmt.execute("grant select on table " + tableName2 + " to user "+ MiniHiveKdc.HIVE_TEST_USER_2);
    stmt.close();
    hs2Conn.close();
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_1));
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("drop table " + tableName1);
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_2));
    try {
      Statement stmt=hs2Conn.createStatement();
      stmt.execute("drop table " + tableName2);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("OBJECT OWNERSHIP"));
    }
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_2));
    Statement stmt=hs2Conn.createStatement();
    stmt.execute(" desc " + tableName2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.TestHiveAuthFactory </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that delegation token manager is started with no exception for MemoryTokenStore
 * @throws Exception
 */
@Test public void testStartTokenManagerForMemoryTokenStore() throws Exception {
  hiveConf.setVar(ConfVars.HIVE_SERVER2_AUTHENTICATION,HiveAuthFactory.AuthTypes.KERBEROS.getAuthName());
  String principalName=miniHiveKdc.getFullHiveServicePrincipal();
  System.out.println("Principal: " + principalName);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_KERBEROS_PRINCIPAL,principalName);
  String keyTabFile=miniHiveKdc.getKeyTabFile(miniHiveKdc.getHiveServicePrincipal());
  System.out.println("keyTabFile: " + keyTabFile);
  Assert.assertNotNull(keyTabFile);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_KERBEROS_KEYTAB,keyTabFile);
  HiveAuthFactory authFactory=new HiveAuthFactory(hiveConf);
  Assert.assertNotNull(authFactory);
  Assert.assertEquals("org.apache.hadoop.hive.thrift.HadoopThriftAuthBridge$Server$TUGIAssumingTransportFactory",authFactory.getAuthTransFactory().getClass().getName());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify that delegation token manager is started with no exception for DBTokenStore
 * @throws Exception
 */
@Test public void testStartTokenManagerForDBTokenStore() throws Exception {
  hiveConf.setVar(ConfVars.HIVE_SERVER2_AUTHENTICATION,HiveAuthFactory.AuthTypes.KERBEROS.getAuthName());
  String principalName=miniHiveKdc.getFullHiveServicePrincipal();
  System.out.println("Principal: " + principalName);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_KERBEROS_PRINCIPAL,principalName);
  String keyTabFile=miniHiveKdc.getKeyTabFile(miniHiveKdc.getHiveServicePrincipal());
  System.out.println("keyTabFile: " + keyTabFile);
  Assert.assertNotNull(keyTabFile);
  hiveConf.setVar(ConfVars.HIVE_SERVER2_KERBEROS_KEYTAB,keyTabFile);
  hiveConf.setVar(ConfVars.METASTORE_CLUSTER_DELEGATION_TOKEN_STORE_CLS,"org.apache.hadoop.hive.thrift.DBTokenStore");
  HiveAuthFactory authFactory=new HiveAuthFactory(hiveConf);
  Assert.assertNotNull(authFactory);
  Assert.assertEquals("org.apache.hadoop.hive.thrift.HadoopThriftAuthBridge$Server$TUGIAssumingTransportFactory",authFactory.getAuthTransFactory().getClass().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.TestHs2HooksWithMiniKdc </h4><pre class="type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that hook context properties are correctly set.
 */
@Test public void testHookContexts() throws Throwable {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_USER_1);
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL());
  Statement stmt=hs2Conn.createStatement();
  stmt.executeQuery("show databases");
  stmt.executeQuery("show tables");
  Throwable error=PostExecHook.error;
  if (error != null) {
    throw error;
  }
  error=PreExecHook.error;
  if (error != null) {
    throw error;
  }
  Assert.assertNotNull(PostExecHook.ipAddress,"ipaddress is null");
  Assert.assertNotNull(PostExecHook.userName,"userName is null");
  Assert.assertNotNull(PostExecHook.operation,"operation is null");
  Assert.assertEquals(MiniHiveKdc.HIVE_TEST_USER_1,PostExecHook.userName);
  Assert.assertTrue(PostExecHook.ipAddress,PostExecHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals("SHOWTABLES",PostExecHook.operation);
  Assert.assertNotNull(PreExecHook.ipAddress,"ipaddress is null");
  Assert.assertNotNull(PreExecHook.userName,"userName is null");
  Assert.assertNotNull(PreExecHook.operation,"operation is null");
  Assert.assertEquals(MiniHiveKdc.HIVE_TEST_USER_1,PreExecHook.userName);
  Assert.assertTrue(PreExecHook.ipAddress,PreExecHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals("SHOWTABLES",PreExecHook.operation);
  error=SemanticAnalysisHook.preAnalyzeError;
  if (error != null) {
    throw error;
  }
  error=SemanticAnalysisHook.postAnalyzeError;
  if (error != null) {
    throw error;
  }
  Assert.assertNotNull(SemanticAnalysisHook.ipAddress,"semantic hook context ipaddress is null");
  Assert.assertNotNull(SemanticAnalysisHook.userName,"semantic hook context userName is null");
  Assert.assertNotNull(SemanticAnalysisHook.command,"semantic hook context command is null");
  Assert.assertTrue(SemanticAnalysisHook.ipAddress,SemanticAnalysisHook.ipAddress.contains("127.0.0.1"));
  Assert.assertEquals("show tables",SemanticAnalysisHook.command);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.TestJdbcWithMiniKdc </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative test, verify that connection to secure HS2 fails when
 * required connection attributes are not provided
 * @throws Exception
 */
@Test public void testConnectionNeg() throws Exception {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_USER_1);
  try {
    String url=miniHS2.getJdbcURL().replaceAll(";principal.*","");
    hs2Conn=DriverManager.getConnection(url);
    fail("NON kerberos connection should fail");
  }
 catch (  SQLException e) {
    assertEquals("08S01",e.getSQLState().trim());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test connection using the proxy user connection property.
 * Verify proxy connection fails when super user doesn't have privilege to
 * impersonate the given user
 * @throws Exception
 */
@Test public void testNegativeProxyAuth() throws Exception {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_SUPER_USER);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",";hive.server2.proxy.user=" + MiniHiveKdc.HIVE_TEST_USER_2));
    verifyProperty(SESSION_USER_NAME,MiniHiveKdc.HIVE_TEST_USER_2);
    fail(MiniHiveKdc.HIVE_TEST_SUPER_USER + " shouldn't be allowed proxy connection for " + MiniHiveKdc.HIVE_TEST_USER_2);
  }
 catch (  SQLException e) {
    e.printStackTrace();
    assertTrue(e.getMessage().contains("Failed to validate proxy privilege"));
    assertTrue(e.getCause().getCause().getMessage().contains("is not allowed to impersonate"));
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative test for token based authentication
 * Verify that a user can't retrieve a token for user that
 * it's not allowed to impersonate
 * @throws Exception
 */
@Test public void testNegativeTokenAuth() throws Exception {
  miniHiveKdc.loginUser(MiniHiveKdc.HIVE_TEST_SUPER_USER);
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL());
  try {
    String token=((HiveConnection)hs2Conn).getDelegationToken(MiniHiveKdc.HIVE_TEST_USER_2,MiniHiveKdc.HIVE_SERVICE_PRINCIPAL);
    fail(MiniHiveKdc.HIVE_TEST_SUPER_USER + " shouldn't be allowed to retrieve token for " + MiniHiveKdc.HIVE_TEST_USER_2);
  }
 catch (  SQLException e) {
    assertTrue(e.getMessage().contains("Error retrieving delegation token for user"));
    assertTrue(e.getCause().getCause().getMessage().contains("is not allowed to impersonate"));
  }
 finally {
    hs2Conn.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.TestMiniHiveKdc </h4><pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogin() throws Exception {
  String servicePrinc=miniHiveKdc.getHiveServicePrincipal();
  assertNotNull(servicePrinc);
  miniHiveKdc.loginUser(servicePrinc);
  assertTrue(UserGroupInformation.isLoginKeytabBased());
  UserGroupInformation ugi=Utils.getUGI();
  assertEquals(MiniHiveKdc.HIVE_SERVICE_PRINCIPAL,ugi.getShortUserName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.api.server.TestTestExecutor </h4><pre class="type-10 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  startRequest=new TestStartRequest();
  startRequest.setProfile(PROFILE);
  startRequest.setTestHandle(TEST_HANDLE);
  test=new Test(startRequest,Status.pending(),System.currentTimeMillis());
  testQueue=new ArrayBlockingQueue<Test>(1);
  executionContextConfiguration=mock(ExecutionContextConfiguration.class);
  executionContextProvider=mock(ExecutionContextProvider.class);
  ptest=mock(PTest.class);
  Set<Host> hosts=Sets.newHashSet();
  String baseDirPath=baseDir.getRoot().getAbsolutePath();
  executionContext=new ExecutionContext(executionContextProvider,hosts,baseDirPath,PRIVATE_KEY);
  profileProperties=new File(baseDirPath,PROFILE + ".properties");
  when(executionContextConfiguration.getProfileDirectory()).thenReturn(baseDirPath);
  when(executionContextConfiguration.getGlobalLogDirectory()).thenReturn(baseDirPath);
  when(executionContextProvider.createExecutionContext()).thenReturn(executionContext);
  Assert.assertTrue(profileProperties.toString(),profileProperties.createNewFile());
  OutputStream profilePropertiesOutputStream=new FileOutputStream(profileProperties);
  Resources.copy(Resources.getResource("test-configuration.properties"),profilePropertiesOutputStream);
  profilePropertiesOutputStream.close();
  ptestBuilder=new PTest.Builder(){
    @Override public PTest build(    TestConfiguration configuration,    ExecutionContext executionContext,    String buildTag,    File logDir,    LocalCommandFactory localCommandFactory,    SSHCommandExecutor sshCommandExecutor,    RSyncCommandExecutor rsyncCommandExecutor,    Logger logger) throws Exception {
      return ptest;
    }
  }
;
  testExecutor=new TestExecutor(executionContextConfiguration,executionContextProvider,testQueue,ptestBuilder);
  testExecutor.setDaemon(true);
  testExecutor.start();
  TimeUnit.MILLISECONDS.sleep(100);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.TestHostExecutor </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParallelFailsOnExec() throws Exception {
  sshCommandExecutor.putFailure("bash /some/local/dir/somehost-someuser-0/scratch/hiveptest-driver-parallel-1.sh",Constants.EXIT_CODE_UNKNOWN);
  HostExecutor executor=createHostExecutor();
  parallelWorkQueue.addAll(Lists.newArrayList(testBatchParallel1));
  executor.submitTests(parallelWorkQueue,isolatedWorkQueue,failedTestResults).get();
  Assert.assertEquals(Collections.emptySet(),failedTestResults);
  Assert.assertTrue(parallelWorkQueue.toString(),parallelWorkQueue.isEmpty());
  Approvals.verify(getExecutedCommands());
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShutdownBeforeExec() throws Exception {
  rsyncCommandExecutor.putFailure("/tmp/hive-ptest-units/TestHostExecutor/scratch/hiveptest-driver-parallel-1.sh " + "/some/local/dir/somehost-someuser-0/scratch/hiveptest-driver-parallel-1.sh",Constants.EXIT_CODE_UNKNOWN);
  HostExecutor executor=createHostExecutor();
  parallelWorkQueue.addAll(Lists.newArrayList(testBatchParallel1));
  executor.shutdownNow();
  executor.submitTests(parallelWorkQueue,isolatedWorkQueue,failedTestResults).get();
  Assert.assertEquals(Collections.emptySet(),failedTestResults);
  Assert.assertEquals(parallelWorkQueue.toString(),1,parallelWorkQueue.size());
  Approvals.verify("EMPTY\n" + getExecutedCommands());
  Assert.assertTrue(executor.isShutdown());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsolatedFailsOnRsyncOne() throws Exception {
  rsyncCommandExecutor.putFailure("/tmp/hive-ptest-units/TestHostExecutor/scratch/hiveptest-driver-isolated-1.sh " + "/some/local/dir/somehost-someuser-0/scratch/hiveptest-driver-isolated-1.sh",1);
  HostExecutor executor=createHostExecutor();
  isolatedWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1));
  executor.submitTests(parallelWorkQueue,isolatedWorkQueue,failedTestResults).get();
  Assert.assertEquals(Collections.emptySet(),failedTestResults);
  Assert.assertTrue(isolatedWorkQueue.toString(),parallelWorkQueue.isEmpty());
  Approvals.verify(getExecutedCommands());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsolatedFailsOnRsyncUnknown() throws Exception {
  rsyncCommandExecutor.putFailure("/tmp/hive-ptest-units/TestHostExecutor/scratch/hiveptest-driver-isolated-1.sh " + "/some/local/dir/somehost-someuser-0/scratch/hiveptest-driver-isolated-1.sh",Constants.EXIT_CODE_UNKNOWN);
  HostExecutor executor=createHostExecutor();
  isolatedWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1));
  executor.submitTests(parallelWorkQueue,isolatedWorkQueue,failedTestResults).get();
  Assert.assertEquals(Collections.emptySet(),failedTestResults);
  Assert.assertTrue(isolatedWorkQueue.toString(),isolatedWorkQueue.isEmpty());
  Approvals.verify(getExecutedCommands());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParallelFailsOnRsync() throws Exception {
  rsyncCommandExecutor.putFailure("/tmp/hive-ptest-units/TestHostExecutor/scratch/hiveptest-driver-parallel-1.sh " + "/some/local/dir/somehost-someuser-0/scratch/hiveptest-driver-parallel-1.sh",Constants.EXIT_CODE_UNKNOWN);
  HostExecutor executor=createHostExecutor();
  parallelWorkQueue.addAll(Lists.newArrayList(testBatchParallel1));
  executor.submitTests(parallelWorkQueue,isolatedWorkQueue,failedTestResults).get();
  Assert.assertEquals(Collections.emptySet(),failedTestResults);
  Assert.assertTrue(parallelWorkQueue.toString(),parallelWorkQueue.isEmpty());
  Approvals.verify(getExecutedCommands());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsolatedFailsOnExec() throws Exception {
  sshCommandExecutor.putFailure("bash /some/local/dir/somehost-someuser-0/scratch/hiveptest-driver-isolated-1.sh",Constants.EXIT_CODE_UNKNOWN);
  HostExecutor executor=createHostExecutor();
  isolatedWorkQueue.addAll(Lists.newArrayList(testBatchIsolated1));
  executor.submitTests(parallelWorkQueue,isolatedWorkQueue,failedTestResults).get();
  Assert.assertEquals(Collections.emptySet(),failedTestResults);
  Assert.assertTrue(isolatedWorkQueue.toString(),parallelWorkQueue.isEmpty());
  Approvals.verify(getExecutedCommands());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.TestTestCheckPhase </h4><pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJavaTests() throws Exception {
  URL url=this.getClass().getResource("/HIVE-10761.6.patch");
  File patchFile=new File(url.getFile());
  Set<String> addedTests=new HashSet<String>();
  phase=new TestCheckPhase(hostExecutors,localCommandFactory,templateDefaults,patchFile,logger,addedTests);
  phase.execute();
  Assert.assertEquals(addedTests.size(),3);
  Assert.assertTrue(addedTests.contains("TestCodahaleMetrics.java"));
  Assert.assertTrue(addedTests.contains("TestMetaStoreMetrics.java"));
  Assert.assertTrue(addedTests.contains("TestLegacyMetrics.java"));
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQTests() throws Exception {
  URL url=this.getClass().getResource("/HIVE-11271.4.patch");
  File patchFile=new File(url.getFile());
  Set<String> addedTests=new HashSet<String>();
  phase=new TestCheckPhase(hostExecutors,localCommandFactory,templateDefaults,patchFile,logger,addedTests);
  phase.execute();
  Assert.assertEquals(addedTests.size(),1);
  Assert.assertTrue(addedTests.contains("unionall_unbalancedppd.q"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.conf.TestQFileTestBatch </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParallel() throws Exception {
  QFileTestBatch batch=new QFileTestBatch("testcase",DRIVER,QUERY_FILES_PROPERTY,tests,true);
  Assert.assertTrue(batch.isParallel());
  Assert.assertEquals(DRIVER,batch.getDriver());
  Assert.assertEquals(Joiner.on("-").join(DRIVER,"a","b","c"),batch.getName());
  Assert.assertEquals(String.format("-Dtestcase=%s -D%s=a,b,c",DRIVER,QUERY_FILES_PROPERTY),batch.getTestArguments());
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoreThanThreeTests() throws Exception {
  Assert.assertTrue(tests.add("d"));
  QFileTestBatch batch=new QFileTestBatch("testcase",DRIVER,QUERY_FILES_PROPERTY,tests,true);
  Assert.assertEquals(Joiner.on("-").join(DRIVER,"a","b","c","and","1","more"),batch.getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.conf.TestTestConfiguration </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGettersSetters() throws Exception {
  ExecutionContextConfiguration execConf=ExecutionContextConfiguration.fromInputStream(Resources.getResource("test-configuration.properties").openStream());
  TestConfiguration conf=TestConfiguration.fromInputStream(Resources.getResource("test-configuration.properties").openStream(),LOG);
  Set<Host> expectedHosts=Sets.newHashSet(new Host("localhost","hiveptest",new String[]{"/home/hiveptest"},2));
  ExecutionContext executionContext=execConf.getExecutionContextProvider().createExecutionContext();
  Assert.assertEquals(expectedHosts,executionContext.getHosts());
  Assert.assertEquals("/tmp/hive-ptest-units/working/dir",execConf.getWorkingDirectory());
  Assert.assertEquals("/etc/hiveptest/conf",execConf.getProfileDirectory());
  Assert.assertEquals("/tmp/hive-ptest-units/working/dir/logs",execConf.getGlobalLogDirectory());
  Assert.assertEquals("/home/brock/.ssh/id_rsa",executionContext.getPrivateKey());
  Assert.assertEquals("git://github.com/apache/hive.git",conf.getRepository());
  Assert.assertEquals("apache-github",conf.getRepositoryName());
  Assert.assertEquals("trunk",conf.getBranch());
  Assert.assertEquals("/tmp/hive-ptest-units/working/dir/working",executionContext.getLocalWorkingDirectory());
  Assert.assertEquals("-Dtest.continue.on.failure=true -Dtest.silent=false",conf.getAntArgs());
  Assert.assertEquals("hadoop-1,hadoop-2",conf.getAdditionalProfiles());
  Assert.assertNotNull(conf.toString());
  Assert.assertEquals("",conf.getPatch());
  conf.setPatch("Patch");
  Assert.assertEquals("Patch",conf.getPatch());
  conf.setRepository("Repository");
  Assert.assertEquals("Repository",conf.getRepository());
  conf.setRepositoryName("RepositoryName");
  Assert.assertEquals("RepositoryName",conf.getRepositoryName());
  conf.setBranch("Branch");
  Assert.assertEquals("Branch",conf.getBranch());
  conf.setAntArgs("AntArgs");
  Assert.assertEquals("AntArgs",conf.getAntArgs());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.conf.TestTestParser </h4><pre class="type-10 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setup() throws Exception {
  context=new Context();
  baseDir=Files.createTempDir();
  workingDirectory=new File(baseDir.getAbsolutePath(),"source");
  unitTestDir1=Dirs.create(new File(baseDir,Joiner.on("/").join("source","build","1","units","test","classes")));
  unitTestDir2=Dirs.create(new File(baseDir,Joiner.on("/").join("source","build","2","units","test","classes")));
  qFileTestDir=Dirs.create(new File(baseDir,Joiner.on("/").join("source","qfiles")));
  propertyDir=Dirs.create(new File(baseDir,Joiner.on("/").join("source","props")));
  Assert.assertTrue((new File(unitTestDir1,"TestA.class")).createNewFile());
  Assert.assertTrue((new File(unitTestDir2,"TestB.class")).createNewFile());
  Assert.assertTrue((new File(unitTestDir1,"TestC.class")).createNewFile());
  Assert.assertTrue((new File(unitTestDir1,"TestD$E.class")).createNewFile());
  Assert.assertTrue((new File(unitTestDir1,DRIVER + ".class")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,".svn")).mkdirs());
  Assert.assertTrue((new File(qFileTestDir,"dir.q")).mkdirs());
  Assert.assertTrue((new File(qFileTestDir,"normal.q")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,"normal2.q")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,"normal3.q")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,"normal4.q")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,"excluded.q")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,"isolated.q")).createNewFile());
  Assert.assertTrue((new File(qFileTestDir,"included.q")).createNewFile());
  Properties normalProp=new Properties();
  normalProp.setProperty("normal.one.group","normal.q,normal2.q");
  normalProp.setProperty("normal.two.group","normal3.q,normal4.q");
  normalProp.setProperty("excluded.group","excluded.q");
  normalProp.setProperty("isolated.group","isolated.q");
  normalProp.setProperty("included.group","included.q");
  serialize("normal.properties",normalProp);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.ssh.TestRSyncCommandExecutor </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShutdownDuringWaitFor() throws Exception {
  LocalCommand localCommand=mock(LocalCommand.class);
  localCommandFactory.setInstance(localCommand);
  final RSyncCommandExecutor executor=new RSyncCommandExecutor(LOG,1,localCommandFactory);
  Assert.assertFalse(executor.isShutdown());
  when(localCommand.getExitCode()).thenAnswer(new Answer<Integer>(){
    @Override public Integer answer(    InvocationOnMock invocation) throws Throwable {
      executor.shutdownNow();
      return Constants.EXIT_CODE_UNKNOWN;
    }
  }
);
  RSyncCommand command=new RSyncCommand(executor,"privateKey","user","host",1,"local","remote",RSyncCommand.Type.FROM_LOCAL);
  executor.execute(command);
  Assert.assertTrue(executor.isShutdown());
  Assert.assertEquals(Constants.EXIT_CODE_UNKNOWN,command.getExitCode());
  if (command.getException() != null) {
    throw new Exception("Unexpected exception during execution",command.getException());
  }
  verify(localCommand,never()).kill();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShutdownBeforeWaitFor() throws Exception {
  LocalCommand localCommand=mock(LocalCommand.class);
  localCommandFactory.setInstance(localCommand);
  RSyncCommandExecutor executor=new RSyncCommandExecutor(LOG,1,localCommandFactory);
  Assert.assertFalse(executor.isShutdown());
  executor.shutdownNow();
  RSyncCommand command=new RSyncCommand(executor,"privateKey","user","host",1,"local","remote",RSyncCommand.Type.FROM_LOCAL);
  executor.execute(command);
  Assert.assertTrue(executor.isShutdown());
  Assert.assertEquals(Constants.EXIT_CODE_UNKNOWN,command.getExitCode());
  if (command.getException() != null) {
    throw new Exception("Unexpected exception during execution",command.getException());
  }
  verify(localCommand,times(1)).kill();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.ssh.TestSSHCommandExecutor </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShutdownBeforeWaitFor() throws Exception {
  LocalCommand localCommand=mock(LocalCommand.class);
  localCommandFactory.setInstance(localCommand);
  SSHCommandExecutor executor=new SSHCommandExecutor(LOG,localCommandFactory,"-o StrictHostKeyChecking=no");
  Assert.assertFalse(executor.isShutdown());
  executor.shutdownNow();
  SSHCommand command=new SSHCommand(executor,"privateKey","user","host",1,"whoami",true);
  executor.execute(command);
  Assert.assertTrue(executor.isShutdown());
  Assert.assertEquals(Constants.EXIT_CODE_UNKNOWN,command.getExitCode());
  if (command.getException() != null) {
    throw new Exception("Unexpected exception during execution",command.getException());
  }
  verify(localCommand,times(1)).kill();
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShutdownDuringWaitFor() throws Exception {
  LocalCommand localCommand=mock(LocalCommand.class);
  localCommandFactory.setInstance(localCommand);
  final SSHCommandExecutor executor=new SSHCommandExecutor(LOG,localCommandFactory,"-o StrictHostKeyChecking=no");
  Assert.assertFalse(executor.isShutdown());
  when(localCommand.getExitCode()).thenAnswer(new Answer<Integer>(){
    @Override public Integer answer(    InvocationOnMock invocation) throws Throwable {
      executor.shutdownNow();
      return Constants.EXIT_CODE_UNKNOWN;
    }
  }
);
  SSHCommand command=new SSHCommand(executor,"privateKey","user","host",1,"whoami",true);
  executor.execute(command);
  Assert.assertTrue(executor.isShutdown());
  Assert.assertEquals(Constants.EXIT_CODE_UNKNOWN,command.getExitCode());
  if (command.getException() != null) {
    throw new Exception("Unexpected exception during execution",command.getException());
  }
  verify(localCommand,never()).kill();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.TestHS2ImpersonationWithRemoteMS </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImpersonation() throws Exception {
  assertTrue("Test setup failed. MiniHS2 is not initialized",miniHS2 != null && miniHS2.isStarted());
  Class.forName(MiniHS2.getJdbcDriverName());
  Connection hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"foo",null);
  Statement stmt=hs2Conn.createStatement();
  String tableName="foo_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"bar",null);
  stmt=hs2Conn.createStatement();
  tableName="bar_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  MiniDFSShim dfs=miniHS2.getDfs();
  FileSystem fs=dfs.getFileSystem();
  FileStatus[] files=fs.listStatus(miniHS2.getWareHouseDir());
  boolean fooTableValidated=false;
  boolean barTableValidated=false;
  for (  FileStatus file : files) {
    final String name=file.getPath().getName();
    final String owner=file.getOwner();
    if (name.equals("foo_table")) {
      fooTableValidated=owner.equals("foo");
      assertTrue(String.format("User 'foo' table has wrong ownership '%s'",owner),fooTableValidated);
    }
 else     if (name.equals("bar_table")) {
      barTableValidated=owner.equals("bar");
      assertTrue(String.format("User 'bar' table has wrong ownership '%s'",owner),barTableValidated);
    }
 else {
      fail(String.format("Unexpected table directory '%s' in warehouse",name));
    }
    System.out.println(String.format("File: %s, Owner: %s",name,owner));
  }
  assertTrue("User 'foo' table not found in warehouse",fooTableValidated);
  assertTrue("User 'bar' table not found in warehouse",barTableValidated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.auth.TestCustomAuthentication </h4><pre class="type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomAuthentication() throws Exception {
  String url="jdbc:hive2://localhost:10000/default";
  Class.forName("org.apache.hive.jdbc.HiveDriver");
  try {
    DriverManager.getConnection(url,"wronguser","pwd");
    Assert.fail("Expected Exception");
  }
 catch (  SQLException e) {
    Assert.assertNotNull(e.getMessage());
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("Peer indicated failure: Error validating the login"));
  }
  Connection connection=DriverManager.getConnection(url,"hiveuser","hive");
  connection.close();
  System.out.println(">>> PASSED testCustomAuthentication");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceRestoreTest </h4><pre class="type-3 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestore() throws HiveSQLException {
  SessionHandle session=service.openSession("foo","bar",null);
  service.stop();
  service=getService();
  try {
    service.getSessionManager().getSession(session);
    Assert.fail("session already exists before restore");
  }
 catch (  HiveSQLException e) {
    Assert.assertTrue(e.getMessage().contains("Invalid SessionHandle"));
  }
  service.createSessionWithSessionHandle(session,"foo","bar",null);
  Assert.assertNotNull(service.getSessionManager().getSession(session));
  service.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceTest </h4><pre class="type-11 type-6 type-12 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalCompileLockTimeout() throws Exception {
  String tableName="TEST_COMPILE_LOCK_TIMEOUT";
  String columnDefinitions="(ID STRING)";
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,new HashMap<String,String>());
  assertNotNull(sessionHandle);
  int THREAD_COUNT=3;
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=(FutureTask<Void>[])new FutureTask[THREAD_COUNT];
  long longPollingTimeoutMs=10 * 60 * 1000;
  Map<String,String> confOverlay=getConfOverlay(0,longPollingTimeoutMs);
  confOverlay.put(HiveConf.ConfVars.SEMANTIC_ANALYZER_HOOK.varname,CompileLockTestSleepHook.class.getName());
  String query="SELECT 0 FROM " + tableName;
  tasks[0]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[0]).start();
  Thread.sleep(5 * 1000);
  confOverlay=getConfOverlay(1,longPollingTimeoutMs);
  query="SELECT 1 FROM " + tableName;
  tasks[1]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.ERROR,false,null,null));
  new Thread(tasks[1]).start();
  confOverlay=getConfOverlay(100,longPollingTimeoutMs);
  query="SELECT 2 FROM " + tableName;
  tasks[2]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[2]).start();
  boolean foundExpectedException=false;
  for (int i=0; i < THREAD_COUNT; ++i) {
    try {
      tasks[i].get();
    }
 catch (    Throwable t) {
      if (i == 1) {
        assertTrue(t.getMessage().contains(ErrorMsg.COMPILE_LOCK_TIMED_OUT.getMsg()));
        foundExpectedException=true;
      }
 else {
        throw new RuntimeException(t);
      }
    }
  }
  assertTrue(foundExpectedException);
  client.executeStatement(sessionHandle,"DROP TABLE " + tableName,getConfOverlay(0,longPollingTimeoutMs));
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test async execution of a well-formed and a malformed query with different long polling durations
 * - Test malformed query with default long polling timeout
 * - Test well-formed query with default long polling timeout
 * - Test well-formed query with long polling timeout set to 0
 * - Test well-formed query with long polling timeout set to 500 millis
 * - Test well-formed query cancellation
 * @throws Exception
 */
@Test public void testExecuteStatementAsync() throws Exception {
  Map<String,String> confOverlay=new HashMap<String,String>();
  String tableName="TEST_EXEC_ASYNC";
  String columnDefinitions="(ID STRING)";
  String queryString;
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,confOverlay);
  assertNotNull(sessionHandle);
  OperationState state=null;
  OperationHandle opHandle;
  OperationStatus opStatus=null;
  queryString="SET " + HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname + " = false";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeOperation(opHandle);
  long longPollingTimeout;
  longPollingTimeout=HiveConf.getTimeVar(new HiveConf(),HiveConf.ConfVars.HIVE_SERVER2_LONG_POLLING_TIMEOUT,TimeUnit.MILLISECONDS);
  queryString="SELECT NON_EXISTING_COLUMN FROM " + tableName;
  try {
    runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.ERROR,longPollingTimeout);
  }
 catch (  HiveSQLException e) {
  }
  queryString="CREATE TABLE NON_EXISTING_TAB (ID STRING) location 'invalid://localhost:10000/a/b/c'";
  opStatus=runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.ERROR,longPollingTimeout);
  assertEquals(opStatus.getOperationException().getSQLState(),"08S01");
  assertEquals(opStatus.getOperationException().getErrorCode(),1);
  queryString="SELECT ID+1 FROM " + tableName;
  runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.FINISHED,longPollingTimeout);
  longPollingTimeout=0;
  queryString="SELECT ID+1 FROM " + tableName;
  runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.FINISHED,longPollingTimeout);
  longPollingTimeout=500;
  queryString="SELECT ID+1 FROM " + tableName;
  runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.FINISHED,longPollingTimeout);
  queryString="SELECT ID+1 FROM " + tableName;
  opHandle=client.executeStatementAsync(sessionHandle,queryString,confOverlay);
  System.out.println("Cancelling " + opHandle);
  client.cancelOperation(opHandle);
  state=client.getOperationStatus(opHandle).getState();
  System.out.println(opHandle + " after cancelling, state= " + state);
  assertEquals("Query should be cancelled",OperationState.CANCELED,state);
  queryString="DROP TABLE " + tableName;
  client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetFunctions() throws Exception {
  SessionHandle sessionHandle=client.openSession("tom","password");
  assertNotNull(sessionHandle);
  OperationHandle opHandle=client.getFunctions(sessionHandle,null,null,"*");
  TableSchema schema=client.getResultSetMetadata(opHandle);
  ColumnDescriptor columnDesc=schema.getColumnDescriptorAt(0);
  assertEquals("FUNCTION_CAT",columnDesc.getName());
  assertEquals(Type.STRING_TYPE,columnDesc.getType());
  columnDesc=schema.getColumnDescriptorAt(1);
  assertEquals("FUNCTION_SCHEM",columnDesc.getName());
  assertEquals(Type.STRING_TYPE,columnDesc.getType());
  columnDesc=schema.getColumnDescriptorAt(2);
  assertEquals("FUNCTION_NAME",columnDesc.getName());
  assertEquals(Type.STRING_TYPE,columnDesc.getType());
  columnDesc=schema.getColumnDescriptorAt(3);
  assertEquals("REMARKS",columnDesc.getName());
  assertEquals(Type.STRING_TYPE,columnDesc.getType());
  columnDesc=schema.getColumnDescriptorAt(4);
  assertEquals("FUNCTION_TYPE",columnDesc.getName());
  assertEquals(Type.INT_TYPE,columnDesc.getType());
  columnDesc=schema.getColumnDescriptorAt(5);
  assertEquals("SPECIFIC_NAME",columnDesc.getName());
  assertEquals(Type.STRING_TYPE,columnDesc.getType());
  client.closeOperation(opHandle);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<pre class="type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test per statement configuration overlay.
 * Create a table using hiveconf: var substitution, with the conf var passed
 * via confOverlay.Verify the confOverlay works for the query and does set the
 * value in the session configuration
 * @throws Exception
 */
@Test public void testConfOverlay() throws Exception {
  SessionHandle sessionHandle=client.openSession("tom","password",new HashMap<String,String>());
  assertNotNull(sessionHandle);
  String tabName="TEST_CONF_EXEC";
  String tabNameVar="tabNameVar";
  String setLockMgr="SET " + HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname + " = false";
  OperationHandle opHandle=client.executeStatement(sessionHandle,setLockMgr,null);
  client.closeOperation(opHandle);
  String dropTable="DROP TABLE IF EXISTS " + tabName;
  opHandle=client.executeStatement(sessionHandle,dropTable,null);
  client.closeOperation(opHandle);
  Map<String,String> confOverlay=new HashMap<String,String>();
  confOverlay.put(tabNameVar,tabName);
  String createTab="CREATE TABLE ${hiveconf:" + tabNameVar + "} (id int)";
  opHandle=client.executeStatement(sessionHandle,createTab,confOverlay);
  assertNotNull(opHandle);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  String selectTab="SELECT * FROM " + tabName;
  opHandle=client.executeStatement(sessionHandle,selectTab,null);
  assertNotNull(opHandle);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  selectTab="SELECT * FROM ${hiveconf:" + tabNameVar + "}";
  try {
    opHandle=client.executeStatement(sessionHandle,selectTab,null);
    fail("Query should fail");
  }
 catch (  HiveSQLException e) {
  }
  dropTable="DROP TABLE IF EXISTS " + tabName;
  opHandle=client.executeStatement(sessionHandle,dropTable,null);
  client.closeOperation(opHandle);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the blocking execution of a query
 * @throws Exception
 */
@Test public void testExecuteStatement() throws Exception {
  HashMap<String,String> confOverlay=new HashMap<String,String>();
  SessionHandle sessionHandle=client.openSession("tom","password",new HashMap<String,String>());
  assertNotNull(sessionHandle);
  OperationHandle opHandle;
  String queryString="SET " + HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname + " = false";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeOperation(opHandle);
  queryString="DROP TABLE IF EXISTS TEST_EXEC";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeOperation(opHandle);
  queryString="CREATE TABLE TEST_EXEC(ID STRING)";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeOperation(opHandle);
  queryString="SELECT ID+1 FROM TEST_EXEC";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  assertEquals("Query should be finished",OperationState.FINISHED,client.getOperationStatus(opHandle).getState());
  client.closeOperation(opHandle);
  queryString="DROP TABLE IF EXISTS TEST_EXEC";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeOperation(opHandle);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.TestHiveSQLException </h4><pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion between the exception text with the simple cause and the
 * Throwable object
 */
@Test public void testExceptionMarshalling() throws Exception {
  Exception ex1=createException();
  ex1.initCause(createSimpleCause());
  Throwable ex=HiveSQLException.toCause(HiveSQLException.toString(ex1));
  Assert.assertSame(RuntimeException.class,ex.getClass());
  Assert.assertEquals("exception1",ex.getMessage());
  Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
  Assert.assertEquals("exception2",ex.getCause().getMessage());
}

</code></pre>

<br>
<pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion between the exception text with nested cause and
 * the Throwable object
 */
@Test public void testNestedException(){
  Exception ex1=createException();
  ex1.initCause(createNestedCause());
  Throwable ex=HiveSQLException.toCause(HiveSQLException.toString(ex1));
  Assert.assertSame(RuntimeException.class,ex.getClass());
  Assert.assertEquals("exception1",ex.getMessage());
  Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
  Assert.assertEquals("exception2",ex.getCause().getMessage());
  Assert.assertSame(Exception.class,ex.getCause().getCause().getClass());
  Assert.assertEquals("exception3",ex.getCause().getCause().getMessage());
}

</code></pre>

<br>
<pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion of the exception from anonymous class
 */
@Test public void testExceptionFromAnonymousClass(){
  Dummy d=new Dummy(){
    public void testExceptionConversion(){
      Exception ex1=createException();
      ex1.initCause(createSimpleCause());
      Throwable ex=HiveSQLException.toCause(HiveSQLException.toString(ex1));
      Assert.assertSame(RuntimeException.class,ex.getClass());
      Assert.assertEquals("exception1",ex.getMessage());
      Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
      Assert.assertEquals("exception2",ex.getCause().getMessage());
    }
  }
;
  d.testExceptionConversion();
}

</code></pre>

<br>
<pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion of the exception with unknown source
 */
@Test public void testExceptionWithUnknownSource(){
  Exception ex1=createException();
  ex1.initCause(createSimpleCause());
  List<String> details=HiveSQLException.toString(ex1);
  String[] tokens=details.get(1).split(":");
  tokens[2]=null;
  tokens[3]="-1";
  details.set(1,StringUtils.join(tokens,":"));
  Throwable ex=HiveSQLException.toCause(details);
  Assert.assertSame(RuntimeException.class,ex.getClass());
  Assert.assertEquals("exception1",ex.getMessage());
  Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
  Assert.assertEquals("exception2",ex.getCause().getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.TestRetryingThriftCLIServiceClient </h4><pre class="type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetryBehaviour() throws Exception {
  HiveConf hiveConf=new HiveConf();
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_BIND_HOST,"localhost");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_PORT,15000);
  hiveConf.setBoolVar(HiveConf.ConfVars.HIVE_SERVER2_ENABLE_DOAS,false);
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_AUTHENTICATION,HiveAuthFactory.AuthTypes.NONE.toString());
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_TRANSPORT_MODE,"binary");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_CLIENT_RETRY_LIMIT,3);
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_CLIENT_CONNECTION_RETRY_LIMIT,3);
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_ASYNC_EXEC_THREADS,10);
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_ASYNC_EXEC_SHUTDOWN_TIMEOUT,"1s");
  final HiveServer2 server=new HiveServer2();
  server.init(hiveConf);
  server.start();
  Thread.sleep(5000);
  System.out.println("## HiveServer started");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_PORT,17000);
  try {
    CLIServiceClient cliServiceClient=RetryingThriftCLIServiceClientTest.newRetryingCLIServiceClient(hiveConf);
    fail("Expected to throw exception for invalid port");
  }
 catch (  HiveSQLException sqlExc) {
    assertTrue(sqlExc.getCause() instanceof TTransportException);
    assertTrue(sqlExc.getMessage().contains("3"));
  }
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_SERVER2_THRIFT_PORT,15000);
  CLIServiceClient cliServiceClient=RetryingThriftCLIServiceClientTest.newRetryingCLIServiceClient(hiveConf);
  System.out.println("## Created client");
  server.stop();
  Thread.sleep(5000);
  try {
    Map<String,String> confOverlay=new HashMap<String,String>();
    RetryingThriftCLIServiceClientTest.handlerInst.callCount=0;
    RetryingThriftCLIServiceClientTest.handlerInst.connectCount=0;
    SessionHandle session=cliServiceClient.openSession("anonymous","anonymous");
  }
 catch (  HiveSQLException exc) {
    exc.printStackTrace();
    assertTrue(exc.getCause() instanceof TException);
    assertEquals(1,RetryingThriftCLIServiceClientTest.handlerInst.callCount);
    assertEquals(3,RetryingThriftCLIServiceClientTest.handlerInst.connectCount);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.OperationLoggingAPITestBase </h4><pre class="type-12 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchResultsOfLogCleanup() throws Exception {
  SessionHandle sessionHandleCleanup=setupSession();
  OperationHandle operationHandle=client.executeStatement(sessionHandleCleanup,sql,null);
  RowSet rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  verifyFetchedLog(rowSetLog,expectedLogsVerbose);
  File sessionLogDir=new File(hiveConf.getVar(HiveConf.ConfVars.HIVE_SERVER2_LOGGING_OPERATION_LOG_LOCATION) + File.separator + sessionHandleCleanup.getHandleIdentifier());
  File operationLogFile=new File(sessionLogDir,operationHandle.getHandleIdentifier().toString());
  client.closeOperation(operationHandle);
  try {
    client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
    Assert.fail("Fetch should fail");
  }
 catch (  HiveSQLException e) {
    Assert.assertTrue(e.getMessage().contains("Invalid OperationHandle:"));
  }
  if (operationLogFile.exists()) {
    Assert.fail("Operation log file should be deleted.");
  }
  client.closeSession(sessionHandleCleanup);
  if (sessionLogDir.exists()) {
    Assert.fail("Session log dir should be deleted.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithMr </h4><pre class="type-11 type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchResultsOfLogAsync() throws Exception {
  OperationHandle operationHandle=client.executeStatementAsync(sessionHandle,sql,null);
  boolean isQueryRunning=true;
  long pollTimeout=System.currentTimeMillis() + 100000;
  OperationStatus opStatus;
  OperationState state=null;
  RowSet rowSetAccumulated=null;
  StringBuilder logs=new StringBuilder();
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      break;
    }
    opStatus=client.getOperationStatus(operationHandle);
    Assert.assertNotNull(opStatus);
    state=opStatus.getState();
    rowSetAccumulated=client.fetchResults(operationHandle,FetchOrientation.FETCH_NEXT,2000,FetchType.LOG);
    for (    Object[] row : rowSetAccumulated) {
      logs.append(row[0]);
    }
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(10);
  }
  Assert.assertEquals("Query should be finished",OperationState.FINISHED,state);
  verifyFetchedLogPost(logs.toString(),expectedLogsVerbose,true);
  RowSet rowSet=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,2000,FetchType.LOG);
  verifyFetchedLog(rowSet,expectedLogsVerbose);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.session.TestPluggableHiveSessionImpl </h4><pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionImpl(){
  SessionHandle sessionHandle=null;
  try {
    sessionHandle=client.openSession("tom","password");
    Assert.assertEquals(TestHiveSessionImpl.class.getName(),service.getHiveConf().getVar(HiveConf.ConfVars.HIVE_SESSION_IMPL_CLASSNAME));
    Assert.assertTrue(cliService.getSessionManager().getSession(sessionHandle) instanceof TestHiveSessionImpl);
    client.closeSession(sessionHandle);
  }
 catch (  HiveSQLException e) {
    e.printStackTrace();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.thrift.ThriftCLIServiceTest </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test synchronous query execution
 * @throws Exception
 */
@Test public void testExecuteStatement() throws Exception {
  Map<String,String> opConf=new HashMap<String,String>();
  SessionHandle sessHandle=client.openSession(USERNAME,PASSWORD,opConf);
  assertNotNull("Session handle should not be null",sessHandle);
  String queryString="SET hive.lock.manager=" + "org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="DROP TABLE IF EXISTS TEST_EXEC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="CREATE TABLE TEST_EXEC_THRIFT(ID STRING)";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="SELECT ID+1 FROM TEST_EXEC_THRIFT";
  OperationHandle opHandle=client.executeStatement(sessHandle,queryString,opConf);
  assertNotNull(opHandle);
  OperationStatus opStatus=client.getOperationStatus(opHandle);
  assertNotNull(opStatus);
  OperationState state=opStatus.getState();
  assertEquals("Query should be finished",OperationState.FINISHED,state);
  queryString="DROP TABLE TEST_EXEC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  client.closeSession(sessHandle);
}

</code></pre>

<br>
<pre class="type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test asynchronous query execution and error reporting to the client
 * @throws Exception
 */
@Test public void testExecuteStatementAsync() throws Exception {
  Map<String,String> opConf=new HashMap<String,String>();
  SessionHandle sessHandle=client.openSession(USERNAME,PASSWORD,opConf);
  assertNotNull("Session handle should not be null",sessHandle);
  OperationHandle opHandle;
  OperationStatus opStatus;
  OperationState state=null;
  String queryString="SET hive.lock.manager=" + "org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="DROP TABLE IF EXISTS TEST_EXEC_ASYNC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="CREATE TABLE TEST_EXEC_ASYNC_THRIFT(ID STRING)";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="SELECT ID+1 FROM TEST_EXEC_ASYNC_THRIFT";
  System.out.println("Will attempt to execute: " + queryString);
  opHandle=client.executeStatementAsync(sessHandle,queryString,opConf);
  assertNotNull(opHandle);
  boolean isQueryRunning=true;
  long pollTimeout=System.currentTimeMillis() + 100000;
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      System.out.println("Polling timed out");
      break;
    }
    opStatus=client.getOperationStatus(opHandle);
    assertNotNull(opStatus);
    state=opStatus.getState();
    System.out.println("Current state: " + state);
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(1000);
  }
  assertEquals("Query should be finished",OperationState.FINISHED,state);
  queryString="CREATE TABLE NON_EXISTING_TAB (ID STRING) location 'hdfs://localhost:10000/a/b/c'";
  System.out.println("Will attempt to execute: " + queryString);
  opHandle=client.executeStatementAsync(sessHandle,queryString,opConf);
  assertNotNull(opHandle);
  opStatus=client.getOperationStatus(opHandle);
  assertNotNull(opStatus);
  isQueryRunning=true;
  pollTimeout=System.currentTimeMillis() + 100000;
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      System.out.println("Polling timed out");
      break;
    }
    state=opStatus.getState();
    System.out.println("Current state: " + state);
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(1000);
    opStatus=client.getOperationStatus(opHandle);
  }
  assertEquals("Operation should be in error state",OperationState.ERROR,state);
  assertEquals(opStatus.getOperationException().getSQLState(),"08S01");
  assertEquals(opStatus.getOperationException().getErrorCode(),1);
  queryString="DROP TABLE TEST_EXEC_ASYNC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  client.closeSession(sessHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.thrift.ThriftCliServiceTestWithCookie </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test synchronous query execution
 * @throws Exception
 */
@Test public void testExecuteStatement() throws Exception {
  Map<String,String> opConf=new HashMap<String,String>();
  SessionHandle sessHandle=client.openSession(USERNAME,PASSWORD,opConf);
  assertNotNull("Session handle should not be null",sessHandle);
  String queryString="SET hive.lock.manager=" + "org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="DROP TABLE IF EXISTS TEST_EXEC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="CREATE TABLE TEST_EXEC_THRIFT(ID STRING)";
  client.executeStatement(sessHandle,queryString,opConf);
  queryString="SELECT ID+1 FROM TEST_EXEC_THRIFT";
  OperationHandle opHandle=client.executeStatement(sessHandle,queryString,opConf);
  assertNotNull(opHandle);
  OperationStatus opStatus=client.getOperationStatus(opHandle);
  assertNotNull(opStatus);
  OperationState state=opStatus.getState();
  assertEquals("Query should be finished",OperationState.FINISHED,state);
  queryString="DROP TABLE TEST_EXEC_THRIFT";
  client.executeStatement(sessHandle,queryString,opConf);
  client.closeSession(sessHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.server.TestHS2HttpServer </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServket() throws Exception {
  String baseURL="http://localhost:" + ConfVars.HIVE_SERVER2_WEBUI_PORT.getDefaultValue() + "/stacks";
  URL url=new URL(baseURL);
  HttpURLConnection conn=(HttpURLConnection)url.openConnection();
  Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
  BufferedReader reader=new BufferedReader(new InputStreamReader(conn.getInputStream()));
  boolean contents=false;
  String line;
  while ((line=reader.readLine()) != null) {
    if (line.contains("Process Thread Dump:")) {
      contents=true;
    }
  }
  Assert.assertTrue(contents);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.TestMetricsCollection </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputReadMethodAggregation(){
  MetricsCollection collection=new MetricsCollection();
  long value=taskValue(1,1,1);
  Metrics metrics1=new Metrics(value,value,value,value,value,value,value,new InputMetrics(DataReadMethod.Memory,value),null,null);
  Metrics metrics2=new Metrics(value,value,value,value,value,value,value,new InputMetrics(DataReadMethod.Disk,value),null,null);
  collection.addMetrics(1,1,1,metrics1);
  collection.addMetrics(1,1,2,metrics2);
  Metrics global=collection.getAllMetrics();
  assertNotNull(global.inputMetrics);
  assertEquals(DataReadMethod.Multiple,global.inputMetrics.readMethod);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOptionalMetrics(){
  long value=taskValue(1,1,1L);
  Metrics metrics=new Metrics(value,value,value,value,value,value,value,null,null,null);
  MetricsCollection collection=new MetricsCollection();
  for (  int i : Arrays.asList(1,2)) {
    collection.addMetrics(i,1,1,metrics);
  }
  Metrics global=collection.getAllMetrics();
  assertNull(global.inputMetrics);
  assertNull(global.shuffleReadMetrics);
  assertNull(global.shuffleWriteMetrics);
  collection.addMetrics(3,1,1,makeMetrics(3,1,1));
  Metrics global2=collection.getAllMetrics();
  assertNotNull(global2.inputMetrics);
  assertEquals(taskValue(3,1,1),global2.inputMetrics.bytesRead);
  assertNotNull(global2.shuffleReadMetrics);
  assertNotNull(global2.shuffleWriteMetrics);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.TestSparkClient </h4><pre class="type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCounters() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle<?> job=client.submit(new CounterIncrementJob());
      job.get(TIMEOUT,TimeUnit.SECONDS);
      SparkCounters counters=job.getSparkCounters();
      assertNotNull(counters);
      long expected=1 + 2 + 3+ 4+ 5;
      assertEquals(expected,counters.getCounter("group1","counter1").getValue());
      assertEquals(expected,counters.getCounter("group2","counter2").getValue());
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricsCollection() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle.Listener<Integer> listener=newListener();
      JobHandle<Integer> future=client.submit(new AsyncSparkJob());
      future.addListener(listener);
      future.get(TIMEOUT,TimeUnit.SECONDS);
      MetricsCollection metrics=future.getMetrics();
      assertEquals(1,metrics.getJobIds().size());
      assertTrue(metrics.getAllMetrics().executorRunTime >= 0L);
      verify(listener).onSparkJobStarted(same(future),eq(metrics.getJobIds().iterator().next()));
      JobHandle.Listener<Integer> listener2=newListener();
      JobHandle<Integer> future2=client.submit(new AsyncSparkJob());
      future2.addListener(listener2);
      future2.get(TIMEOUT,TimeUnit.SECONDS);
      MetricsCollection metrics2=future2.getMetrics();
      assertEquals(1,metrics2.getJobIds().size());
      assertFalse(Objects.equal(metrics.getJobIds(),metrics2.getJobIds()));
      assertTrue(metrics2.getAllMetrics().executorRunTime >= 0L);
      verify(listener2).onSparkJobStarted(same(future2),eq(metrics2.getJobIds().iterator().next()));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorJob() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle.Listener<String> listener=newListener();
      JobHandle<String> handle=client.submit(new ErrorJob());
      handle.addListener(listener);
      try {
        handle.get(TIMEOUT,TimeUnit.SECONDS);
        fail("Should have thrown an exception.");
      }
 catch (      ExecutionException ee) {
        assertTrue(ee.getCause() instanceof SparkException);
        assertTrue(ee.getCause().getMessage().contains("IllegalStateException: Hello"));
      }
      assertFalse(((JobHandleImpl<String>)handle).changeState(JobHandle.State.SENT));
      verify(listener).onJobQueued(handle);
      verify(listener).onJobStarted(handle);
      verify(listener).onJobFailed(same(handle),any(Throwable.class));
    }
  }
);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJobSubmission() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      JobHandle.Listener<String> listener=newListener();
      JobHandle<String> handle=client.submit(new SimpleJob());
      handle.addListener(listener);
      assertEquals("hello",handle.get(TIMEOUT,TimeUnit.SECONDS));
      assertFalse(((JobHandleImpl<String>)handle).changeState(JobHandle.State.SENT));
      verify(listener).onJobQueued(handle);
      verify(listener).onJobStarted(handle);
      verify(listener).onJobSucceeded(same(handle),eq(handle.get()));
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.rpc.TestKryoMessageCodec </h4><pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNegativeMessageSize() throws Exception {
  KryoMessageCodec codec=new KryoMessageCodec(1024);
  ByteBuf buf=newBuffer();
  buf.writeInt(-1);
  try {
    List out=Lists.newArrayList();
    codec.decode(null,buf,out);
    fail("Should have failed to decode message with negative size.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("must be positive") > 0);
  }
}

</code></pre>

<br>
<pre class="type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutoRegistration() throws Exception {
  KryoMessageCodec codec=new KryoMessageCodec(0,TestMessage.class);
  ByteBuf buf=newBuffer();
  codec.encode(null,new TestMessage(),buf);
  List out=Lists.newArrayList();
  codec.decode(null,buf,out);
  assertEquals(1,out.size());
  assertTrue(out.get(0) instanceof TestMessage);
}

</code></pre>

<br>
<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmbeddedChannel() throws Exception {
  EmbeddedChannel c=new EmbeddedChannel(new LoggingHandler(getClass()),new KryoMessageCodec(0));
  c.writeAndFlush(MESSAGE);
  assertEquals(1,c.outboundMessages().size());
  assertFalse(MESSAGE.getClass().equals(c.outboundMessages().peek().getClass()));
  c.writeInbound(c.readOutbound());
  assertEquals(1,c.inboundMessages().size());
  assertEquals(MESSAGE,c.readInbound());
  c.close();
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxMessageSize() throws Exception {
  KryoMessageCodec codec=new KryoMessageCodec(1024);
  ByteBuf buf=newBuffer();
  codec.encode(null,new TestMessage(new byte[512]),buf);
  try {
    codec.encode(null,new TestMessage(new byte[1025]),buf);
    fail("Should have failed to encode large message.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("maximum allowed size") > 0);
  }
  KryoMessageCodec unlimited=new KryoMessageCodec(0);
  buf=newBuffer();
  unlimited.encode(null,new TestMessage(new byte[1025]),buf);
  try {
    List out=Lists.newArrayList();
    codec.decode(null,buf,out);
    fail("Should have failed to decode large message.");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getMessage().indexOf("maximum allowed size") > 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.rpc.TestRpc </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientServer() throws Exception {
  RpcServer server=autoClose(new RpcServer(emptyConfig));
  Rpc[] rpcs=createRpcConnection(server);
  Rpc serverRpc=rpcs[0];
  Rpc client=rpcs[1];
  TestMessage outbound=new TestMessage("Hello World!");
  Future<TestMessage> call=client.call(outbound,TestMessage.class);
  TestMessage reply=call.get(10,TimeUnit.SECONDS);
  assertEquals(outbound.message,reply.message);
  TestMessage another=new TestMessage("Hello again!");
  Future<TestMessage> anotherCall=client.call(another,TestMessage.class);
  TestMessage anotherReply=anotherCall.get(10,TimeUnit.SECONDS);
  assertEquals(another.message,anotherReply.message);
  String errorMsg="This is an error.";
  try {
    client.call(new ErrorCall(errorMsg)).get(10,TimeUnit.SECONDS);
  }
 catch (  ExecutionException ee) {
    assertTrue(ee.getCause() instanceof RpcException);
    assertTrue(ee.getCause().getMessage().indexOf(errorMsg) >= 0);
  }
  TestMessage serverMsg=new TestMessage("Hello from the server!");
  Future<TestMessage> serverCall=serverRpc.call(serverMsg,TestMessage.class);
  TestMessage serverReply=serverCall.get(10,TimeUnit.SECONDS);
  assertEquals(serverMsg.message,serverReply.message);
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientTimeout() throws Exception {
  Map<String,String> conf=ImmutableMap.<String,String>builder().putAll(emptyConfig).build();
  RpcServer server=autoClose(new RpcServer(conf));
  String secret=server.createSecret();
  try {
    autoClose(server.registerClient("client",secret,new TestDispatcher(),1L).get());
    fail("Server should have timed out client.");
  }
 catch (  ExecutionException ee) {
    assertTrue(ee.getCause() instanceof TimeoutException);
  }
  NioEventLoopGroup eloop=new NioEventLoopGroup();
  Future<Rpc> clientRpcFuture=Rpc.createClient(conf,eloop,"localhost",server.getPort(),"client",secret,new TestDispatcher());
  try {
    autoClose(clientRpcFuture.get());
    fail("Client should have failed to connect to server.");
  }
 catch (  ExecutionException ee) {
    assertFalse(ee.getCause() instanceof TimeoutException);
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadHello() throws Exception {
  RpcServer server=autoClose(new RpcServer(emptyConfig));
  Future<Rpc> serverRpcFuture=server.registerClient("client","newClient",new TestDispatcher());
  NioEventLoopGroup eloop=new NioEventLoopGroup();
  Future<Rpc> clientRpcFuture=Rpc.createClient(emptyConfig,eloop,"localhost",server.getPort(),"client","wrongClient",new TestDispatcher());
  try {
    autoClose(clientRpcFuture.get(10,TimeUnit.SECONDS));
    fail("Should have failed to create client with wrong secret.");
  }
 catch (  ExecutionException ee) {
    assertTrue("Unexpected exception: " + ee.getCause(),ee.getCause() instanceof SaslException);
  }
  serverRpcFuture.cancel(true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestSerializationUtils </h4><pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSubtractionOverflowGuava(){
  try {
    LongMath.checkedSubtract(22222222222L,Long.MIN_VALUE);
    fail("expected ArithmeticException for overflow");
  }
 catch (  ArithmeticException ex) {
    assertEquals(ex.getMessage(),"overflow");
  }
  try {
    LongMath.checkedSubtract(-22222222222L,Long.MAX_VALUE);
    fail("expected ArithmeticException for overflow");
  }
 catch (  ArithmeticException ex) {
    assertEquals(ex.getMessage(),"overflow");
  }
  try {
    LongMath.checkedSubtract(Long.MIN_VALUE,Long.MAX_VALUE);
    fail("expected ArithmeticException for overflow");
  }
 catch (  ArithmeticException ex) {
    assertEquals(ex.getMessage(),"overflow");
  }
  assertEquals(-8106206116692740190L,LongMath.checkedSubtract(-1553103058346370095L,6553103058346370095L));
  assertEquals(-Long.MAX_VALUE,LongMath.checkedSubtract(0,Long.MAX_VALUE));
  assertEquals(Long.MIN_VALUE,LongMath.checkedSubtract(Long.MIN_VALUE,0));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
