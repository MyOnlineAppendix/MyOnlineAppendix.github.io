<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestLazyAccumuloMap </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinaryIntMap() throws SerDeException, IOException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add(new Text("cf1"),new Text(toBytes(1)),toBytes(2));
  row.add(new Text("cf1"),new Text(toBytes(2)),toBytes(4));
  row.add(new Text("cf1"),new Text(toBytes(3)),toBytes(6));
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.BINARY,ColumnEncoding.BINARY,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,int>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(3,map.getMapSize());
  Object o=map.getMapValueElement(new IntWritable(1));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(2),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(2));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(4),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(3));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(6),((LazyInteger)o).getWritableObject());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringMapWithProjection() throws SerDeException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add("cf1","foo","bar".getBytes());
  row.add("cf1","bar","foo".getBytes());
  row.add("cf2","foo1","bar1".getBytes());
  row.add("cf3","bar1","foo1".getBytes());
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.STRING,ColumnEncoding.STRING,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<string,string>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(2,map.getMapSize());
  Object o=map.getMapValueElement(new Text("foo"));
  Assert.assertNotNull(o);
  Assert.assertEquals(new Text("bar"),((LazyString)o).getWritableObject());
  o=map.getMapValueElement(new Text("bar"));
  Assert.assertNotNull(o);
  Assert.assertEquals(new Text("foo"),((LazyString)o).getWritableObject());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMixedSerializationMap() throws SerDeException, IOException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add(new Text("cf1"),new Text(toBytes(1)),"2".getBytes());
  row.add(new Text("cf1"),new Text(toBytes(2)),"4".getBytes());
  row.add(new Text("cf1"),new Text(toBytes(3)),"6".getBytes());
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.BINARY,ColumnEncoding.STRING,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,int>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(3,map.getMapSize());
  Object o=map.getMapValueElement(new IntWritable(1));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(2),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(2));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(4),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(3));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(6),((LazyInteger)o).getWritableObject());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntMap() throws SerDeException, IOException {
  AccumuloHiveRow row=new AccumuloHiveRow("row");
  row.add(new Text("cf1"),new Text("1"),"2".getBytes());
  row.add(new Text("cf1"),new Text("2"),"4".getBytes());
  row.add(new Text("cf1"),new Text("3"),"6".getBytes());
  HiveAccumuloMapColumnMapping mapping=new HiveAccumuloMapColumnMapping("cf1",null,ColumnEncoding.STRING,ColumnEncoding.STRING,"column",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo).toString());
  Text nullSequence=new Text("\\N");
  ObjectInspector oi=LazyFactory.createLazyObjectInspector(TypeInfoUtils.getTypeInfosFromTypeString("map<int,int>").get(0),new byte[]{(byte)1,(byte)2},0,nullSequence,false,(byte)0);
  LazyAccumuloMap map=new LazyAccumuloMap((LazyMapObjectInspector)oi);
  map.init(row,mapping);
  Assert.assertEquals(3,map.getMapSize());
  Object o=map.getMapValueElement(new IntWritable(1));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(2),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(2));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(4),((LazyInteger)o).getWritableObject());
  o=map.getMapValueElement(new IntWritable(3));
  Assert.assertNotNull(o);
  Assert.assertEquals(new IntWritable(6),((LazyInteger)o).getWritableObject());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.TestLazyAccumuloRow </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeserializationOfBinaryEncoding() throws Exception {
  List<String> columns=Arrays.asList("row","given_name","surname","age","weight","height");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo);
  LazySimpleStructObjectInspector objectInspector=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(columns,types,LazySerDeParameters.DefaultSeparators,new Text("\\N"),false,false,(byte)'\\');
  DefaultAccumuloRowIdFactory rowIdFactory=new DefaultAccumuloRowIdFactory();
  Properties props=new Properties();
  props.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid#s,personal:given_name#s,personal:surname#s,personal:age,personal:weight,personal:height");
  props.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  props.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  props.setProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,ColumnEncoding.BINARY.getName());
  AccumuloSerDeParameters params=new AccumuloSerDeParameters(new Configuration(),props,AccumuloSerDe.class.getName());
  rowIdFactory.init(params,props);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  LazyAccumuloRow lazyRow=new LazyAccumuloRow(objectInspector);
  AccumuloHiveRow hiveRow=new AccumuloHiveRow("1");
  hiveRow.add("personal","given_name","Bob".getBytes());
  hiveRow.add("personal","surname","Stevens".getBytes());
  out.writeInt(30);
  hiveRow.add("personal","age",baos.toByteArray());
  baos.reset();
  out.writeInt(200);
  hiveRow.add("personal","weight",baos.toByteArray());
  baos.reset();
  out.writeInt(72);
  hiveRow.add("personal","height",baos.toByteArray());
  ColumnMapper columnMapper=params.getColumnMapper();
  lazyRow.init(hiveRow,columnMapper.getColumnMappings(),rowIdFactory);
  Object o=lazyRow.getField(0);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("1",((LazyString)o).toString());
  o=lazyRow.getField(1);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("Bob",((LazyString)o).toString());
  o=lazyRow.getField(2);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("Stevens",((LazyString)o).toString());
  o=lazyRow.getField(3);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyDioInteger.class,o.getClass());
  Assert.assertEquals("30",((LazyDioInteger)o).toString());
  o=lazyRow.getField(4);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyDioInteger.class,o.getClass());
  Assert.assertEquals("200",((LazyDioInteger)o).toString());
  o=lazyRow.getField(5);
  Assert.assertNotNull(o);
  Assert.assertEquals(LazyDioInteger.class,o.getClass());
  Assert.assertEquals("72",((LazyDioInteger)o).toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpectedDeserializationOfColumns() throws Exception {
  List<String> columns=Arrays.asList("row","given_name","surname","age","weight","height");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo);
  LazySimpleStructObjectInspector objectInspector=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(columns,types,LazySerDeParameters.DefaultSeparators,new Text("\\N"),false,false,(byte)'\\');
  DefaultAccumuloRowIdFactory rowIdFactory=new DefaultAccumuloRowIdFactory();
  Properties props=new Properties();
  props.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,personal:given_name,personal:surname,personal:age,personal:weight,personal:height");
  props.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  props.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters params=new AccumuloSerDeParameters(new Configuration(),props,AccumuloSerDe.class.getName());
  rowIdFactory.init(params,props);
  LazyAccumuloRow lazyRow=new LazyAccumuloRow(objectInspector);
  AccumuloHiveRow hiveRow=new AccumuloHiveRow("1");
  hiveRow.add("personal","given_name","Bob".getBytes());
  hiveRow.add("personal","surname","Stevens".getBytes());
  hiveRow.add("personal","age","30".getBytes());
  hiveRow.add("personal","weight","200".getBytes());
  hiveRow.add("personal","height","72".getBytes());
  ColumnMapper columnMapper=params.getColumnMapper();
  lazyRow.init(hiveRow,columnMapper.getColumnMappings(),rowIdFactory);
  Object o=lazyRow.getField(0);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("1",((LazyString)o).toString());
  o=lazyRow.getField(1);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("Bob",((LazyString)o).toString());
  o=lazyRow.getField(2);
  Assert.assertEquals(LazyString.class,o.getClass());
  Assert.assertEquals("Stevens",((LazyString)o).toString());
  o=lazyRow.getField(3);
  Assert.assertEquals(LazyInteger.class,o.getClass());
  Assert.assertEquals("30",((LazyInteger)o).toString());
  o=lazyRow.getField(4);
  Assert.assertEquals(LazyInteger.class,o.getClass());
  Assert.assertEquals("200",((LazyInteger)o).toString());
  o=lazyRow.getField(5);
  Assert.assertEquals(LazyInteger.class,o.getClass());
  Assert.assertEquals("72",((LazyInteger)o).toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullInit() throws SerDeException {
  List<String> columns=Arrays.asList("row","1","2","3");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME),TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME),TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME),TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME));
  LazySimpleStructObjectInspector objectInspector=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(columns,types,LazySerDeParameters.DefaultSeparators,new Text("\\N"),false,false,(byte)'\\');
  DefaultAccumuloRowIdFactory rowIdFactory=new DefaultAccumuloRowIdFactory();
  Properties props=new Properties();
  props.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,cf:cq1,cf:cq2,cf:cq3");
  props.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  props.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters params=new AccumuloSerDeParameters(new Configuration(),props,AccumuloSerDe.class.getName());
  rowIdFactory.init(params,props);
  ColumnMapper columnMapper=params.getColumnMapper();
  LazyAccumuloRow lazyRow=new LazyAccumuloRow(objectInspector);
  AccumuloHiveRow hiveRow=new AccumuloHiveRow("1");
  hiveRow.add("cf","cq1","foo".getBytes());
  hiveRow.add("cf","cq3","bar".getBytes());
  lazyRow.init(hiveRow,columnMapper.getColumnMappings(),rowIdFactory);
  Assert.assertEquals("{'row':'1','1':'foo','2':null,'3':'bar'}".replace('\'','"'),SerDeUtils.getJSONString(lazyRow,objectInspector));
  Assert.assertEquals("{'row':'1','1':'foo','2':null,'3':'bar'}".replace('\'','"'),SerDeUtils.getJSONString(lazyRow,objectInspector));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.columns.TestColumnMapper </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalMapping() throws TooManyAccumuloColumnsException {
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  List<String> columnNames=Arrays.asList("row","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.STRING.getName(),columnNames,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(rawMappings.size(),mappings.size());
  Assert.assertEquals(mappings.size(),mapper.size());
  Iterator<String> rawIter=rawMappings.iterator();
  Iterator<ColumnMapping> iter=mappings.iterator();
  for (int i=0; i < mappings.size() && iter.hasNext(); i++) {
    String rawMapping=rawIter.next();
    ColumnMapping mapping=iter.next();
    ColumnMapping mappingByOffset=mapper.get(i);
    Assert.assertEquals(mapping,mappingByOffset);
    if (AccumuloHiveConstants.ROWID.equals(rawMapping)) {
      Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mapping.getClass());
    }
 else {
      Assert.assertEquals(HiveAccumuloColumnMapping.class,mapping.getClass());
    }
  }
  Assert.assertEquals(0,mapper.getRowIdOffset());
  Assert.assertTrue(mapper.hasRowIdMapping());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMap() throws TooManyAccumuloColumnsException {
  List<String> hiveColumns=Arrays.asList("rowid","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo),TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo),TypeInfoFactory.stringTypeInfo);
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf1:*","cf2:2*","cq3:bar\\*");
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.BINARY.getName(),hiveColumns,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(4,mappings.size());
  Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mappings.get(0).getClass());
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mappings.get(1).getClass());
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mappings.get(2).getClass());
  Assert.assertEquals(HiveAccumuloColumnMapping.class,mappings.get(3).getClass());
  HiveAccumuloRowIdColumnMapping row=(HiveAccumuloRowIdColumnMapping)mappings.get(0);
  Assert.assertEquals(ColumnEncoding.BINARY,row.getEncoding());
  Assert.assertEquals(hiveColumns.get(0),row.getColumnName());
  Assert.assertEquals(columnTypes.get(0).toString(),row.getColumnType());
  HiveAccumuloMapColumnMapping map=(HiveAccumuloMapColumnMapping)mappings.get(1);
  Assert.assertEquals("cf1",map.getColumnFamily());
  Assert.assertEquals("",map.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.BINARY,map.getEncoding());
  Assert.assertEquals(hiveColumns.get(1),map.getColumnName());
  Assert.assertEquals(columnTypes.get(1).toString(),map.getColumnType());
  map=(HiveAccumuloMapColumnMapping)mappings.get(2);
  Assert.assertEquals("cf2",map.getColumnFamily());
  Assert.assertEquals("2",map.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.BINARY,map.getEncoding());
  Assert.assertEquals(hiveColumns.get(2),map.getColumnName());
  Assert.assertEquals(columnTypes.get(2).toString(),map.getColumnType());
  HiveAccumuloColumnMapping column=(HiveAccumuloColumnMapping)mappings.get(3);
  Assert.assertEquals("cq3",column.getColumnFamily());
  Assert.assertEquals("bar*",column.getColumnQualifier());
  Assert.assertEquals(ColumnEncoding.BINARY,column.getEncoding());
  Assert.assertEquals(hiveColumns.get(3),column.getColumnName());
  Assert.assertEquals(columnTypes.get(3).toString(),column.getColumnType());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetTypesString() throws TooManyAccumuloColumnsException {
  List<String> hiveColumns=Arrays.asList("rowid","col1","col2","col3");
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),null,hiveColumns,columnTypes);
  String typeString=mapper.getTypesString();
  String[] types=StringUtils.split(typeString,AccumuloHiveConstants.COLON);
  Assert.assertEquals(rawMappings.size(),types.length);
  for (  String type : types) {
    Assert.assertEquals(serdeConstants.STRING_TYPE_NAME,type);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetMappingFromHiveColumn() throws TooManyAccumuloColumnsException {
  List<String> hiveColumns=Arrays.asList("rowid","col1","col2","col3");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_","cf:qual");
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),null,hiveColumns,columnTypes);
  for (int i=0; i < hiveColumns.size(); i++) {
    String hiveColumn=hiveColumns.get(i), accumuloMapping=rawMappings.get(i);
    ColumnMapping mapping=mapper.getColumnMappingForHiveColumn(hiveColumns,hiveColumn);
    Assert.assertEquals(accumuloMapping,mapping.getMappingSpec());
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultBinary() throws TooManyAccumuloColumnsException {
  List<String> hiveColumns=Arrays.asList("rowid","col1","col2","col3","col4");
  List<String> rawMappings=Arrays.asList(AccumuloHiveConstants.ROWID,"cf:cq","cf:_#s","cf:qual#s","cf:qual2");
  List<TypeInfo> columnTypes=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  ColumnMapper mapper=new ColumnMapper(Joiner.on(AccumuloHiveConstants.COMMA).join(rawMappings),ColumnEncoding.BINARY.getName(),hiveColumns,columnTypes);
  List<ColumnMapping> mappings=mapper.getColumnMappings();
  Assert.assertEquals(5,mappings.size());
  Assert.assertEquals(ColumnEncoding.BINARY,mappings.get(0).getEncoding());
  Assert.assertEquals(columnTypes.get(0).toString(),mappings.get(0).getColumnType());
  Assert.assertEquals(ColumnEncoding.BINARY,mappings.get(1).getEncoding());
  Assert.assertEquals(columnTypes.get(1).toString(),mappings.get(1).getColumnType());
  Assert.assertEquals(ColumnEncoding.STRING,mappings.get(2).getEncoding());
  Assert.assertEquals(columnTypes.get(2).toString(),mappings.get(2).getColumnType());
  Assert.assertEquals(ColumnEncoding.STRING,mappings.get(3).getEncoding());
  Assert.assertEquals(columnTypes.get(3).toString(),mappings.get(3).getColumnType());
  Assert.assertEquals(ColumnEncoding.BINARY,mappings.get(4).getEncoding());
  Assert.assertEquals(columnTypes.get(4).toString(),mappings.get(4).getColumnType());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.columns.TestColumnMappingFactory </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCaseInsensitiveRowId(){
  String mappingStr=":rowid";
  ColumnMapping mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.getDefault(),"col",TypeInfoFactory.stringTypeInfo);
  Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mapping.getClass());
  mappingStr=":rowid#b";
  mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.getDefault(),"col",TypeInfoFactory.stringTypeInfo);
  Assert.assertEquals(HiveAccumuloRowIdColumnMapping.class,mapping.getClass());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInlineEncodingOverridesDefault(){
  String mappingStr="cf:foo#s";
  ColumnMapping mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.BINARY,"col",TypeInfoFactory.stringTypeInfo);
  Assert.assertEquals(HiveAccumuloColumnMapping.class,mapping.getClass());
  HiveAccumuloColumnMapping colMapping=(HiveAccumuloColumnMapping)mapping;
  Assert.assertEquals("cf",colMapping.getColumnFamily());
  Assert.assertEquals("foo",colMapping.getColumnQualifier());
  Assert.assertEquals(ColumnEncoding.STRING,colMapping.getEncoding());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetMapWithPrefix(){
  String mappingStr="cf:foo*";
  ColumnMapping mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.getDefault(),"col",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo));
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mapping.getClass());
  HiveAccumuloMapColumnMapping mapMapping=(HiveAccumuloMapColumnMapping)mapping;
  Assert.assertEquals("cf",mapMapping.getColumnFamily());
  Assert.assertEquals("foo",mapMapping.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.getDefault(),mapMapping.getKeyEncoding());
  Assert.assertEquals(ColumnEncoding.getDefault(),mapMapping.getValueEncoding());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPrefixWithEscape(){
  String mappingStr="cf:foo\\*bar*";
  ColumnMapping mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.getDefault(),"col",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo));
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mapping.getClass());
  HiveAccumuloMapColumnMapping mapMapping=(HiveAccumuloMapColumnMapping)mapping;
  Assert.assertEquals("cf",mapMapping.getColumnFamily());
  Assert.assertEquals("foo*bar",mapMapping.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.getDefault(),mapMapping.getKeyEncoding());
  Assert.assertEquals(ColumnEncoding.getDefault(),mapMapping.getValueEncoding());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetMap(){
  String mappingStr="cf:*";
  ColumnMapping mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.getDefault(),"col",TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo));
  Assert.assertEquals(HiveAccumuloMapColumnMapping.class,mapping.getClass());
  HiveAccumuloMapColumnMapping mapMapping=(HiveAccumuloMapColumnMapping)mapping;
  Assert.assertEquals("cf",mapMapping.getColumnFamily());
  Assert.assertEquals("",mapMapping.getColumnQualifierPrefix());
  Assert.assertEquals(ColumnEncoding.getDefault(),mapMapping.getKeyEncoding());
  Assert.assertEquals(ColumnEncoding.getDefault(),mapMapping.getValueEncoding());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEscapedAsterisk(){
  String mappingStr="cf:\\*";
  ColumnMapping mapping=ColumnMappingFactory.get(mappingStr,ColumnEncoding.getDefault(),"col",TypeInfoFactory.stringTypeInfo);
  Assert.assertEquals(HiveAccumuloColumnMapping.class,mapping.getClass());
  HiveAccumuloColumnMapping colMapping=(HiveAccumuloColumnMapping)mapping;
  Assert.assertEquals("cf",colMapping.getColumnFamily());
  Assert.assertEquals("*",colMapping.getColumnQualifier());
  Assert.assertEquals(ColumnEncoding.getDefault(),colMapping.getEncoding());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTableInputFormat </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapColumnPairs() throws TooManyAccumuloColumnsException {
  ColumnMapper columnMapper=new ColumnMapper(":rowID,cf:*",conf.get(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE),Arrays.asList("row","col"),Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo)));
  Set<Pair<Text,Text>> pairs=inputformat.getPairCollection(columnMapper.getColumnMappings());
  Assert.assertEquals(1,pairs.size());
  Pair<Text,Text> cfCq=pairs.iterator().next();
  Assert.assertEquals("cf",cfCq.getFirst().toString());
  Assert.assertNull(cfCq.getSecond());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTableOutputFormat </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinarySerializationOnStringFallsBackToUtf8() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1","col2");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq1,cf:cq2");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  tableProperties.setProperty(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,ColumnEncoding.BINARY.getName());
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,accumuloSerDeParams.getRowIdFactory());
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(Arrays.asList("row","cq1","cq2"),Arrays.asList(stringTypeInfo,stringTypeInfo,stringTypeInfo),serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row value1 value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,new Authorizations()).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings({"rawtypes","unchecked"}) @Test public void testSaslConfiguration() throws IOException, AccumuloException, AccumuloSecurityException {
  final HiveAccumuloTableOutputFormat outputFormat=Mockito.mock(HiveAccumuloTableOutputFormat.class);
  final AuthenticationToken authToken=Mockito.mock(AuthenticationToken.class);
  final Token hadoopToken=Mockito.mock(Token.class);
  final HiveAccumuloHelper helper=Mockito.mock(HiveAccumuloHelper.class);
  final AccumuloConnectionParameters cnxnParams=Mockito.mock(AccumuloConnectionParameters.class);
  final Connector connector=Mockito.mock(Connector.class);
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation user1=UserGroupInformation.createUserForTesting(user,new String[0]);
  Mockito.when(outputFormat.getCurrentUser()).thenReturn(user1);
  conf.unset(AccumuloConnectionParameters.USER_PASS);
  Mockito.doCallRealMethod().when(outputFormat).configureAccumuloOutputFormat(conf);
  Mockito.when(outputFormat.getHelper()).thenReturn(helper);
  Mockito.when(outputFormat.getConnectionParams(conf)).thenReturn(cnxnParams);
  Mockito.when(cnxnParams.getConnector()).thenReturn(connector);
  Mockito.when(helper.getDelegationToken(connector)).thenReturn(authToken);
  Mockito.when(helper.getHadoopToken(authToken)).thenReturn(hadoopToken);
  Mockito.when(cnxnParams.useSasl()).thenReturn(true);
  Mockito.when(cnxnParams.getAccumuloUserName()).thenReturn(user);
  Mockito.when(cnxnParams.getAccumuloInstanceName()).thenReturn(instanceName);
  Mockito.when(cnxnParams.getZooKeepers()).thenReturn(zookeepers);
  Mockito.when(outputFormat.hasKerberosCredentials(user1)).thenReturn(true);
  outputFormat.configureAccumuloOutputFormat(conf);
  Mockito.verify(outputFormat).setZooKeeperInstanceWithErrorChecking(conf,instanceName,zookeepers,true);
  Mockito.verify(outputFormat).setConnectorInfoWithErrorChecking(conf,user,authToken);
  Mockito.verify(outputFormat).setDefaultAccumuloTableName(conf,outputTable);
  Mockito.verify(helper).mergeTokenIntoJobConf(conf,hadoopToken);
  Collection<Token<? extends TokenIdentifier>> tokens=user1.getTokens();
  Assert.assertEquals(1,tokens.size());
  Assert.assertEquals(hadoopToken,tokens.iterator().next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteToMockInstance() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1","col2");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq1,cf:cq2");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,accumuloSerDeParams.getRowIdFactory());
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(Arrays.asList("row","cq1","cq2"),Arrays.asList(stringTypeInfo,stringTypeInfo,stringTypeInfo),serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row value1 value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,new Authorizations()).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals("",k.getColumnVisibility().toString());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteToMockInstanceWithVisibility() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  Authorizations auths=new Authorizations("foo");
  conn.securityOperations().changeUserAuthorizations("root",auths);
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1","col2");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq1,cf:cq2");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility("foo"),accumuloSerDeParams.getRowIdFactory());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(Arrays.asList("row","cq1","cq2"),Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo),serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row value1 value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,auths).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals("foo",k.getColumnVisibility().toString());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals("foo",k.getColumnVisibility().toString());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteMap() throws Exception {
  Instance inst=new MockInstance(test.getMethodName());
  Connector conn=inst.getConnector("root",new PasswordToken(""));
  HiveAccumuloTableOutputFormat outputFormat=new HiveAccumuloTableOutputFormat();
  String table=test.getMethodName();
  conn.tableOperations().create(table);
  JobConf conf=new JobConf();
  conf.set(AccumuloConnectionParameters.INSTANCE_NAME,inst.getInstanceName());
  conf.set(AccumuloConnectionParameters.USER_NAME,"root");
  conf.set(AccumuloConnectionParameters.USER_PASS,"");
  conf.setBoolean(AccumuloConnectionParameters.USE_MOCK_INSTANCE,true);
  conf.set(AccumuloConnectionParameters.TABLE_NAME,test.getMethodName());
  FileSystem local=FileSystem.getLocal(conf);
  outputFormat.checkOutputSpecs(local,conf);
  RecordWriter<Text,Mutation> recordWriter=outputFormat.getRecordWriter(local,conf,null,null);
  List<String> names=Arrays.asList("row","col1");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:*");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(names));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,accumuloSerDeParams.getRowIdFactory());
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazyStringObjectInspector stringOI=(LazyStringObjectInspector)LazyFactory.createLazyObjectInspector(stringTypeInfo,new byte[]{0},0,serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyMapObjectInspector mapOI=LazyObjectInspectorFactory.getLazySimpleMapObjectInspector(stringOI,stringOI,(byte)',',(byte)':',serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(Arrays.asList("row","data"),Arrays.asList(stringOI,mapOI),(byte)' ',serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyStruct struct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef bytes=new ByteArrayRef();
  bytes.setData("row cq1:value1,cq2:value2".getBytes());
  struct.init(bytes,0,bytes.getData().length);
  Mutation m=serializer.serialize(struct,structOI);
  recordWriter.write(new Text(table),m);
  recordWriter.close(null);
  Iterator<Entry<Key,Value>> iter=conn.createScanner(table,new Authorizations()).iterator();
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Key k=entry.getKey();
  Value v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq1",k.getColumnQualifier().toString());
  Assert.assertEquals(AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,k.getColumnVisibilityParsed());
  Assert.assertEquals("value1",new String(v.get()));
  Assert.assertTrue("Iterator did not have an element as expected",iter.hasNext());
  entry=iter.next();
  k=entry.getKey();
  v=entry.getValue();
  Assert.assertEquals("row",k.getRow().toString());
  Assert.assertEquals("cf",k.getColumnFamily().toString());
  Assert.assertEquals("cq2",k.getColumnQualifier().toString());
  Assert.assertEquals(AccumuloSerDeParameters.DEFAULT_VISIBILITY_LABEL,k.getColumnVisibilityParsed());
  Assert.assertEquals("value2",new String(v.get()));
  Assert.assertFalse("Iterator unexpectedly had more data",iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.mr.TestHiveAccumuloTypes </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUtf8Types() throws Exception {
  final String tableName=test.getMethodName(), user="root", pass="";
  MockInstance mockInstance=new MockInstance(test.getMethodName());
  Connector conn=mockInstance.getConnector(user,new PasswordToken(pass));
  HiveAccumuloTableInputFormat inputformat=new HiveAccumuloTableInputFormat();
  JobConf conf=new JobConf();
  conf.set(AccumuloSerDeParameters.TABLE_NAME,tableName);
  conf.set(AccumuloSerDeParameters.USE_MOCK_INSTANCE,"true");
  conf.set(AccumuloSerDeParameters.INSTANCE_NAME,test.getMethodName());
  conf.set(AccumuloSerDeParameters.USER_NAME,user);
  conf.set(AccumuloSerDeParameters.USER_PASS,pass);
  conf.set(AccumuloSerDeParameters.ZOOKEEPERS,"localhost:2181");
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,AccumuloHiveConstants.ROWID + ",cf:string,cf:boolean,cf:tinyint,cf:smallint,cf:int,cf:bigint" + ",cf:float,cf:double,cf:decimal,cf:date,cf:timestamp,cf:char,cf:varchar");
  conf.set(serdeConstants.LIST_COLUMNS,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conn.tableOperations().create(tableName);
  BatchWriterConfig writerConf=new BatchWriterConfig();
  BatchWriter writer=conn.createBatchWriter(tableName,writerConf);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  String cf="cf";
  byte[] cfBytes=cf.getBytes();
  ByteArrayRef byteRef=new ByteArrayRef();
  Mutation m=new Mutation("row1");
  String stringValue="string";
  baos.reset();
  JavaStringObjectInspector stringOI=(JavaStringObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,stringOI.create(stringValue),stringOI,false,(byte)0,null);
  m.put(cfBytes,"string".getBytes(),baos.toByteArray());
  boolean booleanValue=true;
  baos.reset();
  JavaBooleanObjectInspector booleanOI=(JavaBooleanObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,booleanOI.create(booleanValue),booleanOI,false,(byte)0,null);
  m.put(cfBytes,"boolean".getBytes(),baos.toByteArray());
  byte tinyintValue=-127;
  baos.reset();
  JavaByteObjectInspector byteOI=(JavaByteObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,tinyintValue,byteOI,false,(byte)0,null);
  m.put(cfBytes,"tinyint".getBytes(),baos.toByteArray());
  short smallintValue=Short.MAX_VALUE;
  baos.reset();
  JavaShortObjectInspector shortOI=(JavaShortObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,smallintValue,shortOI,false,(byte)0,null);
  m.put(cfBytes,"smallint".getBytes(),baos.toByteArray());
  int intValue=Integer.MAX_VALUE;
  baos.reset();
  JavaIntObjectInspector intOI=(JavaIntObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,intValue,intOI,false,(byte)0,null);
  m.put(cfBytes,"int".getBytes(),baos.toByteArray());
  long bigintValue=Long.MAX_VALUE;
  baos.reset();
  JavaLongObjectInspector longOI=(JavaLongObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,bigintValue,longOI,false,(byte)0,null);
  m.put(cfBytes,"bigint".getBytes(),baos.toByteArray());
  float floatValue=Float.MAX_VALUE;
  baos.reset();
  JavaFloatObjectInspector floatOI=(JavaFloatObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,floatValue,floatOI,false,(byte)0,null);
  m.put(cfBytes,"float".getBytes(),baos.toByteArray());
  double doubleValue=Double.MAX_VALUE;
  baos.reset();
  JavaDoubleObjectInspector doubleOI=(JavaDoubleObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,doubleValue,doubleOI,false,(byte)0,null);
  m.put(cfBytes,"double".getBytes(),baos.toByteArray());
  HiveDecimal decimalValue=HiveDecimal.create("1.23");
  baos.reset();
  JavaHiveDecimalObjectInspector decimalOI=(JavaHiveDecimalObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new DecimalTypeInfo(5,2));
  LazyUtils.writePrimitiveUTF8(baos,decimalOI.create(decimalValue),decimalOI,false,(byte)0,null);
  m.put(cfBytes,"decimal".getBytes(),baos.toByteArray());
  Date now=new Date(System.currentTimeMillis());
  DateWritable dateWritable=new DateWritable(now);
  Date dateValue=dateWritable.get();
  baos.reset();
  JavaDateObjectInspector dateOI=(JavaDateObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DATE_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,dateOI.create(dateValue),dateOI,false,(byte)0,null);
  m.put(cfBytes,"date".getBytes(),baos.toByteArray());
  Timestamp timestampValue=new Timestamp(now.getTime());
  baos.reset();
  JavaTimestampObjectInspector timestampOI=(JavaTimestampObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TIMESTAMP_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,timestampOI.create(timestampValue),timestampOI,false,(byte)0,null);
  m.put(cfBytes,"timestamp".getBytes(),baos.toByteArray());
  baos.reset();
  HiveChar charValue=new HiveChar("char",4);
  JavaHiveCharObjectInspector charOI=(JavaHiveCharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new CharTypeInfo(4));
  LazyUtils.writePrimitiveUTF8(baos,charOI.create(charValue),charOI,false,(byte)0,null);
  m.put(cfBytes,"char".getBytes(),baos.toByteArray());
  baos.reset();
  HiveVarchar varcharValue=new HiveVarchar("varchar",7);
  JavaHiveVarcharObjectInspector varcharOI=(JavaHiveVarcharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new VarcharTypeInfo(7));
  LazyUtils.writePrimitiveUTF8(baos,varcharOI.create(varcharValue),varcharOI,false,(byte)0,null);
  m.put(cfBytes,"varchar".getBytes(),baos.toByteArray());
  writer.addMutation(m);
  writer.close();
  for (  Entry<Key,Value> e : conn.createScanner(tableName,new Authorizations())) {
    System.out.println(e);
  }
  FileInputFormat.addInputPath(conf,new Path("unused"));
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text key=reader.createKey();
  AccumuloHiveRow value=reader.createValue();
  reader.next(key,value);
  Assert.assertEquals(13,value.getTuples().size());
  Text cfText=new Text(cf), cqHolder=new Text();
  cqHolder.set("string");
  byte[] valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyStringObjectInspector lazyStringOI=LazyPrimitiveObjectInspectorFactory.getLazyStringObjectInspector(false,(byte)0);
  LazyString lazyString=(LazyString)LazyFactory.createLazyObject(lazyStringOI);
  lazyString.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(new Text(stringValue),lazyString.getWritableObject());
  cqHolder.set("boolean");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyBooleanObjectInspector lazyBooleanOI=(LazyBooleanObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyBoolean lazyBoolean=(LazyBoolean)LazyFactory.createLazyObject(lazyBooleanOI);
  lazyBoolean.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(booleanValue,lazyBoolean.getWritableObject().get());
  cqHolder.set("tinyint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyByteObjectInspector lazyByteOI=(LazyByteObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyByte lazyByte=(LazyByte)LazyFactory.createLazyObject(lazyByteOI);
  lazyByte.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(tinyintValue,lazyByte.getWritableObject().get());
  cqHolder.set("smallint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyShortObjectInspector lazyShortOI=(LazyShortObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyShort lazyShort=(LazyShort)LazyFactory.createLazyObject(lazyShortOI);
  lazyShort.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(smallintValue,lazyShort.getWritableObject().get());
  cqHolder.set("int");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyIntObjectInspector lazyIntOI=(LazyIntObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyInteger lazyInt=(LazyInteger)LazyFactory.createLazyObject(lazyIntOI);
  lazyInt.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(intValue,lazyInt.getWritableObject().get());
  cqHolder.set("bigint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyLongObjectInspector lazyLongOI=(LazyLongObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyLong lazyLong=(LazyLong)LazyFactory.createLazyObject(lazyLongOI);
  lazyLong.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(bigintValue,lazyLong.getWritableObject().get());
  cqHolder.set("float");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyFloatObjectInspector lazyFloatOI=(LazyFloatObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyFloat lazyFloat=(LazyFloat)LazyFactory.createLazyObject(lazyFloatOI);
  lazyFloat.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(floatValue,lazyFloat.getWritableObject().get(),0);
  cqHolder.set("double");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyDoubleObjectInspector lazyDoubleOI=(LazyDoubleObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyDouble lazyDouble=(LazyDouble)LazyFactory.createLazyObject(lazyDoubleOI);
  lazyDouble.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(doubleValue,lazyDouble.getWritableObject().get(),0);
  cqHolder.set("decimal");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveDecimalObjectInspector lazyDecimalOI=(LazyHiveDecimalObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new DecimalTypeInfo(5,2));
  LazyHiveDecimal lazyDecimal=(LazyHiveDecimal)LazyFactory.createLazyObject(lazyDecimalOI);
  lazyDecimal.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(decimalValue,lazyDecimal.getWritableObject().getHiveDecimal());
  cqHolder.set("date");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyDateObjectInspector lazyDateOI=(LazyDateObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DATE_TYPE_NAME));
  LazyDate lazyDate=(LazyDate)LazyFactory.createLazyObject(lazyDateOI);
  lazyDate.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(dateValue,lazyDate.getWritableObject().get());
  cqHolder.set("timestamp");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyTimestampObjectInspector lazyTimestampOI=(LazyTimestampObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TIMESTAMP_TYPE_NAME));
  LazyTimestamp lazyTimestamp=(LazyTimestamp)LazyFactory.createLazyObject(lazyTimestampOI);
  lazyTimestamp.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(timestampValue,lazyTimestamp.getWritableObject().getTimestamp());
  cqHolder.set("char");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveCharObjectInspector lazyCharOI=(LazyHiveCharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new CharTypeInfo(4));
  LazyHiveChar lazyChar=(LazyHiveChar)LazyFactory.createLazyObject(lazyCharOI);
  lazyChar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(charValue,lazyChar.getWritableObject().getHiveChar());
  cqHolder.set("varchar");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveVarcharObjectInspector lazyVarcharOI=(LazyHiveVarcharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new VarcharTypeInfo(7));
  LazyHiveVarchar lazyVarchar=(LazyHiveVarchar)LazyFactory.createLazyObject(lazyVarcharOI);
  lazyVarchar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(varcharValue.toString(),lazyVarchar.getWritableObject().getHiveVarchar().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinaryTypes() throws Exception {
  final String tableName=test.getMethodName(), user="root", pass="";
  MockInstance mockInstance=new MockInstance(test.getMethodName());
  Connector conn=mockInstance.getConnector(user,new PasswordToken(pass));
  HiveAccumuloTableInputFormat inputformat=new HiveAccumuloTableInputFormat();
  JobConf conf=new JobConf();
  conf.set(AccumuloSerDeParameters.TABLE_NAME,tableName);
  conf.set(AccumuloSerDeParameters.USE_MOCK_INSTANCE,"true");
  conf.set(AccumuloSerDeParameters.INSTANCE_NAME,test.getMethodName());
  conf.set(AccumuloSerDeParameters.USER_NAME,user);
  conf.set(AccumuloSerDeParameters.USER_PASS,pass);
  conf.set(AccumuloSerDeParameters.ZOOKEEPERS,"localhost:2181");
  conf.set(AccumuloSerDeParameters.COLUMN_MAPPINGS,AccumuloHiveConstants.ROWID + ",cf:string,cf:boolean,cf:tinyint,cf:smallint,cf:int,cf:bigint" + ",cf:float,cf:double,cf:decimal,cf:date,cf:timestamp,cf:char,cf:varchar");
  conf.set(serdeConstants.LIST_COLUMNS,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conf.set(serdeConstants.LIST_COLUMN_TYPES,"string,string,boolean,tinyint,smallint,int,bigint,float,double,decimal,date,timestamp,char(4),varchar(7)");
  conf.set(AccumuloSerDeParameters.DEFAULT_STORAGE_TYPE,"binary");
  conn.tableOperations().create(tableName);
  BatchWriterConfig writerConf=new BatchWriterConfig();
  BatchWriter writer=conn.createBatchWriter(tableName,writerConf);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  String cf="cf";
  byte[] cfBytes=cf.getBytes();
  Mutation m=new Mutation("row1");
  String stringValue="string";
  JavaStringObjectInspector stringOI=(JavaStringObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME));
  LazyUtils.writePrimitiveUTF8(baos,stringOI.create(stringValue),stringOI,false,(byte)0,null);
  m.put(cfBytes,"string".getBytes(),baos.toByteArray());
  boolean booleanValue=true;
  baos.reset();
  JavaBooleanObjectInspector booleanOI=(JavaBooleanObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyUtils.writePrimitive(baos,booleanOI.create(booleanValue),booleanOI);
  m.put(cfBytes,"boolean".getBytes(),baos.toByteArray());
  byte tinyintValue=-127;
  baos.reset();
  JavaByteObjectInspector byteOI=(JavaByteObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,tinyintValue,byteOI);
  m.put(cfBytes,"tinyint".getBytes(),baos.toByteArray());
  short smallintValue=Short.MAX_VALUE;
  baos.reset();
  JavaShortObjectInspector shortOI=(JavaShortObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,smallintValue,shortOI);
  m.put(cfBytes,"smallint".getBytes(),baos.toByteArray());
  int intValue=Integer.MAX_VALUE;
  baos.reset();
  JavaIntObjectInspector intOI=(JavaIntObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,intValue,intOI);
  m.put(cfBytes,"int".getBytes(),baos.toByteArray());
  long bigintValue=Long.MAX_VALUE;
  baos.reset();
  JavaLongObjectInspector longOI=(JavaLongObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,bigintValue,longOI);
  m.put(cfBytes,"bigint".getBytes(),baos.toByteArray());
  float floatValue=Float.MAX_VALUE;
  baos.reset();
  JavaFloatObjectInspector floatOI=(JavaFloatObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyUtils.writePrimitive(baos,floatValue,floatOI);
  m.put(cfBytes,"float".getBytes(),baos.toByteArray());
  double doubleValue=Double.MAX_VALUE;
  baos.reset();
  JavaDoubleObjectInspector doubleOI=(JavaDoubleObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyUtils.writePrimitive(baos,doubleValue,doubleOI);
  m.put(cfBytes,"double".getBytes(),baos.toByteArray());
  baos.reset();
  HiveDecimal decimalValue=HiveDecimal.create(65536l);
  HiveDecimalWritable decimalWritable=new HiveDecimalWritable(decimalValue);
  decimalWritable.write(out);
  m.put(cfBytes,"decimal".getBytes(),baos.toByteArray());
  baos.reset();
  Date now=new Date(System.currentTimeMillis());
  DateWritable dateWritable=new DateWritable(now);
  Date dateValue=dateWritable.get();
  dateWritable.write(out);
  m.put(cfBytes,"date".getBytes(),baos.toByteArray());
  baos.reset();
  Timestamp timestampValue=new Timestamp(now.getTime());
  ByteStream.Output output=new ByteStream.Output();
  TimestampWritable timestampWritable=new TimestampWritable(new Timestamp(now.getTime()));
  timestampWritable.write(output);
  output.close();
  m.put(cfBytes,"timestamp".getBytes(),output.toByteArray());
  baos.reset();
  HiveChar charValue=new HiveChar("char",4);
  JavaHiveCharObjectInspector charOI=(JavaHiveCharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new CharTypeInfo(4));
  LazyUtils.writePrimitiveUTF8(baos,charOI.create(charValue),charOI,false,(byte)0,null);
  m.put(cfBytes,"char".getBytes(),baos.toByteArray());
  baos.reset();
  HiveVarchar varcharValue=new HiveVarchar("varchar",7);
  JavaHiveVarcharObjectInspector varcharOI=(JavaHiveVarcharObjectInspector)PrimitiveObjectInspectorFactory.getPrimitiveJavaObjectInspector(new VarcharTypeInfo(7));
  LazyUtils.writePrimitiveUTF8(baos,varcharOI.create(varcharValue),varcharOI,false,(byte)0,null);
  m.put(cfBytes,"varchar".getBytes(),baos.toByteArray());
  writer.addMutation(m);
  writer.close();
  for (  Entry<Key,Value> e : conn.createScanner(tableName,new Authorizations())) {
    System.out.println(e);
  }
  FileInputFormat.addInputPath(conf,new Path("unused"));
  InputSplit[] splits=inputformat.getSplits(conf,0);
  assertEquals(splits.length,1);
  RecordReader<Text,AccumuloHiveRow> reader=inputformat.getRecordReader(splits[0],conf,null);
  Text key=reader.createKey();
  AccumuloHiveRow value=reader.createValue();
  reader.next(key,value);
  Assert.assertEquals(13,value.getTuples().size());
  ByteArrayRef byteRef=new ByteArrayRef();
  Text cfText=new Text(cf), cqHolder=new Text();
  cqHolder.set("string");
  byte[] valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyStringObjectInspector lazyStringOI=LazyPrimitiveObjectInspectorFactory.getLazyStringObjectInspector(false,(byte)0);
  LazyString lazyString=(LazyString)LazyFactory.createLazyObject(lazyStringOI);
  lazyString.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(stringValue,lazyString.getWritableObject().toString());
  cqHolder.set("boolean");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyBooleanObjectInspector lazyBooleanOI=(LazyBooleanObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BOOLEAN_TYPE_NAME));
  LazyBoolean lazyBoolean=(LazyBoolean)LazyFactory.createLazyPrimitiveBinaryClass(lazyBooleanOI);
  lazyBoolean.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(booleanValue,lazyBoolean.getWritableObject().get());
  cqHolder.set("tinyint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyByteObjectInspector lazyByteOI=(LazyByteObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.TINYINT_TYPE_NAME));
  LazyByte lazyByte=(LazyByte)LazyFactory.createLazyPrimitiveBinaryClass(lazyByteOI);
  lazyByte.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(tinyintValue,lazyByte.getWritableObject().get());
  cqHolder.set("smallint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyShortObjectInspector lazyShortOI=(LazyShortObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.SMALLINT_TYPE_NAME));
  LazyShort lazyShort=(LazyShort)LazyFactory.createLazyPrimitiveBinaryClass(lazyShortOI);
  lazyShort.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(smallintValue,lazyShort.getWritableObject().get());
  cqHolder.set("int");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyIntObjectInspector lazyIntOI=(LazyIntObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.INT_TYPE_NAME));
  LazyInteger lazyInt=(LazyInteger)LazyFactory.createLazyPrimitiveBinaryClass(lazyIntOI);
  lazyInt.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(intValue,lazyInt.getWritableObject().get());
  cqHolder.set("bigint");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyLongObjectInspector lazyLongOI=(LazyLongObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.BIGINT_TYPE_NAME));
  LazyLong lazyLong=(LazyLong)LazyFactory.createLazyPrimitiveBinaryClass(lazyLongOI);
  lazyLong.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(bigintValue,lazyLong.getWritableObject().get());
  cqHolder.set("float");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyFloatObjectInspector lazyFloatOI=(LazyFloatObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.FLOAT_TYPE_NAME));
  LazyFloat lazyFloat=(LazyFloat)LazyFactory.createLazyPrimitiveBinaryClass(lazyFloatOI);
  lazyFloat.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(floatValue,lazyFloat.getWritableObject().get(),0);
  cqHolder.set("double");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyDoubleObjectInspector lazyDoubleOI=(LazyDoubleObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.DOUBLE_TYPE_NAME));
  LazyDouble lazyDouble=(LazyDouble)LazyFactory.createLazyPrimitiveBinaryClass(lazyDoubleOI);
  lazyDouble.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(doubleValue,lazyDouble.getWritableObject().get(),0);
  cqHolder.set("decimal");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  ByteArrayInputStream bais=new ByteArrayInputStream(valueBytes);
  DataInputStream in=new DataInputStream(bais);
  decimalWritable.readFields(in);
  Assert.assertEquals(decimalValue,decimalWritable.getHiveDecimal());
  cqHolder.set("date");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  bais=new ByteArrayInputStream(valueBytes);
  in=new DataInputStream(bais);
  dateWritable.readFields(in);
  Assert.assertEquals(dateValue,dateWritable.get());
  cqHolder.set("timestamp");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  bais=new ByteArrayInputStream(valueBytes);
  in=new DataInputStream(bais);
  timestampWritable.readFields(in);
  Assert.assertEquals(timestampValue,timestampWritable.getTimestamp());
  cqHolder.set("char");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveCharObjectInspector lazyCharOI=(LazyHiveCharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new CharTypeInfo(4));
  LazyHiveChar lazyChar=(LazyHiveChar)LazyFactory.createLazyObject(lazyCharOI);
  lazyChar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(charValue,lazyChar.getWritableObject().getHiveChar());
  cqHolder.set("varchar");
  valueBytes=value.getValue(cfText,cqHolder);
  Assert.assertNotNull(valueBytes);
  byteRef.setData(valueBytes);
  LazyHiveVarcharObjectInspector lazyVarcharOI=(LazyHiveVarcharObjectInspector)LazyPrimitiveObjectInspectorFactory.getLazyObjectInspector(new VarcharTypeInfo(7));
  LazyHiveVarchar lazyVarchar=(LazyHiveVarchar)LazyFactory.createLazyObject(lazyVarcharOI);
  lazyVarchar.init(byteRef,0,valueBytes.length);
  Assert.assertEquals(varcharValue.toString(),lazyVarchar.getWritableObject().getHiveVarchar().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestAccumuloPredicateHandler </h4><pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rangeLessThan() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertFalse(range.contains(new Key(new Text("aaa"))));
  assertTrue(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aa"))));
  assertTrue(range.afterEndKey(new Key(new Text("aab"))));
  assertTrue(range.afterEndKey(new Key(new Text("aaa"))));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testRangeEqual() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqual(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertTrue(range.contains(new Key(new Text("aaa"))));
  assertTrue(range.afterEndKey(new Key(new Text("aab"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aa"))));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleRanges() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"bbb");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  String filterExpr=SerializationUtilities.serializeExpression(both);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(1,ranges.size());
  Range range=ranges.get(0);
  assertEquals(new Range(new Key("aaa"),true,new Key("bbb"),false),range);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPushdownTuple() throws SerDeException, NoSuchPrimitiveComparisonException, NoSuchCompareOpException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.intTypeInfo,"field1",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,5);
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqual(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  List<IndexSearchCondition> sConditions=handler.getSearchConditions(conf);
  assertEquals(sConditions.size(),1);
  IndexSearchCondition sc=sConditions.get(0);
  PushdownTuple tuple=new PushdownTuple(sConditions.get(0),handler.getPrimitiveComparison(sc.getColumnDesc().getTypeString(),sc),handler.getCompareOp(sc.getComparisonOp(),sc));
  byte[] expectedVal=new byte[4];
  ByteBuffer.wrap(expectedVal).putInt(5);
  assertArrayEquals(tuple.getConstVal(),expectedVal);
  assertEquals(tuple.getcOpt().getClass(),Equal.class);
  assertEquals(tuple.getpCompare().getClass(),IntCompare.class);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rangeLessThanOrEqual() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertTrue(range.contains(new Key(new Text("aaa"))));
  assertTrue(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aa"))));
  assertTrue(range.afterEndKey(new Key(new Text("aab"))));
  assertFalse(range.afterEndKey(new Key(new Text("aaa"))));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test() public void testRangeGreaterThan() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPGreaterThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertFalse(range.contains(new Key(new Text("aaa"))));
  assertFalse(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aab"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aa"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aaa"))));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rangeGreaterThanOrEqual() throws SerDeException {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"aaa");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  String filterExpr=SerializationUtilities.serializeExpression(node);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,filterExpr);
  Collection<Range> ranges=handler.getRanges(conf,columnMapper);
  assertEquals(ranges.size(),1);
  Range range=ranges.iterator().next();
  assertTrue(range.isStartKeyInclusive());
  assertFalse(range.isEndKeyInclusive());
  assertTrue(range.contains(new Key(new Text("aaa"))));
  assertFalse(range.afterEndKey(new Key(new Text("ccccc"))));
  assertTrue(range.contains(new Key(new Text("aab"))));
  assertTrue(range.beforeStartKey(new Key(new Text("aa"))));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestAccumuloRangeGenerator </h4><pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeConjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"m");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("f"),true,new Key("m\0"),false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDateRangeConjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.dateTypeInfo,Date.valueOf("2014-01-01"));
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.dateTypeInfo,Date.valueOf("2014-07-01"));
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("2014-01-01"),true,new Key("2014-07-01"),false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCastExpression() throws Exception {
  ExprNodeDesc fourty=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,40), fifty=new ExprNodeConstantDesc(TypeInfoFactory.intTypeInfo,50);
  GenericUDFOPPlus plus=new GenericUDFOPPlus();
  ExprNodeGenericFuncDesc addition=new ExprNodeGenericFuncDesc(TypeInfoFactory.intTypeInfo,plus,Arrays.asList(fourty,fifty));
  UDFToString stringCast=new UDFToString();
  GenericUDFBridge stringCastBridge=new GenericUDFBridge("cast",false,stringCast.getClass().getName());
  ExprNodeGenericFuncDesc cast=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,stringCastBridge,"cast",Collections.<ExprNodeDesc>singletonList(addition));
  ExprNodeDesc key=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"key",null,false);
  ExprNodeGenericFuncDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),Arrays.asList(key,cast));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"key");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(node);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(node);
  Assert.assertNull(result);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialRangeConjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"anythingElse",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"foo");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("f"),true,null,false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeConjunctionWithDisjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"h");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"d");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  ExprNodeDesc column3=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant3=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"q");
  List<ExprNodeDesc> children3=Lists.newArrayList();
  children3.add(column3);
  children3.add(constant3);
  ExprNodeDesc node3=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children3);
  assertNotNull(node3);
  List<ExprNodeDesc> orFilters=Lists.newArrayList();
  orFilters.add(node2);
  orFilters.add(node3);
  ExprNodeGenericFuncDesc orNode=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPOr(),orFilters);
  List<ExprNodeDesc> andFilters=Lists.newArrayList();
  andFilters.add(node);
  andFilters.add(orNode);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),andFilters);
  List<Range> expectedRanges=Arrays.asList(new Range(new Key("q"),true,null,false));
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testRangeOverNonRowIdField() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"foo",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"foo",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"m");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPAnd(),bothFilters);
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNull(result);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRangeDisjunction() throws Exception {
  ExprNodeDesc column=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"f");
  List<ExprNodeDesc> children=Lists.newArrayList();
  children.add(column);
  children.add(constant);
  ExprNodeDesc node=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrGreaterThan(),children);
  assertNotNull(node);
  ExprNodeDesc column2=new ExprNodeColumnDesc(TypeInfoFactory.stringTypeInfo,"rid",null,false);
  ExprNodeDesc constant2=new ExprNodeConstantDesc(TypeInfoFactory.stringTypeInfo,"m");
  List<ExprNodeDesc> children2=Lists.newArrayList();
  children2.add(column2);
  children2.add(constant2);
  ExprNodeDesc node2=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPEqualOrLessThan(),children2);
  assertNotNull(node2);
  List<ExprNodeDesc> bothFilters=Lists.newArrayList();
  bothFilters.add(node);
  bothFilters.add(node2);
  ExprNodeGenericFuncDesc both=new ExprNodeGenericFuncDesc(TypeInfoFactory.stringTypeInfo,new GenericUDFOPOr(),bothFilters);
  List<Range> expectedRanges=Arrays.asList(new Range());
  AccumuloRangeGenerator rangeGenerator=new AccumuloRangeGenerator(handler,rowIdMapping,"rid");
  Dispatcher disp=new DefaultRuleDispatcher(rangeGenerator,Collections.<Rule,NodeProcessor>emptyMap(),null);
  GraphWalker ogw=new DefaultGraphWalker(disp);
  ArrayList<Node> topNodes=new ArrayList<Node>();
  topNodes.add(both);
  HashMap<Node,Object> nodeOutput=new HashMap<Node,Object>();
  try {
    ogw.startWalking(topNodes,nodeOutput);
  }
 catch (  SemanticException ex) {
    throw new RuntimeException(ex);
  }
  Object result=nodeOutput.get(both);
  Assert.assertNotNull(result);
  Assert.assertTrue("Result from graph walk was not a List",result instanceof List);
  @SuppressWarnings("unchecked") List<Range> actualRanges=(List<Range>)result;
  Assert.assertEquals(expectedRanges,actualRanges);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.predicate.TestPrimitiveComparisonFilter </h4><pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBase64ConstantEncode(){
  PrimitiveComparisonFilter filter=new PrimitiveComparisonFilter();
  Map<String,String> options=new HashMap<String,String>();
  for (int i=0; i < 500; i++) {
    String constant=Integer.toString(i);
    options.put(PrimitiveComparisonFilter.CONST_VAL,new String(Base64.encodeBase64(constant.getBytes())));
    Assert.assertEquals(constant,new String(filter.getConstant(options)));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestAccumuloRowSerializer </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBinarySerialization() throws IOException, SerDeException {
  List<String> columns=Arrays.asList("row","cq1","cq2","cq3");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  List<String> typeNames=new ArrayList<String>(types.size());
  for (  TypeInfo type : types) {
    typeNames.add(type.getTypeName());
  }
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,cf:cq1#b,cf:cq2#b,cf:cq3");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(typeNames));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  LazySimpleStructObjectInspector oi=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(columns,types,serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility(),accumuloSerDeParams.getRowIdFactory());
  LazyStruct obj=(LazyStruct)LazyFactory.createLazyObject(oi);
  ByteArrayRef byteRef=new ByteArrayRef();
  byteRef.setData(new byte[]{'r','o','w','1',' ','1','0',' ','2','0',' ','v','a','l','u','e'});
  obj.init(byteRef,0,byteRef.getData().length);
  Mutation m=(Mutation)serializer.serialize(obj,oi);
  Assert.assertArrayEquals("row1".getBytes(),m.getRow());
  List<ColumnUpdate> updates=m.getUpdates();
  Assert.assertEquals(3,updates.size());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  ColumnUpdate update=updates.get(0);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq1",new String(update.getColumnQualifier()));
  out.writeInt(10);
  Assert.assertArrayEquals(baos.toByteArray(),update.getValue());
  update=updates.get(1);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq2",new String(update.getColumnQualifier()));
  baos.reset();
  out.writeInt(20);
  Assert.assertArrayEquals(baos.toByteArray(),update.getValue());
  update=updates.get(2);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq3",new String(update.getColumnQualifier()));
  Assert.assertEquals("value",new String(update.getValue()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVisibilityLabel() throws IOException, SerDeException {
  List<String> columns=Arrays.asList("row","cq1","cq2","cq3");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.intTypeInfo,TypeInfoFactory.stringTypeInfo);
  List<String> typeNames=new ArrayList<String>(types.size());
  for (  TypeInfo type : types) {
    typeNames.add(type.getTypeName());
  }
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,cf:cq1#b,cf:cq2#b,cf:cq3");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(typeNames));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  LazySimpleStructObjectInspector oi=(LazySimpleStructObjectInspector)LazyFactory.createLazyStructInspector(columns,types,serDeParams.getSeparators(),serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility("foo"),accumuloSerDeParams.getRowIdFactory());
  LazyStruct obj=(LazyStruct)LazyFactory.createLazyObject(oi);
  ByteArrayRef byteRef=new ByteArrayRef();
  byteRef.setData(new byte[]{'r','o','w','1',' ','1','0',' ','2','0',' ','v','a','l','u','e'});
  obj.init(byteRef,0,byteRef.getData().length);
  Mutation m=(Mutation)serializer.serialize(obj,oi);
  Assert.assertArrayEquals("row1".getBytes(),m.getRow());
  List<ColumnUpdate> updates=m.getUpdates();
  Assert.assertEquals(3,updates.size());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  ColumnUpdate update=updates.get(0);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq1",new String(update.getColumnQualifier()));
  Assert.assertEquals("foo",new String(update.getColumnVisibility()));
  out.writeInt(10);
  Assert.assertArrayEquals(baos.toByteArray(),update.getValue());
  update=updates.get(1);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq2",new String(update.getColumnQualifier()));
  Assert.assertEquals("foo",new String(update.getColumnVisibility()));
  baos.reset();
  out.writeInt(20);
  Assert.assertArrayEquals(baos.toByteArray(),update.getValue());
  update=updates.get(2);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq3",new String(update.getColumnQualifier()));
  Assert.assertEquals("foo",new String(update.getColumnVisibility()));
  Assert.assertEquals("value",new String(update.getValue()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapSerialization() throws IOException, SerDeException {
  List<String> columns=Arrays.asList("row","col");
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo));
  List<String> typeNames=new ArrayList<String>(types.size());
  for (  TypeInfo type : types) {
    typeNames.add(type.getTypeName());
  }
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,cf:*");
  tableProperties.setProperty(serdeConstants.FIELD_DELIM," ");
  tableProperties.setProperty(serdeConstants.COLLECTION_DELIM,",");
  tableProperties.setProperty(serdeConstants.MAPKEY_DELIM,":");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(typeNames));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazyStringObjectInspector stringOI=(LazyStringObjectInspector)LazyFactory.createLazyObjectInspector(stringTypeInfo,new byte[]{0},0,serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyMapObjectInspector mapOI=LazyObjectInspectorFactory.getLazySimpleMapObjectInspector(stringOI,stringOI,(byte)',',(byte)':',serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(columns,Arrays.asList(stringOI,mapOI),(byte)' ',serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility(),accumuloSerDeParams.getRowIdFactory());
  LazyStruct obj=(LazyStruct)LazyFactory.createLazyObject(structOI);
  ByteArrayRef byteRef=new ByteArrayRef();
  byteRef.setData("row1 cq1:10,cq2:20,cq3:value".getBytes());
  obj.init(byteRef,0,byteRef.getData().length);
  Mutation m=(Mutation)serializer.serialize(obj,structOI);
  Assert.assertArrayEquals("row1".getBytes(),m.getRow());
  List<ColumnUpdate> updates=m.getUpdates();
  Assert.assertEquals(3,updates.size());
  ColumnUpdate update=updates.get(0);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq1",new String(update.getColumnQualifier()));
  Assert.assertEquals("10",new String(update.getValue()));
  update=updates.get(1);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq2",new String(update.getColumnQualifier()));
  Assert.assertEquals("20",new String(update.getValue()));
  update=updates.get(2);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq3",new String(update.getColumnQualifier()));
  Assert.assertEquals("value",new String(update.getValue()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestAccumuloSerDe </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStructOfMapSerialization() throws IOException, SerDeException {
  List<String> columns=Arrays.asList("row","col");
  List<String> structColNames=Arrays.asList("map1","map2");
  TypeInfo mapTypeInfo=TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.getStructTypeInfo(structColNames,Arrays.asList(mapTypeInfo,mapTypeInfo)),TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,cf:cq");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  byte[] seps=serDeParams.getSeparators();
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazyStringObjectInspector stringOI=(LazyStringObjectInspector)LazyFactory.createLazyObjectInspector(stringTypeInfo,new byte[]{0},0,serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyMapObjectInspector mapOI=LazyObjectInspectorFactory.getLazySimpleMapObjectInspector(stringOI,stringOI,seps[3],seps[4],serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector rowStructOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(structColNames,Arrays.<ObjectInspector>asList(mapOI,mapOI),(byte)seps[2],serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(columns,Arrays.asList(rowStructOI,stringOI),seps[1],serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility(),accumuloSerDeParams.getRowIdFactory());
  Map<String,String> map1=new HashMap<String,String>(), map2=new HashMap<String,String>();
  map1.put("key10","value10");
  map1.put("key11","value11");
  map2.put("key20","value20");
  map2.put("key21","value21");
  ByteArrayRef byteRef=new ByteArrayRef();
  String accumuloRow="key10\5value10\4key11\5value11\3key20\5value20\4key21\5value21";
  LazyStruct entireStruct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  byteRef.setData((accumuloRow + "\2foo").getBytes());
  entireStruct.init(byteRef,0,byteRef.getData().length);
  Mutation m=serializer.serialize(entireStruct,structOI);
  Assert.assertArrayEquals(accumuloRow.getBytes(),m.getRow());
  Assert.assertEquals(1,m.getUpdates().size());
  ColumnUpdate update=m.getUpdates().get(0);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq",new String(update.getColumnQualifier()));
  Assert.assertEquals("foo",new String(update.getValue()));
  AccumuloHiveRow haRow=new AccumuloHiveRow(new String(m.getRow()));
  haRow.add("cf","cq","foo".getBytes());
  LazyAccumuloRow lazyAccumuloRow=new LazyAccumuloRow(structOI);
  lazyAccumuloRow.init(haRow,accumuloSerDeParams.getColumnMappings(),accumuloSerDeParams.getRowIdFactory());
  List objects=lazyAccumuloRow.getFieldsAsList();
  Assert.assertEquals(2,objects.size());
  Assert.assertEquals("foo",objects.get(1).toString());
  LazyStruct rowStruct=(LazyStruct)objects.get(0);
  List rowObjects=rowStruct.getFieldsAsList();
  Assert.assertEquals(2,rowObjects.size());
  LazyMap rowMap=(LazyMap)rowObjects.get(0);
  Map<?,?> actualMap=rowMap.getMap();
  System.out.println("Actual map 1: " + actualMap);
  Map<String,String> actualStringMap=new HashMap<String,String>();
  for (  Entry<?,?> entry : actualMap.entrySet()) {
    actualStringMap.put(entry.getKey().toString(),entry.getValue().toString());
  }
  Assert.assertEquals(map1,actualStringMap);
  rowMap=(LazyMap)rowObjects.get(1);
  actualMap=rowMap.getMap();
  System.out.println("Actual map 2: " + actualMap);
  actualStringMap=new HashMap<String,String>();
  for (  Entry<?,?> entry : actualMap.entrySet()) {
    actualStringMap.put(entry.getKey().toString(),entry.getValue().toString());
  }
  Assert.assertEquals(map2,actualStringMap);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapSerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,map<string,string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  properties.setProperty(serdeConstants.MAPKEY_DELIM,"=");
  char collectionSeparator=':', kvSeparator='=';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("k1" + kvSeparator + "v1"+ collectionSeparator+ "k2"+ kvSeparator+ "v2"+ collectionSeparator+ "k3"+ kvSeparator+ "v3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyMap);
  LazyMap map=(LazyMap)field1;
  Map<Object,Object> untypedMap=map.getMap();
  assertEquals(3,map.getMapSize());
  Set<String> expectedKeys=new HashSet<String>();
  expectedKeys.add("k1");
  expectedKeys.add("k2");
  expectedKeys.add("k3");
  for (  Entry<Object,Object> entry : untypedMap.entrySet()) {
    assertNotNull(entry.getKey());
    assertTrue(entry.getKey() instanceof LazyString);
    LazyString key=(LazyString)entry.getKey();
    assertNotNull(entry.getValue());
    assertTrue(entry.getValue() instanceof LazyString);
    LazyString value=(LazyString)entry.getValue();
    String strKey=key.getWritableObject().toString(), strValue=value.getWritableObject().toString();
    assertTrue(expectedKeys.remove(strKey));
    assertEquals(2,strValue.length());
    assertTrue(strValue.startsWith("v"));
    assertTrue(strValue.endsWith(Character.toString(strKey.charAt(1))));
  }
  assertTrue("Did not find expected keys: " + expectedKeys,expectedKeys.isEmpty());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArraySerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,array<string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  char separator=':';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("value1" + separator + "value2"+ separator+ "value3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyArray);
  LazyArray array=(LazyArray)field1;
  List values=array.getList();
  assertEquals(3,values.size());
  for (int i=0; i < 3; i++) {
    Object o=values.get(i);
    assertNotNull(o);
    assertTrue(o instanceof LazyString);
    assertEquals("value" + (i + 1),((LazyString)o).getWritableObject().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestAccumuloSerDeParameters </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseAuthorizationsFromConf() throws SerDeException {
  Configuration conf=new Configuration(false);
  conf.set(AccumuloSerDeParameters.AUTHORIZATIONS_KEY,"foo,bar");
  Authorizations auths=AccumuloSerDeParameters.getAuthorizationsFromConf(conf);
  Assert.assertEquals(new Authorizations("foo,bar"),auths);
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testNullAuthsFromConf() throws SerDeException {
  Configuration conf=new Configuration(false);
  Authorizations auths=AccumuloSerDeParameters.getAuthorizationsFromConf(conf);
  Assert.assertNull(auths);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestDefaultAccumuloRowIdFactory </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCorrectComplexInspectors() throws SerDeException {
  AccumuloSerDe accumuloSerDe=new AccumuloSerDe();
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:cq");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,col");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"struct<col1:int,col2:int>,map<string,string>");
  accumuloSerDe.initialize(conf,properties);
  AccumuloRowIdFactory factory=accumuloSerDe.getParams().getRowIdFactory();
  List<TypeInfo> columnTypes=accumuloSerDe.getParams().getHiveColumnTypes();
  ColumnMapper mapper=accumuloSerDe.getParams().getColumnMapper();
  LazySerDeParameters serDeParams=accumuloSerDe.getParams().getSerDeParameters();
  List<ObjectInspector> OIs=accumuloSerDe.getColumnObjectInspectors(columnTypes,serDeParams,mapper.getColumnMappings(),factory);
  Assert.assertEquals(2,OIs.size());
  Assert.assertEquals(LazySimpleStructObjectInspector.class,OIs.get(0).getClass());
  Assert.assertEquals(LazyMapObjectInspector.class,OIs.get(1).getClass());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)OIs.get(0);
  Assert.assertEquals(2,(int)structOI.getSeparator());
  LazyMapObjectInspector mapOI=(LazyMapObjectInspector)OIs.get(1);
  Assert.assertEquals(2,(int)mapOI.getItemSeparator());
  Assert.assertEquals(3,(int)mapOI.getKeyValueSeparator());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.cli.TestRCFileCat </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test parse file
 */
@Test public void testRCFileCat() throws Exception {
  File template=File.createTempFile("hive","tmpTest");
  Configuration configuration=new Configuration();
  byte[][] record_1={Bytes.toBytes("123"),Bytes.toBytes("456"),Bytes.toBytes("789"),Bytes.toBytes("1000"),Bytes.toBytes("5.3"),Bytes.toBytes("hive and hadoop"),new byte[0],Bytes.toBytes("NULL")};
  byte[][] record_2={Bytes.toBytes("100"),Bytes.toBytes("200"),Bytes.toBytes("123"),Bytes.toBytes("1000"),Bytes.toBytes("5.3"),Bytes.toBytes("hive and hadoop"),new byte[0],Bytes.toBytes("NULL")};
  byte[][] record_3={Bytes.toBytes("200"),Bytes.toBytes("400"),Bytes.toBytes("678"),Bytes.toBytes("1000"),Bytes.toBytes("4.8"),Bytes.toBytes("hive and hadoop"),new byte[0],Bytes.toBytes("TEST")};
  RCFileOutputFormat.setColumnNumber(configuration,8);
  Path file=new Path(template.getAbsolutePath());
  FileSystem fs=FileSystem.getLocal(configuration);
  RCFile.Writer writer=new RCFile.Writer(fs,configuration,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  write(writer,record_1);
  write(writer,record_2);
  write(writer,record_3);
  writer.close();
  RCFileCat fileCat=new RCFileCat();
  RCFileCat.test=true;
  fileCat.setConf(new Configuration());
  PrintStream oldOutPrintStream=System.out;
  PrintStream oldErrPrintStream=System.err;
  ByteArrayOutputStream dataOut=new ByteArrayOutputStream();
  ByteArrayOutputStream dataErr=new ByteArrayOutputStream();
  System.setOut(new PrintStream(dataOut));
  System.setErr(new PrintStream(dataErr));
  try {
    String[] params={"--verbose","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("123\t456\t789\t1000\t5.3\thive and hadoop\t\tNULL"));
    assertTrue(dataOut.toString().contains("100\t200\t123\t1000\t5.3\thive and hadoop\t\tNULL"));
    assertTrue(dataOut.toString().contains("200\t400\t678\t1000\t4.8\thive and hadoop\t\tTEST"));
    dataOut.reset();
    params=new String[]{"--start=-10","--file-sizes","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("File size (uncompressed): 105. File size (compressed): 134. Number of rows: 3."));
    dataOut.reset();
    params=new String[]{"--start=0","--column-sizes","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("0\t9\t17"));
    assertTrue(dataOut.toString().contains("1\t9\t17"));
    assertTrue(dataOut.toString().contains("2\t9\t17"));
    assertTrue(dataOut.toString().contains("3\t12\t14"));
    assertTrue(dataOut.toString().contains("4\t9\t17"));
    assertTrue(dataOut.toString().contains("5\t45\t26"));
    dataOut.reset();
    params=new String[]{"--start=0","--column-sizes-pretty","file://" + template.toURI().getPath()};
    assertEquals(0,fileCat.run(params));
    assertTrue(dataOut.toString().contains("Column 0: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 1: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 2: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 3: Uncompressed size: 12 Compressed size: 14"));
    assertTrue(dataOut.toString().contains("Column 4: Uncompressed size: 9 Compressed size: 17"));
    assertTrue(dataOut.toString().contains("Column 5: Uncompressed size: 45 Compressed size: 26"));
    params=new String[]{};
    assertEquals(-1,fileCat.run(params));
    assertTrue(dataErr.toString().contains("RCFileCat [--start=start_offet] [--length=len] [--verbose] " + "[--column-sizes | --column-sizes-pretty] [--file-sizes] fileName"));
    dataErr.reset();
    params=new String[]{"--fakeParameter","file://" + template.toURI().getPath()};
    assertEquals(-1,fileCat.run(params));
    assertTrue(dataErr.toString().contains("RCFileCat [--start=start_offet] [--length=len] [--verbose] " + "[--column-sizes | --column-sizes-pretty] [--file-sizes] fileName"));
  }
  finally {
    System.setOut(oldOutPrintStream);
    System.setErr(oldErrPrintStream);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.metrics.TestLegacyMetrics </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScopeConcurrency() throws Exception {
  metrics.startStoredScope(scopeName);
  LegacyMetrics.LegacyMetricsScope fooScope=(LegacyMetrics.LegacyMetricsScope)metrics.getStoredScope(scopeName);
  final int threads=10;
  ExecutorService executorService=Executors.newFixedThreadPool(threads);
  for (int i=0; i < threads; i++) {
    final int n=i;
    executorService.submit(new Callable<Void>(){
      @Override public Void call() throws Exception {
        testScopeImpl(n);
        return null;
      }
    }
);
  }
  executorService.shutdown();
  assertTrue(executorService.awaitTermination(periodMs * 3 * threads,TimeUnit.MILLISECONDS));
  fooScope=(LegacyMetrics.LegacyMetricsScope)metrics.getStoredScope(scopeName);
  assertEquals(Long.valueOf(3 * threads),fooScope.getNumCounter());
  assertTrue(fooScope.getTimeCounter().longValue() > 3 * periodMs * threads);
  Double avgT=(Double)metrics.get("foo.avg_t");
  assertTrue(avgT.doubleValue() > periodMs);
  metrics.endStoredScope(scopeName);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetricsMBean() throws Exception {
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  final ObjectName oname=new ObjectName("org.apache.hadoop.hive.common.metrics:type=MetricsMBean");
  MBeanInfo mBeanInfo=mbs.getMBeanInfo(oname);
  assertEquals(MetricsMBeanImpl.class.getName(),mBeanInfo.getClassName());
  MBeanOperationInfo[] oops=mBeanInfo.getOperations();
  boolean resetFound=false;
  for (  MBeanOperationInfo op : oops) {
    if ("reset".equals(op.getName())) {
      resetFound=true;
      break;
    }
  }
  assertTrue(resetFound);
  Attribute attr=new Attribute("fooMetric",Long.valueOf(-77));
  mbs.setAttribute(oname,attr);
  mBeanInfo=mbs.getMBeanInfo(oname);
  MBeanAttributeInfo[] attrinuteInfos=mBeanInfo.getAttributes();
  assertEquals(1,attrinuteInfos.length);
  boolean attrFound=false;
  for (  MBeanAttributeInfo info : attrinuteInfos) {
    if ("fooMetric".equals(info.getName())) {
      assertEquals("java.lang.Long",info.getType());
      assertTrue(info.isReadable());
      assertTrue(info.isWritable());
      assertFalse(info.isIs());
      attrFound=true;
      break;
    }
  }
  assertTrue(attrFound);
  Object v=mbs.getAttribute(oname,"fooMetric");
  assertEquals(Long.valueOf(-77),v);
  Object result=mbs.invoke(oname,"reset",new Object[0],new String[0]);
  assertNull(result);
  v=mbs.getAttribute(oname,"fooMetric");
  assertEquals(Long.valueOf(0),v);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.metrics.metrics2.TestCodahaleMetrics </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileReporting() throws Exception {
  int runs=5;
  for (int i=0; i < runs; i++) {
    MetricsFactory.getInstance().incrementCounter("count2");
    Thread.sleep(100);
  }
  Thread.sleep(2000);
  byte[] jsonData=Files.readAllBytes(Paths.get(jsonReportFile.getAbsolutePath()));
  ObjectMapper objectMapper=new ObjectMapper();
  JsonNode rootNode=objectMapper.readTree(jsonData);
  JsonNode countersNode=rootNode.path("counters");
  JsonNode methodCounterNode=countersNode.path("count2");
  JsonNode countNode=methodCounterNode.path("count");
  Assert.assertEquals(countNode.asInt(),5);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGauge() throws Exception {
  TestMetricsVariable testVar=new TestMetricsVariable();
  testVar.setValue(20);
  MetricsFactory.getInstance().addGauge("gauge1",testVar);
  Thread.sleep(2000);
  byte[] jsonData=Files.readAllBytes(Paths.get(jsonReportFile.getAbsolutePath()));
  ObjectMapper objectMapper=new ObjectMapper();
  JsonNode rootNode=objectMapper.readTree(jsonData);
  JsonNode gaugesNode=rootNode.path("gauges");
  JsonNode methodGaugeNode=gaugesNode.path("gauge1");
  JsonNode countNode=methodGaugeNode.path("value");
  Assert.assertEquals(countNode.asInt(),testVar.getValue());
  testVar.setValue(40);
  Thread.sleep(2000);
  jsonData=Files.readAllBytes(Paths.get(jsonReportFile.getAbsolutePath()));
  rootNode=objectMapper.readTree(jsonData);
  gaugesNode=rootNode.path("gauges");
  methodGaugeNode=gaugesNode.path("gauge1");
  countNode=methodGaugeNode.path("value");
  Assert.assertEquals(countNode.asInt(),testVar.getValue());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrency() throws Exception {
  int threads=4;
  ExecutorService executorService=Executors.newFixedThreadPool(threads);
  for (int i=0; i < threads; i++) {
    final int n=i;
    executorService.submit(new Callable<Void>(){
      @Override public Void call() throws Exception {
        MetricsFactory.getInstance().startStoredScope("method2");
        MetricsFactory.getInstance().endStoredScope("method2");
        return null;
      }
    }
);
  }
  executorService.shutdown();
  assertTrue(executorService.awaitTermination(10000,TimeUnit.MILLISECONDS));
  Timer timer=metricRegistry.getTimers().get("api_method2");
  Assert.assertEquals(4,timer.getCount());
  Assert.assertTrue(timer.getMeanRate() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveDecimal </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testPosMod(){
  HiveDecimal hd1=HiveDecimal.create("-100.91");
  HiveDecimal hd2=HiveDecimal.create("9.8");
  HiveDecimal dec=hd1.remainder(hd2).add(hd2).remainder(hd2);
  Assert.assertEquals("6.89",dec.toString());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testPrecisionScaleEnforcement(){
  String decStr="1786135888657847525803324040144343378.09799306448796128931113691624";
  HiveDecimal dec=HiveDecimal.create(decStr);
  Assert.assertEquals("1786135888657847525803324040144343378.1",dec.toString());
  Assert.assertTrue("Decimal precision should not go above maximum",dec.precision() <= HiveDecimal.MAX_PRECISION);
  Assert.assertTrue("Decimal scale should not go above maximum",dec.scale() <= HiveDecimal.MAX_SCALE);
  decStr="57847525803324040144343378.09799306448796128931113691624";
  HiveDecimal bd=HiveDecimal.create(decStr);
  HiveDecimal bd1=HiveDecimal.enforcePrecisionScale(bd,20,5);
  Assert.assertNull(bd1);
  bd1=HiveDecimal.enforcePrecisionScale(bd,35,5);
  Assert.assertEquals("57847525803324040144343378.09799",bd1.toString());
  bd1=HiveDecimal.enforcePrecisionScale(bd,45,20);
  Assert.assertNull(bd1);
  dec=HiveDecimal.create(new BigDecimal(decStr),false);
  Assert.assertNull(dec);
  dec=HiveDecimal.create("-1786135888657847525803324040144343378.09799306448796128931113691624");
  Assert.assertEquals("-1786135888657847525803324040144343378.1",dec.toString());
  dec=HiveDecimal.create("005.34000");
  Assert.assertEquals(dec.precision(),3);
  Assert.assertEquals(dec.scale(),2);
  dec=HiveDecimal.create("178613588865784752580332404014434337809799306448796128931113691624");
  Assert.assertNull(dec);
  Assert.assertEquals("10",HiveDecimal.enforcePrecisionScale(HiveDecimal.create("9.5"),2,0).toString());
  Assert.assertNull(HiveDecimal.enforcePrecisionScale(HiveDecimal.create("9.5"),1,0));
  Assert.assertEquals("9",HiveDecimal.enforcePrecisionScale(HiveDecimal.create("9.4"),1,0).toString());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testTrailingZeroRemovalAfterEnforcement(){
  String decStr="8.090000000000000000000000000000000000000123456";
  HiveDecimal dec=HiveDecimal.create(decStr);
  Assert.assertEquals("8.09",dec.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestHiveVarchar </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testStringLength() throws Exception {
  int strLen=20;
  int[] lengths={15,20,25};
  for (int idx1=0; idx1 < lengths.length; ++idx1) {
    StringBuilder sb=new StringBuilder();
    int curLen=lengths[idx1];
    for (int idx2=0; idx2 < curLen; ++idx2) {
      sb.appendCodePoint(getRandomCodePoint(' '));
    }
    String testString=sb.toString();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  String[] testStrings={"abcdefg","abcdefghijklmnopqrst","abcdefghijklmnopqrstuvwxyz"};
  for (  String testString : testStrings) {
    int curLen=testString.length();
    assertEquals(curLen,testString.codePointCount(0,testString.length()));
    String enforcedString=HiveBaseChar.enforceMaxLength(testString,strLen);
    if (curLen <= strLen) {
      assertEquals(testString,enforcedString);
    }
 else {
      assertEquals(strLen,enforcedString.codePointCount(0,enforcedString.length()));
    }
  }
  HiveVarchar vc1=new HiveVarchar("0123456789",10);
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue("012345678901234");
  assertEquals(15,vc1.getCharacterLength());
  vc1.setValue("01234",-1);
  assertEquals(5,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("0123456789",-1));
  assertEquals(10,vc1.getCharacterLength());
  vc1.setValue(new HiveVarchar("01234",-1),-1);
  assertEquals(5,vc1.getCharacterLength());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestSignedInt128 </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveInt(){
  two.divideDestructive(1);
  assertEquals(1L,one.longValue());
  assertEquals(2L,two.longValue());
  one.divideDestructive(2);
  assertEquals(0L,one.longValue());
  assertEquals(2L,two.longValue());
  SignedInt128 var1=new SignedInt128(1234234662345L);
  var1.divideDestructive(642337);
  assertEquals(1234234662345L / 642337L,var1.longValue());
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  complicated1.divideDestructive(1534223465);
  BigInteger bigInteger2=BigInteger.valueOf(1534223465);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(0);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveSignedInt128(){
  SignedInt128 remainder=new SignedInt128();
  two.divideDestructive(one,remainder);
  assertEquals(1L,one.longValue());
  assertEquals(2L,two.longValue());
  assertEquals(zero,remainder);
  one.divideDestructive(two,remainder);
  assertEquals(0L,one.longValue());
  assertEquals(2L,two.longValue());
  assertEquals(new SignedInt128(1),remainder);
  SignedInt128 var1=new SignedInt128(1234234662345L);
  var1.divideDestructive(new SignedInt128(642337),remainder);
  assertEquals(1234234662345L / 642337L,var1.longValue());
  assertEquals(1234234662345L % 642337L,remainder.longValue());
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0x42395ADC);
  SignedInt128 complicated2=new SignedInt128(0xF09DC19A,0x00001234,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,remainder);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(zero,remainder);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveSignedInt128(){
  two.multiplyDestructive(one);
  assertEquals(2L,two.longValue());
  assertEquals(1L,one.longValue());
  two.multiplyDestructive(two);
  assertEquals(4L,two.longValue());
  SignedInt128 five=new SignedInt128(5);
  five.multiplyDestructive(new SignedInt128(6432346));
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  SignedInt128 big=new SignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(new SignedInt128(96));
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  SignedInt128 tmp=new SignedInt128(1);
  tmp.shiftLeftDestructive(126);
  try {
    tmp.multiplyDestructive(new SignedInt128(2));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  SignedInt128 complicated2=new SignedInt128(54234234,9,0,0);
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.multiplyDestructive(complicated2);
  BigInteger ans=bigInteger1.multiply(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    SignedInt128 complicated3=new SignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
    complicated3.multiplyDestructive(new SignedInt128(54234234,9845,0,0));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDivideDestructiveSignedInt128Again(){
  SignedInt128 complicated1=new SignedInt128(0xF9892FCA,0x59D109AD,0,0);
  SignedInt128 complicated2=new SignedInt128(0xF09DC19A,3,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,new SignedInt128());
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestSqlMathUtil </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDivision(){
{
    int[] dividend=new int[]{1 + 33,2 + 21,3,4 + 10,20,30,40,0};
    int[] divisor=new int[]{1,2,3,4};
    int[] quotient=new int[5];
    int[] remainder=SqlMathUtil.divideMultiPrecision(dividend,divisor,quotient);
    assertArrayEquals(new int[]{1,0,0,10,0},quotient);
    assertArrayEquals(new int[]{33,21,0,0,0,0,0,0,0},remainder);
  }
{
    int[] dividend=new int[]{0xF7000000,0,0x39000000,0};
    int[] divisor=new int[]{0xF700,0,0x3900,0};
    int[] quotient=new int[5];
    int[] remainder=SqlMathUtil.divideMultiPrecision(dividend,divisor,quotient);
    assertArrayEquals(new int[]{0x10000,0,0,0,0},quotient);
    assertArrayEquals(new int[]{0,0,0,0,0},remainder);
  }
{
    int[] dividend=new int[]{0,0,0,0};
    int[] divisor=new int[]{0xF700,0,0x3900,0};
    int[] quotient=new int[5];
    int[] remainder=SqlMathUtil.divideMultiPrecision(dividend,divisor,quotient);
    assertArrayEquals(new int[]{0,0,0,0,0},quotient);
    assertArrayEquals(new int[]{0,0,0,0,0},remainder);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.common.type.TestUnsignedInt128 </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiplyDestructiveUnsignedInt128(){
  two.multiplyDestructive(one);
  assertEquals(2L,two.asLong());
  assertEquals(1L,one.asLong());
  two.multiplyDestructive(two);
  assertEquals(4L,two.asLong());
  UnsignedInt128 five=new UnsignedInt128(5);
  five.multiplyDestructive(new UnsignedInt128(6432346));
  assertEquals(6432346 * 5,five.getV0());
  assertEquals(0,five.getV1());
  assertEquals(0,five.getV2());
  assertEquals(0,five.getV3());
  UnsignedInt128 big=new UnsignedInt128((1L << 62) + (3L << 34) + 3L);
  big.multiplyDestructive(new UnsignedInt128(96));
  assertEquals(3 * 96,big.getV0());
  assertEquals(96 * (3 << 2),big.getV1());
  assertEquals(96 / 4,big.getV2());
  assertEquals(0,big.getV3());
  UnsignedInt128 tmp=new UnsignedInt128(1);
  tmp.shiftLeftDestructive(126);
  tmp.multiplyDestructive(new UnsignedInt128(2));
  try {
    tmp.multiplyDestructive(new UnsignedInt128(2));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  UnsignedInt128 complicated2=new UnsignedInt128(54234234,9,0,0);
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.multiplyDestructive(complicated2);
  BigInteger ans=bigInteger1.multiply(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    UnsignedInt128 complicated3=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
    complicated3.multiplyDestructive(new UnsignedInt128(54234234,9845,0,0));
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDivideDestructiveUnsignedInt128Again(){
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0,0);
  UnsignedInt128 complicated2=new UnsignedInt128(0xF09DC19A,3,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,new UnsignedInt128());
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveUnsignedInt128(){
  UnsignedInt128 remainder=new UnsignedInt128();
  two.divideDestructive(one,remainder);
  assertEquals(1L,one.asLong());
  assertEquals(2L,two.asLong());
  assertEquals(zero,remainder);
  one.divideDestructive(two,remainder);
  assertEquals(0L,one.asLong());
  assertEquals(2L,two.asLong());
  assertEquals(new UnsignedInt128(1),remainder);
  UnsignedInt128 var1=new UnsignedInt128(1234234662345L);
  var1.divideDestructive(new UnsignedInt128(642337),remainder);
  assertEquals(1234234662345L / 642337L,var1.asLong());
  assertEquals(1234234662345L % 642337L,remainder.asLong());
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0x42395ADC);
  UnsignedInt128 complicated2=new UnsignedInt128(0xF09DC19A,0x00001234,0,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  BigInteger bigInteger2=complicated2.toBigIntegerSlow();
  complicated1.divideDestructive(complicated2,remainder);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(zero,remainder);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDivideDestructiveInt(){
  two.divideDestructive(1);
  assertEquals(1L,one.asLong());
  assertEquals(2L,two.asLong());
  one.divideDestructive(2);
  assertEquals(0L,one.asLong());
  assertEquals(2L,two.asLong());
  UnsignedInt128 var1=new UnsignedInt128(1234234662345L);
  var1.divideDestructive(642337);
  assertEquals(1234234662345L / 642337L,var1.asLong());
  UnsignedInt128 complicated1=new UnsignedInt128(0xF9892FCA,0x59D109AD,0x0534AB4C,0);
  BigInteger bigInteger1=complicated1.toBigIntegerSlow();
  complicated1.divideDestructive(1534223465);
  BigInteger bigInteger2=BigInteger.valueOf(1534223465);
  BigInteger ans=bigInteger1.divide(bigInteger2);
  assertEquals(ans,complicated1.toBigIntegerSlow());
  try {
    complicated1.divideDestructive(0);
    fail();
  }
 catch (  ArithmeticException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.conf.TestHiveConf </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHiveSitePath() throws Exception {
  String expectedPath=HiveTestUtils.getFileFromClasspath("hive-site.xml");
  String hiveSiteLocation=HiveConf.getHiveSiteLocation().getPath();
  if (Shell.WINDOWS) {
    expectedPath=expectedPath.toLowerCase();
    hiveSiteLocation=hiveSiteLocation.toLowerCase();
  }
  Assert.assertEquals(expectedPath,hiveSiteLocation);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestIncrementalObjectSizeEstimator </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleTypes(){
  JavaDataModel memModel=JavaDataModel.get();
  int intSize=runEstimate(new Integer(0),memModel,null);
  runEstimate(new String(""),memModel,"empty string");
  runEstimate(new String("foobarzzzzzzzzzzzzzz"),memModel,null);
  List list=new ArrayList(0);
  runEstimate(list,memModel,"empty ArrayList");
  list.add(new String("zzz"));
  runEstimate(list,memModel,"ArrayList - one string");
  list.add(new Integer(5));
  list.add(new Integer(6));
  int arrayListSize=runEstimate(list,memModel,"ArrayList - 3 elements");
  LinkedHashSet list2=new LinkedHashSet(0);
  runEstimate(list2,memModel,"empty LinkedHashSet");
  list2.add(new String("zzzz"));
  runEstimate(list2,memModel,"LinkedHashSet - one string");
  list2.add(new Integer(7));
  list2.add(new Integer(4));
  int lhsSize=runEstimate(list2,memModel,"LinkedHashSet - 3 elements");
  Struct struct=new Struct();
  int structSize=runEstimate(struct,memModel,"Struct - empty");
  struct.i=10;
  int structSize2=runEstimate(struct,memModel,"Struct - one reference");
  assertEquals(intSize + structSize,structSize2);
  struct.list=list;
  int structSize3=runEstimate(struct,memModel,"Struct - with ArrayList");
  assertEquals(arrayListSize + structSize2,structSize3);
  struct.list2=list2;
  int structSize4=runEstimate(struct,memModel,"Struct - with LinkedHashSet");
  assertEquals(lhsSize + structSize3,structSize4);
  Struct2 struct2=new Struct2();
  int recSize1=runEstimate(struct2,memModel,"recursive struct - empty");
  struct2.next=new Struct2();
  struct2.top=new Struct2();
  int recSize2=runEstimate(struct2,memModel,"recursive struct - no ring");
  assertEquals(recSize1 * 3,recSize2);
  struct2.next.prev=struct2;
  int recSize3=runEstimate(struct2,memModel,"recursive struct - ring added");
  assertEquals(recSize2,recSize3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelCacheImpl </h4><pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPut(){
  LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,-1);
  long fn1=1, fn2=2;
  MemoryBuffer[] fakes=new MemoryBuffer[]{fb(),fb(),fb(),fb(),fb(),fb()};
  verifyRefcount(fakes,1,1,1,1,1,1);
  assertNull(cache.putFileData(fn1,drs(1,2),fbs(fakes,0,1),0,Priority.NORMAL,null));
  assertNull(cache.putFileData(fn2,drs(1,2),fbs(fakes,2,3),0,Priority.NORMAL,null));
  verifyCacheGet(cache,fn1,1,3,fakes[0],fakes[1]);
  verifyCacheGet(cache,fn2,1,3,fakes[2],fakes[3]);
  verifyCacheGet(cache,fn1,2,4,fakes[1],dr(3,4));
  verifyRefcount(fakes,3,4,3,3,1,1);
  MemoryBuffer[] bufsDiff=fbs(fakes,4,5);
  long[] mask=cache.putFileData(fn1,drs(3,1),bufsDiff,0,Priority.NORMAL,null);
  assertEquals(1,mask.length);
  assertEquals(2,mask[0]);
  assertSame(fakes[0],bufsDiff[1]);
  verifyRefcount(fakes,4,4,3,3,2,1);
  verifyCacheGet(cache,fn1,1,4,fakes[0],fakes[1],fakes[4]);
  verifyRefcount(fakes,5,5,3,3,3,1);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testMTTWithCleanup(){
  final LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,1);
  final long fn1=1, fn2=2;
  final int offsetsToUse=8;
  final CountDownLatch cdlIn=new CountDownLatch(4), cdlOut=new CountDownLatch(1);
  final AtomicInteger rdmsDone=new AtomicInteger(0);
  Callable<Long> rdmCall=new Callable<Long>(){
    public Long call(){
      int gets=0, puts=0;
      try {
        Random rdm=new Random(1234 + Thread.currentThread().getId());
        syncThreadStart(cdlIn,cdlOut);
        for (int i=0; i < 20000; ++i) {
          boolean isGet=rdm.nextBoolean(), isFn1=rdm.nextBoolean();
          long fileName=isFn1 ? fn1 : fn2;
          int fileIndex=isFn1 ? 1 : 2;
          int count=rdm.nextInt(offsetsToUse);
          if (isGet) {
            int[] offsets=new int[count];
            count=generateOffsets(offsetsToUse,rdm,offsets);
            CreateHelper list=new CreateHelper();
            for (int j=0; i < count; ++i) {
              list.addOrMerge(offsets[j],offsets[j] + 1,true,false);
            }
            DiskRangeList iter=cache.getFileData(fileName,list.get(),0,testFactory,null,null);
            int j=-1;
            while (iter != null) {
              ++j;
              if (!(iter instanceof CacheChunk)) {
                iter=iter.next;
                continue;
              }
              ++gets;
              LlapDataBuffer result=(LlapDataBuffer)((CacheChunk)iter).getBuffer();
              assertEquals(makeFakeArenaIndex(fileIndex,offsets[j]),result.arenaIndex);
              cache.decRefBuffer(result);
              iter=iter.next;
            }
          }
 else {
            DiskRange[] ranges=new DiskRange[count];
            int[] offsets=new int[count];
            for (int j=0; j < count; ++j) {
              int next=rdm.nextInt(offsetsToUse);
              ranges[j]=dr(next,next + 1);
              offsets[j]=next;
            }
            MemoryBuffer[] buffers=new MemoryBuffer[count];
            for (int j=0; j < offsets.length; ++j) {
              LlapDataBuffer buf=LowLevelCacheImpl.allocateFake();
              buf.arenaIndex=makeFakeArenaIndex(fileIndex,offsets[j]);
              buffers[j]=buf;
            }
            long[] mask=cache.putFileData(fileName,ranges,buffers,0,Priority.NORMAL,null);
            puts+=buffers.length;
            long maskVal=0;
            if (mask != null) {
              assertEquals(1,mask.length);
              maskVal=mask[0];
            }
            for (int j=0; j < offsets.length; ++j) {
              LlapDataBuffer buf=(LlapDataBuffer)(buffers[j]);
              if ((maskVal & 1) == 1) {
                assertEquals(makeFakeArenaIndex(fileIndex,offsets[j]),buf.arenaIndex);
              }
              maskVal>>=1;
              cache.decRefBuffer(buf);
            }
          }
        }
      }
  finally {
        rdmsDone.incrementAndGet();
      }
      return (((long)gets) << 32) | puts;
    }
    private int makeFakeArenaIndex(    int fileIndex,    long offset){
      return (int)((fileIndex << 16) + offset);
    }
  }
;
  FutureTask<Integer> evictionTask=new FutureTask<Integer>(new Callable<Integer>(){
    public Integer call(){
      boolean isFirstFile=false;
      Random rdm=new Random(1234 + Thread.currentThread().getId());
      int evictions=0;
      syncThreadStart(cdlIn,cdlOut);
      while (rdmsDone.get() < 3) {
        DiskRangeList head=new DiskRangeList(0,offsetsToUse + 1);
        isFirstFile=!isFirstFile;
        long fileId=isFirstFile ? fn1 : fn2;
        head=cache.getFileData(fileId,head,0,testFactory,null,null);
        DiskRange[] results=head.listToArray();
        int startIndex=rdm.nextInt(results.length), index=startIndex;
        LlapDataBuffer victim=null;
        do {
          DiskRange r=results[index];
          if (r instanceof CacheChunk) {
            LlapDataBuffer result=(LlapDataBuffer)((CacheChunk)r).getBuffer();
            cache.decRefBuffer(result);
            if (victim == null && result.invalidate()) {
              ++evictions;
              victim=result;
            }
          }
          ++index;
          if (index == results.length)           index=0;
        }
 while (index != startIndex);
        if (victim == null)         continue;
        cache.notifyEvicted(victim);
      }
      return evictions;
    }
  }
);
  FutureTask<Long> rdmTask1=new FutureTask<Long>(rdmCall), rdmTask2=new FutureTask<Long>(rdmCall), rdmTask3=new FutureTask<Long>(rdmCall);
  Executor threadPool=Executors.newFixedThreadPool(4);
  threadPool.execute(rdmTask1);
  threadPool.execute(rdmTask2);
  threadPool.execute(rdmTask3);
  threadPool.execute(evictionTask);
  try {
    cdlIn.await();
    cdlOut.countDown();
    long result1=rdmTask1.get(), result2=rdmTask2.get(), result3=rdmTask3.get();
    int evictions=evictionTask.get();
    LOG.info("MTT test: task 1: " + descRdmTask(result1) + ", task 2: "+ descRdmTask(result2)+ ", task 3: "+ descRdmTask(result3)+ "; "+ evictions+ " evictions");
  }
 catch (  Throwable t) {
    throw new RuntimeException(t);
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStaleValueReplace(){
  LowLevelCacheImpl cache=new LowLevelCacheImpl(LlapDaemonCacheMetrics.create("test","1"),new DummyCachePolicy(),new DummyAllocator(),true,-1);
  long fn1=1, fn2=2;
  MemoryBuffer[] fakes=new MemoryBuffer[]{fb(),fb(),fb(),fb(),fb(),fb(),fb(),fb(),fb()};
  assertNull(cache.putFileData(fn1,drs(1,2,3),fbs(fakes,0,1,2),0,Priority.NORMAL,null));
  assertNull(cache.putFileData(fn2,drs(1),fbs(fakes,3),0,Priority.NORMAL,null));
  evict(cache,fakes[0]);
  evict(cache,fakes[3]);
  long[] mask=cache.putFileData(fn1,drs(1,2,3,4),fbs(fakes,4,5,6,7),0,Priority.NORMAL,null);
  assertEquals(1,mask.length);
  assertEquals(6,mask[0]);
  assertNull(cache.putFileData(fn2,drs(1),fbs(fakes,8),0,Priority.NORMAL,null));
  verifyCacheGet(cache,fn1,1,5,fakes[4],fakes[1],fakes[2],fakes[7]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.cache.TestLowLevelLrfuCachePolicy </h4><pre class="type-11 type-6 type-4 type-5 type-14 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeadlockResolution(){
  int heapSize=4;
  LOG.info("Testing deadlock resolution");
  ArrayList<LlapDataBuffer> inserted=new ArrayList<LlapDataBuffer>(heapSize);
  EvictionTracker et=new EvictionTracker();
  Configuration conf=new Configuration();
  LowLevelLrfuCachePolicy lrfu=new LowLevelLrfuCachePolicy(1,heapSize,conf);
  LowLevelCacheMemoryManager mm=new LowLevelCacheMemoryManager(heapSize,lrfu,LlapDaemonCacheMetrics.create("test","1"));
  lrfu.setEvictionListener(et);
  for (int i=0; i < heapSize; ++i) {
    LlapDataBuffer buffer=LowLevelCacheImpl.allocateFake();
    assertTrue(cache(mm,lrfu,et,buffer));
    inserted.add(buffer);
  }
  LlapDataBuffer locked=inserted.get(0);
  lock(lrfu,locked);
  mm.reserveMemory(1,false);
  LlapDataBuffer evicted=et.evicted.get(0);
  assertNotNull(evicted);
  assertTrue(evicted.isInvalid());
  assertNotSame(locked,evicted);
  unlock(lrfu,locked);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.llap.daemon.impl.TestLlapDaemonProtocolServerImpl </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=10000) public void test() throws ServiceException, IOException {
  LlapConfiguration daemonConf=new LlapConfiguration();
  int rpcPort=HiveConf.getIntVar(daemonConf,ConfVars.LLAP_DAEMON_RPC_PORT);
  int numHandlers=HiveConf.getIntVar(daemonConf,ConfVars.LLAP_DAEMON_RPC_NUM_HANDLERS);
  ContainerRunner containerRunnerMock=mock(ContainerRunner.class);
  LlapProtocolServerImpl server=new LlapProtocolServerImpl(numHandlers,containerRunnerMock,new AtomicReference<InetSocketAddress>(),new AtomicReference<InetSocketAddress>(),rpcPort,rpcPort + 1);
  when(containerRunnerMock.submitWork(any(SubmitWorkRequestProto.class))).thenReturn(SubmitWorkResponseProto.newBuilder().setSubmissionState(SubmissionStateProto.ACCEPTED).build());
  try {
    server.init(new Configuration());
    server.start();
    InetSocketAddress serverAddr=server.getBindAddress();
    LlapProtocolBlockingPB client=new LlapProtocolClientImpl(new Configuration(),serverAddr.getHostName(),serverAddr.getPort(),null,null);
    SubmitWorkResponseProto responseProto=client.submitWork(null,SubmitWorkRequestProto.newBuilder().setAmHost("amhost").setAmPort(2000).build());
    assertEquals(responseProto.getSubmissionState().name(),SubmissionStateProto.ACCEPTED.name());
  }
  finally {
    server.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.TestAggregateStatsCache </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicAddAndGet() throws Exception {
  List<String> partNames=preparePartNames(tables.get(0),1,9);
  BloomFilter bloomFilter=prepareBloomFilter(partNames);
  String tblName=tables.get(0);
  String colName=tabCols.get(0);
  int highVal=100, lowVal=10, numDVs=50, numNulls=5;
  ColumnStatisticsObj aggrColStats=getDummyLongColStat(colName,highVal,lowVal,numDVs,numNulls);
  cache.add(DB_NAME,tblName,colName,10,aggrColStats,bloomFilter);
  AggrColStats aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNotNull(aggrStatsCached);
  ColumnStatisticsObj aggrColStatsCached=aggrStatsCached.getColStats();
  Assert.assertEquals(aggrColStats,aggrColStatsCached);
  aggrStatsCached=cache.get("dbNotThere",tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddGetWithVariance() throws Exception {
  List<String> partNames=preparePartNames(tables.get(0),1,9);
  BloomFilter bloomFilter=prepareBloomFilter(partNames);
  String tblName=tables.get(0);
  String colName=tabCols.get(0);
  int highVal=100, lowVal=10, numDVs=50, numNulls=5;
  ColumnStatisticsObj aggrColStats=getDummyLongColStat(colName,highVal,lowVal,numDVs,numNulls);
  cache.add(DB_NAME,tblName,colName,10,aggrColStats,bloomFilter);
  partNames=preparePartNames(tables.get(0),1,5);
  AggrColStats aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
  partNames=preparePartNames(tables.get(0),11,20);
  aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
  partNames=preparePartNames(tables.get(0),1,8);
  aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNotNull(aggrStatsCached);
  ColumnStatisticsObj aggrColStatsCached=aggrStatsCached.getColStats();
  Assert.assertEquals(aggrColStats,aggrColStatsCached);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testTimeToLive() throws Exception {
  List<String> partNames=preparePartNames(tables.get(0),1,9);
  BloomFilter bloomFilter=prepareBloomFilter(partNames);
  String tblName=tables.get(0);
  String colName=tabCols.get(0);
  int highVal=100, lowVal=10, numDVs=50, numNulls=5;
  ColumnStatisticsObj aggrColStats=getDummyLongColStat(colName,highVal,lowVal,numDVs,numNulls);
  cache.add(DB_NAME,tblName,colName,10,aggrColStats,bloomFilter);
  Thread.sleep(30000);
  AggrColStats aggrStatsCached=cache.get(DB_NAME,tblName,colName,partNames);
  Assert.assertNull(aggrStatsCached);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseFilterPlanUtil </h4><pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionKeyScannerMixedType() throws Exception {
  List<FieldSchema> parts=new ArrayList<FieldSchema>();
  parts.add(new FieldSchema("year","int",null));
  parts.add(new FieldSchema("month","int",null));
  parts.add(new FieldSchema("state","string",null));
  ExpressionTree exprTree=PartFilterExprUtil.getFilterParser("year = 2015 and state = 'CA'").tree;
  PlanResult planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  ScanPlan sp=planRes.plan.getPlans().get(0);
  byte[] startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  byte[] endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  RowFilter filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,Shorts.toByteArray((short)2015)));
  Assert.assertTrue(Bytes.contains(endRowSuffix,Shorts.toByteArray((short)2016)));
  PartitionKeyComparator comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ranges.size(),1);
  Assert.assertEquals(comparator.ranges.get(0).keyName,"state");
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test plan generation from TreeNode
 * @throws MetaException
 */
@Test public void testTreeNodePlan() throws MetaException {
  final String KEY="k1";
  final String VAL1="10";
  final String VAL2="11";
  LeafNode l=new LeafNode();
  l.keyName=KEY;
  l.value=VAL1;
  final ScanMarker DEFAULT_SCANMARKER=null;
  List<FieldSchema> parts=new ArrayList<FieldSchema>();
  parts.add(new FieldSchema("k1","int",null));
  LeafNode r=new LeafNode();
  r.keyName=KEY;
  r.value=VAL2;
  TreeNode tn=new TreeNode(l,LogicalOperator.AND,r);
  l.operator=Operator.GREATERTHANOREQUALTO;
  r.operator=Operator.LESSTHAN;
  verifyPlan(tn,parts,KEY,new ScanMarker(VAL1,INCLUSIVE,"int"),new ScanMarker(VAL2,!INCLUSIVE,"int"));
  l.operator=Operator.GREATERTHANOREQUALTO;
  r.operator=Operator.GREATERTHAN;
  verifyPlan(tn,parts,KEY,new ScanMarker(VAL2,!INCLUSIVE,"int"),DEFAULT_SCANMARKER);
  tn=new TreeNode(l,LogicalOperator.OR,r);
  ExpressionTree e=new ExpressionTree();
  e.setRootForTest(tn);
  PlanResult planRes=HBaseFilterPlanUtil.getFilterPlan(e,parts);
  Assert.assertEquals(2,planRes.plan.getPlans().size());
  Assert.assertEquals(false,planRes.hasUnsupportedCondition);
  TreeNode tn2=new TreeNode(l,LogicalOperator.AND,tn);
  e=new ExpressionTree();
  e.setRootForTest(tn2);
  planRes=HBaseFilterPlanUtil.getFilterPlan(e,parts);
  Assert.assertEquals(2,planRes.plan.getPlans().size());
  Assert.assertEquals(false,planRes.hasUnsupportedCondition);
  LeafNode klike=new LeafNode();
  klike.keyName=KEY;
  klike.value=VAL1;
  klike.operator=Operator.LIKE;
  TreeNode tn3=new TreeNode(tn2,LogicalOperator.OR,klike);
  e=new ExpressionTree();
  e.setRootForTest(tn3);
  planRes=HBaseFilterPlanUtil.getFilterPlan(e,parts);
  Assert.assertEquals(3,planRes.plan.getPlans().size());
  Assert.assertEquals(false,planRes.hasUnsupportedCondition);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionKeyScannerAllString() throws Exception {
  List<FieldSchema> parts=new ArrayList<FieldSchema>();
  parts.add(new FieldSchema("year","string",null));
  parts.add(new FieldSchema("month","string",null));
  parts.add(new FieldSchema("state","string",null));
  ExpressionTree exprTree=PartFilterExprUtil.getFilterParser("year = 2015 and state = 'CA'").tree;
  PlanResult planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  ScanPlan sp=planRes.plan.getPlans().get(0);
  byte[] startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  byte[] endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  RowFilter filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2015".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2015".getBytes()));
  Assert.assertFalse(Bytes.contains(startRowSuffix,"CA".getBytes()));
  Assert.assertFalse(Bytes.contains(endRowSuffix,"CA".getBytes()));
  PartitionKeyComparator comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ranges.size(),1);
  Assert.assertEquals(comparator.ranges.get(0).keyName,"state");
  exprTree=PartFilterExprUtil.getFilterParser("year = 2015 and month > 10 " + "and month <= 11 and state like 'C%'").tree;
  planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  sp=planRes.plan.getPlans().get(0);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2015".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2015".getBytes()));
  Assert.assertTrue(Bytes.contains(startRowSuffix,"10".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"11".getBytes()));
  comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ops.size(),1);
  Assert.assertEquals(comparator.ops.get(0).keyName,"state");
  exprTree=PartFilterExprUtil.getFilterParser("year >= 2014 and month > 10 " + "and month <= 11 and state like 'C%'").tree;
  planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  Assert.assertEquals(planRes.plan.getPlans().size(),1);
  sp=planRes.plan.getPlans().get(0);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2014".getBytes()));
  comparator=(PartitionKeyComparator)filter.getComparator();
  Assert.assertEquals(comparator.ranges.size(),1);
  Assert.assertEquals(comparator.ranges.get(0).keyName,"month");
  Assert.assertEquals(comparator.ops.size(),1);
  Assert.assertEquals(comparator.ops.get(0).keyName,"state");
  exprTree=PartFilterExprUtil.getFilterParser("year = 2014 and (month > 10 " + "or month < 3)").tree;
  planRes=HBaseFilterPlanUtil.getFilterPlan(exprTree,parts);
  sp=planRes.plan.getPlans().get(0);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(startRowSuffix,"10".getBytes()));
  sp=planRes.plan.getPlans().get(1);
  startRowSuffix=sp.getStartRowSuffix("testdb","testtb",parts);
  endRowSuffix=sp.getEndRowSuffix("testdb","testtb",parts);
  filter=(RowFilter)sp.getFilter(parts);
  Assert.assertTrue(Bytes.contains(startRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"2014".getBytes()));
  Assert.assertTrue(Bytes.contains(endRowSuffix,"3".getBytes()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseImport </h4><pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importSecurity() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"securitydb1","securitydb2"};
  String[] roles=new String[]{"securityrole1","securityrole2"};
  String[] tokenIds=new String[]{"securitytokenid1","securitytokenid2"};
  String[] tokens=new String[]{"securitytoken1","securitytoken2"};
  String[] masterKeys=new String[]{"securitymk1","securitymk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  HBaseImport importer=new HBaseImport("-k");
  importer.setConnections(rdbms,store);
  importer.run();
  Assert.assertEquals(baseNumRoles,store.listRoleNames().size());
  Assert.assertEquals(baseNumDbs,store.getAllDatabases().size());
  for (int i=0; i < tokenIds.length; i++) {
    Assert.assertEquals(tokens[i],store.getToken(tokenIds[i]));
  }
  String[] hbaseKeys=store.getMasterKeys();
  Set<String> keys=new HashSet<>(Arrays.asList(hbaseKeys));
  for (int i=0; i < masterKeys.length; i++) {
    Assert.assertTrue(keys.contains(masterKeys[i]));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void importAll() throws Exception {
  RawStore rdbms;
  rdbms=new ObjectStore();
  rdbms.setConf(conf);
  String[] dbNames=new String[]{"alldb1","alldb2"};
  String[] roles=new String[]{"allrole1","allrole2"};
  String[] tokenIds=new String[]{"alltokenid1","alltokenid2"};
  String[] tokens=new String[]{"alltoken1","alltoken2"};
  String[] masterKeys=new String[]{"allmk1","allmk2"};
  int now=(int)System.currentTimeMillis() / 1000;
  setupObjectStore(rdbms,roles,dbNames,tokenIds,tokens,masterKeys,now);
  int baseNumRoles=store.listRoleNames() == null ? 0 : store.listRoleNames().size();
  int baseNumDbs=store.getAllDatabases() == null ? 0 : store.getAllDatabases().size();
  HBaseImport importer=new HBaseImport("-a");
  importer.setConnections(rdbms,store);
  importer.run();
  for (int i=0; i < roles.length; i++) {
    Role role=store.getRole(roles[i]);
    Assert.assertNotNull(role);
    Assert.assertEquals(roles[i],role.getRoleName());
  }
  Assert.assertEquals(baseNumRoles + 2,store.listRoleNames().size());
  for (int i=0; i < dbNames.length; i++) {
    Database db=store.getDatabase(dbNames[i]);
    Assert.assertNotNull(db);
    Assert.assertEquals("file:/tmp",db.getLocationUri());
    Table table=store.getTable(db.getName(),tableNames[0]);
    Assert.assertNotNull(table);
    Assert.assertEquals(now,table.getLastAccessTime());
    Assert.assertEquals("input",table.getSd().getInputFormat());
    table=store.getTable(db.getName(),tableNames[1]);
    Assert.assertNotNull(table);
    for (int j=0; j < partVals.length; j++) {
      Partition part=store.getPartition(dbNames[i],tableNames[1],Arrays.asList(partVals[j]));
      Assert.assertNotNull(part);
      Assert.assertEquals("file:/tmp/region=" + partVals[j],part.getSd().getLocation());
    }
    Assert.assertEquals(4,store.getPartitions(dbNames[i],tableNames[1],-1).size());
    Assert.assertEquals(2,store.getAllTables(dbNames[i]).size());
    Assert.assertEquals(2,store.getFunctions(dbNames[i],"*").size());
    for (int j=0; j < funcNames.length; j++) {
      Assert.assertNotNull(store.getFunction(dbNames[i],funcNames[j]));
    }
  }
  Assert.assertEquals(baseNumDbs + 2,store.getAllDatabases().size());
  for (int i=0; i < tokenIds.length; i++) {
    Assert.assertEquals(tokens[i],store.getToken(tokenIds[i]));
  }
  String[] hbaseKeys=store.getMasterKeys();
  Set<String> keys=new HashSet<>(Arrays.asList(hbaseKeys));
  for (int i=0; i < masterKeys.length; i++) {
    Assert.assertTrue(keys.contains(masterKeys[i]));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStore </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void binaryPartitionStatistics() throws Exception {
  createMockTableAndPartition(BINARY_TYPE,BINARY_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,BINARY_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=binaryColStatsObjs.get(0);
  BinaryColumnStatsData binaryData=obj.getStatsData().getBinaryStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(BINARY_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,dataFromDB.getSetField());
  BinaryColumnStatsData binaryDataFromDB=dataFromDB.getBinaryStats();
  Assert.assertEquals(binaryData.getMaxColLen(),binaryDataFromDB.getMaxColLen());
  Assert.assertEquals(binaryData.getAvgColLen(),binaryDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(binaryData.getNumNulls(),binaryDataFromDB.getNumNulls());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doubleTableStatistics() throws Exception {
  createMockTable(DOUBLE_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DOUBLE_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalTableStatistics() throws Exception {
  createMockTable(DECIMAL_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DECIMAL_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringPartitionStatistics() throws Exception {
  createMockTableAndPartition(STRING_TYPE,STRING_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,STRING_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(STRING_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void booleanTableStatistics() throws Exception {
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=booleanColStatsObjs.get(0);
  BooleanColumnStatsData boolData=obj.getStatsData().getBooleanStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(BOOLEAN_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,dataFromDB.getSetField());
  BooleanColumnStatsData boolDataFromDB=dataFromDB.getBooleanStats();
  Assert.assertEquals(boolData.getNumTrues(),boolDataFromDB.getNumTrues());
  Assert.assertEquals(boolData.getNumFalses(),boolDataFromDB.getNumFalses());
  Assert.assertEquals(boolData.getNumNulls(),boolDataFromDB.getNumNulls());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void hashSd() throws Exception {
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int",""));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",true,0,serde,null,null,emptyParameters);
  Map<List<String>,String> map=new HashMap<List<String>,String>();
  map.put(Arrays.asList("col3"),"col4");
  SkewedInfo skew=new SkewedInfo(Arrays.asList("col1"),Arrays.asList(Arrays.asList("col2")),map);
  sd.setSkewedInfo(skew);
  MessageDigest md=MessageDigest.getInstance("MD5");
  byte[] baseHash=HBaseUtils.hashStorageDescriptor(sd,md);
  StorageDescriptor changeSchema=new StorageDescriptor(sd);
  changeSchema.getCols().add(new FieldSchema("col2","varchar(32)","a comment"));
  byte[] schemaHash=HBaseUtils.hashStorageDescriptor(changeSchema,md);
  Assert.assertFalse(Arrays.equals(baseHash,schemaHash));
  StorageDescriptor changeLocation=new StorageDescriptor(sd);
  changeLocation.setLocation("file:/somewhere/else");
  byte[] locationHash=HBaseUtils.hashStorageDescriptor(changeLocation,md);
  Assert.assertArrayEquals(baseHash,locationHash);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longTableStatistics() throws Exception {
  createMockTable(LONG_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(LONG_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringTableStatistics() throws Exception {
  createMockTable(STRING_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(STRING_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longPartitionStatistics() throws Exception {
  createMockTableAndPartition(INT_TYPE,INT_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,INT_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(INT_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listGetDropPartitionNames() throws Exception {
  String tableName="listParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  partCols.add(new FieldSchema("region","string",""));
  Table table=new Table(tableName,DB,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  String[][] partVals=new String[][]{{"today","north america"},{"tomorrow","europe"}};
  for (  String[] pv : partVals) {
    List<String> vals=new ArrayList<String>();
    for (    String v : pv)     vals.add(v);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + pv[0] + "/region="+ pv[1]);
    Partition part=new Partition(vals,DB,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
  }
  List<String> names=store.listPartitionNames(DB,tableName,(short)-1);
  Assert.assertEquals(2,names.size());
  String[] resultNames=names.toArray(new String[names.size()]);
  Arrays.sort(resultNames);
  Assert.assertArrayEquals(resultNames,new String[]{"pc=today/region=north america","pc=tomorrow/region=europe"});
  List<Partition> parts=store.getPartitionsByNames(DB,tableName,names);
  Assert.assertArrayEquals(partVals[0],parts.get(0).getValues().toArray(new String[2]));
  Assert.assertArrayEquals(partVals[1],parts.get(1).getValues().toArray(new String[2]));
  store.dropPartitions(DB,tableName,names);
  List<Partition> afterDropParts=store.getPartitions(DB,tableName,-1);
  Assert.assertEquals(0,afterDropParts.size());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalPartitionStatistics() throws Exception {
  createMockTableAndPartition(DECIMAL_TYPE,DECIMAL_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DECIMAL_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DECIMAL_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doublePartitionStatistics() throws Exception {
  createMockTableAndPartition(DOUBLE_TYPE,DOUBLE_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DOUBLE_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DOUBLE_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void binaryTableStatistics() throws Exception {
  createMockTable(BINARY_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=binaryColStatsObjs.get(0);
  BinaryColumnStatsData binaryData=obj.getStatsData().getBinaryStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(BINARY_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,dataFromDB.getSetField());
  BinaryColumnStatsData binaryDataFromDB=dataFromDB.getBinaryStats();
  Assert.assertEquals(binaryData.getMaxColLen(),binaryDataFromDB.getMaxColLen());
  Assert.assertEquals(binaryData.getAvgColLen(),binaryDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(binaryData.getNumNulls(),binaryDataFromDB.getNumNulls());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void booleanPartitionStatistics() throws Exception {
  createMockTableAndPartition(BOOLEAN_TYPE,BOOLEAN_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,BOOLEAN_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=booleanColStatsObjs.get(0);
  BooleanColumnStatsData boolData=obj.getStatsData().getBooleanStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(BOOLEAN_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,dataFromDB.getSetField());
  BooleanColumnStatsData boolDataFromDB=dataFromDB.getBooleanStats();
  Assert.assertEquals(boolData.getNumTrues(),boolDataFromDB.getNumTrues());
  Assert.assertEquals(boolData.getNumFalses(),boolDataFromDB.getNumFalses());
  Assert.assertEquals(boolData.getNumNulls(),boolDataFromDB.getNumNulls());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreBitVector </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalPartitionStatistics() throws Exception {
  createMockTableAndPartition(DECIMAL_TYPE,DECIMAL_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DECIMAL_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DECIMAL_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
  Assert.assertEquals(decimalData.getBitVectors(),decimalDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longTableStatistics() throws Exception {
  createMockTable(LONG_COL,LONG_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(LONG_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
  Assert.assertEquals(longData.getBitVectors(),longDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doubleTableStatistics() throws Exception {
  createMockTable(DOUBLE_COL,DOUBLE_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DOUBLE_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
  Assert.assertEquals(doubleData.getBitVectors(),doubleDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void decimalTableStatistics() throws Exception {
  createMockTable(DECIMAL_COL,DECIMAL_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=decimalColStatsObjs.get(0);
  DecimalColumnStatsData decimalData=obj.getStatsData().getDecimalStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(DECIMAL_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,dataFromDB.getSetField());
  DecimalColumnStatsData decimalDataFromDB=dataFromDB.getDecimalStats();
  Assert.assertEquals(decimalData.getHighValue(),decimalDataFromDB.getHighValue());
  Assert.assertEquals(decimalData.getLowValue(),decimalDataFromDB.getLowValue());
  Assert.assertEquals(decimalData.getNumNulls(),decimalDataFromDB.getNumNulls());
  Assert.assertEquals(decimalData.getNumDVs(),decimalDataFromDB.getNumDVs());
  Assert.assertEquals(decimalData.getBitVectors(),decimalDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void longPartitionStatistics() throws Exception {
  createMockTableAndPartition(INT_TYPE,INT_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,INT_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=longColStatsObjs.get(0);
  LongColumnStatsData longData=obj.getStatsData().getLongStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(INT_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,dataFromDB.getSetField());
  LongColumnStatsData longDataFromDB=dataFromDB.getLongStats();
  Assert.assertEquals(longData.getHighValue(),longDataFromDB.getHighValue());
  Assert.assertEquals(longData.getLowValue(),longDataFromDB.getLowValue());
  Assert.assertEquals(longData.getNumNulls(),longDataFromDB.getNumNulls());
  Assert.assertEquals(longData.getNumDVs(),longDataFromDB.getNumDVs());
  Assert.assertEquals(longData.getBitVectors(),longDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringTableStatistics() throws Exception {
  createMockTable(STRING_COL,STRING_TYPE);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockTblColStatsDesc();
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  ColumnStatistics statsFromDB=store.getTableColumnStatistics(DB,TBL,Arrays.asList(STRING_COL));
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.getStatsDesc().getTableName());
  Assert.assertTrue(statsFromDB.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
  Assert.assertEquals(stringData.getBitVectors(),stringDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doublePartitionStatistics() throws Exception {
  createMockTableAndPartition(DOUBLE_TYPE,DOUBLE_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,DOUBLE_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=doubleColStatsObjs.get(0);
  DoubleColumnStatsData doubleData=obj.getStatsData().getDoubleStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(DOUBLE_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,dataFromDB.getSetField());
  DoubleColumnStatsData doubleDataFromDB=dataFromDB.getDoubleStats();
  Assert.assertEquals(doubleData.getHighValue(),doubleDataFromDB.getHighValue(),0.01);
  Assert.assertEquals(doubleData.getLowValue(),doubleDataFromDB.getLowValue(),0.01);
  Assert.assertEquals(doubleData.getNumNulls(),doubleDataFromDB.getNumNulls());
  Assert.assertEquals(doubleData.getNumDVs(),doubleDataFromDB.getNumDVs());
  Assert.assertEquals(doubleData.getBitVectors(),doubleDataFromDB.getBitVectors());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void stringPartitionStatistics() throws Exception {
  createMockTableAndPartition(STRING_TYPE,STRING_VAL);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=getMockPartColStatsDesc(PART_KEY,STRING_VAL);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=stringColStatsObjs.get(0);
  StringColumnStatsData stringData=obj.getStatsData().getStringStats();
  stats.addToStatsObj(obj);
  List<String> parVals=new ArrayList<String>();
  parVals.add(STRING_VAL);
  store.updatePartitionColumnStatistics(stats,parVals);
  List<String> partNames=new ArrayList<String>();
  partNames.add(desc.getPartName());
  List<String> colNames=new ArrayList<String>();
  colNames.add(obj.getColName());
  List<ColumnStatistics> statsFromDB=store.getPartitionColumnStatistics(DB,TBL,partNames,colNames);
  Assert.assertEquals(1,statsFromDB.size());
  Assert.assertEquals(desc.getLastAnalyzed(),statsFromDB.get(0).getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(DB,statsFromDB.get(0).getStatsDesc().getDbName());
  Assert.assertEquals(TBL,statsFromDB.get(0).getStatsDesc().getTableName());
  Assert.assertFalse(statsFromDB.get(0).getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,statsFromDB.get(0).getStatsObjSize());
  ColumnStatisticsObj objFromDB=statsFromDB.get(0).getStatsObj().get(0);
  ColumnStatisticsData dataFromDB=objFromDB.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,dataFromDB.getSetField());
  StringColumnStatsData stringDataFromDB=dataFromDB.getStringStats();
  Assert.assertEquals(stringData.getMaxColLen(),stringDataFromDB.getMaxColLen());
  Assert.assertEquals(stringData.getAvgColLen(),stringDataFromDB.getAvgColLen(),0.01);
  Assert.assertEquals(stringData.getNumNulls(),stringDataFromDB.getNumNulls());
  Assert.assertEquals(stringData.getNumDVs(),stringDataFromDB.getNumDVs());
  Assert.assertEquals(stringData.getBitVectors(),stringDataFromDB.getBitVectors());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreCached </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listGetDropPartitionNames() throws Exception {
  String dbName="default";
  String tableName="listParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  partCols.add(new FieldSchema("region","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  String[][] partVals=new String[][]{{"today","north america"},{"tomorrow","europe"}};
  for (  String[] pv : partVals) {
    List<String> vals=new ArrayList<String>();
    for (    String v : pv)     vals.add(v);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + pv[0] + "/region="+ pv[1]);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
  }
  List<String> names=store.listPartitionNames(dbName,tableName,(short)-1);
  Assert.assertEquals(2,names.size());
  String[] resultNames=names.toArray(new String[names.size()]);
  Arrays.sort(resultNames);
  Assert.assertArrayEquals(resultNames,new String[]{"pc=today/region=north america","pc=tomorrow/region=europe"});
  List<Partition> parts=store.getPartitionsByNames(dbName,tableName,names);
  Assert.assertArrayEquals(partVals[0],parts.get(0).getValues().toArray(new String[2]));
  Assert.assertArrayEquals(partVals[1],parts.get(1).getValues().toArray(new String[2]));
  store.dropPartitions(dbName,tableName,names);
  List<Partition> afterDropParts=store.getPartitions(dbName,tableName,-1);
  Assert.assertEquals(0,afterDropParts.size());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void booleanTableStatistics() throws Exception {
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String boolcol="boolcol";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema(boolcol,"boolean","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table(tableName,dbname,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  long trues=37;
  long falses=12;
  long booleanNulls=2;
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(boolcol);
  obj.setColType("boolean");
  ColumnStatisticsData data=new ColumnStatisticsData();
  BooleanColumnStatsData boolData=new BooleanColumnStatsData();
  boolData.setNumTrues(trues);
  boolData.setNumFalses(falses);
  boolData.setNumNulls(booleanNulls);
  data.setBooleanStats(boolData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(1,stats.getStatsObjSize());
  ColumnStatisticsData colData=obj.getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,colData.getSetField());
  boolData=colData.getBooleanStats();
  Assert.assertEquals(trues,boolData.getNumTrues());
  Assert.assertEquals(falses,boolData.getNumFalses());
  Assert.assertEquals(booleanNulls,boolData.getNumNulls());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestHBaseStoreIntegration </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getPartitions() throws Exception {
  String dbName="default";
  String tableName="manyParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> partVals=Arrays.asList("alan","bob","carl","doug","ethan");
  for (  String val : partVals) {
    List<String> vals=new ArrayList<String>();
    vals.add(val);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + val);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
    Partition p=store.getPartition(dbName,tableName,vals);
    Assert.assertEquals("file:/tmp/pc=" + val,p.getSd().getLocation());
  }
  List<Partition> parts=store.getPartitions(dbName,tableName,-1);
  Assert.assertEquals(5,parts.size());
  String[] pv=new String[5];
  for (int i=0; i < 5; i++)   pv[i]=parts.get(i).getValues().get(0);
  Arrays.sort(pv);
  Assert.assertArrayEquals(pv,partVals.toArray(new String[5]));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void tableStatistics() throws Exception {
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statstable";
  String boolcol="boolcol";
  String longcol="longcol";
  String doublecol="doublecol";
  String stringcol="stringcol";
  String binarycol="bincol";
  String decimalcol="deccol";
  long trues=37;
  long falses=12;
  long booleanNulls=2;
  long longHigh=120938479124L;
  long longLow=-12341243213412124L;
  long longNulls=23;
  long longDVs=213L;
  double doubleHigh=123423.23423;
  double doubleLow=0.00001234233;
  long doubleNulls=92;
  long doubleDVs=1234123421L;
  long strMaxLen=1234;
  double strAvgLen=32.3;
  long strNulls=987;
  long strDVs=906;
  long binMaxLen=123412987L;
  double binAvgLen=76.98;
  long binNulls=976998797L;
  Decimal decHigh=new Decimal();
  decHigh.setScale((short)3);
  decHigh.setUnscaled("3876".getBytes());
  Decimal decLow=new Decimal();
  decLow.setScale((short)3);
  decLow.setUnscaled("38".getBytes());
  long decNulls=13;
  long decDVs=923947293L;
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema(boolcol,"boolean","nocomment"));
  cols.add(new FieldSchema(longcol,"long","nocomment"));
  cols.add(new FieldSchema(doublecol,"double","nocomment"));
  cols.add(new FieldSchema(stringcol,"varchar(32)","nocomment"));
  cols.add(new FieldSchema(binarycol,"binary","nocomment"));
  cols.add(new FieldSchema(decimalcol,"decimal(5, 3)","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table(tableName,dbname,"me",(int)now / 1000,(int)now / 1000,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  ColumnStatistics stats=new ColumnStatistics();
  ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
  desc.setLastAnalyzed(now);
  desc.setDbName(dbname);
  desc.setTableName(tableName);
  desc.setIsTblLevel(true);
  stats.setStatsDesc(desc);
  ColumnStatisticsObj obj=new ColumnStatisticsObj();
  obj.setColName(boolcol);
  obj.setColType("boolean");
  ColumnStatisticsData data=new ColumnStatisticsData();
  BooleanColumnStatsData boolData=new BooleanColumnStatsData();
  boolData.setNumTrues(trues);
  boolData.setNumFalses(falses);
  boolData.setNumNulls(booleanNulls);
  data.setBooleanStats(boolData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(longcol);
  obj.setColType("long");
  data=new ColumnStatisticsData();
  LongColumnStatsData longData=new LongColumnStatsData();
  longData.setHighValue(longHigh);
  longData.setLowValue(longLow);
  longData.setNumNulls(longNulls);
  longData.setNumDVs(longDVs);
  data.setLongStats(longData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(doublecol);
  obj.setColType("double");
  data=new ColumnStatisticsData();
  DoubleColumnStatsData doubleData=new DoubleColumnStatsData();
  doubleData.setHighValue(doubleHigh);
  doubleData.setLowValue(doubleLow);
  doubleData.setNumNulls(doubleNulls);
  doubleData.setNumDVs(doubleDVs);
  data.setDoubleStats(doubleData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol,longcol,doublecol));
  Assert.assertEquals(3,stats.getStatsObjSize());
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol));
  Assert.assertEquals(1,stats.getStatsObjSize());
  stats=new ColumnStatistics();
  stats.setStatsDesc(desc);
  obj=new ColumnStatisticsObj();
  obj.setColName(stringcol);
  obj.setColType("string");
  data=new ColumnStatisticsData();
  StringColumnStatsData strData=new StringColumnStatsData();
  strData.setMaxColLen(strMaxLen);
  strData.setAvgColLen(strAvgLen);
  strData.setNumNulls(strNulls);
  strData.setNumDVs(strDVs);
  data.setStringStats(strData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(binarycol);
  obj.setColType("binary");
  data=new ColumnStatisticsData();
  BinaryColumnStatsData binData=new BinaryColumnStatsData();
  binData.setMaxColLen(binMaxLen);
  binData.setAvgColLen(binAvgLen);
  binData.setNumNulls(binNulls);
  data.setBinaryStats(binData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  obj=new ColumnStatisticsObj();
  obj.setColName(decimalcol);
  obj.setColType("decimal(5,3)");
  data=new ColumnStatisticsData();
  DecimalColumnStatsData decData=new DecimalColumnStatsData();
  LOG.debug("Setting decimal high value to " + decHigh.getScale() + " <"+ new String(decHigh.getUnscaled())+ ">");
  decData.setHighValue(decHigh);
  decData.setLowValue(decLow);
  decData.setNumNulls(decNulls);
  decData.setNumDVs(decDVs);
  data.setDecimalStats(decData);
  obj.setStatsData(data);
  stats.addToStatsObj(obj);
  store.updateTableColumnStatistics(stats);
  stats=store.getTableColumnStatistics(dbname,tableName,Arrays.asList(boolcol,longcol,doublecol,stringcol,binarycol,decimalcol));
  Assert.assertEquals(now,stats.getStatsDesc().getLastAnalyzed());
  Assert.assertEquals(dbname,stats.getStatsDesc().getDbName());
  Assert.assertEquals(tableName,stats.getStatsDesc().getTableName());
  Assert.assertTrue(stats.getStatsDesc().isIsTblLevel());
  Assert.assertEquals(6,stats.getStatsObjSize());
  ColumnStatisticsData colData=stats.getStatsObj().get(0).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BOOLEAN_STATS,colData.getSetField());
  boolData=colData.getBooleanStats();
  Assert.assertEquals(trues,boolData.getNumTrues());
  Assert.assertEquals(falses,boolData.getNumFalses());
  Assert.assertEquals(booleanNulls,boolData.getNumNulls());
  colData=stats.getStatsObj().get(1).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.LONG_STATS,colData.getSetField());
  longData=colData.getLongStats();
  Assert.assertEquals(longHigh,longData.getHighValue());
  Assert.assertEquals(longLow,longData.getLowValue());
  Assert.assertEquals(longNulls,longData.getNumNulls());
  Assert.assertEquals(longDVs,longData.getNumDVs());
  colData=stats.getStatsObj().get(2).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DOUBLE_STATS,colData.getSetField());
  doubleData=colData.getDoubleStats();
  Assert.assertEquals(doubleHigh,doubleData.getHighValue(),0.01);
  Assert.assertEquals(doubleLow,doubleData.getLowValue(),0.01);
  Assert.assertEquals(doubleNulls,doubleData.getNumNulls());
  Assert.assertEquals(doubleDVs,doubleData.getNumDVs());
  colData=stats.getStatsObj().get(3).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.STRING_STATS,colData.getSetField());
  strData=colData.getStringStats();
  Assert.assertEquals(strMaxLen,strData.getMaxColLen());
  Assert.assertEquals(strAvgLen,strData.getAvgColLen(),0.01);
  Assert.assertEquals(strNulls,strData.getNumNulls());
  Assert.assertEquals(strDVs,strData.getNumDVs());
  colData=stats.getStatsObj().get(4).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.BINARY_STATS,colData.getSetField());
  binData=colData.getBinaryStats();
  Assert.assertEquals(binMaxLen,binData.getMaxColLen());
  Assert.assertEquals(binAvgLen,binData.getAvgColLen(),0.01);
  Assert.assertEquals(binNulls,binData.getNumNulls());
  colData=stats.getStatsObj().get(5).getStatsData();
  Assert.assertEquals(ColumnStatisticsData._Fields.DECIMAL_STATS,colData.getSetField());
  decData=colData.getDecimalStats();
  Assert.assertEquals(decHigh,decData.getHighValue());
  Assert.assertEquals(decLow,decData.getLowValue());
  Assert.assertEquals(decNulls,decData.getNumNulls());
  Assert.assertEquals(decDVs,decData.getNumDVs());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listPartitionsWithPs() throws Exception {
  String dbName="default";
  String tableName="listPartitionsWithPs";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  partCols.add(new FieldSchema("region","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  String[][] partVals=new String[][]{{"today","north america"},{"today","europe"},{"tomorrow","north america"},{"tomorrow","europe"}};
  for (  String[] pv : partVals) {
    List<String> vals=new ArrayList<String>();
    for (    String v : pv)     vals.add(v);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/ds=" + pv[0] + "/region="+ pv[1]);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
  }
  List<String> partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList(partVals[0]),(short)-1);
  Assert.assertEquals(1,partitionNames.size());
  Assert.assertEquals("ds=today/region=north america",partitionNames.get(0));
  partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList(partVals[0][0]),(short)-1);
  Assert.assertEquals(2,partitionNames.size());
  String[] names=partitionNames.toArray(new String[partitionNames.size()]);
  Arrays.sort(names);
  Assert.assertArrayEquals(new String[]{"ds=today/region=europe","ds=today/region=north america"},names);
  partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList("today","*"),(short)-1);
  Assert.assertEquals(2,partitionNames.size());
  names=partitionNames.toArray(new String[partitionNames.size()]);
  Arrays.sort(names);
  Assert.assertArrayEquals(new String[]{"ds=today/region=europe","ds=today/region=north america"},names);
  partitionNames=store.listPartitionNamesPs(dbName,tableName,Arrays.asList("*","europe"),(short)-1);
  Assert.assertEquals(2,partitionNames.size());
  names=partitionNames.toArray(new String[partitionNames.size()]);
  Arrays.sort(names);
  Assert.assertArrayEquals(new String[]{"ds=today/region=europe","ds=tomorrow/region=europe"},names);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void userToRoleMapOnDrop() throws Exception {
  String roleName1="utrmod1";
  store.addRole(roleName1,"me");
  String roleName2="utrmod2";
  store.addRole(roleName2,"me");
  String user1="pebbles";
  String user2="bam-bam";
  Role role1=store.getRole(roleName1);
  Role role2=store.getRole(roleName2);
  store.grantRole(role1,user1,PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role1,roleName2,PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role1,user2,PrincipalType.USER,"bob",PrincipalType.USER,false);
  List<String> roles=HBaseReadWrite.getInstance().getUserRoles(user2);
  Assert.assertEquals(2,roles.size());
  String[] roleNames=roles.toArray(new String[roles.size()]);
  Arrays.sort(roleNames);
  Assert.assertArrayEquals(new String[]{roleName1,roleName2},roleNames);
  store.removeRole(roleName2);
  HBaseReadWrite.setConf(conf);
  roles=HBaseReadWrite.getInstance().getUserRoles(user1);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName1,roles.get(0));
  roles=HBaseReadWrite.getInstance().getUserRoles(user2);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName1,roles.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void dropTable() throws Exception {
  String tableName="dtable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table(tableName,"default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  Table t=store.getTable("default",tableName);
  Assert.assertNotNull(t);
  store.dropTable("default",tableName);
  Assert.assertNull(store.getTable("default",tableName));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dropRole() throws Exception {
  String roleName="anotherrole";
  store.addRole(roleName,"me");
  Role r=store.getRole(roleName);
  Assert.assertEquals(roleName,r.getRoleName());
  store.removeRole(roleName);
  thrown.expect(NoSuchObjectException.class);
  store.getRole(roleName);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void alterTable() throws Exception {
  String tableName="alttable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  Table table=new Table(tableName,"default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  startTime+=10;
  table.setLastAccessTime(startTime);
  LOG.debug("XXX alter table test");
  store.alterTable("default",tableName,table);
  Table t=store.getTable("default",tableName);
  LOG.debug("Alter table time " + t.getLastAccessTime());
  Assert.assertEquals(1,t.getSd().getColsSize());
  Assert.assertEquals("col1",t.getSd().getCols().get(0).getName());
  Assert.assertEquals("int",t.getSd().getCols().get(0).getType());
  Assert.assertEquals("nocomment",t.getSd().getCols().get(0).getComment());
  Assert.assertEquals("serde",t.getSd().getSerdeInfo().getName());
  Assert.assertEquals("seriallib",t.getSd().getSerdeInfo().getSerializationLib());
  Assert.assertEquals("file:/tmp",t.getSd().getLocation());
  Assert.assertEquals("input",t.getSd().getInputFormat());
  Assert.assertEquals("output",t.getSd().getOutputFormat());
  Assert.assertEquals("me",t.getOwner());
  Assert.assertEquals("default",t.getDbName());
  Assert.assertEquals(tableName,t.getTableName());
  Assert.assertEquals(startTime,t.getLastAccessTime());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getDbsRegex() throws Exception {
  String[] dbNames=new String[3];
  for (int i=0; i < dbNames.length; i++) {
    dbNames[i]="db" + i;
    Database db=new Database(dbNames[i],"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
  }
  List<String> dbs=store.getDatabases("db1|db2");
  Assert.assertEquals(2,dbs.size());
  String[] namesFromStore=dbs.toArray(new String[2]);
  Arrays.sort(namesFromStore);
  Assert.assertArrayEquals(Arrays.copyOfRange(dbNames,1,3),namesFromStore);
  dbs=store.getDatabases("db*");
  Assert.assertEquals(3,dbs.size());
  namesFromStore=dbs.toArray(new String[3]);
  Arrays.sort(namesFromStore);
  Assert.assertArrayEquals(dbNames,namesFromStore);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getFuncsRegex() throws Exception {
  String dbname="default";
  int now=(int)(System.currentTimeMillis() / 1000);
  String[] funcNames=new String[3];
  for (int i=0; i < funcNames.length; i++) {
    funcNames[i]="func" + i;
    store.createFunction(new Function(funcNames[i],dbname,"o.a.h.h.myfunc","me",PrincipalType.USER,now,FunctionType.JAVA,Arrays.asList(new ResourceUri(ResourceType.JAR,"file:/tmp/somewhere"))));
  }
  List<String> funcs=store.getFunctions(dbname,"func1|func2");
  Assert.assertEquals(2,funcs.size());
  String[] namesFromStore=funcs.toArray(new String[2]);
  Arrays.sort(namesFromStore);
  Assert.assertArrayEquals(Arrays.copyOfRange(funcNames,1,3),namesFromStore);
  funcs=store.getFunctions(dbname,"func*");
  Assert.assertEquals(3,funcs.size());
  namesFromStore=funcs.toArray(new String[3]);
  Arrays.sort(namesFromStore);
  Assert.assertArrayEquals(funcNames,namesFromStore);
  funcs=store.getFunctions("nosuchdb","func*");
  Assert.assertEquals(0,funcs.size());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listTableGrants() throws Exception {
  String dbName="ltg_db";
  String[] tableNames=new String[]{"ltg_t1","ltg_t2"};
  try {
    Database db=new Database(dbName,"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
    int startTime=(int)(System.currentTimeMillis() / 1000);
    List<FieldSchema> cols=new ArrayList<FieldSchema>();
    cols.add(new FieldSchema("col1","int","nocomment"));
    SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
    StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
    Table table=new Table(tableNames[0],dbName,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
    store.createTable(table);
    table=new Table(tableNames[1],dbName,"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
    store.createTable(table);
    String[] roleNames=new String[]{"ltg_role1","ltg_role2"};
    String[] userNames=new String[]{"gandalf","radagast"};
    store.addRole(roleNames[0],"me");
    store.addRole(roleNames[1],"me");
    int now=(int)(System.currentTimeMillis() / 1000);
    Role role1=store.getRole(roleNames[0]);
    Role role2=store.getRole(roleNames[1]);
    store.grantRole(role1,userNames[0],PrincipalType.USER,"bob",PrincipalType.USER,false);
    store.grantRole(role1,roleNames[1],PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
    store.grantRole(role2,userNames[1],PrincipalType.USER,"bob",PrincipalType.USER,false);
    List<HiveObjectPrivilege> privileges=new ArrayList<HiveObjectPrivilege>();
    HiveObjectRef hiveObjRef=new HiveObjectRef(HiveObjectType.TABLE,dbName,tableNames[0],null,null);
    PrivilegeGrantInfo grantInfo=new PrivilegeGrantInfo("read",now,"me",PrincipalType.USER,false);
    HiveObjectPrivilege hop=new HiveObjectPrivilege(hiveObjRef,userNames[0],PrincipalType.USER,grantInfo);
    privileges.add(hop);
    grantInfo=new PrivilegeGrantInfo("write",now,"me",PrincipalType.USER,true);
    hop=new HiveObjectPrivilege(hiveObjRef,roleNames[0],PrincipalType.ROLE,grantInfo);
    privileges.add(hop);
    PrivilegeBag pBag=new PrivilegeBag(privileges);
    store.grantPrivileges(pBag);
    List<HiveObjectPrivilege> hops=store.listAllTableGrants(roleNames[0],PrincipalType.ROLE,dbName,tableNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listAllTableGrants(userNames[0],PrincipalType.USER,dbName,tableNames[0]);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listAllTableGrants(roleNames[1],PrincipalType.ROLE,dbName,tableNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(userNames[1],PrincipalType.USER,dbName,tableNames[0]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(roleNames[0],PrincipalType.ROLE,dbName,tableNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listAllTableGrants(userNames[0],PrincipalType.USER,dbName,tableNames[1]);
    Assert.assertEquals(0,hops.size());
    hops=store.listTableGrantsAll(dbName,tableNames[0]);
    Assert.assertEquals(2,hops.size());
    boolean sawUser=false, sawRole=false;
    for (    HiveObjectPrivilege h : hops) {
      if (h.getPrincipalName().equals(userNames[0])) {
        Assert.assertEquals(PrincipalType.USER,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.TABLE,h.getHiveObject().getObjectType());
        Assert.assertEquals("read",h.getGrantInfo().getPrivilege());
        sawUser=true;
      }
 else       if (h.getPrincipalName().equals(roleNames[0])) {
        Assert.assertEquals(PrincipalType.ROLE,h.getPrincipalType());
        Assert.assertEquals(HiveObjectType.TABLE,h.getHiveObject().getObjectType());
        Assert.assertEquals("write",h.getGrantInfo().getPrivilege());
        sawRole=true;
      }
    }
    Assert.assertTrue(sawUser && sawRole);
    hops=store.listPrincipalTableGrantsAll(roleNames[0],PrincipalType.ROLE);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.ROLE,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("write",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalTableGrantsAll(userNames[0],PrincipalType.USER);
    Assert.assertEquals(1,hops.size());
    Assert.assertEquals(PrincipalType.USER,hops.get(0).getPrincipalType());
    Assert.assertEquals(HiveObjectType.TABLE,hops.get(0).getHiveObject().getObjectType());
    Assert.assertEquals("read",hops.get(0).getGrantInfo().getPrivilege());
    hops=store.listPrincipalDBGrantsAll(roleNames[1],PrincipalType.ROLE);
    Assert.assertEquals(0,hops.size());
    hops=store.listPrincipalDBGrantsAll(userNames[1],PrincipalType.USER);
    Assert.assertEquals(0,hops.size());
  }
  finally {
    store.dropTable(dbName,tableNames[0]);
    store.dropTable(dbName,tableNames[1]);
    store.dropDatabase(dbName);
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void addPartitions() throws Exception {
  String dbName="default";
  String tableName="addParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> partVals=Arrays.asList("alan","bob","carl","doug","ethan");
  List<Partition> partitions=new ArrayList<Partition>();
  for (  String val : partVals) {
    List<String> vals=new ArrayList<String>();
    vals.add(val);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + val);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    partitions.add(part);
  }
  store.addPartitions(dbName,tableName,partitions);
  List<String> partNames=store.listPartitionNames(dbName,tableName,(short)-1);
  Assert.assertEquals(5,partNames.size());
  String[] names=partNames.toArray(new String[partNames.size()]);
  Arrays.sort(names);
  String[] canonicalNames=partVals.toArray(new String[partVals.size()]);
  for (int i=0; i < canonicalNames.length; i++)   canonicalNames[i]="pc=" + canonicalNames[i];
  Assert.assertArrayEquals(canonicalNames,names);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getAllTables() throws Exception {
  String dbNames[]=new String[]{"db0","db1"};
  String tableNames[]=new String[]{"curly","larry","moe"};
  for (int i=0; i < dbNames.length; i++) {
    store.createDatabase(new Database(dbNames[i],"no description","file:///tmp",emptyParameters));
  }
  for (int i=0; i < dbNames.length; i++) {
    for (int j=0; j < tableNames.length; j++) {
      int startTime=(int)(System.currentTimeMillis() / 1000);
      List<FieldSchema> cols=new ArrayList<FieldSchema>();
      cols.add(new FieldSchema("col1","int","nocomment"));
      SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
      StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
      Table table=new Table(tableNames[j],dbNames[i],"me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
      store.createTable(table);
    }
  }
  List<String> fetchedNames=store.getAllTables(dbNames[0]);
  Assert.assertEquals(3,fetchedNames.size());
  String[] sortedFetchedNames=fetchedNames.toArray(new String[fetchedNames.size()]);
  Arrays.sort(sortedFetchedNames);
  Assert.assertArrayEquals(tableNames,sortedFetchedNames);
  List<String> regexNames=store.getTables(dbNames[0],"*y");
  Assert.assertEquals(2,regexNames.size());
  String[] sortedRegexNames=regexNames.toArray(new String[regexNames.size()]);
  Arrays.sort(sortedRegexNames);
  Assert.assertArrayEquals(Arrays.copyOfRange(tableNames,0,2),sortedRegexNames);
  List<Table> fetchedTables=store.getTableObjectsByName(dbNames[1],Arrays.asList(Arrays.copyOfRange(tableNames,1,3)));
  Assert.assertEquals(2,fetchedTables.size());
  sortedFetchedNames=new String[fetchedTables.size()];
  for (int i=0; i < fetchedTables.size(); i++) {
    sortedFetchedNames[i]=fetchedTables.get(i).getTableName();
  }
  Arrays.sort(sortedFetchedNames);
  Assert.assertArrayEquals(Arrays.copyOfRange(tableNames,1,3),sortedFetchedNames);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void partitionStatistics() throws Exception {
  long now=System.currentTimeMillis();
  String dbname="default";
  String tableName="statspart";
  String[] partNames={"ds=today","ds=yesterday"};
  String[] partVals={"today","yesterday"};
  String boolcol="boolcol";
  String longcol="longcol";
  String doublecol="doublecol";
  String stringcol="stringcol";
  String binarycol="bincol";
  String decimalcol="deccol";
  long trues=37;
  long falses=12;
  long booleanNulls=2;
  long strMaxLen=1234;
  double strAvgLen=32.3;
  long strNulls=987;
  long strDVs=906;
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema(boolcol,"boolean","nocomment"));
  cols.add(new FieldSchema(longcol,"long","nocomment"));
  cols.add(new FieldSchema(doublecol,"double","nocomment"));
  cols.add(new FieldSchema(stringcol,"varchar(32)","nocomment"));
  cols.add(new FieldSchema(binarycol,"binary","nocomment"));
  cols.add(new FieldSchema(decimalcol,"decimal(5, 3)","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("ds","string",""));
  Table table=new Table(tableName,dbname,"me",(int)now / 1000,(int)now / 1000,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  for (  String partVal : partVals) {
    Partition part=new Partition(Arrays.asList(partVal),dbname,tableName,(int)now / 1000,(int)now / 1000,sd,emptyParameters);
    store.addPartition(part);
  }
  for (int i=0; i < partNames.length; i++) {
    ColumnStatistics stats=new ColumnStatistics();
    ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
    desc.setLastAnalyzed(now);
    desc.setDbName(dbname);
    desc.setTableName(tableName);
    desc.setIsTblLevel(false);
    desc.setPartName(partNames[i]);
    stats.setStatsDesc(desc);
    ColumnStatisticsObj obj=new ColumnStatisticsObj();
    obj.setColName(boolcol);
    obj.setColType("boolean");
    ColumnStatisticsData data=new ColumnStatisticsData();
    BooleanColumnStatsData boolData=new BooleanColumnStatsData();
    boolData.setNumTrues(trues);
    boolData.setNumFalses(falses);
    boolData.setNumNulls(booleanNulls);
    data.setBooleanStats(boolData);
    obj.setStatsData(data);
    stats.addToStatsObj(obj);
    store.updatePartitionColumnStatistics(stats,Arrays.asList(partVals[i]));
  }
  List<ColumnStatistics> statsList=store.getPartitionColumnStatistics(dbname,tableName,Arrays.asList(partNames),Arrays.asList(boolcol));
  Assert.assertEquals(2,statsList.size());
  for (int i=0; i < partNames.length; i++) {
    Assert.assertEquals(1,statsList.get(i).getStatsObjSize());
  }
  for (int i=0; i < partNames.length; i++) {
    ColumnStatistics stats=new ColumnStatistics();
    ColumnStatisticsDesc desc=new ColumnStatisticsDesc();
    desc.setLastAnalyzed(now);
    desc.setDbName(dbname);
    desc.setTableName(tableName);
    desc.setIsTblLevel(false);
    desc.setPartName(partNames[i]);
    stats.setStatsDesc(desc);
    ColumnStatisticsObj obj=new ColumnStatisticsObj();
    obj.setColName(stringcol);
    obj.setColType("string");
    ColumnStatisticsData data=new ColumnStatisticsData();
    StringColumnStatsData strData=new StringColumnStatsData();
    strData.setMaxColLen(strMaxLen);
    strData.setAvgColLen(strAvgLen);
    strData.setNumNulls(strNulls);
    strData.setNumDVs(strDVs);
    data.setStringStats(strData);
    obj.setStatsData(data);
    stats.addToStatsObj(obj);
    store.updatePartitionColumnStatistics(stats,Arrays.asList(partVals[i]));
  }
  statsList=store.getPartitionColumnStatistics(dbname,tableName,Arrays.asList(partNames),Arrays.asList(boolcol));
  Assert.assertEquals(2,statsList.size());
  for (int i=0; i < partNames.length; i++) {
    Assert.assertEquals(1,statsList.get(i).getStatsObjSize());
  }
  statsList=store.getPartitionColumnStatistics(dbname,tableName,Arrays.asList(partNames),Arrays.asList(boolcol,stringcol));
  Assert.assertEquals(2,statsList.size());
  for (int i=0; i < partNames.length; i++) {
    Assert.assertEquals(2,statsList.get(i).getStatsObjSize());
    Assert.assertEquals(booleanNulls,statsList.get(i).getStatsObj().get(0).getStatsData().getBooleanStats().getNumNulls());
    Assert.assertEquals(strDVs,statsList.get(i).getStatsObj().get(1).getStatsData().getStringStats().getNumDVs());
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void userToRoleMap() throws Exception {
  String roleName1="utrm1";
  store.addRole(roleName1,"me");
  String roleName2="utrm2";
  store.addRole(roleName2,"me");
  String user1="wilma";
  String user2="betty";
  Role role1=store.getRole(roleName1);
  Role role2=store.getRole(roleName2);
  store.grantRole(role1,user1,PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role1,roleName2,PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  List<String> roles=HBaseReadWrite.getInstance().getUserRoles(user1);
  Assert.assertEquals(2,roles.size());
  String[] roleNames=roles.toArray(new String[roles.size()]);
  Arrays.sort(roleNames);
  Assert.assertArrayEquals(new String[]{roleName1,roleName2},roleNames);
  store.grantRole(role2,user1,PrincipalType.USER,"admin",PrincipalType.ROLE,false);
  store.grantRole(role1,user2,PrincipalType.USER,"bob",PrincipalType.USER,false);
  HBaseReadWrite.setConf(conf);
  roles=HBaseReadWrite.getInstance().getUserRoles(user2);
  Assert.assertEquals(2,roles.size());
  roleNames=roles.toArray(new String[roles.size()]);
  Arrays.sort(roleNames);
  Assert.assertArrayEquals(new String[]{roleName1,roleName2},roleNames);
  store.revokeRole(role1,roleName2,PrincipalType.ROLE,false);
  roles=HBaseReadWrite.getInstance().getUserRoles(user1);
  Assert.assertEquals(2,roles.size());
  roleNames=roles.toArray(new String[roles.size()]);
  Arrays.sort(roleNames);
  Assert.assertArrayEquals(new String[]{roleName1,roleName2},roleNames);
  roles=HBaseReadWrite.getInstance().getUserRoles(user2);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName1,roles.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createPartition() throws Exception {
  String dbName="default";
  String tableName="myparttable";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> vals=new ArrayList<String>();
  vals.add("fred");
  StorageDescriptor psd=new StorageDescriptor(sd);
  psd.setLocation("file:/tmp/pc=fred");
  Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
  store.addPartition(part);
  Partition p=store.getPartition(dbName,tableName,vals);
  Assert.assertEquals(1,p.getSd().getColsSize());
  Assert.assertEquals("col1",p.getSd().getCols().get(0).getName());
  Assert.assertEquals("int",p.getSd().getCols().get(0).getType());
  Assert.assertEquals("nocomment",p.getSd().getCols().get(0).getComment());
  Assert.assertEquals("serde",p.getSd().getSerdeInfo().getName());
  Assert.assertEquals("seriallib",p.getSd().getSerdeInfo().getSerializationLib());
  Assert.assertEquals("file:/tmp/pc=fred",p.getSd().getLocation());
  Assert.assertEquals("input",p.getSd().getInputFormat());
  Assert.assertEquals("output",p.getSd().getOutputFormat());
  Assert.assertEquals(dbName,p.getDbName());
  Assert.assertEquals(tableName,p.getTableName());
  Assert.assertEquals(1,p.getValuesSize());
  Assert.assertEquals("fred",p.getValues().get(0));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createRole() throws Exception {
  int now=(int)System.currentTimeMillis() / 1000;
  String roleName="myrole";
  store.addRole(roleName,"me");
  Role r=store.getRole(roleName);
  Assert.assertEquals(roleName,r.getRoleName());
  Assert.assertEquals("me",r.getOwnerName());
  Assert.assertTrue(now <= r.getCreateTime());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getAllDbs() throws Exception {
  String[] dbNames=new String[3];
  for (int i=0; i < dbNames.length; i++) {
    dbNames[i]="db" + i;
    Database db=new Database(dbNames[i],"no description","file:///tmp",emptyParameters);
    store.createDatabase(db);
  }
  List<String> dbs=store.getAllDatabases();
  Assert.assertEquals(3,dbs.size());
  String[] namesFromStore=dbs.toArray(new String[3]);
  Arrays.sort(namesFromStore);
  Assert.assertArrayEquals(dbNames,namesFromStore);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void grantRevokeRoles() throws Exception {
  int now=(int)(System.currentTimeMillis() / 1000);
  String roleName1="role1";
  store.addRole(roleName1,"me");
  String roleName2="role2";
  store.addRole(roleName2,"me");
  Role role1=store.getRole(roleName1);
  Role role2=store.getRole(roleName2);
  store.grantRole(role1,"fred",PrincipalType.USER,"bob",PrincipalType.USER,false);
  store.grantRole(role2,roleName1,PrincipalType.ROLE,"admin",PrincipalType.ROLE,true);
  store.grantRole(role2,"fred",PrincipalType.USER,"admin",PrincipalType.ROLE,false);
  List<Role> roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(3,roles.size());
  boolean sawRole1=false, sawRole2=false, sawPublic=false;
  for (  Role role : roles) {
    if (role.getRoleName().equals(roleName1)) {
      sawRole1=true;
    }
 else     if (role.getRoleName().equals(roleName2)) {
      sawRole2=true;
    }
 else     if (role.getRoleName().equals(HiveMetaStore.PUBLIC)) {
      sawPublic=true;
    }
 else {
      Assert.fail("Unknown role name " + role.getRoleName());
    }
  }
  Assert.assertTrue(sawRole1 && sawRole2 && sawPublic);
  roles=store.listRoles("fred",PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Role role=roles.get(0);
  Assert.assertEquals(roleName2,role.getRoleName());
  List<RolePrincipalGrant> grants=store.listRoleMembers(roleName1);
  Assert.assertEquals(1,grants.size());
  Assert.assertEquals("fred",grants.get(0).getPrincipalName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getPrincipalType());
  Assert.assertTrue("Expected grant time of " + now + " got "+ grants.get(0).getGrantTime(),grants.get(0).getGrantTime() >= now);
  Assert.assertEquals("bob",grants.get(0).getGrantorName());
  Assert.assertEquals(PrincipalType.USER,grants.get(0).getGrantorPrincipalType());
  Assert.assertFalse(grants.get(0).isGrantOption());
  grants=store.listRoleMembers(roleName2);
  Assert.assertEquals(2,grants.size());
  boolean sawFred=false;
  sawRole1=false;
  for (  RolePrincipalGrant m : grants) {
    if ("fred".equals(m.getPrincipalName()))     sawFred=true;
 else     if (roleName1.equals(m.getPrincipalName()))     sawRole1=true;
 else     Assert.fail("Unexpected principal " + m.getPrincipalName());
  }
  Assert.assertTrue(sawFred && sawRole1);
  store.revokeRole(role2,roleName1,PrincipalType.ROLE,true);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(roleName2,roles.get(0).getRoleName());
  grants=store.listRoleMembers(roleName1);
  Assert.assertFalse(grants.get(0).isGrantOption());
  store.removeRole(roleName1);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(2,roles.size());
  sawRole2=sawPublic=false;
  for (  Role m : roles) {
    if (m.getRoleName().equals(roleName2))     sawRole2=true;
 else     if (m.getRoleName().equals(HiveMetaStore.PUBLIC))     sawPublic=true;
 else     Assert.fail("Unknown role " + m.getRoleName());
  }
  Assert.assertTrue(sawRole2 && sawPublic);
  roles=store.listRoles(roleName1,PrincipalType.ROLE);
  Assert.assertEquals(0,roles.size());
  store.revokeRole(role2,"fred",PrincipalType.USER,false);
  roles=store.listRoles("fred",PrincipalType.USER);
  Assert.assertEquals(1,roles.size());
  Assert.assertEquals(HiveMetaStore.PUBLIC,roles.get(0).getRoleName());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void listPartitions() throws Exception {
  String dbName="default";
  String tableName="listParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  partCols.add(new FieldSchema("region","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  String[][] partVals=new String[][]{{"today","north america"},{"tomorrow","europe"}};
  for (  String[] pv : partVals) {
    List<String> vals=new ArrayList<String>();
    for (    String v : pv)     vals.add(v);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + pv[0] + "/region="+ pv[1]);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
  }
  List<String> names=store.listPartitionNames(dbName,tableName,(short)-1);
  Assert.assertEquals(2,names.size());
  String[] resultNames=names.toArray(new String[names.size()]);
  Arrays.sort(resultNames);
  Assert.assertArrayEquals(resultNames,new String[]{"pc=today/region=north america","pc=tomorrow/region=europe"});
  List<Partition> parts=store.getPartitionsByNames(dbName,tableName,names);
  Assert.assertArrayEquals(partVals[0],parts.get(0).getValues().toArray(new String[2]));
  Assert.assertArrayEquals(partVals[1],parts.get(1).getValues().toArray(new String[2]));
  store.dropPartitions(dbName,tableName,names);
  List<Partition> afterDropParts=store.getPartitions(dbName,tableName,-1);
  Assert.assertEquals(0,afterDropParts.size());
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void dropDb() throws Exception {
  String dbname="anotherdb";
  Database db=new Database(dbname,"no description","file:///tmp",emptyParameters);
  store.createDatabase(db);
  Database d=store.getDatabase(dbname);
  Assert.assertNotNull(d);
  store.dropDatabase(dbname);
  thrown.expect(NoSuchObjectException.class);
  store.getDatabase(dbname);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.hbase.TestStorageDescriptorSharing </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createManyPartitions() throws Exception {
  String dbName="default";
  String tableName="manyParts";
  int startTime=(int)(System.currentTimeMillis() / 1000);
  List<FieldSchema> cols=new ArrayList<FieldSchema>();
  cols.add(new FieldSchema("col1","int","nocomment"));
  SerDeInfo serde=new SerDeInfo("serde","seriallib",null);
  StorageDescriptor sd=new StorageDescriptor(cols,"file:/tmp","input","output",false,0,serde,null,null,emptyParameters);
  List<FieldSchema> partCols=new ArrayList<FieldSchema>();
  partCols.add(new FieldSchema("pc","string",""));
  Table table=new Table(tableName,dbName,"me",startTime,startTime,0,sd,partCols,emptyParameters,null,null,null);
  store.createTable(table);
  List<String> partVals=Arrays.asList("alan","bob","carl","doug","ethan");
  for (  String val : partVals) {
    List<String> vals=new ArrayList<String>();
    vals.add(val);
    StorageDescriptor psd=new StorageDescriptor(sd);
    psd.setLocation("file:/tmp/pc=" + val);
    Partition part=new Partition(vals,dbName,tableName,startTime,startTime,psd,emptyParameters);
    store.addPartition(part);
    Partition p=store.getPartition(dbName,tableName,vals);
    Assert.assertEquals("file:/tmp/pc=" + val,p.getSd().getLocation());
  }
  Assert.assertEquals(1,HBaseReadWrite.getInstance().countStorageDescriptor());
  String tableName2="differentTable";
  sd=new StorageDescriptor(cols,"file:/tmp","input2","output",false,0,serde,null,null,emptyParameters);
  table=new Table(tableName2,"default","me",startTime,startTime,0,sd,null,emptyParameters,null,null,null);
  store.createTable(table);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  store.dropPartition(dbName,tableName,Arrays.asList(partVals.get(0)));
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  table=store.getTable(dbName,tableName2);
  byte[] sdHash=HBaseUtils.hashStorageDescriptor(table.getSd(),md);
  table.setLastAccessTime(startTime + 1);
  store.alterTable(dbName,tableName2,table);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  table=store.getTable(dbName,tableName2);
  byte[] alteredHash=HBaseUtils.hashStorageDescriptor(table.getSd(),md);
  Assert.assertArrayEquals(sdHash,alteredHash);
  table.getSd().setOutputFormat("output_changed");
  store.alterTable(dbName,tableName2,table);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  table=store.getTable(dbName,tableName2);
  alteredHash=HBaseUtils.hashStorageDescriptor(table.getSd(),md);
  Assert.assertFalse(Arrays.equals(sdHash,alteredHash));
  Partition part=store.getPartition(dbName,tableName,Arrays.asList(partVals.get(1)));
  sdHash=HBaseUtils.hashStorageDescriptor(part.getSd(),md);
  part.setLastAccessTime(part.getLastAccessTime() + 1);
  store.alterPartition(dbName,tableName,Arrays.asList(partVals.get(1)),part);
  Assert.assertEquals(2,HBaseReadWrite.getInstance().countStorageDescriptor());
  part=store.getPartition(dbName,tableName,Arrays.asList(partVals.get(1)));
  alteredHash=HBaseUtils.hashStorageDescriptor(part.getSd(),md);
  Assert.assertArrayEquals(sdHash,alteredHash);
  part.getSd().setOutputFormat("output_changed_some_more");
  store.alterPartition(dbName,tableName,Arrays.asList(partVals.get(1)),part);
  Assert.assertEquals(3,HBaseReadWrite.getInstance().countStorageDescriptor());
  part=store.getPartition(dbName,tableName,Arrays.asList(partVals.get(1)));
  alteredHash=HBaseUtils.hashStorageDescriptor(part.getSd(),md);
  Assert.assertFalse(Arrays.equals(sdHash,alteredHash));
  List<Partition> parts=store.getPartitions(dbName,tableName,-1);
  sdHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  for (int i=1; i < 3; i++) {
    parts.get(i).setLastAccessTime(97);
  }
  List<List<String>> listPartVals=new ArrayList<List<String>>();
  for (  String pv : partVals.subList(1,partVals.size())) {
    listPartVals.add(Arrays.asList(pv));
  }
  store.alterPartitions(dbName,tableName,listPartVals,parts);
  Assert.assertEquals(3,HBaseReadWrite.getInstance().countStorageDescriptor());
  parts=store.getPartitions(dbName,tableName,-1);
  alteredHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  Assert.assertArrayEquals(sdHash,alteredHash);
  parts=store.getPartitions(dbName,tableName,-1);
  sdHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  for (int i=1; i < 3; i++) {
    parts.get(i).getSd().setOutputFormat("yet_a_different_of");
  }
  store.alterPartitions(dbName,tableName,listPartVals,parts);
  Assert.assertEquals(4,HBaseReadWrite.getInstance().countStorageDescriptor());
  parts=store.getPartitions(dbName,tableName,-1);
  alteredHash=HBaseUtils.hashStorageDescriptor(parts.get(1).getSd(),md);
  Assert.assertFalse(Arrays.equals(sdHash,alteredHash));
  for (  String partVal : partVals.subList(1,partVals.size())) {
    store.dropPartition(dbName,tableName,Arrays.asList(partVal));
  }
  store.dropTable(dbName,tableName);
  store.dropTable(dbName,tableName2);
  Assert.assertEquals(0,HBaseReadWrite.getInstance().countStorageDescriptor());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestCompactionTxnHandler </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkCompacted() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  txnHandler.markCompacted(ci);
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("ready for cleaning",c.getState());
  assertNull(c.getWorkerid());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToClean() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  assertEquals(0,txnHandler.findReadyToClean().size());
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals(0,txnHandler.findReadyToClean().size());
  txnHandler.markCompacted(ci);
  assertNull(txnHandler.findNextToCompact("fred"));
  List<CompactionInfo> toClean=txnHandler.findReadyToClean();
  assertEquals(1,toClean.size());
  assertNull(txnHandler.findNextToCompact("fred"));
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("ready for cleaning",c.getState());
  assertNull(c.getWorkerid());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindNextToCompact() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  long now=System.currentTimeMillis();
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  assertNotNull(ci);
  assertEquals("foo",ci.dbname);
  assertEquals("bar",ci.tableName);
  assertEquals("ds=today",ci.partName);
  assertEquals(CompactionType.MINOR,ci.type);
  assertNull(ci.runAs);
  assertNull(txnHandler.findNextToCompact("fred"));
  txnHandler.setRunAs(ci.id,"bob");
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("working",c.getState());
  assertTrue(c.getStart() - 5000 < now && c.getStart() + 5000 > now);
  assertEquals("fred",c.getWorkerid());
  assertEquals("bob",c.getRunAs());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void addDynamicPartitions() throws Exception {
  String dbName="default";
  String tableName="adp_table";
  OpenTxnsResponse openTxns=txnHandler.openTxns(new OpenTxnRequest(1,"me","localhost"));
  long txnId=openTxns.getTxn_ids().get(0);
  LockComponent lc=new LockComponent(LockType.SHARED_WRITE,LockLevel.TABLE,dbName);
  lc.setTablename(tableName);
  LockRequest lr=new LockRequest(Arrays.asList(lc),"me","localhost");
  lr.setTxnid(txnId);
  LockResponse lock=txnHandler.lock(new LockRequest(Arrays.asList(lc),"me","localhost"));
  assertEquals(LockState.ACQUIRED,lock.getState());
  txnHandler.addDynamicPartitions(new AddDynamicPartitions(txnId,dbName,tableName,Arrays.asList("ds=yesterday","ds=today")));
  txnHandler.commitTxn(new CommitTxnRequest(txnId));
  Set<CompactionInfo> potentials=txnHandler.findPotentialCompactions(1000);
  assertEquals(2,potentials.size());
  SortedSet<CompactionInfo> sorted=new TreeSet<CompactionInfo>(potentials);
  int i=0;
  for (  CompactionInfo ci : sorted) {
    assertEquals(dbName,ci.dbname);
    assertEquals(tableName,ci.tableName);
switch (i++) {
case 0:
      assertEquals("ds=today",ci.partName);
    break;
case 1:
  assertEquals("ds=yesterday",ci.partName);
break;
default :
throw new RuntimeException("What?");
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.metastore.txn.TestTxnHandler </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbortTxn() throws Exception {
  OpenTxnsResponse openedTxns=txnHandler.openTxns(new OpenTxnRequest(2,"me","localhost"));
  List<Long> txnList=openedTxns.getTxn_ids();
  long first=txnList.get(0);
  assertEquals(1L,first);
  long second=txnList.get(1);
  assertEquals(2L,second);
  txnHandler.abortTxn(new AbortTxnRequest(1));
  GetOpenTxnsInfoResponse txnsInfo=txnHandler.getOpenTxnsInfo();
  assertEquals(2L,txnsInfo.getTxn_high_water_mark());
  assertEquals(2,txnsInfo.getOpen_txns().size());
  assertEquals(1L,txnsInfo.getOpen_txns().get(0).getId());
  assertEquals(TxnState.ABORTED,txnsInfo.getOpen_txns().get(0).getState());
  assertEquals(2L,txnsInfo.getOpen_txns().get(1).getId());
  assertEquals(TxnState.OPEN,txnsInfo.getOpen_txns().get(1).getState());
  GetOpenTxnsResponse txns=txnHandler.getOpenTxns();
  assertEquals(2L,txns.getTxn_high_water_mark());
  assertEquals(2,txns.getOpen_txns().size());
  boolean[] saw=new boolean[3];
  for (int i=0; i < saw.length; i++)   saw[i]=false;
  for (  Long tid : txns.getOpen_txns()) {
    saw[tid.intValue()]=true;
  }
  for (int i=1; i < saw.length; i++)   assertTrue(saw[i]);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactMinorNoPartition() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MINOR);
  rqst.setRunas("fred");
  txnHandler.compact(rqst);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertNull(c.getPartitionname());
  assertEquals(CompactionType.MINOR,c.getType());
  assertEquals("initiated",c.getState());
  assertEquals(0L,c.getStart());
  assertEquals("fred",c.getRunAs());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactMajorWithPartition() throws Exception {
  CompactionRequest rqst=new CompactionRequest("foo","bar",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  assertEquals(1,compacts.size());
  ShowCompactResponseElement c=compacts.get(0);
  assertEquals("foo",c.getDbname());
  assertEquals("bar",c.getTablename());
  assertEquals("ds=today",c.getPartitionname());
  assertEquals(CompactionType.MAJOR,c.getType());
  assertEquals("initiated",c.getState());
  assertEquals(0L,c.getStart());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.TestTxnCommands </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateDeleteOfInserts() throws Exception {
  int[][] rows1={{1,2},{3,4}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows1));
  List<String> rs0=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Content didn't match rs0",stringifyValues(rows1),rs0);
  runStatementOnDriver("set autocommit false");
  runStatementOnDriver("START TRANSACTION");
  int[][] rows2={{5,6},{7,8}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows2));
  List<String> rs1=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  List<String> allData=stringifyValues(rows1);
  allData.addAll(stringifyValues(rows2));
  Assert.assertEquals("Content didn't match rs1",allData,rs1);
  runStatementOnDriver("update " + Table.ACIDTBL + " set b = 1 where b != 1");
  int[][] updatedData={{1,1},{3,1},{5,1},{7,1}};
  List<String> rs2=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Wrong data after update",stringifyValues(updatedData),rs2);
  runStatementOnDriver("delete from " + Table.ACIDTBL + " where a = 7 and b = 1");
  dumpTableData(Table.ACIDTBL,1,0);
  dumpTableData(Table.ACIDTBL,2,0);
  dumpTableData(Table.ACIDTBL,2,2);
  dumpTableData(Table.ACIDTBL,2,4);
  int[][] updatedData2={{1,1},{3,1},{5,1}};
  List<String> rs3=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Wrong data after delete",stringifyValues(updatedData2),rs3);
  runStatementOnDriver("commit");
  runStatementOnDriver("set autocommit true");
  List<String> rs4=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Wrong data after commit",stringifyValues(updatedData2),rs4);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleInserts() throws Exception {
  runStatementOnDriver("set autocommit false");
  runStatementOnDriver("START TRANSACTION");
  int[][] rows1={{1,2},{3,4}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows1));
  int[][] rows2={{5,6},{7,8}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows2));
  List<String> allData=stringifyValues(rows1);
  allData.addAll(stringifyValues(rows2));
  List<String> rs=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Content didn't match before commit rs",allData,rs);
  runStatementOnDriver("commit");
  dumpTableData(Table.ACIDTBL,1,0);
  dumpTableData(Table.ACIDTBL,1,1);
  runStatementOnDriver("set autocommit true");
  List<String> rs1=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Content didn't match after commit rs1",allData,rs1);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleAcidInsert() throws Exception {
  int[][] rows1={{1,2},{3,4}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows1));
  runStatementOnDriver("set autocommit false");
  runStatementOnDriver("START TRANSACTION");
  int[][] rows2={{5,6},{7,8}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows2));
  List<String> allData=stringifyValues(rows1);
  allData.addAll(stringifyValues(rows2));
  List<String> rs0=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Data didn't match inside tx (rs0)",allData,rs0);
  runStatementOnDriver("COMMIT WORK");
  dumpTableData(Table.ACIDTBL,1,0);
  dumpTableData(Table.ACIDTBL,2,0);
  runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  runStatementOnDriver("COMMIT");
  runStatementOnDriver("set autocommit true");
  List<String> rs1=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Data didn't match inside tx (rs0)",allData,rs1);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateOfInserts() throws Exception {
  int[][] rows1={{1,2},{3,4}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows1));
  List<String> rs0=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Content didn't match rs0",stringifyValues(rows1),rs0);
  runStatementOnDriver("set autocommit false");
  runStatementOnDriver("START TRANSACTION");
  int[][] rows2={{5,6},{7,8}};
  runStatementOnDriver("insert into " + Table.ACIDTBL + "(a,b) "+ makeValuesClause(rows2));
  List<String> rs1=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  List<String> allData=stringifyValues(rows1);
  allData.addAll(stringifyValues(rows2));
  Assert.assertEquals("Content didn't match rs1",allData,rs1);
  runStatementOnDriver("update " + Table.ACIDTBL + " set b = 1 where b != 1");
  int[][] updatedData={{1,1},{3,1},{5,1},{7,1}};
  List<String> rs2=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Wrong data after update",stringifyValues(updatedData),rs2);
  runStatementOnDriver("commit");
  runStatementOnDriver("set autocommit true");
  List<String> rs4=runStatementOnDriver("select a,b from " + Table.ACIDTBL + " order by a,b");
  Assert.assertEquals("Wrong data after commit",stringifyValues(updatedData),rs4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.TestTxnCommands2 </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the query correctness and directory layout after ACID table conversion and MAJOR compaction
 * @throws Exception
 */
@Test public void testNonAcidToAcidConversionAndMajorCompaction() throws Exception {
  FileSystem fs=FileSystem.get(hiveConf);
  FileStatus[] status;
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(1,2)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  List<String> rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  int[][] resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  int resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " SET TBLPROPERTIES ('transactional'='true')");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,status.length);
  for (int i=0; i < status.length; i++) {
    Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
  }
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=1;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("insert into " + Table.NONACIDORCTBL + "(a,b) values(3,4)");
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(3,status.length);
  boolean sawNewDelta=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("delta_.*")) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
 else {
      Assert.assertTrue(status[i].getPath().getName().matches("00000[01]_0"));
    }
  }
  Assert.assertTrue(sawNewDelta);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  runStatementOnDriver("alter table " + Table.NONACIDORCTBL + " compact 'MAJOR'");
  Worker w=new Worker();
  w.setThreadId((int)w.getId());
  w.setHiveConf(hiveConf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  w.init(stop,looped);
  w.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(4,status.length);
  boolean sawNewBase=false;
  for (int i=0; i < status.length; i++) {
    if (status[i].getPath().getName().matches("base_.*")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(status[i].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
      Assert.assertEquals(BUCKET_COUNT,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
    }
  }
  Assert.assertTrue(sawNewBase);
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
  String fakeFile0=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_0";
  String fakeFile1=TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()+ "/subdir/000000_1";
  fs.create(new Path(fakeFile0));
  fs.create(new Path(fakeFile1));
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(5,status.length);
  Cleaner c=new Cleaner();
  c.setThreadId((int)c.getId());
  c.setHiveConf(hiveConf);
  stop=new AtomicBoolean();
  looped=new AtomicBoolean();
  stop.set(true);
  c.init(stop,looped);
  c.run();
  status=fs.listStatus(new Path(TEST_WAREHOUSE_DIR + "/" + (Table.NONACIDORCTBL).toString().toLowerCase()),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(1,status.length);
  Assert.assertTrue(status[0].getPath().getName().matches("base_.*"));
  FileStatus[] buckets=fs.listStatus(status[0].getPath(),FileUtils.STAGING_DIR_PATH_FILTER);
  Assert.assertEquals(BUCKET_COUNT,buckets.length);
  Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
  Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
  rs=runStatementOnDriver("select a,b from " + Table.NONACIDORCTBL);
  resultData=new int[][]{{1,2},{3,4}};
  Assert.assertEquals(stringifyValues(resultData),rs);
  rs=runStatementOnDriver("select count(*) from " + Table.NONACIDORCTBL);
  resultCount=2;
  Assert.assertEquals(resultCount,Integer.parseInt(rs.get(0)));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * HIVE-12353
 * @throws Exception
 */
@Test public void testInitiatorWithMultipleFailedCompactions() throws Exception {
  String tblName="hive12353";
  runStatementOnDriver("drop table if exists " + tblName);
  runStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')");
  hiveConf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,4);
  for (int i=0; i < 5; i++) {
    runStatementOnDriver("insert into " + tblName + " values("+ (i + 1)+ ", 'foo'),("+ (i + 2)+ ", 'bar'),("+ (i + 3)+ ", 'baz')");
  }
  hiveConf.setBoolVar(HiveConf.ConfVars.HIVETESTMODEFAILCOMPACTION,true);
  int numFailedCompactions=hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_INITIATOR_FAILED_THRESHOLD);
  TxnStore txnHandler=TxnUtils.getTxnStore(hiveConf);
  AtomicBoolean stop=new AtomicBoolean(true);
  for (int i=0; i < numFailedCompactions; i++) {
    txnHandler.compact(new CompactionRequest("default",tblName,CompactionType.MINOR));
    runWorker(hiveConf);
  }
  Initiator init=new Initiator();
  init.setThreadId((int)init.getId());
  init.setHiveConf(hiveConf);
  init.init(stop,new AtomicBoolean());
  init.run();
  CompactionsByState cbs=countCompacts(txnHandler);
  Assert.assertEquals("Unexpected number of failed compactions",numFailedCompactions,cbs.failed);
  Assert.assertEquals("Unexpected total number of compactions",numFailedCompactions,cbs.total);
  hiveConf.setTimeVar(HiveConf.ConfVars.COMPACTOR_HISTORY_REAPER_INTERVAL,10,TimeUnit.MILLISECONDS);
  AcidCompactionHistoryService compactionHistoryService=new AcidCompactionHistoryService();
  runHouseKeeperService(compactionHistoryService,hiveConf);
  cbs=countCompacts(txnHandler);
  Assert.assertEquals("Number of failed compactions after History clean",numFailedCompactions,cbs.failed);
  Assert.assertEquals("Total number of compactions after History clean",numFailedCompactions,cbs.total);
  txnHandler.compact(new CompactionRequest("default",tblName,CompactionType.MAJOR));
  runWorker(hiveConf);
  txnHandler.compact(new CompactionRequest("default",tblName,CompactionType.MINOR));
  runWorker(hiveConf);
  cbs=countCompacts(txnHandler);
  Assert.assertEquals("Unexpected num failed1",numFailedCompactions + 2,cbs.failed);
  Assert.assertEquals("Unexpected num total1",numFailedCompactions + 2,cbs.total);
  runHouseKeeperService(compactionHistoryService,hiveConf);
  cbs=countCompacts(txnHandler);
  Assert.assertEquals("Unexpected num failed2",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED),cbs.failed);
  Assert.assertEquals("Unexpected num total2",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED),cbs.total);
  hiveConf.setBoolVar(HiveConf.ConfVars.HIVETESTMODEFAILCOMPACTION,false);
  txnHandler.compact(new CompactionRequest("default",tblName,CompactionType.MINOR));
  cbs=countCompacts(txnHandler);
  Assert.assertEquals("Unexpected num failed3",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED),cbs.failed);
  Assert.assertEquals("Unexpected num initiated",1,cbs.initiated);
  Assert.assertEquals("Unexpected num total3",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED) + 1,cbs.total);
  runWorker(hiveConf);
  cbs=countCompacts(txnHandler);
  Assert.assertEquals("Unexpected num failed4",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED),cbs.failed);
  Assert.assertEquals("Unexpected num ready to clean",1,cbs.readyToClean);
  Assert.assertEquals("Unexpected num total4",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED) + 1,cbs.total);
  runCleaner(hiveConf);
  runHouseKeeperService(compactionHistoryService,hiveConf);
  cbs=countCompacts(txnHandler);
  Assert.assertEquals("Unexpected num failed5",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED),cbs.failed);
  Assert.assertEquals("Unexpected num succeeded",1,cbs.succeeded);
  Assert.assertEquals("Unexpected num total5",hiveConf.getIntVar(HiveConf.ConfVars.COMPACTOR_HISTORY_RETENTION_FAILED) + 1,cbs.total);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.errors.TestTaskLogProcessor </h4><pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataCorruptErrorHeuristic() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  String badFile1="hdfs://localhost/foo1/moo1/zoo1";
  String badFile2="hdfs://localhost/foo2/moo2/zoo2";
  String content="line a\nlineb\n" + "split: " + badFile1 + " is very bad.\n"+ " line c\nlineD\n"+ "split: "+ badFile2+ " is also very bad.\n"+ " java.io.EOFException: null \n"+ "line E\n";
  File log3File=writeTestLog("1",content);
  taskLogProcessor.addTaskAttemptLogUrl(log3File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.contains(badFile1) || error.contains(badFile2));
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapAggrMemErrorHeuristic() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  Throwable oome=new OutOfMemoryError("java heap space");
  File log1File=writeTestLog("1",toString(oome));
  taskLogProcessor.addTaskAttemptLogUrl(log1File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.contains("memory"));
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
  String confName=HiveConf.ConfVars.HIVEMAPAGGRHASHMEMORY.toString();
  assertTrue(solution.contains(confName));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScriptErrorHeuristic() throws Exception {
  JobConf jobConf=new JobConf();
  jobConf.set(HiveConf.ConfVars.HIVEQUERYSTRING.varname,"select * from foo group by moo;");
  final TaskLogProcessor taskLogProcessor=new TaskLogProcessor(jobConf);
  String errorCode="7874";
  String content="line a\nlineb\n" + "Script failed with code " + errorCode + " line c\nlineD\n";
  File log3File=writeTestLog("1",content);
  taskLogProcessor.addTaskAttemptLogUrl(log3File.toURI().toURL().toString());
  List<ErrorAndSolution> errList=taskLogProcessor.getErrors();
  assertEquals(1,errList.size());
  final ErrorAndSolution eas=errList.get(0);
  String error=eas.getError();
  assertNotNull(error);
  assertTrue(error.indexOf(errorCode) >= 0);
  String solution=eas.getSolution();
  assertNotNull(solution);
  assertTrue(solution.length() > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.persistence.TestMapJoinRowContainer </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization() throws Exception {
  MapJoinRowContainer container1=new MapJoinEagerRowContainer();
  container1.addRow(new Object[]{new Text("f0"),null,new ShortWritable((short)0xf)});
  container1.addRow(Arrays.asList(new Object[]{null,new Text("f1"),new ShortWritable((short)0xf)}));
  container1.addRow(new Object[]{null,null,new ShortWritable((short)0xf)});
  container1.addRow(Arrays.asList(new Object[]{new Text("f0"),new Text("f1"),new ShortWritable((short)0x1)}));
  MapJoinRowContainer container2=Utilities.serde(container1,"f0,f1,filter","string,string,smallint");
  Utilities.testEquality(container1,container2);
  Assert.assertEquals(4,container1.rowCount());
  Assert.assertEquals(1,container2.getAliasFilter());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.persistence.TestMapJoinTableContainer </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyContainer() throws Exception {
  MapJoinTableContainerSerDe.persistDummyTable(out);
  out.close();
  in=new ObjectInputStream(new ByteArrayInputStream(baos.toByteArray()));
  container=containerSerde.load(in);
  Assert.assertEquals(0,container.size());
  Assert.assertTrue(container.entrySet().isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestConstantVectorExpression </h4><pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstantExpression(){
  ConstantVectorExpression longCve=new ConstantVectorExpression(0,17);
  ConstantVectorExpression doubleCve=new ConstantVectorExpression(1,17.34);
  String str="alpha";
  ConstantVectorExpression bytesCve=new ConstantVectorExpression(2,str.getBytes());
  HiveDecimal decVal=HiveDecimal.create("25.8");
  ConstantVectorExpression decimalCve=new ConstantVectorExpression(3,decVal);
  ConstantVectorExpression nullCve=new ConstantVectorExpression(4,"string",true);
  int size=20;
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(size,5,0);
  LongColumnVector lcv=(LongColumnVector)vrg.cols[0];
  DoubleColumnVector dcv=new DoubleColumnVector(size);
  BytesColumnVector bcv=new BytesColumnVector(size);
  DecimalColumnVector dv=new DecimalColumnVector(5,1);
  BytesColumnVector bcvn=new BytesColumnVector(size);
  vrg.cols[1]=dcv;
  vrg.cols[2]=bcv;
  vrg.cols[3]=dv;
  vrg.cols[4]=bcvn;
  longCve.evaluate(vrg);
  doubleCve.evaluate(vrg);
  bytesCve.evaluate(vrg);
  decimalCve.evaluate(vrg);
  nullCve.evaluate(vrg);
  assertTrue(lcv.isRepeating);
  assertTrue(dcv.isRepeating);
  assertTrue(bcv.isRepeating);
  assertEquals(17,lcv.vector[0]);
  assertTrue(17.34 == dcv.vector[0]);
  assertTrue(bcvn.isRepeating);
  assertTrue(bcvn.isNull[0]);
  assertTrue(!bcvn.noNulls);
  byte[] alphaBytes="alpha".getBytes();
  assertTrue(bcv.length[0] == alphaBytes.length);
  assertTrue(sameFirstKBytes(alphaBytes,bcv.vector[0],alphaBytes.length));
  ((BytesColumnVector)(vrg.cols[2])).vector[0]="beta".getBytes();
  bytesCve.evaluate(vrg);
  assertTrue(bcv.length[0] == alphaBytes.length);
  assertTrue(sameFirstKBytes(alphaBytes,bcv.vector[0],alphaBytes.length));
  assertTrue(25.8 == dv.vector[0].getHiveDecimal().doubleValue());
  ((DecimalColumnVector)(vrg.cols[3])).vector[0].set(HiveDecimal.create("39.7"));
  decimalCve.evaluate(vrg);
  assertTrue(25.8 == dv.vector[0].getHiveDecimal().doubleValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestCuckooSet </h4><pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testSetBytesLargeRandom(){
  byte[][] values;
  Random gen=new Random(98763537);
  for (int i=0; i < 200; ) {
    int size=gen.nextInt() % MAX_SIZE;
    if (size <= 0) {
      continue;
    }
    i++;
    values=new byte[size][];
    loadRandomBytes(values,gen);
    CuckooSetBytes s=new CuckooSetBytes(size);
    loadSet(s,values);
    for (int j=0; j != size; j++) {
      assertTrue(s.lookup(values[j],0,values[j].length));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testSetLongRandom(){
  long[] values;
  Random gen=new Random(98763537);
  for (int i=0; i < 200; ) {
    int size=gen.nextInt() % MAX_SIZE;
    if (size <= 0) {
      continue;
    }
    i++;
    values=new long[size];
    loadRandom(values,gen);
    CuckooSetLong s=new CuckooSetLong(size);
    loadSet(s,values);
    for (int j=0; j != size; j++) {
      assertTrue(s.lookup(values[j]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorArithmeticExpressions </h4><pre class="type-11 type-6 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLongColAddLongColumn(){
  int seed=17;
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(VectorizedRowBatch.DEFAULT_SIZE,6,seed);
  LongColumnVector lcv0=(LongColumnVector)vrg.cols[0];
  LongColumnVector lcv1=(LongColumnVector)vrg.cols[1];
  LongColumnVector lcv2=(LongColumnVector)vrg.cols[2];
  LongColumnVector lcv3=(LongColumnVector)vrg.cols[3];
  LongColumnVector lcv4=(LongColumnVector)vrg.cols[4];
  LongColumnVector lcv5=(LongColumnVector)vrg.cols[5];
  LongColAddLongColumn expr=new LongColAddLongColumn(0,1,2);
  expr.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    assertEquals((i + 1) * seed * 3,lcv2.vector[i]);
  }
  assertTrue(lcv2.noNulls);
  lcv1.noNulls=false;
  lcv1.isNull[1]=true;
  lcv2.isRepeating=true;
  lcv2.noNulls=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.isNull[1]);
  assertFalse(lcv2.noNulls);
  assertFalse(lcv2.isRepeating);
  verifyLongNullDataVectorEntries(lcv2,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv0.noNulls=false;
  lcv0.isNull[1]=true;
  lcv0.isNull[3]=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.isNull[1]);
  assertTrue(lcv2.isNull[3]);
  assertFalse(lcv2.noNulls);
  verifyLongNullDataVectorEntries(lcv2,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv3.isRepeating=true;
  LongColAddLongColumn expr2=new LongColAddLongColumn(3,4,5);
  expr2.evaluate(vrg);
  for (int i=0; i < VectorizedRowBatch.DEFAULT_SIZE; i++) {
    assertEquals(seed * (4 + 5 * (i + 1)),lcv5.vector[i]);
  }
  lcv4.noNulls=false;
  lcv4.isNull[0]=true;
  expr2.evaluate(vrg);
  assertTrue(lcv5.isNull[0]);
  assertFalse(lcv5.noNulls);
  verifyLongNullDataVectorEntries(lcv5,vrg.selected,vrg.selectedInUse,vrg.size);
  lcv3.isRepeating=true;
  lcv3.noNulls=false;
  lcv3.isNull[0]=true;
  expr2.evaluate(vrg);
  assertFalse(lcv5.noNulls);
  assertTrue(lcv5.isRepeating);
  assertTrue(lcv5.isNull[0]);
  verifyLongNullDataVectorEntries(lcv5,vrg.selected,vrg.selectedInUse,vrg.size);
  vrg.selectedInUse=false;
  lcv0.noNulls=true;
  lcv1.noNulls=true;
  lcv0.isRepeating=false;
  lcv1.isRepeating=false;
  lcv2.noNulls=false;
  lcv2.isRepeating=true;
  expr.evaluate(vrg);
  assertTrue(lcv2.noNulls);
  assertFalse(lcv2.isRepeating);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorFilterExpressions </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterTimestampNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  long startTS=TimestampUtils.getTimeNanoSec(Timestamp.valueOf("2013-11-05 00:00:00.000000000"));
  long endTS=TimestampUtils.getTimeNanoSec(Timestamp.valueOf("2013-11-05 00:00:00.000000010"));
  Timestamp ts0=Timestamp.valueOf("2013-11-04 00:00:00.000000000");
  lcv0.vector[0]=TimestampUtils.getTimeNanoSec(ts0);
  Timestamp ts1=Timestamp.valueOf("2013-11-05 00:00:00.000000002");
  lcv0.vector[1]=TimestampUtils.getTimeNanoSec(ts1);
  Timestamp ts2=Timestamp.valueOf("2099-11-06 00:00:00.000");
  lcv0.vector[2]=TimestampUtils.getTimeNanoSec(ts2);
  vrb.size=3;
  VectorExpression expr1=new FilterLongColumnNotBetween(0,startTS,endTS);
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertEquals(true,vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterLongColGreaterLongColumn(){
  int seed=17;
  VectorizedRowBatch b=VectorizedRowGroupGenUtil.getVectorizedRowBatch(VectorizedRowBatch.DEFAULT_SIZE,2,seed);
  LongColumnVector lcv0=(LongColumnVector)b.cols[0];
  LongColumnVector lcv1=(LongColumnVector)b.cols[1];
  b.size=3;
  FilterLongColGreaterLongColumn expr=new FilterLongColGreaterLongColumn(0,1);
  lcv0.vector[0]=10;
  lcv0.vector[1]=10;
  lcv0.vector[2]=10;
  lcv1.vector[0]=20;
  lcv1.vector[1]=1;
  lcv1.vector[2]=7;
  expr.evaluate(b);
  assertEquals(2,b.size);
  assertEquals(1,b.selected[0]);
  assertEquals(2,b.selected[1]);
  lcv0.noNulls=false;
  lcv0.isNull[1]=true;
  expr.evaluate(b);
  assertEquals(1,b.size);
  assertEquals(2,b.selected[0]);
  b.size=3;
  b.selectedInUse=false;
  lcv0.isRepeating=true;
  lcv0.noNulls=true;
  expr.evaluate(b);
  assertEquals(2,b.size);
  b.size=3;
  b.selectedInUse=false;
  lcv0.isNull[0]=true;
  lcv0.noNulls=false;
  expr.evaluate(b);
  assertEquals(0,b.size);
  b.size=3;
  b.selectedInUse=false;
  lcv0.isRepeating=false;
  lcv1.noNulls=false;
  lcv1.isNull[2]=true;
  expr.evaluate(b);
  assertEquals(0,b.size);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterLongColLessLongColumn(){
  int seed=17;
  VectorizedRowBatch vrg=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,3,seed);
  LongColumnVector lcv0=(LongColumnVector)vrg.cols[0];
  LongColumnVector lcv1=(LongColumnVector)vrg.cols[1];
  LongColumnVector lcv2=(LongColumnVector)vrg.cols[2];
  FilterLongColLessLongColumn expr=new FilterLongColLessLongColumn(2,1);
  LongColAddLongScalar childExpr=new LongColAddLongScalar(0,10,2);
  expr.setChildExpressions(new VectorExpression[]{childExpr});
  lcv0.vector[0]=10;
  lcv0.vector[1]=20;
  lcv0.vector[2]=9;
  lcv0.vector[3]=20;
  lcv0.vector[4]=10;
  lcv1.vector[0]=20;
  lcv1.vector[1]=10;
  lcv1.vector[2]=20;
  lcv1.vector[3]=10;
  lcv1.vector[4]=20;
  expr.evaluate(vrg);
  assertEquals(1,vrg.size);
  assertEquals(2,vrg.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterStringIn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(3,2,seed);
  vrb.cols[0]=new BytesColumnVector();
  BytesColumnVector bcv=(BytesColumnVector)vrb.cols[0];
  bcv.initBuffer();
  bcv.setVal(0,a,0,1);
  bcv.setVal(1,b,0,1);
  bcv.setVal(2,c,0,1);
  VectorExpression expr=new FilterStringColumnInList(0);
  byte[][] inList={b,c};
  ((FilterStringColumnInList)expr).setInListValues(inList);
  expr.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isNull[2]=true;
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertEquals(1,vrb.selected[0]);
  assertTrue(vrb.selectedInUse);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=true;
  bcv.isRepeating=true;
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isRepeating=true;
  bcv.isNull[0]=true;
  bcv.setVal(0,b,0,1);
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterLongNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  VectorExpression expr=new FilterLongColumnNotBetween(0,10,20);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDoubleNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  vrb.cols[0]=new DoubleColumnVector();
  DoubleColumnVector dcv=(DoubleColumnVector)vrb.cols[0];
  dcv.vector[0]=5;
  dcv.vector[1]=20;
  dcv.vector[2]=17;
  dcv.vector[3]=15;
  dcv.vector[4]=10;
  VectorExpression expr=new FilterDoubleColumnNotBetween(0,10,20);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterTimestampBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  long startTS=0;
  long endTS=TimestampUtils.getTimeNanoSec(Timestamp.valueOf("2013-11-05 00:00:00.000000000"));
  Timestamp ts0=Timestamp.valueOf("1963-11-06 00:00:00.000");
  lcv0.vector[0]=TimestampUtils.getTimeNanoSec(ts0);
  Timestamp ts1=Timestamp.valueOf("1983-11-06 00:00:00.000");
  lcv0.vector[1]=TimestampUtils.getTimeNanoSec(ts1);
  Timestamp ts2=Timestamp.valueOf("2099-11-06 00:00:00.000");
  lcv0.vector[2]=TimestampUtils.getTimeNanoSec(ts2);
  vrb.size=3;
  VectorExpression expr1=new FilterLongColumnBetween(0,startTS,endTS);
  expr1.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertEquals(true,vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterStringBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(3,2,seed);
  vrb.cols[0]=new BytesColumnVector();
  BytesColumnVector bcv=(BytesColumnVector)vrb.cols[0];
  bcv.initBuffer();
  bcv.setVal(0,a,0,1);
  bcv.setVal(1,b,0,1);
  bcv.setVal(2,c,0,1);
  VectorExpression expr=new FilterStringColumnBetween(0,b,c);
  expr.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isNull[2]=true;
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertEquals(1,vrb.selected[0]);
  assertTrue(vrb.selectedInUse);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=true;
  bcv.isRepeating=true;
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
  vrb.selectedInUse=false;
  vrb.size=3;
  bcv.noNulls=false;
  bcv.isRepeating=true;
  bcv.isNull[0]=true;
  bcv.setVal(0,b,0,1);
  expr.evaluate(vrb);
  assertEquals(0,vrb.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterStringNotBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(3,2,seed);
  vrb.cols[0]=new BytesColumnVector();
  BytesColumnVector bcv=(BytesColumnVector)vrb.cols[0];
  bcv.initBuffer();
  bcv.setVal(0,a,0,1);
  bcv.setVal(1,b,0,1);
  bcv.setVal(2,c,0,1);
  VectorExpression expr=new FilterStringColumnNotBetween(0,b,c);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterLongBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  VectorExpression expr1=new FilterLongColumnBetween(0,15,17);
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(2,vrb.selected[0]);
  assertEquals(3,vrb.selected[1]);
  VectorizedRowBatch vrb1=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  lcv0=(LongColumnVector)vrb1.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  expr1.evaluate(vrb1);
  assertEquals(1,vrb1.size);
  assertTrue(vrb1.selectedInUse);
  assertEquals(3,vrb1.selected[0]);
  VectorizedRowBatch vrb2=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  vrb2.selectedInUse=true;
  vrb2.selected[0]=1;
  vrb2.selected[1]=2;
  vrb2.selected[2]=4;
  vrb2.size=3;
  lcv0=(LongColumnVector)vrb2.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.vector[5]=19;
  lcv0.vector[6]=21;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  lcv0.isNull[5]=true;
  expr1.evaluate(vrb2);
  assertEquals(0,vrb2.size);
  VectorizedRowBatch vrb3=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  lcv0=(LongColumnVector)vrb3.cols[0];
  lcv0.isRepeating=true;
  lcv0.vector[0]=17;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb3);
  assertEquals(7,vrb3.size);
  assertFalse(vrb3.selectedInUse);
  assertTrue(lcv0.isRepeating);
  lcv0.noNulls=false;
  lcv0.vector[0]=17;
  lcv0.isNull[0]=true;
  expr1.evaluate(vrb3);
  assertEquals(0,vrb3.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the IN filter VectorExpression classes.
 */
@Test public void testFilterLongIn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  long[] inList={5,20};
  FilterLongColumnInList f=new FilterLongColumnInList(0);
  f.setInListValues(inList);
  VectorExpression expr1=f;
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
  assertEquals(1,vrb.selected[1]);
  VectorizedRowBatch vrb1=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  lcv0=(LongColumnVector)vrb1.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  expr1.evaluate(vrb1);
  assertEquals(1,vrb1.size);
  assertTrue(vrb1.selectedInUse);
  assertEquals(1,vrb1.selected[0]);
  VectorizedRowBatch vrb2=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  vrb2.selectedInUse=true;
  vrb2.selected[0]=1;
  vrb2.selected[1]=2;
  vrb2.selected[2]=4;
  vrb2.size=3;
  lcv0=(LongColumnVector)vrb2.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.vector[5]=19;
  lcv0.vector[6]=21;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  lcv0.isNull[5]=true;
  expr1.evaluate(vrb2);
  assertEquals(1,vrb2.size);
  assertEquals(1,vrb2.selected[0]);
  VectorizedRowBatch vrb3=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  lcv0=(LongColumnVector)vrb3.cols[0];
  lcv0.isRepeating=true;
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb3);
  assertEquals(7,vrb3.size);
  assertFalse(vrb3.selectedInUse);
  assertTrue(lcv0.isRepeating);
  lcv0.noNulls=false;
  lcv0.vector[0]=5;
  lcv0.isNull[0]=true;
  expr1.evaluate(vrb3);
  assertEquals(0,vrb3.size);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDoubleBetween(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  DoubleColumnVector dcv0=new DoubleColumnVector();
  vrb.cols[0]=dcv0;
  dcv0.vector[0]=5;
  dcv0.vector[1]=20;
  dcv0.vector[2]=17;
  dcv0.vector[3]=15;
  dcv0.vector[4]=10;
  VectorExpression expr=new FilterDoubleColumnBetween(0,20,21);
  expr.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterDoubleIn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  DoubleColumnVector dcv0=new DoubleColumnVector();
  vrb.cols[0]=dcv0;
  double[] inList={5.0,20.2};
  FilterDoubleColumnInList f=new FilterDoubleColumnInList(0);
  f.setInListValues(inList);
  VectorExpression expr1=f;
  dcv0.vector[0]=5.0;
  dcv0.vector[1]=20.2;
  dcv0.vector[2]=17.0;
  dcv0.vector[3]=15.0;
  dcv0.vector[4]=10.0;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(0,vrb.selected[0]);
  assertEquals(1,vrb.selected[1]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterLongScalarLessLongColumn(){
  int seed=17;
  VectorizedRowBatch vrb=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  LongColumnVector lcv0=(LongColumnVector)vrb.cols[0];
  FilterLongScalarLessLongColumn expr1=new FilterLongScalarLessLongColumn(15,0);
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb);
  assertEquals(2,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(1,vrb.selected[0]);
  assertEquals(2,vrb.selected[1]);
  FilterLongScalarGreaterLongColumn expr2=new FilterLongScalarGreaterLongColumn(18,0);
  expr2.evaluate(vrb);
  assertEquals(1,vrb.size);
  assertTrue(vrb.selectedInUse);
  assertEquals(2,vrb.selected[0]);
  VectorizedRowBatch vrb1=VectorizedRowGroupGenUtil.getVectorizedRowBatch(5,2,seed);
  lcv0=(LongColumnVector)vrb1.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  expr1.evaluate(vrb1);
  assertEquals(1,vrb1.size);
  assertTrue(vrb1.selectedInUse);
  assertEquals(1,vrb1.selected[0]);
  VectorizedRowBatch vrb2=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  vrb2.selectedInUse=true;
  vrb2.selected[0]=1;
  vrb2.selected[1]=2;
  vrb2.selected[2]=4;
  vrb2.size=3;
  lcv0=(LongColumnVector)vrb2.cols[0];
  lcv0.vector[0]=5;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  lcv0.vector[5]=19;
  lcv0.vector[6]=21;
  lcv0.noNulls=false;
  lcv0.isNull[0]=true;
  lcv0.isNull[2]=true;
  lcv0.isNull[5]=true;
  expr1.evaluate(vrb2);
  assertEquals(1,vrb2.size);
  assertTrue(vrb2.selectedInUse);
  assertEquals(1,vrb2.selected[0]);
  VectorizedRowBatch vrb3=VectorizedRowGroupGenUtil.getVectorizedRowBatch(7,2,seed);
  lcv0=(LongColumnVector)vrb3.cols[0];
  lcv0.isRepeating=true;
  lcv0.vector[0]=17;
  lcv0.vector[1]=20;
  lcv0.vector[2]=17;
  lcv0.vector[3]=15;
  lcv0.vector[4]=10;
  expr1.evaluate(vrb3);
  assertEquals(7,vrb3.size);
  assertFalse(vrb3.selectedInUse);
  assertTrue(lcv0.isRepeating);
  lcv0.noNulls=false;
  lcv0.vector[0]=17;
  lcv0.isNull[0]=true;
  expr1.evaluate(vrb3);
  assertEquals(0,vrb3.size);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.expressions.TestVectorStringExpressions </h4><pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColLower(){
  VectorizedRowBatch batch=makeStringBatchMixedCase();
  StringLower expr=new StringLower(0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(green,0,green.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  batch=makeStringBatchMixedCase();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.noNulls);
  batch=makeStringBatchMixedCase();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatchMixedCase();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(mixedUpLower,0,mixedUpLower.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatCharScalar(){
  VectorizedRowBatch batch=makeStringBatch();
  StringGroupColConcatCharScalar expr=new StringGroupColConcatCharScalar(0,new HiveChar(new String(red),6),1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testTruncateScalar(){
  int largeMaxLength=100;
  byte[] result;
  Assert.assertTrue(StringExpr.characterCount(blue) == 4);
  result=StringExpr.truncateScalar(blue,largeMaxLength);
  Assert.assertTrue(Arrays.equals(blue,result));
  Assert.assertTrue(StringExpr.characterCount(redgreen) == 8);
  result=StringExpr.truncateScalar(redgreen,largeMaxLength);
  Assert.assertTrue(Arrays.equals(redgreen,result));
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence) == 31);
  result=StringExpr.truncateScalar(ascii_sentence,largeMaxLength);
  Assert.assertTrue(Arrays.equals(ascii_sentence,result));
  Assert.assertTrue(StringExpr.characterCount(blanksLeft) == 5);
  result=StringExpr.truncateScalar(blanksLeft,largeMaxLength);
  Assert.assertTrue(Arrays.equals(blanksLeft,result));
  Assert.assertTrue(StringExpr.characterCount(blue) == 4);
  result=StringExpr.truncateScalar(blue,blue.length);
  Assert.assertTrue(Arrays.equals(blue,result));
  Assert.assertTrue(StringExpr.characterCount(redgreen) == 8);
  result=StringExpr.truncateScalar(redgreen,redgreen.length);
  Assert.assertTrue(Arrays.equals(redgreen,result));
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence) == 31);
  result=StringExpr.truncateScalar(ascii_sentence,ascii_sentence.length);
  Assert.assertTrue(Arrays.equals(ascii_sentence,result));
  Assert.assertTrue(StringExpr.characterCount(blanksLeft) == 5);
  result=StringExpr.truncateScalar(blanksLeft,blanksLeft.length);
  Assert.assertTrue(Arrays.equals(blanksLeft,result));
  result=StringExpr.truncateScalar(blue,3);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blue,3),result));
  result=StringExpr.truncateScalar(redgreen,6);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(redgreen,6),result));
  result=StringExpr.truncateScalar(ascii_sentence,14);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(ascii_sentence,14),result));
  result=StringExpr.truncateScalar(blanksLeft,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blanksLeft,2),result));
  result=StringExpr.truncateScalar(blanksRight,4);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blanksRight,4),result));
  result=StringExpr.truncateScalar(blanksBoth,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blanksBoth,2),result));
  result=StringExpr.truncateScalar(blankString,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blankString,1),result));
  result=StringExpr.truncateScalar(blankRanges,29);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blankRanges,29),result));
  byte[] scratch=new byte[100];
  byte[] multiByte;
  addMultiByteCharRightPadded1_1(scratch);
  multiByte=Arrays.copyOf(scratch,4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  result=StringExpr.truncateScalar(multiByte,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,3),result));
  addMultiByteCharRightPadded1_2(scratch);
  multiByte=Arrays.copyOf(scratch,5);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  result=StringExpr.truncateScalar(multiByte,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,4),result));
  addMultiByteCharRightPadded1_3(scratch);
  multiByte=Arrays.copyOf(scratch,9);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  result=StringExpr.truncateScalar(multiByte,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,5),result));
  addMultiByteCharRightPadded1_2(scratch);
  multiByte=Arrays.copyOfRange(scratch,3,3 + 2);
  Assert.assertTrue(StringExpr.characterCount(multiByte) == 2);
  result=StringExpr.truncateScalar(multiByte,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,1),result));
  int sentenceOneLen=addMultiByteCharSentenceOne(scratch,0);
  byte[] sentenceOne=Arrays.copyOf(scratch,sentenceOneLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne) == 10);
  result=StringExpr.truncateScalar(sentenceOne,8);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOne,20),result));
  byte[] sentenceOnePortion=Arrays.copyOf(sentenceOne,sentenceOneLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePortion) == 9);
  result=StringExpr.truncateScalar(sentenceOnePortion,3);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePortion,9),result));
  int sentenceTwoLen=addMultiByteCharSentenceTwo(scratch,0);
  byte[] sentenceTwo=Arrays.copyOf(scratch,sentenceTwoLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo) == 13);
  result=StringExpr.truncateScalar(sentenceTwo,9);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwo,16),result));
  byte[] sentenceTwoPortion=Arrays.copyOf(sentenceTwo,sentenceTwoLen - 5);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPortion) == 10);
  result=StringExpr.truncateScalar(sentenceTwoPortion,6);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPortion,11),result));
  int start;
  start=addPads(scratch,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(scratch,start);
  byte[] sentenceOnePaddedLeft=Arrays.copyOf(scratch,sentenceOnePaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft) == 3 + 10);
  result=StringExpr.truncateScalar(sentenceOnePaddedLeft,4);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedLeft,6),result));
  byte[] sentenceOnePaddedLeftPortion=Arrays.copyOf(sentenceOnePaddedLeft,sentenceOnePaddedLeftLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeftPortion) == 3 + 9);
  result=StringExpr.truncateScalar(sentenceOnePaddedLeftPortion,7);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedLeftPortion,13),result));
  start=addPads(scratch,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(scratch,start);
  byte[] sentenceTwoPaddedLeft=Arrays.copyOf(scratch,sentenceTwoPaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft) == 2 + 13);
  result=StringExpr.truncateScalar(sentenceTwoPaddedLeft,14);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedLeft,24),result));
  byte[] sentenceTwoPaddedLeftPortion=Arrays.copyOf(sentenceTwoPaddedLeft,sentenceTwoPaddedLeftLen - 5);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeftPortion) == 2 + 10);
  result=StringExpr.truncateScalar(sentenceTwoPaddedLeftPortion,9);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedLeftPortion,15),result));
  start=addMultiByteCharSentenceOne(scratch,0);
  int sentenceOnePaddedRightLen=addPads(scratch,start,4);
  byte[] sentenceOnePaddedRight=Arrays.copyOf(scratch,sentenceOnePaddedRightLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight) == 10 + 4);
  result=StringExpr.truncateScalar(sentenceOnePaddedRight,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedRight,3),result));
  byte[] sentenceOnePaddedRightPortion=Arrays.copyOf(sentenceOnePaddedRight,sentenceOnePaddedRightLen - 3 - 4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRightPortion) == 9);
  result=StringExpr.truncateScalar(sentenceOnePaddedRightPortion,5);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedRightPortion,13),result));
  start=addMultiByteCharSentenceTwo(scratch,0);
  int sentenceTwoPaddedRightLen=addPads(scratch,start,1);
  byte[] sentenceTwoPaddedRight=Arrays.copyOf(scratch,sentenceTwoPaddedRightLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight) == 13 + 1);
  result=StringExpr.truncateScalar(sentenceTwoPaddedRight,6);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedRight,11),result));
  byte[] sentenceTwoPaddedRightPortion=Arrays.copyOf(sentenceTwoPaddedRight,sentenceTwoPaddedRightLen - 5 - 1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRightPortion) == 10);
  result=StringExpr.truncateScalar(sentenceTwoPaddedRightPortion,8);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedRightPortion,14),result));
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(scratch,0);
  byte[] sentenceBlankRanges=Arrays.copyOf(scratch,sentenceBlankRangesLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges) == 17);
  result=StringExpr.truncateScalar(sentenceBlankRanges,4);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceBlankRanges,9),result));
  byte[] sentenceBlankRangesPortion=Arrays.copyOf(sentenceBlankRanges,sentenceBlankRangesLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRangesPortion) == 16);
  result=StringExpr.truncateScalar(sentenceBlankRangesPortion,14);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceBlankRangesPortion,23),result));
  sentenceBlankRangesPortion=Arrays.copyOfRange(sentenceBlankRanges,7,7 + 17);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRangesPortion) == 13);
  result=StringExpr.truncateScalar(sentenceBlankRangesPortion,11);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceBlankRangesPortion,15),result));
  Assert.assertTrue(StringExpr.characterCount(result) == 11);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testLoadBytesColumnVectorByValueLargeData(){
  BytesColumnVector bcv=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  bcv.initBuffer(10);
  String s="0123456789";
  while (s.length() < 500) {
    s+=s;
  }
  byte[] b=null;
  try {
    b=s.getBytes("UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    e.printStackTrace();
  }
  for (int i=0; i != VectorizedRowBatch.DEFAULT_SIZE; i++) {
    bcv.setVal(i,b,0,b.length);
  }
  Assert.assertTrue(bcv.bufferSize() >= b.length * VectorizedRowBatch.DEFAULT_SIZE);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void testRightTrimAndTruncateBytesColumnVector(){
  BytesColumnVector outV=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  outV.initBuffer(35);
  int i=0;
  int largeMaxLength=100;
  int expectedResultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,blue,0,blue.length,largeMaxLength);
  expectedResultLen=blue.length;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.rightTrimAndTruncate(outV,i,redgreen,0,redgreen.length,largeMaxLength);
  expectedResultLen=redgreen.length;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.rightTrimAndTruncate(outV,i,ascii_sentence,0,ascii_sentence.length,largeMaxLength);
  expectedResultLen=ascii_sentence.length;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.rightTrimAndTruncate(outV,i,blanksLeft,0,blanksLeft.length,largeMaxLength);
  expectedResultLen=blanksLeft.length;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  StringExpr.rightTrimAndTruncate(outV,i,blanksRight,0,blanksRight.length,largeMaxLength);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,0,blanksBoth.length,largeMaxLength);
  expectedResultLen=5;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 5);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,blankString,0,blankString.length,largeMaxLength);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,0,blankRanges.length,largeMaxLength);
  expectedResultLen=blankRanges.length - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 26);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,blanksRight,1,blanksRight.length - 1,largeMaxLength);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,4,blanksBoth.length - 4,largeMaxLength);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,5,blanksBoth.length - 5,largeMaxLength);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,5,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,blankString,1,blankString.length - 1,largeMaxLength);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,4,blankRanges.length - 4,largeMaxLength);
  expectedResultLen=blankRanges.length - 4 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 22);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,6,blankRanges.length - 6,largeMaxLength);
  expectedResultLen=blankRanges.length - 6 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,6,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 20);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,7,blankRanges.length - 7,largeMaxLength);
  expectedResultLen=blankRanges.length - 7 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 19);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,7,8 - 7,largeMaxLength);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  byte[] multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,4,largeMaxLength);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,5,largeMaxLength);
  expectedResultLen=4;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,9,largeMaxLength);
  expectedResultLen=8;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,3,1,largeMaxLength);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,3,2,largeMaxLength);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  byte[] sentenceOne=new byte[100];
  int sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOne,0,sentenceOneLen,largeMaxLength);
  expectedResultLen=sentenceOneLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOne,0,sentenceOneLen - 3,largeMaxLength);
  expectedResultLen=sentenceOneLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  byte[] sentenceTwo=new byte[100];
  int sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwo,0,sentenceTwoLen,largeMaxLength);
  expectedResultLen=sentenceTwoLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwo,0,sentenceTwoLen - 5,largeMaxLength);
  expectedResultLen=sentenceTwoLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  int start;
  byte[] sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,largeMaxLength);
  expectedResultLen=sentenceOnePaddedLeftLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,largeMaxLength);
  expectedResultLen=sentenceOnePaddedLeftLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  byte[] sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,largeMaxLength);
  expectedResultLen=sentenceTwoPaddedLeftLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,largeMaxLength);
  expectedResultLen=sentenceTwoPaddedLeftLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  byte[] sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  int sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,largeMaxLength);
  expectedResultLen=sentenceOnePaddedRightLen - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,largeMaxLength);
  expectedResultLen=sentenceOnePaddedRightLen - 3 - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  byte[] sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  int sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,largeMaxLength);
  expectedResultLen=sentenceTwoPaddedRightLen - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,largeMaxLength);
  expectedResultLen=sentenceTwoPaddedRightLen - 5 - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen,largeMaxLength);
  expectedResultLen=sentenceBlankRangesLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen - 3,largeMaxLength);
  expectedResultLen=sentenceBlankRangesLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,7,17,largeMaxLength);
  expectedResultLen=12;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 8);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,blue,0,blue.length,4);
  expectedResultLen=blue.length;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 4);
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.rightTrimAndTruncate(outV,i,redgreen,0,redgreen.length,8);
  expectedResultLen=redgreen.length;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.rightTrimAndTruncate(outV,i,ascii_sentence,0,ascii_sentence.length,31);
  expectedResultLen=ascii_sentence.length;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.rightTrimAndTruncate(outV,i,blanksLeft,0,blanksLeft.length,5);
  expectedResultLen=blanksLeft.length;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  StringExpr.rightTrimAndTruncate(outV,i,blanksRight,0,blanksRight.length,5);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,0,blanksBoth.length,7);
  expectedResultLen=5;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 5);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,blankString,0,blankString.length,2);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,0,blankRanges.length,30);
  expectedResultLen=blankRanges.length - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 26);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,blanksRight,1,blanksRight.length - 1,4);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,4,blanksBoth.length - 4,3);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,5,blanksBoth.length - 5,2);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,5,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,blankString,1,blankString.length - 1,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,4,blankRanges.length - 4,26);
  expectedResultLen=blankRanges.length - 4 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 22);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,6,blankRanges.length - 6,24);
  expectedResultLen=blankRanges.length - 6 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,6,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 20);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,7,blankRanges.length - 7,23);
  expectedResultLen=blankRanges.length - 7 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 19);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,7,8 - 7,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,4,2);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,5,3);
  expectedResultLen=4;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,9,4);
  expectedResultLen=8;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,3,1,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,3,2,2);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  sentenceOne=new byte[100];
  sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOne,0,sentenceOneLen,10);
  expectedResultLen=sentenceOneLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOne,0,sentenceOneLen - 3,9);
  expectedResultLen=sentenceOneLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  sentenceTwo=new byte[100];
  sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwo,0,sentenceTwoLen,13);
  expectedResultLen=sentenceTwoLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwo,0,sentenceTwoLen - 5,10);
  expectedResultLen=sentenceTwoLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,3 + 10);
  expectedResultLen=sentenceOnePaddedLeftLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,3 + 9);
  expectedResultLen=sentenceOnePaddedLeftLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,2 + 13);
  expectedResultLen=sentenceTwoPaddedLeftLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,2 + 10);
  expectedResultLen=sentenceTwoPaddedLeftLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,10 + 4);
  expectedResultLen=sentenceOnePaddedRightLen - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,9);
  expectedResultLen=sentenceOnePaddedRightLen - 3 - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,13 + 1);
  expectedResultLen=sentenceTwoPaddedRightLen - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,10);
  expectedResultLen=sentenceTwoPaddedRightLen - 5 - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  sentenceBlankRanges=new byte[100];
  sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen,17);
  expectedResultLen=sentenceBlankRangesLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen - 3,16);
  expectedResultLen=sentenceBlankRangesLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,7,17,largeMaxLength);
  expectedResultLen=12;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 8);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,blue,0,blue.length,3);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.rightTrimAndTruncate(outV,i,redgreen,0,redgreen.length,6);
  expectedResultLen=6;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.rightTrimAndTruncate(outV,i,ascii_sentence,0,ascii_sentence.length,30);
  expectedResultLen=30;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.rightTrimAndTruncate(outV,i,blanksLeft,0,blanksLeft.length,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  StringExpr.rightTrimAndTruncate(outV,i,blanksRight,0,blanksRight.length,4);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,0,blanksBoth.length,6);
  expectedResultLen=5;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 5);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,blankString,0,blankString.length,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,0,blankRanges.length,19);
  expectedResultLen=15;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 15);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,blanksRight,1,blanksRight.length - 1,3);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,4,blanksBoth.length - 4,2);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,blanksBoth,5,blanksBoth.length - 5,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,5,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,blankString,1,blankString.length - 1,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,3,6) == 6);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,3,6,5);
  expectedResultLen=4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 4);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,6,blankRanges.length - 6,22);
  expectedResultLen=blankRanges.length - 6 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,6,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 20);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,7,blankRanges.length - 7,10);
  expectedResultLen=8;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 8);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,blankRanges,7,8 - 7,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,4,1);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,5,2);
  expectedResultLen=4;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,0,9,3);
  expectedResultLen=8;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,3,1,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  StringExpr.rightTrimAndTruncate(outV,i,multiByte,3,2,1);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  sentenceOne=new byte[100];
  sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOne,0,sentenceOneLen,7);
  expectedResultLen=sentenceOneLen - 9;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOne,0,sentenceOneLen - 3,6);
  expectedResultLen=13;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  sentenceTwo=new byte[100];
  sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwo,0,sentenceTwoLen,13);
  expectedResultLen=sentenceTwoLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwo,0,sentenceTwoLen - 5,10);
  expectedResultLen=sentenceTwoLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,3 + 8);
  expectedResultLen=sentenceOnePaddedLeftLen - 6;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,3 + 6);
  expectedResultLen=16;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,7);
  expectedResultLen=10;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,6);
  expectedResultLen=10;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,10);
  expectedResultLen=sentenceOnePaddedRightLen - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,7);
  expectedResultLen=17;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,13);
  expectedResultLen=sentenceTwoPaddedRightLen - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,4);
  expectedResultLen=8;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  sentenceBlankRanges=new byte[100];
  sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen,4);
  expectedResultLen=7;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen - 3,6);
  expectedResultLen=11;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,4,12) == 8);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,4,12,6);
  expectedResultLen=7;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 5);
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  StringExpr.rightTrimAndTruncate(outV,i,sentenceBlankRanges,7,17,11);
  expectedResultLen=12;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 8);
  i++;
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColUpper(){
  VectorizedRowBatch batch=makeStringBatchMixedCase();
  StringUpper expr=new StringUpper(0,1);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(mixedUpUpper,0,mixedUpUpper.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void testRightTrimBytesColumnVector(){
  BytesColumnVector outV=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  outV.initBuffer(30);
  int i=0;
  int expectedResultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.rightTrim(outV,i,blue,0,blue.length);
  expectedResultLen=blue.length;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 4);
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.rightTrim(outV,i,redgreen,0,redgreen.length);
  expectedResultLen=redgreen.length;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.rightTrim(outV,i,ascii_sentence,0,ascii_sentence.length);
  expectedResultLen=ascii_sentence.length;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.rightTrim(outV,i,blanksLeft,0,blanksLeft.length);
  expectedResultLen=blanksLeft.length;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  StringExpr.rightTrim(outV,i,blanksRight,0,blanksRight.length);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  StringExpr.rightTrim(outV,i,blanksBoth,0,blanksBoth.length);
  expectedResultLen=5;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 5);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  StringExpr.rightTrim(outV,i,blankString,0,blankString.length);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  StringExpr.rightTrim(outV,i,blankRanges,0,blankRanges.length);
  expectedResultLen=blankRanges.length - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 26);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  StringExpr.rightTrim(outV,i,blanksRight,1,blanksRight.length - 1);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  StringExpr.rightTrim(outV,i,blanksBoth,4,blanksBoth.length - 4);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  StringExpr.rightTrim(outV,i,blanksBoth,5,blanksBoth.length - 5);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,5,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  StringExpr.rightTrim(outV,i,blankString,1,blankString.length - 1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankString,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  StringExpr.rightTrim(outV,i,blankRanges,4,blankRanges.length - 4);
  expectedResultLen=blankRanges.length - 4 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 22);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  StringExpr.rightTrim(outV,i,blankRanges,6,blankRanges.length - 6);
  expectedResultLen=blankRanges.length - 6 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,6,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 20);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  StringExpr.rightTrim(outV,i,blankRanges,7,blankRanges.length - 7);
  expectedResultLen=blankRanges.length - 7 - 4;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 19);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  StringExpr.rightTrim(outV,i,blankRanges,7,8 - 7);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  byte[] multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  StringExpr.rightTrim(outV,i,multiByte,0,4);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  StringExpr.rightTrim(outV,i,multiByte,0,5);
  expectedResultLen=4;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  StringExpr.rightTrim(outV,i,multiByte,0,9);
  expectedResultLen=8;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  StringExpr.rightTrim(outV,i,multiByte,3,1);
  expectedResultLen=0;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 0);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  StringExpr.rightTrim(outV,i,multiByte,3,2);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  byte[] sentenceOne=new byte[100];
  int sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  StringExpr.rightTrim(outV,i,sentenceOne,0,sentenceOneLen);
  expectedResultLen=sentenceOneLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  StringExpr.rightTrim(outV,i,sentenceOne,0,sentenceOneLen - 3);
  expectedResultLen=sentenceOneLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  byte[] sentenceTwo=new byte[100];
  int sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  StringExpr.rightTrim(outV,i,sentenceTwo,0,sentenceTwoLen);
  expectedResultLen=sentenceTwoLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  StringExpr.rightTrim(outV,i,sentenceTwo,0,sentenceTwoLen - 5);
  expectedResultLen=sentenceTwoLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  int start;
  byte[] sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  StringExpr.rightTrim(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen);
  expectedResultLen=sentenceOnePaddedLeftLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  StringExpr.rightTrim(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3);
  expectedResultLen=sentenceOnePaddedLeftLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  byte[] sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  StringExpr.rightTrim(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen);
  expectedResultLen=sentenceTwoPaddedLeftLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  StringExpr.rightTrim(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5);
  expectedResultLen=sentenceTwoPaddedLeftLen - 5;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  byte[] sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  int sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  StringExpr.rightTrim(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen);
  expectedResultLen=sentenceOnePaddedRightLen - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  StringExpr.rightTrim(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4);
  expectedResultLen=sentenceOnePaddedRightLen - 3 - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  byte[] sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  int sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  StringExpr.rightTrim(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen);
  expectedResultLen=sentenceTwoPaddedRightLen - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  StringExpr.rightTrim(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1);
  expectedResultLen=sentenceTwoPaddedRightLen - 5 - 1;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  StringExpr.rightTrim(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen);
  expectedResultLen=sentenceBlankRangesLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  StringExpr.rightTrim(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen - 3);
  expectedResultLen=sentenceBlankRangesLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  StringExpr.rightTrim(outV,i,sentenceBlankRanges,7,17);
  expectedResultLen=12;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 8);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatVarCharScalar(){
  VectorizedRowBatch batch=makeStringBatch();
  StringGroupColConcatVarCharScalar expr=new StringGroupColConcatVarCharScalar(0,new HiveVarchar(new String(red),14),1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testRightTrimAndTruncateScalar(){
  int largeMaxLength=100;
  byte[] result;
  Assert.assertTrue(StringExpr.characterCount(blue) == 4);
  result=StringExpr.rightTrimAndTruncateScalar(blue,largeMaxLength);
  Assert.assertTrue(Arrays.equals(blue,result));
  Assert.assertTrue(StringExpr.characterCount(redgreen) == 8);
  result=StringExpr.rightTrimAndTruncateScalar(redgreen,largeMaxLength);
  Assert.assertTrue(Arrays.equals(redgreen,result));
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence) == 31);
  result=StringExpr.rightTrimAndTruncateScalar(ascii_sentence,largeMaxLength);
  Assert.assertTrue(Arrays.equals(ascii_sentence,result));
  Assert.assertTrue(StringExpr.characterCount(blanksLeft) == 5);
  result=StringExpr.rightTrimAndTruncateScalar(blanksLeft,largeMaxLength);
  Assert.assertTrue(Arrays.equals(blanksLeft,result));
  Assert.assertTrue(StringExpr.characterCount(blue) == 4);
  result=StringExpr.rightTrimAndTruncateScalar(blue,blue.length);
  Assert.assertTrue(Arrays.equals(blue,result));
  Assert.assertTrue(StringExpr.characterCount(redgreen) == 8);
  result=StringExpr.rightTrimAndTruncateScalar(redgreen,redgreen.length);
  Assert.assertTrue(Arrays.equals(redgreen,result));
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence) == 31);
  result=StringExpr.rightTrimAndTruncateScalar(ascii_sentence,ascii_sentence.length);
  Assert.assertTrue(Arrays.equals(ascii_sentence,result));
  Assert.assertTrue(StringExpr.characterCount(blanksLeft) == 5);
  result=StringExpr.rightTrimAndTruncateScalar(blanksLeft,blanksLeft.length);
  Assert.assertTrue(Arrays.equals(blanksLeft,result));
  result=StringExpr.rightTrimAndTruncateScalar(blue,3);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blue,3),result));
  result=StringExpr.rightTrimAndTruncateScalar(redgreen,6);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(redgreen,6),result));
  result=StringExpr.rightTrimAndTruncateScalar(ascii_sentence,14);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(ascii_sentence,14),result));
  result=StringExpr.rightTrimAndTruncateScalar(blanksLeft,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blanksLeft,0),result));
  result=StringExpr.rightTrimAndTruncateScalar(blanksRight,4);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blanksRight,3),result));
  result=StringExpr.rightTrimAndTruncateScalar(blanksBoth,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blanksBoth,0),result));
  result=StringExpr.rightTrimAndTruncateScalar(blankString,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blankString,0),result));
  result=StringExpr.rightTrimAndTruncateScalar(blankRanges,29);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(blankRanges,26),result));
  byte[] scratch=new byte[100];
  byte[] multiByte;
  addMultiByteCharRightPadded1_1(scratch);
  multiByte=Arrays.copyOf(scratch,4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  result=StringExpr.rightTrimAndTruncateScalar(multiByte,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,3),result));
  addMultiByteCharRightPadded1_2(scratch);
  multiByte=Arrays.copyOf(scratch,5);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  result=StringExpr.rightTrimAndTruncateScalar(multiByte,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,4),result));
  addMultiByteCharRightPadded1_3(scratch);
  multiByte=Arrays.copyOf(scratch,9);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  result=StringExpr.rightTrimAndTruncateScalar(multiByte,2);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,5),result));
  addMultiByteCharRightPadded1_2(scratch);
  multiByte=Arrays.copyOfRange(scratch,3,3 + 2);
  Assert.assertTrue(StringExpr.characterCount(multiByte) == 2);
  result=StringExpr.rightTrimAndTruncateScalar(multiByte,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(multiByte,1),result));
  int sentenceOneLen=addMultiByteCharSentenceOne(scratch,0);
  byte[] sentenceOne=Arrays.copyOf(scratch,sentenceOneLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne) == 10);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceOne,8);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOne,20),result));
  byte[] sentenceOnePortion=Arrays.copyOf(sentenceOne,sentenceOneLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePortion) == 9);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceOnePortion,3);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePortion,9),result));
  int sentenceTwoLen=addMultiByteCharSentenceTwo(scratch,0);
  byte[] sentenceTwo=Arrays.copyOf(scratch,sentenceTwoLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo) == 13);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceTwo,9);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwo,16),result));
  byte[] sentenceTwoPortion=Arrays.copyOf(sentenceTwo,sentenceTwoLen - 5);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPortion) == 10);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceTwoPortion,6);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPortion,11),result));
  int start;
  start=addPads(scratch,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(scratch,start);
  byte[] sentenceOnePaddedLeft=Arrays.copyOf(scratch,sentenceOnePaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft) == 3 + 10);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceOnePaddedLeft,4);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedLeft,6),result));
  byte[] sentenceOnePaddedLeftPortion=Arrays.copyOf(sentenceOnePaddedLeft,sentenceOnePaddedLeftLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeftPortion) == 3 + 9);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceOnePaddedLeftPortion,7);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedLeftPortion,12),result));
  start=addPads(scratch,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(scratch,start);
  byte[] sentenceTwoPaddedLeft=Arrays.copyOf(scratch,sentenceTwoPaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft) == 2 + 13);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceTwoPaddedLeft,14);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedLeft,24),result));
  byte[] sentenceTwoPaddedLeftPortion=Arrays.copyOf(sentenceTwoPaddedLeft,sentenceTwoPaddedLeftLen - 5);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeftPortion) == 2 + 10);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceTwoPaddedLeftPortion,9);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedLeftPortion,15),result));
  start=addMultiByteCharSentenceOne(scratch,0);
  int sentenceOnePaddedRightLen=addPads(scratch,start,4);
  byte[] sentenceOnePaddedRight=Arrays.copyOf(scratch,sentenceOnePaddedRightLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight) == 10 + 4);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceOnePaddedRight,1);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedRight,3),result));
  byte[] sentenceOnePaddedRightPortion=Arrays.copyOf(sentenceOnePaddedRight,sentenceOnePaddedRightLen - 3 - 4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRightPortion) == 9);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceOnePaddedRightPortion,5);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceOnePaddedRightPortion,13),result));
  start=addMultiByteCharSentenceTwo(scratch,0);
  int sentenceTwoPaddedRightLen=addPads(scratch,start,1);
  byte[] sentenceTwoPaddedRight=Arrays.copyOf(scratch,sentenceTwoPaddedRightLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight) == 13 + 1);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceTwoPaddedRight,6);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedRight,11),result));
  byte[] sentenceTwoPaddedRightPortion=Arrays.copyOf(sentenceTwoPaddedRight,sentenceTwoPaddedRightLen - 5 - 1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRightPortion) == 10);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceTwoPaddedRightPortion,8);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceTwoPaddedRightPortion,13),result));
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(scratch,0);
  byte[] sentenceBlankRanges=Arrays.copyOf(scratch,sentenceBlankRangesLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges) == 17);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceBlankRanges,4);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceBlankRanges,7),result));
  byte[] sentenceBlankRangesPortion=Arrays.copyOf(sentenceBlankRanges,sentenceBlankRangesLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRangesPortion) == 16);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceBlankRangesPortion,14);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceBlankRangesPortion,19),result));
  sentenceBlankRangesPortion=Arrays.copyOfRange(sentenceBlankRanges,7,7 + 17);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRangesPortion) == 13);
  result=StringExpr.rightTrimAndTruncateScalar(sentenceBlankRangesPortion,11);
  Assert.assertTrue(Arrays.equals(Arrays.copyOf(sentenceBlankRangesPortion,12),result));
  Assert.assertTrue(StringExpr.characterCount(result) == 8);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatStringScalar(){
  VectorizedRowBatch batch=makeStringBatch();
  StringGroupColConcatStringScalar expr=new StringGroupColConcatStringScalar(0,red,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCharScalarConcatCol(){
  VectorizedRowBatch batch=makeStringBatch();
  CharScalarConcatStringGroupCol expr=new CharScalarConcatStringGroupCol(new HiveChar(new String(red),6),0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testTruncateBytesSlice(){
  int largeMaxLength=100;
  int resultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.truncate(blue,0,blue.length,largeMaxLength);
  Assert.assertTrue(resultLen == blue.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.truncate(redgreen,0,redgreen.length,largeMaxLength);
  Assert.assertTrue(resultLen == redgreen.length);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.truncate(ascii_sentence,0,ascii_sentence.length,largeMaxLength);
  Assert.assertTrue(resultLen == ascii_sentence.length);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.truncate(blanksLeft,0,blanksLeft.length,largeMaxLength);
  Assert.assertTrue(resultLen == blanksLeft.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.truncate(blue,0,blue.length,4);
  Assert.assertTrue(resultLen == blue.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.truncate(redgreen,0,redgreen.length,8);
  Assert.assertTrue(resultLen == redgreen.length);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.truncate(ascii_sentence,0,ascii_sentence.length,31);
  Assert.assertTrue(resultLen == ascii_sentence.length);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.truncate(blanksLeft,0,blanksLeft.length,5);
  Assert.assertTrue(resultLen == blanksLeft.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.truncate(blue,0,blue.length,3);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.truncate(redgreen,0,redgreen.length,6);
  Assert.assertTrue(resultLen == 6);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.truncate(ascii_sentence,0,ascii_sentence.length,14);
  Assert.assertTrue(resultLen == 14);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.truncate(blanksLeft,0,blanksLeft.length,2);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  resultLen=StringExpr.truncate(blanksRight,0,blanksRight.length,4);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  resultLen=StringExpr.truncate(blanksBoth,0,blanksBoth.length,2);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,resultLen) == 2);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  resultLen=StringExpr.truncate(blankString,0,blankString.length,1);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,resultLen) == 1);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  resultLen=StringExpr.truncate(blankRanges,0,blankRanges.length,29);
  Assert.assertTrue(resultLen == 29);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,resultLen) == 29);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  resultLen=StringExpr.truncate(blanksRight,1,blanksRight.length - 1,3);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  resultLen=StringExpr.truncate(blanksBoth,4,blanksBoth.length - 4,2);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,resultLen) == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  resultLen=StringExpr.truncate(blanksBoth,5,blanksBoth.length - 5,1);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,resultLen) == 1);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  resultLen=StringExpr.truncate(blankRanges,4,blankRanges.length - 4,22);
  Assert.assertTrue(resultLen == 22);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,resultLen) == 22);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  resultLen=StringExpr.truncate(blankRanges,6,blankRanges.length - 6,7);
  Assert.assertTrue(resultLen == 7);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,resultLen) == 7);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  resultLen=StringExpr.truncate(blankRanges,7,blankRanges.length - 7,20);
  Assert.assertTrue(resultLen == 20);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 20);
  byte[] multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  resultLen=StringExpr.truncate(multiByte,0,4,1);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 1);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  resultLen=StringExpr.truncate(multiByte,0,5,2);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 2);
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  resultLen=StringExpr.truncate(multiByte,0,9,2);
  Assert.assertTrue(resultLen == 5);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 2);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  resultLen=StringExpr.truncate(multiByte,3,2,1);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,resultLen) == 1);
  byte[] sentenceOne=new byte[100];
  int sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  resultLen=StringExpr.truncate(sentenceOne,0,sentenceOneLen,8);
  Assert.assertTrue(resultLen == 20);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  resultLen=StringExpr.truncate(sentenceOne,0,sentenceOneLen - 3,3);
  Assert.assertTrue(resultLen == 9);
  byte[] sentenceTwo=new byte[100];
  int sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  resultLen=StringExpr.truncate(sentenceTwo,0,sentenceTwoLen,9);
  Assert.assertTrue(resultLen == 16);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  resultLen=StringExpr.truncate(sentenceTwo,0,sentenceTwoLen - 5,6);
  Assert.assertTrue(resultLen == 11);
  int start;
  byte[] sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  resultLen=StringExpr.truncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,4);
  Assert.assertTrue(resultLen == 6);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  resultLen=StringExpr.truncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,7);
  Assert.assertTrue(resultLen == 13);
  byte[] sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  resultLen=StringExpr.truncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,14);
  Assert.assertTrue(resultLen == 24);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  resultLen=StringExpr.truncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,9);
  Assert.assertTrue(resultLen == 15);
  byte[] sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  int sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  resultLen=StringExpr.truncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,1);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  resultLen=StringExpr.truncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,5);
  Assert.assertTrue(resultLen == 13);
  byte[] sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  int sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  resultLen=StringExpr.truncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,6);
  Assert.assertTrue(resultLen == 11);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  resultLen=StringExpr.truncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,8);
  Assert.assertTrue(resultLen == 14);
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  resultLen=StringExpr.truncate(sentenceBlankRanges,0,sentenceBlankRangesLen,4);
  Assert.assertTrue(resultLen == 9);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  resultLen=StringExpr.truncate(sentenceBlankRanges,0,sentenceBlankRangesLen - 3,14);
  Assert.assertTrue(resultLen == 23);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  resultLen=StringExpr.truncate(sentenceBlankRanges,7,17,11);
  Assert.assertTrue(resultLen == 15);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,resultLen) == 11);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringScalarConcatCol(){
  VectorizedRowBatch batch=makeStringBatch();
  StringScalarConcatStringGroupCol expr=new StringScalarConcatStringGroupCol(red,0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void testTruncateBytesColumnVector(){
  BytesColumnVector outV=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  outV.initBuffer(35);
  int i=0;
  int largeMaxLength=100;
  int expectedResultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.truncate(outV,i,blue,0,blue.length,largeMaxLength);
  expectedResultLen=blue.length;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 4);
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.truncate(outV,i,redgreen,0,redgreen.length,largeMaxLength);
  expectedResultLen=redgreen.length;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.truncate(outV,i,ascii_sentence,0,ascii_sentence.length,largeMaxLength);
  expectedResultLen=ascii_sentence.length;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.truncate(outV,i,blanksLeft,0,blanksLeft.length,largeMaxLength);
  expectedResultLen=blanksLeft.length;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.truncate(outV,i,blue,0,blue.length,4);
  expectedResultLen=blue.length;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 4);
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.truncate(outV,i,redgreen,0,redgreen.length,8);
  expectedResultLen=redgreen.length;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.truncate(outV,i,ascii_sentence,0,ascii_sentence.length,31);
  expectedResultLen=ascii_sentence.length;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.truncate(outV,i,blanksLeft,0,blanksLeft.length,5);
  expectedResultLen=blanksLeft.length;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.truncate(outV,i,blue,0,blue.length,3);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.truncate(outV,i,redgreen,0,redgreen.length,6);
  expectedResultLen=6;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.truncate(outV,i,ascii_sentence,0,ascii_sentence.length,14);
  expectedResultLen=14;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.truncate(outV,i,blanksLeft,0,blanksLeft.length,2);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  StringExpr.truncate(outV,i,blanksRight,0,blanksRight.length,4);
  expectedResultLen=4;
  Assert.assertTrue(vectorCharacterCount(outV,i) == 4);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  StringExpr.truncate(outV,i,blanksBoth,0,blanksBoth.length,2);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  StringExpr.truncate(outV,i,blankString,0,blankString.length,1);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,blankString,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  StringExpr.truncate(outV,i,blankRanges,0,blankRanges.length,29);
  expectedResultLen=29;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 29);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  StringExpr.truncate(outV,i,blanksRight,1,blanksRight.length - 1,3);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,blanksRight,1,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 3);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  StringExpr.truncate(outV,i,blanksBoth,4,blanksBoth.length - 4,2);
  expectedResultLen=2;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  StringExpr.truncate(outV,i,blanksBoth,5,blanksBoth.length - 5,1);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,blanksBoth,5,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  StringExpr.truncate(outV,i,blankRanges,4,blankRanges.length - 4,22);
  expectedResultLen=22;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 22);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  StringExpr.truncate(outV,i,blankRanges,6,blankRanges.length - 6,7);
  expectedResultLen=7;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,6,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 7);
  i++;
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  StringExpr.truncate(outV,i,blankRanges,7,blankRanges.length - 7,20);
  expectedResultLen=20;
  Assert.assertTrue(vectorEqual(outV,i,blankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 20);
  i++;
  byte[] multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  StringExpr.truncate(outV,i,multiByte,0,4,1);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  StringExpr.truncate(outV,i,multiByte,0,5,2);
  expectedResultLen=4;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  StringExpr.truncate(outV,i,multiByte,0,9,2);
  expectedResultLen=5;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,0,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 2);
  i++;
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  StringExpr.truncate(outV,i,multiByte,3,2,1);
  expectedResultLen=1;
  Assert.assertTrue(vectorEqual(outV,i,multiByte,3,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 1);
  i++;
  byte[] sentenceOne=new byte[100];
  int sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  StringExpr.truncate(outV,i,sentenceOne,0,sentenceOneLen,8);
  expectedResultLen=20;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  StringExpr.truncate(outV,i,sentenceOne,0,sentenceOneLen - 3,3);
  expectedResultLen=9;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOne,0,expectedResultLen));
  i++;
  byte[] sentenceTwo=new byte[100];
  int sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  StringExpr.truncate(outV,i,sentenceTwo,0,sentenceTwoLen,9);
  expectedResultLen=16;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  StringExpr.truncate(outV,i,sentenceTwo,0,sentenceTwoLen - 5,6);
  expectedResultLen=11;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwo,0,expectedResultLen));
  i++;
  int start;
  byte[] sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  StringExpr.truncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,4);
  expectedResultLen=6;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  StringExpr.truncate(outV,i,sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,7);
  expectedResultLen=13;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedLeft,0,expectedResultLen));
  i++;
  byte[] sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  StringExpr.truncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,14);
  expectedResultLen=24;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  StringExpr.truncate(outV,i,sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,9);
  expectedResultLen=15;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedLeft,0,expectedResultLen));
  i++;
  byte[] sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  int sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  StringExpr.truncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,1);
  expectedResultLen=3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  StringExpr.truncate(outV,i,sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,5);
  expectedResultLen=13;
  Assert.assertTrue(vectorEqual(outV,i,sentenceOnePaddedRight,0,expectedResultLen));
  i++;
  byte[] sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  int sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  StringExpr.truncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,6);
  expectedResultLen=11;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  StringExpr.truncate(outV,i,sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,8);
  expectedResultLen=14;
  Assert.assertTrue(vectorEqual(outV,i,sentenceTwoPaddedRight,0,expectedResultLen));
  i++;
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  StringExpr.truncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen,4);
  expectedResultLen=9;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  StringExpr.truncate(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen - 3,14);
  expectedResultLen=23;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  StringExpr.truncate(outV,i,sentenceBlankRanges,7,17,11);
  expectedResultLen=15;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 11);
  i++;
}

</code></pre>

<br>
<pre class="type-11 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testRightTrimBytesSlice(){
  int resultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.rightTrim(blue,0,blue.length);
  Assert.assertTrue(resultLen == blue.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.rightTrim(redgreen,0,redgreen.length);
  Assert.assertTrue(resultLen == redgreen.length);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.rightTrim(ascii_sentence,0,ascii_sentence.length);
  Assert.assertTrue(resultLen == ascii_sentence.length);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.rightTrim(blanksLeft,0,blanksLeft.length);
  Assert.assertTrue(resultLen == blanksLeft.length);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  resultLen=StringExpr.rightTrim(blanksRight,0,blanksRight.length);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  resultLen=StringExpr.rightTrim(blanksBoth,0,blanksBoth.length);
  Assert.assertTrue(resultLen == 5);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,resultLen) == 5);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  resultLen=StringExpr.rightTrim(blankString,0,blankString.length);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  resultLen=StringExpr.rightTrim(blankRanges,0,blankRanges.length);
  Assert.assertTrue(resultLen == blankRanges.length - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,resultLen) == 26);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  resultLen=StringExpr.rightTrim(blanksRight,1,blanksRight.length - 1);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,resultLen) == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  resultLen=StringExpr.rightTrim(blanksBoth,4,blanksBoth.length - 4);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,resultLen) == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  resultLen=StringExpr.rightTrim(blanksBoth,5,blanksBoth.length - 5);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  resultLen=StringExpr.rightTrim(blankString,1,blankString.length - 1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  resultLen=StringExpr.rightTrim(blankRanges,4,blankRanges.length - 4);
  Assert.assertTrue(resultLen == blankRanges.length - 4 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,resultLen) == 22);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  resultLen=StringExpr.rightTrim(blankRanges,6,blankRanges.length - 6);
  Assert.assertTrue(resultLen == blankRanges.length - 6 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,resultLen) == 20);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  resultLen=StringExpr.rightTrim(blankRanges,7,blankRanges.length - 7);
  Assert.assertTrue(resultLen == blankRanges.length - 7 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 19);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  resultLen=StringExpr.rightTrim(blankRanges,7,8 - 7);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 0);
  byte[] multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  resultLen=StringExpr.rightTrim(multiByte,0,4);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 1);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  resultLen=StringExpr.rightTrim(multiByte,0,5);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 2);
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  resultLen=StringExpr.rightTrim(multiByte,0,9);
  Assert.assertTrue(resultLen == 8);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 3);
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  resultLen=StringExpr.rightTrim(multiByte,3,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 0);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  resultLen=StringExpr.rightTrim(multiByte,3,2);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,resultLen) == 1);
  byte[] sentenceOne=new byte[100];
  int sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  resultLen=StringExpr.rightTrim(sentenceOne,0,sentenceOneLen);
  Assert.assertTrue(resultLen == sentenceOneLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  resultLen=StringExpr.rightTrim(sentenceOne,0,sentenceOneLen - 3);
  Assert.assertTrue(resultLen == sentenceOneLen - 3);
  byte[] sentenceTwo=new byte[100];
  int sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  resultLen=StringExpr.rightTrim(sentenceTwo,0,sentenceTwoLen);
  Assert.assertTrue(resultLen == sentenceTwoLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  resultLen=StringExpr.rightTrim(sentenceTwo,0,sentenceTwoLen - 5);
  Assert.assertTrue(resultLen == sentenceTwoLen - 5);
  int start;
  byte[] sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  resultLen=StringExpr.rightTrim(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  resultLen=StringExpr.rightTrim(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen - 3);
  byte[] sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  resultLen=StringExpr.rightTrim(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen);
  Assert.assertTrue(resultLen == sentenceTwoPaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  resultLen=StringExpr.rightTrim(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5);
  Assert.assertTrue(resultLen == sentenceTwoPaddedLeftLen - 5);
  byte[] sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  int sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  resultLen=StringExpr.rightTrim(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  resultLen=StringExpr.rightTrim(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 3 - 4);
  byte[] sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  int sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  resultLen=StringExpr.rightTrim(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  resultLen=StringExpr.rightTrim(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 5 - 1);
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  resultLen=StringExpr.rightTrim(sentenceBlankRanges,0,sentenceBlankRangesLen);
  Assert.assertTrue(resultLen == sentenceBlankRangesLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  resultLen=StringExpr.rightTrim(sentenceBlankRanges,0,sentenceBlankRangesLen - 3);
  Assert.assertTrue(resultLen == sentenceBlankRangesLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  resultLen=StringExpr.rightTrim(sentenceBlankRanges,7,17);
  Assert.assertTrue(resultLen == 12);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,resultLen) == 8);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testVarCharScalarConcatCol(){
  VectorizedRowBatch batch=makeStringBatch();
  VarCharScalarConcatStringGroupCol expr=new VarCharScalarConcatStringGroupCol(new HiveVarchar(new String(red),14),0,1);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[1];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertFalse(outCol.noNulls);
  batch=makeStringBatch();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[1];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isRepeating);
  Assert.assertTrue(outCol.noNulls);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void testLoadBytesColumnVectorByRef(){
  BytesColumnVector bcv=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  String s="red";
  byte[] b=null;
  try {
    b=s.getBytes("UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    e.printStackTrace();
  }
  for (int i=0; i != VectorizedRowBatch.DEFAULT_SIZE; i++) {
    bcv.setRef(i,b,0,b.length);
  }
  byte[] v=new byte[b.length];
  for (int i=0; i != VectorizedRowBatch.DEFAULT_SIZE; i++) {
    Assert.assertTrue(bcv.length[i] == b.length);
    System.arraycopy(bcv.vector[i],bcv.start[i],v,0,b.length);
    Assert.assertTrue(Arrays.equals(b,v));
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testRightTrimAndTruncateBytesSlice(){
  int largeMaxLength=100;
  int resultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(blue,0,blue.length,largeMaxLength);
  Assert.assertTrue(resultLen == blue.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.rightTrimAndTruncate(redgreen,0,redgreen.length,largeMaxLength);
  Assert.assertTrue(resultLen == redgreen.length);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.rightTrimAndTruncate(ascii_sentence,0,ascii_sentence.length,largeMaxLength);
  Assert.assertTrue(resultLen == ascii_sentence.length);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.rightTrimAndTruncate(blanksLeft,0,blanksLeft.length,largeMaxLength);
  Assert.assertTrue(resultLen == blanksLeft.length);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  resultLen=StringExpr.rightTrimAndTruncate(blanksRight,0,blanksRight.length,largeMaxLength);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,0,blanksBoth.length,largeMaxLength);
  Assert.assertTrue(resultLen == 5);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,resultLen) == 5);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(blankString,0,blankString.length,largeMaxLength);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,0,blankRanges.length,largeMaxLength);
  Assert.assertTrue(resultLen == blankRanges.length - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,resultLen) == 26);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(blanksRight,1,blanksRight.length - 1,largeMaxLength);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,resultLen) == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,4,blanksBoth.length - 4,largeMaxLength);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,resultLen) == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,5,blanksBoth.length - 5,largeMaxLength);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(blankString,1,blankString.length - 1,largeMaxLength);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,4,blankRanges.length - 4,largeMaxLength);
  Assert.assertTrue(resultLen == blankRanges.length - 4 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,resultLen) == 22);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,6,blankRanges.length - 6,largeMaxLength);
  Assert.assertTrue(resultLen == blankRanges.length - 6 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,resultLen) == 20);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,7,blankRanges.length - 7,largeMaxLength);
  Assert.assertTrue(resultLen == blankRanges.length - 7 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 19);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,7,8 - 7,largeMaxLength);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 0);
  byte[] multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,4,largeMaxLength);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 1);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,5,largeMaxLength);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 2);
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,9,largeMaxLength);
  Assert.assertTrue(resultLen == 8);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 3);
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,3,1,largeMaxLength);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 0);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,3,2,largeMaxLength);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,resultLen) == 1);
  byte[] sentenceOne=new byte[100];
  int sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOne,0,sentenceOneLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceOneLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOne,0,sentenceOneLen - 3,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceOneLen - 3);
  byte[] sentenceTwo=new byte[100];
  int sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwo,0,sentenceTwoLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceTwoLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwo,0,sentenceTwoLen - 5,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceTwoLen - 5);
  int start;
  byte[] sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  int sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen - 3);
  byte[] sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  int sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceTwoPaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceTwoPaddedLeftLen - 5);
  byte[] sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  int sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 3 - 4);
  byte[] sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  int sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 5 - 1);
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,0,sentenceBlankRangesLen,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceBlankRangesLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,0,sentenceBlankRangesLen - 3,largeMaxLength);
  Assert.assertTrue(resultLen == sentenceBlankRangesLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,7,17,largeMaxLength);
  Assert.assertTrue(resultLen == 12);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,resultLen) == 8);
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(blue,0,blue.length,4);
  Assert.assertTrue(resultLen == blue.length);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.rightTrimAndTruncate(redgreen,0,redgreen.length,8);
  Assert.assertTrue(resultLen == redgreen.length);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.rightTrimAndTruncate(ascii_sentence,0,ascii_sentence.length,31);
  Assert.assertTrue(resultLen == ascii_sentence.length);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.rightTrimAndTruncate(blanksLeft,0,blanksLeft.length,5);
  Assert.assertTrue(resultLen == blanksLeft.length);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  resultLen=StringExpr.rightTrimAndTruncate(blanksRight,0,blanksRight.length,5);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,0,blanksBoth.length,7);
  Assert.assertTrue(resultLen == 5);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,resultLen) == 5);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(blankString,0,blankString.length,2);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,0,blankRanges.length,30);
  Assert.assertTrue(resultLen == blankRanges.length - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,resultLen) == 26);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(blanksRight,1,blanksRight.length - 1,4);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,resultLen) == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,4,blanksBoth.length - 4,3);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,resultLen) == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,5,blanksBoth.length - 5,2);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(blankString,1,blankString.length - 1,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,blankRanges.length - 4) == 26);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,4,blankRanges.length - 4,26);
  Assert.assertTrue(resultLen == blankRanges.length - 4 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,4,resultLen) == 22);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,6,blankRanges.length - 6,24);
  Assert.assertTrue(resultLen == blankRanges.length - 6 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,resultLen) == 20);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,7,blankRanges.length - 7,23);
  Assert.assertTrue(resultLen == blankRanges.length - 7 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 19);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,7,8 - 7,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 0);
  multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,4,2);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 1);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,5,3);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 2);
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,9,4);
  Assert.assertTrue(resultLen == 8);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 3);
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,3,1,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 0);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,3,2,2);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,resultLen) == 1);
  sentenceOne=new byte[100];
  sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOne,0,sentenceOneLen,10);
  Assert.assertTrue(resultLen == sentenceOneLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOne,0,sentenceOneLen - 3,9);
  Assert.assertTrue(resultLen == sentenceOneLen - 3);
  sentenceTwo=new byte[100];
  sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwo,0,sentenceTwoLen,13);
  Assert.assertTrue(resultLen == sentenceTwoLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwo,0,sentenceTwoLen - 5,10);
  Assert.assertTrue(resultLen == sentenceTwoLen - 5);
  sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,3 + 10);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,3 + 9);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen - 3);
  sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,2 + 13);
  Assert.assertTrue(resultLen == sentenceTwoPaddedLeftLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,2 + 10);
  Assert.assertTrue(resultLen == sentenceTwoPaddedLeftLen - 5);
  sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,10 + 4);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,9);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 3 - 4);
  sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,13 + 1);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,10);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 5 - 1);
  sentenceBlankRanges=new byte[100];
  sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,0,sentenceBlankRangesLen,17);
  Assert.assertTrue(resultLen == sentenceBlankRangesLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,0,sentenceBlankRangesLen - 3,16);
  Assert.assertTrue(resultLen == sentenceBlankRangesLen - 3);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,7,17,largeMaxLength);
  Assert.assertTrue(resultLen == 12);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,resultLen) == 8);
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(blue,0,blue.length,3);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blue,0,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  resultLen=StringExpr.rightTrimAndTruncate(redgreen,0,redgreen.length,6);
  Assert.assertTrue(resultLen == 6);
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  resultLen=StringExpr.rightTrimAndTruncate(ascii_sentence,0,ascii_sentence.length,30);
  Assert.assertTrue(resultLen == 30);
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  resultLen=StringExpr.rightTrimAndTruncate(blanksLeft,0,blanksLeft.length,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,blanksRight.length) == 5);
  resultLen=StringExpr.rightTrimAndTruncate(blanksRight,0,blanksRight.length,4);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,0,resultLen) == 3);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,blanksBoth.length) == 7);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,0,blanksBoth.length,6);
  Assert.assertTrue(resultLen == 5);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,0,resultLen) == 5);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,blankString.length) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(blankString,0,blankString.length,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,0,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,blankRanges.length) == 30);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,0,blankRanges.length,19);
  Assert.assertTrue(resultLen == 15);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,0,resultLen) == 15);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,blanksRight.length - 1) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(blanksRight,1,blanksRight.length - 1,3);
  Assert.assertTrue(resultLen == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksRight,1,resultLen) == 2);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,blanksBoth.length - 4) == 3);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,4,blanksBoth.length - 4,2);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,4,resultLen) == 1);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,blanksBoth.length - 5) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(blanksBoth,5,blanksBoth.length - 5,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blanksBoth,5,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,blankString.length - 1) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(blankString,1,blankString.length - 1,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankString,1,resultLen) == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,3,6) == 6);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,3,6,5);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,3,resultLen) == 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,blankRanges.length - 6) == 24);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,6,blankRanges.length - 6,22);
  Assert.assertTrue(resultLen == blankRanges.length - 6 - 4);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,6,resultLen) == 20);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,blankRanges.length - 7) == 23);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,7,blankRanges.length - 7,10);
  Assert.assertTrue(resultLen == 8);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 8);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,8 - 7) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(blankRanges,7,8 - 7,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(blankRanges,7,resultLen) == 0);
  multiByte=new byte[100];
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,4) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,4,1);
  Assert.assertTrue(resultLen == 3);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 1);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,5) == 3);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,5,2);
  Assert.assertTrue(resultLen == 4);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 2);
  addMultiByteCharRightPadded1_3(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,9) == 4);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,0,9,3);
  Assert.assertTrue(resultLen == 8);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 3);
  addMultiByteCharRightPadded1_1(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,1) == 1);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,3,1,1);
  Assert.assertTrue(resultLen == 0);
  Assert.assertTrue(StringExpr.characterCount(multiByte,0,resultLen) == 0);
  addMultiByteCharRightPadded1_2(multiByte);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,2) == 2);
  resultLen=StringExpr.rightTrimAndTruncate(multiByte,3,2,1);
  Assert.assertTrue(resultLen == 1);
  Assert.assertTrue(StringExpr.characterCount(multiByte,3,resultLen) == 1);
  sentenceOne=new byte[100];
  sentenceOneLen=addMultiByteCharSentenceOne(sentenceOne,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOne,0,sentenceOneLen,7);
  Assert.assertTrue(resultLen == sentenceOneLen - 9);
  Assert.assertTrue(StringExpr.characterCount(sentenceOne,0,sentenceOneLen - 3) == 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOne,0,sentenceOneLen - 3,6);
  Assert.assertTrue(resultLen == 13);
  sentenceTwo=new byte[100];
  sentenceTwoLen=addMultiByteCharSentenceTwo(sentenceTwo,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen) == 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwo,0,sentenceTwoLen,13);
  Assert.assertTrue(resultLen == sentenceTwoLen);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwo,0,sentenceTwoLen - 5) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwo,0,sentenceTwoLen - 5,10);
  Assert.assertTrue(resultLen == sentenceTwoLen - 5);
  sentenceOnePaddedLeft=new byte[100];
  start=addPads(sentenceOnePaddedLeft,0,3);
  sentenceOnePaddedLeftLen=addMultiByteCharSentenceOne(sentenceOnePaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen) == 3 + 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen,3 + 8);
  Assert.assertTrue(resultLen == sentenceOnePaddedLeftLen - 6);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3) == 3 + 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedLeft,0,sentenceOnePaddedLeftLen - 3,3 + 6);
  Assert.assertTrue(resultLen == 16);
  sentenceTwoPaddedLeft=new byte[100];
  start=addPads(sentenceTwoPaddedLeft,0,2);
  sentenceTwoPaddedLeftLen=addMultiByteCharSentenceTwo(sentenceTwoPaddedLeft,start);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen) == 2 + 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen,7);
  Assert.assertTrue(resultLen == 10);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5) == 2 + 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedLeft,0,sentenceTwoPaddedLeftLen - 5,6);
  Assert.assertTrue(resultLen == 10);
  sentenceOnePaddedRight=new byte[100];
  start=addMultiByteCharSentenceOne(sentenceOnePaddedRight,0);
  sentenceOnePaddedRightLen=addPads(sentenceOnePaddedRight,start,4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen) == 10 + 4);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen,10);
  Assert.assertTrue(resultLen == sentenceOnePaddedRightLen - 4);
  Assert.assertTrue(StringExpr.characterCount(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4) == 9);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceOnePaddedRight,0,sentenceOnePaddedRightLen - 3 - 4,7);
  Assert.assertTrue(resultLen == 17);
  sentenceTwoPaddedRight=new byte[100];
  start=addMultiByteCharSentenceTwo(sentenceTwoPaddedRight,0);
  sentenceTwoPaddedRightLen=addPads(sentenceTwoPaddedRight,start,1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen) == 13 + 1);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen,13);
  Assert.assertTrue(resultLen == sentenceTwoPaddedRightLen - 1);
  Assert.assertTrue(StringExpr.characterCount(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1) == 10);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceTwoPaddedRight,0,sentenceTwoPaddedRightLen - 5 - 1,4);
  Assert.assertTrue(resultLen == 8);
  sentenceBlankRanges=new byte[100];
  sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,0,sentenceBlankRangesLen,4);
  Assert.assertTrue(resultLen == 7);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,0,sentenceBlankRangesLen - 3,6);
  Assert.assertTrue(resultLen == 11);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,4,12) == 8);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,4,12,6);
  Assert.assertTrue(resultLen == 7);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,4,resultLen) == 5);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  resultLen=StringExpr.rightTrimAndTruncate(sentenceBlankRanges,7,17,11);
  Assert.assertTrue(resultLen == 12);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,resultLen) == 8);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void testAssignBytesColumnVector(){
  BytesColumnVector outV=new BytesColumnVector(VectorizedRowBatch.DEFAULT_SIZE);
  outV.initBuffer(35);
  int i=0;
  int expectedResultLen;
  Assert.assertTrue(StringExpr.characterCount(blue,0,blue.length) == 4);
  StringExpr.assign(outV,i,blue,0,blue.length);
  expectedResultLen=blue.length;
  Assert.assertTrue(vectorEqual(outV,i,blue,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(redgreen,0,redgreen.length) == 8);
  StringExpr.assign(outV,i,redgreen,0,redgreen.length);
  expectedResultLen=redgreen.length;
  Assert.assertTrue(vectorEqual(outV,i,redgreen,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(ascii_sentence,0,ascii_sentence.length) == 31);
  StringExpr.assign(outV,i,ascii_sentence,0,ascii_sentence.length);
  expectedResultLen=ascii_sentence.length;
  Assert.assertTrue(vectorEqual(outV,i,ascii_sentence,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(blanksLeft,0,blanksLeft.length) == 5);
  StringExpr.assign(outV,i,blanksLeft,0,blanksLeft.length);
  expectedResultLen=blanksLeft.length;
  Assert.assertTrue(vectorEqual(outV,i,blanksLeft,0,expectedResultLen));
  i++;
  byte[] sentenceBlankRanges=new byte[100];
  int sentenceBlankRangesLen=addMultiByteCharSentenceBlankRanges(sentenceBlankRanges,0);
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen) == 17);
  StringExpr.assign(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen);
  expectedResultLen=sentenceBlankRangesLen;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,0,sentenceBlankRangesLen - 3) == 16);
  StringExpr.assign(outV,i,sentenceBlankRanges,0,sentenceBlankRangesLen - 3);
  expectedResultLen=sentenceBlankRangesLen - 3;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,0,expectedResultLen));
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,4,sentenceBlankRangesLen - 4) == 16);
  StringExpr.assign(outV,i,sentenceBlankRanges,4,sentenceBlankRangesLen - 4);
  expectedResultLen=sentenceBlankRangesLen - 4;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,4,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 16);
  i++;
  Assert.assertTrue(StringExpr.characterCount(sentenceBlankRanges,7,17) == 13);
  StringExpr.assign(outV,i,sentenceBlankRanges,7,17);
  expectedResultLen=17;
  Assert.assertTrue(vectorEqual(outV,i,sentenceBlankRanges,7,expectedResultLen));
  Assert.assertTrue(vectorCharacterCount(outV,i) == 13);
  i++;
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColConcatCol(){
  VectorizedRowBatch batch=makeStringBatch2In1Out();
  StringGroupConcatColCol expr=new StringGroupConcatColCol(0,1,2);
  expr.evaluate(batch);
  BytesColumnVector outCol=(BytesColumnVector)batch.cols[2];
  int cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertTrue(outCol.isNull[2]);
  int cmp2=StringExpr.compare(greengreen,0,greengreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  Assert.assertFalse(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch2In1Out();
  batch.cols[0].noNulls=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  cmp2=StringExpr.compare(greengreen,0,greengreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp2);
  int cmp3=StringExpr.compare(emptyString,0,emptyString.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp3);
  Assert.assertTrue(outCol.noNulls);
  Assert.assertFalse(outCol.isRepeating);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(true,outCol.isNull[0]);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(false,outCol.isRepeating);
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
  Assert.assertEquals(true,outCol.isNull[2]);
  batch=makeStringBatch2In1Out();
  batch.cols[1].isRepeating=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(true,outCol.isNull[0]);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].isNull[0]=true;
  batch.cols[1].isRepeating=true;
  batch.cols[1].isNull[0]=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(true,outCol.isNull[0]);
  batch=makeStringBatch2In1Out();
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(false,outCol.isRepeating);
  Assert.assertEquals(false,outCol.isNull[0]);
  Assert.assertEquals(false,outCol.noNulls);
  Assert.assertEquals(true,outCol.isNull[2]);
  cmp=StringExpr.compare(greenred,0,greenred.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp);
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  Assert.assertEquals(false,outCol.isRepeating);
  Assert.assertEquals(true,outCol.noNulls);
  cmp=StringExpr.compare(red,0,red.length,outCol.vector[2],outCol.start[2],outCol.length[2]);
  Assert.assertEquals(0,cmp);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(false,outCol.isRepeating);
  Assert.assertEquals(false,outCol.isNull[0]);
  Assert.assertEquals(false,outCol.noNulls);
  Assert.assertEquals(true,outCol.isNull[2]);
  cmp=StringExpr.compare(redgreen,0,redgreen.length,outCol.vector[1],outCol.start[1],outCol.length[1]);
  Assert.assertEquals(0,cmp);
  batch=makeStringBatch2In1Out();
  batch.cols[0].isRepeating=true;
  batch.cols[0].noNulls=true;
  batch.cols[1].isRepeating=true;
  batch.cols[1].noNulls=true;
  expr.evaluate(batch);
  outCol=(BytesColumnVector)batch.cols[2];
  Assert.assertEquals(3,batch.size);
  Assert.assertEquals(true,outCol.isRepeating);
  Assert.assertEquals(false,outCol.isNull[0]);
  cmp=StringExpr.compare(redred,0,redred.length,outCol.vector[0],outCol.start[0],outCol.length[0]);
  Assert.assertEquals(0,cmp);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.udf.TestVectorUDFAdaptor </h4><pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenericUDF(){
  ExprNodeGenericFuncDesc funcDesc;
  GenericUDF genericUDF=new GenericUDFIsNull();
  TypeInfo typeInfoStr=TypeInfoFactory.stringTypeInfo;
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  children.add(new ExprNodeColumnDesc(typeInfoStr,"col0","tablename",false));
  children.add(new ExprNodeConstantDesc(typeInfoStr,"UNKNOWN"));
  VectorUDFArgDesc[] argDescs=new VectorUDFArgDesc[2];
  for (int i=0; i < 2; i++) {
    argDescs[i]=new VectorUDFArgDesc();
  }
  argDescs[0].setVariable(0);
  argDescs[1].setConstant((ExprNodeConstantDesc)children.get(1));
  funcDesc=new ExprNodeGenericFuncDesc(typeInfoStr,genericUDF,"myisnull",children);
  VectorUDFAdaptor vudf=null;
  try {
    vudf=new VectorUDFAdaptor(funcDesc,3,"String",argDescs);
  }
 catch (  HiveException e) {
    assertTrue(false);
  }
  VectorizedRowBatch b;
  byte[] red=null;
  byte[] unknown=null;
  try {
    red="red".getBytes("UTF-8");
    unknown="UNKNOWN".getBytes("UTF-8");
  }
 catch (  Exception e) {
    ;
  }
  BytesColumnVector out;
  b=getBatchStrDblLongWithStrOut();
  b.cols[0].noNulls=false;
  b.cols[0].isNull[0]=true;
  vudf.evaluate(b);
  out=(BytesColumnVector)b.cols[3];
  int cmp=StringExpr.compare(red,0,red.length,out.vector[1],out.start[1],out.length[1]);
  assertEquals(0,cmp);
  cmp=StringExpr.compare(unknown,0,unknown.length,out.vector[0],out.start[0],out.length[0]);
  assertEquals(0,cmp);
  assertTrue(out.noNulls || !out.isNull[0]);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiArgumentUDF(){
  ExprNodeGenericFuncDesc funcDesc;
  TypeInfo typeInfoStr=TypeInfoFactory.stringTypeInfo;
  TypeInfo typeInfoLong=TypeInfoFactory.longTypeInfo;
  TypeInfo typeInfoDbl=TypeInfoFactory.doubleTypeInfo;
  GenericUDFBridge genericUDFBridge=new GenericUDFBridge("testudf",false,ConcatTextLongDoubleUDF.class.getName());
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  children.add(new ExprNodeColumnDesc(typeInfoStr,"col0","tablename",false));
  children.add(new ExprNodeColumnDesc(typeInfoLong,"col1","tablename",false));
  children.add(new ExprNodeColumnDesc(typeInfoDbl,"col2","tablename",false));
  VectorUDFArgDesc[] argDescs=new VectorUDFArgDesc[3];
  for (int i=0; i < 3; i++) {
    argDescs[i]=new VectorUDFArgDesc();
    argDescs[i].setVariable(i);
  }
  funcDesc=new ExprNodeGenericFuncDesc(typeInfoStr,genericUDFBridge,genericUDFBridge.getUdfName(),children);
  VectorUDFAdaptor vudf=null;
  try {
    vudf=new VectorUDFAdaptor(funcDesc,3,"String",argDescs);
  }
 catch (  HiveException e) {
    assertTrue(false);
    throw new RuntimeException(e);
  }
  VectorizedRowBatch b=getBatchStrDblLongWithStrOut();
  vudf.evaluate(b);
  byte[] result=null;
  byte[] result2=null;
  try {
    result="red:1:1.0".getBytes("UTF-8");
    result2="blue:0:0.0".getBytes("UTF-8");
  }
 catch (  Exception e) {
    ;
  }
  BytesColumnVector out=(BytesColumnVector)b.cols[3];
  int cmp=StringExpr.compare(result,0,result.length,out.vector[1],out.start[1],out.length[1]);
  assertEquals(0,cmp);
  assertTrue(out.noNulls);
  b=getBatchStrDblLongWithStrOut();
  b.cols[1].noNulls=false;
  vudf.evaluate(b);
  out=(BytesColumnVector)b.cols[3];
  assertFalse(out.noNulls);
  assertTrue(out.isNull[1]);
  b=getBatchStrDblLongWithStrOut();
  b.cols[0].isRepeating=true;
  b.cols[1].isRepeating=true;
  b.cols[2].isRepeating=true;
  vudf.evaluate(b);
  out=(BytesColumnVector)b.cols[3];
  assertTrue(out.isRepeating);
  cmp=StringExpr.compare(result2,0,result2.length,out.vector[0],out.start[0],out.length[0]);
  assertEquals(0,cmp);
  assertTrue(out.noNulls);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.hooks.TestHooks </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testQueryRedactor() throws Exception {
  HiveConf conf=new HiveConf(TestHooks.class);
  HiveConf.setVar(conf,HiveConf.ConfVars.QUERYREDACTORHOOKS,SimpleQueryRedactor.class.getName());
  Driver driver=createDriver(conf);
  int ret=driver.compile("select 'XXX' from t1");
  assertEquals("Checking command success",0,ret);
  assertEquals("select 'AAA' from t1",HiveConf.getVar(conf,HiveConf.ConfVars.HIVEQUERYSTRING));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRedactLogString() throws Exception {
  HiveConf conf=new HiveConf(TestHooks.class);
  String str;
  HiveConf.setVar(conf,HiveConf.ConfVars.QUERYREDACTORHOOKS,SimpleQueryRedactor.class.getName());
  str=HookUtils.redactLogString(null,null);
  assertEquals(str,null);
  str=HookUtils.redactLogString(conf,null);
  assertEquals(str,null);
  str=HookUtils.redactLogString(conf,"select 'XXX' from t1");
  assertEquals(str,"select 'AAA' from t1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestAcidUtils </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void deltasWithOpenTxnsNotInCompact() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/delta_1_1/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_2_5/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"mock:/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidCompactorTxnList("100:4"));
  List<AcidUtils.ParsedDelta> delts=dir.getCurrentDirectories();
  assertEquals(1,delts.size());
  assertEquals("mock:/tbl/part1/delta_1_1",delts.get(0).getPath().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOriginal() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/000000_0",500,new byte[0]),new MockFile("mock:/tbl/part1/000001_1",500,new byte[0]),new MockFile("mock:/tbl/part1/000002_0",500,new byte[0]),new MockFile("mock:/tbl/part1/random",500,new byte[0]),new MockFile("mock:/tbl/part1/_done",0,new byte[0]),new MockFile("mock:/tbl/part1/subdir/000000_0",0,new byte[0]));
  AcidUtils.Directory dir=AcidUtils.getAcidState(new MockPath(fs,"/tbl/part1"),conf,new ValidReadTxnList("100:"));
  assertEquals(null,dir.getBaseDirectory());
  assertEquals(0,dir.getCurrentDirectories().size());
  assertEquals(0,dir.getObsolete().size());
  List<HdfsFileStatusWithId> result=dir.getOriginalFiles();
  assertEquals(5,result.size());
  assertEquals("mock:/tbl/part1/000000_0",result.get(0).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/000001_1",result.get(1).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/000002_0",result.get(2).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/random",result.get(3).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/subdir/000000_0",result.get(4).getFileStatus().getPath().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBaseDeltas() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/base_5/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_10/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_49/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_025_025/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_029_029/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_025_030/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_050_105/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_90_120/bucket_0",0,new byte[0]));
  AcidUtils.Directory dir=AcidUtils.getAcidState(new TestInputOutputFormat.MockPath(fs,"mock:/tbl/part1"),conf,new ValidReadTxnList("100:"));
  assertEquals("mock:/tbl/part1/base_49",dir.getBaseDirectory().toString());
  List<FileStatus> obsolete=dir.getObsolete();
  assertEquals(5,obsolete.size());
  assertEquals("mock:/tbl/part1/base_10",obsolete.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/base_5",obsolete.get(1).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_025_030",obsolete.get(2).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_025_025",obsolete.get(3).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_029_029",obsolete.get(4).getPath().toString());
  assertEquals(0,dir.getOriginalFiles().size());
  List<AcidUtils.ParsedDelta> deltas=dir.getCurrentDirectories();
  assertEquals(1,deltas.size());
  AcidUtils.ParsedDelta delt=deltas.get(0);
  assertEquals("mock:/tbl/part1/delta_050_105",delt.getPath().toString());
  assertEquals(50,delt.getMinTransaction());
  assertEquals(105,delt.getMaxTransaction());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @since 1.3.0
 * @throws Exception
 */
@Test public void deltasWithOpenTxnInRead2() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/delta_1_1/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_2_5/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_4_4_1/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_4_4_3/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_101_101_1/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"mock:/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("100:4"));
  List<AcidUtils.ParsedDelta> delts=dir.getCurrentDirectories();
  assertEquals(2,delts.size());
  assertEquals("mock:/tbl/part1/delta_1_1",delts.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_2_5",delts.get(1).getPath().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOriginalDeltas() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/000000_0",500,new byte[0]),new MockFile("mock:/tbl/part1/000001_1",500,new byte[0]),new MockFile("mock:/tbl/part1/000002_0",500,new byte[0]),new MockFile("mock:/tbl/part1/random",500,new byte[0]),new MockFile("mock:/tbl/part1/_done",0,new byte[0]),new MockFile("mock:/tbl/part1/subdir/000000_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_025_025/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_029_029/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_025_030/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_050_100/bucket_0",0,new byte[0]),new MockFile("mock:/tbl/part1/delta_101_101/bucket_0",0,new byte[0]));
  AcidUtils.Directory dir=AcidUtils.getAcidState(new TestInputOutputFormat.MockPath(fs,"mock:/tbl/part1"),conf,new ValidReadTxnList("100:"));
  assertEquals(null,dir.getBaseDirectory());
  List<FileStatus> obsolete=dir.getObsolete();
  assertEquals(2,obsolete.size());
  assertEquals("mock:/tbl/part1/delta_025_025",obsolete.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_029_029",obsolete.get(1).getPath().toString());
  List<HdfsFileStatusWithId> result=dir.getOriginalFiles();
  assertEquals(5,result.size());
  assertEquals("mock:/tbl/part1/000000_0",result.get(0).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/000001_1",result.get(1).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/000002_0",result.get(2).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/random",result.get(3).getFileStatus().getPath().toString());
  assertEquals("mock:/tbl/part1/subdir/000000_0",result.get(4).getFileStatus().getPath().toString());
  List<AcidUtils.ParsedDelta> deltas=dir.getCurrentDirectories();
  assertEquals(2,deltas.size());
  AcidUtils.ParsedDelta delt=deltas.get(0);
  assertEquals("mock:/tbl/part1/delta_025_030",delt.getPath().toString());
  assertEquals(25,delt.getMinTransaction());
  assertEquals(30,delt.getMaxTransaction());
  delt=deltas.get(1);
  assertEquals("mock:/tbl/part1/delta_050_100",delt.getPath().toString());
  assertEquals(50,delt.getMinTransaction());
  assertEquals(100,delt.getMaxTransaction());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testObsoleteOriginals() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/base_10/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_5/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/000000_0",500,new byte[0]),new MockFile("mock:/tbl/part1/000001_1",500,new byte[0]));
  Path part=new MockPath(fs,"/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("150:"));
  List<FileStatus> obsolete=dir.getObsolete();
  assertEquals(3,obsolete.size());
  assertEquals("mock:/tbl/part1/base_5",obsolete.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/base_10",dir.getBaseDirectory().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBestBase() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/base_5/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_10/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_25/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_100/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_200/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("150:"));
  assertEquals("mock:/tbl/part1/base_200",dir.getBaseDirectory().toString());
  List<FileStatus> obsoletes=dir.getObsolete();
  assertEquals(4,obsoletes.size());
  assertEquals("mock:/tbl/part1/base_10",obsoletes.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/base_100",obsoletes.get(1).getPath().toString());
  assertEquals("mock:/tbl/part1/base_25",obsoletes.get(2).getPath().toString());
  assertEquals("mock:/tbl/part1/base_5",obsoletes.get(3).getPath().toString());
  assertEquals(0,dir.getOriginalFiles().size());
  assertEquals(0,dir.getCurrentDirectories().size());
  dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("10:"));
  assertEquals("mock:/tbl/part1/base_200",dir.getBaseDirectory().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void deltasWithOpenTxnInRead() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/delta_1_1/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_2_5/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"mock:/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("100:4"));
  List<AcidUtils.ParsedDelta> delts=dir.getCurrentDirectories();
  assertEquals(2,delts.size());
  assertEquals("mock:/tbl/part1/delta_1_1",delts.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_2_5",delts.get(1).getPath().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Hive 1.3.0 delta dir naming scheme which supports multi-statement txns
 * @throws Exception
 */
@Test public void testOverlapingDelta2() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/delta_0000063_63_0/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_000062_62_0/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_000062_62_3/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_00061_61_0/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_40_60/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_0060_60_1/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_0060_60_4/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_0060_60_7/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_052_55/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_058_58/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_50/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"mock:/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("100:"));
  assertEquals("mock:/tbl/part1/base_50",dir.getBaseDirectory().toString());
  List<FileStatus> obsolete=dir.getObsolete();
  assertEquals(5,obsolete.size());
  assertEquals("mock:/tbl/part1/delta_052_55",obsolete.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_058_58",obsolete.get(1).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_0060_60_1",obsolete.get(2).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_0060_60_4",obsolete.get(3).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_0060_60_7",obsolete.get(4).getPath().toString());
  List<AcidUtils.ParsedDelta> delts=dir.getCurrentDirectories();
  assertEquals(5,delts.size());
  assertEquals("mock:/tbl/part1/delta_40_60",delts.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_00061_61_0",delts.get(1).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_000062_62_0",delts.get(2).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_000062_62_3",delts.get(3).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_0000063_63_0",delts.get(4).getPath().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParsing() throws Exception {
  assertEquals(123,AcidUtils.parseBase(new Path("/tmp/base_000123")));
  Path dir=new Path("/tmp/tbl");
  Configuration conf=new Configuration();
  AcidOutputFormat.Options opts=AcidUtils.parseBaseBucketFilename(new Path(dir,"base_567/bucket_123"),conf);
  assertEquals(false,opts.getOldStyle());
  assertEquals(true,opts.isWritingBase());
  assertEquals(567,opts.getMaximumTransactionId());
  assertEquals(0,opts.getMinimumTransactionId());
  assertEquals(123,opts.getBucket());
  opts=AcidUtils.parseBaseBucketFilename(new Path(dir,"000123_0"),conf);
  assertEquals(true,opts.getOldStyle());
  assertEquals(true,opts.isWritingBase());
  assertEquals(123,opts.getBucket());
  assertEquals(0,opts.getMinimumTransactionId());
  assertEquals(0,opts.getMaximumTransactionId());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOverlapingDelta() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/delta_0000063_63/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_000062_62/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_00061_61/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_40_60/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_0060_60/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_052_55/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/base_50/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"mock:/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidReadTxnList("100:"));
  assertEquals("mock:/tbl/part1/base_50",dir.getBaseDirectory().toString());
  List<FileStatus> obsolete=dir.getObsolete();
  assertEquals(2,obsolete.size());
  assertEquals("mock:/tbl/part1/delta_052_55",obsolete.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_0060_60",obsolete.get(1).getPath().toString());
  List<AcidUtils.ParsedDelta> delts=dir.getCurrentDirectories();
  assertEquals(4,delts.size());
  assertEquals("mock:/tbl/part1/delta_40_60",delts.get(0).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_00061_61",delts.get(1).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_000062_62",delts.get(2).getPath().toString());
  assertEquals("mock:/tbl/part1/delta_0000063_63",delts.get(3).getPath().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void deltasWithOpenTxnsNotInCompact2() throws Exception {
  Configuration conf=new Configuration();
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/tbl/part1/delta_1_1/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_2_5/bucket_0",500,new byte[0]),new MockFile("mock:/tbl/part1/delta_2_5/bucket_0" + AcidUtils.DELTA_SIDE_FILE_SUFFIX,500,new byte[0]),new MockFile("mock:/tbl/part1/delta_6_10/bucket_0",500,new byte[0]));
  Path part=new MockPath(fs,"mock:/tbl/part1");
  AcidUtils.Directory dir=AcidUtils.getAcidState(part,conf,new ValidCompactorTxnList("100:4"));
  List<AcidUtils.ParsedDelta> delts=dir.getCurrentDirectories();
  assertEquals(1,delts.size());
  assertEquals("mock:/tbl/part1/delta_1_1",delts.get(0).getPath().toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestIOContextMap </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTezLlapAttemptMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000, ATTEMPT_COUNT=3;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT * ATTEMPT_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        final Configuration conf=new Configuration(), conf2=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          String input1="Input " + nextIx;
          conf.set(Utilities.INPUT_NAME,input1);
          for (int j=0; j < ATTEMPT_COUNT; ++j) {
            String attemptId="Attempt " + nextIx + ":"+ j;
            IOContextMap.setThreadAttemptId(attemptId);
            final IOContext r1=results[(nextIx * ATTEMPT_COUNT) + j]=IOContextMap.get(conf);
            if ((nextIx % (ITER_COUNT / 10)) == 0) {
              String input2="Input2 " + nextIx;
              conf2.set(Utilities.INPUT_NAME,input2);
              final AtomicReference<IOContext> ref2=new AtomicReference<>();
              Thread t=new Thread(new Runnable(){
                public void run(){
                  assertSame(r1,IOContextMap.get(conf));
                  ref2.set(IOContextMap.get(conf2));
                }
              }
);
              t.start();
              t.join();
              assertSame(ref2.get(),IOContextMap.get(conf2));
            }
          }
          if (nextIx == 0)           break;
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Configuration conf=new Configuration();
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < ITER_COUNT; ++i) {
    conf.set(Utilities.INPUT_NAME,"Input " + i);
    for (int j=0; j < ATTEMPT_COUNT; ++j) {
      String attemptId="Attempt " + i + ":"+ j;
      IOContext result=results[(i * ATTEMPT_COUNT) + j];
      assertTrue(resultSet.add(result));
      IOContextMap.setThreadAttemptId(attemptId);
      assertSame(result,IOContextMap.get(conf));
      IOContextMap.clearThreadAttempt(attemptId);
      IOContextMap.setThreadAttemptId(attemptId);
      assertNotSame(result,IOContextMap.get(conf));
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMRTezGlobalMap() throws Exception {
  final int THREAD_COUNT=2, ITER_COUNT=1000;
  final AtomicInteger countdown=new AtomicInteger(ITER_COUNT);
  final CountDownLatch phase1End=new CountDownLatch(THREAD_COUNT);
  final IOContext[] results=new IOContext[ITER_COUNT];
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<Void>(new Callable<Void>(){
      public Void call() throws Exception {
        Configuration conf=new Configuration();
        syncThreadStart(cdlIn,cdlOut);
        while (true) {
          int nextIx=countdown.decrementAndGet();
          if (nextIx < 0)           break;
          conf.set(Utilities.INPUT_NAME,"Input " + nextIx);
          results[nextIx]=IOContextMap.get(conf);
          if (nextIx == 0)           break;
        }
        phase1End.countDown();
        phase1End.await();
        for (int i=0; i < ITER_COUNT; ++i) {
          conf.set(Utilities.INPUT_NAME,"Input " + i);
          IOContext ctx=IOContextMap.get(conf);
          assertSame(results[i],ctx);
        }
        return null;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  for (int i=0; i < tasks.length; ++i) {
    tasks[i].get();
  }
  Set<IOContext> resultSet=Sets.newIdentityHashSet();
  for (int i=0; i < results.length; ++i) {
    assertTrue(resultSet.add(results[i]));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-14 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparkThreadLocal() throws Exception {
  final Configuration conf1=new Configuration();
  conf1.set(HiveConf.ConfVars.HIVE_EXECUTION_ENGINE.varname,"spark");
  final Configuration conf2=new Configuration(conf1);
  conf2.set(Utilities.INPUT_NAME,"Other input");
  final int THREAD_COUNT=2;
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  final CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") FutureTask<IOContext>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < tasks.length; ++i) {
    tasks[i]=new FutureTask<IOContext>(new Callable<IOContext>(){
      public IOContext call() throws Exception {
        syncThreadStart(cdlIn,cdlOut);
        IOContext c1=IOContextMap.get(conf1), c2=IOContextMap.get(conf2);
        assertSame(c1,c2);
        return c1;
      }
    }
);
    executor.execute(tasks[i]);
  }
  cdlIn.await();
  cdlOut.countDown();
  Set<IOContext> results=Sets.newIdentityHashSet();
  for (int i=0; i < tasks.length; ++i) {
    assertTrue(results.add(tasks[i].get()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.TestRCFile </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleReadAndWrite() throws IOException, SerDeException {
  cleanup();
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  Object[] expectedRecord_1={new ByteWritable((byte)123),new ShortWritable((short)456),new IntWritable(789),new LongWritable(1000),new DoubleWritable(5.3),new Text("hive and hadoop"),null,null};
  Object[] expectedRecord_2={new ByteWritable((byte)100),new ShortWritable((short)200),new IntWritable(123),new LongWritable(1000),new DoubleWritable(5.3),new Text("hive and hadoop"),null,null};
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  assertEquals(new Text("block"),reader.getMetadata().get(new Text("apple")));
  assertEquals(new Text("block"),reader.getMetadataValueOf(new Text("apple")));
  assertEquals(new Text("dog"),reader.getMetadataValueOf(new Text("cat")));
  LongWritable rowID=new LongWritable();
  for (int i=0; i < 2; i++) {
    reader.next(rowID);
    BytesRefArrayWritable cols=new BytesRefArrayWritable();
    reader.getCurrentRow(cols);
    cols.resetValid(8);
    Object row=serDe.deserialize(cols);
    StructObjectInspector oi=(StructObjectInspector)serDe.getObjectInspector();
    List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
    assertEquals("Field size should be 8",8,fieldRefs.size());
    for (int j=0; j < fieldRefs.size(); j++) {
      Object fieldData=oi.getStructFieldData(row,fieldRefs.get(j));
      Object standardWritableData=ObjectInspectorUtils.copyToStandardObject(fieldData,fieldRefs.get(j).getFieldObjectInspector(),ObjectInspectorCopyOption.WRITABLE);
      if (i == 0) {
        assertEquals("Field " + i,standardWritableData,expectedRecord_1[j]);
      }
 else {
        assertEquals("Field " + i,standardWritableData,expectedRecord_2[j]);
      }
    }
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link RCFile.Reader#getColumn(int,BytesRefArrayWritable) } method.
 * @throws IOException
 */
@Test public void testGetColumn() throws IOException {
  cleanup();
  RCFileOutputFormat.setColumnNumber(conf,expectedFieldsData.length);
  RCFile.Writer writer=new RCFile.Writer(fs,conf,file,null,RCFile.createMetadata(new Text("apple"),new Text("block"),new Text("cat"),new Text("dog")),new DefaultCodec());
  byte[][] record_1={"123".getBytes("UTF-8"),"456".getBytes("UTF-8"),"789".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  byte[][] record_2={"100".getBytes("UTF-8"),"200".getBytes("UTF-8"),"123".getBytes("UTF-8"),"1000".getBytes("UTF-8"),"5.3".getBytes("UTF-8"),"hive and hadoop".getBytes("UTF-8"),new byte[0],"NULL".getBytes("UTF-8")};
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(record_1.length);
  for (int i=0; i < record_1.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_1[i],0,record_1[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  bytes.clear();
  for (int i=0; i < record_2.length; i++) {
    BytesRefWritable cu=new BytesRefWritable(record_2[i],0,record_2[i].length);
    bytes.set(i,cu);
  }
  writer.append(bytes);
  writer.close();
  RCFile.Reader reader=new RCFile.Reader(fs,file,conf);
  LongWritable rowID=new LongWritable();
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),0L);
  assertTrue(reader.next(rowID));
  assertEquals(rowID.get(),1L);
  BytesRefArrayWritable result=null;
  BytesRefWritable brw;
  for (int col=0; col < 8; col++) {
    BytesRefArrayWritable result2=reader.getColumn(col,result);
    if (result == null) {
      assertNotNull(result2);
      result=result2;
    }
 else {
      assertSame(result2,result);
    }
    assertEquals(2,result.size());
    for (int row=0; row < result.size(); row++) {
      brw=result.get(row);
      int start=brw.getStart();
      int len=brw.getLength();
      byte[] actualData=Arrays.copyOfRange(brw.getData(),start,start + len);
      byte[] expectedData=(row == 0) ? record_1[col] : record_2[col];
      assertArrayEquals("col=" + col + " : row="+ row,expectedData,actualData);
    }
    result.clear();
  }
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSync() throws IOException {
  Path testDir=new Path(System.getProperty("test.tmp.dir",".") + "/mapred/testsync");
  Path testFile=new Path(testDir,"test_rcfile");
  fs.delete(testFile,true);
  int intervalRecordCount=500;
  CompressionCodec codec=null;
  int writeCount=2500;
  Configuration cloneConf=new Configuration(conf);
  RCFileOutputFormat.setColumnNumber(cloneConf,bytesArray.length);
  cloneConf.setInt(HiveConf.ConfVars.HIVE_RCFILE_RECORD_INTERVAL.varname,intervalRecordCount);
  RCFile.Writer writer=new RCFile.Writer(fs,cloneConf,testFile,null,codec);
  BytesRefArrayWritable bytes=new BytesRefArrayWritable(bytesArray.length);
  for (int i=0; i < bytesArray.length; i++) {
    BytesRefWritable cu=null;
    cu=new BytesRefWritable(bytesArray[i],0,bytesArray[i].length);
    bytes.set(i,cu);
  }
  for (int i=0; i < writeCount; i++) {
    writer.append(bytes);
  }
  writer.close();
  long fileLen=fs.getFileStatus(testFile).getLen();
  RCFileInputFormat inputFormat=new RCFileInputFormat();
  JobConf jobconf=new JobConf(cloneConf);
  jobconf.set("mapred.input.dir",testDir.toString());
  HiveConf.setLongVar(jobconf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,fileLen);
  InputSplit[] splits=inputFormat.getSplits(jobconf,1);
  RCFileRecordReader rr=new RCFileRecordReader(jobconf,(FileSplit)splits[0]);
  long lastSync=0;
  for (int i=0; i < 2500; i++) {
    rr.sync(i);
    if (rr.getPos() < lastSync) {
      String reason=String.format("Sync at offset %d skipped sync block at location %d (returned %d instead)",i - 1,rr.getPos(),lastSync);
      System.out.println(reason);
      fail(reason);
    }
    lastSync=rr.getPos();
  }
  rr.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestColumnStatistics </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateMerge() throws Exception {
  TypeDescription schema=TypeDescription.createDate();
  ColumnStatisticsImpl stats1=ColumnStatisticsImpl.create(schema);
  ColumnStatisticsImpl stats2=ColumnStatisticsImpl.create(schema);
  stats1.updateDate(new DateWritable(1000));
  stats1.updateDate(new DateWritable(100));
  stats2.updateDate(new DateWritable(10));
  stats2.updateDate(new DateWritable(2000));
  stats1.merge(stats2);
  DateColumnStatistics typed=(DateColumnStatistics)stats1;
  assertEquals(new DateWritable(10).get(),typed.getMinimum());
  assertEquals(new DateWritable(2000).get(),typed.getMaximum());
  stats1.reset();
  stats1.updateDate(new DateWritable(-10));
  stats1.updateDate(new DateWritable(10000));
  stats1.merge(stats2);
  assertEquals(new DateWritable(-10).get(),typed.getMinimum());
  assertEquals(new DateWritable(10000).get(),typed.getMaximum());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringMerge() throws Exception {
  TypeDescription schema=TypeDescription.createString();
  ColumnStatisticsImpl stats1=ColumnStatisticsImpl.create(schema);
  ColumnStatisticsImpl stats2=ColumnStatisticsImpl.create(schema);
  stats1.updateString(new Text("bob"));
  stats1.updateString(new Text("david"));
  stats1.updateString(new Text("charles"));
  stats2.updateString(new Text("anne"));
  byte[] erin=new byte[]{0,1,2,3,4,5,101,114,105,110};
  stats2.updateString(erin,6,4,5);
  assertEquals(24,((StringColumnStatistics)stats2).getSum());
  stats1.merge(stats2);
  StringColumnStatistics typed=(StringColumnStatistics)stats1;
  assertEquals("anne",typed.getMinimum());
  assertEquals("erin",typed.getMaximum());
  assertEquals(39,typed.getSum());
  stats1.reset();
  stats1.updateString(new Text("aaa"));
  stats1.updateString(new Text("zzz"));
  stats1.merge(stats2);
  assertEquals("aaa",typed.getMinimum());
  assertEquals("zzz",typed.getMaximum());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHasNull() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(SimpleStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).rowIndexStride(1000).stripeSize(10000).bufferSize(10000));
  for (int i=0; i < 1000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),"RG1"));
  }
  for (int i=0; i < 1000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),null));
  }
  for (int i=0; i < 1000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),"RG3"));
  }
  for (int i=0; i < 1000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),null));
  }
  for (int i=0; i < 1000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),null));
  }
  for (int i=0; i < 5000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),null));
  }
  for (int i=0; i < 5000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),"STRIPE-3"));
  }
  for (int i=0; i < 5000; i++) {
    writer.addRow(new SimpleStruct(bytes(1,2,3),null));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(20000,stats[0].getNumberOfValues());
  assertEquals(20000,stats[1].getNumberOfValues());
  assertEquals(7000,stats[2].getNumberOfValues());
  assertEquals(false,stats[0].hasNull());
  assertEquals(false,stats[1].hasNull());
  assertEquals(true,stats[2].hasNull());
  List<StripeStatistics> stripeStats=reader.getStripeStatistics();
  StripeStatistics ss1=stripeStats.get(0);
  ColumnStatistics ss1_cs1=ss1.getColumnStatistics()[0];
  ColumnStatistics ss1_cs2=ss1.getColumnStatistics()[1];
  ColumnStatistics ss1_cs3=ss1.getColumnStatistics()[2];
  assertEquals(false,ss1_cs1.hasNull());
  assertEquals(false,ss1_cs2.hasNull());
  assertEquals(true,ss1_cs3.hasNull());
  StripeStatistics ss2=stripeStats.get(1);
  ColumnStatistics ss2_cs1=ss2.getColumnStatistics()[0];
  ColumnStatistics ss2_cs2=ss2.getColumnStatistics()[1];
  ColumnStatistics ss2_cs3=ss2.getColumnStatistics()[2];
  assertEquals(false,ss2_cs1.hasNull());
  assertEquals(false,ss2_cs2.hasNull());
  assertEquals(true,ss2_cs3.hasNull());
  StripeStatistics ss3=stripeStats.get(2);
  ColumnStatistics ss3_cs1=ss3.getColumnStatistics()[0];
  ColumnStatistics ss3_cs2=ss3.getColumnStatistics()[1];
  ColumnStatistics ss3_cs3=ss3.getColumnStatistics()[2];
  assertEquals(false,ss3_cs1.hasNull());
  assertEquals(false,ss3_cs2.hasNull());
  assertEquals(false,ss3_cs3.hasNull());
  StripeStatistics ss4=stripeStats.get(3);
  ColumnStatistics ss4_cs1=ss4.getColumnStatistics()[0];
  ColumnStatistics ss4_cs2=ss4.getColumnStatistics()[1];
  ColumnStatistics ss4_cs3=ss4.getColumnStatistics()[2];
  assertEquals(false,ss4_cs1.hasNull());
  assertEquals(false,ss4_cs2.hasNull());
  assertEquals(true,ss4_cs3.hasNull());
  PrintStream origOut=System.out;
  String outputFilename="orc-file-has-null.out";
  FileOutputStream myOut=new FileOutputStream(workDir + File.separator + outputFilename);
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toString(),"--rowindex=2"});
  System.out.flush();
  System.setOut(origOut);
  TestFileDump.checkOutput(outputFilename,workDir + File.separator + outputFilename);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleMerge() throws Exception {
  TypeDescription schema=TypeDescription.createDouble();
  ColumnStatisticsImpl stats1=ColumnStatisticsImpl.create(schema);
  ColumnStatisticsImpl stats2=ColumnStatisticsImpl.create(schema);
  stats1.updateDouble(10.0);
  stats1.updateDouble(100.0);
  stats2.updateDouble(1.0);
  stats2.updateDouble(1000.0);
  stats1.merge(stats2);
  DoubleColumnStatistics typed=(DoubleColumnStatistics)stats1;
  assertEquals(1.0,typed.getMinimum(),0.001);
  assertEquals(1000.0,typed.getMaximum(),0.001);
  stats1.reset();
  stats1.updateDouble(-10);
  stats1.updateDouble(10000);
  stats1.merge(stats2);
  assertEquals(-10,typed.getMinimum(),0.001);
  assertEquals(10000,typed.getMaximum(),0.001);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimalMerge() throws Exception {
  TypeDescription schema=TypeDescription.createDecimal().withPrecision(38).withScale(16);
  ColumnStatisticsImpl stats1=ColumnStatisticsImpl.create(schema);
  ColumnStatisticsImpl stats2=ColumnStatisticsImpl.create(schema);
  stats1.updateDecimal(HiveDecimal.create(10));
  stats1.updateDecimal(HiveDecimal.create(100));
  stats2.updateDecimal(HiveDecimal.create(1));
  stats2.updateDecimal(HiveDecimal.create(1000));
  stats1.merge(stats2);
  DecimalColumnStatistics typed=(DecimalColumnStatistics)stats1;
  assertEquals(1,typed.getMinimum().longValue());
  assertEquals(1000,typed.getMaximum().longValue());
  stats1.reset();
  stats1.updateDecimal(HiveDecimal.create(-10));
  stats1.updateDecimal(HiveDecimal.create(10000));
  stats1.merge(stats2);
  assertEquals(-10,typed.getMinimum().longValue());
  assertEquals(10000,typed.getMaximum().longValue());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongMerge() throws Exception {
  TypeDescription schema=TypeDescription.createInt();
  ColumnStatisticsImpl stats1=ColumnStatisticsImpl.create(schema);
  ColumnStatisticsImpl stats2=ColumnStatisticsImpl.create(schema);
  stats1.updateInteger(10,2);
  stats2.updateInteger(1,1);
  stats2.updateInteger(1000,1);
  stats1.merge(stats2);
  IntegerColumnStatistics typed=(IntegerColumnStatistics)stats1;
  assertEquals(1,typed.getMinimum());
  assertEquals(1000,typed.getMaximum());
  stats1.reset();
  stats1.updateInteger(-10,1);
  stats1.updateInteger(10000,1);
  stats1.merge(stats2);
  assertEquals(-10,typed.getMinimum());
  assertEquals(10000,typed.getMaximum());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampMerge() throws Exception {
  TypeDescription schema=TypeDescription.createTimestamp();
  ColumnStatisticsImpl stats1=ColumnStatisticsImpl.create(schema);
  ColumnStatisticsImpl stats2=ColumnStatisticsImpl.create(schema);
  stats1.updateTimestamp(new Timestamp(10));
  stats1.updateTimestamp(new Timestamp(100));
  stats2.updateTimestamp(new Timestamp(1));
  stats2.updateTimestamp(new Timestamp(1000));
  stats1.merge(stats2);
  TimestampColumnStatistics typed=(TimestampColumnStatistics)stats1;
  assertEquals(1,typed.getMinimum().getTime());
  assertEquals(1000,typed.getMaximum().getTime());
  stats1.reset();
  stats1.updateTimestamp(new Timestamp(-10));
  stats1.updateTimestamp(new Timestamp(10000));
  stats1.merge(stats2);
  assertEquals(-10,typed.getMinimum().getTime());
  assertEquals(10000,typed.getMaximum().getTime());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestFileDump </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDataDump() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(AllTypesRecord.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(fs,testFilePath,conf,inspector,100000,CompressionKind.NONE,10000,1000);
  Map<String,String> m=new HashMap<String,String>(2);
  m.put("k1","v1");
  writer.addRow(new AllTypesRecord(true,(byte)10,(short)100,1000,10000L,4.0f,20.0,HiveDecimal.create("4.2222"),new Timestamp(1416967764000L),new Date(1416967764000L),"string",new HiveChar("hello",5),new HiveVarchar("hello",10),m,Arrays.asList(100,200),new AllTypesRecord.Struct(10,"foo")));
  m.clear();
  m.put("k3","v3");
  writer.addRow(new AllTypesRecord(false,(byte)20,(short)200,2000,20000L,8.0f,40.0,HiveDecimal.create("2.2222"),new Timestamp(1416967364000L),new Date(1411967764000L),"abcd",new HiveChar("world",5),new HiveVarchar("world",10),m,Arrays.asList(200,300),new AllTypesRecord.Struct(20,"bar")));
  writer.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toString(),"-d"});
  System.out.flush();
  System.setOut(origOut);
  String[] lines=myOut.toString().split("\n");
  assertEquals("{\"b\":true,\"bt\":10,\"s\":100,\"i\":1000,\"l\":10000,\"f\":4,\"d\":20,\"de\":\"4.2222\",\"t\":\"2014-11-25 18:09:24\",\"dt\":\"2014-11-25\",\"str\":\"string\",\"c\":\"hello                                                                                                                                                                                                                                                          \",\"vc\":\"hello\",\"m\":[{\"_key\":\"k1\",\"_value\":\"v1\"}],\"a\":[100,200],\"st\":{\"i\":10,\"s\":\"foo\"}}",lines[0]);
  assertEquals("{\"b\":false,\"bt\":20,\"s\":200,\"i\":2000,\"l\":20000,\"f\":8,\"d\":40,\"de\":\"2.2222\",\"t\":\"2014-11-25 18:02:44\",\"dt\":\"2014-09-28\",\"str\":\"abcd\",\"c\":\"world                                                                                                                                                                                                                                                          \",\"vc\":\"world\",\"m\":[{\"_key\":\"k3\",\"_value\":\"v3\"}],\"a\":[200,300],\"st\":{\"i\":20,\"s\":\"bar\"}}",lines[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestInputOutputFormat </h4><pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testProjectedColumnSize() throws Exception {
  long[] stripeSizes=new long[]{200,200,200,200,100};
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/file",500,createMockOrcFile(stripeSizes),new MockBlock("host1-1","host1-2","host1-3"),new MockBlock("host2-1","host0","host2-3"),new MockBlock("host0","host3-2","host3-3"),new MockBlock("host4-1","host4-2","host4-3"),new MockBlock("host5-1","host5-2","host5-3")));
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,300);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,200);
  conf.setBoolean(ColumnProjectionUtils.READ_ALL_COLUMNS,false);
  conf.set(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR,"0");
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  OrcInputFormat.SplitGenerator splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  List<OrcSplit> results=splitter.call();
  OrcSplit result=results.get(0);
  assertEquals(3,results.size());
  assertEquals(3,result.getStart());
  assertEquals(400,result.getLength());
  assertEquals(167468,result.getProjectedColumnsUncompressedSize());
  result=results.get(1);
  assertEquals(403,result.getStart());
  assertEquals(400,result.getLength());
  assertEquals(167468,result.getProjectedColumnsUncompressedSize());
  result=results.get(2);
  assertEquals(803,result.getStart());
  assertEquals(100,result.getLength());
  assertEquals(41867,result.getProjectedColumnsUncompressedSize());
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,0);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,0);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  assertEquals(5,results.size());
  for (int i=0; i < stripeSizes.length; ++i) {
    assertEquals("checking stripe " + i + " size",stripeSizes[i],results.get(i).getLength());
    if (i == stripeSizes.length - 1) {
      assertEquals(41867,results.get(i).getProjectedColumnsUncompressedSize());
    }
 else {
      assertEquals(83734,results.get(i).getProjectedColumnsUncompressedSize());
    }
  }
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,1000);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,100000);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,fs.getFileStatus(new Path("/a/file")),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  assertEquals(1,results.size());
  result=results.get(0);
  assertEquals(3,result.getStart());
  assertEquals(900,result.getLength());
  assertEquals(376804,result.getProjectedColumnsUncompressedSize());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testVectorizationWithAcid() throws Exception {
  StructObjectInspector inspector=new BigRowInspector();
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"vectorizationAcid",inspector,true,1);
  Path partDir=new Path(conf.get("mapred.input.dir"));
  OrcRecordUpdater writer=new OrcRecordUpdater(partDir,new AcidOutputFormat.Options(conf).maximumTransactionId(10).writingBase(true).bucket(0).inspector(inspector).finalDestination(partDir));
  for (int i=0; i < 100; ++i) {
    BigRow row=new BigRow(i);
    writer.insert(10,row);
  }
  WriterImpl baseWriter=(WriterImpl)writer.getWriter();
  writer.close(false);
  ((MockOutputStream)baseWriter.getStream()).setBlocks(new MockBlock("host0","host1"));
  HiveInputFormat<?,?> inputFormat=new HiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,10);
  assertEquals(1,splits.length);
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,BigRow.getColumnNamesProperty());
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,BigRow.getColumnTypesProperty());
  HiveConf.setBoolVar(conf,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> reader=inputFormat.getRecordReader(splits[0],conf,Reporter.NULL);
  NullWritable key=reader.createKey();
  VectorizedRowBatch value=reader.createValue();
  assertEquals(true,reader.next(key,value));
  assertEquals(100,value.count());
  LongColumnVector booleanColumn=(LongColumnVector)value.cols[0];
  LongColumnVector byteColumn=(LongColumnVector)value.cols[1];
  LongColumnVector shortColumn=(LongColumnVector)value.cols[2];
  LongColumnVector intColumn=(LongColumnVector)value.cols[3];
  LongColumnVector longColumn=(LongColumnVector)value.cols[4];
  DoubleColumnVector floatColumn=(DoubleColumnVector)value.cols[5];
  DoubleColumnVector doubleCoulmn=(DoubleColumnVector)value.cols[6];
  BytesColumnVector stringColumn=(BytesColumnVector)value.cols[7];
  DecimalColumnVector decimalColumn=(DecimalColumnVector)value.cols[8];
  LongColumnVector dateColumn=(LongColumnVector)value.cols[9];
  LongColumnVector timestampColumn=(LongColumnVector)value.cols[10];
  for (int i=0; i < 100; i++) {
    assertEquals("checking boolean " + i,i % 2 == 0 ? 1 : 0,booleanColumn.vector[i]);
    assertEquals("checking byte " + i,(byte)i,byteColumn.vector[i]);
    assertEquals("checking short " + i,(short)i,shortColumn.vector[i]);
    assertEquals("checking int " + i,i,intColumn.vector[i]);
    assertEquals("checking long " + i,i,longColumn.vector[i]);
    assertEquals("checking float " + i,i,floatColumn.vector[i],0.0001);
    assertEquals("checking double " + i,i,doubleCoulmn.vector[i],0.0001);
    Text strValue=new Text();
    strValue.set(stringColumn.vector[i],stringColumn.start[i],stringColumn.length[i]);
    assertEquals("checking string " + i,new Text(Long.toHexString(i)),strValue);
    assertEquals("checking decimal " + i,HiveDecimal.create(i),decimalColumn.vector[i].getHiveDecimal());
    assertEquals("checking date " + i,i,dateColumn.vector[i]);
    long millis=(long)i * MILLIS_IN_DAY;
    millis-=LOCAL_TIMEZONE.getOffset(millis);
    assertEquals("checking timestamp " + i,millis * 1000000L,timestampColumn.vector[i]);
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileGenerator() throws Exception {
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/b/part-00",1000,new byte[0]),new MockFile("mock:/a/b/part-01",1000,new byte[0]),new MockFile("mock:/a/b/_part-02",1000,new byte[0]),new MockFile("mock:/a/b/.part-03",1000,new byte[0]),new MockFile("mock:/a/b/part-04",1000,new byte[0]));
  OrcInputFormat.FileGenerator gen=new OrcInputFormat.FileGenerator(context,fs,new MockPath(fs,"mock:/a/b"),false);
  OrcInputFormat.SplitStrategy splitStrategy=createSplitStrategy(context,gen);
  assertEquals(true,splitStrategy instanceof OrcInputFormat.BISplitStrategy);
  conf.set("mapreduce.input.fileinputformat.split.maxsize","500");
  context=new OrcInputFormat.Context(conf);
  fs=new MockFileSystem(conf,new MockFile("mock:/a/b/part-00",1000,new byte[1000]),new MockFile("mock:/a/b/part-01",1000,new byte[1000]),new MockFile("mock:/a/b/_part-02",1000,new byte[1000]),new MockFile("mock:/a/b/.part-03",1000,new byte[1000]),new MockFile("mock:/a/b/part-04",1000,new byte[1000]));
  gen=new OrcInputFormat.FileGenerator(context,fs,new MockPath(fs,"mock:/a/b"),false);
  splitStrategy=createSplitStrategy(context,gen);
  assertEquals(true,splitStrategy instanceof OrcInputFormat.ETLSplitStrategy);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInOutFormat() throws Exception {
  Properties properties=new Properties();
  properties.setProperty("columns","x,y");
  properties.setProperty("columns.types","int:int");
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  SerDe serde=new OrcSerde();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,MyRow.class,true,properties,Reporter.NULL);
  writer.write(serde.serialize(new MyRow(1,2),inspector));
  writer.write(serde.serialize(new MyRow(2,2),inspector));
  writer.write(serde.serialize(new MyRow(3,2),inspector));
  writer.close(true);
  serde=new OrcSerde();
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  assertEquals(OrcSerde.OrcSerdeRow.class,serde.getSerializedClass());
  inspector=(StructObjectInspector)serde.getObjectInspector();
  assertEquals("struct<x:int,y:int>",inspector.getTypeName());
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertEquals(1,splits.length);
  ArrayList<FileStatus> fileList=new ArrayList<FileStatus>();
  assertEquals(false,((InputFormatChecker)in).validateInput(fs,new HiveConf(),fileList));
  fileList.add(fs.getFileStatus(testFilePath));
  assertEquals(true,((InputFormatChecker)in).validateInput(fs,new HiveConf(),fileList));
  fileList.add(fs.getFileStatus(workDir));
  assertEquals(false,((InputFormatChecker)in).validateInput(fs,new HiveConf(),fileList));
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,MyRow.getColumnNamesProperty());
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,MyRow.getColumnTypesProperty());
  org.apache.hadoop.mapred.RecordReader reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  Object key=reader.createKey();
  Writable value=(Writable)reader.createValue();
  int rowNum=0;
  List<? extends StructField> fields=inspector.getAllStructFieldRefs();
  IntObjectInspector intInspector=(IntObjectInspector)fields.get(0).getFieldObjectInspector();
  while (reader.next(key,value)) {
    assertEquals(++rowNum,intInspector.get(inspector.getStructFieldData(serde.deserialize(value),fields.get(0))));
    assertEquals(2,intInspector.get(inspector.getStructFieldData(serde.deserialize(value),fields.get(1))));
  }
  assertEquals(3,rowNum);
  assertEquals(1.0,reader.getProgress(),0.00001);
  reader.close();
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(0));
  reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  key=reader.createKey();
  value=(Writable)reader.createValue();
  rowNum=0;
  fields=inspector.getAllStructFieldRefs();
  while (reader.next(key,value)) {
    assertEquals(++rowNum,intInspector.get(inspector.getStructFieldData(value,fields.get(0))));
    assertEquals(null,inspector.getStructFieldData(value,fields.get(1)));
  }
  assertEquals(3,rowNum);
  reader.close();
  ColumnProjectionUtils.setReadAllColumns(conf);
  reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  key=reader.createKey();
  value=(Writable)reader.createValue();
  rowNum=0;
  fields=inspector.getAllStructFieldRefs();
  while (reader.next(key,value)) {
    assertEquals(++rowNum,intInspector.get(inspector.getStructFieldData(value,fields.get(0))));
    assertEquals(2,intInspector.get(inspector.getStructFieldData(serde.deserialize(value),fields.get(1))));
  }
  assertEquals(3,rowNum);
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMROutput() throws Exception {
  Properties properties=new Properties();
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(NestedRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  SerDe serde=new OrcSerde();
  OutputFormat<?,?> outFormat=new OrcOutputFormat();
  RecordWriter writer=outFormat.getRecordWriter(fs,conf,testFilePath.toString(),Reporter.NULL);
  writer.write(NullWritable.get(),serde.serialize(new NestedRow(1,2,3),inspector));
  writer.write(NullWritable.get(),serde.serialize(new NestedRow(4,5,6),inspector));
  writer.write(NullWritable.get(),serde.serialize(new NestedRow(7,8,9),inspector));
  writer.close(Reporter.NULL);
  serde=new OrcSerde();
  properties.setProperty("columns","z,r");
  properties.setProperty("columns.types","int:struct<x:int,y:int>");
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  inspector=(StructObjectInspector)serde.getObjectInspector();
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertEquals(1,splits.length);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(1));
  conf.set("columns","z,r");
  conf.set("columns.types","int:struct<x:int,y:int>");
  org.apache.hadoop.mapred.RecordReader reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  Object key=reader.createKey();
  Object value=reader.createValue();
  int rowNum=0;
  List<? extends StructField> fields=inspector.getAllStructFieldRefs();
  StructObjectInspector inner=(StructObjectInspector)fields.get(1).getFieldObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  IntObjectInspector intInspector=(IntObjectInspector)fields.get(0).getFieldObjectInspector();
  while (reader.next(key,value)) {
    assertEquals(null,inspector.getStructFieldData(value,fields.get(0)));
    Object sub=inspector.getStructFieldData(value,fields.get(1));
    assertEquals(3 * rowNum + 1,intInspector.get(inner.getStructFieldData(sub,inFields.get(0))));
    assertEquals(3 * rowNum + 2,intInspector.get(inner.getStructFieldData(sub,inFields.get(1))));
    rowNum+=1;
  }
  assertEquals(3,rowNum);
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test vectorization, non-acid, non-combine.
 * @throws Exception
 */
@Test public void testVectorization() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"vectorization",inspector,true,1);
  Writer writer=OrcFile.createWriter(new Path(conf.get("mapred.input.dir") + "/0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  ((MockOutputStream)((WriterImpl)writer).getStream()).setBlocks(new MockBlock("host0","host1"));
  HiveInputFormat<?,?> inputFormat=new HiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,10);
  assertEquals(1,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> reader=inputFormat.getRecordReader(splits[0],conf,Reporter.NULL);
  NullWritable key=reader.createKey();
  VectorizedRowBatch value=reader.createValue();
  assertEquals(true,reader.next(key,value));
  assertEquals(10,value.count());
  LongColumnVector col0=(LongColumnVector)value.cols[0];
  for (int i=0; i < 10; i++) {
    assertEquals("checking " + i,i,col0.vector[i]);
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testSplitStrategySelection() throws Exception {
  conf.set("mapreduce.input.fileinputformat.split.maxsize","500");
  conf.setLong(HiveConf.ConfVars.HIVE_ORC_CACHE_STRIPE_DETAILS_SIZE.varname,100);
  final int[] counts={1,10,100,256};
  final int[] sizes={100,1000};
  final int[] numSplits={1,9,10,11,99,111};
  final String[] strategyResults=new String[]{"ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","BISplitStrategy","BISplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","BISplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy","ETLSplitStrategy"};
  int k=0;
  for (  int c : counts) {
    for (    int s : sizes) {
      final FileSystem fs=generateMockFiles(c,s);
      for (      int n : numSplits) {
        final OrcInputFormat.Context context=new OrcInputFormat.Context(conf,n);
        OrcInputFormat.FileGenerator gen=new OrcInputFormat.FileGenerator(context,fs,new MockPath(fs,"mock:/a/b"),false);
        final SplitStrategy splitStrategy=createSplitStrategy(context,gen);
        assertTrue(String.format("Split strategy for %d files x %d size for %d splits",c,s,n),splitStrategy.getClass().getSimpleName().equals(strategyResults[k++]));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCombinationInputFormatWithAcid() throws Exception {
  StructObjectInspector inspector;
  final int PARTITIONS=2;
  final int BUCKETS=3;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"combinationAcid",inspector,false,PARTITIONS);
  Path[] partDir=new Path[PARTITIONS];
  String[] paths=conf.getStrings("mapred.input.dir");
  for (int p=0; p < PARTITIONS; ++p) {
    partDir[p]=new Path(paths[p]);
  }
  OrcRecordUpdater writer=new OrcRecordUpdater(partDir[0],new AcidOutputFormat.Options(conf).maximumTransactionId(10).writingBase(true).bucket(0).inspector(inspector).finalDestination(partDir[0]));
  for (int i=0; i < 10; ++i) {
    writer.insert(10,new MyRow(i,2 * i));
  }
  WriterImpl baseWriter=(WriterImpl)writer.getWriter();
  writer.close(false);
  MockOutputStream outputStream=(MockOutputStream)baseWriter.getStream();
  outputStream.setBlocks(new MockBlock("host1","host2"));
  writer=new OrcRecordUpdater(partDir[0],new AcidOutputFormat.Options(conf).maximumTransactionId(10).writingBase(true).bucket(1).inspector(inspector).finalDestination(partDir[0]));
  for (int i=10; i < 20; ++i) {
    writer.insert(10,new MyRow(i,2 * i));
  }
  WriterImpl deltaWriter=(WriterImpl)writer.getWriter();
  outputStream=(MockOutputStream)deltaWriter.getStream();
  writer.close(false);
  outputStream.setBlocks(new MockBlock("host1","host2"));
  for (int bucket=0; bucket < BUCKETS; ++bucket) {
    Writer orc=OrcFile.createWriter(new Path(partDir[1],"00000" + bucket + "_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
    orc.addRow(new MyRow(1,2));
    outputStream=(MockOutputStream)((WriterImpl)orc).getStream();
    orc.close();
    outputStream.setBlocks(new MockBlock("host3","host4"));
  }
  conf.setInt(hive_metastoreConstants.BUCKET_COUNT,BUCKETS);
  HiveInputFormat<?,?> inputFormat=new CombineHiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,1);
  assertEquals(3,splits.length);
  HiveInputFormat.HiveInputSplit split=(HiveInputFormat.HiveInputSplit)splits[0];
  assertEquals("org.apache.hadoop.hive.ql.io.orc.OrcInputFormat",split.inputFormatClassName());
  assertEquals("mock:/combinationAcid/p=0/base_0000010/bucket_00000",split.getPath().toString());
  assertEquals(0,split.getStart());
  assertEquals(607,split.getLength());
  split=(HiveInputFormat.HiveInputSplit)splits[1];
  assertEquals("org.apache.hadoop.hive.ql.io.orc.OrcInputFormat",split.inputFormatClassName());
  assertEquals("mock:/combinationAcid/p=0/base_0000010/bucket_00001",split.getPath().toString());
  assertEquals(0,split.getStart());
  assertEquals(629,split.getLength());
  CombineHiveInputFormat.CombineHiveInputSplit combineSplit=(CombineHiveInputFormat.CombineHiveInputSplit)splits[2];
  assertEquals(BUCKETS,combineSplit.getNumPaths());
  for (int bucket=0; bucket < BUCKETS; ++bucket) {
    assertEquals("mock:/combinationAcid/p=1/00000" + bucket + "_0",combineSplit.getPath(bucket).toString());
    assertEquals(0,combineSplit.getOffset(bucket));
    assertEquals(241,combineSplit.getLength(bucket));
  }
  String[] hosts=combineSplit.getLocations();
  assertEquals(2,hosts.length);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombinationInputFormat() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"combination",inspector,false,1);
  Path partDir=new Path(conf.get("mapred.input.dir"));
  Writer writer=OrcFile.createWriter(new Path(partDir,"0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  MockOutputStream outputStream=(MockOutputStream)((WriterImpl)writer).getStream();
  outputStream.setBlocks(new MockBlock("host0","host1"));
  int length0=outputStream.file.length;
  writer=OrcFile.createWriter(new Path(partDir,"1_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=10; i < 20; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  outputStream=(MockOutputStream)((WriterImpl)writer).getStream();
  outputStream.setBlocks(new MockBlock("host1","host2"));
  HiveInputFormat<?,?> inputFormat=new CombineHiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,1);
  assertEquals(1,splits.length);
  CombineHiveInputFormat.CombineHiveInputSplit split=(CombineHiveInputFormat.CombineHiveInputSplit)splits[0];
  assertEquals(2,split.getNumPaths());
  assertEquals(partDir.toString() + "/0_0",split.getPath(0).toString());
  assertEquals(partDir.toString() + "/1_0",split.getPath(1).toString());
  assertEquals(length0,split.getLength(0));
  assertEquals(outputStream.file.length,split.getLength(1));
  assertEquals(0,split.getOffset(0));
  assertEquals(0,split.getOffset(1));
  assertTrue(3 >= split.getLocations().length);
  org.apache.hadoop.mapred.RecordReader<CombineHiveKey,OrcStruct> reader=inputFormat.getRecordReader(split,conf,Reporter.NULL);
  CombineHiveKey key=reader.createKey();
  OrcStruct value=reader.createValue();
  for (int i=0; i < 20; i++) {
    assertEquals(true,reader.next(key,value));
    assertEquals(i,((IntWritable)value.getFieldValue(0)).get());
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-14 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEtlCombinedStrategy() throws Exception {
  conf.set(HiveConf.ConfVars.HIVE_ORC_SPLIT_STRATEGY.varname,"ETL");
  conf.set(HiveConf.ConfVars.HIVE_ORC_SPLIT_DIRECTORY_BATCH_MS.varname,"1000000");
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/1/part-00",1000,new byte[0]),new MockFile("mock:/a/1/part-01",1000,new byte[0]),new MockFile("mock:/a/2/part-00",1000,new byte[0]),new MockFile("mock:/a/2/part-01",1000,new byte[0]),new MockFile("mock:/a/3/base_0/1",1000,new byte[0]),new MockFile("mock:/a/4/base_0/1",1000,new byte[0]),new MockFile("mock:/a/5/base_0/1",1000,new byte[0]),new MockFile("mock:/a/5/delta_0_25/1",1000,new byte[0]));
  OrcInputFormat.CombinedCtx combineCtx=new OrcInputFormat.CombinedCtx();
  SplitStrategy<?> ss=createOrCombineStrategy(context,fs,"mock:/a/1",combineCtx);
  assertNull(ss);
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  OrcInputFormat.ETLSplitStrategy etlSs=(OrcInputFormat.ETLSplitStrategy)combineCtx.combined;
  assertEquals(2,etlSs.files.size());
  assertTrue(etlSs.isOriginal);
  assertEquals(1,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/2",combineCtx);
  assertNull(ss);
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  assertEquals(4,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/3",combineCtx);
  assertSame(etlSs,ss);
  assertEquals(4,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  etlSs=(OrcInputFormat.ETLSplitStrategy)combineCtx.combined;
  assertEquals(1,etlSs.files.size());
  assertFalse(etlSs.isOriginal);
  assertEquals(1,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/1",combineCtx);
  assertTrue(ss instanceof OrcInputFormat.ETLSplitStrategy);
  assertNotSame(etlSs,ss);
  OrcInputFormat.ETLSplitStrategy rejectedEtlSs=(OrcInputFormat.ETLSplitStrategy)ss;
  assertEquals(2,rejectedEtlSs.files.size());
  assertEquals(1,rejectedEtlSs.dirs.size());
  assertTrue(rejectedEtlSs.isOriginal);
  assertEquals(1,etlSs.files.size());
  assertEquals(1,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/4",combineCtx);
  assertNull(ss);
  assertTrue(combineCtx.combined instanceof OrcInputFormat.ETLSplitStrategy);
  assertEquals(2,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
  ss=createOrCombineStrategy(context,fs,"mock:/a/5",combineCtx);
  assertTrue(ss instanceof OrcInputFormat.ETLSplitStrategy);
  assertNotSame(etlSs,ss);
  assertEquals(2,etlSs.files.size());
  assertEquals(2,etlSs.dirs.size());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSplitGenerator() throws Exception {
  long[] stripeSizes=new long[]{197,300,600,200,200,100,100,100,100,100};
  MockFileSystem fs=new MockFileSystem(conf,new MockFile("mock:/a/file",500,createMockOrcFile(stripeSizes),new MockBlock("host1-1","host1-2","host1-3"),new MockBlock("host2-1","host0","host2-3"),new MockBlock("host0","host3-2","host3-3"),new MockBlock("host4-1","host4-2","host4-3"),new MockBlock("host5-1","host5-2","host5-3")));
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,300);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,200);
  OrcInputFormat.Context context=new OrcInputFormat.Context(conf);
  OrcInputFormat.SplitGenerator splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,AcidUtils.createOriginalObj(null,fs.getFileStatus(new Path("/a/file"))),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  List<OrcSplit> results=splitter.call();
  OrcSplit result=results.get(0);
  assertEquals(3,result.getStart());
  assertEquals(497,result.getLength());
  result=results.get(1);
  assertEquals(500,result.getStart());
  assertEquals(600,result.getLength());
  result=results.get(2);
  assertEquals(1100,result.getStart());
  assertEquals(400,result.getLength());
  result=results.get(3);
  assertEquals(1500,result.getStart());
  assertEquals(300,result.getLength());
  result=results.get(4);
  assertEquals(1800,result.getStart());
  assertEquals(200,result.getLength());
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMAXSPLITSIZE,0);
  HiveConf.setLongVar(conf,HiveConf.ConfVars.MAPREDMINSPLITSIZE,0);
  context=new OrcInputFormat.Context(conf);
  splitter=new OrcInputFormat.SplitGenerator(new OrcInputFormat.SplitInfo(context,fs,AcidUtils.createOriginalObj(null,fs.getFileStatus(new Path("/a/file"))),null,true,new ArrayList<AcidInputFormat.DeltaMetaData>(),true,null,null));
  results=splitter.call();
  for (int i=0; i < stripeSizes.length; ++i) {
    assertEquals("checking stripe " + i + " size",stripeSizes[i],results.get(i).getLength());
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultTypes() throws Exception {
  Properties properties=new Properties();
  properties.setProperty("columns","str,str2");
  properties.setProperty("columns.types","string:string");
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(StringRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  SerDe serde=new OrcSerde();
  HiveOutputFormat<?,?> outFormat=new OrcOutputFormat();
  org.apache.hadoop.hive.ql.exec.FileSinkOperator.RecordWriter writer=outFormat.getHiveRecordWriter(conf,testFilePath,StringRow.class,true,properties,Reporter.NULL);
  writer.write(serde.serialize(new StringRow("owen"),inspector));
  writer.write(serde.serialize(new StringRow("beth"),inspector));
  writer.write(serde.serialize(new StringRow("laurel"),inspector));
  writer.write(serde.serialize(new StringRow("hazen"),inspector));
  writer.write(serde.serialize(new StringRow("colin"),inspector));
  writer.write(serde.serialize(new StringRow("miles"),inspector));
  writer.close(true);
  serde=new OrcSerde();
  SerDeUtils.initializeSerDe(serde,conf,properties,null);
  inspector=(StructObjectInspector)serde.getObjectInspector();
  assertEquals("struct<str:string,str2:string>",inspector.getTypeName());
  InputFormat<?,?> in=new OrcInputFormat();
  FileInputFormat.setInputPaths(conf,testFilePath.toString());
  InputSplit[] splits=in.getSplits(conf,1);
  assertEquals(1,splits.length);
  conf.set("columns",StringRow.getColumnNamesProperty());
  conf.set("columns.types",StringRow.getColumnTypesProperty());
  org.apache.hadoop.mapred.RecordReader reader=in.getRecordReader(splits[0],conf,Reporter.NULL);
  Object key=reader.createKey();
  Writable value=(Writable)reader.createValue();
  List<? extends StructField> fields=inspector.getAllStructFieldRefs();
  StringObjectInspector strInspector=(StringObjectInspector)fields.get(0).getFieldObjectInspector();
  assertEquals(true,reader.next(key,value));
  assertEquals("owen",strInspector.getPrimitiveJavaObject(inspector.getStructFieldData(value,fields.get(0))));
  assertEquals(true,reader.next(key,value));
  assertEquals("beth",strInspector.getPrimitiveJavaObject(inspector.getStructFieldData(value,fields.get(0))));
  assertEquals(true,reader.next(key,value));
  assertEquals("laurel",strInspector.getPrimitiveJavaObject(inspector.getStructFieldData(value,fields.get(0))));
  assertEquals(true,reader.next(key,value));
  assertEquals("hazen",strInspector.getPrimitiveJavaObject(inspector.getStructFieldData(value,fields.get(0))));
  assertEquals(true,reader.next(key,value));
  assertEquals("colin",strInspector.getPrimitiveJavaObject(inspector.getStructFieldData(value,fields.get(0))));
  assertEquals(true,reader.next(key,value));
  assertEquals("miles",strInspector.getPrimitiveJavaObject(inspector.getStructFieldData(value,fields.get(0))));
  assertEquals(false,reader.next(key,value));
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Test vectorization, non-acid, non-combine.
 * @throws Exception
 */
@Test public void testVectorizationWithBuckets() throws Exception {
  StructObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  JobConf conf=createMockExecutionEnvironment(workDir,new Path("mock:///"),"vectorBuckets",inspector,true,1);
  Writer writer=OrcFile.createWriter(new Path(conf.get("mapred.input.dir") + "/0_0"),OrcFile.writerOptions(conf).blockPadding(false).bufferSize(1024).inspector(inspector));
  for (int i=0; i < 10; ++i) {
    writer.addRow(new MyRow(i,2 * i));
  }
  writer.close();
  ((MockOutputStream)((WriterImpl)writer).getStream()).setBlocks(new MockBlock("host0","host1"));
  conf.setInt(hive_metastoreConstants.BUCKET_COUNT,3);
  HiveInputFormat<?,?> inputFormat=new HiveInputFormat<WritableComparable,Writable>();
  InputSplit[] splits=inputFormat.getSplits(conf,10);
  assertEquals(1,splits.length);
  org.apache.hadoop.mapred.RecordReader<NullWritable,VectorizedRowBatch> reader=inputFormat.getRecordReader(splits[0],conf,Reporter.NULL);
  NullWritable key=reader.createKey();
  VectorizedRowBatch value=reader.createValue();
  assertEquals(true,reader.next(key,value));
  assertEquals(10,value.count());
  LongColumnVector col0=(LongColumnVector)value.cols[0];
  for (int i=0; i < 10; i++) {
    assertEquals("checking " + i,i,col0.vector[i]);
  }
  assertEquals(false,reader.next(key,value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestNewInputOutputFormat </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInputFormat() throws Exception {
  Job job=new Job(conf,"orc test");
  job.setInputFormatClass(OrcNewInputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper1.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  FileInputFormat.addInputPath(job,new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc")));
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  localFs.delete(outputPath,true);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  assertTrue(localFs.exists(outputFilePath));
  BufferedReader reader=new BufferedReader(new InputStreamReader(localFs.open(outputFilePath)));
  int count=0;
  String line;
  String lastLine=null;
  while ((line=reader.readLine()) != null) {
    count++;
    lastLine=line;
  }
  reader.close();
  assertEquals(count,7500);
  assertEquals(lastLine,"{true, 100, 2048, 65536," + " 9223372036854775807, 2.0, -5.0" + ", , bye, {[{1, bye}, {2, sigh}]}, [{100000000, cat},"+ " {-100000, in}, {1234, hat}],"+ " {chani={5, chani}, mauddib={1, mauddib}},"+ " 2000-03-12 15:00:01, 12345678.6547457}");
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewOutputFormat() throws Exception {
  int rownum=1000;
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  Random r=new Random(1000L);
  boolean firstRow=true;
  int firstIntValue=0;
  String firstStringValue=null;
  for (int i=0; i < rownum; i++) {
    int intValue=r.nextInt();
    String stringValue=UUID.randomUUID().toString();
    if (firstRow) {
      firstRow=false;
      firstIntValue=intValue;
      firstStringValue=stringValue;
    }
    pw.println(intValue + "," + stringValue);
  }
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper2.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(Writable.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  assertTrue(localFs.exists(outputFilePath));
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  assertTrue(reader.getNumberOfRows() == rownum);
  assertEquals(reader.getCompression(),CompressionKind.ZLIB);
  StructObjectInspector soi=(StructObjectInspector)reader.getObjectInspector();
  StructTypeInfo ti=(StructTypeInfo)TypeInfoUtils.getTypeInfoFromObjectInspector(soi);
  assertEquals(((PrimitiveTypeInfo)ti.getAllStructFieldTypeInfos().get(0)).getPrimitiveCategory(),PrimitiveObjectInspector.PrimitiveCategory.INT);
  assertEquals(((PrimitiveTypeInfo)ti.getAllStructFieldTypeInfos().get(1)).getPrimitiveCategory(),PrimitiveObjectInspector.PrimitiveCategory.STRING);
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  IntWritable intWritable=(IntWritable)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(0));
  Text text=(Text)soi.getStructFieldData(row,soi.getAllStructFieldRefs().get(1));
  assertEquals(intWritable.get(),firstIntValue);
  assertEquals(text.toString(),firstStringValue);
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewInputFormatPruning() throws Exception {
  conf.set("hive.io.file.read.all.columns","false");
  conf.set("hive.io.file.readcolumn.ids","1,3");
  Job job=new Job(conf,"orc test");
  job.setInputFormatClass(OrcNewInputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper1.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  FileInputFormat.addInputPath(job,new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc")));
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  localFs.delete(outputPath,true);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  BufferedReader reader=new BufferedReader(new InputStreamReader(localFs.open(outputFilePath)));
  String line=reader.readLine();
  assertEquals(line,"{null, 1, null, 65536, null, null, null, " + "null, null, null, null, null, null, null}");
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewOutputFormatWithCompression() throws Exception {
  conf.set("hive.exec.orc.default.compress","SNAPPY");
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  pw.println("1,hello");
  pw.println("2,world");
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper2.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(OrcSerdeRow.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-m-00000");
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  assertEquals(reader.getCompression(),CompressionKind.SNAPPY);
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void testNewOutputFormatComplex() throws Exception {
  Path inputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".txt");
  Path outputPath=new Path(workDir,"TestOrcFile." + testCaseName.getMethodName() + ".orc");
  localFs.delete(outputPath,true);
  PrintWriter pw=new PrintWriter(new OutputStreamWriter(localFs.create(inputPath)));
  pw.println("I have eaten");
  pw.println("the plums");
  pw.println("that were in");
  pw.println("the icebox");
  pw.println("and which");
  pw.println("you were probably");
  pw.println("saving");
  pw.println("for breakfast");
  pw.println("Forgive me");
  pw.println("they were delicious");
  pw.println("so sweet");
  pw.println("and so cold");
  pw.close();
  Job job=new Job(conf,"orc test");
  job.setOutputFormatClass(OrcNewOutputFormat.class);
  job.setJarByClass(TestNewInputOutputFormat.class);
  job.setMapperClass(OrcTestMapper3.class);
  job.setReducerClass(OrcTestReducer3.class);
  job.setMapOutputKeyClass(IntWritable.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(OrcSerdeRow.class);
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean result=job.waitForCompletion(true);
  assertTrue(result);
  Path outputFilePath=new Path(outputPath,"part-r-00000");
  Reader reader=OrcFile.createReader(outputFilePath,OrcFile.readerOptions(conf).filesystem(localFs));
  RecordReader rows=reader.rows();
  ObjectInspector orcOi=reader.getObjectInspector();
  ObjectInspector stoi=TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(OrcTestReducer3.typeInfo);
  ObjectInspectorConverters.Converter converter=ObjectInspectorConverters.getConverter(orcOi,stoi);
  Object row=rows.next(null);
  List converted=(List)converter.convert(row);
  assertEquals(1,converted.get(0));
  assertEquals(1,converted.get(1));
  List list=(List)converted.get(2);
  assertEquals(list.size(),1);
  assertEquals("saving",((List)list.get(0)).get(0));
  assertEquals(6,((List)list.get(0)).get(1));
  Map<String,Integer> map=(Map<String,Integer>)converted.get(3);
  assertEquals(map.size(),1);
  assertEquals(map.get("saving"),new Integer(1));
  row=rows.next(null);
  converted=(List)converter.convert(row);
  assertEquals(2,converted.get(0));
  assertEquals(6,converted.get(1));
  list=(List)converted.get(2);
  assertEquals(list.size(),6);
  assertEquals("breakfast",((List)list.get(0)).get(0));
  assertEquals(9,((List)list.get(0)).get(1));
  map=(Map<String,Integer>)converted.get(3);
  assertEquals(map.size(),11);
  assertEquals(map.get("the"),new Integer(2));
  row=rows.next(null);
  converted=(List)converter.convert(row);
  assertEquals(3,converted.get(0));
  assertEquals(5,converted.get(1));
  list=(List)converted.get(2);
  assertEquals(list.size(),5);
  assertEquals("cold",((List)list.get(0)).get(0));
  assertEquals(4,((List)list.get(0)).get(1));
  map=(Map<String,Integer>)converted.get(3);
  assertEquals(map.size(),13);
  assertEquals(map.get("were"),new Integer(3));
  assertFalse(rows.hasNext());
  localFs.delete(outputPath,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestNewIntegerEncoding </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaOverflow3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{-4513343538618202711l,-2911390882471569739l,-2,Long.MAX_VALUE};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 100000; i++) {
    input.add((long)rand.nextInt());
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).stripeSize(100000).bufferSize(10000).version(OrcFile.Version.V_0_11).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=55555;
  rows.seekToRow(idx);
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin4() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{13,13,11,8,13,10,10,11,11,14,11,7,13,12,12,11,15,12,12,9,8,10,13,11,8,6,5,6,11,7,15,10,7,6,8,7,9,9,11,33,11,3,7,4,6,10,14,12,5,14,7,6};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add(371946367L);
  input.add(11963367L);
  input.add(68639400007L);
  input.add(100233367L);
  input.add(6367L);
  input.add(10026367L);
  input.add(3670000L);
  input.add(3602367L);
  input.add(4719226367L);
  input.add(7196367L);
  input.add(444442L);
  input.add(210267L);
  input.add(21033L);
  input.add(160267L);
  input.add(400267L);
  input.add(23634347L);
  input.add(16027L);
  input.add(46026367L);
  input.add(Long.MAX_VALUE);
  input.add(33333L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{20,2,3,2,1,3,17,71,35,2,1,139,2,2,3,1783,475,2,1,1,3,1,3,2,32,1,2,3,1,8,30,1,3,414,1,1,135,3,3,1,414,2,1,2,2,594,2,5,6,4,11,1,2,2,1,1,52,4,1,2,7,1,17,334,1,2,1,2,2,6,1,266,1,2,217,2,6,2,13,2,2,1,2,3,5,1,2,1,7244,11813,1,33,2,-13,1,2,3,13,1,92,3,13,5,14,9,141,12,6,15,25,1,1,1,46,2,1,1,141,3,1,1,1,1,2,1,4,34,5,78,8,1,2,2,1,9,10,2,1,4,13,1,5,4,4,19,5,1,1,1,68,33,399,1,1885,25,5,2,4,1,1,2,16,1,2966,3,1,1,25501,1,1,1,66,1,3,8,131,14,5,1,2,2,1,1,8,1,1,2,1,5,9,2,3,112,13,2,2,1,5,10,3,1,1,13,2,3,4,1,3,1,1,2,1,1,2,4,2,207,1,1,2,4,3,3,2,2,16};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{20,2,3,2,1,3,17,71,35,2,1,139,2,2,3,1783,475,2,1,1,3,1,3,2,32,1,2,3,1,8,30,1,3,414,1,1,135,3,3,1,414,2,1,2,2,594,2,5,6,4,11,1,2,2,1,1,52,4,1,2,7,1,17,334,1,2,1,2,2,6,1,266,1,2,217,2,6,2,13,2,2,1,2,3,5,1,2,1,7244,11813,1,33,2,0,1,2,3,13,1,92,3,13,5,14,9,141,12,6,15,25,1,1,1,46,2,1,1,141,3,1,1,1,1,2,1,4,34,5,78,8,1,2,2,1,9,10,2,1,4,13,1,5,4,4,19,5,1,1,1,68,33,399,1,1885,25,5,2,4,1,1,2,16,1,2966,3,1,1,25501,1,1,1,66,1,3,8,131,14,5,1,2,2,1,1,8,1,1,2,1,5,9,2,3,112,13,2,2,1,5,10,3,1,1,13,2,3,4,1,3,1,1,2,1,1,2,4,2,207,1,1,2,4,3,3,2,2,16};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(60));
  }
  input.set(128,Long.MAX_VALUE);
  input.set(256,Long.MAX_VALUE);
  input.set(511,Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRandomInt() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 100000; i++) {
    input.add((long)rand.nextInt());
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{-500,-400,-350,-325,-310};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerMax() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add((long)Integer.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt0() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(0,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseNegativeMin2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{20,2,3,2,1,3,17,71,35,2,1,139,2,2,3,1783,475,2,1,1,3,1,3,2,32,1,2,3,1,8,30,1,3,414,1,1,135,3,3,1,414,2,1,2,2,594,2,5,6,4,11,1,2,2,1,1,52,4,1,2,7,1,17,334,1,2,1,2,2,6,1,266,1,2,217,2,6,2,13,2,2,1,2,3,5,1,2,1,7244,11813,1,33,2,-1,1,2,3,13,1,92,3,13,5,14,9,141,12,6,15,25,1,1,1,46,2,1,1,141,3,1,1,1,1,2,1,4,34,5,78,8,1,2,2,1,9,10,2,1,4,13,1,5,4,4,19,5,1,1,1,68,33,399,1,1885,25,5,2,4,1,1,2,16,1,2966,3,1,1,25501,1,1,1,66,1,3,8,131,14,5,1,2,2,1,1,8,1,1,2,1,5,9,2,3,112,13,2,2,1,5,10,3,1,1,13,2,3,4,1,3,1,1,2,1,1,2,4,2,207,1,1,2,4,3,3,2,2,16};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongMin() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add(Long.MIN_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicRow() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Row.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  writer.addRow(new Row(111,1111L));
  writer.addRow(new Row(111,1111L));
  writer.addRow(new Row(111,1111L));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new IntWritable(111),((OrcStruct)row).getFieldValue(0));
    assertEquals(new LongWritable(1111),((OrcStruct)row).getFieldValue(1));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerMin() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add((long)Integer.MIN_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseTimestamp() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(TSRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2099-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("1993-08-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2007-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2008-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1994-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2004-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2001-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2000-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2011-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00"));
  tslist.add(Timestamp.valueOf("1974-01-01 00:00:00"));
  for (  Timestamp ts : tslist) {
    writer.addRow(new TSRow(ts));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((TimestampWritable)((OrcStruct)row).getFieldValue(0)).getNanos());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(1,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax4() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  for (int i=0; i < 25; i++) {
    input.add(371292224226367L);
    input.add(119622332222267L);
    input.add(686329400222007L);
    input.add(100233333222367L);
    input.add(636272333322222L);
    input.add(10202633223267L);
    input.add(36700222022230L);
    input.add(36023226224227L);
    input.add(47192226364427L);
    input.add(71963622222447L);
    input.add(22244444222222L);
    input.add(21220263327442L);
    input.add(21032233332232L);
    input.add(16026322232227L);
    input.add(40022262272212L);
    input.add(23634342227222L);
    input.add(16022222222227L);
    input.add(46026362222227L);
    input.add(46026362222227L);
    input.add(33322222222323L);
  }
  input.add(Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongMax() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  input.add(Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta3() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{500,400,350,325,310};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRandomLong() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 100000; i++) {
    input.add(rand.nextLong());
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt256() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(256,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaOverflow() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{4513343538618202719l,4513343538618202711l,2911390882471569739l,-9181829309989854913l};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{-500,-600,-650,-675,-710};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseAt255() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(255,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBaseMax1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(60));
  }
  input.set(511,Long.MAX_VALUE);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBase510() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(510,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDirectLargeNegatives() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  writer.addRow(-7486502418706614742L);
  writer.addRow(0L);
  writer.addRow(1L);
  writer.addRow(1L);
  writer.addRow(-5535739865598783616L);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertEquals(-7486502418706614742L,((LongWritable)row).get());
  row=rows.next(row);
  assertEquals(0L,((LongWritable)row).get());
  row=rows.next(row);
  assertEquals(1L,((LongWritable)row).get());
  row=rows.next(row);
  assertEquals(1L,((LongWritable)row).get());
  row=rows.next(row);
  assertEquals(-5535739865598783616L,((LongWritable)row).get());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicNew() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{1,1,1,1,1,1,1,1,1,1,1,2,3,4,5,6,7,8,9,10,1,1,1,1,1,1,10,9,7,6,5,4,3,2,1,1,1,1,1,2,5,1,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,2000,2,1,1,1,1,1,3,7,1,9,2,6,1,1,1,1,1};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaOverflow2() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{Long.MAX_VALUE,4513343538618202711l,2911390882471569739l,Long.MIN_VALUE};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicDelta4() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{500,600,650,675,710};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicOld() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{1,1,1,1,1,1,1,1,1,1,1,2,3,4,5,6,7,8,9,10,1,1,1,1,1,1,10,9,7,6,5,4,3,2,1,1,1,1,1,2,5,1,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,3,7,1,9,2,6,2000,2,1,1,1,1,1,3,7,1,9,2,6,1,1,1,1,1};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).version(OrcFile.Version.V_0_11).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBase511() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  List<Long> input=Lists.newArrayList();
  Random rand=new Random();
  for (int i=0; i < 5120; i++) {
    input.add((long)rand.nextInt(100));
  }
  input.set(511,20000L);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).encodingStrategy(encodingStrategy));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcFile </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringAndBinaryStatistics() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(SimpleStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4),"foo"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3),"bar"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4,5),null));
  writer.addRow(new SimpleStruct(null,"hi"));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(2,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,true};
  boolean[] included=OrcUtils.includeColumns("string1",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns(null,schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4,stats[0].getNumberOfValues());
  assertEquals("count: 4 hasNull: false",stats[0].toString());
  assertEquals(3,stats[1].getNumberOfValues());
  assertEquals(15,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals("count: 3 hasNull: true sum: 15",stats[1].toString());
  assertEquals(3,stats[2].getNumberOfValues());
  assertEquals("bar",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals(8,((StringColumnStatistics)stats[2]).getSum());
  assertEquals("count: 3 hasNull: true min: bar max: hi sum: 8",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<bytes1:binary,string1:string>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("foo",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("bar",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3,4,5),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertNull(st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertNull(bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV12() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).batchSize(100).version(OrcFile.Version.V_0_12));
  assertEquals(testFilePath,memory.path);
  for (int i=0; i < 2500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(3,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testSnappy() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.SNAPPY).bufferSize(100));
  Random rand=new Random(12);
  for (int i=0; i < 10000; ++i) {
    writer.addRow(new InnerStruct(rand.nextInt(),Integer.toHexString(rand.nextInt())));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  rand=new Random(12);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(rand.nextInt(),((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(rand.nextInt()),row.getFieldValue(1).toString());
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestamp() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).version(OrcFile.Version.V_0_11));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2037-01-01 00:00:00.000999"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.000000222"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00.999999999"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00.688888888"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00.1"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00.000009001"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00.000002229"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00.900203003"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.800000007"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00.723100809"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00.857340643"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  for (  Timestamp ts : tslist) {
    writer.addRow(ts);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((TimestampWritable)row).getNanos());
  }
  assertEquals(0,writer.getSchema().getMaximumId());
  boolean[] expected=new boolean[]{false};
  boolean[] included=OrcUtils.includeColumns("",writer.getSchema());
  assertEquals(true,Arrays.equals(expected,included));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testZeroCopySeek() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(200000).bufferSize(65536).rowIndexStride(1000));
  Random rand=new Random(42);
  final int COUNT=32768;
  long[] intValues=new long[COUNT];
  double[] doubleValues=new double[COUNT];
  String[] stringValues=new String[COUNT];
  BytesWritable[] byteValues=new BytesWritable[COUNT];
  String[] words=new String[128];
  for (int i=0; i < words.length; ++i) {
    words[i]=Integer.toHexString(rand.nextInt());
  }
  for (int i=0; i < COUNT / 2; ++i) {
    intValues[2 * i]=rand.nextLong();
    intValues[2 * i + 1]=intValues[2 * i];
    stringValues[2 * i]=words[rand.nextInt(words.length)];
    stringValues[2 * i + 1]=stringValues[2 * i];
  }
  for (int i=0; i < COUNT; ++i) {
    doubleValues[i]=rand.nextDouble();
    byte[] buf=new byte[20];
    rand.nextBytes(buf);
    byteValues[i]=new BytesWritable(buf);
  }
  for (int i=0; i < COUNT; ++i) {
    writer.addRow(createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i));
  }
  writer.close();
  writer=null;
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(COUNT,reader.getNumberOfRows());
  Configuration conf=new Configuration();
  HiveConf.setBoolVar(conf,HiveConf.ConfVars.HIVE_ORC_ZEROCOPY,true);
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int i=COUNT - 1; i >= 0; --i) {
    rows.seekToRow(i);
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i);
    assertEquals(expected.boolean1.booleanValue(),((BooleanWritable)row.getFieldValue(0)).get());
    assertEquals(expected.byte1.byteValue(),((ByteWritable)row.getFieldValue(1)).get());
    assertEquals(expected.short1.shortValue(),((ShortWritable)row.getFieldValue(2)).get());
    assertEquals(expected.int1.intValue(),((IntWritable)row.getFieldValue(3)).get());
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.float1.floatValue(),((FloatWritable)row.getFieldValue(5)).get(),0.0001);
    assertEquals(expected.double1.doubleValue(),((DoubleWritable)row.getFieldValue(6)).get(),0.0001);
    assertEquals(expected.bytes1,row.getFieldValue(7));
    assertEquals(expected.string1,row.getFieldValue(8));
    List<InnerStruct> expectedList=expected.middle.list;
    List<OrcStruct> actualList=(List)((OrcStruct)row.getFieldValue(9)).getFieldValue(0);
    compareList(expectedList,actualList);
    compareList(expected.list,(List)row.getFieldValue(10));
  }
  rows.close();
  Iterator<StripeInformation> stripeIterator=reader.getStripes().iterator();
  long offsetOfStripe2=0;
  long offsetOfStripe4=0;
  long lastRowOfStripe2=0;
  for (int i=0; i < 5; ++i) {
    StripeInformation stripe=stripeIterator.next();
    if (i < 2) {
      lastRowOfStripe2+=stripe.getNumberOfRows();
    }
 else     if (i == 2) {
      offsetOfStripe2=stripe.getOffset();
      lastRowOfStripe2+=stripe.getNumberOfRows() - 1;
    }
 else     if (i == 4) {
      offsetOfStripe4=stripe.getOffset();
    }
  }
  boolean[] columns=new boolean[reader.getStatistics().length];
  columns[5]=true;
  columns[9]=true;
  rows=reader.rowsOptions(new Reader.Options().range(offsetOfStripe2,offsetOfStripe4 - offsetOfStripe2).include(columns));
  rows.seekToRow(lastRowOfStripe2);
  for (int i=0; i < 2; ++i) {
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,(int)(lastRowOfStripe2 + i));
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.string1,row.getFieldValue(8));
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBitPack64Large() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  int size=1080832;
  long[] inp=new long[size];
  Random rand=new Random(1234);
  for (int i=0; i < size; i++) {
    inp[i]=rand.nextLong();
  }
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.ZLIB));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    Assert.assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPredicatePushdown() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(fs,testFilePath,conf,inspector,400000L,CompressionKind.NONE,500,1000);
  for (int i=0; i < 3500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(3500,reader.getNumberOfRows());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().startNot().lessThan("int1",PredicateLeaf.Type.LONG,300000L).end().lessThan("int1",PredicateLeaf.Type.LONG,600000L).end().build();
  RecordReader rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(1000L,rows.getRowNumber());
  OrcStruct row=null;
  for (int i=1000; i < 2000; ++i) {
    assertTrue(rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
  sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("int1",PredicateLeaf.Type.LONG,0L).end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(3500L,rows.getRowNumber());
  assertTrue(!rows.hasNext());
  sarg=SearchArgumentFactory.newBuilder().startOr().lessThan("int1",PredicateLeaf.Type.LONG,300L * 100).startNot().lessThan("int1",PredicateLeaf.Type.LONG,300L * 3400).end().end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  row=null;
  for (int i=0; i < 1000; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  for (int i=3000; i < 3500; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(200000).bufferSize(65536).rowIndexStride(1000));
  Random rand=new Random(42);
  final int COUNT=32768;
  long[] intValues=new long[COUNT];
  double[] doubleValues=new double[COUNT];
  String[] stringValues=new String[COUNT];
  BytesWritable[] byteValues=new BytesWritable[COUNT];
  String[] words=new String[128];
  for (int i=0; i < words.length; ++i) {
    words[i]=Integer.toHexString(rand.nextInt());
  }
  for (int i=0; i < COUNT / 2; ++i) {
    intValues[2 * i]=rand.nextLong();
    intValues[2 * i + 1]=intValues[2 * i];
    stringValues[2 * i]=words[rand.nextInt(words.length)];
    stringValues[2 * i + 1]=stringValues[2 * i];
  }
  for (int i=0; i < COUNT; ++i) {
    doubleValues[i]=rand.nextDouble();
    byte[] buf=new byte[20];
    rand.nextBytes(buf);
    byteValues[i]=new BytesWritable(buf);
  }
  for (int i=0; i < COUNT; ++i) {
    writer.addRow(createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(COUNT,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int i=COUNT - 1; i >= 0; --i) {
    rows.seekToRow(i);
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i);
    assertEquals(expected.boolean1.booleanValue(),((BooleanWritable)row.getFieldValue(0)).get());
    assertEquals(expected.byte1.byteValue(),((ByteWritable)row.getFieldValue(1)).get());
    assertEquals(expected.short1.shortValue(),((ShortWritable)row.getFieldValue(2)).get());
    assertEquals(expected.int1.intValue(),((IntWritable)row.getFieldValue(3)).get());
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.float1,((FloatWritable)row.getFieldValue(5)).get(),0.0001);
    assertEquals(expected.double1,((DoubleWritable)row.getFieldValue(6)).get(),0.0001);
    assertEquals(expected.bytes1,row.getFieldValue(7));
    assertEquals(expected.string1,row.getFieldValue(8));
    List<InnerStruct> expectedList=expected.middle.list;
    List<OrcStruct> actualList=(List<OrcStruct>)((OrcStruct)row.getFieldValue(9)).getFieldValue(0);
    compareList(expectedList,actualList);
    compareList(expected.list,(List<OrcStruct>)row.getFieldValue(10));
  }
  rows.close();
  Iterator<StripeInformation> stripeIterator=reader.getStripes().iterator();
  long offsetOfStripe2=0;
  long offsetOfStripe4=0;
  long lastRowOfStripe2=0;
  for (int i=0; i < 5; ++i) {
    StripeInformation stripe=stripeIterator.next();
    if (i < 2) {
      lastRowOfStripe2+=stripe.getNumberOfRows();
    }
 else     if (i == 2) {
      offsetOfStripe2=stripe.getOffset();
      lastRowOfStripe2+=stripe.getNumberOfRows() - 1;
    }
 else     if (i == 4) {
      offsetOfStripe4=stripe.getOffset();
    }
  }
  boolean[] columns=new boolean[reader.getStatistics().length];
  columns[5]=true;
  columns[9]=true;
  rows=reader.rowsOptions(new Reader.Options().range(offsetOfStripe2,offsetOfStripe4 - offsetOfStripe2).include(columns));
  rows.seekToRow(lastRowOfStripe2);
  for (int i=0; i < 2; ++i) {
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,(int)(lastRowOfStripe2 + i));
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.string1,row.getFieldValue(8));
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void emptyFile() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(false,reader.rows().hasNext());
  assertEquals(CompressionKind.NONE,reader.getCompression());
  assertEquals(0,reader.getNumberOfRows());
  assertEquals(0,reader.getCompressionSize());
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(3,reader.getContentLength());
  assertEquals(false,reader.getStripes().iterator().hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void metaData() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100));
  writer.addUserMetadata("my.meta",byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128));
  writer.addUserMetadata("clobber",byteBuf(1,2,3));
  writer.addUserMetadata("clobber",byteBuf(4,3,2,1));
  ByteBuffer bigBuf=ByteBuffer.allocate(40000);
  Random random=new Random(0);
  random.nextBytes(bigBuf.array());
  writer.addUserMetadata("big",bigBuf);
  bigBuf.position(0);
  writer.addRow(new BigRow(true,(byte)127,(short)1024,42,42L * 1024 * 1024* 1024,(float)3.1415,-2.713,null,null,null,null,null));
  writer.addUserMetadata("clobber",byteBuf(5,7,11,13,17,19));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(byteBuf(5,7,11,13,17,19),reader.getMetadataValue("clobber"));
  assertEquals(byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128),reader.getMetadataValue("my.meta"));
  assertEquals(bigBuf,reader.getMetadataValue("big"));
  try {
    reader.getMetadataValue("unknown");
    assertTrue(false);
  }
 catch (  IllegalArgumentException iae) {
  }
  int i=0;
  for (  String key : reader.getMetadataKeys()) {
    if ("my.meta".equals(key) || "clobber".equals(key) || "big".equals(key)) {
      i+=1;
    }
 else {
      throw new IllegalArgumentException("unknown key " + key);
    }
  }
  assertEquals(3,i);
  int numStripes=reader.getStripeStatistics().size();
  assertEquals(1,numStripes);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new BigRow(false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map()));
  writer.addRow(new BigRow(true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib"))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(23,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,byte1,short1,int1,long1,float1,double1,bytes1,string1,middle,list,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  StripeStatistics ss=reader.getStripeStatistics().get(0);
  assertEquals(2,ss.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)ss.getColumnStatistics()[1]).getTrueCount());
  assertEquals(1024,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMinimum());
  assertEquals(2048,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMaximum());
  assertEquals(3072,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getSum());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testWithoutIndex() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(5000).compress(CompressionKind.SNAPPY).bufferSize(1000).rowIndexStride(0));
  Random rand=new Random(24);
  for (int i=0; i < 10000; ++i) {
    InnerStruct row=new InnerStruct(rand.nextInt(),Integer.toBinaryString(rand.nextInt()));
    for (int j=0; j < 5; ++j) {
      writer.addRow(row);
    }
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(50000,reader.getNumberOfRows());
  assertEquals(0,reader.getRowIndexStride());
  StripeInformation stripe=reader.getStripes().iterator().next();
  assertEquals(true,stripe.getDataLength() != 0);
  assertEquals(0,stripe.getIndexLength());
  RecordReader rows=reader.rows();
  rand=new Random(24);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    int intVal=rand.nextInt();
    String strVal=Integer.toBinaryString(rand.nextInt());
    for (int j=0; j < 5; ++j) {
      assertEquals(true,rows.hasNext());
      row=(OrcStruct)rows.next(row);
      assertEquals(intVal,((IntWritable)row.getFieldValue(0)).get());
      assertEquals(strVal,row.getFieldValue(1).toString());
    }
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStripeLevelStats() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000).batchSize(1000));
  for (int i=0; i < 11000; i++) {
    if (i >= 5000) {
      if (i >= 10000) {
        writer.addRow(new InnerStruct(3,"three"));
      }
 else {
        writer.addRow(new InnerStruct(2,"two"));
      }
    }
 else {
      writer.addRow(new InnerStruct(1,"one"));
    }
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(2,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,true,false};
  boolean[] included=OrcUtils.includeColumns("int1",schema);
  assertEquals(true,Arrays.equals(expected,included));
  List<StripeStatistics> stats=reader.getStripeStatistics();
  int numStripes=stats.size();
  assertEquals(3,numStripes);
  StripeStatistics ss1=stats.get(0);
  StripeStatistics ss2=stats.get(1);
  StripeStatistics ss3=stats.get(2);
  assertEquals(5000,ss1.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(5000,ss2.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1000,ss3.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(5000,(ss1.getColumnStatistics()[1]).getNumberOfValues());
  assertEquals(5000,(ss2.getColumnStatistics()[1]).getNumberOfValues());
  assertEquals(1000,(ss3.getColumnStatistics()[1]).getNumberOfValues());
  assertEquals(1,((IntegerColumnStatistics)ss1.getColumnStatistics()[1]).getMinimum());
  assertEquals(2,((IntegerColumnStatistics)ss2.getColumnStatistics()[1]).getMinimum());
  assertEquals(3,((IntegerColumnStatistics)ss3.getColumnStatistics()[1]).getMinimum());
  assertEquals(1,((IntegerColumnStatistics)ss1.getColumnStatistics()[1]).getMaximum());
  assertEquals(2,((IntegerColumnStatistics)ss2.getColumnStatistics()[1]).getMaximum());
  assertEquals(3,((IntegerColumnStatistics)ss3.getColumnStatistics()[1]).getMaximum());
  assertEquals(5000,((IntegerColumnStatistics)ss1.getColumnStatistics()[1]).getSum());
  assertEquals(10000,((IntegerColumnStatistics)ss2.getColumnStatistics()[1]).getSum());
  assertEquals(3000,((IntegerColumnStatistics)ss3.getColumnStatistics()[1]).getSum());
  assertEquals(5000,(ss1.getColumnStatistics()[2]).getNumberOfValues());
  assertEquals(5000,(ss2.getColumnStatistics()[2]).getNumberOfValues());
  assertEquals(1000,(ss3.getColumnStatistics()[2]).getNumberOfValues());
  assertEquals("one",((StringColumnStatistics)ss1.getColumnStatistics()[2]).getMinimum());
  assertEquals("two",((StringColumnStatistics)ss2.getColumnStatistics()[2]).getMinimum());
  assertEquals("three",((StringColumnStatistics)ss3.getColumnStatistics()[2]).getMinimum());
  assertEquals("one",((StringColumnStatistics)ss1.getColumnStatistics()[2]).getMaximum());
  assertEquals("two",((StringColumnStatistics)ss2.getColumnStatistics()[2]).getMaximum());
  assertEquals("three",((StringColumnStatistics)ss3.getColumnStatistics()[2]).getMaximum());
  assertEquals(15000,((StringColumnStatistics)ss1.getColumnStatistics()[2]).getSum());
  assertEquals(15000,((StringColumnStatistics)ss2.getColumnStatistics()[2]).getSum());
  assertEquals(5000,((StringColumnStatistics)ss3.getColumnStatistics()[2]).getSum());
  RecordReaderImpl recordReader=(RecordReaderImpl)reader.rows();
  OrcProto.RowIndex[] index=recordReader.readRowIndex(0,null,null).getRowGroupIndex();
  assertEquals(3,index.length);
  List<OrcProto.RowIndexEntry> items=index[1].getEntryList();
  assertEquals(1,items.size());
  assertEquals(3,items.get(0).getPositionsCount());
  assertEquals(0,items.get(0).getPositions(0));
  assertEquals(0,items.get(0).getPositions(1));
  assertEquals(0,items.get(0).getPositions(2));
  assertEquals(1,items.get(0).getStatistics().getIntStatistics().getMinimum());
  index=recordReader.readRowIndex(1,null,null).getRowGroupIndex();
  assertEquals(3,index.length);
  items=index[1].getEntryList();
  assertEquals(2,items.get(0).getStatistics().getIntStatistics().getMaximum());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We test union, timestamp, and decimal separately since we need to make the
 * object inspector manually. (The Hive reflection-based doesn't handle
 * them properly.)
 */
@Test public void testUnionAndTimestamp() throws Exception {
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addFieldNames("time").addFieldNames("union").addFieldNames("decimal").addSubtypes(1).addSubtypes(2).addSubtypes(5).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.TIMESTAMP).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.UNION).addSubtypes(3).addSubtypes(4).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRING).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.DECIMAL).build());
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=OrcStruct.createObjectInspector(0,types);
  }
  HiveDecimal maxValue=HiveDecimal.create("10000000000000000000");
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).batchSize(1000).bufferSize(100).blockPadding(false));
  OrcStruct row=new OrcStruct(3);
  OrcUnion union=new OrcUnion();
  row.setFieldValue(1,union);
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")));
  HiveDecimal value=HiveDecimal.create("12345678.6547456");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  union.set((byte)0,new IntWritable(42));
  writer.addRow(row);
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")));
  union.set((byte)1,new Text("hello"));
  value=HiveDecimal.create("-5643.234");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  writer.addRow(row);
  row.setFieldValue(0,null);
  row.setFieldValue(1,null);
  row.setFieldValue(2,null);
  writer.addRow(row);
  row.setFieldValue(1,union);
  union.set((byte)0,null);
  writer.addRow(row);
  union.set((byte)1,null);
  writer.addRow(row);
  union.set((byte)0,new IntWritable(200000));
  row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")));
  value=HiveDecimal.create("10000000000000000000");
  row.setFieldValue(2,new HiveDecimalWritable(value));
  writer.addRow(row);
  Random rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row.setFieldValue(0,new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)));
    if ((i & 1) == 0) {
      union.set((byte)0,new IntWritable(i * i));
    }
 else {
      union.set((byte)1,new Text(Integer.toString(i * i)));
    }
    value=HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18));
    row.setFieldValue(2,new HiveDecimalWritable(value));
    if (maxValue.compareTo(value) < 0) {
      maxValue=value;
    }
    writer.addRow(row);
  }
  row.setFieldValue(0,null);
  union.set((byte)0,new IntWritable(1732050807));
  row.setFieldValue(2,null);
  for (int i=0; i < 5000; ++i) {
    writer.addRow(row);
  }
  union.set((byte)0,new IntWritable(0));
  writer.addRow(row);
  union.set((byte)0,new IntWritable(10));
  writer.addRow(row);
  union.set((byte)0,new IntWritable(138));
  writer.addRow(row);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  TypeDescription schema=writer.getSchema();
  assertEquals(5,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,true};
  included=OrcUtils.includeColumns("time,decimal",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,true,true,true,false};
  included=OrcUtils.includeColumns("union",schema);
  assertEquals(true,Arrays.equals(expected,included));
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(5077,reader.getNumberOfRows());
  DecimalColumnStatistics stats=(DecimalColumnStatistics)reader.getStatistics()[5];
  assertEquals(71,stats.getNumberOfValues());
  assertEquals(HiveDecimal.create("-5643.234"),stats.getMinimum());
  assertEquals(maxValue,stats.getMaximum());
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  assertEquals(reader.getContentLength(),currentOffset);
  RecordReader rows=reader.rows();
  assertEquals(0,rows.getRowNumber());
  assertEquals(0.0,rows.getProgress(),0.000001);
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(1,rows.getRowNumber());
  inspector=reader.getObjectInspector();
  assertEquals("struct<time:timestamp,union:uniontype<int,string>,decimal:decimal(38,18)>",inspector.getTypeName());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")),row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(new IntWritable(42),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("12345678.6547456")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(2,rows.getRowNumber());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(null,row.getFieldValue(1));
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")),row.getFieldValue(0));
  assertEquals(new IntWritable(200000),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("10000000000000000000")),row.getFieldValue(2));
  rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)),row.getFieldValue(0));
    if ((i & 1) == 0) {
      assertEquals(0,union.getTag());
      assertEquals(new IntWritable(i * i),union.getObject());
    }
 else {
      assertEquals(1,union.getTag());
      assertEquals(new Text(Integer.toString(i * i)),union.getObject());
    }
    assertEquals(new HiveDecimalWritable(HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18))),row.getFieldValue(2));
  }
  for (int i=0; i < 5000; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new IntWritable(1732050807),union.getObject());
  }
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(0),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(10),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(138),union.getObject());
  assertEquals(false,rows.hasNext());
  assertEquals(1.0,rows.getProgress(),0.00001);
  assertEquals(reader.getNumberOfRows(),rows.getRowNumber());
  rows.seekToRow(1);
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFormat_0_11() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>,ts:timestamp,"+ "decimal1:decimal(38,18)>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  HiveDecimalObjectInspector dco=(HiveDecimalObjectInspector)readerInspector.getStructFieldRef("decimal1").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547456"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547457"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV11() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).batchSize(100).version(OrcFile.Version.V_0_11));
  assertEquals(testFilePath,memory.path);
  for (int i=0; i < 2500; ++i) {
    writer.addRow(new InnerStruct(i * 300,Integer.toHexString(10 * i)));
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(25,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void columnProjection() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(InnerStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).rowIndexStride(1000));
  Random r1=new Random(1);
  Random r2=new Random(2);
  int x;
  int minInt=0, maxInt=0;
  String y;
  String minStr=null, maxStr=null;
  for (int i=0; i < 21000; ++i) {
    x=r1.nextInt();
    y=Long.toHexString(r2.nextLong());
    if (i == 0 || x < minInt) {
      minInt=x;
    }
    if (i == 0 || x > maxInt) {
      maxInt=x;
    }
    if (i == 0 || y.compareTo(minStr) < 0) {
      minStr=y;
    }
    if (i == 0 || y.compareTo(maxStr) > 0) {
      maxStr=y;
    }
    writer.addRow(inner(x,y));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(3,stats.length);
  for (  ColumnStatistics s : stats) {
    assertEquals(21000,s.getNumberOfValues());
    if (s instanceof IntegerColumnStatistics) {
      assertEquals(minInt,((IntegerColumnStatistics)s).getMinimum());
      assertEquals(maxInt,((IntegerColumnStatistics)s).getMaximum());
    }
 else     if (s instanceof StringColumnStatistics) {
      assertEquals(maxStr,((StringColumnStatistics)s).getMaximum());
      assertEquals(minStr,((StringColumnStatistics)s).getMinimum());
    }
  }
  List<OrcProto.Type> types=reader.getTypes();
  assertEquals(3,types.size());
  assertEquals(OrcProto.Type.Kind.STRUCT,types.get(0).getKind());
  assertEquals(2,types.get(0).getSubtypesCount());
  assertEquals(1,types.get(0).getSubtypes(0));
  assertEquals(2,types.get(0).getSubtypes(1));
  assertEquals(OrcProto.Type.Kind.INT,types.get(1).getKind());
  assertEquals(0,types.get(1).getSubtypesCount());
  assertEquals(OrcProto.Type.Kind.STRING,types.get(2).getKind());
  assertEquals(0,types.get(2).getSubtypesCount());
  RecordReader rows1=reader.rows(new boolean[]{true,true,false});
  RecordReader rows2=reader.rows(new boolean[]{true,false,true});
  r1=new Random(1);
  r2=new Random(2);
  OrcStruct row1=null;
  OrcStruct row2=null;
  for (int i=0; i < 21000; ++i) {
    assertEquals(true,rows1.hasNext());
    assertEquals(true,rows2.hasNext());
    row1=(OrcStruct)rows1.next(row1);
    row2=(OrcStruct)rows2.next(row2);
    assertEquals(r1.nextInt(),((IntWritable)row1.getFieldValue(0)).get());
    assertEquals(Long.toHexString(r2.nextLong()),row2.getFieldValue(1).toString());
  }
  assertEquals(false,rows1.hasNext());
  assertEquals(false,rows2.hasNext());
  rows1.close();
  rows2.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcNullOptimization </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnsWithNullAndCompression() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcNullOptimization.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new MyStruct(3,"a",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(null,"b",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(3,null,false,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(3,"d",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"e",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"f",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"g",true,Lists.newArrayList(new InnerStruct(100))));
  writer.addRow(new MyStruct(2,"h",true,Lists.newArrayList(new InnerStruct(100))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(8,reader.getNumberOfRows());
  assertEquals(8,stats[0].getNumberOfValues());
  assertEquals(3,((IntegerColumnStatistics)stats[1]).getMaximum());
  assertEquals(2,((IntegerColumnStatistics)stats[1]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[1]).isSumDefined());
  assertEquals(17,((IntegerColumnStatistics)stats[1]).getSum());
  assertEquals("count: 7 hasNull: true min: 2 max: 3 sum: 17",stats[1].toString());
  assertEquals("h",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals(7,stats[2].getNumberOfValues());
  assertEquals("count: 7 hasNull: true min: a max: h sum: 7",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<a:int,b:string,c:boolean,list:array<struct<z:int>>>",readerInspector.getTypeName());
  RecordReader rows=reader.rows();
  List<Boolean> expected=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    expected.add(false);
  }
  expected.set(expected.size() - 1,true);
  List<Boolean> got=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    OrcProto.StripeFooter sf=((RecordReaderImpl)rows).readStripeFooter(sinfo);
    got.add(sf.toString().indexOf(OrcProto.Stream.Kind.PRESENT.toString()) != -1);
  }
  assertEquals(expected,got);
  OrcStruct row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertEquals(new IntWritable(3),row.getFieldValue(0));
  assertEquals("a",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNull(row.getFieldValue(0));
  assertEquals("b",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNull(row.getFieldValue(1));
  assertEquals(new IntWritable(3),row.getFieldValue(0));
  assertEquals(new BooleanWritable(false),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiStripeWithoutNull() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcNullOptimization.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(100);
  for (int i=1; i < 20000; i++) {
    writer.addRow(new MyStruct(rand.nextInt(1),"a",true,Lists.newArrayList(new InnerStruct(100))));
  }
  writer.addRow(new MyStruct(0,"b",true,Lists.newArrayList(new InnerStruct(100))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(20000,reader.getNumberOfRows());
  assertEquals(20000,stats[0].getNumberOfValues());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMaximum());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[1]).isSumDefined());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getSum());
  assertEquals("count: 20000 hasNull: false min: 0 max: 0 sum: 0",stats[1].toString());
  assertEquals("b",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals(20000,stats[2].getNumberOfValues());
  assertEquals("count: 20000 hasNull: false min: a max: b sum: 20000",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<a:int,b:string,c:boolean,list:array<struct<z:int>>>",readerInspector.getTypeName());
  RecordReader rows=reader.rows();
  List<Boolean> expected=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    expected.add(false);
  }
  List<Boolean> got=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    OrcProto.StripeFooter sf=((RecordReaderImpl)rows).readStripeFooter(sinfo);
    got.add(sf.toString().indexOf(OrcProto.Stream.Kind.PRESENT.toString()) != -1);
  }
  assertEquals(expected,got);
  rows.seekToRow(19998);
  OrcStruct row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertNotNull(row.getFieldValue(1));
  assertEquals(new IntWritable(0),row.getFieldValue(0));
  assertEquals("a",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNotNull(row.getFieldValue(0));
  assertNotNull(row.getFieldValue(1));
  assertEquals("b",row.getFieldValue(1).toString());
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiStripeWithNull() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcNullOptimization.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(100);
  writer.addRow(new MyStruct(null,null,true,Lists.newArrayList(new InnerStruct(100))));
  for (int i=2; i < 20000; i++) {
    writer.addRow(new MyStruct(rand.nextInt(1),"a",true,Lists.newArrayList(new InnerStruct(100))));
  }
  writer.addRow(new MyStruct(null,null,true,Lists.newArrayList(new InnerStruct(100))));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(20000,reader.getNumberOfRows());
  assertEquals(20000,stats[0].getNumberOfValues());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMaximum());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[1]).isSumDefined());
  assertEquals(0,((IntegerColumnStatistics)stats[1]).getSum());
  assertEquals("count: 19998 hasNull: true min: 0 max: 0 sum: 0",stats[1].toString());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals("a",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals(19998,stats[2].getNumberOfValues());
  assertEquals("count: 19998 hasNull: true min: a max: a sum: 19998",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<a:int,b:string,c:boolean,list:array<struct<z:int>>>",readerInspector.getTypeName());
  RecordReader rows=reader.rows();
  List<Boolean> expected=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    expected.add(false);
  }
  expected.set(0,true);
  expected.set(expected.size() - 1,true);
  List<Boolean> got=Lists.newArrayList();
  for (  StripeInformation sinfo : reader.getStripes()) {
    OrcProto.StripeFooter sf=((RecordReaderImpl)rows).readStripeFooter(sinfo);
    got.add(sf.toString().indexOf(OrcProto.Stream.Kind.PRESENT.toString()) != -1);
  }
  assertEquals(expected,got);
  OrcStruct row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertNull(row.getFieldValue(0));
  assertNull(row.getFieldValue(1));
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.seekToRow(19998);
  row=(OrcStruct)rows.next(null);
  assertNotNull(row);
  assertNotNull(row.getFieldValue(1));
  assertEquals(new IntWritable(0),row.getFieldValue(0));
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  row=(OrcStruct)rows.next(row);
  assertNotNull(row);
  assertNull(row.getFieldValue(0));
  assertNull(row.getFieldValue(1));
  assertEquals(new BooleanWritable(true),row.getFieldValue(2));
  assertEquals(new IntWritable(100),((OrcStruct)((ArrayList<?>)row.getFieldValue(3)).get(0)).getFieldValue(0));
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcRawRecordMerger </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmpty() throws Exception {
  final int BUCKET=0;
  Configuration conf=new Configuration();
  OrcOutputFormat of=new OrcOutputFormat();
  FileSystem fs=FileSystem.getLocal(conf);
  Path root=new Path(tmpDir,"testEmpty").makeQualified(fs);
  fs.delete(root,true);
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).inspector(inspector).bucket(BUCKET).writingBase(true).maximumTransactionId(100).finalDestination(root);
  of.getRecordUpdater(root,options).close(false);
  ValidTxnList txnList=new ValidReadTxnList("200:");
  AcidUtils.Directory directory=AcidUtils.getAcidState(root,conf,txnList);
  Path basePath=AcidUtils.createBucketFile(directory.getBaseDirectory(),BUCKET);
  Reader baseReader=OrcFile.createReader(basePath,OrcFile.readerOptions(conf));
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,MyRow.getColumnNamesProperty());
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,MyRow.getColumnTypesProperty());
  HiveConf.setBoolVar(conf,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  OrcRawRecordMerger merger=new OrcRawRecordMerger(conf,true,baseReader,false,BUCKET,createMaximalTxnList(),new Reader.Options(),AcidUtils.getPaths(directory.getCurrentDirectories()));
  RecordIdentifier key=merger.createKey();
  OrcStruct value=merger.createValue();
  assertEquals(false,merger.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNewBase() throws Exception {
  Configuration conf=new Configuration();
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS,"col1");
  conf.set(IOConstants.SCHEMA_EVOLUTION_COLUMNS_TYPES,"string");
  HiveConf.setBoolVar(conf,HiveConf.ConfVars.HIVE_TRANSACTIONAL_TABLE_SCAN,true);
  Reader reader=Mockito.mock(Reader.class,settings);
  RecordReader recordReader=Mockito.mock(RecordReader.class,settings);
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  OrcProto.Type.Builder typeBuilder=OrcProto.Type.newBuilder();
  typeBuilder.setKind(OrcProto.Type.Kind.STRUCT).addSubtypes(1).addSubtypes(2).addSubtypes(3).addSubtypes(4).addSubtypes(5).addSubtypes(6);
  typeBuilder.addAllFieldNames(Lists.newArrayList("operation","originalTransaction","bucket","rowId","currentTransaction","row"));
  types.add(typeBuilder.build());
  types.add(null);
  types.add(null);
  types.add(null);
  types.add(null);
  types.add(null);
  typeBuilder.clearSubtypes();
  typeBuilder.addSubtypes(7);
  typeBuilder.addAllFieldNames(Lists.newArrayList("col1"));
  types.add(typeBuilder.build());
  typeBuilder.clear();
  typeBuilder.setKind(OrcProto.Type.Kind.STRING);
  types.add(typeBuilder.build());
  Mockito.when(reader.getTypes()).thenReturn(types);
  Mockito.when(reader.rowsOptions(Mockito.any(Reader.Options.class))).thenReturn(recordReader);
  OrcStruct row1=new OrcStruct(OrcRecordUpdater.FIELDS);
  setRow(row1,OrcRecordUpdater.INSERT_OPERATION,10,20,20,100,"first");
  OrcStruct row2=new OrcStruct(OrcRecordUpdater.FIELDS);
  setRow(row2,OrcRecordUpdater.INSERT_OPERATION,10,20,30,110,"second");
  OrcStruct row3=new OrcStruct(OrcRecordUpdater.FIELDS);
  setRow(row3,OrcRecordUpdater.INSERT_OPERATION,10,20,40,120,"third");
  OrcStruct row4=new OrcStruct(OrcRecordUpdater.FIELDS);
  setRow(row4,OrcRecordUpdater.INSERT_OPERATION,40,50,60,130,"fourth");
  OrcStruct row5=new OrcStruct(OrcRecordUpdater.FIELDS);
  setRow(row5,OrcRecordUpdater.INSERT_OPERATION,40,50,61,140,"fifth");
  Mockito.when(recordReader.hasNext()).thenReturn(true,true,true,true,true,false);
  Mockito.when(recordReader.getProgress()).thenReturn(1.0f);
  Mockito.when(recordReader.next(null)).thenReturn(row1,row4);
  Mockito.when(recordReader.next(row1)).thenReturn(row2);
  Mockito.when(recordReader.next(row2)).thenReturn(row3);
  Mockito.when(recordReader.next(row3)).thenReturn(row5);
  Mockito.when(reader.getMetadataValue(OrcRecordUpdater.ACID_KEY_INDEX_NAME)).thenReturn(ByteBuffer.wrap("10,20,30;40,50,60;40,50,61".getBytes("UTF-8")));
  Mockito.when(reader.getStripes()).thenReturn(createStripes(2,2,1));
  OrcRawRecordMerger merger=new OrcRawRecordMerger(conf,false,reader,false,10,createMaximalTxnList(),new Reader.Options().range(1000,1000),null);
  RecordReader rr=merger.getCurrentReader().recordReader;
  assertEquals(0,merger.getOtherReaders().size());
  assertEquals(new RecordIdentifier(10,20,30),merger.getMinKey());
  assertEquals(new RecordIdentifier(40,50,60),merger.getMaxKey());
  RecordIdentifier id=merger.createKey();
  OrcStruct event=merger.createValue();
  assertEquals(true,merger.next(id,event));
  assertEquals(10,id.getTransactionId());
  assertEquals(20,id.getBucketId());
  assertEquals(40,id.getRowId());
  assertEquals("third",getValue(event));
  assertEquals(true,merger.next(id,event));
  assertEquals(40,id.getTransactionId());
  assertEquals(50,id.getBucketId());
  assertEquals(60,id.getRowId());
  assertEquals("fourth",getValue(event));
  assertEquals(false,merger.next(id,event));
  assertEquals(1.0,merger.getProgress(),0.01);
  merger.close();
  Mockito.verify(rr).close();
  Mockito.verify(rr).getProgress();
  StructObjectInspector eventObjectInspector=(StructObjectInspector)merger.getObjectInspector();
  List<? extends StructField> fields=eventObjectInspector.getAllStructFieldRefs();
  assertEquals(OrcRecordUpdater.FIELDS,fields.size());
  assertEquals("operation",fields.get(OrcRecordUpdater.OPERATION).getFieldName());
  assertEquals("currentTransaction",fields.get(OrcRecordUpdater.CURRENT_TRANSACTION).getFieldName());
  assertEquals("originalTransaction",fields.get(OrcRecordUpdater.ORIGINAL_TRANSACTION).getFieldName());
  assertEquals("bucket",fields.get(OrcRecordUpdater.BUCKET).getFieldName());
  assertEquals("rowId",fields.get(OrcRecordUpdater.ROW_ID).getFieldName());
  StructObjectInspector rowObjectInspector=(StructObjectInspector)fields.get(OrcRecordUpdater.ROW).getFieldObjectInspector();
  assertEquals("col1",rowObjectInspector.getAllStructFieldRefs().get(0).getFieldName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcRecordUpdater </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdates() throws Exception {
  Path root=new Path(workDir,"testUpdates");
  Configuration conf=new Configuration();
  FileSystem fs=root.getFileSystem(conf);
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  int bucket=20;
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).filesystem(fs).bucket(bucket).writingBase(false).minimumTransactionId(100).maximumTransactionId(100).inspector(inspector).reporter(Reporter.NULL).recordIdColumn(1).finalDestination(root);
  RecordUpdater updater=new OrcRecordUpdater(root,options);
  updater.update(100,new MyRow("update",30,10,bucket));
  updater.delete(100,new MyRow("",60,40,bucket));
  assertEquals(-1L,updater.getStats().getRowCount());
  updater.close(false);
  Path bucketPath=AcidUtils.createFilename(root,options);
  Reader reader=OrcFile.createReader(bucketPath,new OrcFile.ReaderOptions(conf).filesystem(fs));
  assertEquals(2,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  assertEquals(true,rows.hasNext());
  OrcStruct row=(OrcStruct)rows.next(null);
  assertEquals(OrcRecordUpdater.UPDATE_OPERATION,OrcRecordUpdater.getOperation(row));
  assertEquals(100,OrcRecordUpdater.getCurrentTransaction(row));
  assertEquals(10,OrcRecordUpdater.getOriginalTransaction(row));
  assertEquals(20,OrcRecordUpdater.getBucket(row));
  assertEquals(30,OrcRecordUpdater.getRowId(row));
  assertEquals("update",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(100,OrcRecordUpdater.getCurrentTransaction(row));
  assertEquals(40,OrcRecordUpdater.getOriginalTransaction(row));
  assertEquals(20,OrcRecordUpdater.getBucket(row));
  assertEquals(60,OrcRecordUpdater.getRowId(row));
  assertNull(OrcRecordUpdater.getRow(row));
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriter() throws Exception {
  Path root=new Path(workDir,"testWriter");
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf).getRaw();
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).filesystem(fs).bucket(10).writingBase(false).minimumTransactionId(10).maximumTransactionId(19).inspector(inspector).reporter(Reporter.NULL).finalDestination(root);
  RecordUpdater updater=new OrcRecordUpdater(root,options);
  updater.insert(11,new MyRow("first"));
  updater.insert(11,new MyRow("second"));
  updater.insert(11,new MyRow("third"));
  updater.flush();
  updater.insert(12,new MyRow("fourth"));
  updater.insert(12,new MyRow("fifth"));
  updater.flush();
  assertEquals(5L,updater.getStats().getRowCount());
  Path bucketPath=AcidUtils.createFilename(root,options);
  Path sidePath=OrcRecordUpdater.getSideFile(bucketPath);
  DataInputStream side=fs.open(sidePath);
  long len=side.readLong();
  Reader reader=OrcFile.createReader(bucketPath,new OrcFile.ReaderOptions(conf).filesystem(fs).maxLength(len));
  assertEquals(3,reader.getNumberOfRows());
  len=side.readLong();
  side.close();
  reader=OrcFile.createReader(bucketPath,new OrcFile.ReaderOptions(conf).filesystem(fs).maxLength(len));
  assertEquals(5,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  assertEquals(true,rows.hasNext());
  OrcStruct row=(OrcStruct)rows.next(null);
  assertEquals(OrcRecordUpdater.INSERT_OPERATION,OrcRecordUpdater.getOperation(row));
  assertEquals(11,OrcRecordUpdater.getCurrentTransaction(row));
  assertEquals(11,OrcRecordUpdater.getOriginalTransaction(row));
  assertEquals(10,OrcRecordUpdater.getBucket(row));
  assertEquals(0,OrcRecordUpdater.getRowId(row));
  assertEquals("first",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(1,OrcRecordUpdater.getRowId(row));
  assertEquals(10,OrcRecordUpdater.getBucket(row));
  assertEquals("second",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(2,OrcRecordUpdater.getRowId(row));
  assertEquals(10,OrcRecordUpdater.getBucket(row));
  assertEquals("third",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(12,OrcRecordUpdater.getCurrentTransaction(row));
  assertEquals(12,OrcRecordUpdater.getOriginalTransaction(row));
  assertEquals(10,OrcRecordUpdater.getBucket(row));
  assertEquals(0,OrcRecordUpdater.getRowId(row));
  assertEquals("fourth",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(true,rows.hasNext());
  row=(OrcStruct)rows.next(null);
  assertEquals(1,OrcRecordUpdater.getRowId(row));
  assertEquals("fifth",OrcRecordUpdater.getRow(row).getFieldValue(0).toString());
  assertEquals(false,rows.hasNext());
  updater.insert(20,new MyRow("sixth"));
  updater.close(false);
  reader=OrcFile.createReader(bucketPath,new OrcFile.ReaderOptions(conf).filesystem(fs));
  assertEquals(6,reader.getNumberOfRows());
  assertEquals(6L,updater.getStats().getRowCount());
  assertEquals(false,fs.exists(sidePath));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWriterTblProperties() throws Exception {
  Path root=new Path(workDir,"testWriterTblProperties");
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf).getRaw();
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MyRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Properties tblProps=new Properties();
  tblProps.setProperty("orc.compress","SNAPPY");
  AcidOutputFormat.Options options=new AcidOutputFormat.Options(conf).filesystem(fs).bucket(10).writingBase(false).minimumTransactionId(10).maximumTransactionId(19).inspector(inspector).reporter(Reporter.NULL).finalDestination(root).tableProperties(tblProps);
  RecordUpdater updater=new OrcRecordUpdater(root,options);
  updater.insert(11,new MyRow("first"));
  updater.insert(11,new MyRow("second"));
  updater.insert(11,new MyRow("third"));
  updater.flush();
  updater.insert(12,new MyRow("fourth"));
  updater.insert(12,new MyRow("fifth"));
  updater.flush();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{root.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Compression: SNAPPY"));
  System.setOut(origOut);
  updater.close(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcSerDeStats </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrcSerDeStatsMap() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(MapStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(10000).bufferSize(10000));
  for (int row=0; row < 1000; row++) {
    Map<String,Double> test=new HashMap<String,Double>();
    for (int i=0; i < 10; i++) {
      test.put("hi" + i,2.0);
    }
    writer.addRow(new MapStruct(test));
  }
  writer.close();
  assertEquals(1000,writer.getNumberOfRows());
  assertEquals(950000,writer.getRawDataSize());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(1000,reader.getNumberOfRows());
  assertEquals(950000,reader.getRawDataSize());
  assertEquals(950000,reader.getRawDataSizeOfColumns(Lists.newArrayList("map1")));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrcSerDeStatsComplex() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new BigRow(false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map(),Timestamp.valueOf("2000-03-12 15:00:00"),HiveDecimal.create("12345678.6547456")));
  writer.addRow(new BigRow(true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib")),Timestamp.valueOf("2000-03-11 15:00:00"),HiveDecimal.create("12345678.6547452")));
  writer.close();
  long rowCount=writer.getNumberOfRows();
  long rawDataSize=writer.getRawDataSize();
  assertEquals(2,rowCount);
  assertEquals(1740,rawDataSize);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(2,reader.getNumberOfRows());
  assertEquals(1740,reader.getRawDataSize());
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("boolean1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("byte1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("short1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("int1")));
  assertEquals(16,reader.getRawDataSizeOfColumns(Lists.newArrayList("long1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("float1")));
  assertEquals(16,reader.getRawDataSizeOfColumns(Lists.newArrayList("double1")));
  assertEquals(5,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1")));
  assertEquals(172,reader.getRawDataSizeOfColumns(Lists.newArrayList("string1")));
  assertEquals(455,reader.getRawDataSizeOfColumns(Lists.newArrayList("list")));
  assertEquals(368,reader.getRawDataSizeOfColumns(Lists.newArrayList("map")));
  assertEquals(364,reader.getRawDataSizeOfColumns(Lists.newArrayList("middle")));
  assertEquals(80,reader.getRawDataSizeOfColumns(Lists.newArrayList("ts")));
  assertEquals(224,reader.getRawDataSizeOfColumns(Lists.newArrayList("decimal1")));
  assertEquals(88,reader.getRawDataSizeOfColumns(Lists.newArrayList("ts","int1")));
  assertEquals(1195,reader.getRawDataSizeOfColumns(Lists.newArrayList("middle","list","map","float1")));
  assertEquals(185,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1","byte1","string1")));
  assertEquals(rawDataSize,reader.getRawDataSizeOfColumns(Lists.newArrayList("boolean1","byte1","short1","int1","long1","float1","double1","bytes1","string1","list","map","middle","ts","decimal1")));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 2 hasNull: false min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=ClassCastException.class) public void testSerdeStatsOldFormat() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(6300000,reader.getRawDataSize());
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("bye",((StringColumnStatistics)stats[9]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[9]).getMaximum());
  assertEquals(0,((StringColumnStatistics)stats[9]).getSum());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  assertEquals("count: 7500 hasNull: true",stats[8].toString());
  assertEquals(5,((BinaryColumnStatistics)stats[8]).getSum());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringAndBinaryStatistics() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(SimpleStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4),"foo"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3),"bar"));
  writer.addRow(new SimpleStruct(bytes(0,1,2,3,4,5),null));
  writer.addRow(new SimpleStruct(null,"hi"));
  writer.close();
  assertEquals(4,writer.getNumberOfRows());
  assertEquals(273,writer.getRawDataSize());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(4,reader.getNumberOfRows());
  assertEquals(273,reader.getRawDataSize());
  assertEquals(15,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1")));
  assertEquals(258,reader.getRawDataSizeOfColumns(Lists.newArrayList("string1")));
  assertEquals(273,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1","string1")));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4,stats[0].getNumberOfValues());
  assertEquals("count: 4 hasNull: false",stats[0].toString());
  assertEquals(3,stats[1].getNumberOfValues());
  assertEquals(15,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals("count: 3 hasNull: true sum: 15",stats[1].toString());
  assertEquals(3,stats[2].getNumberOfValues());
  assertEquals("bar",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals(8,((StringColumnStatistics)stats[2]).getSum());
  assertEquals("count: 3 hasNull: true min: bar max: hi sum: 8",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<bytes1:binary,string1:string>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("foo",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("bar",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3,4,5),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertNull(st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertNull(bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrcSerDeStatsSimpleWithNulls() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(SimpleStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(10000).bufferSize(10000));
  for (int row=0; row < 1000; row++) {
    if (row % 2 == 0) {
      writer.addRow(new SimpleStruct(new BytesWritable(new byte[]{1,2,3}),"hi"));
    }
 else {
      writer.addRow(null);
    }
  }
  writer.close();
  assertEquals(1000,writer.getNumberOfRows());
  assertEquals(44500,writer.getRawDataSize());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(1000,reader.getNumberOfRows());
  assertEquals(44500,reader.getRawDataSize());
  assertEquals(1500,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1")));
  assertEquals(43000,reader.getRawDataSizeOfColumns(Lists.newArrayList("string1")));
  assertEquals(44500,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1","string1")));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrcSerDeStatsList() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(ListStruct.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(10000).bufferSize(10000));
  for (int row=0; row < 5000; row++) {
    List<String> test=new ArrayList<String>();
    for (int i=0; i < 1000; i++) {
      test.add("hi");
    }
    writer.addRow(new ListStruct(test));
  }
  writer.close();
  assertEquals(5000,writer.getNumberOfRows());
  assertEquals(430000000,writer.getRawDataSize());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(5000,reader.getNumberOfRows());
  assertEquals(430000000,reader.getRawDataSize());
  assertEquals(430000000,reader.getRawDataSizeOfColumns(Lists.newArrayList("list1")));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOrcSerDeStatsComplexOldFormat() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcSerDeStats.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(BigRow.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).version(OrcFile.Version.V_0_11).bufferSize(10000));
  writer.addRow(new BigRow(false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map(),Timestamp.valueOf("2000-03-12 15:00:00"),HiveDecimal.create("12345678.6547456")));
  writer.addRow(new BigRow(true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib")),Timestamp.valueOf("2000-03-11 15:00:00"),HiveDecimal.create("12345678.6547452")));
  writer.close();
  long rowCount=writer.getNumberOfRows();
  long rawDataSize=writer.getRawDataSize();
  assertEquals(2,rowCount);
  assertEquals(1740,rawDataSize);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(2,reader.getNumberOfRows());
  assertEquals(1740,reader.getRawDataSize());
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("boolean1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("byte1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("short1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("int1")));
  assertEquals(16,reader.getRawDataSizeOfColumns(Lists.newArrayList("long1")));
  assertEquals(8,reader.getRawDataSizeOfColumns(Lists.newArrayList("float1")));
  assertEquals(16,reader.getRawDataSizeOfColumns(Lists.newArrayList("double1")));
  assertEquals(5,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1")));
  assertEquals(172,reader.getRawDataSizeOfColumns(Lists.newArrayList("string1")));
  assertEquals(455,reader.getRawDataSizeOfColumns(Lists.newArrayList("list")));
  assertEquals(368,reader.getRawDataSizeOfColumns(Lists.newArrayList("map")));
  assertEquals(364,reader.getRawDataSizeOfColumns(Lists.newArrayList("middle")));
  assertEquals(80,reader.getRawDataSizeOfColumns(Lists.newArrayList("ts")));
  assertEquals(224,reader.getRawDataSizeOfColumns(Lists.newArrayList("decimal1")));
  assertEquals(88,reader.getRawDataSizeOfColumns(Lists.newArrayList("ts","int1")));
  assertEquals(1195,reader.getRawDataSizeOfColumns(Lists.newArrayList("middle","list","map","float1")));
  assertEquals(185,reader.getRawDataSizeOfColumns(Lists.newArrayList("bytes1","byte1","string1")));
  assertEquals(rawDataSize,reader.getRawDataSizeOfColumns(Lists.newArrayList("boolean1","byte1","short1","int1","long1","float1","double1","bytes1","string1","list","map","middle","ts","decimal1")));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 2 hasNull: false min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals(5,((BinaryColumnStatistics)stats[8]).getSum());
  assertEquals("count: 2 hasNull: false sum: 5",stats[8].toString());
  assertEquals("bye",((StringColumnStatistics)stats[9]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[9]).getMaximum());
  assertEquals(5,((StringColumnStatistics)stats[9]).getSum());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcStruct </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInspectorFromTypeInfo() throws Exception {
  TypeInfo typeInfo=TypeInfoUtils.getTypeInfoFromTypeString("struct<c1:boolean,c2:tinyint" + ",c3:smallint,c4:int,c5:bigint,c6:float,c7:double,c8:binary," + "c9:string,c10:struct<c1:int>,c11:map<int,int>,c12:uniontype<int>"+ ",c13:array<timestamp>>");
  StructObjectInspector inspector=(StructObjectInspector)OrcStruct.createObjectInspector(typeInfo);
  assertEquals("struct<c1:boolean,c2:tinyint,c3:smallint,c4:int,c5:" + "bigint,c6:float,c7:double,c8:binary,c9:string,c10:struct<" + "c1:int>,c11:map<int,int>,c12:uniontype<int>,c13:array<timestamp>>",inspector.getTypeName());
  assertEquals(null,inspector.getAllStructFieldRefs().get(0).getFieldComment());
  assertEquals(null,inspector.getStructFieldRef("UNKNOWN"));
  OrcStruct s1=new OrcStruct(13);
  for (int i=0; i < 13; ++i) {
    s1.setFieldValue(i,i);
  }
  List list=new ArrayList();
  list.addAll(Arrays.asList(0,1,2,3,4,5,6,7,8,9,10,11,12));
  assertEquals(list,inspector.getStructFieldsDataAsList(s1));
  ListObjectInspector listOI=(ListObjectInspector)inspector.getAllStructFieldRefs().get(12).getFieldObjectInspector();
  assertEquals(ObjectInspector.Category.LIST,listOI.getCategory());
  assertEquals(10,listOI.getListElement(list,10));
  assertEquals(null,listOI.getListElement(list,-1));
  assertEquals(null,listOI.getListElement(list,13));
  assertEquals(13,listOI.getListLength(list));
  Map<Integer,Integer> map=new HashMap<Integer,Integer>();
  map.put(1,2);
  map.put(2,4);
  map.put(3,6);
  MapObjectInspector mapOI=(MapObjectInspector)inspector.getAllStructFieldRefs().get(10).getFieldObjectInspector();
  assertEquals(3,mapOI.getMapSize(map));
  assertEquals(4,mapOI.getMapValueElement(map,2));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcTimezone1 </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampWriter() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  TimeZone.setDefault(TimeZone.getTimeZone(writerTimeZone));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  assertEquals(writerTimeZone,TimeZone.getDefault().getID());
  List<String> ts=Lists.newArrayList();
  ts.add("2003-01-01 01:00:00.000000222");
  ts.add("1996-08-02 09:00:00.723100809");
  ts.add("1999-01-01 02:00:00.999999999");
  ts.add("1995-01-02 03:00:00.688888888");
  ts.add("2002-01-01 04:00:00.1");
  ts.add("2010-03-02 05:00:00.000009001");
  ts.add("2005-01-01 06:00:00.000002229");
  ts.add("2006-01-01 07:00:00.900203003");
  ts.add("2003-01-01 08:00:00.800000007");
  ts.add("1998-11-02 10:00:00.857340643");
  ts.add("2008-10-02 11:00:00.0");
  ts.add("2037-01-01 00:00:00.000999");
  ts.add("2014-03-28 00:00:00.0");
  for (  String t : ts) {
    writer.addRow(Timestamp.valueOf(t));
  }
  writer.close();
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(readerTimeZone,TimeZone.getDefault().getID());
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    Timestamp got=((TimestampWritable)row).getTimestamp();
    assertEquals(ts.get(idx++),got.toString());
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadTimestampFormat_0_11() throws Exception {
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestOrcTimezone2 </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampWriter() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  TimeZone.setDefault(TimeZone.getTimeZone(writerTimeZone));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).bufferSize(10000));
  assertEquals(writerTimeZone,TimeZone.getDefault().getID());
  List<String> ts=Lists.newArrayList();
  ts.add("2003-01-01 01:00:00.000000222");
  ts.add("1999-01-01 02:00:00.999999999");
  ts.add("1995-01-02 03:00:00.688888888");
  ts.add("2002-01-01 04:00:00.1");
  ts.add("2010-03-02 05:00:00.000009001");
  ts.add("2005-01-01 06:00:00.000002229");
  ts.add("2006-01-01 07:00:00.900203003");
  ts.add("2003-01-01 08:00:00.800000007");
  ts.add("1996-08-02 09:00:00.723100809");
  ts.add("1998-11-02 10:00:00.857340643");
  ts.add("2008-10-02 11:00:00.0");
  ts.add("2037-01-01 00:00:00.000999");
  for (  String t : ts) {
    writer.addRow(Timestamp.valueOf(t));
  }
  writer.close();
  TimeZone.setDefault(TimeZone.getTimeZone(readerTimeZone));
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(readerTimeZone,TimeZone.getDefault().getID());
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    Timestamp got=((TimestampWritable)row).getTimestamp();
    assertEquals(ts.get(idx++),got.toString());
  }
  rows.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestRLEv2 </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFixedDeltaLarge() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  for (int i=0; i < 5120; ++i) {
    w.addRow(i % 512 + ((i % 512) * 100));
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 50"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeltaUnknownSign() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  w.addRow(0);
  for (int i=0; i < 511; ++i) {
    w.addRow(i);
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 642"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFixedDeltaOne() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  for (int i=0; i < 5120; ++i) {
    w.addRow(i % 512);
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 40"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFixedDeltaOneDescending() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  for (int i=0; i < 5120; ++i) {
    w.addRow(512 - (i % 512));
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 50"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFixedDeltaLargeDescending() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  for (int i=0; i < 5120; ++i) {
    w.addRow((512 - i % 512) + ((i % 512) * 100));
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 60"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShortRepeat() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  for (int i=0; i < 5; ++i) {
    w.addRow(10);
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 2"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFixedDeltaZero() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  for (int i=0; i < 5120; ++i) {
    w.addRow(123);
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 50"));
  System.setOut(origOut);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPatchedBase() throws Exception {
  ObjectInspector inspector=ObjectInspectorFactory.getReflectionObjectInspector(Integer.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  Writer w=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).compress(CompressionKind.NONE).inspector(inspector).rowIndexStride(0).encodingStrategy(OrcFile.EncodingStrategy.COMPRESSION).version(OrcFile.Version.V_0_12));
  Random rand=new Random(123);
  w.addRow(10000000);
  for (int i=0; i < 511; ++i) {
    w.addRow(rand.nextInt(i + 1));
  }
  w.close();
  PrintStream origOut=System.out;
  ByteArrayOutputStream myOut=new ByteArrayOutputStream();
  System.setOut(new PrintStream(myOut));
  FileDump.main(new String[]{testFilePath.toUri().toString()});
  System.out.flush();
  String outDump=new String(myOut.toByteArray());
  assertEquals(true,outDump.contains("Stream: column 0 section DATA start: 3 length 583"));
  System.setOut(origOut);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestRecordReaderImpl </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullsInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add(new HiveDecimalWritable("15"));
  args.add(null);
  args.add(new HiveDecimalWritable("19"));
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.DECIMAL,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addString(HiveDecimal.create(i).toString());
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createDecimalStats("10","200",false));
  assertEquals(TruthValue.NO,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  cs=ColumnStatisticsImpl.deserialize(createDecimalStats("10","200",true));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addString(HiveDecimal.create(19).toString());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addString(HiveDecimal.create(15).toString());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBetweenWithNullInStats() throws Exception {
  List args=new ArrayList();
  args.add("c");
  args.add("f");
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.BETWEEN,PredicateLeaf.Type.STRING,"x",null,args);
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("d","e",true),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("e","f",true),pred,null));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("h","g",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("f","g",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("e","g",true),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("c","e",true),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("c","f",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("c","g",true),pred,null));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("a","b",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("a","c",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("b","d",true),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("c","c",true),pred,null));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add("str_15");
  args.add("str_19");
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.STRING,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addString("str_" + i);
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createStringStats("str_10","str_200"));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addString("str_19");
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addString("str_15");
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIn() throws Exception {
  List args=new ArrayList();
  args.add(10L);
  args.add(20L);
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.LONG,"x",null,args);
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(20L,20L),pred,null));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(30L,30L),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(10L,30L),pred,null));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(12L,18L),pred,null));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add(15L);
  args.add(19L);
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.LONG,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addLong(i);
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createIntStats(10,100));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addLong(19);
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addLong(15);
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDateWritableInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add(new DateWritable(15).get());
  args.add(new DateWritable(19).get());
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.DATE,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addLong((new DateWritable(i)).getDays());
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createDateStats(10,100));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addLong((new DateWritable(19)).getDays());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addLong((new DateWritable(15)).getDays());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInWithNullInStats() throws Exception {
  List args=new ArrayList();
  args.add("c");
  args.add("f");
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.STRING,"x",null,args);
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("d","e",true),pred,null));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("a","b",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("e","f",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("c","d",true),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("b","d",true),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createStringStats("c","c",true),pred,null));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimalInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add(new HiveDecimalWritable("15"));
  args.add(new HiveDecimalWritable("19"));
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.DECIMAL,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addString(HiveDecimal.create(i).toString());
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createDecimalStats("10","200"));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addString(HiveDecimal.create(19).toString());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addString(HiveDecimal.create(15).toString());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add(15.0);
  args.add(19.0);
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.FLOAT,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addDouble(i);
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createDoubleStats(10.0,100.0));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addDouble(19.0);
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addDouble(15.0);
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<pre class="type-11 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testPartialPlanCompressed() throws Exception {
  DiskRangeList result;
  List<OrcProto.Stream> streams=new ArrayList<OrcProto.Stream>();
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(1).setLength(1000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(1).setLength(99000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(2).setLength(2000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(2).setLength(98000).build());
  boolean[] columns=new boolean[]{true,true,false};
  boolean[] rowGroups=new boolean[]{true,true,false,false,true,false};
  OrcProto.RowIndex[] indexes=new OrcProto.RowIndex[columns.length];
  indexes[1]=OrcProto.RowIndex.newBuilder().addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(0).addPositions(-1).addPositions(-1).addPositions(-1).addPositions(0).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(100).addPositions(-1).addPositions(-1).addPositions(-1).addPositions(10000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(200).addPositions(-1).addPositions(-1).addPositions(-1).addPositions(20000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(300).addPositions(-1).addPositions(-1).addPositions(-1).addPositions(30000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(400).addPositions(-1).addPositions(-1).addPositions(-1).addPositions(40000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(500).addPositions(-1).addPositions(-1).addPositions(-1).addPositions(50000).build()).build();
  List<OrcProto.ColumnEncoding> encodings=new ArrayList<OrcProto.ColumnEncoding>();
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addSubtypes(1).addSubtypes(2).addFieldNames("x").addFieldNames("y").build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,true,encodings,types,32768,false);
  assertThat(result,is(diskRanges(0,1000,100,1000,400,1000,1000,11000 + (2 * 32771),11000,21000 + (2 * 32771),41000,100000)));
  rowGroups=new boolean[]{false,false,false,false,false,true};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,true,encodings,types,32768,false);
  assertThat(result,is(diskRanges(500,1000,51000,100000)));
}

</code></pre>

<br>
<pre class="type-11 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testPartialPlanString() throws Exception {
  DiskRangeList result;
  List<OrcProto.Stream> streams=new ArrayList<OrcProto.Stream>();
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(1).setLength(1000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(1).setLength(94000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.LENGTH).setColumn(1).setLength(2000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DICTIONARY_DATA).setColumn(1).setLength(3000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(2).setLength(2000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(2).setLength(98000).build());
  boolean[] columns=new boolean[]{true,true,false};
  boolean[] rowGroups=new boolean[]{false,true,false,false,true,true};
  OrcProto.RowIndex[] indexes=new OrcProto.RowIndex[columns.length];
  indexes[1]=OrcProto.RowIndex.newBuilder().addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(0).addPositions(-1).addPositions(-1).addPositions(0).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(100).addPositions(-1).addPositions(-1).addPositions(10000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(200).addPositions(-1).addPositions(-1).addPositions(20000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(300).addPositions(-1).addPositions(-1).addPositions(30000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(400).addPositions(-1).addPositions(-1).addPositions(40000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(500).addPositions(-1).addPositions(-1).addPositions(50000).build()).build();
  List<OrcProto.ColumnEncoding> encodings=new ArrayList<OrcProto.ColumnEncoding>();
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DICTIONARY).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addSubtypes(1).addSubtypes(2).addFieldNames("x").addFieldNames("y").build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRING).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(100,1000,400,1000,500,1000,11000,21000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,41000,51000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,51000,95000,95000,97000,97000,100000)));
}

</code></pre>

<br>
<pre class="type-11 type-8 type-20 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialPlan() throws Exception {
  DiskRangeList result;
  List<OrcProto.Stream> streams=new ArrayList<OrcProto.Stream>();
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(1).setLength(1000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(1).setLength(99000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.PRESENT).setColumn(2).setLength(2000).build());
  streams.add(OrcProto.Stream.newBuilder().setKind(OrcProto.Stream.Kind.DATA).setColumn(2).setLength(98000).build());
  boolean[] columns=new boolean[]{true,true,false};
  boolean[] rowGroups=new boolean[]{true,true,false,false,true,false};
  OrcProto.RowIndex[] indexes=new OrcProto.RowIndex[columns.length];
  indexes[1]=OrcProto.RowIndex.newBuilder().addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(0).addPositions(-1).addPositions(-1).addPositions(0).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(100).addPositions(-1).addPositions(-1).addPositions(10000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(200).addPositions(-1).addPositions(-1).addPositions(20000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(300).addPositions(-1).addPositions(-1).addPositions(30000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(400).addPositions(-1).addPositions(-1).addPositions(40000).build()).addEntry(OrcProto.RowIndexEntry.newBuilder().addPositions(500).addPositions(-1).addPositions(-1).addPositions(50000).build()).build();
  List<OrcProto.ColumnEncoding> encodings=new ArrayList<OrcProto.ColumnEncoding>();
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  encodings.add(OrcProto.ColumnEncoding.newBuilder().setKind(OrcProto.ColumnEncoding.Kind.DIRECT).build());
  List<OrcProto.Type> types=new ArrayList<OrcProto.Type>();
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.STRUCT).addSubtypes(1).addSubtypes(2).addFieldNames("x").addFieldNames("y").build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  types.add(OrcProto.Type.newBuilder().setKind(OrcProto.Type.Kind.INT).build());
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(0,1000,100,1000,400,1000,1000,11000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,11000,21000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,41000,51000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(0,21000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP,41000,51000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  rowGroups=new boolean[]{false,false,false,false,false,false};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertNull(result);
  rowGroups=null;
  columns=new boolean[]{true,false,true};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,null,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(100000,102000,102000,200000)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,null,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(100000,200000)));
  rowGroups=new boolean[]{false,true,false,false,false,false};
  indexes[2]=indexes[1];
  indexes[1]=null;
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(100100,102000,112000,122000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(100100,102000,112000,122000 + RecordReaderUtils.WORST_UNCOMPRESSED_SLOP)));
  rowGroups=new boolean[]{false,false,false,false,false,true};
  indexes[1]=indexes[2];
  columns=new boolean[]{true,true,true};
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,false);
  assertThat(result,is(diskRanges(500,1000,51000,100000,100500,102000,152000,200000)));
  result=RecordReaderImpl.planReadPartialDataStreams(streams,indexes,columns,rowGroups,false,encodings,types,32768,true);
  assertThat(result,is(diskRanges(500,1000,51000,100000,100500,102000,152000,200000)));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBetween() throws Exception {
  List args=new ArrayList();
  args.add(10L);
  args.add(20L);
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.BETWEEN,PredicateLeaf.Type.LONG,"x",null,args);
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(0L,5L),pred,null));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(30L,40L),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(5L,15L),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(15L,25L),pred,null));
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(5L,25L),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(10L,20L),pred,null));
  assertEquals(TruthValue.YES_NULL,RecordReaderImpl.evaluatePredicateProto(createIntStats(12L,18L),pred,null));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestampInBloomFilter() throws Exception {
  List args=new ArrayList();
  args.add(new Timestamp(15));
  args.add(new Timestamp(19));
  PredicateLeaf pred=TestSearchArgumentImpl.createPredicateLeaf(PredicateLeaf.Operator.IN,PredicateLeaf.Type.TIMESTAMP,"x",null,args);
  BloomFilterIO bf=new BloomFilterIO(10000);
  for (int i=20; i < 1000; i++) {
    bf.addLong((new Timestamp(i)).getTime());
  }
  ColumnStatistics cs=ColumnStatisticsImpl.deserialize(createTimestampStats(10,100));
  assertEquals(TruthValue.NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addLong((new Timestamp(19)).getTime());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
  bf.addLong((new Timestamp(15)).getTime());
  assertEquals(TruthValue.YES_NO_NULL,RecordReaderImpl.evaluatePredicate(cs,pred,bf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestStringDictionary </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHalfDistinct() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(123);
  int[] input=new int[20000];
  for (int i=0; i < 20000; i++) {
    input[i]=rand.nextInt(10000);
  }
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(input[i])));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(input[idx++])),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DICTIONARY_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHalfDistinctCheckDisabled() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  conf.setBoolean(ConfVars.HIVE_ORC_ROW_INDEX_STRIDE_DICTIONARY_CHECK.varname,false);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  Random rand=new Random(123);
  int[] input=new int[20000];
  for (int i=0; i < 20000; i++) {
    input[i]=rand.nextInt(10000);
  }
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(input[i])));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(input[idx++])),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DICTIONARY_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooManyDistinctV11AlwaysDictionary() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).version(OrcFile.Version.V_0_11).bufferSize(10000));
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(idx++)),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DICTIONARY,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooManyDistinct() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(idx++)),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DIRECT_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTooManyDistinctCheckDisabled() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Text.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  conf.setBoolean(ConfVars.HIVE_ORC_ROW_INDEX_STRIDE_DICTIONARY_CHECK.varname,false);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).compress(CompressionKind.NONE).bufferSize(10000));
  for (int i=0; i < 20000; i++) {
    writer.addRow(new Text(String.valueOf(i)));
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(new Text(String.valueOf(idx++)),row);
  }
  for (  StripeInformation stripe : reader.getStripes()) {
    OrcProto.StripeFooter footer=((RecordReaderImpl)rows).readStripeFooter(stripe);
    for (int i=0; i < footer.getColumnsCount(); ++i) {
      OrcProto.ColumnEncoding encoding=footer.getColumns(i);
      assertEquals(OrcProto.ColumnEncoding.Kind.DIRECT_V2,encoding.getKind());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestUnrolledBitPack </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBitPacking() throws Exception {
  ObjectInspector inspector;
synchronized (TestOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Long.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  long[] inp=new long[]{val,0,val,val,0,val,0,val,val,0,val,0,val,val,0,0,val,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,val,0,0,val,0,val,0,0,val,val};
  List<Long> input=Lists.newArrayList(Longs.asList(inp));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).inspector(inspector).stripeSize(100000).compress(CompressionKind.NONE).bufferSize(10000));
  for (  Long l : input) {
    writer.addRow(l);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(input.get(idx++).longValue(),((LongWritable)row).get());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.orc.TestVectorOrcFile </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeek() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(200000).bufferSize(65536).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random rand=new Random(42);
  final int COUNT=32768;
  long[] intValues=new long[COUNT];
  double[] doubleValues=new double[COUNT];
  String[] stringValues=new String[COUNT];
  BytesWritable[] byteValues=new BytesWritable[COUNT];
  String[] words=new String[128];
  for (int i=0; i < words.length; ++i) {
    words[i]=Integer.toHexString(rand.nextInt());
  }
  for (int i=0; i < COUNT / 2; ++i) {
    intValues[2 * i]=rand.nextLong();
    intValues[2 * i + 1]=intValues[2 * i];
    stringValues[2 * i]=words[rand.nextInt(words.length)];
    stringValues[2 * i + 1]=stringValues[2 * i];
  }
  for (int i=0; i < COUNT; ++i) {
    doubleValues[i]=rand.nextDouble();
    byte[] buf=new byte[20];
    rand.nextBytes(buf);
    byteValues[i]=new BytesWritable(buf);
  }
  for (int i=0; i < COUNT; ++i) {
    appendRandomRow(batch,intValues,doubleValues,stringValues,byteValues,words,i);
    if (batch.size == 1024) {
      writer.addRowBatch(batch);
      batch.reset();
    }
  }
  if (batch.size != 0) {
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(COUNT,reader.getNumberOfRows());
  RecordReader rows=reader.rows();
  MetadataReader meta=((RecordReaderImpl)rows).getMetadataReader();
  OrcIndex index=meta.readRowIndex(reader.getStripes().get(0),null,null,null,null,null);
  for (int c=1; c < 9; ++c) {
    OrcProto.RowIndex colIndex=index.getRowGroupIndex()[c];
    assertEquals(1000,colIndex.getEntry(0).getStatistics().getNumberOfValues());
  }
  OrcStruct row=null;
  for (int i=COUNT - 1; i >= 0; --i) {
    rows.seekToRow(i);
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,i);
    assertEquals(expected.boolean1.booleanValue(),((BooleanWritable)row.getFieldValue(0)).get());
    assertEquals(expected.byte1.byteValue(),((ByteWritable)row.getFieldValue(1)).get());
    assertEquals(expected.short1.shortValue(),((ShortWritable)row.getFieldValue(2)).get());
    assertEquals(expected.int1.intValue(),((IntWritable)row.getFieldValue(3)).get());
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.float1,((FloatWritable)row.getFieldValue(5)).get(),0.0001);
    assertEquals(expected.double1,((DoubleWritable)row.getFieldValue(6)).get(),0.0001);
    assertEquals(expected.bytes1,row.getFieldValue(7));
    assertEquals(expected.string1,row.getFieldValue(8));
    List<InnerStruct> expectedList=expected.middle.list;
    List<OrcStruct> actualList=(List<OrcStruct>)((OrcStruct)row.getFieldValue(9)).getFieldValue(0);
    compareList(expectedList,actualList,"middle list " + i);
    compareList(expected.list,(List<OrcStruct>)row.getFieldValue(10),"list " + i);
  }
  rows.close();
  Iterator<StripeInformation> stripeIterator=reader.getStripes().iterator();
  long offsetOfStripe2=0;
  long offsetOfStripe4=0;
  long lastRowOfStripe2=0;
  for (int i=0; i < 5; ++i) {
    StripeInformation stripe=stripeIterator.next();
    if (i < 2) {
      lastRowOfStripe2+=stripe.getNumberOfRows();
    }
 else     if (i == 2) {
      offsetOfStripe2=stripe.getOffset();
      lastRowOfStripe2+=stripe.getNumberOfRows() - 1;
    }
 else     if (i == 4) {
      offsetOfStripe4=stripe.getOffset();
    }
  }
  boolean[] columns=new boolean[reader.getStatistics().length];
  columns[5]=true;
  columns[9]=true;
  rows=reader.rowsOptions(new Reader.Options().range(offsetOfStripe2,offsetOfStripe4 - offsetOfStripe2).include(columns));
  rows.seekToRow(lastRowOfStripe2);
  for (int i=0; i < 2; ++i) {
    row=(OrcStruct)rows.next(row);
    BigRow expected=createRandomRow(intValues,doubleValues,stringValues,byteValues,words,(int)(lastRowOfStripe2 + i));
    assertEquals(expected.long1.longValue(),((LongWritable)row.getFieldValue(4)).get());
    assertEquals(expected.string1,row.getFieldValue(8));
  }
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStripeLevelStats() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("int1",TypeDescription.createInt()).addField("string1",TypeDescription.createString());
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1000;
  LongColumnVector field1=(LongColumnVector)batch.cols[0];
  BytesColumnVector field2=(BytesColumnVector)batch.cols[1];
  field1.isRepeating=true;
  field2.isRepeating=true;
  for (int b=0; b < 11; b++) {
    if (b >= 5) {
      if (b >= 10) {
        field1.vector[0]=3;
        field2.setVal(0,"three".getBytes());
      }
 else {
        field1.vector[0]=2;
        field2.setVal(0,"two".getBytes());
      }
    }
 else {
      field1.vector[0]=1;
      field2.setVal(0,"one".getBytes());
    }
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(2,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,true,false};
  boolean[] included=OrcUtils.includeColumns("int1",schema);
  assertEquals(true,Arrays.equals(expected,included));
  List<StripeStatistics> stats=reader.getStripeStatistics();
  int numStripes=stats.size();
  assertEquals(3,numStripes);
  StripeStatistics ss1=stats.get(0);
  StripeStatistics ss2=stats.get(1);
  StripeStatistics ss3=stats.get(2);
  assertEquals(5000,ss1.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(5000,ss2.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1000,ss3.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(5000,(ss1.getColumnStatistics()[1]).getNumberOfValues());
  assertEquals(5000,(ss2.getColumnStatistics()[1]).getNumberOfValues());
  assertEquals(1000,(ss3.getColumnStatistics()[1]).getNumberOfValues());
  assertEquals(1,((IntegerColumnStatistics)ss1.getColumnStatistics()[1]).getMinimum());
  assertEquals(2,((IntegerColumnStatistics)ss2.getColumnStatistics()[1]).getMinimum());
  assertEquals(3,((IntegerColumnStatistics)ss3.getColumnStatistics()[1]).getMinimum());
  assertEquals(1,((IntegerColumnStatistics)ss1.getColumnStatistics()[1]).getMaximum());
  assertEquals(2,((IntegerColumnStatistics)ss2.getColumnStatistics()[1]).getMaximum());
  assertEquals(3,((IntegerColumnStatistics)ss3.getColumnStatistics()[1]).getMaximum());
  assertEquals(5000,((IntegerColumnStatistics)ss1.getColumnStatistics()[1]).getSum());
  assertEquals(10000,((IntegerColumnStatistics)ss2.getColumnStatistics()[1]).getSum());
  assertEquals(3000,((IntegerColumnStatistics)ss3.getColumnStatistics()[1]).getSum());
  assertEquals(5000,(ss1.getColumnStatistics()[2]).getNumberOfValues());
  assertEquals(5000,(ss2.getColumnStatistics()[2]).getNumberOfValues());
  assertEquals(1000,(ss3.getColumnStatistics()[2]).getNumberOfValues());
  assertEquals("one",((StringColumnStatistics)ss1.getColumnStatistics()[2]).getMinimum());
  assertEquals("two",((StringColumnStatistics)ss2.getColumnStatistics()[2]).getMinimum());
  assertEquals("three",((StringColumnStatistics)ss3.getColumnStatistics()[2]).getMinimum());
  assertEquals("one",((StringColumnStatistics)ss1.getColumnStatistics()[2]).getMaximum());
  assertEquals("two",((StringColumnStatistics)ss2.getColumnStatistics()[2]).getMaximum());
  assertEquals("three",((StringColumnStatistics)ss3.getColumnStatistics()[2]).getMaximum());
  assertEquals(15000,((StringColumnStatistics)ss1.getColumnStatistics()[2]).getSum());
  assertEquals(15000,((StringColumnStatistics)ss2.getColumnStatistics()[2]).getSum());
  assertEquals(5000,((StringColumnStatistics)ss3.getColumnStatistics()[2]).getSum());
  RecordReaderImpl recordReader=(RecordReaderImpl)reader.rows();
  OrcProto.RowIndex[] index=recordReader.readRowIndex(0,null,null).getRowGroupIndex();
  assertEquals(3,index.length);
  List<OrcProto.RowIndexEntry> items=index[1].getEntryList();
  assertEquals(1,items.size());
  assertEquals(3,items.get(0).getPositionsCount());
  assertEquals(0,items.get(0).getPositions(0));
  assertEquals(0,items.get(0).getPositions(1));
  assertEquals(0,items.get(0).getPositions(2));
  assertEquals(1,items.get(0).getStatistics().getIntStatistics().getMinimum());
  index=recordReader.readRowIndex(1,null,null).getRowGroupIndex();
  assertEquals(3,index.length);
  items=index[1].getEntryList();
  assertEquals(2,items.get(0).getStatistics().getIntStatistics().getMaximum());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * A test case that tests the case where you add a repeating batch
 * to a column that isn't using dictionary encoding.
 * @throws Exception
 */
@Test public void testNonDictionaryRepeatingString() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("str",TypeDescription.createString());
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  for (int r=0; r < batch.size; ++r) {
    ((BytesColumnVector)batch.cols[0]).setVal(r,Integer.toString(r * 10001).getBytes());
  }
  writer.addRowBatch(batch);
  batch.cols[0].isRepeating=true;
  ((BytesColumnVector)batch.cols[0]).setVal(0,"Halloween".getBytes());
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  batch=rows.nextBatch(null);
  assertEquals(1024,batch.size);
  for (int r=0; r < 1024; ++r) {
    assertEquals(Integer.toString(r * 10001),makeString((BytesColumnVector)batch.cols[0],r));
  }
  batch=rows.nextBatch(batch);
  assertEquals(1024,batch.size);
  for (int r=0; r < 1024; ++r) {
    assertEquals("Halloween",makeString((BytesColumnVector)batch.cols[0],r));
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testColumnProjection() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random r1=new Random(1);
  Random r2=new Random(2);
  int x;
  int minInt=0, maxInt=0;
  String y;
  String minStr=null, maxStr=null;
  batch.size=1000;
  boolean first=true;
  for (int b=0; b < 21; ++b) {
    for (int r=0; r < 1000; ++r) {
      x=r1.nextInt();
      y=Long.toHexString(r2.nextLong());
      if (first || x < minInt) {
        minInt=x;
      }
      if (first || x > maxInt) {
        maxInt=x;
      }
      if (first || y.compareTo(minStr) < 0) {
        minStr=y;
      }
      if (first || y.compareTo(maxStr) > 0) {
        maxStr=y;
      }
      first=false;
      ((LongColumnVector)batch.cols[0]).vector[r]=x;
      ((BytesColumnVector)batch.cols[1]).setVal(r,y.getBytes());
    }
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(3,stats.length);
  for (  ColumnStatistics s : stats) {
    assertEquals(21000,s.getNumberOfValues());
    if (s instanceof IntegerColumnStatistics) {
      assertEquals(minInt,((IntegerColumnStatistics)s).getMinimum());
      assertEquals(maxInt,((IntegerColumnStatistics)s).getMaximum());
    }
 else     if (s instanceof StringColumnStatistics) {
      assertEquals(maxStr,((StringColumnStatistics)s).getMaximum());
      assertEquals(minStr,((StringColumnStatistics)s).getMinimum());
    }
  }
  List<OrcProto.Type> types=reader.getTypes();
  assertEquals(3,types.size());
  assertEquals(OrcProto.Type.Kind.STRUCT,types.get(0).getKind());
  assertEquals(2,types.get(0).getSubtypesCount());
  assertEquals(1,types.get(0).getSubtypes(0));
  assertEquals(2,types.get(0).getSubtypes(1));
  assertEquals(OrcProto.Type.Kind.INT,types.get(1).getKind());
  assertEquals(0,types.get(1).getSubtypesCount());
  assertEquals(OrcProto.Type.Kind.STRING,types.get(2).getKind());
  assertEquals(0,types.get(2).getSubtypesCount());
  RecordReader rows1=reader.rows(new boolean[]{true,true,false});
  RecordReader rows2=reader.rows(new boolean[]{true,false,true});
  r1=new Random(1);
  r2=new Random(2);
  OrcStruct row1=null;
  OrcStruct row2=null;
  for (int i=0; i < 21000; ++i) {
    assertEquals(true,rows1.hasNext());
    assertEquals(true,rows2.hasNext());
    row1=(OrcStruct)rows1.next(row1);
    row2=(OrcStruct)rows2.next(row2);
    assertEquals(r1.nextInt(),((IntWritable)row1.getFieldValue(0)).get());
    assertEquals(Long.toHexString(r2.nextLong()),row2.getFieldValue(1).toString());
  }
  assertEquals(false,rows1.hasNext());
  assertEquals(false,rows2.hasNext());
  rows1.close();
  rows2.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test Unions.
 * @throws Exception
 */
@Test public void testUnions() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("outer",TypeDescription.createUnion().addUnionChild(TypeDescription.createInt()).addUnionChild(TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  UnionColumnVector outer=(UnionColumnVector)batch.cols[0];
  batch.cols[0].noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      outer.isNull[r]=true;
    }
 else     if (r < 300) {
      outer.tags[r]=0;
    }
 else     if (r < 400) {
      outer.tags[r]=1;
    }
 else     if (r < 600) {
      outer.isNull[r]=true;
    }
 else     if (r < 800) {
      outer.tags[r]=1;
    }
 else     if (r < 1000) {
      outer.isNull[r]=true;
    }
 else {
      outer.tags[r]=1;
    }
    ((LongColumnVector)outer.fields[0]).vector[r]=r;
    ((LongColumnVector)outer.fields[1]).vector[r]=-r;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    OrcUnion inner=(OrcUnion)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"union(0, " + r + ")",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 800) {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
 else     if (r < 1000) {
      assertEquals("row " + r,null,inner);
    }
 else {
      assertEquals("row " + r,"union(1, " + -r + ")",inner.toString());
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test lists and how they interact with the child column. In particular,
 * put nulls between back to back lists and then make some lists that
 * oper lap.
 * @throws Exception
 */
@Test public void testLists() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("list",TypeDescription.createList(TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  ListColumnVector list=(ListColumnVector)batch.cols[0];
  list.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      list.isNull[r]=true;
    }
 else     if (r < 300) {
      list.offsets[r]=r - 200;
      list.lengths[r]=1;
    }
 else     if (r < 400) {
      list.isNull[r]=true;
    }
 else     if (r < 500) {
      list.offsets[r]=r - 300;
      list.lengths[r]=1;
    }
 else     if (r < 600) {
      list.isNull[r]=true;
    }
 else     if (r < 700) {
      list.offsets[r]=r;
      list.lengths[r]=2;
    }
 else {
      list.isNull[r]=true;
    }
    ((LongColumnVector)list.child).vector[r]=r * 10;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    List inner=(List)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"[" + ((r - 200) * 10) + "]",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 500) {
      assertEquals("row " + r,"[" + ((r - 300) * 10) + "]",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 700) {
      assertEquals("row " + r,"[" + (10 * r) + ", "+ (10 * (r + 1))+ "]",inner.toString());
    }
 else {
      assertEquals("row " + r,null,inner);
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testWithoutIndex() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(5000).compress(CompressionKind.SNAPPY).bufferSize(1000).rowIndexStride(0));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random rand=new Random(24);
  batch.size=5;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
  }
  for (int i=0; i < 10000; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[0]=rand.nextInt();
    ((BytesColumnVector)batch.cols[1]).setVal(0,Integer.toBinaryString(rand.nextInt()).getBytes());
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(50000,reader.getNumberOfRows());
  assertEquals(0,reader.getRowIndexStride());
  StripeInformation stripe=reader.getStripes().iterator().next();
  assertEquals(true,stripe.getDataLength() != 0);
  assertEquals(0,stripe.getIndexLength());
  RecordReader rows=reader.rows();
  rand=new Random(24);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    int intVal=rand.nextInt();
    String strVal=Integer.toBinaryString(rand.nextInt());
    for (int j=0; j < 5; ++j) {
      assertEquals(true,rows.hasNext());
      row=(OrcStruct)rows.next(row);
      assertEquals(intVal,((IntWritable)row.getFieldValue(0)).get());
      assertEquals(strVal,row.getFieldValue(1).toString());
    }
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadFormat_0_11() throws Exception {
  Path oldFilePath=new Path(HiveTestUtils.getFileFromClasspath("orc-file-11-format.orc"));
  Reader reader=OrcFile.createReader(oldFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getIndexLength() + stripe.getDataLength()+ stripe.getFooterLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getIndexLength() + stripe.getDataLength() + stripe.getFooterLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(7500,stats[1].getNumberOfValues());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(3750,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 7500 hasNull: true true: 3750",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(11520000,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 7500 hasNull: true min: 1024 max: 2048 sum: 11520000",stats[3].toString());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMaximum());
  assertEquals(Long.MAX_VALUE,((IntegerColumnStatistics)stats[5]).getMinimum());
  assertEquals(false,((IntegerColumnStatistics)stats[5]).isSumDefined());
  assertEquals("count: 7500 hasNull: true min: 9223372036854775807 max: 9223372036854775807",stats[5].toString());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-75000.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 7500 hasNull: true min: -15.0 max: -5.0 sum: -75000.0",stats[7].toString());
  assertEquals("count: 7500 hasNull: true min: bye max: hi sum: 0",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>,ts:timestamp,"+ "decimal1:decimal(38,18)>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  TimestampObjectInspector tso=(TimestampObjectInspector)readerInspector.getStructFieldRef("ts").getFieldObjectInspector();
  HiveDecimalObjectInspector dco=(HiveDecimalObjectInspector)readerInspector.getStructFieldRef("decimal1").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:00"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547456"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(true,rows.hasNext());
  rows.seekToRow(7499);
  row=rows.next(null);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(Timestamp.valueOf("2000-03-12 15:00:01"),tso.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(12))));
  assertEquals(HiveDecimal.create("12345678.6547457"),dco.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(13))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV12() throws Exception {
  TypeDescription schema=createInnerSchema();
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).version(OrcFile.Version.V_0_12));
  VectorizedRowBatch batch=schema.createRowBatch();
  assertEquals(testFilePath,memory.path);
  batch.size=1;
  for (int i=0; i < 2500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[0]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(0,Integer.toHexString(10 * i).getBytes());
    writer.addRowBatch(batch);
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(3,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStructs() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("struct",TypeDescription.createStruct().addField("inner",TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  StructColumnVector outer=(StructColumnVector)batch.cols[0];
  outer.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200 || (r >= 400 && r < 600) || r >= 800) {
      outer.isNull[r]=true;
    }
    ((LongColumnVector)outer.fields[0]).vector[r]=r;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    OrcStruct inner=(OrcStruct)row.getFieldValue(0);
    if (r < 200 || (r >= 400 && r < 600) || r >= 800) {
      assertEquals("row " + r,null,inner);
    }
 else {
      assertEquals("row " + r,"{" + r + "}",inner.toString());
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test all of the types that have distinct ORC writers using the vectorized
 * writer with different combinations of repeating and null values.
 * @throws Exception
 */
@Test public void testRepeating() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("bin",TypeDescription.createBinary()).addField("bool",TypeDescription.createBoolean()).addField("byte",TypeDescription.createByte()).addField("long",TypeDescription.createLong()).addField("float",TypeDescription.createFloat()).addField("double",TypeDescription.createDouble()).addField("date",TypeDescription.createDate()).addField("time",TypeDescription.createTimestamp()).addField("dec",TypeDescription.createDecimal().withPrecision(20).withScale(6)).addField("string",TypeDescription.createString()).addField("char",TypeDescription.createChar().withMaxLength(10)).addField("vc",TypeDescription.createVarchar().withMaxLength(10)).addField("struct",TypeDescription.createStruct().addField("sub1",TypeDescription.createInt())).addField("union",TypeDescription.createUnion().addUnionChild(TypeDescription.createString()).addUnionChild(TypeDescription.createInt())).addField("list",TypeDescription.createList(TypeDescription.createInt())).addField("map",TypeDescription.createMap(TypeDescription.createString(),TypeDescription.createString()));
  VectorizedRowBatch batch=schema.createRowBatch();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).rowIndexStride(1000));
  batch.size=1024;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
    batch.cols[c].noNulls=false;
    batch.cols[c].isNull[0]=true;
  }
  writer.addRowBatch(batch);
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].isNull[0]=false;
  }
  ((BytesColumnVector)batch.cols[0]).setVal(0,"Horton".getBytes());
  ((LongColumnVector)batch.cols[1]).vector[0]=1;
  ((LongColumnVector)batch.cols[2]).vector[0]=130;
  ((LongColumnVector)batch.cols[3]).vector[0]=0x123456789abcdef0L;
  ((DoubleColumnVector)batch.cols[4]).vector[0]=1.125;
  ((DoubleColumnVector)batch.cols[5]).vector[0]=0.0009765625;
  ((LongColumnVector)batch.cols[6]).vector[0]=new DateWritable(new Date(111,6,1)).getDays();
  ((LongColumnVector)batch.cols[7]).vector[0]=TimestampUtils.getTimeNanoSec(new Timestamp(115,9,23,10,11,59,999999999));
  ((DecimalColumnVector)batch.cols[8]).vector[0]=new HiveDecimalWritable("1.234567");
  ((BytesColumnVector)batch.cols[9]).setVal(0,"Echelon".getBytes());
  ((BytesColumnVector)batch.cols[10]).setVal(0,"Juggernaut".getBytes());
  ((BytesColumnVector)batch.cols[11]).setVal(0,"Dreadnaught".getBytes());
  ((LongColumnVector)((StructColumnVector)batch.cols[12]).fields[0]).vector[0]=123;
  ((UnionColumnVector)batch.cols[13]).tags[0]=1;
  ((LongColumnVector)((UnionColumnVector)batch.cols[13]).fields[1]).vector[0]=1234;
  ((ListColumnVector)batch.cols[14]).offsets[0]=0;
  ((ListColumnVector)batch.cols[14]).lengths[0]=3;
  ((ListColumnVector)batch.cols[14]).child.isRepeating=true;
  ((LongColumnVector)((ListColumnVector)batch.cols[14]).child).vector[0]=31415;
  ((MapColumnVector)batch.cols[15]).offsets[0]=0;
  ((MapColumnVector)batch.cols[15]).lengths[0]=3;
  ((MapColumnVector)batch.cols[15]).values.isRepeating=true;
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(0,"ORC".getBytes());
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(1,"Hive".getBytes());
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(2,"LLAP".getBytes());
  ((BytesColumnVector)((MapColumnVector)batch.cols[15]).values).setVal(0,"fast".getBytes());
  writer.addRowBatch(batch);
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(false);
    batch.cols[c].noNulls=false;
    Arrays.fill(batch.cols[c].isNull,true);
  }
  writer.addRowBatch(batch);
  batch.reset();
  batch.size=1024;
  ((ListColumnVector)batch.cols[14]).child.ensureSize(3 * 1024,false);
  ((MapColumnVector)batch.cols[15]).keys.ensureSize(3 * 1024,false);
  ((MapColumnVector)batch.cols[15]).values.ensureSize(3 * 1024,false);
  for (int r=0; r < 1024; ++r) {
    ((BytesColumnVector)batch.cols[0]).setVal(r,Integer.toHexString(r).getBytes());
    ((LongColumnVector)batch.cols[1]).vector[r]=r % 2;
    ((LongColumnVector)batch.cols[2]).vector[r]=(r % 255);
    ((LongColumnVector)batch.cols[3]).vector[r]=31415L * r;
    ((DoubleColumnVector)batch.cols[4]).vector[r]=1.125 * r;
    ((DoubleColumnVector)batch.cols[5]).vector[r]=0.0009765625 * r;
    ((LongColumnVector)batch.cols[6]).vector[r]=new DateWritable(new Date(111,6,1)).getDays() + r;
    ((LongColumnVector)batch.cols[7]).vector[r]=TimestampUtils.getTimeNanoSec(new Timestamp(115,9,23,10,11,59,999999999)) + r * 1000000000L;
    ((DecimalColumnVector)batch.cols[8]).vector[r]=new HiveDecimalWritable("1.234567");
    ((BytesColumnVector)batch.cols[9]).setVal(r,Integer.toString(r).getBytes());
    ((BytesColumnVector)batch.cols[10]).setVal(r,Integer.toHexString(r).getBytes());
    ((BytesColumnVector)batch.cols[11]).setVal(r,Integer.toHexString(r * 128).getBytes());
    ((LongColumnVector)((StructColumnVector)batch.cols[12]).fields[0]).vector[r]=r + 13;
    ((UnionColumnVector)batch.cols[13]).tags[r]=1;
    ((LongColumnVector)((UnionColumnVector)batch.cols[13]).fields[1]).vector[r]=r + 42;
    ((ListColumnVector)batch.cols[14]).offsets[r]=3 * r;
    ((ListColumnVector)batch.cols[14]).lengths[r]=3;
    for (int i=0; i < 3; ++i) {
      ((LongColumnVector)((ListColumnVector)batch.cols[14]).child).vector[3 * r + i]=31415 + i;
    }
    ((MapColumnVector)batch.cols[15]).offsets[r]=3 * r;
    ((MapColumnVector)batch.cols[15]).lengths[r]=3;
    for (int i=0; i < 3; ++i) {
      ((BytesColumnVector)((MapColumnVector)batch.cols[15]).keys).setVal(3 * r + i,Integer.toHexString(3 * r + i).getBytes());
      ((BytesColumnVector)((MapColumnVector)batch.cols[15]).values).setVal(3 * r + i,Integer.toString(3 * r + i).getBytes());
    }
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4096,stats[0].getNumberOfValues());
  assertEquals(false,stats[0].hasNull());
  for (  TypeDescription colType : schema.getChildren()) {
    assertEquals("count on " + colType.getId(),2048,stats[colType.getId()].getNumberOfValues());
    assertEquals("hasNull on " + colType.getId(),true,stats[colType.getId()].hasNull());
  }
  assertEquals(8944,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals(1536,((BooleanColumnStatistics)stats[2]).getTrueCount());
  assertEquals(512,((BooleanColumnStatistics)stats[2]).getFalseCount());
  assertEquals(false,((IntegerColumnStatistics)stats[4]).isSumDefined());
  assertEquals(0,((IntegerColumnStatistics)stats[4]).getMinimum());
  assertEquals(0x123456789abcdef0L,((IntegerColumnStatistics)stats[4]).getMaximum());
  assertEquals("0",((StringColumnStatistics)stats[10]).getMinimum());
  assertEquals("Echelon",((StringColumnStatistics)stats[10]).getMaximum());
  assertEquals(10154,((StringColumnStatistics)stats[10]).getSum());
  assertEquals("0         ",((StringColumnStatistics)stats[11]).getMinimum());
  assertEquals("ff        ",((StringColumnStatistics)stats[11]).getMaximum());
  assertEquals(20480,((StringColumnStatistics)stats[11]).getSum());
  assertEquals("0",((StringColumnStatistics)stats[12]).getMinimum());
  assertEquals("ff80",((StringColumnStatistics)stats[12]).getMaximum());
  assertEquals(14813,((StringColumnStatistics)stats[12]).getSum());
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    for (int f=0; f < row.getNumFields(); ++f) {
      assertEquals("non-null on row " + r + " field "+ f,null,row.getFieldValue(f));
    }
  }
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals("row " + r,"48 6f 72 74 6f 6e",row.getFieldValue(0).toString());
    assertEquals("row " + r,"true",row.getFieldValue(1).toString());
    assertEquals("row " + r,"-126",row.getFieldValue(2).toString());
    assertEquals("row " + r,"1311768467463790320",row.getFieldValue(3).toString());
    assertEquals("row " + r,"1.125",row.getFieldValue(4).toString());
    assertEquals("row " + r,"9.765625E-4",row.getFieldValue(5).toString());
    assertEquals("row " + r,"2011-07-01",row.getFieldValue(6).toString());
    assertEquals("row " + r,"2015-10-23 10:11:59.999999999",row.getFieldValue(7).toString());
    assertEquals("row " + r,"1.234567",row.getFieldValue(8).toString());
    assertEquals("row " + r,"Echelon",row.getFieldValue(9).toString());
    assertEquals("row " + r,"Juggernaut",row.getFieldValue(10).toString());
    assertEquals("row " + r,"Dreadnaugh",row.getFieldValue(11).toString());
    assertEquals("row " + r,"{123}",row.getFieldValue(12).toString());
    assertEquals("row " + r,"union(1, 1234)",row.getFieldValue(13).toString());
    assertEquals("row " + r,"[31415, 31415, 31415]",row.getFieldValue(14).toString());
    assertEquals("row " + r,"{ORC=fast, Hive=fast, LLAP=fast}",row.getFieldValue(15).toString());
  }
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    for (int f=0; f < row.getNumFields(); ++f) {
      assertEquals("non-null on row " + r + " field "+ f,null,row.getFieldValue(f));
    }
  }
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    byte[] hex=Integer.toHexString(r).getBytes();
    StringBuilder expected=new StringBuilder();
    for (int i=0; i < hex.length; ++i) {
      if (i != 0) {
        expected.append(' ');
      }
      expected.append(Integer.toHexString(hex[i]));
    }
    assertEquals("row " + r,expected.toString(),row.getFieldValue(0).toString());
    assertEquals("row " + r,r % 2 == 1 ? "true" : "false",row.getFieldValue(1).toString());
    assertEquals("row " + r,Integer.toString((byte)(r % 255)),row.getFieldValue(2).toString());
    assertEquals("row " + r,Long.toString(31415L * r),row.getFieldValue(3).toString());
    assertEquals("row " + r,Float.toString(1.125F * r),row.getFieldValue(4).toString());
    assertEquals("row " + r,Double.toString(0.0009765625 * r),row.getFieldValue(5).toString());
    assertEquals("row " + r,new Date(111,6,1 + r).toString(),row.getFieldValue(6).toString());
    assertEquals("row " + r,new Timestamp(115,9,23,10,11,59 + r,999999999).toString(),row.getFieldValue(7).toString());
    assertEquals("row " + r,"1.234567",row.getFieldValue(8).toString());
    assertEquals("row " + r,Integer.toString(r),row.getFieldValue(9).toString());
    assertEquals("row " + r,pad(Integer.toHexString(r),10),row.getFieldValue(10).toString());
    assertEquals("row " + r,Integer.toHexString(r * 128),row.getFieldValue(11).toString());
    assertEquals("row " + r,"{" + Integer.toString(r + 13) + "}",row.getFieldValue(12).toString());
    assertEquals("row " + r,"union(1, " + Integer.toString(r + 42) + ")",row.getFieldValue(13).toString());
    assertEquals("row " + r,"[31415, 31416, 31417]",row.getFieldValue(14).toString());
    expected=new StringBuilder();
    expected.append('{');
    expected.append(Integer.toHexString(3 * r));
    expected.append('=');
    expected.append(3 * r);
    expected.append(", ");
    expected.append(Integer.toHexString(3 * r + 1));
    expected.append('=');
    expected.append(3 * r + 1);
    expected.append(", ");
    expected.append(Integer.toHexString(3 * r + 2));
    expected.append('=');
    expected.append(3 * r + 2);
    expected.append('}');
    assertEquals("row " + r,expected.toString(),row.getFieldValue(15).toString());
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStringAndBinaryStatistics() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("bytes1",TypeDescription.createBinary()).addField("string1",TypeDescription.createString());
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=4;
  BytesColumnVector field1=(BytesColumnVector)batch.cols[0];
  BytesColumnVector field2=(BytesColumnVector)batch.cols[1];
  field1.setVal(0,bytesArray(0,1,2,3,4));
  field1.setVal(1,bytesArray(0,1,2,3));
  field1.setVal(2,bytesArray(0,1,2,3,4,5));
  field1.noNulls=false;
  field1.isNull[3]=true;
  field2.setVal(0,"foo".getBytes());
  field2.setVal(1,"bar".getBytes());
  field2.noNulls=false;
  field2.isNull[2]=true;
  field2.setVal(3,"hi".getBytes());
  writer.addRowBatch(batch);
  writer.close();
  schema=writer.getSchema();
  assertEquals(2,schema.getMaximumId());
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  boolean[] expected=new boolean[]{false,false,true};
  boolean[] included=OrcUtils.includeColumns("string1",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,false};
  included=OrcUtils.includeColumns(null,schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(4,stats[0].getNumberOfValues());
  assertEquals("count: 4 hasNull: false",stats[0].toString());
  assertEquals(3,stats[1].getNumberOfValues());
  assertEquals(15,((BinaryColumnStatistics)stats[1]).getSum());
  assertEquals("count: 3 hasNull: true sum: 15",stats[1].toString());
  assertEquals(3,stats[2].getNumberOfValues());
  assertEquals("bar",((StringColumnStatistics)stats[2]).getMinimum());
  assertEquals("hi",((StringColumnStatistics)stats[2]).getMaximum());
  assertEquals(8,((StringColumnStatistics)stats[2]).getSum());
  assertEquals("count: 3 hasNull: true min: bar max: hi sum: 8",stats[2].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<bytes1:binary,string1:string>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("foo",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("bar",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(bytes(0,1,2,3,4,5),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertNull(st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertNull(bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the char and varchar padding and truncation.
 * @throws Exception
 */
@Test public void testStringPadding() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("char",TypeDescription.createChar().withMaxLength(10)).addField("varchar",TypeDescription.createVarchar().withMaxLength(10));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=4;
  for (int c=0; c < batch.cols.length; ++c) {
    ((BytesColumnVector)batch.cols[c]).setVal(0,"".getBytes());
    ((BytesColumnVector)batch.cols[c]).setVal(1,"xyz".getBytes());
    ((BytesColumnVector)batch.cols[c]).setVal(2,"0123456789".getBytes());
    ((BytesColumnVector)batch.cols[c]).setVal(3,"0123456789abcdef".getBytes());
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  batch=rows.nextBatch(null);
  assertEquals(4,batch.size);
  assertEquals("",makeString((BytesColumnVector)batch.cols[0],0));
  assertEquals("xyz",makeString((BytesColumnVector)batch.cols[0],1));
  assertEquals("0123456789",makeString((BytesColumnVector)batch.cols[0],2));
  assertEquals("0123456789",makeString((BytesColumnVector)batch.cols[0],3));
  assertEquals("",makeString((BytesColumnVector)batch.cols[1],0));
  assertEquals("xyz",makeString((BytesColumnVector)batch.cols[1],1));
  assertEquals("0123456789",makeString((BytesColumnVector)batch.cols[1],2));
  assertEquals("0123456789",makeString((BytesColumnVector)batch.cols[1],3));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimestamp() throws Exception {
  ObjectInspector inspector;
synchronized (TestVectorOrcFile.class) {
    inspector=ObjectInspectorFactory.getReflectionObjectInspector(Timestamp.class,ObjectInspectorFactory.ObjectInspectorOptions.JAVA);
  }
  TypeDescription schema=TypeDescription.createTimestamp();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000).version(org.apache.orc.OrcFile.Version.V_0_11));
  List<Timestamp> tslist=Lists.newArrayList();
  tslist.add(Timestamp.valueOf("2037-01-01 00:00:00.000999"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.000000222"));
  tslist.add(Timestamp.valueOf("1999-01-01 00:00:00.999999999"));
  tslist.add(Timestamp.valueOf("1995-01-01 00:00:00.688888888"));
  tslist.add(Timestamp.valueOf("2002-01-01 00:00:00.1"));
  tslist.add(Timestamp.valueOf("2010-03-02 00:00:00.000009001"));
  tslist.add(Timestamp.valueOf("2005-01-01 00:00:00.000002229"));
  tslist.add(Timestamp.valueOf("2006-01-01 00:00:00.900203003"));
  tslist.add(Timestamp.valueOf("2003-01-01 00:00:00.800000007"));
  tslist.add(Timestamp.valueOf("1996-08-02 00:00:00.723100809"));
  tslist.add(Timestamp.valueOf("1998-11-02 00:00:00.857340643"));
  tslist.add(Timestamp.valueOf("2008-10-02 00:00:00"));
  VectorizedRowBatch batch=new VectorizedRowBatch(1,1024);
  LongColumnVector vec=new LongColumnVector(1024);
  batch.cols[0]=vec;
  batch.reset();
  batch.size=tslist.size();
  for (int i=0; i < tslist.size(); ++i) {
    Timestamp ts=tslist.get(i);
    vec.vector[i]=TimestampUtils.getTimeNanoSec(ts);
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows(null);
  int idx=0;
  while (rows.hasNext()) {
    Object row=rows.next(null);
    assertEquals(tslist.get(idx++).getNanos(),((TimestampWritable)row).getNanos());
  }
  assertEquals(tslist.size(),rows.getRowNumber());
  assertEquals(0,writer.getSchema().getMaximumId());
  boolean[] expected=new boolean[]{false};
  boolean[] included=OrcUtils.includeColumns("",writer.getSchema());
  assertEquals(true,Arrays.equals(expected,included));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryManagementV11() throws Exception {
  TypeDescription schema=createInnerSchema();
  MyMemoryManager memory=new MyMemoryManager(conf,10000,0.1);
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).compress(CompressionKind.NONE).stripeSize(50000).bufferSize(100).rowIndexStride(0).memory(memory).version(OrcFile.Version.V_0_11));
  assertEquals(testFilePath,memory.path);
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1;
  for (int i=0; i < 2500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[0]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(0,Integer.toHexString(10 * i).getBytes());
    writer.addRowBatch(batch);
  }
  writer.close();
  assertEquals(null,memory.path);
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  int i=0;
  for (  StripeInformation stripe : reader.getStripes()) {
    i+=1;
    assertTrue("stripe " + i + " is too long at "+ stripe.getDataLength(),stripe.getDataLength() < 5000);
  }
  assertEquals(25,i);
  assertEquals(2500,reader.getNumberOfRows());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * We test union, timestamp, and decimal separately since we need to make the
 * object inspector manually. (The Hive reflection-based doesn't handle
 * them properly.)
 */
@Test public void testUnionAndTimestamp() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("time",TypeDescription.createTimestamp()).addField("union",TypeDescription.createUnion().addUnionChild(TypeDescription.createInt()).addUnionChild(TypeDescription.createString())).addField("decimal",TypeDescription.createDecimal().withPrecision(38).withScale(18));
  HiveDecimal maxValue=HiveDecimal.create("10000000000000000000");
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100).blockPadding(false));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=6;
  setUnion(batch,0,Timestamp.valueOf("2000-03-12 15:00:00"),0,42,null,new HiveDecimalWritable("12345678.6547456"));
  setUnion(batch,1,Timestamp.valueOf("2000-03-20 12:00:00.123456789"),1,null,"hello",new HiveDecimalWritable("-5643.234"));
  setUnion(batch,2,null,null,null,null,null);
  setUnion(batch,3,null,0,null,null,null);
  setUnion(batch,4,null,1,null,null,null);
  setUnion(batch,5,Timestamp.valueOf("1970-01-01 00:00:00"),0,200000,null,new HiveDecimalWritable("10000000000000000000"));
  writer.addRowBatch(batch);
  batch.reset();
  Random rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    Timestamp ts=Timestamp.valueOf(i + "-05-05 12:34:56." + i);
    HiveDecimal dec=HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18));
    if ((i & 1) == 0) {
      setUnion(batch,batch.size++,ts,0,i * i,null,new HiveDecimalWritable(dec));
    }
 else {
      setUnion(batch,batch.size++,ts,1,null,Integer.toString(i * i),new HiveDecimalWritable(dec));
    }
    if (maxValue.compareTo(dec) < 0) {
      maxValue=dec;
    }
  }
  writer.addRowBatch(batch);
  batch.reset();
  batch.size=1000;
  for (int c=0; c < batch.cols.length; ++c) {
    batch.cols[c].setRepeating(true);
  }
  setUnion(batch,0,null,0,1732050807,null,null);
  for (int i=0; i < 5; ++i) {
    writer.addRowBatch(batch);
  }
  batch.reset();
  batch.size=3;
  setUnion(batch,0,null,0,0,null,null);
  setUnion(batch,1,null,0,10,null,null);
  setUnion(batch,2,null,0,138,null,null);
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(5,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,true};
  included=OrcUtils.includeColumns("time,decimal",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,false,true,true,true,false};
  included=OrcUtils.includeColumns("union",schema);
  assertEquals(true,Arrays.equals(expected,included));
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(5077,reader.getNumberOfRows());
  DecimalColumnStatistics stats=(DecimalColumnStatistics)reader.getStatistics()[5];
  assertEquals(71,stats.getNumberOfValues());
  assertEquals(HiveDecimal.create("-5643.234"),stats.getMinimum());
  assertEquals(maxValue,stats.getMaximum());
  int stripeCount=0;
  int rowCount=0;
  long currentOffset=-1;
  for (  StripeInformation stripe : reader.getStripes()) {
    stripeCount+=1;
    rowCount+=stripe.getNumberOfRows();
    if (currentOffset < 0) {
      currentOffset=stripe.getOffset() + stripe.getLength();
    }
 else {
      assertEquals(currentOffset,stripe.getOffset());
      currentOffset+=stripe.getLength();
    }
  }
  assertEquals(reader.getNumberOfRows(),rowCount);
  assertEquals(2,stripeCount);
  assertEquals(reader.getContentLength(),currentOffset);
  RecordReader rows=reader.rows();
  assertEquals(0,rows.getRowNumber());
  assertEquals(0.0,rows.getProgress(),0.000001);
  assertEquals(true,rows.hasNext());
  OrcStruct row=(OrcStruct)rows.next(null);
  assertEquals(1,rows.getRowNumber());
  ObjectInspector inspector=reader.getObjectInspector();
  assertEquals("struct<time:timestamp,union:uniontype<int,string>,decimal:decimal(38,18)>",inspector.getTypeName());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-12 15:00:00")),row.getFieldValue(0));
  OrcUnion union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(new IntWritable(42),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("12345678.6547456")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(2,rows.getRowNumber());
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(null,row.getFieldValue(1));
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  union=(OrcUnion)row.getFieldValue(1);
  assertEquals(0,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(null,row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(null,union.getObject());
  assertEquals(null,row.getFieldValue(2));
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("1970-01-01 00:00:00")),row.getFieldValue(0));
  assertEquals(new IntWritable(200000),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("10000000000000000000")),row.getFieldValue(2));
  rand=new Random(42);
  for (int i=1970; i < 2038; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new TimestampWritable(Timestamp.valueOf(i + "-05-05 12:34:56." + i)),row.getFieldValue(0));
    if ((i & 1) == 0) {
      assertEquals(0,union.getTag());
      assertEquals(new IntWritable(i * i),union.getObject());
    }
 else {
      assertEquals(1,union.getTag());
      assertEquals(new Text(Integer.toString(i * i)),union.getObject());
    }
    assertEquals(new HiveDecimalWritable(HiveDecimal.create(new BigInteger(64,rand),rand.nextInt(18))),row.getFieldValue(2));
  }
  for (int i=0; i < 5000; ++i) {
    row=(OrcStruct)rows.next(row);
    assertEquals(new IntWritable(1732050807),union.getObject());
  }
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(0),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(10),union.getObject());
  row=(OrcStruct)rows.next(row);
  assertEquals(new IntWritable(138),union.getObject());
  assertEquals(false,rows.hasNext());
  assertEquals(1.0,rows.getProgress(),0.00001);
  assertEquals(reader.getNumberOfRows(),rows.getRowNumber());
  rows.seekToRow(1);
  row=(OrcStruct)rows.next(row);
  assertEquals(new TimestampWritable(Timestamp.valueOf("2000-03-20 12:00:00.123456789")),row.getFieldValue(0));
  assertEquals(1,union.getTag());
  assertEquals(new Text("hello"),union.getObject());
  assertEquals(new HiveDecimalWritable(HiveDecimal.create("-5643.234")),row.getFieldValue(2));
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test maps and how they interact with the child column. In particular,
 * put nulls between back to back lists and then make some lists that
 * oper lap.
 * @throws Exception
 */
@Test public void testMaps() throws Exception {
  TypeDescription schema=TypeDescription.createStruct().addField("map",TypeDescription.createMap(TypeDescription.createLong(),TypeDescription.createLong()));
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1024;
  MapColumnVector map=(MapColumnVector)batch.cols[0];
  map.noNulls=false;
  for (int r=0; r < 1024; ++r) {
    if (r < 200) {
      map.isNull[r]=true;
    }
 else     if (r < 300) {
      map.offsets[r]=r - 200;
      map.lengths[r]=1;
    }
 else     if (r < 400) {
      map.isNull[r]=true;
    }
 else     if (r < 500) {
      map.offsets[r]=r - 300;
      map.lengths[r]=1;
    }
 else     if (r < 600) {
      map.isNull[r]=true;
    }
 else     if (r < 700) {
      map.offsets[r]=r;
      map.lengths[r]=2;
    }
 else {
      map.isNull[r]=true;
    }
    ((LongColumnVector)map.keys).vector[r]=r;
    ((LongColumnVector)map.values).vector[r]=r * 10;
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf));
  RecordReader rows=reader.rows();
  OrcStruct row=null;
  for (int r=0; r < 1024; ++r) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    Map inner=(Map)row.getFieldValue(0);
    if (r < 200) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 300) {
      assertEquals("row " + r,"{" + (r - 200) + "="+ ((r - 200) * 10)+ "}",inner.toString());
    }
 else     if (r < 400) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 500) {
      assertEquals("row " + r,"{" + (r - 300) + "="+ ((r - 300) * 10)+ "}",inner.toString());
    }
 else     if (r < 600) {
      assertEquals("row " + r,null,inner);
    }
 else     if (r < 700) {
      assertEquals("row " + r,"{" + r + "="+ (r * 10)+ ", "+ (r + 1)+ "="+ (10 * (r + 1))+ "}",inner.toString());
    }
 else {
      assertEquals("row " + r,null,inner);
    }
  }
  assertEquals(false,rows.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyFile() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(false,reader.rows().hasNext());
  assertEquals(CompressionKind.NONE,reader.getCompressionKind());
  assertEquals(0,reader.getNumberOfRows());
  assertEquals(0,reader.getCompressionSize());
  assertEquals(false,reader.getMetadataKeys().iterator().hasNext());
  assertEquals(3,reader.getContentLength());
  assertEquals(false,reader.getStripes().iterator().hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void metaData() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.NONE).bufferSize(100));
  writer.addUserMetadata("my.meta",byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128));
  writer.addUserMetadata("clobber",byteBuf(1,2,3));
  writer.addUserMetadata("clobber",byteBuf(4,3,2,1));
  ByteBuffer bigBuf=ByteBuffer.allocate(40000);
  Random random=new Random(0);
  random.nextBytes(bigBuf.array());
  writer.addUserMetadata("big",bigBuf);
  bigBuf.position(0);
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=1;
  setBigRow(batch,0,true,(byte)127,(short)1024,42,42L * 1024 * 1024* 1024,(float)3.1415,-2.713,null,null,null,null,null);
  writer.addRowBatch(batch);
  writer.addUserMetadata("clobber",byteBuf(5,7,11,13,17,19));
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(byteBuf(5,7,11,13,17,19),reader.getMetadataValue("clobber"));
  assertEquals(byteBuf(1,2,3,4,5,6,7,-1,-2,127,-128),reader.getMetadataValue("my.meta"));
  assertEquals(bigBuf,reader.getMetadataValue("big"));
  try {
    reader.getMetadataValue("unknown");
    assertTrue(false);
  }
 catch (  IllegalArgumentException iae) {
  }
  int i=0;
  for (  String key : reader.getMetadataKeys()) {
    if ("my.meta".equals(key) || "clobber".equals(key) || "big".equals(key)) {
      i+=1;
    }
 else {
      throw new IllegalArgumentException("unknown key " + key);
    }
  }
  assertEquals(3,i);
  int numStripes=reader.getStripeStatistics().size();
  assertEquals(1,numStripes);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Read and write a randomly generated snappy file.
 * @throws Exception
 */
@Test public void testSnappy() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(1000).compress(CompressionKind.SNAPPY).bufferSize(100));
  VectorizedRowBatch batch=schema.createRowBatch();
  Random rand=new Random(12);
  batch.size=1000;
  for (int b=0; b < 10; ++b) {
    for (int r=0; r < 1000; ++r) {
      ((LongColumnVector)batch.cols[0]).vector[r]=rand.nextInt();
      ((BytesColumnVector)batch.cols[1]).setVal(r,Integer.toHexString(rand.nextInt()).getBytes());
    }
    writer.addRowBatch(batch);
  }
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  RecordReader rows=reader.rows();
  rand=new Random(12);
  OrcStruct row=null;
  for (int i=0; i < 10000; ++i) {
    assertEquals(true,rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(rand.nextInt(),((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(rand.nextInt()),row.getFieldValue(1).toString());
  }
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  TypeDescription schema=createBigRowSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(100000).bufferSize(10000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.size=2;
  setBigRow(batch,0,false,(byte)1,(short)1024,65536,Long.MAX_VALUE,(float)1.0,-15.0,bytes(0,1,2,3,4),"hi",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(3,"good"),inner(4,"bad")),map());
  setBigRow(batch,1,true,(byte)100,(short)2048,65536,Long.MAX_VALUE,(float)2.0,-5.0,bytes(),"bye",new MiddleStruct(inner(1,"bye"),inner(2,"sigh")),list(inner(100000000,"cat"),inner(-100000,"in"),inner(1234,"hat")),map(inner(5,"chani"),inner(1,"mauddib")));
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  schema=writer.getSchema();
  assertEquals(23,schema.getMaximumId());
  boolean[] expected=new boolean[]{false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false};
  boolean[] included=OrcUtils.includeColumns("",schema);
  assertEquals(true,Arrays.equals(expected,included));
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertArrayEquals(expected,included);
  expected=new boolean[]{false,true,false,false,false,false,false,false,false,true,true,true,true,true,true,false,false,false,false,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,string1,middle,map",schema);
  assertArrayEquals(expected,included);
  expected=new boolean[]{false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true};
  included=OrcUtils.includeColumns("boolean1,byte1,short1,int1,long1,float1,double1,bytes1,string1,middle,list,map",schema);
  assertEquals(true,Arrays.equals(expected,included));
  ColumnStatistics[] stats=reader.getStatistics();
  assertEquals(2,stats[1].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getFalseCount());
  assertEquals(1,((BooleanColumnStatistics)stats[1]).getTrueCount());
  assertEquals("count: 2 hasNull: false true: 1",stats[1].toString());
  assertEquals(2048,((IntegerColumnStatistics)stats[3]).getMaximum());
  assertEquals(1024,((IntegerColumnStatistics)stats[3]).getMinimum());
  assertEquals(true,((IntegerColumnStatistics)stats[3]).isSumDefined());
  assertEquals(3072,((IntegerColumnStatistics)stats[3]).getSum());
  assertEquals("count: 2 hasNull: false min: 1024 max: 2048 sum: 3072",stats[3].toString());
  StripeStatistics ss=reader.getStripeStatistics().get(0);
  assertEquals(2,ss.getColumnStatistics()[0].getNumberOfValues());
  assertEquals(1,((BooleanColumnStatistics)ss.getColumnStatistics()[1]).getTrueCount());
  assertEquals(1024,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMinimum());
  assertEquals(2048,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getMaximum());
  assertEquals(3072,((IntegerColumnStatistics)ss.getColumnStatistics()[3]).getSum());
  assertEquals(-15.0,((DoubleColumnStatistics)stats[7]).getMinimum());
  assertEquals(-5.0,((DoubleColumnStatistics)stats[7]).getMaximum());
  assertEquals(-20.0,((DoubleColumnStatistics)stats[7]).getSum(),0.00001);
  assertEquals("count: 2 hasNull: false min: -15.0 max: -5.0 sum: -20.0",stats[7].toString());
  assertEquals("count: 2 hasNull: false min: bye max: hi sum: 5",stats[9].toString());
  StructObjectInspector readerInspector=(StructObjectInspector)reader.getObjectInspector();
  assertEquals(ObjectInspector.Category.STRUCT,readerInspector.getCategory());
  assertEquals("struct<boolean1:boolean,byte1:tinyint,short1:smallint," + "int1:int,long1:bigint,float1:float,double1:double,bytes1:" + "binary,string1:string,middle:struct<list:array<struct<int1:int,"+ "string1:string>>>,list:array<struct<int1:int,string1:string>>,"+ "map:map<string,struct<int1:int,string1:string>>>",readerInspector.getTypeName());
  List<? extends StructField> fields=readerInspector.getAllStructFieldRefs();
  BooleanObjectInspector bo=(BooleanObjectInspector)readerInspector.getStructFieldRef("boolean1").getFieldObjectInspector();
  ByteObjectInspector by=(ByteObjectInspector)readerInspector.getStructFieldRef("byte1").getFieldObjectInspector();
  ShortObjectInspector sh=(ShortObjectInspector)readerInspector.getStructFieldRef("short1").getFieldObjectInspector();
  IntObjectInspector in=(IntObjectInspector)readerInspector.getStructFieldRef("int1").getFieldObjectInspector();
  LongObjectInspector lo=(LongObjectInspector)readerInspector.getStructFieldRef("long1").getFieldObjectInspector();
  FloatObjectInspector fl=(FloatObjectInspector)readerInspector.getStructFieldRef("float1").getFieldObjectInspector();
  DoubleObjectInspector dbl=(DoubleObjectInspector)readerInspector.getStructFieldRef("double1").getFieldObjectInspector();
  BinaryObjectInspector bi=(BinaryObjectInspector)readerInspector.getStructFieldRef("bytes1").getFieldObjectInspector();
  StringObjectInspector st=(StringObjectInspector)readerInspector.getStructFieldRef("string1").getFieldObjectInspector();
  StructObjectInspector mid=(StructObjectInspector)readerInspector.getStructFieldRef("middle").getFieldObjectInspector();
  List<? extends StructField> midFields=mid.getAllStructFieldRefs();
  ListObjectInspector midli=(ListObjectInspector)midFields.get(0).getFieldObjectInspector();
  StructObjectInspector inner=(StructObjectInspector)midli.getListElementObjectInspector();
  List<? extends StructField> inFields=inner.getAllStructFieldRefs();
  ListObjectInspector li=(ListObjectInspector)readerInspector.getStructFieldRef("list").getFieldObjectInspector();
  MapObjectInspector ma=(MapObjectInspector)readerInspector.getStructFieldRef("map").getFieldObjectInspector();
  StringObjectInspector mk=(StringObjectInspector)ma.getMapKeyObjectInspector();
  RecordReader rows=reader.rows();
  Object row=rows.next(null);
  assertNotNull(row);
  assertEquals(false,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(1,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(1024,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(1.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-15.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(0,1,2,3,4),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("hi",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  List<?> midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  List<?> list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(2,list.size());
  assertEquals(3,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("good",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(4,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("bad",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  Map<?,?> map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(0,map.size());
  assertEquals(true,rows.hasNext());
  row=rows.next(row);
  assertEquals(true,bo.get(readerInspector.getStructFieldData(row,fields.get(0))));
  assertEquals(100,by.get(readerInspector.getStructFieldData(row,fields.get(1))));
  assertEquals(2048,sh.get(readerInspector.getStructFieldData(row,fields.get(2))));
  assertEquals(65536,in.get(readerInspector.getStructFieldData(row,fields.get(3))));
  assertEquals(Long.MAX_VALUE,lo.get(readerInspector.getStructFieldData(row,fields.get(4))));
  assertEquals(2.0,fl.get(readerInspector.getStructFieldData(row,fields.get(5))),0.00001);
  assertEquals(-5.0,dbl.get(readerInspector.getStructFieldData(row,fields.get(6))),0.00001);
  assertEquals(bytes(),bi.getPrimitiveWritableObject(readerInspector.getStructFieldData(row,fields.get(7))));
  assertEquals("bye",st.getPrimitiveJavaObject(readerInspector.getStructFieldData(row,fields.get(8))));
  midRow=midli.getList(mid.getStructFieldData(readerInspector.getStructFieldData(row,fields.get(9)),midFields.get(0)));
  assertNotNull(midRow);
  assertEquals(2,midRow.size());
  assertEquals(1,in.get(inner.getStructFieldData(midRow.get(0),inFields.get(0))));
  assertEquals("bye",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(0),inFields.get(1))));
  assertEquals(2,in.get(inner.getStructFieldData(midRow.get(1),inFields.get(0))));
  assertEquals("sigh",st.getPrimitiveJavaObject(inner.getStructFieldData(midRow.get(1),inFields.get(1))));
  list=li.getList(readerInspector.getStructFieldData(row,fields.get(10)));
  assertEquals(3,list.size());
  assertEquals(100000000,in.get(inner.getStructFieldData(list.get(0),inFields.get(0))));
  assertEquals("cat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(0),inFields.get(1))));
  assertEquals(-100000,in.get(inner.getStructFieldData(list.get(1),inFields.get(0))));
  assertEquals("in",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(1),inFields.get(1))));
  assertEquals(1234,in.get(inner.getStructFieldData(list.get(2),inFields.get(0))));
  assertEquals("hat",st.getPrimitiveJavaObject(inner.getStructFieldData(list.get(2),inFields.get(1))));
  map=ma.getMap(readerInspector.getStructFieldData(row,fields.get(11)));
  assertEquals(2,map.size());
  boolean[] found=new boolean[2];
  for (  Object key : map.keySet()) {
    String str=mk.getPrimitiveJavaObject(key);
    if (str.equals("chani")) {
      assertEquals(false,found[0]);
      assertEquals(5,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[0]=true;
    }
 else     if (str.equals("mauddib")) {
      assertEquals(false,found[1]);
      assertEquals(1,in.get(inner.getStructFieldData(map.get(key),inFields.get(0))));
      assertEquals(str,st.getPrimitiveJavaObject(inner.getStructFieldData(map.get(key),inFields.get(1))));
      found[1]=true;
    }
 else {
      throw new IllegalArgumentException("Unknown key " + str);
    }
  }
  assertEquals(true,found[0]);
  assertEquals(true,found[1]);
  assertEquals(false,rows.hasNext());
  rows.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPredicatePushdown() throws Exception {
  TypeDescription schema=createInnerSchema();
  Writer writer=OrcFile.createWriter(testFilePath,OrcFile.writerOptions(conf).setSchema(schema).stripeSize(400000L).compress(CompressionKind.NONE).bufferSize(500).rowIndexStride(1000));
  VectorizedRowBatch batch=schema.createRowBatch();
  batch.ensureSize(3500);
  batch.size=3500;
  for (int i=0; i < 3500; ++i) {
    ((LongColumnVector)batch.cols[0]).vector[i]=i * 300;
    ((BytesColumnVector)batch.cols[1]).setVal(i,Integer.toHexString(10 * i).getBytes());
  }
  writer.addRowBatch(batch);
  writer.close();
  Reader reader=OrcFile.createReader(testFilePath,OrcFile.readerOptions(conf).filesystem(fs));
  assertEquals(3500,reader.getNumberOfRows());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().startNot().lessThan("int1",PredicateLeaf.Type.LONG,300000L).end().lessThan("int1",PredicateLeaf.Type.LONG,600000L).end().build();
  RecordReader rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(1000L,rows.getRowNumber());
  OrcStruct row=null;
  for (int i=1000; i < 2000; ++i) {
    assertTrue(rows.hasNext());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
  sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("int1",PredicateLeaf.Type.LONG,0L).end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  assertEquals(3500L,rows.getRowNumber());
  assertTrue(!rows.hasNext());
  sarg=SearchArgumentFactory.newBuilder().startOr().lessThan("int1",PredicateLeaf.Type.LONG,300L * 100).startNot().lessThan("int1",PredicateLeaf.Type.LONG,300L * 3400).end().end().build();
  rows=reader.rowsOptions(new Reader.Options().range(0L,Long.MAX_VALUE).include(new boolean[]{true,true,true}).searchArgument(sarg,new String[]{null,"int1","string1"}));
  row=null;
  for (int i=0; i < 1000; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  for (int i=3000; i < 3500; ++i) {
    assertTrue(rows.hasNext());
    assertEquals(i,rows.getRowNumber());
    row=(OrcStruct)rows.next(row);
    assertEquals(300 * i,((IntWritable)row.getFieldValue(0)).get());
    assertEquals(Integer.toHexString(10 * i),row.getFieldValue(1).toString());
  }
  assertTrue(!rows.hasNext());
  assertEquals(3500,rows.getRowNumber());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestArrayCompatibility </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAvroSingleFieldGroupInList() throws Exception {
  Path test=writeDirect("AvroSingleFieldGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().required(INT64).named("count").named("array").named("single_element_groups").named("AvroSingleFieldGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("single_element_groups",0);
      rc.startGroup();
      rc.startField("array",0);
      rc.startGroup();
      rc.startField("count",0);
      rc.addLong(1234L);
      rc.endField("count",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("count",0);
      rc.addLong(2345L);
      rc.endField("count",0);
      rc.endGroup();
      rc.endField("array",0);
      rc.endGroup();
      rc.endField("single_element_groups",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new LongWritable(1234L)),record(new LongWritable(2345L)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultiFieldGroupInList() throws Exception {
  Path test=writeDirect("MultiFieldGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().required(DOUBLE).named("latitude").required(DOUBLE).named("longitude").named("element").named("locations").named("MultiFieldGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("locations",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(0.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(180.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.endField("locations",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new DoubleWritable(0.0),new DoubleWritable(0.0)),record(new DoubleWritable(0.0),new DoubleWritable(180.0)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHiveRequiredGroupInList() throws Exception {
  Path test=writeDirect("HiveRequiredGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().requiredGroup().required(DOUBLE).named("latitude").required(DOUBLE).named("longitude").named("element").named("bag").named("locations").named("HiveRequiredGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("locations",0);
      rc.startGroup();
      rc.startField("bag",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(180.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(0.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.endField("bag",0);
      rc.endGroup();
      rc.endField("locations",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new DoubleWritable(0.0),new DoubleWritable(180.0)),record(new DoubleWritable(0.0),new DoubleWritable(0.0)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThriftSingleFieldGroupInList() throws Exception {
  Path test=writeDirect("ThriftSingleFieldGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().required(INT64).named("count").named("single_element_groups_tuple").named("single_element_groups").named("ThriftSingleFieldGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("single_element_groups",0);
      rc.startGroup();
      rc.startField("single_element_groups_tuple",0);
      rc.startGroup();
      rc.startField("count",0);
      rc.addLong(1234L);
      rc.endField("count",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("count",0);
      rc.addLong(2345L);
      rc.endField("count",0);
      rc.endGroup();
      rc.endField("single_element_groups_tuple",0);
      rc.endGroup();
      rc.endField("single_element_groups",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new LongWritable(1234L)),record(new LongWritable(2345L)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnannotatedListOfPrimitives() throws Exception {
  MessageType fileSchema=Types.buildMessage().repeated(INT32).named("list_of_ints").named("UnannotatedListOfPrimitives");
  Path test=writeDirect("UnannotatedListOfPrimitives",fileSchema,new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("list_of_ints",0);
      rc.addInteger(34);
      rc.addInteger(35);
      rc.addInteger(36);
      rc.endField("list_of_ints",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(new IntWritable(34),new IntWritable(35),new IntWritable(36));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAmbiguousSingleFieldGroupInList() throws Exception {
  Path test=writeDirect("SingleFieldGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().required(INT64).named("count").named("single_element_group").named("single_element_groups").named("SingleFieldGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("single_element_groups",0);
      rc.startGroup();
      rc.startField("single_element_group",0);
      rc.startGroup();
      rc.startField("count",0);
      rc.addLong(1234L);
      rc.endField("count",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("count",0);
      rc.addLong(2345L);
      rc.endField("count",0);
      rc.endGroup();
      rc.endField("single_element_group",0);
      rc.endGroup();
      rc.endField("single_element_groups",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(new LongWritable(1234L),new LongWritable(2345L));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAvroPrimitiveInList() throws Exception {
  Path test=writeDirect("AvroPrimitiveInList",Types.buildMessage().requiredGroup().as(LIST).repeated(INT32).named("array").named("list_of_ints").named("AvroPrimitiveInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("list_of_ints",0);
      rc.startGroup();
      rc.startField("array",0);
      rc.addInteger(34);
      rc.addInteger(35);
      rc.addInteger(36);
      rc.endField("array",0);
      rc.endGroup();
      rc.endField("list_of_ints",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(new IntWritable(34),new IntWritable(35),new IntWritable(36));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testThriftPrimitiveInList() throws Exception {
  Path test=writeDirect("ThriftPrimitiveInList",Types.buildMessage().requiredGroup().as(LIST).repeated(INT32).named("list_of_ints_tuple").named("list_of_ints").named("ThriftPrimitiveInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("list_of_ints",0);
      rc.startGroup();
      rc.startField("list_of_ints_tuple",0);
      rc.addInteger(34);
      rc.addInteger(35);
      rc.addInteger(36);
      rc.endField("list_of_ints_tuple",0);
      rc.endGroup();
      rc.endField("list_of_ints",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(new IntWritable(34),new IntWritable(35),new IntWritable(36));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNewOptionalGroupInList() throws Exception {
  Path test=writeDirect("NewOptionalGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().optionalGroup().required(DOUBLE).named("latitude").required(DOUBLE).named("longitude").named("element").named("list").named("locations").named("NewOptionalGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("locations",0);
      rc.startGroup();
      rc.startField("list",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(0.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.endGroup();
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(180.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.endField("list",0);
      rc.endGroup();
      rc.endField("locations",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new DoubleWritable(0.0),new DoubleWritable(0.0)),null,record(new DoubleWritable(0.0),new DoubleWritable(180.0)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnannotatedListOfGroups() throws Exception {
  Path test=writeDirect("UnannotatedListOfGroups",Types.buildMessage().repeatedGroup().required(FLOAT).named("x").required(FLOAT).named("y").named("list_of_points").named("UnannotatedListOfGroups"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("list_of_points",0);
      rc.startGroup();
      rc.startField("x",0);
      rc.addFloat(1.0f);
      rc.endField("x",0);
      rc.startField("y",1);
      rc.addFloat(1.0f);
      rc.endField("y",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("x",0);
      rc.addFloat(2.0f);
      rc.endField("x",0);
      rc.startField("y",1);
      rc.addFloat(2.0f);
      rc.endField("y",1);
      rc.endGroup();
      rc.endField("list_of_points",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new FloatWritable(1.0f),new FloatWritable(1.0f)),record(new FloatWritable(2.0f),new FloatWritable(2.0f)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNewRequiredGroupInList() throws Exception {
  Path test=writeDirect("NewRequiredGroupInList",Types.buildMessage().optionalGroup().as(LIST).repeatedGroup().requiredGroup().required(DOUBLE).named("latitude").required(DOUBLE).named("longitude").named("element").named("list").named("locations").named("NewRequiredGroupInList"),new DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("locations",0);
      rc.startGroup();
      rc.startField("list",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(180.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("element",0);
      rc.startGroup();
      rc.startField("latitude",0);
      rc.addDouble(0.0);
      rc.endField("latitude",0);
      rc.startField("longitude",1);
      rc.addDouble(0.0);
      rc.endField("longitude",1);
      rc.endGroup();
      rc.endField("element",0);
      rc.endGroup();
      rc.endField("list",0);
      rc.endGroup();
      rc.endField("locations",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new DoubleWritable(0.0),new DoubleWritable(180.0)),record(new DoubleWritable(0.0),new DoubleWritable(0.0)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestHiveSchemaConverter </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapOriginalType() throws Exception {
  final String hiveColumnTypes="map<string,string>";
  final String hiveColumnNames="mapCol";
  final List<String> columnNames=createHiveColumnsFrom(hiveColumnNames);
  final List<TypeInfo> columnTypes=createHiveTypeInfoFrom(hiveColumnTypes);
  final MessageType messageTypeFound=HiveSchemaConverter.convert(columnNames,columnTypes);
  assertEquals(1,messageTypeFound.getFieldCount());
  org.apache.parquet.schema.Type topLevel=messageTypeFound.getFields().get(0);
  assertEquals("mapCol",topLevel.getName());
  assertEquals(OriginalType.MAP,topLevel.getOriginalType());
  assertEquals(Repetition.OPTIONAL,topLevel.getRepetition());
  assertEquals(1,topLevel.asGroupType().getFieldCount());
  org.apache.parquet.schema.Type secondLevel=topLevel.asGroupType().getFields().get(0);
  assertEquals("map",secondLevel.getName());
  assertEquals(OriginalType.MAP_KEY_VALUE,secondLevel.getOriginalType());
  assertEquals(Repetition.REPEATED,secondLevel.getRepetition());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestMapStructures </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringMapOptionalPrimitive() throws Exception {
  Path test=writeDirect("StringMapOptionalPrimitive",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().required(BINARY).as(UTF8).named("key").optional(INT32).named("value").named("key_value").named("votes").named("StringMapOptionalPrimitive"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("votes",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("lettuce"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(34);
      rc.endField("value",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("kale"));
      rc.endField("key",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("cabbage"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(18);
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("votes",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new Text("lettuce"),new IntWritable(34)),record(new Text("kale"),null),record(new Text("cabbage"),new IntWritable(18)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("votes"),Arrays.asList("map<string,int>"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNestedMap() throws Exception {
  Path test=writeDirect("DoubleMapWithStructValue",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().optional(BINARY).as(UTF8).named("key").optionalGroup().as(MAP).repeatedGroup().optional(BINARY).as(UTF8).named("key").required(INT32).named("value").named("key_value").named("value").named("key_value").named("map_of_maps").named("NestedMap"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("map_of_maps",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("a"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("b"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(1);
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("value",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("b"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("a"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(-1);
      rc.endField("value",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("b"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(-2);
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("map_of_maps",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new Text("a"),record(record(new Text("b"),new IntWritable(1)))),record(new Text("b"),record(record(new Text("a"),new IntWritable(-1)),record(new Text("b"),new IntWritable(-2)))));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("map_of_maps"),Arrays.asList("map<string,map<string,int>>"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringMapOfOptionalArray() throws Exception {
  Path test=writeDirect("StringMapOfOptionalArray",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().required(BINARY).as(UTF8).named("key").optionalGroup().as(LIST).repeatedGroup().optional(BINARY).as(UTF8).named("element").named("list").named("value").named("key_value").named("examples").named("StringMapOfOptionalArray"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("examples",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("green"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.startGroup();
      rc.startField("list",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.addBinary(Binary.fromString("lettuce"));
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("element",0);
      rc.addBinary(Binary.fromString("kale"));
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.endGroup();
      rc.endField("list",0);
      rc.endGroup();
      rc.endField("value",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("brown"));
      rc.endField("key",0);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("examples",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new Text("green"),record(new Text("lettuce"),new Text("kale"),null)),record(new Text("brown"),null));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("examples"),Arrays.asList("map<string,array<string>>"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringMapRequiredPrimitive() throws Exception {
  Path test=writeDirect("StringMapRequiredPrimitive",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().required(BINARY).as(UTF8).named("key").required(INT32).named("value").named("key_value").named("votes").named("StringMapRequiredPrimitive"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("votes",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("lettuce"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(34);
      rc.endField("value",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("cabbage"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addInteger(18);
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("votes",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new Text("lettuce"),new IntWritable(34)),record(new Text("cabbage"),new IntWritable(18)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("votes"),Arrays.asList("map<string,int>"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleMapWithStructValue() throws Exception {
  Path test=writeDirect("DoubleMapWithStructValue",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().optional(DOUBLE).named("key").optionalGroup().required(INT32).named("x").required(INT32).named("y").named("value").named("key_value").named("approx").named("DoubleMapWithStructValue"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("approx",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addDouble(3.14);
      rc.endField("key",0);
      rc.startField("value",1);
      rc.startGroup();
      rc.startField("x",0);
      rc.addInteger(7);
      rc.endField("x",0);
      rc.startField("y",1);
      rc.addInteger(22);
      rc.endField("y",1);
      rc.endGroup();
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("approx",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new DoubleWritable(3.14),record(new IntWritable(7),new IntWritable(22))));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("approx"),Arrays.asList("map<bigint,struct<x:int,y:int>>"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStringMapOfOptionalIntArray() throws Exception {
  Path test=writeDirect("StringMapOfOptionalIntArray",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().required(BINARY).as(UTF8).named("key").optionalGroup().as(LIST).repeatedGroup().optional(INT32).named("element").named("list").named("value").named("key_value").named("examples").named("StringMapOfOptionalIntArray"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("examples",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("low"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.startGroup();
      rc.startField("list",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.addInteger(34);
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("element",0);
      rc.addInteger(35);
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.endGroup();
      rc.endField("list",0);
      rc.endGroup();
      rc.endField("value",1);
      rc.endGroup();
      rc.startGroup();
      rc.startField("key",0);
      rc.addBinary(Binary.fromString("high"));
      rc.endField("key",0);
      rc.startField("value",1);
      rc.startGroup();
      rc.startField("list",0);
      rc.startGroup();
      rc.startField("element",0);
      rc.addInteger(340);
      rc.endField("element",0);
      rc.endGroup();
      rc.startGroup();
      rc.startField("element",0);
      rc.addInteger(360);
      rc.endField("element",0);
      rc.endGroup();
      rc.endField("list",0);
      rc.endGroup();
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("examples",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(new Text("low"),record(new IntWritable(34),new IntWritable(35),null)),record(new Text("high"),record(new IntWritable(340),new IntWritable(360))));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("examples"),Arrays.asList("map<string,array<int>>"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMapWithComplexKey() throws Exception {
  Path test=writeDirect("MapWithComplexKey",Types.buildMessage().optionalGroup().as(MAP).repeatedGroup().requiredGroup().required(INT32).named("x").required(INT32).named("y").named("key").optional(DOUBLE).named("value").named("key_value").named("matrix").named("MapWithComplexKey"),new TestArrayCompatibility.DirectWriter(){
    @Override public void write(    RecordConsumer rc){
      rc.startMessage();
      rc.startField("matrix",0);
      rc.startGroup();
      rc.startField("key_value",0);
      rc.startGroup();
      rc.startField("key",0);
      rc.startGroup();
      rc.startField("x",0);
      rc.addInteger(7);
      rc.endField("x",0);
      rc.startField("y",1);
      rc.addInteger(22);
      rc.endField("y",1);
      rc.endGroup();
      rc.endField("key",0);
      rc.startField("value",1);
      rc.addDouble(3.14);
      rc.endField("value",1);
      rc.endGroup();
      rc.endField("key_value",0);
      rc.endGroup();
      rc.endField("matrix",0);
      rc.endMessage();
    }
  }
);
  ArrayWritable expected=list(record(record(new IntWritable(7),new IntWritable(22)),new DoubleWritable(3.14)));
  List<ArrayWritable> records=read(test);
  Assert.assertEquals("Should have only one record",1,records.size());
  assertEquals("Should match expected record",expected,records.get(0));
  deserialize(records.get(0),Arrays.asList("matrix"),Arrays.asList("map<struct<x:int,y:int>,bigint>"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestParquetRecordReaderWrapper </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBuilderComplexTypes2() throws Exception {
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("x",PredicateLeaf.Type.DATE,Date.valueOf("2005-3-12")).lessThanEquals("y",PredicateLeaf.Type.STRING,new HiveChar("hi",10).toString()).equals("z",PredicateLeaf.Type.DECIMAL,new HiveDecimalWritable("1.0")).end().build();
  MessageType schema=MessageTypeParser.parseMessageType("message test {" + " required int32 x; required binary y; required binary z;}");
  assertEquals("lteq(y, Binary{\"hi        \"})",ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema).toString());
  sarg=SearchArgumentFactory.newBuilder().startNot().startOr().isNull("x",PredicateLeaf.Type.LONG).between("y",PredicateLeaf.Type.DECIMAL,new HiveDecimalWritable("10"),new HiveDecimalWritable("20.0")).in("z",PredicateLeaf.Type.LONG,1L,2L,3L).nullSafeEquals("a",PredicateLeaf.Type.STRING,new HiveVarchar("stinger",100).toString()).end().end().build();
  schema=MessageTypeParser.parseMessageType("message test {" + " optional int32 x; required binary y; required int32 z;" + " optional binary a;}");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(and(not(eq(x, null)), not(or(or(eq(z, 1), eq(z, 2)), eq(z, 3)))), " + "not(eq(a, Binary{\"stinger\"})))";
  assertEquals(expected,p.toString());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBuilderComplexTypes() throws Exception {
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("x",PredicateLeaf.Type.DATE,Date.valueOf("1970-1-11")).lessThanEquals("y",PredicateLeaf.Type.STRING,new HiveChar("hi",10).toString()).equals("z",PredicateLeaf.Type.DECIMAL,new HiveDecimalWritable("1.0")).end().build();
  MessageType schema=MessageTypeParser.parseMessageType("message test {" + " required int32 x; required binary y; required binary z;}");
  assertEquals("lteq(y, Binary{\"hi        \"})",ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema).toString());
  sarg=SearchArgumentFactory.newBuilder().startNot().startOr().isNull("x",PredicateLeaf.Type.LONG).between("y",PredicateLeaf.Type.DECIMAL,new HiveDecimalWritable("10"),new HiveDecimalWritable("20.0")).in("z",PredicateLeaf.Type.LONG,1L,2L,3L).nullSafeEquals("a",PredicateLeaf.Type.STRING,new HiveVarchar("stinger",100).toString()).end().end().build();
  schema=MessageTypeParser.parseMessageType("message test {" + " optional int32 x; required binary y; required int32 z;" + " optional binary a;}");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(and(not(eq(x, null)), not(or(or(eq(z, 1), eq(z, 2)), eq(z, 3)))), " + "not(eq(a, Binary{\"stinger\"})))";
  assertEquals(expected,p.toString());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBuilder() throws Exception {
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startNot().startOr().isNull("x",PredicateLeaf.Type.LONG).between("y",PredicateLeaf.Type.LONG,10L,20L).in("z",PredicateLeaf.Type.LONG,1L,2L,3L).nullSafeEquals("a",PredicateLeaf.Type.STRING,"stinger").end().end().build();
  MessageType schema=MessageTypeParser.parseMessageType("message test {" + " optional int32 x; required int32 y; required int32 z;" + " optional binary a;}");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(and(and(not(eq(x, null)), not(and(lt(y, 20), not(lteq(y, 10))))), not(or(or(eq(z, 1), " + "eq(z, 2)), eq(z, 3)))), not(eq(a, Binary{\"stinger\"})))";
  assertEquals(expected,p.toString());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBuilderFloat() throws Exception {
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("x",PredicateLeaf.Type.LONG,22L).lessThan("x1",PredicateLeaf.Type.LONG,22L).lessThanEquals("y",PredicateLeaf.Type.STRING,new HiveChar("hi",10).toString()).equals("z",PredicateLeaf.Type.FLOAT,new Double(0.22)).equals("z1",PredicateLeaf.Type.FLOAT,new Double(0.22)).end().build();
  MessageType schema=MessageTypeParser.parseMessageType("message test {" + " required int32 x; required int32 x1;" + " required binary y; required float z; required float z1;}");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(and(and(and(lt(x, 22), lt(x1, 22))," + " lteq(y, Binary{\"hi        \"})), eq(z, " + "0.22)), eq(z1, 0.22))";
  assertEquals(expected,p.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.TestParquetRowGroupFilter </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRowGroupFilterTakeEffect() throws Exception {
  columnNames="intCol";
  columnTypes="int";
  StructObjectInspector inspector=getObjectInspector(columnNames,columnTypes);
  MessageType fileSchema=MessageTypeParser.parseMessageType("message hive_schema {\n" + "  optional int32 intCol;\n" + "}\n");
  conf.set(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR,"intCol");
  conf.set("columns","intCol");
  conf.set("columns.types","int");
  Path testPath=writeDirect("RowGroupFilterTakeEffect",fileSchema,new DirectWriter(){
    @Override public void write(    RecordConsumer consumer){
      for (int i=0; i < 100; i++) {
        consumer.startMessage();
        consumer.startField("int",0);
        consumer.addInteger(i);
        consumer.endField("int",0);
        consumer.endMessage();
      }
    }
  }
);
  GenericUDF udf=new GenericUDFOPGreaterThan();
  List<ExprNodeDesc> children=Lists.newArrayList();
  ExprNodeColumnDesc columnDesc=new ExprNodeColumnDesc(Integer.class,"intCol","T",false);
  ExprNodeConstantDesc constantDesc=new ExprNodeConstantDesc(50);
  children.add(columnDesc);
  children.add(constantDesc);
  ExprNodeGenericFuncDesc genericFuncDesc=new ExprNodeGenericFuncDesc(inspector,udf,children);
  String searchArgumentStr=SerializationUtilities.serializeExpression(genericFuncDesc);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,searchArgumentStr);
  ParquetRecordReaderWrapper recordReader=(ParquetRecordReaderWrapper)new MapredParquetInputFormat().getRecordReader(new FileSplit(testPath,0,fileLength(testPath),(String[])null),conf,null);
  Assert.assertEquals("row group is not filtered correctly",1,recordReader.getFiltedBlocks().size());
  constantDesc=new ExprNodeConstantDesc(100);
  children.set(1,constantDesc);
  genericFuncDesc=new ExprNodeGenericFuncDesc(inspector,udf,children);
  searchArgumentStr=SerializationUtilities.serializeExpression(genericFuncDesc);
  conf.set(TableScanDesc.FILTER_EXPR_CONF_STR,searchArgumentStr);
  recordReader=(ParquetRecordReaderWrapper)new MapredParquetInputFormat().getRecordReader(new FileSplit(testPath,0,fileLength(testPath),(String[])null),conf,null);
  Assert.assertEquals("row group is not filtered correctly",0,recordReader.getFiltedBlocks().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.parquet.read.TestParquetFilterPredicate </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterColumnsThatDoNoExistOnSchema(){
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 a; required binary stinger; }");
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startNot().startOr().isNull("a",PredicateLeaf.Type.LONG).between("y",PredicateLeaf.Type.LONG,10L,20L).in("z",PredicateLeaf.Type.LONG,1L,2L,3L).nullSafeEquals("a",PredicateLeaf.Type.STRING,"stinger").end().end().build();
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(not(eq(a, null)), not(eq(a, Binary{\"stinger\"})))";
  assertEquals(expected,p.toString());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterFloatColumns(){
  MessageType schema=MessageTypeParser.parseMessageType("message test {  required float a; required int32 b; }");
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startNot().startOr().isNull("a",PredicateLeaf.Type.FLOAT).between("a",PredicateLeaf.Type.FLOAT,10.2,20.3).in("b",PredicateLeaf.Type.LONG,1L,2L,3L).end().end().build();
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(and(not(eq(a, null)), not(and(lt(a, 20.3), not(lteq(a, 10.2))))), not(or(or(eq(b, 1), eq(b, 2)), eq(b, 3))))";
  assertEquals(expected,p.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.sarg.TestConvertAstToSearchArg </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestBigintSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQFi6QAAAWJpZ29y4wECb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5zZXJkZT" + "IudHlwZWluZm8uUHJpbWl0aXZlVHlwZUluZu8BAWJpZ2lu9AEDb3JnLmFwYWNoZS5oYWRvb3AuaGl2Z"+ "S5xbC5wbGFuLkV4cHJOb2RlQ29uc3RhbnREZXPjAQECBwnywAEBBG9yZy5hcGFjaGUuaGFkb29wLmhp"+ "dmUucWwudWRmLmdlbmVyaWMuR2VuZXJpY1VERk9QRXF1YewBAAABgj0BRVFVQcwBBW9yZy5hcGFjaGU"+ "uaGFkb29wLmlvLkJvb2xlYW5Xcml0YWJs5QEAAAECAQFib29sZWHu";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals("(EQUALS bi 12345)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression7() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                      <void property=\"children\"> \n"+ "                       <object class=\"java.util.ArrayList\"> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                          <void property=\"column\"> \n"+ "                           <string>id</string> \n"+ "                          </void> \n"+ "                          <void property=\"tabAlias\"> \n"+ "                           <string>orc_people</string> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                            <void property=\"typeName\"> \n"+ "                             <string>int</string> \n"+ "                            </void> \n"+ "                           </object> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                          <void property=\"value\"> \n"+ "                           <int>10</int> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"genericUDF\"> \n"+ "                       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                        <void property=\"typeName\"> \n"+ "                         <string>boolean</string> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                      <void property=\"children\"> \n"+ "                       <object class=\"java.util.ArrayList\"> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                          <void property=\"column\"> \n"+ "                           <string>id</string> \n"+ "                          </void> \n"+ "                          <void property=\"tabAlias\"> \n"+ "                           <string>orc_people</string> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                          <void property=\"value\"> \n"+ "                           <int>11</int> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"genericUDF\"> \n"+ "                       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                      <void property=\"column\"> \n"+ "                       <string>id</string> \n"+ "                      </void> \n"+ "                      <void property=\"tabAlias\"> \n"+ "                       <string>orc_people</string> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <int>12</int> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                      <void property=\"children\"> \n"+ "                       <object class=\"java.util.ArrayList\"> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                          <void property=\"column\"> \n"+ "                           <string>id</string> \n"+ "                          </void> \n"+ "                          <void property=\"tabAlias\"> \n"+ "                           <string>orc_people</string> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                          <void property=\"value\"> \n"+ "                           <int>13</int> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"genericUDF\"> \n"+ "                       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                      <void property=\"children\"> \n"+ "                       <object class=\"java.util.ArrayList\"> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                          <void property=\"column\"> \n"+ "                           <string>id</string> \n"+ "                          </void> \n"+ "                          <void property=\"tabAlias\"> \n"+ "                           <string>orc_people</string> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                          </void> \n"+ "                          <void property=\"value\"> \n"+ "                           <int>14</int> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"genericUDF\"> \n"+ "                       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                      <void property=\"column\"> \n"+ "                       <string>id</string> \n"+ "                      </void> \n"+ "                      <void property=\"tabAlias\"> \n"+ "                       <string>orc_people</string> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <int>15</int> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>id</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                  <void property=\"value\"> \n"+ "                   <int>16</int> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>id</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                  <void property=\"value\"> \n"+ "                   <int>17</int> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "          <void property=\"column\"> \n"+ "           <string>id</string> \n"+ "          </void> \n"+ "          <void property=\"tabAlias\"> \n"+ "           <string>orc_people</string> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <int>18</int> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "  </void> \n"+ " </object>\n"+ "</java>";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(9,leaves.size());
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(and(and(and(and(and(and(and(and(and(and(and(and(and(and(and(and(" + "or(or(or(lt(id, 18), lt(id, 10)), lt(id, 13)), lt(id, 16)), " + "or(or(or(lt(id, 18), lt(id, 11)), lt(id, 13)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 12)), lt(id, 13)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 10)), lt(id, 14)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 11)), lt(id, 14)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 12)), lt(id, 14)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 10)), lt(id, 15)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 11)), lt(id, 15)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 12)), lt(id, 15)), lt(id, 16))), "+ "or(or(or(lt(id, 18), lt(id, 10)), lt(id, 13)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 11)), lt(id, 13)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 12)), lt(id, 13)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 10)), lt(id, 14)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 11)), lt(id, 14)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 12)), lt(id, 14)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 10)), lt(id, 15)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 11)), lt(id, 15)), lt(id, 17))), "+ "or(or(or(lt(id, 18), lt(id, 12)), lt(id, 15)), lt(id, 17)))";
  assertEquals(p.toString(),expected);
  PredicateLeaf leaf=leaves.get(0);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(18L,leaf.getLiteral());
  leaf=leaves.get(1);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(10L,leaf.getLiteral());
  leaf=leaves.get(2);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(13L,leaf.getLiteral());
  leaf=leaves.get(3);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(16L,leaf.getLiteral());
  leaf=leaves.get(4);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(11L,leaf.getLiteral());
  leaf=leaves.get(5);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(12L,leaf.getLiteral());
  leaf=leaves.get(6);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(14L,leaf.getLiteral());
  leaf=leaves.get(7);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(15L,leaf.getLiteral());
  leaf=leaves.get(8);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(17L,leaf.getLiteral());
  assertEquals("(and" + " (or leaf-0 leaf-1 leaf-2 leaf-3)" + " (or leaf-0 leaf-4 leaf-2 leaf-3)"+ " (or leaf-0 leaf-5 leaf-2 leaf-3)"+ " (or leaf-0 leaf-1 leaf-6 leaf-3)"+ " (or leaf-0 leaf-4 leaf-6 leaf-3)"+ " (or leaf-0 leaf-5 leaf-6 leaf-3)"+ " (or leaf-0 leaf-1 leaf-7 leaf-3)"+ " (or leaf-0 leaf-4 leaf-7 leaf-3)"+ " (or leaf-0 leaf-5 leaf-7 leaf-3)"+ " (or leaf-0 leaf-1 leaf-2 leaf-8)"+ " (or leaf-0 leaf-4 leaf-2 leaf-8)"+ " (or leaf-0 leaf-5 leaf-2 leaf-8)"+ " (or leaf-0 leaf-1 leaf-6 leaf-8)"+ " (or leaf-0 leaf-4 leaf-6 leaf-8)"+ " (or leaf-0 leaf-5 leaf-6 leaf-8)"+ " (or leaf-0 leaf-1 leaf-7 leaf-8)"+ " (or leaf-0 leaf-4 leaf-7 leaf-8)"+ " (or leaf-0 leaf-5 leaf-7 leaf-8))",sarg.getExpression().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestDoubleSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQFkYuwAAAFiaWdvcuMBAm9yZy5hcGFjaGUuaGFkb29wLmhpdmUuc2VyZG" + "UyLnR5cGVpbmZvLlByaW1pdGl2ZVR5cGVJbmbvAQFkb3VibOUBA29yZy5hcGFjaGUuaGFkb29wLmhpd"+ "mUucWwucGxhbi5FeHByTm9kZUNvbnN0YW50RGVz4wEBAgcKQAGZmZmZmZoBBG9yZy5hcGFjaGUuaGFk"+ "b29wLmhpdmUucWwudWRmLmdlbmVyaWMuR2VuZXJpY1VERk9QRXF1YewBAAABgj0BRVFVQcwBBW9yZy5"+ "hcGFjaGUuaGFkb29wLmlvLkJvb2xlYW5Xcml0YWJs5QEAAAECAQFib29sZWHu";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.FLOAT,leaf.getType());
  assertEquals("(EQUALS dbl 2.2)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression10() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "          <void property=\"column\"> \n"+ "           <string>id</string> \n"+ "          </void> \n"+ "          <void property=\"tabAlias\"> \n"+ "           <string>orc_people</string> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "            <void property=\"typeName\"> \n"+ "             <string>int</string> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <int>10</int> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "        <void property=\"typeName\"> \n"+ "         <string>boolean</string> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>id</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>10</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNot\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "  </void> \n"+ " </object> \n"+ "</java>";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(1,leaves.size());
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(not(lt(id, 10)), not(lt(id, 10)))";
  assertEquals(expected,p.toString());
  assertEquals(PredicateLeaf.Type.LONG,leaves.get(0).getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaves.get(0).getOperator());
  assertEquals("id",leaves.get(0).getColumnName());
  assertEquals(10L,leaves.get(0).getLiteral());
  assertEquals("(and (not leaf-0) (not leaf-0))",sarg.getExpression().toString());
  assertNoSharedNodes(sarg.getExpression(),Sets.<ExpressionTree>newIdentityHashSet());
  assertEquals(TruthValue.NO,sarg.evaluate(values(TruthValue.YES)));
  assertEquals(TruthValue.YES,sarg.evaluate(values(TruthValue.NO)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NULL)));
  assertEquals(TruthValue.NO_NULL,sarg.evaluate(values(TruthValue.YES_NULL)));
  assertEquals(TruthValue.YES_NULL,sarg.evaluate(values(TruthValue.NO_NULL)));
  assertEquals(TruthValue.YES_NO,sarg.evaluate(values(TruthValue.YES_NO)));
  assertEquals(TruthValue.YES_NO_NULL,sarg.evaluate(values(TruthValue.YES_NO_NULL)));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression4() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>id</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                <void property=\"typeName\"> \n"+ "                 <string>int</string> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>12</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotEqual\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "            <void property=\"typeName\"> \n"+ "             <string>boolean</string> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>first_name</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object id=\"PrimitiveTypeInfo2\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                <void property=\"typeName\"> \n"+ "                 <string>string</string> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <string>john</string> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <string>sue</string> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFIn\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "          <void property=\"column\"> \n"+ "           <string>id</string> \n"+ "          </void> \n"+ "          <void property=\"tabAlias\"> \n"+ "           <string>orc_people</string> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <int>34</int> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <int>50</int> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFIn\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "  </void> \n"+ " </object> \n"+ "</java> \n"+ "\n";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(3,leaves.size());
  String[] conditions=new String[]{"not(eq(id, 12))","or(eq(first_name, Binary{\"john\"}), eq(first_name, Binary{\"sue\"}))","or(eq(id, 34), eq(id, 50))"};
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected=String.format("and(and(%1$s, %2$s), %3$s)",conditions);
  assertEquals(expected,p.toString());
  PredicateLeaf leaf=leaves.get(0);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.EQUALS,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(12L,leaf.getLiteral());
  leaf=leaves.get(1);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.IN,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("john",leaf.getLiteralList().get(0));
  assertEquals("sue",leaf.getLiteralList().get(1));
  leaf=leaves.get(2);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.IN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(34L,leaf.getLiteralList().get(0));
  assertEquals(50L,leaf.getLiteralList().get(1));
  assertEquals("(and (not leaf-0) leaf-1 leaf-2)",sarg.getExpression().toString());
  assertNoSharedNodes(sarg.getExpression(),Sets.<ExpressionTree>newIdentityHashSet());
  assertEquals(TruthValue.YES,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.YES)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NULL,TruthValue.YES,TruthValue.YES)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.NULL,TruthValue.YES)));
  assertEquals(TruthValue.NO,sarg.evaluate(values(TruthValue.YES,TruthValue.YES,TruthValue.YES)));
  assertEquals(TruthValue.NO,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.NO)));
  assertEquals(TruthValue.NO,sarg.evaluate(values(TruthValue.NO,TruthValue.YES_NULL,TruthValue.NO)));
  assertEquals(TruthValue.NO_NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.NULL,TruthValue.YES_NO_NULL)));
  assertEquals(TruthValue.NO_NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.NO_NULL)));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestBooleanSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVHZW5lcmljRnVuY0Rlc+MBAQABAgECb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5xbC5wbGFuLk" + "V4cHJOb2RlQ29sdW1uRGVz4wEBYrEAAAFib29sb3LjAQNvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnNlc"+ "mRlMi50eXBlaW5mby5QcmltaXRpdmVUeXBlSW5m7wEBYm9vbGVh7gEEb3JnLmFwYWNoZS5oYWRvb3Au"+ "aGl2ZS5xbC5wbGFuLkV4cHJOb2RlQ29uc3RhbnREZXPjAQEDCQUBAQVvcmcuYXBhY2hlLmhhZG9vcC5"+ "oaXZlLnFsLnVkZi5nZW5lcmljLkdlbmVyaWNVREZPUEVxdWHsAQAAAYI9AUVRVUHMAQZvcmcuYXBhY2"+ "hlLmhhZG9vcC5pby5Cb29sZWFuV3JpdGFibOUBAAABAwkBAgEBYrIAAAgBAwkBB29yZy5hcGFjaGUua"+ "GFkb29wLmhpdmUucWwudWRmLmdlbmVyaWMuR2VuZXJpY1VERk9QQW7kAQEGAQAAAQMJ";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("(and leaf-0 leaf-1)",sarg.getExpression().toString());
  assertEquals(2,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.BOOLEAN,leaf.getType());
  assertEquals("(EQUALS b1 true)",leaf.toString());
  leaf=sarg.getLeaves().get(1);
  assertEquals(PredicateLeaf.Type.BOOLEAN,leaf.getType());
  assertEquals("(EQUALS b2 true)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestDateSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQFk9AAAAWJpZ29y4wECb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5zZXJkZT" + "IudHlwZWluZm8uUHJpbWl0aXZlVHlwZUluZu8BAWRhdOUBA29yZy5hcGFjaGUuaGFkb29wLmhpdmUuc"+ "WwucGxhbi5FeHByTm9kZUNvbnN0YW50RGVz4wEBAgEBc3RyaW7nAwEyMDE1LTA1LTC1AQRvcmcuYXBh"+ "Y2hlLmhhZG9vcC5oaXZlLnFsLnVkZi5nZW5lcmljLkdlbmVyaWNVREZPUEVxdWHsAQAAAYI9AUVRVUH"+ "MAQVvcmcuYXBhY2hlLmhhZG9vcC5pby5Cb29sZWFuV3JpdGFibOUBAAABAgEBYm9vbGVh7g==";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.DATE,leaf.getType());
  assertEquals("(EQUALS dt 2015-05-05)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestCharSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQFj6AAAAWJpZ29y4wECb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5zZXJkZT" + "IudHlwZWluZm8uQ2hhclR5cGVJbmbvARQBY2hh8gEDb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5xbC5wb"+ "GFuLkV4cHJOb2RlQ29uc3RhbnREZXPjAQEEb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5zZXJkZTIudHlw"+ "ZWluZm8uUHJpbWl0aXZlVHlwZUluZu8BAXN0cmlu5wMBY2hhciAgICAgoAEFb3JnLmFwYWNoZS5oYWR"+ "vb3AuaGl2ZS5xbC51ZGYuZ2VuZXJpYy5HZW5lcmljVURGT1BFcXVh7AEAAAGCPQFFUVVBzAEGb3JnLm"+ "FwYWNoZS5oYWRvb3AuaW8uQm9vbGVhbldyaXRhYmzlAQAAAQQBAWJvb2xlYe4=";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals("(EQUALS ch char      )",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestDecimalSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQFkZeMAAAFiaWdvcuMBAm9yZy5hcGFjaGUuaGFkb29wLmhpdmUuc2VyZG" + "UyLnR5cGVpbmZvLkRlY2ltYWxUeXBlSW5m7wEUAAFkZWNpbWHsAQNvcmcuYXBhY2hlLmhhZG9vcC5oa"+ "XZlLnFsLnBsYW4uRXhwck5vZGVDb25zdGFudERlc+MBAQRvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnNl"+ "cmRlMi50eXBlaW5mby5QcmltaXRpdmVUeXBlSW5m7wEBaW70AvYBAQVvcmcuYXBhY2hlLmhhZG9vcC5"+ "oaXZlLnFsLnVkZi5nZW5lcmljLkdlbmVyaWNVREZPUEVxdWHsAQAAAYI9AUVRVUHMAQZvcmcuYXBhY2"+ "hlLmhhZG9vcC5pby5Cb29sZWFuV3JpdGFibOUBAAABBAEBYm9vbGVh7g==";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.DECIMAL,leaf.getType());
  assertEquals("(EQUALS dec 123)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestVarcharSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQF24wAAAWJpZ29y4wECb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5zZXJkZT" + "IudHlwZWluZm8uVmFyY2hhclR5cGVJbmbvAcgBAXZhcmNoYfIBA29yZy5hcGFjaGUuaGFkb29wLmhpd"+ "mUucWwucGxhbi5FeHByTm9kZUNvbnN0YW50RGVz4wEBBG9yZy5hcGFjaGUuaGFkb29wLmhpdmUuc2Vy"+ "ZGUyLnR5cGVpbmZvLlByaW1pdGl2ZVR5cGVJbmbvAQFzdHJpbucDAXZhcmlhYmzlAQVvcmcuYXBhY2h"+ "lLmhhZG9vcC5oaXZlLnFsLnVkZi5nZW5lcmljLkdlbmVyaWNVREZPUEVxdWHsAQAAAYI9AUVRVUHMAQ"+ "ZvcmcuYXBhY2hlLmhhZG9vcC5pby5Cb29sZWFuV3JpdGFibOUBAAABBAEBYm9vbGVh7g==";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals("(EQUALS vc variable)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression5() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>first_name</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                <void property=\"typeName\"> \n"+ "                 <string>string</string> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <string>owen</string> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "            <void property=\"typeName\"> \n"+ "             <string>boolean</string> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <string>foobar</string> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>last_name</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                    <void property=\"typeName\"> \n"+ "                     <string>int</string> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"value\"> \n"+ "                   <int>4</int> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge\"> \n"+ "                <void property=\"udfClassName\"> \n"+ "                 <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> \n"+ "                </void> \n"+ "                <void property=\"udfName\"> \n"+ "                 <string>substr</string> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <boolean>false</boolean> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "          <void property=\"column\"> \n"+ "           <string>first_name</string> \n"+ "          </void> \n"+ "          <void property=\"tabAlias\"> \n"+ "           <string>orc_people</string> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <string>david</string> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <string>greg</string> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBetween\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "  </void> \n"+ " </object> \n"+ "</java> \n";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(1,leaves.size());
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected="and(lt(first_name, Binary{\"greg\"}), not(lteq(first_name, Binary{\"david\"})))";
  assertEquals(p.toString(),expected);
  assertEquals(PredicateLeaf.Type.STRING,leaves.get(0).getType());
  assertEquals(PredicateLeaf.Operator.BETWEEN,leaves.get(0).getOperator());
  assertEquals("first_name",leaves.get(0).getColumnName());
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertNoSharedNodes(sarg.getExpression(),Sets.<ExpressionTree>newIdentityHashSet());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestTimestampSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLn" + "BsYW4uRXhwck5vZGVDb2x1bW5EZXPjAQF08wAAAWJpZ29y4wECb3JnLmFwYWNoZS5o" + "YWRvb3AuaGl2ZS5zZXJkZTIudHlwZWluZm8uUHJpbWl0aXZlVHlwZUluZu8BAXRpbW"+ "VzdGFt8AEDb3JnLmFwYWNoZS5oYWRvb3AuaGl2ZS5xbC5wbGFuLkV4cHJOb2RlQ29u"+ "c3RhbnREZXPjAQECAQFzdHJpbucDATIwMTUtMDMtMTcgMTI6MzQ6NbYBBG9yZy5hcG"+ "FjaGUuaGFkb29wLmhpdmUucWwudWRmLmdlbmVyaWMuR2VuZXJpY1VERk9QRXF1YewB"+ "AAABgj0BRVFVQcwBBW9yZy5hcGFjaGUuaGFkb29wLmlvLkJvb2xlYW5Xcml0YWJs5Q"+ "EAAAECAQFib29sZWHu";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.TIMESTAMP,leaf.getType());
  assertEquals("(EQUALS ts 2015-03-17 12:34:56.0)",leaf.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression2() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>first_name</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                    <void property=\"typeName\"> \n"+ "                     <string>string</string> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                <void property=\"typeName\"> \n"+ "                 <string>boolean</string> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>first_name</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                  <void property=\"value\"> \n"+ "                   <string>sue</string> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNotEqual\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>id</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object id=\"PrimitiveTypeInfo2\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                <void property=\"typeName\"> \n"+ "                 <string>int</string> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>12</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrGreaterThan\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "          <void property=\"column\"> \n"+ "           <string>id</string> \n"+ "          </void> \n"+ "          <void property=\"tabAlias\"> \n"+ "           <string>orc_people</string> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <int>4</int> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualOrLessThan\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "  </void> \n"+ " </object> \n"+ "</java> \n";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(4,leaves.size());
  String[] conditions=new String[]{"eq(first_name, null)","not(eq(first_name, Binary{\"sue\"}))","not(lt(id, 12))","lteq(id, 4)"};
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected=String.format("or(or(or(%1$s, %2$s), %3$s), %4$s)",conditions);
  assertEquals(expected,p.toString());
  PredicateLeaf leaf=leaves.get(0);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.IS_NULL,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals(null,leaf.getLiteral());
  assertEquals(null,leaf.getLiteralList());
  leaf=leaves.get(1);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.EQUALS,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("sue",leaf.getLiteral());
  leaf=leaves.get(2);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(12L,leaf.getLiteral());
  leaf=leaves.get(3);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN_EQUALS,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(4L,leaf.getLiteral());
  assertEquals("(or leaf-0 (not leaf-1) (not leaf-2) leaf-3)",sarg.getExpression().toString());
  assertNoSharedNodes(sarg.getExpression(),Sets.<ExpressionTree>newIdentityHashSet());
  assertEquals(TruthValue.NO,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.YES,TruthValue.NO)));
  assertEquals(TruthValue.YES,sarg.evaluate(values(TruthValue.YES,TruthValue.YES,TruthValue.YES,TruthValue.NO)));
  assertEquals(TruthValue.YES,sarg.evaluate(values(TruthValue.NO,TruthValue.NO,TruthValue.YES,TruthValue.NO)));
  assertEquals(TruthValue.YES,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.NO,TruthValue.NO)));
  assertEquals(TruthValue.YES,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.YES,TruthValue.YES)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NULL,TruthValue.YES,TruthValue.YES,TruthValue.NO)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.NULL,TruthValue.YES,TruthValue.NO)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.NULL,TruthValue.NO)));
  assertEquals(TruthValue.NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.YES,TruthValue.YES,TruthValue.NULL)));
  assertEquals(TruthValue.YES_NO,sarg.evaluate(values(TruthValue.NO,TruthValue.YES_NO,TruthValue.YES,TruthValue.YES_NO)));
  assertEquals(TruthValue.NO_NULL,sarg.evaluate(values(TruthValue.NO,TruthValue.YES_NULL,TruthValue.YES,TruthValue.NO_NULL)));
  assertEquals(TruthValue.YES_NULL,sarg.evaluate(values(TruthValue.YES_NULL,TruthValue.YES_NO_NULL,TruthValue.YES,TruthValue.NULL)));
  assertEquals(TruthValue.YES_NO_NULL,sarg.evaluate(values(TruthValue.NO_NULL,TruthValue.YES_NO_NULL,TruthValue.YES,TruthValue.NO)));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression3() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                        <void property=\"typeName\"> \n"+ "                         <string>boolean</string> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <boolean>false</boolean> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                      <void property=\"column\"> \n"+ "                       <string>id</string> \n"+ "                      </void> \n"+ "                      <void property=\"tabAlias\"> \n"+ "                       <string>orc_people</string> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                        <void property=\"typeName\"> \n"+ "                         <string>int</string> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <int>23</int> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <int>45</int> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBetween\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                      <void property=\"column\"> \n"+ "                       <string>first_name</string> \n"+ "                      </void> \n"+ "                      <void property=\"tabAlias\"> \n"+ "                       <string>orc_people</string> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object id=\"PrimitiveTypeInfo2\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                        <void property=\"typeName\"> \n"+ "                         <string>string</string> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <string>alan</string> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <string>xxxxx</string> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <int>3</int> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge\"> \n"+ "                    <void property=\"udfClassName\"> \n"+ "                     <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> \n"+ "                    </void> \n"+ "                    <void property=\"udfName\"> \n"+ "                     <string>substr</string> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>first_name</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <string>smith</string> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>last_name</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>first_name</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>3</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge\"> \n"+ "            <void property=\"udfClassName\"> \n"+ "             <string>org.apache.hadoop.hive.ql.udf.UDFSubstr</string> \n"+ "            </void> \n"+ "            <void property=\"udfName\"> \n"+ "             <string>substr</string> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <string>yyy</string> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "  </void> \n"+ " </object> \n"+ "</java> \n";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(3,leaves.size());
  String[] conditions=new String[]{"lt(id, 45)","not(lteq(id, 23))","eq(first_name, Binary{\"alan\"})","eq(last_name, Binary{\"smith\"})"};
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; required binary last_name;}");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String expected=String.format("and(and(and(%1$s, %2$s), %3$s), %4$s)",conditions);
  assertEquals(expected,p.toString());
  PredicateLeaf leaf=leaves.get(0);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.BETWEEN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(null,leaf.getLiteral());
  assertEquals(23L,leaf.getLiteralList().get(0));
  assertEquals(45L,leaf.getLiteralList().get(1));
  leaf=leaves.get(1);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.EQUALS,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("alan",leaf.getLiteral());
  leaf=leaves.get(2);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.EQUALS,leaf.getOperator());
  assertEquals("last_name",leaf.getColumnName());
  assertEquals("smith",leaf.getLiteral());
  assertEquals("(and leaf-0 leaf-1 leaf-2)",sarg.getExpression().toString());
  assertNoSharedNodes(sarg.getExpression(),Sets.<ExpressionTree>newIdentityHashSet());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpression8() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "      <void property=\"column\"> \n"+ "       <string>first_name</string> \n"+ "      </void> \n"+ "      <void property=\"tabAlias\"> \n"+ "       <string>orc_people</string> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "        <void property=\"typeName\"> \n"+ "         <string>string</string> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "      <void property=\"column\"> \n"+ "       <string>last_name</string> \n"+ "      </void> \n"+ "      <void property=\"tabAlias\"> \n"+ "       <string>orc_people</string> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "    <void property=\"typeName\"> \n"+ "     <string>boolean</string> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ " </object> \n"+ "</java> ";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(0,leaves.size());
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  assertNull(p);
  assertEquals("YES_NO_NULL",sarg.getExpression().toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression9() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "      <void property=\"column\"> \n"+ "       <string>id</string> \n"+ "      </void> \n"+ "      <void property=\"tabAlias\"> \n"+ "       <string>orc_people</string> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "        <void property=\"typeName\"> \n"+ "         <string>int</string> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>1</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>3</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge\"> \n"+ "            <void property=\"operator\"> \n"+ "             <boolean>true</boolean> \n"+ "            </void> \n"+ "            <void property=\"udfClassName\"> \n"+ "             <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> \n"+ "            </void> \n"+ "            <void property=\"udfName\"> \n"+ "             <string>+</string> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "          </void> \n"+ "          <void property=\"value\"> \n"+ "           <int>4</int> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge\"> \n"+ "        <void property=\"operator\"> \n"+ "         <boolean>true</boolean> \n"+ "        </void> \n"+ "        <void property=\"udfClassName\"> \n"+ "         <string>org.apache.hadoop.hive.ql.udf.UDFOPPlus</string> \n"+ "        </void> \n"+ "        <void property=\"udfName\"> \n"+ "         <string>+</string> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "    <void property=\"typeName\"> \n"+ "     <string>boolean</string> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ " </object> \n"+ "</java> ";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(0,leaves.size());
  assertEquals("YES_NO_NULL",sarg.getExpression().toString());
  assertEquals(TruthValue.YES_NO_NULL,sarg.evaluate(values()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExpression1() throws Exception {
  String exprStr="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n" + "<java version=\"1.6.0_31\" class=\"java.beans.XMLDecoder\"> \n" + " <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "  <void property=\"children\"> \n"+ "   <object class=\"java.util.ArrayList\"> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                      <void property=\"children\"> \n"+ "                       <object class=\"java.util.ArrayList\"> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                          <void property=\"children\"> \n"+ "                           <object class=\"java.util.ArrayList\"> \n"+ "                            <void method=\"add\"> \n"+ "                             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                              <void property=\"children\"> \n"+ "                               <object class=\"java.util.ArrayList\"> \n"+ "                                <void method=\"add\"> \n"+ "                                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                                  <void property=\"column\"> \n"+ "                                   <string>first_name</string> \n"+ "                                  </void> \n"+ "                                  <void property=\"tabAlias\"> \n"+ "                                   <string>orc_people</string> \n"+ "                                  </void> \n"+ "                                  <void property=\"typeInfo\"> \n"+ "                                   <object id=\"PrimitiveTypeInfo0\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                                    <void property=\"typeName\"> \n"+ "                                     <string>string</string> \n"+ "                                    </void> \n"+ "                                   </object> \n"+ "                                  </void> \n"+ "                                 </object> \n"+ "                                </void> \n"+ "                                <void method=\"add\"> \n"+ "                                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                                  <void property=\"typeInfo\"> \n"+ "                                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                                  </void> \n"+ "                                  <void property=\"value\"> \n"+ "                                   <string>john</string> \n"+ "                                  </void> \n"+ "                                 </object> \n"+ "                                </void> \n"+ "                               </object> \n"+ "                              </void> \n"+ "                              <void property=\"genericUDF\"> \n"+ "                               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqual\"/> \n"+ "                              </void> \n"+ "                              <void property=\"typeInfo\"> \n"+ "                               <object id=\"PrimitiveTypeInfo1\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                                <void property=\"typeName\"> \n"+ "                                 <string>boolean</string> \n"+ "                                </void> \n"+ "                               </object> \n"+ "                              </void> \n"+ "                             </object> \n"+ "                            </void> \n"+ "                            <void method=\"add\"> \n"+ "                             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                              <void property=\"children\"> \n"+ "                               <object class=\"java.util.ArrayList\"> \n"+ "                                <void method=\"add\"> \n"+ "                                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                                  <void property=\"typeInfo\"> \n"+ "                                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                                  </void> \n"+ "                                  <void property=\"value\"> \n"+ "                                   <string>greg</string> \n"+ "                                  </void> \n"+ "                                 </object> \n"+ "                                </void> \n"+ "                                <void method=\"add\"> \n"+ "                                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                                  <void property=\"column\"> \n"+ "                                   <string>first_name</string> \n"+ "                                  </void> \n"+ "                                  <void property=\"tabAlias\"> \n"+ "                                   <string>orc_people</string> \n"+ "                                  </void> \n"+ "                                  <void property=\"typeInfo\"> \n"+ "                                   <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                                  </void> \n"+ "                                 </object> \n"+ "                                </void> \n"+ "                               </object> \n"+ "                              </void> \n"+ "                              <void property=\"genericUDF\"> \n"+ "                               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                              </void> \n"+ "                              <void property=\"typeInfo\"> \n"+ "                               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                              </void> \n"+ "                             </object> \n"+ "                            </void> \n"+ "                           </object> \n"+ "                          </void> \n"+ "                          <void property=\"genericUDF\"> \n"+ "                           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                          <void property=\"children\"> \n"+ "                           <object class=\"java.util.ArrayList\"> \n"+ "                            <void method=\"add\"> \n"+ "                             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                              <void property=\"typeInfo\"> \n"+ "                               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                              </void> \n"+ "                              <void property=\"value\"> \n"+ "                               <string>alan</string> \n"+ "                              </void> \n"+ "                             </object> \n"+ "                            </void> \n"+ "                            <void method=\"add\"> \n"+ "                             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                              <void property=\"column\"> \n"+ "                               <string>first_name</string> \n"+ "                              </void> \n"+ "                              <void property=\"tabAlias\"> \n"+ "                               <string>orc_people</string> \n"+ "                              </void> \n"+ "                              <void property=\"typeInfo\"> \n"+ "                               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "                              </void> \n"+ "                             </object> \n"+ "                            </void> \n"+ "                           </object> \n"+ "                          </void> \n"+ "                          <void property=\"genericUDF\"> \n"+ "                           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan\"/> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"genericUDF\"> \n"+ "                       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                      <void property=\"children\"> \n"+ "                       <object class=\"java.util.ArrayList\"> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                          <void property=\"column\"> \n"+ "                           <string>id</string> \n"+ "                          </void> \n"+ "                          <void property=\"tabAlias\"> \n"+ "                           <string>orc_people</string> \n"+ "                          </void> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object id=\"PrimitiveTypeInfo2\" class=\"org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo\"> \n"+ "                            <void property=\"typeName\"> \n"+ "                             <string>int</string> \n"+ "                            </void> \n"+ "                           </object> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                        <void method=\"add\"> \n"+ "                         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                          <void property=\"typeInfo\"> \n"+ "                           <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                          </void> \n"+ "                          <void property=\"value\"> \n"+ "                           <int>12</int> \n"+ "                          </void> \n"+ "                         </object> \n"+ "                        </void> \n"+ "                       </object> \n"+ "                      </void> \n"+ "                      <void property=\"genericUDF\"> \n"+ "                       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan\"/> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "                  <void property=\"children\"> \n"+ "                   <object class=\"java.util.ArrayList\"> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                      </void> \n"+ "                      <void property=\"value\"> \n"+ "                       <int>13</int> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                    <void method=\"add\"> \n"+ "                     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                      <void property=\"column\"> \n"+ "                       <string>id</string> \n"+ "                      </void> \n"+ "                      <void property=\"tabAlias\"> \n"+ "                       <string>orc_people</string> \n"+ "                      </void> \n"+ "                      <void property=\"typeInfo\"> \n"+ "                       <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                      </void> \n"+ "                     </object> \n"+ "                    </void> \n"+ "                   </object> \n"+ "                  </void> \n"+ "                  <void property=\"genericUDF\"> \n"+ "                   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "              <void property=\"children\"> \n"+ "               <object class=\"java.util.ArrayList\"> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "                  <void property=\"column\"> \n"+ "                   <string>id</string> \n"+ "                  </void> \n"+ "                  <void property=\"tabAlias\"> \n"+ "                   <string>orc_people</string> \n"+ "                  </void> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "                <void method=\"add\"> \n"+ "                 <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "                  <void property=\"typeInfo\"> \n"+ "                   <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "                  </void> \n"+ "                  <void property=\"value\"> \n"+ "                   <int>15</int> \n"+ "                  </void> \n"+ "                 </object> \n"+ "                </void> \n"+ "               </object> \n"+ "              </void> \n"+ "              <void property=\"genericUDF\"> \n"+ "               <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPLessThan\"/> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>16</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>id</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPGreaterThan\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "    <void method=\"add\"> \n"+ "     <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "      <void property=\"children\"> \n"+ "       <object class=\"java.util.ArrayList\"> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>id</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo2\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <int>30</int> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualNS\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "        <void method=\"add\"> \n"+ "         <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc\"> \n"+ "          <void property=\"children\"> \n"+ "           <object class=\"java.util.ArrayList\"> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc\"> \n"+ "              <void property=\"column\"> \n"+ "               <string>first_name</string> \n"+ "              </void> \n"+ "              <void property=\"tabAlias\"> \n"+ "               <string>orc_people</string> \n"+ "              </void> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "            <void method=\"add\"> \n"+ "             <object class=\"org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc\"> \n"+ "              <void property=\"typeInfo\"> \n"+ "               <object idref=\"PrimitiveTypeInfo0\"/> \n"+ "              </void> \n"+ "              <void property=\"value\"> \n"+ "               <string>owen</string> \n"+ "              </void> \n"+ "             </object> \n"+ "            </void> \n"+ "           </object> \n"+ "          </void> \n"+ "          <void property=\"genericUDF\"> \n"+ "           <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPEqualNS\"/> \n"+ "          </void> \n"+ "          <void property=\"typeInfo\"> \n"+ "           <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "          </void> \n"+ "         </object> \n"+ "        </void> \n"+ "       </object> \n"+ "      </void> \n"+ "      <void property=\"genericUDF\"> \n"+ "       <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPAnd\"/> \n"+ "      </void> \n"+ "      <void property=\"typeInfo\"> \n"+ "       <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "      </void> \n"+ "     </object> \n"+ "    </void> \n"+ "   </object> \n"+ "  </void> \n"+ "  <void property=\"genericUDF\"> \n"+ "   <object class=\"org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPOr\"/> \n"+ "  </void> \n"+ "  <void property=\"typeInfo\"> \n"+ "   <object idref=\"PrimitiveTypeInfo1\"/> \n"+ "  </void> \n"+ " </object> \n"+ "</java> \n";
  SearchArgumentImpl sarg=(SearchArgumentImpl)ConvertAstToSearchArg.create(getFuncDesc(exprStr));
  List<PredicateLeaf> leaves=sarg.getLeaves();
  assertEquals(9,leaves.size());
  MessageType schema=MessageTypeParser.parseMessageType("message test { required int32 id;" + " required binary first_name; }");
  FilterPredicate p=ParquetFilterPredicateConverter.toFilterPredicate(sarg,schema);
  String[] conditions=new String[]{"eq(first_name, Binary{\"john\"})","not(lteq(first_name, Binary{\"greg\"}))","lt(first_name, Binary{\"alan\"})","not(lteq(id, 12))","not(lteq(id, 13))","lt(id, 15)","lt(id, 16)","eq(id, 30)","eq(first_name, Binary{\"owen\"})"};
  String expected=String.format("and(or(or(or(or(or(or(or(%1$s, %2$s), %3$s), %4$s), %5$s), %6$s), %7$s), %8$s), " + "or(or(or(or(or(or(or(%1$s, %2$s), %3$s), %4$s), %5$s), %6$s), %7$s), %9$s))",conditions);
  assertEquals(expected,p.toString());
  PredicateLeaf leaf=leaves.get(0);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.EQUALS,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("john",leaf.getLiteral());
  leaf=leaves.get(1);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN_EQUALS,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("greg",leaf.getLiteral());
  leaf=leaves.get(2);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("alan",leaf.getLiteral());
  leaf=leaves.get(3);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN_EQUALS,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(12L,leaf.getLiteral());
  leaf=leaves.get(4);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN_EQUALS,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(13L,leaf.getLiteral());
  leaf=leaves.get(5);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(15L,leaf.getLiteral());
  leaf=leaves.get(6);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.LESS_THAN,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(16L,leaf.getLiteral());
  leaf=leaves.get(7);
  assertEquals(PredicateLeaf.Type.LONG,leaf.getType());
  assertEquals(PredicateLeaf.Operator.NULL_SAFE_EQUALS,leaf.getOperator());
  assertEquals("id",leaf.getColumnName());
  assertEquals(30L,leaf.getLiteral());
  leaf=leaves.get(8);
  assertEquals(PredicateLeaf.Type.STRING,leaf.getType());
  assertEquals(PredicateLeaf.Operator.NULL_SAFE_EQUALS,leaf.getOperator());
  assertEquals("first_name",leaf.getColumnName());
  assertEquals("owen",leaf.getLiteral());
  assertEquals("(and (or leaf-0 (not leaf-1) leaf-2 (not leaf-3)" + " (not leaf-4) leaf-5 leaf-6 leaf-7)" + " (or leaf-0 (not leaf-1) leaf-2 (not leaf-3)"+ " (not leaf-4) leaf-5 leaf-6 leaf-8))",sarg.getExpression().toString());
  assertNoSharedNodes(sarg.getExpression(),Sets.<ExpressionTree>newIdentityHashSet());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void TestFloatSarg() throws Exception {
  String serialAst="AQEAamF2YS51dGlsLkFycmF5TGlz9AECAQFvcmcuYXBhY2hlLmhhZG9vcC5oaXZlLnFsLnBsYW4uRXh" + "wck5vZGVDb2x1bW5EZXPjAQFmbPQAAAFiaWdvcuMBAm9yZy5hcGFjaGUuaGFkb29wLmhpdmUuc2VyZG" + "UyLnR5cGVpbmZvLlByaW1pdGl2ZVR5cGVJbmbvAQFmbG9h9AEDb3JnLmFwYWNoZS5oYWRvb3AuaGl2Z"+ "S5xbC5wbGFuLkV4cHJOb2RlQ29uc3RhbnREZXPjAQECBwQ/jMzNAQRvcmcuYXBhY2hlLmhhZG9vcC5o"+ "aXZlLnFsLnVkZi5nZW5lcmljLkdlbmVyaWNVREZPUEVxdWHsAQAAAYI9AUVRVUHMAQVvcmcuYXBhY2h"+ "lLmhhZG9vcC5pby5Cb29sZWFuV3JpdGFibOUBAAABAgEBYm9vbGVh7g==";
  SearchArgument sarg=new ConvertAstToSearchArg(SerializationUtilities.deserializeExpression(serialAst)).buildSearchArgument();
  assertEquals("leaf-0",sarg.getExpression().toString());
  assertEquals(1,sarg.getLeaves().size());
  PredicateLeaf leaf=sarg.getLeaves().get(0);
  assertEquals(PredicateLeaf.Type.FLOAT,leaf.getType());
  assertEquals("(EQUALS flt 1.1)",leaf.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.io.sarg.TestSearchArgumentImpl </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimestampSerialization() throws Exception {
  Timestamp now=new Timestamp(new java.util.Date().getTime());
  SearchArgument sarg=SearchArgumentFactory.newBuilder().startAnd().lessThan("x",PredicateLeaf.Type.TIMESTAMP,now).end().build();
  String serializedSarg=TestInputOutputFormat.toKryo(sarg);
  SearchArgument sarg2=ConvertAstToSearchArg.create(serializedSarg);
  Field literalField=PredicateLeafImpl.class.getDeclaredField("literal");
  literalField.setAccessible(true);
  assertTrue(literalField.get(sarg2.getLeaves().get(0)) instanceof java.util.Date);
  Timestamp ts=(Timestamp)sarg2.getLeaves().get(0).getLiteral();
  assertEquals(ts,now);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.TestDbTxnManager </h4><pre class="type-11 type-10 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  TxnDbUtil.prepDb();
  txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  txnMgr.getLockManager();
  Assert.assertTrue(txnMgr instanceof DbTxnManager);
  nextInput=1;
  readEntities=new HashSet<ReadEntity>();
  writeEntities=new HashSet<WriteEntity>();
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TIMEDOUT_TXN_REAPER_START,0,TimeUnit.SECONDS);
  conf.setTimeVar(HiveConf.ConfVars.HIVE_TXN_TIMEOUT,1,TimeUnit.SECONDS);
  houseKeeperService=new AcidHouseKeeperService();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.TestDbTxnManager2 </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDummyTxnManagerOnAcidTable() throws Exception {
  CommandProcessorResponse cpr=driver.run("create table T10 (a int, b int) clustered by(b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')");
  checkCmdOnDriver(cpr);
  cpr=driver.run("create table T11 (a int, b int) clustered by(b) into 2 buckets stored as orc");
  checkCmdOnDriver(cpr);
  conf.setVar(HiveConf.ConfVars.HIVE_TXN_MANAGER,"org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager");
  txnMgr=SessionState.get().initTxnMgr(conf);
  Assert.assertTrue(txnMgr instanceof DummyTxnManager);
  cpr=driver.compileAndRespond("select * from T10");
  Assert.assertEquals(ErrorMsg.TXNMGR_NOT_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("This command is not allowed on an ACID table"));
  cpr=driver.compileAndRespond("insert into table T10 values (1, 2)");
  Assert.assertEquals(ErrorMsg.TXNMGR_NOT_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("This command is not allowed on an ACID table"));
  cpr=driver.compileAndRespond("insert overwrite table T10 select a, b from T11");
  Assert.assertEquals(ErrorMsg.NO_INSERT_OVERWRITE_WITH_ACID.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("INSERT OVERWRITE not allowed on table with OutputFormat" + " that implements AcidOutputFormat while transaction manager that supports ACID is in use"));
  cpr=driver.compileAndRespond("update T10 set a=0 where b=1");
  Assert.assertEquals(ErrorMsg.ACID_OP_ON_NONACID_TXNMGR.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("Attempt to do update or delete using transaction manager that does not support these operations."));
  cpr=driver.compileAndRespond("delete from T10");
  Assert.assertEquals(ErrorMsg.ACID_OP_ON_NONACID_TXNMGR.getErrorCode(),cpr.getResponseCode());
  Assert.assertTrue(cpr.getErrorMessage().contains("Attempt to do update or delete using transaction manager that does not support these operations."));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLockRetryLimit() throws Exception {
  conf.setIntVar(HiveConf.ConfVars.HIVE_LOCK_NUMRETRIES,2);
  conf.setBoolVar(HiveConf.ConfVars.TXN_MGR_DUMP_LOCK_STATE_ON_ACQUIRE_TIMEOUT,true);
  HiveTxnManager otherTxnMgr=new DbTxnManager();
  ((DbTxnManager)otherTxnMgr).setHiveConf(conf);
  CommandProcessorResponse cpr=driver.run("create table T9(a int)");
  checkCmdOnDriver(cpr);
  cpr=driver.compileAndRespond("select * from T9");
  checkCmdOnDriver(cpr);
  txnMgr.acquireLocks(driver.getPlan(),ctx,"Vincent Vega");
  List<ShowLocksResponseElement> locks=getLocks(txnMgr);
  Assert.assertEquals("Unexpected lock count",1,locks.size());
  checkLock(LockType.SHARED_READ,LockState.ACQUIRED,"default","T9",null,locks.get(0));
  cpr=driver.compileAndRespond("drop table T9");
  checkCmdOnDriver(cpr);
  try {
    otherTxnMgr.acquireLocks(driver.getPlan(),ctx,"Winston Winnfield");
  }
 catch (  LockException ex) {
    Assert.assertEquals("Got wrong lock exception",ErrorMsg.LOCK_ACQUIRE_TIMEDOUT,ex.getCanonicalErrorMsg());
  }
  locks=getLocks(txnMgr);
  Assert.assertEquals("Unexpected lock count",1,locks.size());
  checkLock(LockType.SHARED_READ,LockState.ACQUIRED,"default","T9",null,locks.get(0));
  otherTxnMgr.closeTxnManager();
}

</code></pre>

<br>
<pre class="type-11 type-10 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  SessionState.start(conf);
  ctx=new Context(conf);
  driver=new Driver(conf);
  driver.init();
  TxnDbUtil.cleanDb();
  TxnDbUtil.prepDb();
  txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  Assert.assertTrue(txnMgr instanceof DbTxnManager);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.TestDummyTxnManager </h4><pre class="type-11 type-10 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  conf.setBoolVar(HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY,true);
  conf.setVar(HiveConf.ConfVars.HIVE_TXN_MANAGER,DummyTxnManager.class.getName());
  SessionState.start(conf);
  ctx=new Context(conf);
  txnMgr=TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
  Assert.assertTrue(txnMgr instanceof DummyTxnManager);
  Field field=DummyTxnManager.class.getDeclaredField("lockMgr");
  field.setAccessible(true);
  field.set(txnMgr,mockLockManager);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDedupLockObjects(){
  List<HiveLockObj> lockObjs=new ArrayList<HiveLockObj>();
  String path1="path1";
  String path2="path2";
  HiveLockObjectData lockData1=new HiveLockObjectData("query1","1","IMPLICIT","drop table table1");
  HiveLockObjectData lockData2=new HiveLockObjectData("query1","1","IMPLICIT","drop table table1");
  lockObjs.add(new HiveLockObj(new HiveLockObject(path1,lockData1),HiveLockMode.SHARED));
  String name1=lockObjs.get(lockObjs.size() - 1).getName();
  lockObjs.add(new HiveLockObj(new HiveLockObject(path1,lockData1),HiveLockMode.EXCLUSIVE));
  lockObjs.add(new HiveLockObj(new HiveLockObject(path2,lockData2),HiveLockMode.SHARED));
  String name2=lockObjs.get(lockObjs.size() - 1).getName();
  lockObjs.add(new HiveLockObj(new HiveLockObject(path2,lockData2),HiveLockMode.SHARED));
  lockObjs.add(new HiveLockObj(new HiveLockObject(path2,lockData2),HiveLockMode.SHARED));
  DummyTxnManager.dedupLockObjects(lockObjs);
  Assert.assertEquals("Locks should be deduped",2,lockObjs.size());
  Comparator<HiveLockObj> cmp=new Comparator<HiveLockObj>(){
    @Override public int compare(    HiveLockObj lock1,    HiveLockObj lock2){
      return lock1.getName().compareTo(lock2.getName());
    }
  }
;
  Collections.sort(lockObjs,cmp);
  HiveLockObj lockObj=lockObjs.get(0);
  Assert.assertEquals(name1,lockObj.getName());
  Assert.assertEquals(HiveLockMode.EXCLUSIVE,lockObj.getMode());
  lockObj=lockObjs.get(1);
  Assert.assertEquals(name2,lockObj.getName());
  Assert.assertEquals(HiveLockMode.SHARED,lockObj.getMode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.lockmgr.zookeeper.TestZookeeperLockManager </h4><pre class="type-11 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteNoChildren() throws Exception {
  client.create().creatingParentsIfNeeded().forPath(TABLE_LOCK_PATH,lockObjData.toString().getBytes());
  byte[] data=client.getData().forPath(TABLE_LOCK_PATH);
  Assert.assertArrayEquals(lockObjData.toString().getBytes(),data);
  ZooKeeperHiveLockManager.unlockPrimitive(zLock,PARENT,client);
  try {
    data=client.getData().forPath(TABLE_LOCK_PATH);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertEquals(e instanceof KeeperException.NoNodeException,true);
  }
  try {
    data=client.getData().forPath(PARENT_LOCK_PATH);
    Assert.fail();
  }
 catch (  Exception e) {
    Assert.assertEquals(e instanceof KeeperException.NoNodeException,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.TestGenMapRedUtilsUsePartitionColumnsPositive </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUsePartitionColumns(){
  Properties p=new Properties();
  p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS,inPartColNames);
  p.setProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES,inPartColTypes);
  GenMapRedUtils.usePartitionColumns(p,Arrays.asList(partNamesToRetain.split(",")));
  String actualNames=p.getProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS);
  String actualTypes=p.getProperty(hive_metastoreConstants.META_TABLE_PARTITION_COLUMN_TYPES);
  assertEquals(expectedPartColNames,actualNames);
  assertEquals(expectedPartColTypes,actualTypes);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.listbucketingpruner.TestDynamicMultiDimeCollection </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFlat1() throws SemanticException {
  List<List<String>> uniqSkewedElements=new ArrayList<List<String>>();
  List<String> v1=Arrays.asList("1","2");
  List<String> v2=Arrays.asList("3","4");
  uniqSkewedElements.add(v1);
  uniqSkewedElements.add(v2);
  List<List<String>> actual=ListBucketingPruner.DynamicMultiDimensionalCollection.flat(uniqSkewedElements);
  List<List<String>> expected=new ArrayList<List<String>>();
  v1=Arrays.asList("1","3");
  v2=Arrays.asList("1","4");
  List<String> v3=Arrays.asList("2","3");
  List<String> v4=Arrays.asList("2","4");
  expected.add(v1);
  expected.add(v2);
  expected.add(v3);
  expected.add(v4);
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUniqueElementsList2(){
  List<List<String>> values=new ArrayList<List<String>>();
  List<String> v1=Arrays.asList("1","a","x");
  values.add(v1);
  List<List<String>> actuals=ListBucketingPruner.DynamicMultiDimensionalCollection.uniqueElementsList(values,DEF_DIR);
  List<List<String>> expecteds=new ArrayList<List<String>>();
  v1=Arrays.asList("1","default");
  List<String> v2=Arrays.asList("a","default");
  List<String> v3=Arrays.asList("x","default");
  expecteds.add(v1);
  expecteds.add(v2);
  expecteds.add(v3);
  Assert.assertEquals(expecteds,actuals);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUniqueElementsList3(){
  List<List<String>> values=new ArrayList<List<String>>();
  List<String> v1=Arrays.asList("1");
  List<String> v2=Arrays.asList("2");
  List<String> v3=Arrays.asList("3");
  List<String> v4=Arrays.asList("4");
  values.add(v1);
  values.add(v2);
  values.add(v3);
  values.add(v4);
  List<List<String>> actuals=ListBucketingPruner.DynamicMultiDimensionalCollection.uniqueElementsList(values,DEF_DIR);
  List<List<String>> expecteds=new ArrayList<List<String>>();
  v1=Arrays.asList("1","2","3","4","default");
  expecteds.add(v1);
  Assert.assertEquals(expecteds,actuals);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUniqueElementsList1(){
  List<List<String>> values=new ArrayList<List<String>>();
  List<String> v1=Arrays.asList("1","a","x");
  List<String> v2=Arrays.asList("2","b","x");
  List<String> v3=Arrays.asList("1","c","x");
  List<String> v4=Arrays.asList("2","a","y");
  values.add(v1);
  values.add(v2);
  values.add(v3);
  values.add(v4);
  List<List<String>> actuals=ListBucketingPruner.DynamicMultiDimensionalCollection.uniqueElementsList(values,DEF_DIR);
  List<List<String>> expecteds=new ArrayList<List<String>>();
  v1=Arrays.asList("1","2","default");
  v2=Arrays.asList("a","b","c","default");
  v3=Arrays.asList("x","y","default");
  expecteds.add(v1);
  expecteds.add(v2);
  expecteds.add(v3);
  Assert.assertEquals(expecteds,actuals);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFlat2() throws SemanticException {
  List<List<String>> uniqSkewedElements=new ArrayList<List<String>>();
  List<String> v1=Arrays.asList("1","2");
  uniqSkewedElements.add(v1);
  List<List<String>> actual=ListBucketingPruner.DynamicMultiDimensionalCollection.flat(uniqSkewedElements);
  List<List<String>> expected=new ArrayList<List<String>>();
  v1=Arrays.asList("1");
  List<String> v2=Arrays.asList("2");
  expected.add(v1);
  expected.add(v2);
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testFlat3() throws SemanticException {
  List<List<String>> uniqSkewedElements=new ArrayList<List<String>>();
  List<String> v1=Arrays.asList("1","2","default");
  List<String> v2=Arrays.asList("a","b","c","default");
  List<String> v3=Arrays.asList("x","y","default");
  uniqSkewedElements.add(v1);
  uniqSkewedElements.add(v2);
  uniqSkewedElements.add(v3);
  List<List<String>> actuals=ListBucketingPruner.DynamicMultiDimensionalCollection.flat(uniqSkewedElements);
  Assert.assertTrue(actuals.size() == 36);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.optimizer.ppr.TestPositivePartitionPrunerCompactExpr </h4><pre class="type-11 type-12 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactExpr(){
  ExprNodeDesc actual=PartitionPruner.compactExpr(expression);
  if (expected == null) {
    assertNull(actual);
  }
 else {
    assertNotNull("Expected not NULL expression",actual);
    assertNotNull("Expected not NULL expression string",actual.getExprString());
    assertEquals(expected,actual.getExprString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestColumnAccess </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinTable1AndTable2() throws ParseException {
  String query="select * from t1 join t2 on (t1.id1 = t2.id1)";
  Driver driver=createDriver();
  int rc=driver.compile(query);
  Assert.assertEquals("Checking command success",0,rc);
  QueryPlan plan=driver.getPlan();
  ColumnAccessInfo columnAccessInfo=plan.getColumnAccessInfo();
  List<String> cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  Map<String,List<String>> tableColsMap=getColsFromReadEntity(plan.getInputs());
  cols=tableColsMap.get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=tableColsMap.get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryTable1() throws ParseException {
  String query="select * from t1";
  Driver driver=createDriver();
  int rc=driver.compile(query);
  Assert.assertEquals("Checking command success",0,rc);
  QueryPlan plan=driver.getPlan();
  ColumnAccessInfo columnAccessInfo=plan.getColumnAccessInfo();
  List<String> cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  Map<String,List<String>> tableColsMap=getColsFromReadEntity(plan.getInputs());
  cols=tableColsMap.get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJoinView1AndTable2() throws ParseException {
  String query="select * from v1 join t2 on (v1.id1 = t2.id1)";
  Driver driver=createDriver();
  int rc=driver.compile(query);
  Assert.assertEquals("Checking command success",0,rc);
  QueryPlan plan=driver.getPlan();
  ColumnAccessInfo columnAccessInfo=plan.getColumnAccessInfo();
  List<String> cols=columnAccessInfo.getTableToColumnAccessMap().get("default@v1");
  Assert.assertNull(cols);
  cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=columnAccessInfo.getTableToColumnAccessMap().get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  Map<String,List<String>> tableColsMap=getColsFromReadEntity(plan.getInputs());
  cols=tableColsMap.get("default@v1");
  Assert.assertNull(cols);
  cols=tableColsMap.get("default@t1");
  Assert.assertNotNull(cols);
  Assert.assertEquals(2,cols.size());
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
  cols=tableColsMap.get("default@t2");
  Assert.assertNotNull(cols);
  Assert.assertEquals(3,cols.size());
  Assert.assertNotNull(cols.contains("id2"));
  Assert.assertNotNull(cols.contains("id1"));
  Assert.assertNotNull(cols.contains("name1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestHiveDecimalParse </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimalType2() throws ParseException {
  String query="create table dec (d decimal(9,7))";
  String type=getColumnType(query);
  Assert.assertEquals("decimal(9,7)",type);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimalType1() throws ParseException {
  String query="create table dec (d decimal(5))";
  String type=getColumnType(query);
  Assert.assertEquals("decimal(5,0)",type);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimalType() throws ParseException {
  String query="create table dec (d decimal)";
  String type=getColumnType(query);
  Assert.assertEquals("decimal(10,0)",type);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestQBJoinTreeApplyPredicate </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3WayJoin() throws SemanticException {
  QBJoinTree jT1=createJoinTree(JoinType.INNER,"a",null,"b");
  QBJoinTree jT=createJoinTree(JoinType.INNER,"b",jT1,"c");
  ASTNode joinCond1=applyEqPredicate(jT,"a","x","b","y");
  ASTNode joinCond2=applyEqPredicate(jT,"b","y","c","z");
  Assert.assertEquals(jT1.getExpressions().get(0).get(0),joinCond1.getChild(0));
  Assert.assertEquals(jT1.getExpressions().get(1).get(0),joinCond1.getChild(1));
  Assert.assertEquals(jT.getExpressions().get(0).get(0),joinCond2.getChild(0));
  Assert.assertEquals(jT.getExpressions().get(1).get(0),joinCond2.getChild(1));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test4WayJoin() throws SemanticException {
  QBJoinTree jT1=createJoinTree(JoinType.INNER,"a",null,"b");
  QBJoinTree jT2=createJoinTree(JoinType.INNER,"b",jT1,"c");
  QBJoinTree jT=createJoinTree(JoinType.INNER,"c",jT2,"d");
  ASTNode joinCond1=applyEqPredicate(jT,"a","x","b","y");
  ASTNode joinCond2=applyEqPredicate(jT,"b","y","c","z");
  ASTNode joinCond3=applyEqPredicate(jT,"a","x","c","z");
  Assert.assertEquals(jT1.getExpressions().get(0).get(0),joinCond1.getChild(0));
  Assert.assertEquals(jT1.getExpressions().get(1).get(0),joinCond1.getChild(1));
  Assert.assertEquals(jT2.getExpressions().get(0).get(0),joinCond2.getChild(0));
  Assert.assertEquals(jT2.getExpressions().get(1).get(0),joinCond2.getChild(1));
  Assert.assertEquals(jT2.getExpressions().get(0).get(1),joinCond3.getChild(0));
  Assert.assertEquals(jT2.getExpressions().get(1).get(1),joinCond3.getChild(1));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimpleCondn() throws SemanticException {
  QBJoinTree jT=createJoinTree(JoinType.INNER,"a",null,"b");
  ASTNode joinCond=applyEqPredicate(jT,"a","x","b","y");
  Assert.assertEquals(jT.getExpressions().get(0).get(0),joinCond.getChild(0));
  Assert.assertEquals(jT.getExpressions().get(1).get(0),joinCond.getChild(1));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test4WayJoinSwitched() throws SemanticException {
  QBJoinTree jT1=createJoinTree(JoinType.INNER,"a",null,"b");
  QBJoinTree jT2=createJoinTree(JoinType.INNER,"b",jT1,"c");
  QBJoinTree jT=createJoinTree(JoinType.INNER,"c",jT2,"d");
  ASTNode joinCond1=applyEqPredicate(jT,"b","y","a","x");
  ASTNode joinCond2=applyEqPredicate(jT,"b","y","c","z");
  ASTNode joinCond3=applyEqPredicate(jT,"c","z","a","x");
  Assert.assertEquals(jT1.getExpressions().get(0).get(0),joinCond1.getChild(1));
  Assert.assertEquals(jT1.getExpressions().get(1).get(0),joinCond1.getChild(0));
  Assert.assertEquals(jT2.getExpressions().get(0).get(0),joinCond2.getChild(0));
  Assert.assertEquals(jT2.getExpressions().get(1).get(0),joinCond2.getChild(1));
  Assert.assertEquals(jT2.getExpressions().get(0).get(1),joinCond3.getChild(1));
  Assert.assertEquals(jT2.getExpressions().get(1).get(1),joinCond3.getChild(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test3WayJoinSwitched() throws SemanticException {
  QBJoinTree jT1=createJoinTree(JoinType.INNER,"a",null,"b");
  QBJoinTree jT=createJoinTree(JoinType.INNER,"b",jT1,"c");
  ASTNode joinCond1=applyEqPredicate(jT,"b","y","a","x");
  ASTNode joinCond2=applyEqPredicate(jT,"b","y","c","z");
  Assert.assertEquals(jT1.getExpressions().get(0).get(0),joinCond1.getChild(1));
  Assert.assertEquals(jT1.getExpressions().get(1).get(0),joinCond1.getChild(0));
  Assert.assertEquals(jT.getExpressions().get(0).get(0),joinCond2.getChild(0));
  Assert.assertEquals(jT.getExpressions().get(1).get(0),joinCond2.getChild(1));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestQBSubQuery </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRewriteOuterQueryWhere() throws Exception {
  ASTNode ast=parse(IN_QUERY);
  ASTNode where=where(ast);
  List<ASTNode> sqs=SubQueryUtils.findSubQueries((ASTNode)where.getChild(0));
  ASTNode sq=sqs.get(0);
  ASTNode newWhere=SubQueryUtils.rewriteParentQueryWhere((ASTNode)where.getChild(0),sq);
  Assert.assertEquals("(= 1 1)",newWhere.toStringTree());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExtractSubQueries() throws Exception {
  ASTNode ast=parse(IN_QUERY);
  ASTNode where=where(ast);
  List<ASTNode> sqs=SubQueryUtils.findSubQueries((ASTNode)where.getChild(0));
  Assert.assertEquals(1,sqs.size());
  ASTNode sq=sqs.get(0);
  Assert.assertEquals("(tok_subquery_expr (tok_subquery_op in) (tok_query (tok_from (tok_tabref (tok_tabname src) s1)) (tok_insert (tok_destination (tok_dir tok_tmp_file)) (tok_select (tok_selexpr (tok_table_or_col key))) (tok_where (and (> (. (tok_table_or_col s1) key) '9') (> (. (tok_table_or_col s1) value) '9'))))) (. (tok_table_or_col src) key))",sq.toStringTree());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCheckAggOrWindowing() throws Exception {
  ASTNode ast=parse(QUERY3);
  ASTNode select=select(ast);
  Assert.assertEquals(0,SubQueryUtils.checkAggOrWindowing((ASTNode)select.getChild(0)));
  Assert.assertEquals(1,SubQueryUtils.checkAggOrWindowing((ASTNode)select.getChild(1)));
  Assert.assertEquals(2,SubQueryUtils.checkAggOrWindowing((ASTNode)select.getChild(2)));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRewriteOuterQueryWhere2() throws Exception {
  ASTNode ast=parse(IN_QUERY2);
  ASTNode where=where(ast);
  List<ASTNode> sqs=SubQueryUtils.findSubQueries((ASTNode)where.getChild(0));
  ASTNode sq=sqs.get(0);
  ASTNode newWhere=SubQueryUtils.rewriteParentQueryWhere((ASTNode)where.getChild(0),sq);
  Assert.assertEquals("(> (tok_table_or_col value) '9')",newWhere.toStringTree());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.parse.TestSemanticAnalyzerFactory </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDrop() throws Exception {
  BaseSemanticAnalyzer analyzer=SemanticAnalyzerFactory.get(conf,new ASTNode(new CommonToken(HiveParser.TOK_DROPMACRO)));
  Assert.assertTrue(analyzer.getClass().getSimpleName(),analyzer instanceof MacroSemanticAnalyzer);
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCreate() throws Exception {
  BaseSemanticAnalyzer analyzer=SemanticAnalyzerFactory.get(conf,new ASTNode(new CommonToken(HiveParser.TOK_CREATEMACRO)));
  Assert.assertTrue(analyzer.getClass().getSimpleName(),analyzer instanceof MacroSemanticAnalyzer);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.plan.TestTezWork </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRemove() throws Exception {
  BaseWork parent=nodes.get(0);
  BaseWork children[]={nodes.get(1),nodes.get(2)};
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.SIMPLE_EDGE);
  work.connect(parent,children[0],edgeProp);
  work.connect(parent,children[1],edgeProp);
  work.remove(parent);
  Assert.assertEquals(work.getParents(children[0]).size(),0);
  Assert.assertEquals(work.getParents(children[1]).size(),0);
  Assert.assertEquals(work.getAllWork().size(),nodes.size() - 1);
  Assert.assertEquals(work.getRoots().size(),nodes.size() - 1);
  Assert.assertEquals(work.getLeaves().size(),nodes.size() - 1);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBroadcastConnect() throws Exception {
  BaseWork parent=nodes.get(0);
  BaseWork child=nodes.get(1);
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.BROADCAST_EDGE);
  work.connect(parent,child,edgeProp);
  Assert.assertEquals(work.getParents(child).size(),1);
  Assert.assertEquals(work.getChildren(parent).size(),1);
  Assert.assertEquals(work.getChildren(parent).get(0),child);
  Assert.assertEquals(work.getParents(child).get(0),parent);
  Assert.assertTrue(work.getRoots().contains(parent) && !work.getRoots().contains(child));
  Assert.assertTrue(!work.getLeaves().contains(parent) && work.getLeaves().contains(child));
  for (  BaseWork w : nodes) {
    if (w == parent || w == child) {
      continue;
    }
    Assert.assertEquals(work.getParents(w).size(),0);
    Assert.assertEquals(work.getChildren(w).size(),0);
  }
  Assert.assertEquals(work.getEdgeProperty(parent,child).getEdgeType(),EdgeType.BROADCAST_EDGE);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDisconnect() throws Exception {
  BaseWork parent=nodes.get(0);
  BaseWork children[]={nodes.get(1),nodes.get(2)};
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.SIMPLE_EDGE);
  work.connect(parent,children[0],edgeProp);
  work.connect(parent,children[1],edgeProp);
  work.disconnect(parent,children[0]);
  Assert.assertTrue(work.getChildren(parent).contains(children[1]));
  Assert.assertTrue(!work.getChildren(parent).contains(children[0]));
  Assert.assertTrue(work.getRoots().contains(parent) && work.getRoots().contains(children[0]) && !work.getRoots().contains(children[1]));
  Assert.assertTrue(!work.getLeaves().contains(parent) && work.getLeaves().contains(children[0]) && work.getLeaves().contains(children[1]));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnect() throws Exception {
  BaseWork parent=nodes.get(0);
  BaseWork child=nodes.get(1);
  TezEdgeProperty edgeProp=new TezEdgeProperty(EdgeType.SIMPLE_EDGE);
  work.connect(parent,child,edgeProp);
  Assert.assertEquals(work.getParents(child).size(),1);
  Assert.assertEquals(work.getChildren(parent).size(),1);
  Assert.assertEquals(work.getChildren(parent).get(0),child);
  Assert.assertEquals(work.getParents(child).get(0),parent);
  Assert.assertTrue(work.getRoots().contains(parent) && !work.getRoots().contains(child));
  Assert.assertTrue(!work.getLeaves().contains(parent) && work.getLeaves().contains(child));
  for (  BaseWork w : nodes) {
    if (w == parent || w == child) {
      continue;
    }
    Assert.assertEquals(work.getParents(w).size(),0);
    Assert.assertEquals(work.getChildren(w).size(),0);
  }
  Assert.assertEquals(work.getEdgeProperty(parent,child).getEdgeType(),EdgeType.SIMPLE_EDGE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.processors.TestCommandProcessorFactory </h4><pre class="type-11 type-3 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAvailableCommands() throws Exception {
  enableTestOnlyCmd(conf);
  SessionState.start(conf);
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    String cmdInLowerCase=cmd.toLowerCase();
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting()));
    Assert.assertNotNull("Cmd " + cmd + " not return null",CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmdInLowerCase},conf,command.isOnlyForTesting()));
  }
  conf.set(HiveConf.ConfVars.HIVE_SECURITY_COMMAND_WHITELIST.toString(),"");
  for (  HiveCommand command : HiveCommand.values()) {
    String cmd=command.name();
    try {
      CommandProcessorFactory.getForHiveCommandInternal(new String[]{cmd},conf,command.isOnlyForTesting());
      Assert.fail("Expected SQLException for " + cmd + " as available commands is empty");
    }
 catch (    SQLException e) {
      Assert.assertEquals("Insufficient privileges to execute " + cmd,e.getMessage());
      Assert.assertEquals("42000",e.getSQLState());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.processors.TestSetProcessor </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testHiddenConfig() throws Exception {
  HiveConf conf=new HiveConf();
  SessionState.start(conf);
  SessionState state=SessionState.get();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  state.out=new PrintStream(baos);
  SetProcessor processor=new SetProcessor();
  processor.run("");
  state.out.flush();
  String ret=baos.toString();
  Assert.assertFalse(ret.contains(HiveConf.ConfVars.METASTOREPWD.varname + "="));
  Assert.assertFalse(ret.contains(HiveConf.ConfVars.HIVE_SERVER2_SSL_KEYSTORE_PASSWORD.varname + "="));
  baos=new ByteArrayOutputStream();
  state.out=new PrintStream(baos);
  processor.run(HiveConf.ConfVars.METASTOREPWD.varname);
  state.out.flush();
  ret=new String(baos.toByteArray());
  Assert.assertTrue(baos.toString().contains("hidden"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.security.authorization.plugin.TestHiveAuthorizerCheckInvocation </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInputNoColumnsUsed() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("describe " + tableName);
  assertEquals(0,status);
  List<HivePrivilegeObject> inputs=getHivePrivilegeObjectInputs().getLeft();
  checkSingleTableInput(inputs);
  HivePrivilegeObject tableObj=inputs.get(0);
  assertNull("columns used",tableObj.getColumns());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempFunction() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  final String funcName="testAuthFunc2";
  int status=driver.compile("create temporary function " + funcName + " as 'org.apache.hadoop.hive.ql.udf.UDFPI'");
  assertEquals(0,status);
  List<HivePrivilegeObject> outputs=getHivePrivilegeObjectInputs().getRight();
  HivePrivilegeObject funcObj=outputs.get(0);
  assertEquals("input type",HivePrivilegeObjectType.FUNCTION,funcObj.getType());
  assertTrue("function name",funcName.equalsIgnoreCase(funcObj.getObjectName()));
  assertEquals("db name",null,funcObj.getDbname());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShowTables() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("show tables");
  assertEquals(0,status);
  Pair<List<HivePrivilegeObject>,List<HivePrivilegeObject>> io=getHivePrivilegeObjectInputs();
  List<HivePrivilegeObject> inputs=io.getLeft();
  assertEquals(1,inputs.size());
  HivePrivilegeObject dbObj=inputs.get(0);
  assertEquals("default",dbObj.getDbname().toLowerCase());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPermFunction() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  final String funcName="testauthfunc1";
  int status=driver.compile("create function " + dbName + "."+ funcName+ " as 'org.apache.hadoop.hive.ql.udf.UDFPI'");
  assertEquals(0,status);
  List<HivePrivilegeObject> outputs=getHivePrivilegeObjectInputs().getRight();
  HivePrivilegeObject funcObj;
  HivePrivilegeObject dbObj;
  assertEquals("number of output object",2,outputs.size());
  if (outputs.get(0).getType() == HivePrivilegeObjectType.FUNCTION) {
    funcObj=outputs.get(0);
    dbObj=outputs.get(1);
  }
 else {
    funcObj=outputs.get(1);
    dbObj=outputs.get(0);
  }
  assertEquals("input type",HivePrivilegeObjectType.FUNCTION,funcObj.getType());
  assertTrue("function name",funcName.equalsIgnoreCase(funcObj.getObjectName()));
  assertTrue("db name",dbName.equalsIgnoreCase(funcObj.getDbname()));
  assertEquals("input type",HivePrivilegeObjectType.DATABASE,dbObj.getType());
  assertTrue("db name",dbName.equalsIgnoreCase(dbObj.getDbname()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDelete() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("delete from " + acidTableName + " where j = 3");
  assertEquals(0,status);
  Pair<List<HivePrivilegeObject>,List<HivePrivilegeObject>> io=getHivePrivilegeObjectInputs();
  List<HivePrivilegeObject> inputs=io.getLeft();
  assertEquals(1,inputs.size());
  HivePrivilegeObject tableObj=inputs.get(0);
  assertEquals(1,tableObj.getColumns().size());
  assertEquals("j",tableObj.getColumns().get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInputSomeColumnsUsed() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("select i from " + tableName + " where k = 'X' and city = 'Scottsdale-AZ' ");
  assertEquals(0,status);
  List<HivePrivilegeObject> inputs=getHivePrivilegeObjectInputs().getLeft();
  checkSingleTableInput(inputs);
  HivePrivilegeObject tableObj=inputs.get(0);
  assertEquals("no of columns used",3,tableObj.getColumns().size());
  assertEquals("Columns used",Arrays.asList("city","i","k"),getSortedList(tableObj.getColumns()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDescDatabase() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("describe database " + dbName);
  assertEquals(0,status);
  Pair<List<HivePrivilegeObject>,List<HivePrivilegeObject>> io=getHivePrivilegeObjectInputs();
  List<HivePrivilegeObject> inputs=io.getLeft();
  assertEquals(1,inputs.size());
  HivePrivilegeObject dbObj=inputs.get(0);
  assertEquals(dbName.toLowerCase(),dbObj.getDbname().toLowerCase());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInputAllColumnsUsed() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("select * from " + tableName + " order by i");
  assertEquals(0,status);
  List<HivePrivilegeObject> inputs=getHivePrivilegeObjectInputs().getLeft();
  checkSingleTableInput(inputs);
  HivePrivilegeObject tableObj=inputs.get(0);
  assertEquals("no of columns used",5,tableObj.getColumns().size());
  assertEquals("Columns used",Arrays.asList("city","date","i","j","k"),getSortedList(tableObj.getColumns()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateSomeColumnsUsed() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("update " + acidTableName + " set i = 5 where j = 3");
  assertEquals(0,status);
  Pair<List<HivePrivilegeObject>,List<HivePrivilegeObject>> io=getHivePrivilegeObjectInputs();
  List<HivePrivilegeObject> outputs=io.getRight();
  HivePrivilegeObject tableObj=outputs.get(0);
  LOG.debug("Got privilege object " + tableObj);
  assertEquals("no of columns used",1,tableObj.getColumns().size());
  assertEquals("Column used","i",tableObj.getColumns().get(0));
  List<HivePrivilegeObject> inputs=io.getLeft();
  assertEquals(1,inputs.size());
  tableObj=inputs.get(0);
  assertEquals(2,tableObj.getColumns().size());
  assertEquals("j",tableObj.getColumns().get(0));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUpdateSomeColumnsUsedExprInSet() throws HiveAuthzPluginException, HiveAccessControlException, CommandNeedRetryException {
  reset(mockedAuthorizer);
  int status=driver.compile("update " + acidTableName + " set i = 5, l = k where j = 3");
  assertEquals(0,status);
  Pair<List<HivePrivilegeObject>,List<HivePrivilegeObject>> io=getHivePrivilegeObjectInputs();
  List<HivePrivilegeObject> outputs=io.getRight();
  HivePrivilegeObject tableObj=outputs.get(0);
  LOG.debug("Got privilege object " + tableObj);
  assertEquals("no of columns used",2,tableObj.getColumns().size());
  assertEquals("Columns used",Arrays.asList("i","l"),getSortedList(tableObj.getColumns()));
  List<HivePrivilegeObject> inputs=io.getLeft();
  assertEquals(1,inputs.size());
  tableObj=inputs.get(0);
  assertEquals(2,tableObj.getColumns().size());
  assertEquals("Columns used",Arrays.asList("j","k"),getSortedList(tableObj.getColumns()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.session.TestAddResource </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeleteJarMultiple() throws URISyntaxException, IOException {
  SessionState ss=Mockito.spy(SessionState.start(conf).get());
  String query1="testQuery1";
  String query2="testQuery2";
  String query3="testQuery3";
  List<URI> list1=new LinkedList<URI>();
  List<URI> list2=new LinkedList<URI>();
  List<URI> list3=new LinkedList<URI>();
  List<String> addList=new LinkedList<String>();
  list1.add(createURI(TEST_JAR_DIR + "testjar1.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar2.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar3.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar5.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar3.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  list3.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  list3.add(createURI(TEST_JAR_DIR + "testjar2.jar"));
  list3.add(createURI(TEST_JAR_DIR + "testjar5.jar"));
  Collections.sort(list1);
  Collections.sort(list2);
  Collections.sort(list3);
  Mockito.when(ss.resolveAndDownload(query1,false)).thenReturn(list1);
  Mockito.when(ss.resolveAndDownload(query2,false)).thenReturn(list2);
  Mockito.when(ss.resolveAndDownload(query3,false)).thenReturn(list3);
  addList.add(query1);
  addList.add(query2);
  addList.add(query3);
  ss.add_resources(t,addList);
  List<String> deleteList=new LinkedList<String>();
  deleteList.add(list1.get(0).toString());
  ss.delete_resources(t,deleteList);
  Set<String> dependencies=ss.list_resource(t,null);
  LinkedList<URI> actual=new LinkedList<URI>();
  for (  String dependency : dependencies) {
    actual.add(createURI(dependency));
  }
  List<URI> expected=union(list2,list3);
  Collections.sort(expected);
  Collections.sort(actual);
  assertEquals(expected,actual);
  actual.clear();
  expected.clear();
  deleteList.clear();
  deleteList.add(list2.get(0).toString());
  ss.delete_resources(t,deleteList);
  dependencies=ss.list_resource(t,null);
  actual=new LinkedList<URI>();
  for (  String dependency : dependencies) {
    actual.add(createURI(dependency));
  }
  expected=new LinkedList<URI>(list3);
  Collections.sort(expected);
  Collections.sort(actual);
  assertEquals(expected,actual);
  actual.clear();
  expected.clear();
  deleteList.clear();
  deleteList.add(list3.get(0).toString());
  ss.delete_resources(t,deleteList);
  dependencies=ss.list_resource(t,null);
  assertEquals(dependencies.isEmpty(),true);
  ss.close();
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnion() throws URISyntaxException, IOException {
  HiveConf conf=new HiveConf();
  SessionState ss=Mockito.spy(SessionState.start(conf).get());
  ResourceType t=ResourceType.JAR;
  String query1="testQuery1";
  String query2="testQuery2";
  List<String> addList=new LinkedList<String>();
  List<URI> list1=new LinkedList<URI>();
  List<URI> list2=new LinkedList<URI>();
  list1.add(createURI(TEST_JAR_DIR + "testjar1.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar2.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar3.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar5.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar3.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  Mockito.when(ss.resolveAndDownload(query1,false)).thenReturn(list1);
  Mockito.when(ss.resolveAndDownload(query2,false)).thenReturn(list2);
  addList.add(query1);
  addList.add(query2);
  ss.add_resources(t,addList);
  Set<String> dependencies=ss.list_resource(t,null);
  LinkedList<URI> actual=new LinkedList<URI>();
  for (  String dependency : dependencies) {
    actual.add(createURI(dependency));
  }
  List<URI> expected=union(list1,list2);
  Collections.sort(expected);
  Collections.sort(actual);
  assertEquals(expected,actual);
  ss.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeleteJar() throws URISyntaxException, IOException {
  SessionState ss=Mockito.spy(SessionState.start(conf).get());
  String query1="testQuery1";
  String query2="testQuery2";
  List<URI> list1=new LinkedList<URI>();
  List<URI> list2=new LinkedList<URI>();
  List<String> addList=new LinkedList<String>();
  list1.add(createURI(TEST_JAR_DIR + "testjar1.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar2.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar3.jar"));
  list1.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar5.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar3.jar"));
  list2.add(createURI(TEST_JAR_DIR + "testjar4.jar"));
  Collections.sort(list1);
  Collections.sort(list2);
  Mockito.when(ss.resolveAndDownload(query1,false)).thenReturn(list1);
  Mockito.when(ss.resolveAndDownload(query2,false)).thenReturn(list2);
  addList.add(query1);
  addList.add(query2);
  ss.add_resources(t,addList);
  List<String> deleteList=new LinkedList<String>();
  deleteList.add(list1.get(0).toString());
  ss.delete_resources(t,deleteList);
  Set<String> dependencies=ss.list_resource(t,null);
  LinkedList<URI> actual=new LinkedList<URI>();
  for (  String dependency : dependencies) {
    actual.add(createURI(dependency));
  }
  List<URI> expected=list2;
  Collections.sort(expected);
  Collections.sort(actual);
  assertEquals(expected,actual);
  deleteList.clear();
  deleteList.add(list2.get(0).toString());
  ss.delete_resources(t,deleteList);
  dependencies=ss.list_resource(t,null);
  assertEquals(dependencies.isEmpty(),true);
  ss.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCleaner </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMajorPartitionCompactionNoBase() throws Exception {
  Table t=newTable("default","campcnb",true);
  Partition p=newPartition(t,"today");
  addDeltaFile(t,p,1L,22L,22);
  addDeltaFile(t,p,23L,24L,2);
  addBaseFile(t,p,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","campcnb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMajorPartitionCompaction() throws Exception {
  Table t=newTable("default","campc",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addBaseFile(t,p,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","campc",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMajorTableCompaction() throws Exception {
  Table t=newTable("default","camtc",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addBaseFile(t,null,25L,25);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camtc",CompactionType.MAJOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(1,paths.size());
  Assert.assertEquals("base_25",paths.get(0).getName());
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorTableCompaction() throws Exception {
  Table t=newTable("default","camitc",false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addDeltaFile(t,null,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camitc",CompactionType.MINOR);
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,null);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path p : paths) {
    if (p.getName().equals("base_20"))     sawBase=true;
 else     if (p.getName().equals(makeDeltaDirName(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + p.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cleanupAfterMinorPartitionCompaction() throws Exception {
  Table t=newTable("default","camipc",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addDeltaFile(t,p,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","camipc",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  CompactionInfo ci=txnHandler.findNextToCompact("fred");
  txnHandler.markCompacted(ci);
  txnHandler.setRunAs(ci.id,System.getProperty("user.name"));
  startCleaner();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  Assert.assertEquals(1,rsp.getCompactsSize());
  Assert.assertTrue(TxnStore.SUCCEEDED_RESPONSE.equals(rsp.getCompacts().get(0).getState()));
  List<Path> paths=getDirectories(conf,t,p);
  Assert.assertEquals(2,paths.size());
  boolean sawBase=false, sawDelta=false;
  for (  Path path : paths) {
    if (path.getName().equals("base_20"))     sawBase=true;
 else     if (path.getName().equals(makeDeltaDirNameCompacted(21,24)))     sawDelta=true;
 else     Assert.fail("Unexpected file " + path.getName());
  }
  Assert.assertTrue(sawBase);
  Assert.assertTrue(sawDelta);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestCompactor </h4><pre class="type-11 type-12 type-3 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void minorCompactAfterAbort() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MINOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.deltaFileFilter);
    String[] names=new String[stat.length];
    Path resultDelta=null;
    for (int i=0; i < names.length; i++) {
      names[i]=stat[i].getPath().getName();
      if (names[i].equals("delta_0000001_0000006")) {
        resultDelta=stat[i].getPath();
      }
    }
    Arrays.sort(names);
    String[] expected=new String[]{"delta_0000001_0000002","delta_0000001_0000006","delta_0000003_0000004","delta_0000005_0000006"};
    if (!Arrays.deepEquals(expected,names)) {
      Assert.fail("Expected: " + Arrays.toString(expected) + ", found: "+ Arrays.toString(names));
    }
    checkExpectedTxnsPresent(null,new Path[]{resultDelta},columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dynamicPartitioningUpdate() throws Exception {
  String tblName="udpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("update " + tblName + " set b = 'barney'",driver);
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,1);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=today",names.get(0));
  Assert.assertEquals("ds=yesterday",names.get(1));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dynamicPartitioningDelete() throws Exception {
  String tblName="ddpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("update " + tblName + " set b = 'fred' where a = 1",driver);
  executeStatementOnDriver("delete from " + tblName + " where b = 'fred'",driver);
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,2);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=today",names.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dynamicPartitioningInsert() throws Exception {
  String tblName="dpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,0);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(2,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=today",names.get(0));
  Assert.assertEquals("ds=yesterday",names.get(1));
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void majorCompactAfterAbort() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    txnBatch.beginNextTransaction();
    txnBatch.abort();
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("majorCompactAfterAbort FileStatus[] stat " + Arrays.toString(stat));
    }
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000006\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    if (!name.equals("base_0000006")) {
      Assert.fail("majorCompactAfterAbort name " + name + " not equals to base_0000006");
    }
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * After each major compaction, stats need to be updated on each column of the
 * table/partition which previously had stats.
 * 1. create a bucketed ORC backed table (Orc is currently required by ACID)
 * 2. populate 2 partitions with data
 * 3. compute stats
 * 4. insert some data into the table using StreamingAPI
 * 5. Trigger major compaction (which should update stats)
 * 6. check that stats have been updated
 * @throws Exceptiontodo:
 * 2. add non-partitioned test
 * 4. add a test with sorted table?
 */
@Test public void testStatsAfterCompactionPartTbl() throws Exception {
  String tblName="compaction_test";
  String tblNameStg=tblName + "_stg";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("drop table if exists " + tblNameStg,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(bkt INT)"+ " CLUSTERED BY(a) INTO 4 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("CREATE EXTERNAL TABLE " + tblNameStg + "(a INT, b STRING)"+ " ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\t' LINES TERMINATED BY '\\n'"+ " STORED AS TEXTFILE"+ " LOCATION '"+ stagingFolder.newFolder().toURI().getPath()+ "'"+ " TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("load data local inpath '" + BASIC_FILE_NAME + "' overwrite into table "+ tblNameStg,driver);
  execSelectAndDumpData("select * from " + tblNameStg,driver,"Dumping data for " + tblNameStg + " after load:");
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=0) "+ "SELECT a, b where a < 2",driver);
  executeStatementOnDriver("FROM " + tblNameStg + " INSERT INTO TABLE "+ tblName+ " PARTITION(bkt=1) "+ "SELECT a, b where a >= 2",driver);
  execSelectAndDumpData("select * from " + tblName,driver,"Dumping data for " + tblName + " after load:");
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  CompactionInfo ci=new CompactionInfo("default",tblName,"bkt=0",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  Worker.StatsUpdater su=Worker.StatsUpdater.init(ci,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part1: " + txnHandler.findColumnsWithStats(ci));
  CompactionInfo ciPart2=new CompactionInfo("default",tblName,"bkt=1",CompactionType.MAJOR);
  LOG.debug("List of stats columns before analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  su=Worker.StatsUpdater.init(ciPart2,colNames,conf,System.getProperty("user.name"));
  su.gatherStats();
  LOG.debug("List of stats columns after analyze Part2: " + txnHandler.findColumnsWithStats(ci));
  Map<String,List<ColumnStatisticsObj>> stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  List<ColumnStatisticsObj> colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  LongColumnStatsData colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",1,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",1,colAStats.getNumDVs());
  StringColumnStatsData colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",3,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",3.0,colBStats.getAvgColLen(),0.01);
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",2,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  LongColumnStatsData colAStatsPart2=colStats.get(0).getStatsData().getLongStats();
  StringColumnStatsData colBStatsPart2=colStats.get(1).getStatsData().getStringStats();
  HiveEndPoint endPt=new HiveEndPoint(null,ci.dbname,ci.tableName,Arrays.asList("0"));
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(true);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  Assert.assertEquals(TransactionBatch.TxnState.OPEN,txnBatch.getCurrentTransactionState());
  txnBatch.write("50,Kiev".getBytes());
  txnBatch.write("51,St. Petersburg".getBytes());
  txnBatch.write("44,Boston".getBytes());
  txnBatch.commit();
  txnBatch.beginNextTransaction();
  txnBatch.write("52,Tel Aviv".getBytes());
  txnBatch.write("53,Atlantis".getBytes());
  txnBatch.write("53,Boston".getBytes());
  txnBatch.commit();
  txnBatch.close();
  connection.close();
  execSelectAndDumpData("select * from " + ci.getFullTableName(),driver,ci.getFullTableName());
  CompactionRequest rqst=new CompactionRequest(ci.dbname,ci.tableName,CompactionType.MAJOR);
  rqst.setPartitionname(ci.partName);
  txnHandler.compact(rqst);
  Worker t=new Worker();
  t.setThreadId((int)t.getId());
  t.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  AtomicBoolean looped=new AtomicBoolean();
  stop.set(true);
  t.init(stop,looped);
  t.run();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  if (1 != compacts.size()) {
    Assert.fail("Expecting 1 file and found " + compacts.size() + " files "+ compacts.toString());
  }
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  stats=msClient.getPartitionColumnStatistics(ci.dbname,ci.tableName,Arrays.asList(ci.partName),colNames);
  colStats=stats.get(ci.partName);
  Assert.assertNotNull("No stats found for partition " + ci.partName,colStats);
  Assert.assertEquals("Expected column 'a' at index 0","a",colStats.get(0).getColName());
  Assert.assertEquals("Expected column 'b' at index 1","b",colStats.get(1).getColName());
  colAStats=colStats.get(0).getStatsData().getLongStats();
  Assert.assertEquals("lowValue a",1,colAStats.getLowValue());
  Assert.assertEquals("highValue a",53,colAStats.getHighValue());
  Assert.assertEquals("numNulls a",0,colAStats.getNumNulls());
  Assert.assertEquals("numNdv a",6,colAStats.getNumDVs());
  colBStats=colStats.get(1).getStatsData().getStringStats();
  Assert.assertEquals("maxColLen b",14,colBStats.getMaxColLen());
  Assert.assertEquals("avgColLen b",(long)6.1111111111,(long)colBStats.getAvgColLen());
  Assert.assertEquals("numNulls b",0,colBStats.getNumNulls());
  Assert.assertEquals("nunDVs",10,colBStats.getNumDVs());
  stats=msClient.getPartitionColumnStatistics(ciPart2.dbname,ciPart2.tableName,Arrays.asList(ciPart2.partName),colNames);
  colStats=stats.get(ciPart2.partName);
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colAStatsPart2,colStats.get(0).getStatsData().getLongStats());
  Assert.assertEquals("Expected stats for " + ciPart2.partName + " to stay the same",colBStatsPart2,colStats.get(1).getStatsData().getStringStats());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Simple schema evolution add columns with partitioning.
 * @throws Exception
 */
@Test public void schemaEvolutionAddColDynamicPartitioningInsert() throws Exception {
  String tblName="dpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("ALTER TABLE " + tblName + " ADD COLUMNS(c int)",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(2,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tfred\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\twilma\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values "+ "(3, 'mark', 1900, 'soon'), (4, 'douglas', 1901, 'last_century'), "+ "(5, 'doc', 1902, 'yesterday')",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tfred\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\twilma\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t1900\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t1901\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t1902\tyesterday",valuesReadFromHiveDriver.get(4));
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,0);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(4,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=last_century",names.get(0));
  Assert.assertEquals("ds=soon",names.get(1));
  Assert.assertEquals("ds=today",names.get(2));
  Assert.assertEquals("ds=yesterday",names.get(3));
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tfred\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\twilma\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t1900\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t1901\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t1902\tyesterday",valuesReadFromHiveDriver.get(4));
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true') ",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MAJOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.baseFileFilter);
    if (1 != stat.length) {
      Assert.fail("Expecting 1 file \"base_0000004\" and found " + stat.length + " files "+ Arrays.toString(stat));
    }
    String name=stat[0].getPath().getName();
    Assert.assertEquals(name,"base_0000004");
    checkExpectedTxnsPresent(stat[0].getPath(),null,columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void schemaEvolutionAddColDynamicPartitioningUpdate() throws Exception {
  String tblName="udpct";
  List<String> colNames=Arrays.asList("a","b");
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " PARTITIONED BY(ds string)"+ " CLUSTERED BY(a) INTO 2 BUCKETS"+ " STORED AS ORC TBLPROPERTIES ('transactional'='true')",driver);
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values (1, 'fred', "+ "'today'), (2, 'wilma', 'yesterday')",driver);
  executeStatementOnDriver("update " + tblName + " set b = 'barney'",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(2,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\tyesterday",valuesReadFromHiveDriver.get(1));
  executeStatementOnDriver("ALTER TABLE " + tblName + " ADD COLUMNS(c int)",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(2,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  executeStatementOnDriver("insert into " + tblName + " partition (ds) values "+ "(3, 'mark', 1900, 'soon'), (4, 'douglas', 1901, 'last_century'), "+ "(5, 'doc', 1902, 'yesterday')",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\tNULL\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\tNULL\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t1900\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t1901\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t1902\tyesterday",valuesReadFromHiveDriver.get(4));
  executeStatementOnDriver("update " + tblName + " set c = 2000",driver);
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\t2000\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\t2000\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t2000\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t2000\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t2000\tyesterday",valuesReadFromHiveDriver.get(4));
  Initiator initiator=new Initiator();
  initiator.setThreadId((int)initiator.getId());
  conf.setIntVar(HiveConf.ConfVars.HIVE_COMPACTOR_DELTA_NUM_THRESHOLD,1);
  initiator.setHiveConf(conf);
  AtomicBoolean stop=new AtomicBoolean();
  stop.set(true);
  initiator.init(stop,new AtomicBoolean());
  initiator.run();
  TxnStore txnHandler=TxnUtils.getTxnStore(conf);
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(4,compacts.size());
  SortedSet<String> partNames=new TreeSet<String>();
  for (int i=0; i < compacts.size(); i++) {
    Assert.assertEquals("default",compacts.get(i).getDbname());
    Assert.assertEquals(tblName,compacts.get(i).getTablename());
    Assert.assertEquals("initiated",compacts.get(i).getState());
    partNames.add(compacts.get(i).getPartitionname());
  }
  List<String> names=new ArrayList<String>(partNames);
  Assert.assertEquals("ds=last_century",names.get(0));
  Assert.assertEquals("ds=soon",names.get(1));
  Assert.assertEquals("ds=today",names.get(2));
  Assert.assertEquals("ds=yesterday",names.get(3));
  executeStatementOnDriver("SELECT * FROM " + tblName + " ORDER BY a",driver);
  valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  Assert.assertEquals(5,valuesReadFromHiveDriver.size());
  Assert.assertEquals("1\tbarney\t2000\ttoday",valuesReadFromHiveDriver.get(0));
  Assert.assertEquals("2\tbarney\t2000\tyesterday",valuesReadFromHiveDriver.get(1));
  Assert.assertEquals("3\tmark\t2000\tsoon",valuesReadFromHiveDriver.get(2));
  Assert.assertEquals("4\tdouglas\t2000\tlast_century",valuesReadFromHiveDriver.get(3));
  Assert.assertEquals("5\tdoc\t2000\tyesterday",valuesReadFromHiveDriver.get(4));
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void minorCompactWhileStreaming() throws Exception {
  String dbName="default";
  String tblName="cws";
  List<String> colNames=Arrays.asList("a","b");
  String columnNamesProperty="a,b";
  String columnTypesProperty="int:string";
  executeStatementOnDriver("drop table if exists " + tblName,driver);
  executeStatementOnDriver("CREATE TABLE " + tblName + "(a INT, b STRING) "+ " CLUSTERED BY(a) INTO 1 BUCKETS"+ " STORED AS ORC  TBLPROPERTIES ('transactional'='true')",driver);
  HiveEndPoint endPt=new HiveEndPoint(null,dbName,tblName,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(new String[]{"a","b"},",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  try {
    for (int i=0; i < 2; i++) {
      writeBatch(connection,writer,false);
    }
    writeBatch(connection,writer,true);
    TxnStore txnHandler=TxnUtils.getTxnStore(conf);
    txnHandler.compact(new CompactionRequest(dbName,tblName,CompactionType.MINOR));
    Worker t=new Worker();
    t.setThreadId((int)t.getId());
    t.setHiveConf(conf);
    AtomicBoolean stop=new AtomicBoolean(true);
    AtomicBoolean looped=new AtomicBoolean();
    t.init(stop,looped);
    t.run();
    IMetaStoreClient msClient=new HiveMetaStoreClient(conf);
    Table table=msClient.getTable(dbName,tblName);
    FileSystem fs=FileSystem.get(conf);
    FileStatus[] stat=fs.listStatus(new Path(table.getSd().getLocation()),AcidUtils.deltaFileFilter);
    String[] names=new String[stat.length];
    Path resultFile=null;
    for (int i=0; i < names.length; i++) {
      names[i]=stat[i].getPath().getName();
      if (names[i].equals("delta_0000001_0000004")) {
        resultFile=stat[i].getPath();
      }
    }
    Arrays.sort(names);
    String[] expected=new String[]{"delta_0000001_0000002","delta_0000001_0000004","delta_0000003_0000004","delta_0000005_0000006"};
    if (!Arrays.deepEquals(expected,names)) {
      Assert.fail("Expected: " + Arrays.toString(expected) + ", found: "+ Arrays.toString(names));
    }
    checkExpectedTxnsPresent(null,new Path[]{resultFile},columnNamesProperty,columnTypesProperty,0,1L,4L);
  }
  finally {
    connection.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.txn.compactor.TestWorker </h4><pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBase() throws Exception {
  LOG.debug("Starting majorPartitionWithBase");
  Table t=newTable("default","mapwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mapwb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000024")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(624L,buckets[0].getLen());
      Assert.assertEquals(624L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void minorPartitionWithBase() throws Exception {
  Table t=newTable("default","mpwb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","mpwb",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewDelta=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals(makeDeltaDirNameCompacted(21,24))) {
      sawNewDelta=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertEquals(208L,buckets[0].getLen());
      Assert.assertEquals(208L,buckets[1].getLen());
    }
 else {
      LOG.debug("This is not the delta file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewDelta);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sortedPartition() throws Exception {
  List<Order> sortCols=new ArrayList<Order>(1);
  sortCols.add(new Order("b",1));
  Table t=newTable("default","sp",true,new HashMap<String,String>(),sortCols,false);
  Partition p=newPartition(t,"today",sortCols);
  addBaseFile(t,p,20L,20);
  addDeltaFile(t,p,21L,22L,2);
  addDeltaFile(t,p,23L,24L,2);
  addDeltaFile(t,p,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","sp",CompactionType.MINOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void majorPartitionWithBaseMissingBuckets() throws Exception {
  LOG.debug("Starting majorPartitionWithBaseMissingBuckets");
  Table t=newTable("default","mapwbmb",true);
  Partition p=newPartition(t,"today");
  addBaseFile(t,p,20L,20,2,false);
  addDeltaFile(t,p,21L,22L,2,2,false);
  addDeltaFile(t,p,23L,26L,4);
  burnThroughTransactions(27);
  CompactionRequest rqst=new CompactionRequest("default","mapwbmb",CompactionType.MAJOR);
  rqst.setPartitionname("ds=today");
  txnHandler.compact(rqst);
  startWorker();
  ShowCompactResponse rsp=txnHandler.showCompact(new ShowCompactRequest());
  List<ShowCompactResponseElement> compacts=rsp.getCompacts();
  Assert.assertEquals(1,compacts.size());
  Assert.assertEquals("ready for cleaning",compacts.get(0).getState());
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(p.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
  boolean sawNewBase=false;
  for (int i=0; i < stat.length; i++) {
    if (stat[i].getPath().getName().equals("base_0000026")) {
      sawNewBase=true;
      FileStatus[] buckets=fs.listStatus(stat[i].getPath());
      Assert.assertEquals(2,buckets.length);
      Assert.assertTrue(buckets[0].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(buckets[1].getPath().getName().matches("bucket_0000[01]"));
      Assert.assertTrue(("bucket_00000".equals(buckets[0].getPath().getName()) && 104L == buckets[0].getLen() && "bucket_00001".equals(buckets[1].getPath().getName()) && 676L == buckets[1].getLen()) || ("bucket_00000".equals(buckets[1].getPath().getName()) && 104L == buckets[1].getLen() && "bucket_00001".equals(buckets[0].getPath().getName()) && 676L == buckets[0].getLen()));
    }
 else {
      LOG.debug("This is not the file you are looking for " + stat[i].getPath().getName());
    }
  }
  Assert.assertTrue(sawNewBase);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sortedTable() throws Exception {
  List<Order> sortCols=new ArrayList<Order>(1);
  sortCols.add(new Order("b",1));
  Table t=newTable("default","st",false,new HashMap<String,String>(),sortCols,false);
  addBaseFile(t,null,20L,20);
  addDeltaFile(t,null,21L,22L,2);
  addDeltaFile(t,null,23L,24L,2);
  addDeltaFile(t,null,21L,24L,4);
  burnThroughTransactions(25);
  CompactionRequest rqst=new CompactionRequest("default","st",CompactionType.MINOR);
  txnHandler.compact(rqst);
  startWorker();
  FileSystem fs=FileSystem.get(conf);
  FileStatus[] stat=fs.listStatus(new Path(t.getSd().getLocation()));
  Assert.assertEquals(4,stat.length);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.generic.TestGenericUDFBRound </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMathExprBround() throws HiveException {
  double[] vArr={1.5,2.5,-1.5,-2.5,1.49,1.51};
  for (  double v : vArr) {
    double v1=RoundUtils.bround(v,0);
    double v2=MathExpr.bround(v);
    Assert.assertEquals(v1,v2,0.00001);
    double v3=BigDecimal.valueOf(v).setScale(0,ROUND_HALF_EVEN).doubleValue();
    Assert.assertEquals(v3,v2,0.00001);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.generic.TestGenericUDFCeil </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChar() throws HiveException {
  GenericUDFCeil udf=new GenericUDFCeil();
  HiveChar vc=new HiveChar("-32300.004747",12);
  HiveCharWritable input=new HiveCharWritable(vc);
  CharTypeInfo inputTypeInfo=TypeInfoFactory.getCharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.longTypeInfo,oi.getTypeInfo());
  LongWritable res=(LongWritable)udf.evaluate(args);
  Assert.assertEquals(-32300L,res.get());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimal() throws HiveException {
  GenericUDFCeil udf=new GenericUDFCeil();
  HiveDecimalWritable input=new HiveDecimalWritable(HiveDecimal.create("32300.004747"));
  DecimalTypeInfo inputTypeInfo=TypeInfoFactory.getDecimalTypeInfo(11,6);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.getDecimalTypeInfo(6,0),oi.getTypeInfo());
  HiveDecimalWritable res=(HiveDecimalWritable)udf.evaluate(args);
  Assert.assertEquals(HiveDecimal.create("32301"),res.getHiveDecimal());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVarchar() throws HiveException {
  GenericUDFCeil udf=new GenericUDFCeil();
  HiveVarchar vc=new HiveVarchar("32300.004747",12);
  HiveVarcharWritable input=new HiveVarcharWritable(vc);
  VarcharTypeInfo inputTypeInfo=TypeInfoFactory.getVarcharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.longTypeInfo,oi.getTypeInfo());
  LongWritable res=(LongWritable)udf.evaluate(args);
  Assert.assertEquals(32301L,res.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.generic.TestGenericUDFFloor </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVarchar() throws HiveException {
  GenericUDFFloor udf=new GenericUDFFloor();
  HiveVarchar vc=new HiveVarchar("32300.004747",12);
  HiveVarcharWritable input=new HiveVarcharWritable(vc);
  VarcharTypeInfo inputTypeInfo=TypeInfoFactory.getVarcharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.longTypeInfo,oi.getTypeInfo());
  LongWritable res=(LongWritable)udf.evaluate(args);
  Assert.assertEquals(32300L,res.get());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimal() throws HiveException {
  GenericUDFFloor udf=new GenericUDFFloor();
  HiveDecimalWritable input=new HiveDecimalWritable(HiveDecimal.create("32300.004747"));
  DecimalTypeInfo inputTypeInfo=TypeInfoFactory.getDecimalTypeInfo(11,6);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.getDecimalTypeInfo(6,0),oi.getTypeInfo());
  HiveDecimalWritable res=(HiveDecimalWritable)udf.evaluate(args);
  Assert.assertEquals(HiveDecimal.create("32300"),res.getHiveDecimal());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChar() throws HiveException {
  GenericUDFFloor udf=new GenericUDFFloor();
  HiveChar vc=new HiveChar("32300.004747",12);
  HiveCharWritable input=new HiveCharWritable(vc);
  CharTypeInfo inputTypeInfo=TypeInfoFactory.getCharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.longTypeInfo,oi.getTypeInfo());
  LongWritable res=(LongWritable)udf.evaluate(args);
  Assert.assertEquals(32300L,res.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.generic.TestGenericUDFOPNegative </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChar() throws HiveException {
  GenericUDFOPNegative udf=new GenericUDFOPNegative();
  HiveChar vc=new HiveChar("32300.004747",12);
  HiveCharWritable input=new HiveCharWritable(vc);
  CharTypeInfo inputTypeInfo=TypeInfoFactory.getCharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
  DoubleWritable res=(DoubleWritable)udf.evaluate(args);
  Assert.assertEquals(new Double(-32300.004747),new Double(res.get()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVarchar() throws HiveException {
  GenericUDFOPNegative udf=new GenericUDFOPNegative();
  HiveVarchar vc=new HiveVarchar("32300.004747",12);
  HiveVarcharWritable input=new HiveVarcharWritable(vc);
  VarcharTypeInfo inputTypeInfo=TypeInfoFactory.getVarcharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
  DoubleWritable res=(DoubleWritable)udf.evaluate(args);
  Assert.assertEquals(new Double(-32300.004747),new Double(res.get()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimal() throws HiveException {
  GenericUDFOPNegative udf=new GenericUDFOPNegative();
  HiveDecimalWritable input=new HiveDecimalWritable(HiveDecimal.create("32300.004747"));
  DecimalTypeInfo inputTypeInfo=TypeInfoFactory.getDecimalTypeInfo(11,6);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(inputTypeInfo,oi.getTypeInfo());
  HiveDecimalWritable res=(HiveDecimalWritable)udf.evaluate(args);
  Assert.assertEquals(HiveDecimal.create("-32300.004747"),res.getHiveDecimal());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.generic.TestGenericUDFOPPositive </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChar() throws HiveException {
  GenericUDFOPPositive udf=new GenericUDFOPPositive();
  HiveChar vc=new HiveChar("32300.004747",12);
  HiveCharWritable input=new HiveCharWritable(vc);
  CharTypeInfo inputTypeInfo=TypeInfoFactory.getCharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
  DoubleWritable res=(DoubleWritable)udf.evaluate(args);
  Assert.assertEquals(new Double(32300.004747),new Double(res.get()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDecimal() throws HiveException {
  GenericUDFOPPositive udf=new GenericUDFOPPositive();
  HiveDecimalWritable input=new HiveDecimalWritable(HiveDecimal.create("32300.004747"));
  DecimalTypeInfo inputTypeInfo=TypeInfoFactory.getDecimalTypeInfo(11,6);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(inputTypeInfo,oi.getTypeInfo());
  HiveDecimalWritable res=(HiveDecimalWritable)udf.evaluate(args);
  Assert.assertEquals(HiveDecimal.create("32300.004747"),res.getHiveDecimal());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVarchar() throws HiveException {
  GenericUDFOPPositive udf=new GenericUDFOPPositive();
  HiveVarchar vc=new HiveVarchar("32300.004747",12);
  HiveVarcharWritable input=new HiveVarcharWritable(vc);
  VarcharTypeInfo inputTypeInfo=TypeInfoFactory.getVarcharTypeInfo(12);
  ObjectInspector[] inputOIs={PrimitiveObjectInspectorFactory.getPrimitiveWritableObjectInspector(inputTypeInfo)};
  DeferredObject[] args={new DeferredJavaObject(input)};
  PrimitiveObjectInspector oi=(PrimitiveObjectInspector)udf.initialize(inputOIs);
  Assert.assertEquals(TypeInfoFactory.doubleTypeInfo,oi.getTypeInfo());
  DoubleWritable res=(DoubleWritable)udf.evaluate(args);
  Assert.assertEquals(new Double(32300.004747),new Double(res.get()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.ql.udf.xml.TestReusableStringReader </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkip() throws IOException {
  Reader reader=new ReusableStringReader();
  ((ReusableStringReader)reader).set(fox);
  long skipped=reader.skip(fox.length() + 1);
  assertEquals(fox.length(),skipped);
  assertEquals(-1,reader.read());
  ((ReusableStringReader)reader).set(fox);
  char[] cc=new char[6];
  int read;
  read=reader.read(cc);
  assertEquals(6,read);
  assertEquals("Quick ",new String(cc));
  skipped=reader.skip(30);
  assertEquals(30,skipped);
  read=reader.read(cc);
  assertEquals(4,read);
  assertEquals("dog.",new String(cc,0,read));
  skipped=reader.skip(300);
  assertEquals(0,skipped);
  assertEquals(-1,reader.read());
  reader.close();
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMarkReset() throws IOException {
  Reader reader=new ReusableStringReader();
  if (reader.markSupported()) {
    ((ReusableStringReader)reader).set(fox);
    assertTrue(reader.ready());
    char[] cc=new char[6];
    int read;
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("Quick ",new String(cc));
    reader.mark(100);
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("brown ",new String(cc));
    reader.reset();
    read=reader.read(cc);
    assertEquals(6,read);
    assertEquals("brown ",new String(cc));
  }
  reader.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.TestColumnProjectionUtils </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadColumnIds(){
  List<Integer> columnIds=new ArrayList<Integer>();
  List<Integer> actual;
  assertEquals(Collections.EMPTY_LIST,ColumnProjectionUtils.getReadColumnIDs(conf));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  ColumnProjectionUtils.appendReadColumns(conf,columnIds);
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  assertFalse(ColumnProjectionUtils.isReadAllColumns(conf));
  columnIds.add(1);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(1));
  assertEquals(columnIds,ColumnProjectionUtils.getReadColumnIDs(conf));
  columnIds.add(2);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(2));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  columnIds.add(3);
  ColumnProjectionUtils.appendReadColumns(conf,Collections.singletonList(3));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  assertFalse(ColumnProjectionUtils.isReadAllColumns(conf));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeprecatedMethods(){
  List<Integer> columnIds=new ArrayList<Integer>();
  List<Integer> actual;
  assertEquals(Collections.EMPTY_LIST,ColumnProjectionUtils.getReadColumnIDs(conf));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  ColumnProjectionUtils.setReadColumnIDs(conf,columnIds);
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  assertEquals(Collections.EMPTY_LIST,actual);
  columnIds.add(1);
  ColumnProjectionUtils.setReadColumnIDs(conf,Collections.singletonList(1));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  columnIds.add(2);
  ColumnProjectionUtils.appendReadColumnIDs(conf,Collections.singletonList(2));
  actual=ColumnProjectionUtils.getReadColumnIDs(conf);
  Collections.sort(actual);
  assertEquals(columnIds,actual);
  assertFalse(ColumnProjectionUtils.isReadAllColumns(conf));
  ColumnProjectionUtils.setFullyReadColumns(conf);
  assertTrue(ColumnProjectionUtils.isReadAllColumns(conf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroDeserializer </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeMapsWithJavaLangStringKeys() throws IOException, SerDeException {
  String schemaString="{\n" + "  \"namespace\": \"testing\",\n" + "  \"name\": \"oneMap\",\n"+ "  \"type\": \"record\",\n"+ "  \"fields\": [\n"+ "    {\n"+ "      \"name\":\"aMap\",\n"+ "      \"type\":{\"type\":\"map\",\n"+ "      \"avro.java.string\":\"String\",\n"+ "      \"values\":\"long\"}\n"+ "\t}\n"+ "  ]\n"+ "}";
  Schema s=AvroSerdeUtils.getSchemaFor(schemaString);
  GenericData.Record record=new GenericData.Record(s);
  Map<String,Long> m=new Hashtable<String,Long>();
  m.put("one",1l);
  m.put("two",2l);
  m.put("three",3l);
  record.put("aMap",m);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theMapObject=row.get(0);
  assertTrue(theMapObject instanceof Map);
  Map theMap=(Map)theMapObject;
  assertEquals(1l,theMap.get("one"));
  assertEquals(2l,theMap.get("two"));
  assertEquals(3l,theMap.get("three"));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List z=oi.getStructFieldsDataAsList(row);
  assertEquals(1,z.size());
  StructField fieldRef=oi.getStructFieldRef("amap");
  Map theMap2=(Map)oi.getStructFieldData(row,fieldRef);
  assertEquals(1l,theMap2.get("one"));
  assertEquals(2l,theMap2.get("two"));
  assertEquals(3l,theMap2.get("three"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeEnums() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.ENUM_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  record.put("baddies",new GenericData.EnumSymbol(s.getField("baddies").schema(),"DALEKS"));
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List<? extends StructField> fieldRefs=oi.getAllStructFieldRefs();
  assertEquals(1,fieldRefs.size());
  StructField fieldRef=fieldRefs.get(0);
  assertEquals("baddies",fieldRef.getFieldName());
  Object theStringObject=oi.getStructFieldData(row,fieldRef);
  assertTrue(fieldRef.getFieldObjectInspector() instanceof StringObjectInspector);
  StringObjectInspector soi=(StringObjectInspector)fieldRef.getFieldObjectInspector();
  String finalValue=soi.getPrimitiveJavaObject(theStringObject);
  assertEquals("DALEKS",finalValue);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeBytes() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.BYTES_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  byte[] bytes="ANANCIENTBLUEBOX".getBytes();
  ByteBuffer bb=ByteBuffer.wrap(bytes);
  bb.rewind();
  record.put("bytesField",bb);
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object byteObject=row.get(0);
  assertTrue(byteObject instanceof byte[]);
  byte[] outBytes=(byte[])byteObject;
  for (int i=0; i < bytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef("bytesField");
  outBytes=(byte[])oi.getStructFieldData(row,fieldRef);
  for (int i=0; i < outBytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeVoidType() throws IOException, SerDeException {
  String schemaString="{\n" + "  \"type\": \"record\", \n" + "  \"name\": \"nullTest\",\n"+ "  \"fields\" : [\n"+ "    {\"name\": \"isANull\", \"type\": \"null\"}\n"+ "  ]\n"+ "}";
  Schema s=AvroSerdeUtils.getSchemaFor(schemaString);
  GenericData.Record record=new GenericData.Record(s);
  record.put("isANull",null);
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theVoidObject=row.get(0);
  assertNull(theVoidObject);
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  StructField fieldRef=oi.getStructFieldRef("isANull");
  Object shouldBeNull=oi.getStructFieldData(row,fieldRef);
  assertNull(shouldBeNull);
  assertTrue(fieldRef.getFieldObjectInspector() instanceof VoidObjectInspector);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeFixed() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.FIXED_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  byte[] bytes="ANANCIENTBLUEBOX".getBytes();
  record.put("hash",new GenericData.Fixed(s,bytes));
  assertTrue(GENERIC_DATA.validate(s,record));
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object byteObject=row.get(0);
  assertTrue(byteObject instanceof byte[]);
  byte[] outBytes=(byte[])byteObject;
  for (int i=0; i < bytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List fieldsDataAsList=oi.getStructFieldsDataAsList(row);
  assertEquals(1,fieldsDataAsList.size());
  StructField fieldRef=oi.getStructFieldRef("hash");
  outBytes=(byte[])oi.getStructFieldData(row,fieldRef);
  for (int i=0; i < outBytes.length; i++) {
    assertEquals(bytes[i],outBytes[i]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeEvolvedUnions2() throws SerDeException, IOException {
  Schema ws=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_3);
  Schema rs=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_4);
  GenericData.Record record=new GenericData.Record(ws);
  record.put("aUnion",90);
  ResultPair result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(90,result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(0,uoi.getTag(result.unionObject));
  record=new GenericData.Record(ws);
  record.put("aUnion",99.9f);
  result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Float);
  assertEquals(99.9f,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeEvolvedUnions1() throws SerDeException, IOException {
  Schema ws=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA);
  Schema rs=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA_2);
  GenericData.Record record=new GenericData.Record(ws);
  record.put("aUnion","this is a string");
  ResultPair result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof String);
  assertEquals("this is a string",result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(2,uoi.getTag(result.unionObject));
  record=new GenericData.Record(ws);
  record.put("aUnion",99);
  result=unionTester(ws,rs,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(99,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeArrays() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.ARRAY_WITH_PRIMITIVE_ELEMENT_TYPE);
  GenericData.Record record=new GenericData.Record(s);
  List<String> list=new ArrayList<String>();
  list.add("Eccleston");
  list.add("Tennant");
  list.add("Smith");
  record.put("anArray",list);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("Array-backed record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theArrayObject=row.get(0);
  assertTrue(theArrayObject instanceof List);
  List theList=(List)theArrayObject;
  assertEquals("Eccleston",theList.get(0));
  assertEquals("Tennant",theList.get(1));
  assertEquals("Smith",theList.get(2));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  StructField fieldRefToArray=oi.getStructFieldRef("anArray");
  Object anArrayData=oi.getStructFieldData(row,fieldRefToArray);
  StandardListObjectInspector anArrayOI=(StandardListObjectInspector)fieldRefToArray.getFieldObjectInspector();
  assertEquals(3,anArrayOI.getListLength(anArrayData));
  JavaStringObjectInspector elementOI=(JavaStringObjectInspector)anArrayOI.getListElementObjectInspector();
  Object firstElement=anArrayOI.getListElement(anArrayData,0);
  assertEquals("Eccleston",elementOI.getPrimitiveJavaObject(firstElement));
  assertTrue(firstElement instanceof String);
  Object secondElement=anArrayOI.getListElement(anArrayData,1);
  assertEquals("Tennant",elementOI.getPrimitiveJavaObject(secondElement));
  assertTrue(secondElement instanceof String);
  Object thirdElement=anArrayOI.getListElement(anArrayData,2);
  assertEquals("Smith",elementOI.getPrimitiveJavaObject(thirdElement));
  assertTrue(thirdElement instanceof String);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeMapWithNullablePrimitiveValues() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.MAP_WITH_NULLABLE_PRIMITIVE_VALUE_TYPE_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  Map<String,Long> m=new HashMap<String,Long>();
  m.put("one",1l);
  m.put("two",2l);
  m.put("three",3l);
  m.put("mu",null);
  record.put("aMap",m);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theMapObject=row.get(0);
  assertTrue(theMapObject instanceof Map);
  Map theMap=(Map)theMapObject;
  assertEquals(1l,theMap.get("one"));
  assertEquals(2l,theMap.get("two"));
  assertEquals(3l,theMap.get("three"));
  assertTrue(theMap.containsKey("mu"));
  assertEquals(null,theMap.get("mu"));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List z=oi.getStructFieldsDataAsList(row);
  assertEquals(1,z.size());
  StructField fieldRef=oi.getStructFieldRef("amap");
  Map theMap2=(Map)oi.getStructFieldData(row,fieldRef);
  assertEquals(1l,theMap2.get("one"));
  assertEquals(2l,theMap2.get("two"));
  assertEquals(3l,theMap2.get("three"));
  assertTrue(theMap2.containsKey("mu"));
  assertEquals(null,theMap2.get("mu"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeUnions() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.UNION_SCHEMA);
  GenericData.Record record=new GenericData.Record(s);
  record.put("aUnion","this is a string");
  ResultPair result=unionTester(s,record);
  assertTrue(result.value instanceof String);
  assertEquals("this is a string",result.value);
  UnionObjectInspector uoi=(UnionObjectInspector)result.oi;
  assertEquals(1,uoi.getTag(result.unionObject));
  record=new GenericData.Record(s);
  record.put("aUnion",99);
  result=unionTester(s,record);
  assertTrue(result.value instanceof Integer);
  assertEquals(99,result.value);
  uoi=(UnionObjectInspector)result.oi;
  assertEquals(0,uoi.getTag(result.unionObject));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canDeserializeMapsWithPrimitiveKeys() throws SerDeException, IOException {
  Schema s=AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.MAP_WITH_PRIMITIVE_VALUE_TYPE);
  GenericData.Record record=new GenericData.Record(s);
  Map<String,Long> m=new Hashtable<String,Long>();
  m.put("one",1l);
  m.put("two",2l);
  m.put("three",3l);
  record.put("aMap",m);
  assertTrue(GENERIC_DATA.validate(s,record));
  System.out.println("record = " + record);
  AvroGenericRecordWritable garw=Utils.serializeAndDeserializeRecord(record);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  AvroDeserializer de=new AvroDeserializer();
  ArrayList row=(ArrayList)de.deserialize(aoig.getColumnNames(),aoig.getColumnTypes(),garw,s);
  assertEquals(1,row.size());
  Object theMapObject=row.get(0);
  assertTrue(theMapObject instanceof Map);
  Map theMap=(Map)theMapObject;
  assertEquals(1l,theMap.get("one"));
  assertEquals(2l,theMap.get("two"));
  assertEquals(3l,theMap.get("three"));
  StandardStructObjectInspector oi=(StandardStructObjectInspector)aoig.getObjectInspector();
  List z=oi.getStructFieldsDataAsList(row);
  assertEquals(1,z.size());
  StructField fieldRef=oi.getStructFieldRef("amap");
  Map theMap2=(Map)oi.getStructFieldData(row,fieldRef);
  assertEquals(1l,theMap2.get("one"));
  assertEquals(2l,theMap2.get("two"));
  assertEquals(3l,theMap2.get("three"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroLazyObjectInspector </h4><pre class="type-11 type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testEmptyData(){
  List<String> fieldNames=new ArrayList<String>();
  fieldNames.add("myField");
  List<ObjectInspector> ois=new ArrayList<ObjectInspector>();
  ois.add(LazyPrimitiveObjectInspectorFactory.getLazyStringObjectInspector(false,new Byte((byte)0)));
  AvroLazyObjectInspector aloi=new AvroLazyObjectInspector(fieldNames,ois,null,(byte)0,new Text(),false,false,(byte)0);
  LazyStruct lazyStruct=new LazyStruct(LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(fieldNames,ois,(byte)0,new Text(),false,false,(byte)0));
  ByteArrayRef byteArrayRef=new ByteArrayRef();
  byteArrayRef.setData(new byte[0]);
  lazyStruct.init(byteArrayRef,0,0);
  assertNull(aloi.getStructFieldData(lazyStruct,new TestStructField()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroObjectInspectorGenerator </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void convertsNullableEnum() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(NULLABLE_ENUM_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("nullableEnum",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  PrimitiveTypeInfo pti=(PrimitiveTypeInfo)typeInfo;
  assertEquals(PrimitiveObjectInspector.PrimitiveCategory.STRING,pti.getPrimitiveCategory());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleArrays() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(ARRAY_WITH_PRIMITIVE_ELEMENT_TYPE);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("anArray",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertEquals(ObjectInspector.Category.LIST,typeInfo.getCategory());
  assertTrue(typeInfo instanceof ListTypeInfo);
  ListTypeInfo listTypeInfo=(ListTypeInfo)typeInfo;
  assertEquals("string",listTypeInfo.getListElementTypeInfo().getTypeName());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void primitiveTypesWorkCorrectly() throws SerDeException {
  final String bunchOfPrimitives="{\n" + "  \"namespace\": \"testing\",\n" + "  \"name\": \"PrimitiveTypes\",\n"+ "  \"type\": \"record\",\n"+ "  \"fields\": [\n"+ "    {\n"+ "      \"name\":\"aString\",\n"+ "      \"type\":\"string\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"anInt\",\n"+ "      \"type\":\"int\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aBoolean\",\n"+ "      \"type\":\"boolean\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aLong\",\n"+ "      \"type\":\"long\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aFloat\",\n"+ "      \"type\":\"float\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aDouble\",\n"+ "      \"type\":\"double\"\n"+ "    },\n"+ "    {\n"+ "      \"name\":\"aNull\",\n"+ "      \"type\":\"null\"\n"+ "    }\n"+ "  ]\n"+ "}";
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(AvroSerdeUtils.getSchemaFor(bunchOfPrimitives));
  String[] expectedColumnNames={"aString","anInt","aBoolean","aLong","aFloat","aDouble","aNull"};
  verifyColumnNames(expectedColumnNames,aoig.getColumnNames());
  TypeInfo[] expectedColumnTypes={STRING,INT,BOOLEAN,LONG,FLOAT,DOUBLE,VOID};
  verifyColumnTypes(expectedColumnTypes,aoig.getColumnTypes());
  final ObjectInspector oi=aoig.getObjectInspector();
  assertTrue(oi instanceof StandardStructObjectInspector);
  final StandardStructObjectInspector ssoi=(StandardStructObjectInspector)oi;
  List<? extends StructField> structFields=ssoi.getAllStructFieldRefs();
  assertEquals(expectedColumnNames.length,structFields.size());
  for (int i=0; i < expectedColumnNames.length; i++) {
    assertEquals("Column names don't match",expectedColumnNames[i].toLowerCase(),structFields.get(i).getFieldName());
    assertEquals("Column types don't match",expectedColumnTypes[i].getTypeName(),structFields.get(i).getFieldObjectInspector().getTypeName());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleRecords() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(RECORD_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("aRecord",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertEquals(ObjectInspector.Category.STRUCT,typeInfo.getCategory());
  assertTrue(typeInfo instanceof StructTypeInfo);
  StructTypeInfo structTypeInfo=(StructTypeInfo)typeInfo;
  ArrayList<String> allStructFieldNames=structTypeInfo.getAllStructFieldNames();
  ArrayList<TypeInfo> allStructFieldTypeInfos=structTypeInfo.getAllStructFieldTypeInfos();
  assertEquals(allStructFieldNames.size(),3);
  String[] names=new String[]{"int1","boolean1","long1"};
  String[] typeInfoStrings=new String[]{"int","boolean","bigint"};
  for (int i=0; i < allStructFieldNames.size(); i++) {
    assertEquals("Fieldname " + allStructFieldNames.get(i) + " doesn't match expected "+ names[i],names[i],allStructFieldNames.get(i));
    assertEquals("Typeinfo " + allStructFieldTypeInfos.get(i) + " doesn't match expected "+ typeInfoStrings[i],typeInfoStrings[i],allStructFieldTypeInfos.get(i).getTypeName());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleBytes() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(BYTES_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("bytesField",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  assertEquals(((PrimitiveTypeInfo)typeInfo).getPrimitiveCategory(),PrimitiveCategory.BINARY);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleFixed() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(FIXED_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("hash",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  assertEquals(((PrimitiveTypeInfo)typeInfo).getPrimitiveCategory(),PrimitiveCategory.BINARY);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canHandleUnions() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(UNION_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("aUnion",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof UnionTypeInfo);
  UnionTypeInfo uti=(UnionTypeInfo)typeInfo;
  List<TypeInfo> typeInfos=uti.getAllUnionObjectTypeInfos();
  assertEquals(2,typeInfos.size());
  assertEquals(INT,typeInfos.get(0));
  assertEquals(STRING,typeInfos.get(1));
  assertEquals("uniontype<int,string>",uti.getTypeName());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canHandleEnums() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(ENUM_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("baddies",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  assertEquals(STRING,aoig.getColumnTypes().get(0));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void convertsNullableTypes() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(NULLABLE_STRING_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  assertEquals(1,aoig.getColumnNames().size());
  assertEquals("nullableString",aoig.getColumnNames().get(0));
  assertEquals(1,aoig.getColumnTypes().size());
  TypeInfo typeInfo=aoig.getColumnTypes().get(0);
  assertTrue(typeInfo instanceof PrimitiveTypeInfo);
  PrimitiveTypeInfo pti=(PrimitiveTypeInfo)typeInfo;
  assertEquals(PrimitiveObjectInspector.PrimitiveCategory.STRING,pti.getPrimitiveCategory());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void objectInspectorsAreCached() throws SerDeException {
  Schema s=AvroSerdeUtils.getSchemaFor(KITCHEN_SINK_SCHEMA);
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  Schema s2=AvroSerdeUtils.getSchemaFor(KITCHEN_SINK_SCHEMA);
  AvroObjectInspectorGenerator aoig2=new AvroObjectInspectorGenerator(s2);
  assertEquals(aoig.getObjectInspector(),aoig2.getObjectInspector());
  assertTrue(aoig.getObjectInspector() == aoig2.getObjectInspector());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroSerdeUtils </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void determineSchemaCanReadSchemaFromHDFS() throws IOException, AvroSerdeException, URISyntaxException {
  String schemaString=TestAvroObjectInspectorGenerator.RECORD_SCHEMA;
  MiniDFSCluster miniDfs=null;
  try {
    miniDfs=new MiniDFSCluster(new Configuration(),1,true,null);
    miniDfs.getFileSystem().mkdirs(new Path("/path/to/schema"));
    FSDataOutputStream out=miniDfs.getFileSystem().create(new Path("/path/to/schema/schema.avsc"));
    out.writeBytes(schemaString);
    out.close();
    String onHDFS=miniDfs.getFileSystem().getUri() + "/path/to/schema/schema.avsc";
    Schema schemaFromHDFS=AvroSerdeUtils.getSchemaFromFS(onHDFS,miniDfs.getFileSystem().getConf());
    Schema expectedSchema=AvroSerdeUtils.getSchemaFor(schemaString);
    assertEquals(expectedSchema,schemaFromHDFS);
  }
  finally {
    if (miniDfs != null)     miniDfs.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noneOptionWorksForSpecifyingSchemas() throws IOException, AvroSerdeException {
  Configuration conf=new Configuration();
  Properties props=new Properties();
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),SCHEMA_NONE);
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),SCHEMA_NONE);
  try {
    determineSchemaOrThrowException(conf,props);
    fail("Should have thrown exception with none set for both url and literal");
  }
 catch (  AvroSerdeException he) {
    assertEquals(EXCEPTION_MESSAGE,he.getMessage());
  }
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),TestAvroObjectInspectorGenerator.RECORD_SCHEMA);
  Schema s;
  try {
    s=determineSchemaOrThrowException(conf,props);
    assertNotNull(s);
    assertEquals(AvroSerdeUtils.getSchemaFor(TestAvroObjectInspectorGenerator.RECORD_SCHEMA),s);
  }
 catch (  AvroSerdeException he) {
    fail("Should have parsed schema literal, not thrown exception.");
  }
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),SCHEMA_NONE);
  props.put(AvroTableProperties.SCHEMA_URL.getPropName(),"not:///a.real.url");
  try {
    determineSchemaOrThrowException(conf,props);
    fail("Should have tried to open that bogus URL");
  }
 catch (  AvroSerdeException e) {
    assertEquals("Unable to read schema from given path: not:///a.real.url",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getTypeFromNullableTypePositiveCase(){
  Schema s=AvroSerdeUtils.getSchemaFor(NULLABLE_UNION);
  Schema typeFromNullableType=getOtherTypeFromNullableType(s.getField("mayBeNull").schema());
  assertEquals(Schema.Type.STRING,typeFromNullableType.getType());
  s=AvroSerdeUtils.getSchemaFor(NULLABLE_UNION2);
  typeFromNullableType=getOtherTypeFromNullableType(s.getField("mayBeNull").schema());
  assertEquals(Schema.Type.STRING,typeFromNullableType.getType());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void determineSchemaFindsLiterals() throws Exception {
  String schema=TestAvroObjectInspectorGenerator.RECORD_SCHEMA;
  Configuration conf=new Configuration();
  Properties props=new Properties();
  props.put(AvroTableProperties.SCHEMA_LITERAL.getPropName(),schema);
  Schema expected=AvroSerdeUtils.getSchemaFor(schema);
  assertEquals(expected,AvroSerdeUtils.determineSchemaOrThrowException(conf,props));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestAvroSerializer </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeUnions() throws SerDeException, IOException {
  String field="{ \"name\":\"union1\", \"type\":[\"float\", \"boolean\", \"string\"," + " {\"type\":\"bytes\", \"logicalType\":\"decimal\", \"precision\":5, \"scale\":4}] }";
  GenericRecord r=serializeAndDeserialize(field,"union1",424.4f);
  assertEquals(424.4f,r.get("union1"));
  r=serializeAndDeserialize(field,"union1",true);
  assertEquals(true,r.get("union1"));
  r=serializeAndDeserialize(field,"union1","hello");
  assertEquals("hello",r.get("union1"));
  HiveDecimal dec=HiveDecimal.create("3.1415926");
  r=serializeAndDeserialize(field,"union1",AvroSerdeUtils.getBufferFromDecimal(dec,4));
  HiveDecimal dec1=AvroSerdeUtils.getHiveDecimalFromByteBuffer((ByteBuffer)r.get("union1"),4);
  assertEquals(dec.setScale(4),dec1);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableEnums() throws SerDeException, IOException {
  String type="{\"type\": \"enum\", \"name\": \"enum1_values\",\n" + "  \"namespace\": \"org.apache.hadoop.hive\",\n" + "  \"symbols\":[\"BLUE\",\"RED\",\"GREEN\"]}";
  Schema schema=AvroSerdeUtils.getSchemaFor(type);
  String field="{ \"name\":\"nullableenum\", \"type\": [\"null\", " + schema + "] }";
  GenericEnumSymbol symbol=new GenericData.EnumSymbol(schema,enum1.BLUE.toString());
  GenericRecord r=serializeAndDeserialize(field,"nullableenum",symbol);
  assertEquals(enum1.BLUE,enum1.valueOf(r.get("nullableenum").toString()));
  r=serializeAndDeserialize(field,"nullableenum",null);
  assertNull(r.get("nullableenum"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeArraysWithNullablePrimitiveElements() throws SerDeException, IOException {
  final String field="{ \"name\":\"listWithNulls\", \"type\": " + "{\"type\":\"array\", \"items\": [\"null\", \"int\"]} }";
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,null,3);
  GenericRecord r=serializeAndDeserialize(field,"listWithNulls",intList);
  Object result=r.get("listWithNulls");
  assertNotSame(intList,result);
  assertEquals(intList,result);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableLists() throws SerDeException, IOException {
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  String field="{ \"name\":\"nullableList\", \"type\": [\"null\", " + "{\"type\":\"array\", \"items\":\"int\"}] }";
  GenericRecord r=serializeAndDeserialize(field,"nullableList",intList);
  Object result=r.get("nullableList");
  assertNotSame(intList,result);
  assertEquals(intList,result);
  r=serializeAndDeserialize(field,"nullableList",null);
  assertNull(r.get("nullableList"));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeFixed() throws SerDeException, IOException {
  String field="{ \"name\":\"fixed1\", \"type\":{\"type\":\"fixed\", " + "\"name\":\"threebytes\", \"size\":3} }";
  GenericData.Fixed fixed=new GenericData.Fixed(buildSchema(field),"k9@".getBytes());
  GenericRecord r=serializeAndDeserialize(field,"fixed1",fixed);
  assertArrayEquals(fixed.bytes(),((GenericData.Fixed)r.get("fixed1")).bytes());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeEnums() throws SerDeException, IOException {
  String type="{\"type\": \"enum\", \"name\": \"enum1_values\", " + "\"symbols\":[\"BLUE\",\"RED\",\"GREEN\"]}";
  Schema schema=AvroSerdeUtils.getSchemaFor(type);
  String field="{ \"name\":\"enum1\", \"type\": " + schema + " }";
  for (  enum1 e : enum1.values()) {
    GenericEnumSymbol symbol=new GenericData.EnumSymbol(schema,e.toString());
    GenericRecord r=serializeAndDeserialize(field,"enum1",symbol);
    assertEquals(e,enum1.valueOf(r.get("enum1").toString()));
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableDecimals() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableBytes\", \"type\":[\"null\", " + "{\"type\":\"bytes\", \"logicalType\":\"decimal\", \"precision\":5, \"scale\":4}] }";
  Buffer bb=AvroSerdeUtils.getBufferFromDecimal(HiveDecimal.create("3.1416"),4);
  GenericRecord r=serializeAndDeserialize(field,"nullableBytes",bb);
  Object result=r.get("nullableBytes");
  assertNotSame(bb,result);
  assertEquals(bb,result);
  r=serializeAndDeserialize(field,"nullableBytes",null);
  assertNull(r.get("nullableBytes"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeArraysWithNullableComplexElements() throws SerDeException, IOException {
  final String field="{ \"name\":\"listOfNullableLists\", \"type\": " + "{\"type\":\"array\", \"items\": [\"null\", " + "{\"type\": \"array\", \"items\": \"int\"}]} }";
  List<List<Integer>> intListList=new ArrayList<List<Integer>>();
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  Collections.addAll(intListList,intList,null);
  GenericRecord r=serializeAndDeserialize(field,"listOfNullableLists",intListList);
  Object result=r.get("listOfNullableLists");
  assertNotSame(intListList,result);
  assertEquals(intListList,result);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeBytes() throws SerDeException, IOException {
  String field="{ \"name\":\"bytes1\", \"type\":\"bytes\" }";
  ByteBuffer bb=ByteBuffer.wrap("easy as one two three".getBytes());
  bb.rewind();
  GenericRecord r=serializeAndDeserialize(field,"bytes1",bb);
  assertEquals(bb,r.get("bytes1"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableFixed() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableFixed\", \"type\": [\"null\", " + "{\"type\":\"fixed\", \"name\":\"threebytes\", \"size\":3}] }";
  Schema s=buildSchema(field);
  Schema nullable=s.getField("nullableFixed").schema();
  assertTrue(AvroSerdeUtils.isNullableType(nullable));
  GenericData.Fixed fixed=new GenericData.Fixed(AvroSerdeUtils.getOtherTypeFromNullableType(nullable),"k9@".getBytes());
  GenericRecord r=serializeAndDeserialize(field,"nullableFixed",fixed);
  GenericData.Fixed result=(GenericData.Fixed)r.get("nullableFixed");
  assertNotSame(fixed,result);
  assertArrayEquals(fixed.bytes(),result.bytes());
  r=serializeAndDeserialize(field,"nullableFixed",null);
  assertNull(r.get("nullableFixed"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeMapsWithNullablePrimitiveValues() throws SerDeException, IOException {
  String field="{ \"name\":\"mapWithNulls\", \"type\": " + "{\"type\":\"map\", \"values\": [\"null\", \"boolean\"]} }";
  Map<String,Boolean> m=new HashMap<String,Boolean>();
  m.put("yes",true);
  m.put("no",false);
  m.put("maybe",null);
  GenericRecord r=serializeAndDeserialize(field,"mapWithNulls",m);
  Object result=r.get("mapWithNulls");
  assertEquals(m,result);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableBytes() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableBytes\", \"type\":[\"null\", \"bytes\"] }";
  ByteBuffer bb=ByteBuffer.wrap("easy as one two three".getBytes());
  bb.rewind();
  GenericRecord r=serializeAndDeserialize(field,"nullableBytes",bb);
  Object result=r.get("nullableBytes");
  assertNotSame(bb,result);
  assertEquals(bb,result);
  r=serializeAndDeserialize(field,"nullableBytes",null);
  assertNull(r.get("nullableBytes"));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullablePrimitiveTypes() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableint\", \"type\":[\"int\", \"null\"] }";
  GenericRecord r=serializeAndDeserialize(field,"nullableint",42);
  assertEquals(42,r.get("nullableint"));
  r=serializeAndDeserialize(field,"nullableint",null);
  assertNull(r.get("nullableint"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeRecordsWithNullableComplexElements() throws SerDeException, IOException {
  String field="{ \"name\":\"struct1\", \"type\":{\"type\":\"record\", " + "\"name\":\"struct1_name\", \"fields\": [\n" + "{ \"name\":\"sInt\", \"type\":\"int\" }, { \"name\""+ ":\"sBoolean\", \"type\":\"boolean\" }, { \"name\":\"nullableList\", \"type\":[\"null\", "+ "{ \"type\":\"array\", \"items\":\"int\"}] } ] } }";
  Schema s=buildSchema(field);
  GenericData.Record innerRecord=new GenericData.Record(s.getField("struct1").schema());
  innerRecord.put("sInt",77);
  innerRecord.put("sBoolean",false);
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  innerRecord.put("nullableList",intList);
  GenericRecord r=serializeAndDeserialize(field,"struct1",innerRecord);
  Object result=r.get("struct1");
  assertNotSame(innerRecord,result);
  assertEquals(innerRecord,result);
  innerRecord.put("nullableList",null);
  r=serializeAndDeserialize(field,"struct1",innerRecord);
  result=r.get("struct1");
  assertNotSame(innerRecord,result);
  assertEquals(innerRecord,result);
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeMaps() throws SerDeException, IOException {
  Map<String,Boolean> m=new HashMap<String,Boolean>();
  m.put("yes",true);
  m.put("no",false);
  String field="{ \"name\":\"map1\", \"type\":{\"type\":\"map\", \"values\":\"boolean\"} }";
  GenericRecord r=serializeAndDeserialize(field,"map1",m);
  assertEquals(m,r.get("map1"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableMaps() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableMap\", \"type\": [\"null\", " + "{\"type\":\"map\", \"values\":\"boolean\"}] }";
  Map<String,Boolean> m=new HashMap<String,Boolean>();
  m.put("yes",true);
  m.put("no",false);
  GenericRecord r=serializeAndDeserialize(field,"nullableMap",m);
  Object result=r.get("nullableMap");
  assertNotSame(m,result);
  assertEquals(m,result);
  r=serializeAndDeserialize(field,"nullableMap",null);
  assertNull(r.get("nullableMap"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeStructs() throws SerDeException {
  String field="{ \"name\":\"struct1\", \"type\":{\"type\":\"record\", " + "\"name\":\"struct1_name\", \"fields\": [\n" + "{ \"name\":\"sInt\", \"type\":\"int\" }, { \"name\""+ ":\"sBoolean\", \"type\":\"boolean\" }, { \"name\":\"sString\", \"type\":\"string\" } ] } }";
  Schema s=buildSchema(field);
  GenericData.Record innerRecord=new GenericData.Record(s.getField("struct1").schema());
  innerRecord.put("sInt",77);
  innerRecord.put("sBoolean",false);
  innerRecord.put("sString","tedious");
  GenericData.Record r=new GenericData.Record(s);
  r.put("struct1",innerRecord);
  AvroSerializer as=new AvroSerializer();
  AvroDeserializer ad=new AvroDeserializer();
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(s);
  ObjectInspector oi=aoig.getObjectInspector();
  List<String> columnNames=aoig.getColumnNames();
  List<TypeInfo> columnTypes=aoig.getColumnTypes();
  AvroGenericRecordWritable agrw=new AvroGenericRecordWritable(r);
  agrw.setFileSchema(r.getSchema());
  Object obj=ad.deserialize(columnNames,columnTypes,agrw,s);
  Writable result=as.serialize(obj,oi,columnNames,columnTypes,s);
  assertTrue(result instanceof AvroGenericRecordWritable);
  GenericRecord r2=((AvroGenericRecordWritable)result).getRecord();
  assertEquals(s,r2.getSchema());
  GenericRecord r3=(GenericRecord)r2.get("struct1");
  assertEquals(77,r3.get("sInt"));
  assertEquals(false,r3.get("sBoolean"));
  assertEquals("tedious",r3.get("sString"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeCyclesInSchema() throws SerDeException, IOException {
  AvroCycleParent parent=new AvroCycleParent();
  AvroCycleChild child=new AvroCycleChild();
  parent.setChild(child);
  Schema parentS=ReflectData.AllowNull.get().getSchema(AvroCycleParent.class);
  GenericData.Record parentRec=new GenericData.Record(parentS);
  Schema childS=ReflectData.AllowNull.get().getSchema(AvroCycleChild.class);
  GenericData.Record childRec=new GenericData.Record(childS);
  parentRec.put("child",childRec);
  AvroSerializer as=new AvroSerializer();
  AvroDeserializer ad=new AvroDeserializer();
  AvroObjectInspectorGenerator aoig=new AvroObjectInspectorGenerator(parentS);
  ObjectInspector oi=aoig.getObjectInspector();
  List<String> columnNames=aoig.getColumnNames();
  List<TypeInfo> columnTypes=aoig.getColumnTypes();
  AvroGenericRecordWritable agrw=Utils.serializeAndDeserializeRecord(parentRec);
  Object obj=ad.deserialize(columnNames,columnTypes,agrw,parentS);
  Writable result=as.serialize(obj,oi,columnNames,columnTypes,parentS);
  assertTrue(result instanceof AvroGenericRecordWritable);
  GenericRecord r2=((AvroGenericRecordWritable)result).getRecord();
  assertEquals(parentS,r2.getSchema());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeMapOfDecimals() throws SerDeException, IOException {
  Map<String,Buffer> m=new HashMap<String,Buffer>();
  m.put("yes",AvroSerdeUtils.getBufferFromDecimal(HiveDecimal.create("3.14"),4));
  m.put("no",AvroSerdeUtils.getBufferFromDecimal(HiveDecimal.create("6.2832732"),4));
  String field="{ \"name\":\"map1\", \"type\":{\"type\":\"map\"," + " \"values\":{\"type\":\"bytes\", \"logicalType\":\"decimal\", \"precision\":5, \"scale\":4}} }";
  GenericRecord r=serializeAndDeserialize(field,"map1",m);
  assertEquals(m,r.get("map1"));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void canSerializeListOfDecimals() throws SerDeException, IOException {
  List<Buffer> bbList=new ArrayList<Buffer>();
  String[] decs=new String[]{"3.1416","4.7779","0.2312","9.1000","5.5555"};
  for (int i=0; i < decs.length; i++) {
    bbList.add(AvroSerdeUtils.getBufferFromDecimal(HiveDecimal.create(decs[i]),4));
  }
  String field="{ \"name\":\"list1\", \"type\":{\"type\":\"array\"," + " \"items\":{\"type\":\"bytes\", \"logicalType\":\"decimal\", \"precision\":5, \"scale\":4}} }";
  GenericRecord r=serializeAndDeserialize(field,"list1",bbList);
  assertEquals(bbList,r.get("list1"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-14 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeNullableRecords() throws SerDeException, IOException {
  String field="{ \"name\":\"nullableStruct\", \"type\": [\"null\", {\"type\":\"record\", " + "\"name\":\"struct1_name\", \"fields\": [\n" + "{ \"name\":\"sInt\", \"type\":\"int\" }, "+ "{ \"name\":\"sBoolean\", \"type\":\"boolean\" }, "+ "{ \"name\":\"sString\", \"type\":\"string\" } ] }] }";
  Schema s=buildSchema(field);
  Schema nullable=s.getField("nullableStruct").schema();
  assertTrue(AvroSerdeUtils.isNullableType(nullable));
  GenericData.Record innerRecord=new GenericData.Record(AvroSerdeUtils.getOtherTypeFromNullableType(nullable));
  innerRecord.put("sInt",77);
  innerRecord.put("sBoolean",false);
  innerRecord.put("sString","tedious");
  GenericRecord r=serializeAndDeserialize(field,"nullableStruct",innerRecord);
  Object result=r.get("nullableStruct");
  assertNotSame(innerRecord,result);
  assertEquals(innerRecord,result);
  r=serializeAndDeserialize(field,"nullableStruct",null);
  assertNull(r.get("nullableStruct"));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeMapsWithNullableComplexValues() throws SerDeException, IOException {
  String field="{ \"name\":\"mapWithNullableLists\", \"type\": " + "{\"type\":\"map\", \"values\": [\"null\", " + "{\"type\": \"array\", \"items\": \"int\"}]} }";
  Map<String,List<Integer>> m=new HashMap<String,List<Integer>>();
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  m.put("list",intList);
  m.put("null",null);
  GenericRecord r=serializeAndDeserialize(field,"mapWithNullableLists",m);
  Object result=r.get("mapWithNullableLists");
  assertNotSame(m,result);
  assertEquals(m,result);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canSerializeLists() throws SerDeException, IOException {
  List<Integer> intList=new ArrayList<Integer>();
  Collections.addAll(intList,1,2,3);
  String field="{ \"name\":\"list1\", \"type\":{\"type\":\"array\", \"items\":\"int\"} }";
  GenericRecord r=serializeAndDeserialize(field,"list1",intList);
  final Object list1=r.get("list1");
  Assert.assertTrue(list1 instanceof GenericArray);
  Assert.assertTrue(list1 instanceof List);
  assertEquals(intList,list1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestGenericAvroRecordWritable </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void writableContractIsImplementedCorrectly() throws IOException {
  Schema schema=AvroSerdeUtils.getSchemaFor(schemaJSON);
  GenericRecord gr=new GenericData.Record(schema);
  gr.put("first","The");
  gr.put("last","Doctor");
  assertEquals("The",gr.get("first"));
  assertEquals("Doctor",gr.get("last"));
  AvroGenericRecordWritable garw=new AvroGenericRecordWritable(gr);
  garw.setFileSchema(gr.getSchema());
  garw.setRecordReaderID(new UID());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream daos=new DataOutputStream(baos);
  garw.write(daos);
  AvroGenericRecordWritable garw2=new AvroGenericRecordWritable(gr);
  garw.setFileSchema(gr.getSchema());
  garw2.setRecordReaderID(new UID());
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DataInputStream dais=new DataInputStream(bais);
  garw2.readFields(dais);
  GenericRecord gr2=garw2.getRecord();
  assertEquals("The",gr2.get("first").toString());
  assertEquals("Doctor",gr2.get("last").toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestSchemaReEncoder </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void schemasCanAddFields() throws SerDeException {
  String original="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"Line\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"text\",\n"+ "            \"type\":\"string\"\n"+ "        }\n"+ "    ]\n"+ "}";
  String evolved="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"Line\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"text\",\n"+ "            \"type\":\"string\"\n"+ "        },\n"+ "        {\n"+ "            \"name\":\"new_kid\",\n"+ "            \"type\":\"string\",\n"+ "            \"default\":\"Hi!\"\n"+ "        }\n"+ "    ]\n"+ "}";
  Schema originalSchema=AvroSerdeUtils.getSchemaFor(original);
  Schema evolvedSchema=AvroSerdeUtils.getSchemaFor(evolved);
  GenericRecord record=new GenericData.Record(originalSchema);
  record.put("text","it is a far better thing I do, yadda, yadda");
  assertTrue(GenericData.get().validate(originalSchema,record));
  AvroDeserializer.SchemaReEncoder schemaReEncoder=new AvroDeserializer.SchemaReEncoder(record.getSchema(),evolvedSchema);
  GenericRecord r2=schemaReEncoder.reencode(record);
  assertTrue(GenericData.get().validate(evolvedSchema,r2));
  assertEquals("Hi!",r2.get("new_kid").toString());
  String original2="{\n" + "    \"namespace\": \"somebody.else\",\n" + "    \"name\": \"something_else\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"a\",\n"+ "            \"type\":\"int\"\n"+ "        }\n"+ "    ]\n"+ "}";
  String evolved2="{\n" + "    \"namespace\": \"somebody.else\",\n" + "    \"name\": \"something_else\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"a\",\n"+ "            \"type\":\"int\"\n"+ "        },\n"+ "        {\n"+ "            \"name\":\"b\",\n"+ "            \"type\":\"long\",\n"+ "            \"default\":42\n"+ "        }\n"+ "    ]\n"+ "}";
  Schema originalSchema2=AvroSerdeUtils.getSchemaFor(original2);
  Schema evolvedSchema2=AvroSerdeUtils.getSchemaFor(evolved2);
  record=new GenericData.Record(originalSchema2);
  record.put("a",19);
  assertTrue(GenericData.get().validate(originalSchema2,record));
  schemaReEncoder=new AvroDeserializer.SchemaReEncoder(record.getSchema(),evolvedSchema2);
  r2=schemaReEncoder.reencode(record);
  assertTrue(GenericData.get().validate(evolvedSchema2,r2));
  assertEquals(42l,r2.get("b"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestThatEvolvedSchemasActAsWeWant </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void resolvedSchemasShouldReturnReaderSchema() throws IOException {
  String v0="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"SomeStuff\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"v0\",\n"+ "            \"type\":\"string\"\n"+ "        }\n"+ "    ]\n"+ "}";
  String v1="{\n" + "    \"namespace\": \"org.apache.hadoop.hive\",\n" + "    \"name\": \"SomeStuff\",\n"+ "    \"type\": \"record\",\n"+ "    \"fields\": [\n"+ "        {\n"+ "            \"name\":\"v0\",\n"+ "            \"type\":\"string\"\n"+ "        },\n"+ "        {\n"+ "            \"name\":\"v1\",\n"+ "            \"type\":\"string\",\n"+ "            \"default\":\"v1_default\""+ "        }\n"+ "    ]\n"+ "}";
  Schema[] schemas={AvroSerdeUtils.getSchemaFor(v0),AvroSerdeUtils.getSchemaFor(v1)};
  GenericRecord record=new GenericData.Record(schemas[0]);
  record.put("v0","v0 value");
  assertTrue(GenericData.get().validate(schemas[0],record));
  GenericDatumWriter<GenericRecord> gdw=new GenericDatumWriter<GenericRecord>(schemas[0]);
  DataFileWriter<GenericRecord> dfw=new DataFileWriter<GenericRecord>(gdw);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  dfw.create(schemas[0],baos);
  dfw.append(record);
  dfw.close();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  GenericDatumReader<GenericRecord> gdr=new GenericDatumReader<GenericRecord>();
  gdr.setExpected(schemas[1]);
  DataFileStream<GenericRecord> dfs=new DataFileStream<GenericRecord>(bais,gdr);
  assertTrue(dfs.hasNext());
  GenericRecord next=dfs.next();
  assertEquals("v0 value",next.get("v0").toString());
  assertEquals("v1_default",next.get("v1").toString());
  assertEquals(schemas[1],next.getSchema());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.avro.TestTypeInfoToSchema </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroBooleanSchema(){
  final String specificSchema="\"boolean\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for boolean's avro schema failed",expectedSchema,getAvroSchemaString(BOOLEAN));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroCharSchema(){
  final String specificSchema="{" + "\"type\":\"string\"," + "\"logicalType\":\"char\","+ "\"maxLength\":" + CHAR_LEN + "}";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for char's avro schema failed",expectedSchema,getAvroSchemaString(CHAR));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroStructSchema() throws IOException {
  StructTypeInfo structTypeInfo=new StructTypeInfo();
  ArrayList<String> names=new ArrayList<String>();
  names.add("field1");
  names.add("field2");
  names.add("field3");
  names.add("field4");
  names.add("field5");
  names.add("field6");
  names.add("field7");
  names.add("field8");
  names.add("field9");
  names.add("field10");
  names.add("field11");
  names.add("field12");
  names.add("field13");
  names.add("field14");
  structTypeInfo.setAllStructFieldNames(names);
  ArrayList<TypeInfo> typeInfos=new ArrayList<TypeInfo>();
  typeInfos.add(STRING);
  typeInfos.add(CHAR);
  typeInfos.add(VARCHAR);
  typeInfos.add(BINARY);
  typeInfos.add(BYTE);
  typeInfos.add(SHORT);
  typeInfos.add(INT);
  typeInfos.add(LONG);
  typeInfos.add(FLOAT);
  typeInfos.add(DOUBLE);
  typeInfos.add(BOOLEAN);
  typeInfos.add(DECIMAL);
  typeInfos.add(DATE);
  typeInfos.add(VOID);
  structTypeInfo.setAllStructFieldTypeInfos(typeInfos);
  LOGGER.info("structTypeInfo is " + structTypeInfo);
  final String specificSchema=IOUtils.toString(Resources.getResource("avro-struct.avsc").openStream()).replace(lineSeparator,"");
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for struct's avro schema failed",expectedSchema,getAvroSchemaString(structTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroDoubleSchema(){
  final String specificSchema="\"double\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for double's avro schema failed",expectedSchema,getAvroSchemaString(DOUBLE));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroUnionSchemaWithNull(){
  UnionTypeInfo unionTypeInfo=new UnionTypeInfo();
  unionTypeInfo.setAllUnionObjectTypeInfos(Arrays.asList(INT,FLOAT,STRING,VOID));
  final String specificSchema=Schema.createUnion(Arrays.asList(Schema.create(Schema.Type.NULL),Schema.create(Schema.Type.INT),Schema.create(Schema.Type.FLOAT),Schema.create(Schema.Type.STRING))).toString();
  String expectedSchema=genSchemaWithoutNull(specificSchema);
  Assert.assertEquals("Test for union's avro schema failed",expectedSchema,getAvroSchemaString(unionTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroMapSchema(){
  MapTypeInfo mapTypeInfo=new MapTypeInfo();
  mapTypeInfo.setMapKeyTypeInfo(STRING);
  mapTypeInfo.setMapValueTypeInfo(INT);
  final String specificSchema=Schema.createMap(Schema.createUnion(Arrays.asList(Schema.create(Schema.Type.NULL),Schema.create(Schema.Type.INT)))).toString();
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for map's avro schema failed",expectedSchema,getAvroSchemaString(mapTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroDateSchema(){
  final String specificSchema="{" + "\"type\":\"int\"," + "\"logicalType\":\"date\"}";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for date in avro schema failed",expectedSchema,getAvroSchemaString(DATE));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroVarcharSchema(){
  final String specificSchema="{" + "\"type\":\"string\"," + "\"logicalType\":\"varchar\","+ "\"maxLength\":" + CHAR_LEN + "}";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for varchar's avro schema failed",expectedSchema,getAvroSchemaString(VARCHAR));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroBinarySchema(){
  final String specificSchema="\"bytes\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for binary's avro schema failed",expectedSchema,getAvroSchemaString(BINARY));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroUnionSchemaOfNull(){
  UnionTypeInfo unionTypeInfo=new UnionTypeInfo();
  unionTypeInfo.setAllUnionObjectTypeInfos(Arrays.asList(VOID));
  final String specificSchema=Schema.createUnion(Arrays.asList(Schema.create(Schema.Type.NULL))).toString();
  String expectedSchema=genSchemaWithoutNull(specificSchema);
  Assert.assertEquals("Test for union's avro schema failed",expectedSchema,getAvroSchemaString(unionTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroBytesSchema(){
  final String specificSchema="\"int\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for bytes's avro schema failed",expectedSchema,getAvroSchemaString(BYTE));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroShortSchema(){
  final String specificSchema="\"int\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for short's avro schema failed",expectedSchema,getAvroSchemaString(SHORT));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroDecimalSchema(){
  final String specificSchema="{" + "\"type\":\"bytes\"," + "\"logicalType\":\"decimal\","+ "\"precision\":" + PRECISION + ","+ "\"scale\":"+ SCALE+ "}";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for decimal's avro schema failed",expectedSchema,getAvroSchemaString(DECIMAL));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroLongSchema(){
  final String specificSchema="\"long\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for long's avro schema failed",expectedSchema,getAvroSchemaString(LONG));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroNestedStructSchema() throws IOException {
  StructTypeInfo structTypeInfo=new StructTypeInfo();
  ArrayList<String> names=new ArrayList<String>();
  names.add("field1");
  names.add("field2");
  structTypeInfo.setAllStructFieldNames(names);
  ArrayList<TypeInfo> typeInfos=new ArrayList<TypeInfo>();
  typeInfos.add(STRING);
  typeInfos.add(INT);
  structTypeInfo.setAllStructFieldTypeInfos(typeInfos);
  StructTypeInfo superStructTypeInfo=new StructTypeInfo();
  ArrayList<String> superNames=new ArrayList<String>();
  superNames.add("superfield1");
  superNames.add("superfield2");
  superStructTypeInfo.setAllStructFieldNames(superNames);
  ArrayList<TypeInfo> superTypeInfos=new ArrayList<TypeInfo>();
  superTypeInfos.add(STRING);
  superTypeInfos.add(structTypeInfo);
  superStructTypeInfo.setAllStructFieldTypeInfos(superTypeInfos);
  final String specificSchema=IOUtils.toString(Resources.getResource("avro-nested-struct.avsc").openStream()).replace(lineSeparator,"");
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for nested struct's avro schema failed",expectedSchema,getAvroSchemaString(superStructTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroTimestampSchema(){
  final String specificSchema="{" + "\"type\":\"long\"," + "\"logicalType\":\"timestamp-millis\"}";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for timestamp in avro schema failed",expectedSchema,getAvroSchemaString(TIMESTAMP));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroStringSchema(){
  final String specificSchema="\"string\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for string's avro schema failed",expectedSchema,getAvroSchemaString(STRING));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroUnionSchema(){
  UnionTypeInfo unionTypeInfo=new UnionTypeInfo();
  unionTypeInfo.setAllUnionObjectTypeInfos(Arrays.asList(INT,FLOAT,STRING));
  final String specificSchema=Schema.createUnion(Arrays.asList(Schema.create(Schema.Type.NULL),Schema.create(Schema.Type.INT),Schema.create(Schema.Type.FLOAT),Schema.create(Schema.Type.STRING))).toString();
  String expectedSchema=genSchemaWithoutNull(specificSchema);
  Assert.assertEquals("Test for union's avro schema failed",expectedSchema,getAvroSchemaString(unionTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroUnionSchemaOfOne(){
  UnionTypeInfo unionTypeInfo=new UnionTypeInfo();
  unionTypeInfo.setAllUnionObjectTypeInfos(Arrays.asList(STRING));
  final String specificSchema=Schema.createUnion(Arrays.asList(Schema.create(Schema.Type.NULL),Schema.create(Schema.Type.STRING))).toString();
  String expectedSchema=genSchemaWithoutNull(specificSchema);
  Assert.assertEquals("Test for union's avro schema failed",expectedSchema,getAvroSchemaString(unionTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroFloatSchema(){
  final String specificSchema="\"float\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for float's avro schema failed",expectedSchema,getAvroSchemaString(FLOAT));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroVoidSchema(){
  final String specificSchema="\"null\"";
  String expectedSchema=genSchemaWithoutNull(specificSchema);
  Assert.assertEquals("Test for void's avro schema failed",expectedSchema,getAvroSchemaString(VOID));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroListSchema(){
  ListTypeInfo listTypeInfo=new ListTypeInfo();
  listTypeInfo.setListElementTypeInfo(STRING);
  final String specificSchema=Schema.createArray(Schema.createUnion(Arrays.asList(Schema.create(Schema.Type.NULL),Schema.create(Schema.Type.STRING)))).toString();
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for list's avro schema failed",expectedSchema,getAvroSchemaString(listTypeInfo));
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createAvroIntSchema(){
  final String specificSchema="\"int\"";
  String expectedSchema=genSchema(specificSchema);
  Assert.assertEquals("Test for int's avro schema failed",expectedSchema,getAvroSchemaString(INT));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestDateWritable </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testDateValueOf(){
  String dateStr=getRandomDateString();
  Date date=Date.valueOf(dateStr);
  assertEquals(dateStr,date.toString());
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDaylightSavingsTime() throws InterruptedException, ExecutionException {
  String[] timeZones={"GMT","UTC","America/Godthab","America/Los_Angeles","Asia/Jerusalem","Australia/Melbourne","Europe/London","America/St_Johns","Asia/Tehran"};
  for (  String timeZone : timeZones) {
    TimeZone previousDefault=TimeZone.getDefault();
    TimeZone.setDefault(TimeZone.getTimeZone(timeZone));
    assertEquals("Default timezone should now be " + timeZone,timeZone,TimeZone.getDefault().getID());
    ExecutorService threadPool=Executors.newFixedThreadPool(1);
    try {
      Future<String> future=threadPool.submit(new DateTestCallable());
      String result=future.get();
      assertNull("Failed at timezone " + timeZone + ", date "+ result,result);
    }
  finally {
      threadPool.shutdown();
      TimeZone.setDefault(previousDefault);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.io.TestTimestampWritable </h4><pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) public void testDecimalToTimestampRandomly(){
  Random rand=new Random(294729777L);
  for (int i=0; i < 10000; ++i) {
    Timestamp ts=new Timestamp(randomMillis(MIN_FOUR_DIGIT_YEAR_MILLIS,MAX_FOUR_DIGIT_YEAR_MILLIS,rand));
    ts.setNanos(randomNanos(rand,9));
    assertEquals(ts,TimestampWritable.decimalToTimestamp(timestampToDecimal(ts)));
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) @Repeating(repetition=100) public void testDecimalToTimestampCornerCases(){
  Timestamp ts=new Timestamp(parseToMillis("1969-03-04 05:44:33"));
  assertEquals(0,ts.getTime() % 1000);
  for (  int nanos : new int[]{100000,900000,999100000,999900000}) {
    ts.setNanos(nanos);
    HiveDecimal d=timestampToDecimal(ts);
    assertEquals(ts,TimestampWritable.decimalToTimestamp(d));
    assertEquals(ts,TimestampWritable.doubleToTimestamp(d.bigDecimalValue().doubleValue()));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Concurrent(count=4) public void testToFromDouble(){
  Random rand=new Random(294729777L);
  for (int nanosPrecision=0; nanosPrecision <= 4; ++nanosPrecision) {
    for (int i=0; i < 10000; ++i) {
      long millis=randomMillis(MIN_FOUR_DIGIT_YEAR_MILLIS,MAX_FOUR_DIGIT_YEAR_MILLIS,rand);
      Timestamp ts=new Timestamp(millis);
      int nanos=randomNanos(rand,nanosPrecision);
      ts.setNanos(nanos);
      TimestampWritable tsw=new TimestampWritable(ts);
      double asDouble=tsw.getDouble();
      int recoveredNanos=(int)(Math.round((asDouble - Math.floor(asDouble)) * Math.pow(10,nanosPrecision)) * Math.pow(10,9 - nanosPrecision));
      assertEquals(String.format("Invalid nanosecond part recovered from %f",asDouble),nanos,recoveredNanos);
      assertEquals(ts,TimestampWritable.doubleToTimestamp(asDouble));
      assertEquals(ts,TimestampWritable.decimalToTimestamp(HiveDecimal.create(BigDecimal.valueOf(asDouble))));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hadoop.hive.serde2.lazy.TestLazySimpleSerDe </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the deprecated usage of SerDeParameters.
 */
@Test @SuppressWarnings("deprecation") public void testSerDeParameters() throws SerDeException, IOException {
  LazySimpleSerDe serDe=new LazySimpleSerDe();
  Configuration conf=new Configuration();
  MyTestClass row=new MyTestClass();
  ExtraTypeInfo extraTypeInfo=new ExtraTypeInfo();
  row.randomFill(new Random(1234),extraTypeInfo);
  StructObjectInspector rowOI=(StructObjectInspector)ObjectInspectorFactory.getReflectionObjectInspector(MyTestClass.class,ObjectInspectorOptions.JAVA);
  String fieldNames=ObjectInspectorUtils.getFieldNames(rowOI);
  String fieldTypes=ObjectInspectorUtils.getFieldTypes(rowOI);
  Properties schema=new Properties();
  schema.setProperty(serdeConstants.LIST_COLUMNS,fieldNames);
  schema.setProperty(serdeConstants.LIST_COLUMN_TYPES,fieldTypes);
  SerDeUtils.initializeSerDe(serDe,conf,schema,null);
  SerDeParameters serdeParams=LazySimpleSerDe.initSerdeParams(conf,schema,"testSerdeName");
  LazyStruct data=(LazyStruct)serializeAndDeserialize(row,rowOI,serDe,serdeParams);
  assertEquals((boolean)row.myBool,((LazyBoolean)data.getField(0)).getWritableObject().get());
  assertEquals((int)row.myInt,((LazyInteger)data.getField(3)).getWritableObject().get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeeLineHistory </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testHistory() throws Exception {
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  PrintStream ops=new PrintStream(os);
  BeeLine beeline=new BeeLine();
  beeline.getOpts().setHistoryFile(fileName);
  beeline.setOutputStream(ops);
  beeline.getConsoleReader(null);
  beeline.dispatch("!history");
  String output=os.toString("UTF-8");
  String[] tmp=output.split("\n");
  Assert.assertTrue(tmp[0].equals("1     : select 1;"));
  Assert.assertTrue(tmp[9].equals("10    : select 10;"));
  beeline.close();
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNumHistories() throws Exception {
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  PrintStream ops=new PrintStream(os);
  BeeLine beeline=new BeeLine();
  beeline.getOpts().setHistoryFile(fileName);
  beeline.setOutputStream(ops);
  beeline.getConsoleReader(null);
  beeline.dispatch("!history");
  String output=os.toString("UTF-8");
  int numHistories=output.split("\n").length;
  Assert.assertEquals(numHistories,10);
  beeline.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeeLineWithArgs </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * HIVE-4566
 * @throws UnsupportedEncodingException
 */
@Test public void testNPE() throws UnsupportedEncodingException {
  BeeLine beeLine=new BeeLine();
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  PrintStream beelineOutputStream=new PrintStream(os);
  beeLine.setOutputStream(beelineOutputStream);
  beeLine.setErrorStream(beelineOutputStream);
  beeLine.runCommands(new String[]{"!typeinfo"});
  String output=os.toString("UTF8");
  Assert.assertFalse(output.contains("java.lang.NullPointerException"));
  Assert.assertTrue(output.contains("No current connection"));
  beeLine.runCommands(new String[]{"!nativesql"});
  output=os.toString("UTF8");
  Assert.assertFalse(output.contains("java.lang.NullPointerException"));
  Assert.assertTrue(output.contains("No current connection"));
  System.out.println(">>> PASSED " + "testNPE");
}

</code></pre>

<br>
<pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Attempt to execute a missing script file with the -f option to BeeLine
 */
@Test public void testNegativeScriptFile() throws Throwable {
  final String EXPECTED_PATTERN=" default ";
  File scriptFile=File.createTempFile("beelinenegative","temp");
  scriptFile.delete();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("-f");
  argList.add(scriptFile.getAbsolutePath());
  try {
    String output=testCommandLineScript(argList,null);
    if (output.contains(EXPECTED_PATTERN)) {
      fail("Output: " + output + " Negative pattern: "+ EXPECTED_PATTERN);
    }
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw e;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.beeline.TestBeelineArgParsing </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testBeelinePasswordMask() throws Exception {
  TestBeeline bl=new TestBeeline();
  File errFile=File.createTempFile("test","tmp");
  bl.setErrorStream(new PrintStream(new FileOutputStream(errFile)));
  String args[]=new String[]{"-u","url","-n","name","-p","password","-d","driver","--autoCommit=true","--verbose","--truncateTable"};
  bl.initArgs(args);
  bl.close();
  String errContents=new String(Files.readAllBytes(Paths.get(errFile.toString())));
  Assert.assertTrue(errContents.contains(BeeLine.PASSWD_MASK));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.common.util.TestBloomFilter </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBloomFilterDouble(){
  BloomFilter bf=new BloomFilter(10000);
  double val=Double.MIN_VALUE;
  double val1=1.1d;
  double val2=2.2d;
  double val3=Double.MAX_VALUE;
  assertEquals(false,bf.testDouble(val));
  assertEquals(false,bf.testDouble(val1));
  assertEquals(false,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val);
  assertEquals(true,bf.testDouble(val));
  assertEquals(false,bf.testDouble(val1));
  assertEquals(false,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val1);
  assertEquals(true,bf.testDouble(val));
  assertEquals(true,bf.testDouble(val1));
  assertEquals(false,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val2);
  assertEquals(true,bf.testDouble(val));
  assertEquals(true,bf.testDouble(val1));
  assertEquals(true,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val3);
  assertEquals(true,bf.testDouble(val));
  assertEquals(true,bf.testDouble(val1));
  assertEquals(true,bf.testDouble(val2));
  assertEquals(true,bf.testDouble(val3));
  double randVal=0;
  for (int i=0; i < COUNT; i++) {
    randVal=rand.nextDouble();
    bf.addDouble(randVal);
  }
  assertEquals(true,bf.testDouble(randVal));
  assertEquals(false,bf.testDouble(-120.2d));
  assertEquals(7800,bf.sizeInBytes());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBloomFilterString(){
  BloomFilter bf=new BloomFilter(100000);
  String val="bloo";
  String val1="bloom fil";
  String val2="bloom filter";
  String val3="cuckoo filter";
  assertEquals(false,bf.testString(val));
  assertEquals(false,bf.testString(val1));
  assertEquals(false,bf.testString(val2));
  assertEquals(false,bf.testString(val3));
  bf.addString(val);
  assertEquals(true,bf.testString(val));
  assertEquals(false,bf.testString(val1));
  assertEquals(false,bf.testString(val2));
  assertEquals(false,bf.testString(val3));
  bf.addString(val1);
  assertEquals(true,bf.testString(val));
  assertEquals(true,bf.testString(val1));
  assertEquals(false,bf.testString(val2));
  assertEquals(false,bf.testString(val3));
  bf.addString(val2);
  assertEquals(true,bf.testString(val));
  assertEquals(true,bf.testString(val1));
  assertEquals(true,bf.testString(val2));
  assertEquals(false,bf.testString(val3));
  bf.addString(val3);
  assertEquals(true,bf.testString(val));
  assertEquals(true,bf.testString(val1));
  assertEquals(true,bf.testString(val2));
  assertEquals(true,bf.testString(val3));
  long randVal=0;
  for (int i=0; i < COUNT; i++) {
    randVal=rand.nextLong();
    bf.addString(Long.toString(randVal));
  }
  assertEquals(true,bf.testString(Long.toString(randVal)));
  assertEquals(false,bf.testString(Long.toString(-120)));
  assertEquals(77944,bf.sizeInBytes());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBloomFilterFloat(){
  BloomFilter bf=new BloomFilter(10000);
  float val=Float.MIN_VALUE;
  float val1=1.1f;
  float val2=2.2f;
  float val3=Float.MAX_VALUE;
  assertEquals(false,bf.testDouble(val));
  assertEquals(false,bf.testDouble(val1));
  assertEquals(false,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val);
  assertEquals(true,bf.testDouble(val));
  assertEquals(false,bf.testDouble(val1));
  assertEquals(false,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val1);
  assertEquals(true,bf.testDouble(val));
  assertEquals(true,bf.testDouble(val1));
  assertEquals(false,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val2);
  assertEquals(true,bf.testDouble(val));
  assertEquals(true,bf.testDouble(val1));
  assertEquals(true,bf.testDouble(val2));
  assertEquals(false,bf.testDouble(val3));
  bf.addDouble(val3);
  assertEquals(true,bf.testDouble(val));
  assertEquals(true,bf.testDouble(val1));
  assertEquals(true,bf.testDouble(val2));
  assertEquals(true,bf.testDouble(val3));
  float randVal=0;
  for (int i=0; i < COUNT; i++) {
    randVal=rand.nextFloat();
    bf.addDouble(randVal);
  }
  assertEquals(true,bf.testDouble(randVal));
  assertEquals(false,bf.testDouble(-120.2f));
  assertEquals(7800,bf.sizeInBytes());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBloomFilterLong(){
  BloomFilter bf=new BloomFilter(10000);
  long val=Long.MIN_VALUE;
  long val1=1;
  long val2=2;
  long val3=Long.MAX_VALUE;
  assertEquals(false,bf.testLong(val));
  assertEquals(false,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val);
  assertEquals(true,bf.testLong(val));
  assertEquals(false,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val1);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val2);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(true,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val3);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(true,bf.testLong(val2));
  assertEquals(true,bf.testLong(val3));
  long randVal=0;
  for (int i=0; i < COUNT; i++) {
    randVal=rand.nextLong();
    bf.addLong(randVal);
  }
  assertEquals(true,bf.testLong(randVal));
  assertEquals(false,bf.testLong(-120));
  assertEquals(7800,bf.sizeInBytes());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBloomFilterByte(){
  BloomFilter bf=new BloomFilter(10000);
  byte val=Byte.MIN_VALUE;
  byte val1=1;
  byte val2=2;
  byte val3=Byte.MAX_VALUE;
  assertEquals(false,bf.testLong(val));
  assertEquals(false,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val);
  assertEquals(true,bf.testLong(val));
  assertEquals(false,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val1);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val2);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(true,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val3);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(true,bf.testLong(val2));
  assertEquals(true,bf.testLong(val3));
  byte randVal=0;
  for (int i=0; i < COUNT; i++) {
    randVal=(byte)rand.nextInt(Byte.MAX_VALUE);
    bf.addLong(randVal);
  }
  assertEquals(true,bf.testLong(randVal));
  assertEquals(false,bf.testLong((byte)-120));
  assertEquals(7800,bf.sizeInBytes());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBloomFilterInt(){
  BloomFilter bf=new BloomFilter(10000);
  int val=Integer.MIN_VALUE;
  int val1=1;
  int val2=2;
  int val3=Integer.MAX_VALUE;
  assertEquals(false,bf.testLong(val));
  assertEquals(false,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val);
  assertEquals(true,bf.testLong(val));
  assertEquals(false,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val1);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(false,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val2);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(true,bf.testLong(val2));
  assertEquals(false,bf.testLong(val3));
  bf.addLong(val3);
  assertEquals(true,bf.testLong(val));
  assertEquals(true,bf.testLong(val1));
  assertEquals(true,bf.testLong(val2));
  assertEquals(true,bf.testLong(val3));
  int randVal=0;
  for (int i=0; i < COUNT; i++) {
    randVal=rand.nextInt();
    bf.addLong(randVal);
  }
  assertEquals(true,bf.testLong(randVal));
  assertEquals(false,bf.testLong(-120));
  assertEquals(7800,bf.sizeInBytes());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.common.util.TestMurmur3 </h4><pre class="type-11 type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_longs(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_128(seed);
  for (int i=0; i < 1000; i++) {
    long val=rand.nextLong();
    byte[] data=ByteBuffer.allocate(8).putLong(val).array();
    ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
    buf.put(hf.hashBytes(data).asBytes());
    buf.flip();
    long gl1=buf.getLong();
    long gl2=buf.getLong(8);
    long[] hc=Murmur3.hash128(data,0,data.length,seed);
    long m1=hc[0];
    long m2=hc[1];
    assertEquals(gl1,m1);
    assertEquals(gl2,m2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_ints(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_128(seed);
  for (int i=0; i < 1000; i++) {
    int val=rand.nextInt();
    byte[] data=ByteBuffer.allocate(4).putInt(val).array();
    ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
    buf.put(hf.hashBytes(data).asBytes());
    buf.flip();
    long gl1=buf.getLong();
    long gl2=buf.getLong(8);
    long[] hc=Murmur3.hash128(data,0,data.length,seed);
    long m1=hc[0];
    long m2=hc[1];
    assertEquals(gl1,m1);
    assertEquals(gl2,m2);
    byte[] offsetData=new byte[data.length + 50];
    System.arraycopy(data,0,offsetData,50,data.length);
    hc=Murmur3.hash128(offsetData,50,data.length,seed);
    assertEquals(gl1,hc[0]);
    assertEquals(gl2,hc[1]);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_32_ints(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_32(seed);
  for (int i=0; i < 1000; i++) {
    int val=rand.nextInt();
    byte[] data=ByteBuffer.allocate(4).putInt(val).array();
    int hc1=hf.hashBytes(data).asInt();
    int hc2=Murmur3.hash32(data,data.length,seed);
    assertEquals(hc1,hc2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_double(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_128(seed);
  for (int i=0; i < 1000; i++) {
    double val=rand.nextDouble();
    byte[] data=ByteBuffer.allocate(8).putDouble(val).array();
    ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
    buf.put(hf.hashBytes(data).asBytes());
    buf.flip();
    long gl1=buf.getLong();
    long gl2=buf.getLong(8);
    long[] hc=Murmur3.hash128(data,0,data.length,seed);
    long m1=hc[0];
    long m2=hc[1];
    assertEquals(gl1,m1);
    assertEquals(gl2,m2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_32_longs(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_32(seed);
  for (int i=0; i < 1000; i++) {
    long val=rand.nextLong();
    byte[] data=ByteBuffer.allocate(8).putLong(val).array();
    int hc1=hf.hashBytes(data).asInt();
    int hc2=Murmur3.hash32(data,data.length,seed);
    assertEquals(hc1,hc2);
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHashCodesM3_32_string(){
  String key="test";
  int seed=123;
  HashFunction hf=Hashing.murmur3_32(seed);
  int hc1=hf.hashBytes(key.getBytes()).asInt();
  int hc2=Murmur3.hash32(key.getBytes(),key.getBytes().length,seed);
  assertEquals(hc1,hc2);
  key="testkey";
  hc1=hf.hashBytes(key.getBytes()).asInt();
  hc2=Murmur3.hash32(key.getBytes(),key.getBytes().length,seed);
  assertEquals(hc1,hc2);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_128_string(){
  String key="test";
  int seed=123;
  HashFunction hf=Hashing.murmur3_128(seed);
  ByteBuffer buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
  buf.put(hf.hashBytes(key.getBytes()).asBytes());
  buf.flip();
  long gl1=buf.getLong();
  long gl2=buf.getLong(8);
  long[] hc=Murmur3.hash128(key.getBytes(),0,key.getBytes().length,seed);
  long m1=hc[0];
  long m2=hc[1];
  assertEquals(gl1,m1);
  assertEquals(gl2,m2);
  key="testkey128_testkey128";
  buf=ByteBuffer.allocate(16).order(ByteOrder.LITTLE_ENDIAN);
  buf.put(hf.hashBytes(key.getBytes()).asBytes());
  buf.flip();
  gl1=buf.getLong();
  gl2=buf.getLong(8);
  byte[] keyBytes=key.getBytes();
  hc=Murmur3.hash128(keyBytes,0,keyBytes.length,seed);
  m1=hc[0];
  m2=hc[1];
  assertEquals(gl1,m1);
  assertEquals(gl2,m2);
  byte[] offsetKeyBytes=new byte[keyBytes.length + 35];
  Arrays.fill(offsetKeyBytes,(byte)-1);
  System.arraycopy(keyBytes,0,offsetKeyBytes,35,keyBytes.length);
  hc=Murmur3.hash128(offsetKeyBytes,35,keyBytes.length,seed);
  assertEquals(gl1,hc[0]);
  assertEquals(gl2,hc[1]);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodeM3_64(){
  byte[] origin=("It was the best of times, it was the worst of times," + " it was the age of wisdom, it was the age of foolishness," + " it was the epoch of belief, it was the epoch of incredulity,"+ " it was the season of Light, it was the season of Darkness,"+ " it was the spring of hope, it was the winter of despair,"+ " we had everything before us, we had nothing before us,"+ " we were all going direct to Heaven,"+ " we were all going direct the other way.").getBytes();
  long hash=Murmur3.hash64(origin,0,origin.length);
  assertEquals(305830725663368540L,hash);
  byte[] originOffset=new byte[origin.length + 150];
  Arrays.fill(originOffset,(byte)123);
  System.arraycopy(origin,0,originOffset,150,origin.length);
  hash=Murmur3.hash64(originOffset,150,origin.length);
  assertEquals(305830725663368540L,hash);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testHashCodesM3_32_double(){
  int seed=123;
  Random rand=new Random(seed);
  HashFunction hf=Hashing.murmur3_32(seed);
  for (int i=0; i < 1000; i++) {
    double val=rand.nextDouble();
    byte[] data=ByteBuffer.allocate(8).putDouble(val).array();
    int hc1=hf.hashBytes(data).asInt();
    int hc2=Murmur3.hash32(data,data.length,seed);
    assertEquals(hc1,hc2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClient </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicDDLCommands() throws Exception {
  String db="testdb";
  String tableOne="testTable1";
  String tableTwo="testTable2";
  String tableThree="testTable3";
  HCatClient client=HCatClient.create(new Configuration(hcatConf));
  client.dropDatabase(db,true,HCatClient.DropDBMode.CASCADE);
  HCatCreateDBDesc dbDesc=HCatCreateDBDesc.create(db).ifNotExists(false).build();
  client.createDatabase(dbDesc);
  List<String> dbNames=client.listDatabaseNamesByPattern("*");
  assertTrue(dbNames.contains("default"));
  assertTrue(dbNames.contains(db));
  HCatDatabase testDb=client.getDatabase(db);
  assertTrue(testDb.getComment() == null);
  assertTrue(testDb.getProperties().size() == 0);
  String warehouseDir=System.getProperty("test.warehouse.dir","/user/hive/warehouse");
  if (useExternalMS) {
    assertTrue(testDb.getLocation().matches(".*" + "/" + db + ".db"));
  }
 else {
    String expectedDir=warehouseDir.replaceFirst("pfile:///","pfile:/");
    assertEquals(expectedDir + "/" + db+ ".db",testDb.getLocation());
  }
  ArrayList<HCatFieldSchema> cols=new ArrayList<HCatFieldSchema>();
  cols.add(new HCatFieldSchema("id",Type.INT,"id comment"));
  cols.add(new HCatFieldSchema("value",Type.STRING,"value comment"));
  HCatCreateTableDesc tableDesc=HCatCreateTableDesc.create(db,tableOne,cols).fileFormat("rcfile").build();
  client.createTable(tableDesc);
  HCatTable table1=client.getTable(db,tableOne);
  assertTrue(table1.getInputFileFormat().equalsIgnoreCase(RCFileInputFormat.class.getName()));
  assertTrue(table1.getOutputFileFormat().equalsIgnoreCase(RCFileOutputFormat.class.getName()));
  assertTrue(table1.getSerdeLib().equalsIgnoreCase(LazyBinaryColumnarSerDe.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  try {
    client.createTable(tableDesc);
    fail("Expected exception");
  }
 catch (  HCatException e) {
    assertTrue(e.getMessage().contains("AlreadyExistsException while creating table."));
  }
  client.dropTable(db,tableOne,true);
  HCatCreateTableDesc tableDesc2=HCatCreateTableDesc.create(db,tableTwo,cols).fieldsTerminatedBy('\001').escapeChar('\002').linesTerminatedBy('\003').mapKeysTerminatedBy('\004').collectionItemsTerminatedBy('\005').nullDefinedAs('\006').build();
  client.createTable(tableDesc2);
  HCatTable table2=client.getTable(db,tableTwo);
  assertTrue("Expected TextInputFormat, but got: " + table2.getInputFileFormat(),table2.getInputFileFormat().equalsIgnoreCase(TextInputFormat.class.getName()));
  assertTrue(table2.getOutputFileFormat().equalsIgnoreCase(HiveIgnoreKeyTextOutputFormat.class.getName()));
  assertTrue("SerdeParams not found",table2.getSerdeParams() != null);
  assertEquals("checking " + serdeConstants.FIELD_DELIM,Character.toString('\001'),table2.getSerdeParams().get(serdeConstants.FIELD_DELIM));
  assertEquals("checking " + serdeConstants.ESCAPE_CHAR,Character.toString('\002'),table2.getSerdeParams().get(serdeConstants.ESCAPE_CHAR));
  assertEquals("checking " + serdeConstants.LINE_DELIM,Character.toString('\003'),table2.getSerdeParams().get(serdeConstants.LINE_DELIM));
  assertEquals("checking " + serdeConstants.MAPKEY_DELIM,Character.toString('\004'),table2.getSerdeParams().get(serdeConstants.MAPKEY_DELIM));
  assertEquals("checking " + serdeConstants.COLLECTION_DELIM,Character.toString('\005'),table2.getSerdeParams().get(serdeConstants.COLLECTION_DELIM));
  assertEquals("checking " + serdeConstants.SERIALIZATION_NULL_FORMAT,Character.toString('\006'),table2.getSerdeParams().get(serdeConstants.SERIALIZATION_NULL_FORMAT));
  assertTrue(table2.getLocation().toLowerCase().matches(".*" + ("/" + db + ".db/"+ tableTwo).toLowerCase()));
  HCatCreateTableDesc tableDesc3=HCatCreateTableDesc.create(db,tableThree,cols).fileFormat("orcfile").build();
  client.createTable(tableDesc3);
  HCatTable table3=client.getTable(db,tableThree);
  assertTrue(table3.getInputFileFormat().equalsIgnoreCase(OrcInputFormat.class.getName()));
  assertTrue(table3.getOutputFileFormat().equalsIgnoreCase(OrcOutputFormat.class.getName()));
  assertTrue(table3.getSerdeLib().equalsIgnoreCase(OrcSerde.class.getName()));
  assertTrue(table1.getCols().equals(cols));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that partition-definitions can be replicated between HCat-instances,
 * independently of table-metadata replication.
 * 2 identical tables are created on 2 different HCat instances ("source" and "target").
 * On the source instance,
 * 1. One partition is added with the old format ("TEXTFILE").
 * 2. The table is updated with an additional column and the data-format changed to ORC.
 * 3. Another partition is added with the new format.
 * 4. The partitions' metadata is copied to the target HCat instance, without updating the target table definition.
 * 5. The partitions' metadata is tested to be an exact replica of that on the source.
 * @throws Exception
 */
@Test public void testPartitionRegistrationWithCustomSchema() throws Exception {
  try {
    startReplicationTargetMetaStoreIfRequired();
    HCatClient sourceMetaStore=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    sourceMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=new ArrayList<HCatFieldSchema>(Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,"")));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable sourceTable=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema).comment("Source table.");
    sourceMetaStore.createTable(HCatCreateTableDesc.create(sourceTable).build());
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",sourceTable);
    Map<String,String> partitionSpec_1=new HashMap<String,String>();
    partitionSpec_1.put("grid","AB");
    partitionSpec_1.put("dt","2011_12_31");
    HCatPartition sourcePartition_1=new HCatPartition(sourceTable,partitionSpec_1,makePartLocation(sourceTable,partitionSpec_1));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_1).build());
    assertEquals("Unexpected number of partitions. ",1,sourceMetaStore.getPartitions(dbName,tableName).size());
    HCatPartition addedPartition_1=sourceMetaStore.getPartition(dbName,tableName,partitionSpec_1);
    assertEquals("Column schema doesn't match.",sourceTable.getCols(),addedPartition_1.getColumns());
    assertEquals("InputFormat doesn't match.",sourceTable.getInputFileFormat(),addedPartition_1.getInputFormat());
    assertEquals("OutputFormat doesn't match.",sourceTable.getOutputFileFormat(),addedPartition_1.getOutputFormat());
    assertEquals("SerDe doesn't match.",sourceTable.getSerdeLib(),addedPartition_1.getSerDe());
    assertEquals("SerDe params don't match.",sourceTable.getSerdeParams(),addedPartition_1.getSerdeParams());
    HCatClient targetMetaStore=HCatClient.create(new Configuration(replicationTargetHCatConf));
    targetMetaStore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    targetMetaStore.createDatabase(HCatCreateDBDesc.create(dbName).build());
    HCatTable targetTable=targetMetaStore.deserializeTable(sourceMetaStore.serializeTable(sourceTable));
    targetMetaStore.createTable(HCatCreateTableDesc.create(targetTable).build());
    targetTable=targetMetaStore.getTable(dbName,tableName);
    assertEquals("Created table doesn't match the source.",HCatTable.NO_DIFF,targetTable.diff(sourceTable));
    List<HCatFieldSchema> newColumnSchema=new ArrayList<HCatFieldSchema>(columnSchema);
    newColumnSchema.add(new HCatFieldSchema("goo_new",Type.DOUBLE,""));
    Map<String,String> tableParams=new HashMap<String,String>(1);
    tableParams.put("orc.compress","ZLIB");
    sourceTable.cols(newColumnSchema).fileFormat("orcfile").tblProps(tableParams).serdeParam(serdeConstants.FIELD_DELIM,Character.toString('\001'));
    sourceMetaStore.updateTableSchema(dbName,tableName,sourceTable);
    sourceTable=sourceMetaStore.getTable(dbName,tableName);
    Map<String,String> partitionSpec_2=new HashMap<String,String>();
    partitionSpec_2.put("grid","AB");
    partitionSpec_2.put("dt","2012_01_01");
    HCatPartition sourcePartition_2=new HCatPartition(sourceTable,partitionSpec_2,makePartLocation(sourceTable,partitionSpec_2));
    sourceMetaStore.addPartition(HCatAddPartitionDesc.create(sourcePartition_2).build());
    List<HCatPartition> sourcePartitions=sourceMetaStore.getPartitions(dbName,tableName);
    assertEquals("Unexpected number of source partitions.",2,sourcePartitions.size());
    List<HCatAddPartitionDesc> addPartitionDescs=new ArrayList<HCatAddPartitionDesc>(sourcePartitions.size());
    for (    HCatPartition partition : sourcePartitions) {
      addPartitionDescs.add(HCatAddPartitionDesc.create(partition).build());
    }
    targetMetaStore.addPartitions(addPartitionDescs);
    List<HCatPartition> targetPartitions=targetMetaStore.getPartitions(dbName,tableName);
    assertEquals("Expected the same number of partitions. ",sourcePartitions.size(),targetPartitions.size());
    for (int i=0; i < targetPartitions.size(); ++i) {
      HCatPartition sourcePartition=sourcePartitions.get(i), targetPartition=targetPartitions.get(i);
      assertEquals("Column schema doesn't match.",sourcePartition.getColumns(),targetPartition.getColumns());
      assertEquals("InputFormat doesn't match.",sourcePartition.getInputFormat(),targetPartition.getInputFormat());
      assertEquals("OutputFormat doesn't match.",sourcePartition.getOutputFormat(),targetPartition.getOutputFormat());
      assertEquals("SerDe doesn't match.",sourcePartition.getSerDe(),targetPartition.getSerDe());
      assertEquals("SerDe params don't match.",sourcePartition.getSerdeParams(),targetPartition.getSerdeParams());
    }
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception! ",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test for event-based replication scenario
 * Does not test if replication actually happened, merely tests if we're able to consume a repl task
 * iter appropriately, calling all the functions expected of the interface, without errors.
 */
@Test public void testReplicationTaskIter() throws Exception {
  Configuration cfg=new Configuration(hcatConf);
  cfg.set(HiveConf.ConfVars.METASTORE_BATCH_RETRIEVE_MAX.varname,"10");
  cfg.set(HiveConf.ConfVars.HIVE_REPL_TASK_FACTORY.varname,EximReplicationTaskFactory.class.getName());
  HCatClient sourceMetastore=HCatClient.create(cfg);
  String dbName="testReplicationTaskIter";
  long baseId=sourceMetastore.getCurrentNotificationEventId();
{
    sourceMetastore.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    sourceMetastore.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
    String tblName1="T1";
    List<HCatFieldSchema> cols1=HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields();
    HCatTable table1=(new HCatTable(dbName,tblName1)).cols(cols1);
    sourceMetastore.createTable(HCatCreateTableDesc.create(table1).build());
    String tblName2="T2";
    List<HCatFieldSchema> cols2=HCatSchemaUtils.getHCatSchema("a:int").getFields();
    List<HCatFieldSchema> pcols2=HCatSchemaUtils.getHCatSchema("b:string").getFields();
    HCatTable table2=(new HCatTable(dbName,tblName2)).cols(cols2).partCols(pcols2);
    sourceMetastore.createTable(HCatCreateTableDesc.create(table2).build());
    HCatTable table2Created=sourceMetastore.getTable(dbName,tblName2);
    Map<String,String> ptnDesc1=new HashMap<String,String>();
    ptnDesc1.put("b","test1");
    HCatPartition ptn1=(new HCatPartition(table2Created,ptnDesc1,makePartLocation(table2Created,ptnDesc1)));
    sourceMetastore.addPartition(HCatAddPartitionDesc.create(ptn1).build());
    for (int i=0; i < 20; i++) {
      Map<String,String> ptnDesc=new HashMap<String,String>();
      ptnDesc.put("b","testmul" + i);
      HCatPartition ptn=(new HCatPartition(table2Created,ptnDesc,makePartLocation(table2Created,ptnDesc)));
      sourceMetastore.addPartition(HCatAddPartitionDesc.create(ptn).build());
      sourceMetastore.dropPartitions(dbName,tblName2,ptnDesc,true);
    }
    sourceMetastore.dropTable(dbName,tblName1,true);
    sourceMetastore.dropTable(dbName,tblName2,true);
    long currId=sourceMetastore.getCurrentNotificationEventId();
    assertTrue("currId[" + currId + "] must be more than 25 greater than baseId["+ baseId+ "]",currId > baseId + 25);
  }
  List<HCatNotificationEvent> notifs=sourceMetastore.getNextNotification(0,0,new IMetaStoreClient.NotificationFilter(){
    @Override public boolean accept(    NotificationEvent event){
      return true;
    }
  }
);
  for (  HCatNotificationEvent n : notifs) {
    LOG.info("notif from dblistener:" + n.getEventId() + ":"+ n.getEventTime()+ ",t:"+ n.getEventType()+ ",o:"+ n.getDbName()+ "."+ n.getTableName());
  }
  Iterator<ReplicationTask> taskIter=sourceMetastore.getReplicationTasks(0,-1,dbName,null);
  while (taskIter.hasNext()) {
    ReplicationTask task=taskIter.next();
    HCatNotificationEvent n=task.getEvent();
    LOG.info("notif from tasks:" + n.getEventId() + ":"+ n.getEventTime()+ ",t:"+ n.getEventType()+ ",o:"+ n.getDbName()+ "."+ n.getTableName()+ ",s:"+ n.getEventScope());
    LOG.info("task :" + task.getClass().getName());
    if (task.needsStagingDirs()) {
      StagingDirectoryProvider provider=new StagingDirectoryProvider(){
        @Override public String getStagingDirectory(        String key){
          LOG.info("getStagingDirectory(" + key + ") called!");
          return "/tmp/" + key.replaceAll(" ","_");
        }
      }
;
      task.withSrcStagingDirProvider(provider).withDstStagingDirProvider(provider);
    }
    if (task.isActionable()) {
      LOG.info("task was actionable!");
      Function<Command,String> commandDebugPrinter=new Function<Command,String>(){
        @Override public String apply(        @Nullable Command cmd){
          StringBuilder sb=new StringBuilder();
          String serializedCmd=null;
          try {
            serializedCmd=ReplicationUtils.serializeCommand(cmd);
          }
 catch (          IOException e) {
            e.printStackTrace();
            throw new RuntimeException(e);
          }
          sb.append("SERIALIZED:" + serializedCmd + "\n");
          Command command=null;
          try {
            command=ReplicationUtils.deserializeCommand(serializedCmd);
          }
 catch (          IOException e) {
            e.printStackTrace();
            throw new RuntimeException(e);
          }
          sb.append("CMD:[" + command.getClass().getName() + "]\n");
          sb.append("EVENTID:[" + command.getEventId() + "]\n");
          for (          String s : command.get()) {
            sb.append("CMD:" + s);
            sb.append("\n");
          }
          sb.append("Retriable:" + command.isRetriable() + "\n");
          sb.append("Undoable:" + command.isUndoable() + "\n");
          if (command.isUndoable()) {
            for (            String s : command.getUndo()) {
              sb.append("UNDO:" + s);
              sb.append("\n");
            }
          }
          List<String> locns=command.cleanupLocationsPerRetry();
          sb.append("cleanupLocationsPerRetry entries :" + locns.size());
          for (          String s : locns) {
            sb.append("RETRY_CLEANUP:" + s);
            sb.append("\n");
          }
          locns=command.cleanupLocationsAfterEvent();
          sb.append("cleanupLocationsAfterEvent entries :" + locns.size());
          for (          String s : locns) {
            sb.append("AFTER_EVENT_CLEANUP:" + s);
            sb.append("\n");
          }
          return sb.toString();
        }
      }
;
      LOG.info("On src:");
      for (      String s : Iterables.transform(task.getSrcWhCommands(),commandDebugPrinter)) {
        LOG.info(s);
      }
      LOG.info("On dest:");
      for (      String s : Iterables.transform(task.getDstWhCommands(),commandDebugPrinter)) {
        LOG.info(s);
      }
    }
 else {
      LOG.info("task was not actionable.");
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDropPartitionsWithPartialSpec() throws Exception {
  try {
    HCatClient client=HCatClient.create(new Configuration(hcatConf));
    final String dbName="myDb";
    final String tableName="myTable";
    client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
    client.createDatabase(HCatCreateDBDesc.create(dbName).build());
    List<HCatFieldSchema> columnSchema=Arrays.asList(new HCatFieldSchema("foo",Type.INT,""),new HCatFieldSchema("bar",Type.STRING,""));
    List<HCatFieldSchema> partitionSchema=Arrays.asList(new HCatFieldSchema("dt",Type.STRING,""),new HCatFieldSchema("grid",Type.STRING,""));
    HCatTable table=new HCatTable(dbName,tableName).cols(columnSchema).partCols(partitionSchema);
    client.createTable(HCatCreateTableDesc.create(table,false).build());
    table=client.getTable(dbName,tableName);
    assertNotNull("Table couldn't be queried for. ",table);
    Map<String,String> partitionSpec=new HashMap<String,String>();
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2011_12_31");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("grid","AB");
    partitionSpec.put("dt","2012_01_01");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","OB");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    partitionSpec.put("dt","2012_01_01");
    partitionSpec.put("grid","XB");
    client.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partitionSpec,makePartLocation(table,partitionSpec))).build());
    Map<String,String> partialPartitionSpec=new HashMap<String,String>();
    partialPartitionSpec.put("dt","2012_01_01");
    client.dropPartitions(dbName,tableName,partialPartitionSpec,true);
    List<HCatPartition> partitions=client.getPartitions(dbName,tableName);
    assertEquals("Unexpected number of partitions.",1,partitions.size());
    assertArrayEquals("Mismatched partition.",new String[]{"2011_12_31","AB"},partitions.get(0).getValues().toArray());
    List<HCatFieldSchema> partColumns=partitions.get(0).getPartColumns();
    assertEquals(2,partColumns.size());
    assertEquals("dt",partColumns.get(0).getName());
    assertEquals("grid",partColumns.get(1).getName());
    client.dropDatabase(dbName,false,HCatClient.DropDBMode.CASCADE);
  }
 catch (  Exception unexpected) {
    LOG.error("Unexpected exception!",unexpected);
    assertTrue("Unexpected exception! " + unexpected.getMessage(),false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.TestHCatClientNotification </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropTable() throws Exception {
  String dbName="default";
  String tableName="hcatdroptable";
  HCatTable table=new HCatTable(dbName,tableName);
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  hCatClient.dropTable(dbName,tableName,false);
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,events.size());
  HCatNotificationEvent event=events.get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_TABLE_EVENT,event.getEventType());
  assertEquals(dbName,event.getDbName());
  assertEquals(tableName,event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"hcatdroptable\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropDatabase() throws Exception {
  String dbname="hcatdropdb";
  hCatClient.createDatabase(HCatCreateDBDesc.create(dbname).build());
  hCatClient.dropDatabase(dbname,false,HCatClient.DropDBMode.RESTRICT);
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,events.size());
  HCatNotificationEvent event=events.get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_DATABASE_EVENT,event.getEventType());
  assertEquals(dbname,event.getDbName());
  assertNull(event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_DATABASE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"hcatdropdb\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addPartition() throws Exception {
  String dbName="default";
  String tableName="hcataddparttable";
  String partColName="pc";
  HCatTable table=new HCatTable(dbName,tableName);
  table.partCol(new HCatFieldSchema(partColName,TypeInfoFactory.stringTypeInfo,""));
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  String partName="testpart";
  Map<String,String> partSpec=new HashMap<String,String>(1);
  partSpec.put(partColName,partName);
  hCatClient.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partSpec,null)).build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(2,events.size());
  HCatNotificationEvent event=events.get(1);
  assertEquals(firstEventId + 2,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_ADD_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals(tableName,event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"ADD_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"hcataddparttable\",\"timestamp\":[0-9]+,\"partitions\":\\[\\{\"pc\":\"testpart\"}]}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createTable() throws Exception {
  String dbName="default";
  String tableName="hcatcreatetable";
  HCatTable table=new HCatTable(dbName,tableName);
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,events.size());
  HCatNotificationEvent event=events.get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_TABLE_EVENT,event.getEventType());
  assertEquals(dbName,event.getDbName());
  assertEquals("hcatcreatetable",event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"CREATE_TABLE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":\"hcatcreatetable\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createDatabase() throws Exception {
  hCatClient.createDatabase(HCatCreateDBDesc.create("myhcatdb").build());
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(1,events.size());
  HCatNotificationEvent event=events.get(0);
  assertEquals(firstEventId + 1,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_CREATE_DATABASE_EVENT,event.getEventType());
  assertEquals("myhcatdb",event.getDbName());
  assertNull(event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"CREATE_DATABASE\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"myhcatdb\",\"timestamp\":[0-9]+}"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dropPartition() throws Exception {
  String dbName="default";
  String tableName="hcatdropparttable";
  String partColName="pc";
  HCatTable table=new HCatTable(dbName,tableName);
  table.partCol(new HCatFieldSchema(partColName,TypeInfoFactory.stringTypeInfo,""));
  table.cols(Arrays.asList(new HCatFieldSchema("onecol",TypeInfoFactory.stringTypeInfo,"")));
  hCatClient.createTable(HCatCreateTableDesc.create(table).build());
  String partName="testpart";
  Map<String,String> partSpec=new HashMap<String,String>(1);
  partSpec.put(partColName,partName);
  hCatClient.addPartition(HCatAddPartitionDesc.create(new HCatPartition(table,partSpec,null)).build());
  hCatClient.dropPartitions(dbName,tableName,partSpec,false);
  List<HCatNotificationEvent> events=hCatClient.getNextNotification(firstEventId,0,null);
  assertEquals(3,events.size());
  HCatNotificationEvent event=events.get(2);
  assertEquals(firstEventId + 3,event.getEventId());
  assertTrue(event.getEventTime() >= startTime);
  assertEquals(HCatConstants.HCAT_DROP_PARTITION_EVENT,event.getEventType());
  assertEquals("default",event.getDbName());
  assertEquals(tableName,event.getTableName());
  assertTrue(event.getMessage().matches("\\{\"eventType\":\"DROP_PARTITION\",\"server\":\"\"," + "\"servicePrincipal\":\"\",\"db\":\"default\",\"table\":" + "\"hcatdropparttable\",\"timestamp\":[0-9]+,\"partitions\":\\[\\{\"pc\":\"testpart\"}]}"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.repl.commands.TestCommands </h4><pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicReplEximCommands() throws IOException, CommandNeedRetryException {
  int evid=111;
  String exportLocation=TEST_PATH + File.separator + "testBasicReplExim";
  Path tempPath=new Path(TEST_PATH,"testBasicReplEximTmp");
  String tempLocation=tempPath.toUri().getPath();
  String dbName="exim";
  String tableName="basicSrc";
  String importedTableName="basicDst";
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("b:string").getFields();
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  HCatTable table=(new HCatTable(dbName,tableName)).cols(cols).fileFormat("textfile");
  client.createTable(HCatCreateTableDesc.create(table).build());
  HCatTable t=client.getTable(dbName,tableName);
  assertNotNull(t);
  String[] data=new String[]{"eleven","twelve"};
  HcatTestUtils.createTestDataFile(tempLocation,data);
  CommandProcessorResponse ret=driver.run("LOAD DATA LOCAL INPATH '" + tempLocation + "' OVERWRITE INTO TABLE "+ dbName+ "."+ tableName);
  assertEquals(ret.getResponseCode() + ":" + ret.getErrorMessage(),null,ret.getException());
  CommandProcessorResponse selectRet=driver.run("SELECT * from " + dbName + "."+ tableName);
  assertEquals(selectRet.getResponseCode() + ":" + selectRet.getErrorMessage(),null,selectRet.getException());
  List<String> values=new ArrayList<String>();
  driver.getResults(values);
  assertEquals(2,values.size());
  assertEquals(data[0],values.get(0));
  assertEquals(data[1],values.get(1));
  ExportCommand exportCmd=new ExportCommand(dbName,tableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + exportCmd.get().get(0));
  CommandProcessorResponse ret2=driver.run(exportCmd.get().get(0));
  assertEquals(ret2.getResponseCode() + ":" + ret2.getErrorMessage(),null,ret2.getException());
  List<String> exportPaths=exportCmd.cleanupLocationsAfterEvent();
  assertEquals(1,exportPaths.size());
  String metadata=getMetadataContents(exportPaths.get(0));
  LOG.info("Export returned the following _metadata contents:");
  LOG.info(metadata);
  assertTrue(metadata + "did not match \"repl.scope\"=\"all\"",metadata.matches(".*\"repl.scope\":\"all\".*"));
  assertTrue(metadata + "has \"repl.last.id\"",metadata.matches(".*\"repl.last.id\":.*"));
  ImportCommand importCmd=new ImportCommand(dbName,importedTableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + importCmd.get().get(0));
  CommandProcessorResponse ret3=driver.run(importCmd.get().get(0));
  assertEquals(ret3.getResponseCode() + ":" + ret3.getErrorMessage(),null,ret3.getException());
  CommandProcessorResponse selectRet2=driver.run("SELECT * from " + dbName + "."+ importedTableName);
  assertEquals(selectRet2.getResponseCode() + ":" + selectRet2.getErrorMessage(),null,selectRet2.getException());
  List<String> values2=new ArrayList<String>();
  driver.getResults(values2);
  assertEquals(2,values2.size());
  assertEquals(data[0],values2.get(0));
  assertEquals(data[1],values2.get(1));
  HCatTable importedTable=client.getTable(dbName,importedTableName);
  assertNotNull(importedTable);
  assertTrue(importedTable.getTblProps().containsKey("repl.last.id"));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoopReplEximCommands() throws CommandNeedRetryException, IOException {
  int evid=333;
  String exportLocation=TEST_PATH + File.separator + "testNoopReplExim";
  String dbName="doesNotExist" + System.currentTimeMillis();
  String tableName="nope" + System.currentTimeMillis();
  ExportCommand noopExportCmd=new ExportCommand(dbName,tableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + noopExportCmd.get().get(0));
  CommandProcessorResponse ret=driver.run(noopExportCmd.get().get(0));
  assertEquals(ret.getResponseCode() + ":" + ret.getErrorMessage(),null,ret.getException());
  List<String> exportPaths=noopExportCmd.cleanupLocationsAfterEvent();
  assertEquals(1,exportPaths.size());
  String metadata=getMetadataContents(exportPaths.get(0));
  LOG.info("Export returned the following _metadata contents:");
  LOG.info(metadata);
  assertTrue(metadata + "did not match \"repl.noop\"=\"true\"",metadata.matches(".*\"repl.noop\":\"true\".*"));
  ImportCommand noopImportCmd=new ImportCommand(dbName,tableName,null,exportLocation,false,evid);
  LOG.info("About to run :" + noopImportCmd.get().get(0));
  CommandProcessorResponse ret2=driver.run(noopImportCmd.get().get(0));
  assertEquals(ret2.getResponseCode() + ":" + ret2.getErrorMessage(),null,ret2.getException());
  Exception onfe=null;
  try {
    HCatDatabase d_doesNotExist=client.getDatabase(dbName);
  }
 catch (  Exception e) {
    onfe=e;
  }
  assertNotNull(onfe);
  assertTrue(onfe instanceof ObjectNotFoundException);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetadataReplEximCommands() throws IOException, CommandNeedRetryException {
  int evid=222;
  String exportLocation=TEST_PATH + File.separator + "testMetadataReplExim";
  Path tempPath=new Path(TEST_PATH,"testMetadataReplEximTmp");
  String tempLocation=tempPath.toUri().getPath();
  String dbName="exim";
  String tableName="basicSrc";
  String importedTableName="basicDst";
  List<HCatFieldSchema> cols=HCatSchemaUtils.getHCatSchema("b:string").getFields();
  client.dropDatabase(dbName,true,HCatClient.DropDBMode.CASCADE);
  client.createDatabase(HCatCreateDBDesc.create(dbName).ifNotExists(false).build());
  HCatTable table=(new HCatTable(dbName,tableName)).cols(cols).fileFormat("textfile");
  client.createTable(HCatCreateTableDesc.create(table).build());
  HCatTable t=client.getTable(dbName,tableName);
  assertNotNull(t);
  String[] data=new String[]{"eleven","twelve"};
  HcatTestUtils.createTestDataFile(tempLocation,data);
  CommandProcessorResponse ret=driver.run("LOAD DATA LOCAL INPATH '" + tempLocation + "' OVERWRITE INTO TABLE "+ dbName+ "."+ tableName);
  assertEquals(ret.getResponseCode() + ":" + ret.getErrorMessage(),null,ret.getException());
  CommandProcessorResponse selectRet=driver.run("SELECT * from " + dbName + "."+ tableName);
  assertEquals(selectRet.getResponseCode() + ":" + selectRet.getErrorMessage(),null,selectRet.getException());
  List<String> values=new ArrayList<String>();
  driver.getResults(values);
  assertEquals(2,values.size());
  assertEquals(data[0],values.get(0));
  assertEquals(data[1],values.get(1));
  ExportCommand exportMdCmd=new ExportCommand(dbName,tableName,null,exportLocation,true,evid);
  LOG.info("About to run :" + exportMdCmd.get().get(0));
  CommandProcessorResponse ret2=driver.run(exportMdCmd.get().get(0));
  assertEquals(ret2.getResponseCode() + ":" + ret2.getErrorMessage(),null,ret2.getException());
  List<String> exportPaths=exportMdCmd.cleanupLocationsAfterEvent();
  assertEquals(1,exportPaths.size());
  String metadata=getMetadataContents(exportPaths.get(0));
  LOG.info("Export returned the following _metadata contents:");
  LOG.info(metadata);
  assertTrue(metadata + "did not match \"repl.scope\"=\"metadata\"",metadata.matches(".*\"repl.scope\":\"metadata\".*"));
  assertTrue(metadata + "has \"repl.last.id\"",metadata.matches(".*\"repl.last.id\":.*"));
  ImportCommand importMdCmd=new ImportCommand(dbName,importedTableName,null,exportLocation,true,evid);
  LOG.info("About to run :" + importMdCmd.get().get(0));
  CommandProcessorResponse ret3=driver.run(importMdCmd.get().get(0));
  assertEquals(ret3.getResponseCode() + ":" + ret3.getErrorMessage(),null,ret3.getException());
  CommandProcessorResponse selectRet2=driver.run("SELECT * from " + dbName + "."+ importedTableName);
  assertEquals(selectRet2.getResponseCode() + ":" + selectRet2.getErrorMessage(),null,selectRet2.getException());
  List<String> values2=new ArrayList<String>();
  driver.getResults(values2);
  assertEquals(0,values2.size());
  HCatTable importedTable=client.getTable(dbName,importedTableName);
  assertNotNull(importedTable);
  assertTrue(importedTable.getTblProps().containsKey("repl.last.id"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.api.repl.exim.TestEximReplicationTasks </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropDb() throws IOException {
  Database db=new Database();
  db.setName("testdb");
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_DROP_DATABASE_EVENT,msgFactory.buildCreateDatabaseMessage(db).toString());
  event.setDbName(db.getName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyDropDbReplicationTask(rtask);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddPartition() throws IOException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  List<FieldSchema> pkeys=HCatSchemaUtils.getFieldSchemas(HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields());
  t.setPartitionKeys(pkeys);
  List<Partition> addedPtns=new ArrayList<Partition>();
  addedPtns.add(createPtn(t,Arrays.asList("120","abc")));
  addedPtns.add(createPtn(t,Arrays.asList("201","xyz")));
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_ADD_PARTITION_EVENT,msgFactory.buildAddPartitionMessage(t,addedPtns.iterator()).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyAddPartitionReplicationTask(rtask,t,addedPtns);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateDb(){
  Database db=new Database();
  db.setName("testdb");
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_CREATE_DATABASE_EVENT,msgFactory.buildCreateDatabaseMessage(db).toString());
  event.setDbName(db.getName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyCreateDbReplicationTask(rtask);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlterPartition() throws HCatException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  List<FieldSchema> pkeys=HCatSchemaUtils.getFieldSchemas(HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields());
  t.setPartitionKeys(pkeys);
  Partition p=createPtn(t,Arrays.asList("102","lmn"));
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_ALTER_PARTITION_EVENT,msgFactory.buildAlterPartitionMessage(t,p,p).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyAlterPartitionReplicationTask(rtask,t,p);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlterTable() throws IOException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_ALTER_TABLE_EVENT,msgFactory.buildAlterTableMessage(t,t).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyAlterTableReplicationTask(rtask);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateTable() throws IOException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_CREATE_TABLE_EVENT,msgFactory.buildCreateTableMessage(t).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyCreateTableReplicationTask(rtask);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropTable() throws IOException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_DROP_TABLE_EVENT,msgFactory.buildDropTableMessage(t).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyDropTableReplicationTask(rtask);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDropPartition() throws HCatException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  List<FieldSchema> pkeys=HCatSchemaUtils.getFieldSchemas(HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields());
  t.setPartitionKeys(pkeys);
  Partition p=createPtn(t,Arrays.asList("102","lmn"));
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_DROP_PARTITION_EVENT,msgFactory.buildDropPartitionMessage(t,Collections.singletonList(p).iterator()).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyDropPartitionReplicationTask(rtask,t,p);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInsert() throws HCatException {
  Table t=new Table();
  t.setDbName("testdb");
  t.setTableName("testtable");
  List<FieldSchema> pkeys=HCatSchemaUtils.getFieldSchemas(HCatSchemaUtils.getHCatSchema("a:int,b:string").getFields());
  t.setPartitionKeys(pkeys);
  Partition p=createPtn(t,Arrays.asList("102","lmn"));
  List<String> files=Arrays.asList("/tmp/test123");
  NotificationEvent event=new NotificationEvent(getEventId(),getTime(),HCatConstants.HCAT_INSERT_EVENT,msgFactory.buildInsertMessage(t.getDbName(),t.getTableName(),getPtnDesc(t,p),files).toString());
  event.setDbName(t.getDbName());
  event.setTableName(t.getTableName());
  HCatNotificationEvent hev=new HCatNotificationEvent(event);
  ReplicationTask rtask=ReplicationTask.create(client,hev);
  assertEquals(hev.toString(),rtask.getEvent().toString());
  verifyInsertReplicationTask(rtask,t,p);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.cli.TestSemanticAnalysis </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddDriverInfo() throws IOException, MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  query="create table junit_sem_analysis (a int) partitioned by (b string)  stored as " + "INPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileInputFormat' OUTPUTFORMAT " + "'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' inputdriver 'mydriver' outputdriver 'yourdriver' ";
  assertEquals(0,hcatDriver.run(query).getResponseCode());
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTableIfNotExists() throws MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table " + TBL_NAME);
  hcatDriver.run("create table " + TBL_NAME + " (a int) stored as RCFILE");
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  List<FieldSchema> cols=tbl.getSd().getCols();
  assertEquals(1,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a","int",null)));
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  CommandProcessorResponse resp=hcatDriver.run("create table if not exists junit_sem_analysis (a int) stored as RCFILE");
  assertEquals(0,resp.getResponseCode());
  assertNull(resp.getErrorMessage());
  tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  cols=tbl.getSd().getCols();
  assertEquals(1,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a","int",null)));
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlterTblFFpart() throws MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  driver.run("drop table junit_sem_analysis");
  driver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as TEXTFILE");
  driver.run("alter table junit_sem_analysis add partition (b='2010-10-10')");
  hcatDriver.run("alter table junit_sem_analysis partition (b='2010-10-10') set fileformat RCFILE");
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  assertEquals(TextInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(HiveIgnoreKeyTextOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  List<String> partVals=new ArrayList<String>(1);
  partVals.add("2010-10-10");
  Partition part=client.getPartition(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME,partVals);
  assertEquals(RCFileInputFormat.class.getName(),part.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),part.getSd().getOutputFormat());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCreateTblWithLowerCasePartNames() throws CommandNeedRetryException, MetaException, TException, NoSuchObjectException {
  driver.run("drop table junit_sem_analysis");
  CommandProcessorResponse resp=driver.run("create table junit_sem_analysis (a int) partitioned by (B string) stored as TEXTFILE");
  assertEquals(resp.getResponseCode(),0);
  assertEquals(null,resp.getErrorMessage());
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  assertEquals("Partition key name case problem","b",tbl.getPartitionKeys().get(0).getName());
  driver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAlterTableSetFF() throws IOException, MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  hcatDriver.run("create table junit_sem_analysis (a int) partitioned by (b string) stored as RCFILE");
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  hcatDriver.run("alter table junit_sem_analysis set fileformat INPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileInputFormat' OUTPUTFORMAT " + "'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' inputdriver 'mydriver' outputdriver 'yourdriver'");
  hcatDriver.run("desc extended junit_sem_analysis");
  tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  assertEquals(RCFileInputFormat.class.getName(),tbl.getSd().getInputFormat());
  assertEquals(RCFileOutputFormat.class.getName(),tbl.getSd().getOutputFormat());
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddReplaceCols() throws IOException, MetaException, TException, NoSuchObjectException, CommandNeedRetryException {
  hcatDriver.run("drop table junit_sem_analysis");
  hcatDriver.run("create table junit_sem_analysis (a int, c string) partitioned by (b string) stored as RCFILE");
  CommandProcessorResponse response=hcatDriver.run("alter table junit_sem_analysis replace columns (a1 tinyint)");
  assertEquals(0,response.getResponseCode());
  response=hcatDriver.run("alter table junit_sem_analysis add columns (d tinyint)");
  assertEquals(0,response.getResponseCode());
  assertNull(response.getErrorMessage());
  response=hcatDriver.run("describe extended junit_sem_analysis");
  assertEquals(0,response.getResponseCode());
  Table tbl=client.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME,TBL_NAME);
  List<FieldSchema> cols=tbl.getSd().getCols();
  assertEquals(2,cols.size());
  assertTrue(cols.get(0).equals(new FieldSchema("a1","tinyint",null)));
  assertTrue(cols.get(1).equals(new FieldSchema("d","tinyint",null)));
  hcatDriver.run("drop table junit_sem_analysis");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.common.TestHCatUtil </h4><pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFsPermissionOperation(){
  HashMap<String,Integer> permsCode=new HashMap<String,Integer>();
  for (int i=0; i < 8; i++) {
    for (int j=0; j < 8; j++) {
      for (int k=0; k < 8; k++) {
        StringBuilder sb=new StringBuilder();
        sb.append("0");
        sb.append(i);
        sb.append(j);
        sb.append(k);
        Integer code=(((i * 8) + j) * 8) + k;
        String perms=(new FsPermission(Short.decode(sb.toString()))).toString();
        if (permsCode.containsKey(perms)) {
          Assert.assertEquals("permissions(" + perms + ") mapped to multiple codes",code,permsCode.get(perms));
        }
        permsCode.put(perms,code);
        assertFsPermissionTransformationIsGood(perms);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.common.TestHiveClientCache </h4><pre class="type-11 type-14 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check that a *new* client is created if asked from different threads even with
 * the same hive configuration
 * @throws ExecutionException
 * @throws InterruptedException
 */
@Test public void testMultipleThreadAccess() throws ExecutionException, InterruptedException {
  final HiveClientCache cache=new HiveClientCache(1000);
class GetHiveClient implements Callable<IMetaStoreClient> {
    @Override public IMetaStoreClient call() throws IOException, MetaException, LoginException {
      return cache.get(hiveConf);
    }
  }
  ExecutorService executor=Executors.newFixedThreadPool(2);
  Callable<IMetaStoreClient> worker1=new GetHiveClient();
  Callable<IMetaStoreClient> worker2=new GetHiveClient();
  Future<IMetaStoreClient> clientFuture1=executor.submit(worker1);
  Future<IMetaStoreClient> clientFuture2=executor.submit(worker2);
  IMetaStoreClient client1=clientFuture1.get();
  IMetaStoreClient client2=clientFuture2.get();
  assertNotNull(client1);
  assertNotNull(client2);
  assertNotSame(client1,client2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.data.TestLazyHCatRecord </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetWithName() throws Exception {
  TypeInfo ti=getTypeInfo();
  HCatRecord r=new LazyHCatRecord(getHCatRecord(),getObjectInspector(ti));
  HCatSchema schema=HCatSchemaUtils.getHCatSchema(ti).get(0).getStructSubSchema();
  Assert.assertEquals(INT_CONST,((Integer)r.get("an_int",schema)).intValue());
  Assert.assertEquals(LONG_CONST,((Long)r.get("a_long",schema)).longValue());
  Assert.assertEquals(DOUBLE_CONST,((Double)r.get("a_double",schema)).doubleValue(),0);
  Assert.assertEquals(STRING_CONST,(String)r.get("a_string",schema));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.hbase.TestPigHBaseStorageHandler </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigFilterProjection() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, testqualifier1 string, testqualifier2 string) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.default.storage.type'='binary')";
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  populateHBaseTable(hbaseTableName);
  Configuration conf=new Configuration(getHbaseConf());
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes("testFamily"));
  ResultScanner scanner=table.getScanner(scan);
  int index=1;
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + databaseName + "."+ tableName+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("B = filter A by key < 5;");
  server.registerQuery("C = foreach B generate key,testqualifier2;");
  Iterator<Tuple> itr=server.openIterator("C");
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertTrue(t.size() == 2);
    assertTrue(t.get(0).getClass() == Integer.class);
    assertEquals(index,t.get(0));
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals("textB-" + index,t.get(1));
    index++;
  }
  assertEquals(index - 1,4);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPigPopulation() throws Exception {
  Initialize();
  String tableName=newTableName("MyTable");
  String databaseName=newTableName("MyDatabase");
  String hbaseTableName=(databaseName + "." + tableName).toLowerCase();
  String db_dir=HCatUtil.makePathASafeFileName(getTestDir() + "/hbasedb");
  String POPTXT_FILE_NAME=db_dir + "testfile.txt";
  float f=-100.1f;
  String dbQuery="CREATE DATABASE IF NOT EXISTS " + databaseName + " LOCATION '"+ db_dir+ "'";
  String deleteQuery="DROP TABLE " + databaseName + "."+ tableName;
  String tableQuery="CREATE TABLE " + databaseName + "."+ tableName+ "(key int, testqualifier1 float, testqualifier2 string) STORED BY "+ "'org.apache.hadoop.hive.hbase.HBaseStorageHandler'"+ " WITH SERDEPROPERTIES ('hbase.columns.mapping'=':key,testFamily:testQualifier1,testFamily:testQualifier2')"+ " TBLPROPERTIES ('hbase.table.default.storage.type'='binary')";
  String selectQuery="SELECT * from " + databaseName.toLowerCase() + "."+ tableName.toLowerCase();
  CommandProcessorResponse responseOne=driver.run(deleteQuery);
  assertEquals(0,responseOne.getResponseCode());
  CommandProcessorResponse responseTwo=driver.run(dbQuery);
  assertEquals(0,responseTwo.getResponseCode());
  CommandProcessorResponse responseThree=driver.run(tableQuery);
  HBaseAdmin hAdmin=new HBaseAdmin(getHbaseConf());
  boolean doesTableExist=hAdmin.tableExists(hbaseTableName);
  assertTrue(doesTableExist);
  createTestDataFile(POPTXT_FILE_NAME);
  PigServer server=new PigServer(ExecType.LOCAL,hcatConf.getAllProperties());
  server.registerQuery("A = load '" + POPTXT_FILE_NAME + "' using PigStorage() as (key:int, testqualifier1:float, testqualifier2:chararray);");
  server.registerQuery("B = filter A by (key > 2) AND (key < 8) ;");
  server.registerQuery("store B into '" + databaseName.toLowerCase() + "."+ tableName.toLowerCase()+ "' using  org.apache.hive.hcatalog.pig.HCatStorer();");
  server.registerQuery("C = load '" + databaseName.toLowerCase() + "."+ tableName.toLowerCase()+ "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedBSchema=server.dumpSchema("C");
  List<FieldSchema> fields=dumpedBSchema.getFields();
  assertEquals(3,fields.size());
  assertEquals(DataType.INTEGER,fields.get(0).type);
  assertEquals("key",fields.get(0).alias.toLowerCase());
  assertEquals(DataType.FLOAT,fields.get(1).type);
  assertEquals("testQualifier1".toLowerCase(),fields.get(1).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,fields.get(2).type);
  assertEquals("testQualifier2".toLowerCase(),fields.get(2).alias.toLowerCase());
  Configuration conf=new Configuration(getHbaseConf());
  HTable table=new HTable(conf,hbaseTableName);
  Scan scan=new Scan();
  scan.addFamily(Bytes.toBytes("testFamily"));
  byte[] familyNameBytes=Bytes.toBytes("testFamily");
  ResultScanner scanner=table.getScanner(scan);
  int index=3;
  int count=0;
  for (  Result result : scanner) {
    assertEquals(index,Bytes.toInt(result.getRow()));
    assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes("testQualifier1")));
    assertEquals((index + f),Bytes.toFloat(result.getValue(familyNameBytes,Bytes.toBytes("testQualifier1"))),0);
    assertTrue(result.containsColumn(familyNameBytes,Bytes.toBytes("testQualifier2")));
    assertEquals(("textB-" + index).toString(),Bytes.toString(result.getValue(familyNameBytes,Bytes.toBytes("testQualifier2"))));
    index++;
    count++;
  }
  assertEquals(count,5);
  driver.run(selectQuery);
  ArrayList<String> result=new ArrayList<String>();
  driver.getResults(result);
  assertEquals(5,result.size());
  Iterator<String> itr=result.iterator();
  for (int i=3; i <= 7; i++) {
    String tokens[]=itr.next().split("\\s+");
    assertEquals(i,Integer.parseInt(tokens[0]));
    assertEquals(i + f,Float.parseFloat(tokens[1]),0);
    assertEquals(("textB-" + i).toString(),tokens[2]);
  }
  CommandProcessorResponse responseFour=driver.run(deleteQuery);
  assertEquals(0,responseFour.getResponseCode());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatHiveCompatibility </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnpartedReadWrite() throws Exception {
  driver.run("drop table if exists junit_unparted_noisd");
  String createTable="create table junit_unparted_noisd(a int) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_unparted_noisd' using org.apache.hive.hcatalog.pig.HCatStorer();");
  logAndRegister(server,"B = load 'default.junit_unparted_noisd' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(1,t.size());
    Assert.assertEquals(t.get(0),i);
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_unparted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartedRead() throws Exception {
  driver.run("drop table if exists junit_parted_noisd");
  String createTable="create table junit_parted_noisd(a int) partitioned by (b string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  Table table=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  PigServer server=new PigServer(ExecType.LOCAL);
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  logAndRegister(server,"store A into 'default.junit_parted_noisd' using org.apache.hive.hcatalog.pig.HCatStorer('b=42');");
  logAndRegister(server,"B = load 'default.junit_parted_noisd' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    Assert.assertEquals(2,t.size());
    Assert.assertEquals(t.get(0),i);
    Assert.assertEquals(t.get(1),"42");
    i++;
  }
  Assert.assertFalse(itr.hasNext());
  Assert.assertEquals(11,i);
  Table table2=client.getTable("default","junit_parted_noisd");
  Assert.assertTrue(table2.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  Partition ptn=client.getPartition("default","junit_parted_noisd",Arrays.asList("42"));
  Assert.assertNotNull(ptn);
  Assert.assertTrue(ptn.getSd().getInputFormat().equals(HCatConstants.HIVE_RCFILE_IF_CLASS));
  driver.run("drop table junit_unparted_noisd");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatHiveThriftCompatibility </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Create a table with no explicit schema and ensure its correctly
 * discovered from the thrift struct.
 */
@Test public void testDynamicCols() throws Exception {
  Assert.assertEquals(0,driver.run("drop table if exists test_thrift").getResponseCode());
  Assert.assertEquals(0,driver.run("create external table test_thrift " + "partitioned by (year string) " + "row format serde 'org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer' "+ "with serdeproperties ( "+ "  'serialization.class'='org.apache.hadoop.hive.serde2.thrift.test.IntString', "+ "  'serialization.format'='org.apache.thrift.protocol.TBinaryProtocol') "+ "stored as"+ "  inputformat 'org.apache.hadoop.mapred.SequenceFileInputFormat'"+ "  outputformat 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'").getResponseCode());
  Assert.assertEquals(0,driver.run("alter table test_thrift add partition (year = '2012') location '" + intStringSeq.getParent() + "'").getResponseCode());
  PigServer pigServer=new PigServer(ExecType.LOCAL);
  pigServer.registerQuery("A = load 'test_thrift' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema expectedSchema=new Schema();
  expectedSchema.add(new Schema.FieldSchema("myint",DataType.INTEGER));
  expectedSchema.add(new Schema.FieldSchema("mystring",DataType.CHARARRAY));
  expectedSchema.add(new Schema.FieldSchema("underscore_int",DataType.INTEGER));
  expectedSchema.add(new Schema.FieldSchema("year",DataType.CHARARRAY));
  Assert.assertEquals(expectedSchema,pigServer.dumpSchema("A"));
  Iterator<Tuple> iterator=pigServer.openIterator("A");
  Tuple t=iterator.next();
  Assert.assertEquals(1,t.get(0));
  Assert.assertEquals("one",t.get(1));
  Assert.assertEquals(1,t.get(2));
  Assert.assertEquals("2012",t.get(3));
  Assert.assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatNonPartitioned </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatNonPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  runMRCreate(null,partitionColumns,writeRecords,10,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(null,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_NON_EMPTY_TABLE,((HCatException)exc).getErrorType());
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","p1value2");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc != null);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  }
  if (isTableImmutable()) {
    runMRRead(10);
  }
 else {
    runMRRead(30);
  }
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestHCatPartitioned </h4><pre class="type-11 type-12 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHCatPartitionedTable() throws Exception {
  Map<String,String> partitionMap=new HashMap<String,String>();
  partitionMap.put("part1","p1value1");
  partitionMap.put("part0","501");
  runMRCreate(partitionMap,partitionColumns,writeRecords,10,true);
  partitionMap.clear();
  partitionMap.put("PART1","p1value2");
  partitionMap.put("PART0","502");
  runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  IOException exc=null;
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertEquals(!isTableImmutable(),j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertTrue(exc instanceof HCatException);
    assertTrue(ErrorType.ERROR_DUPLICATE_PARTITION.equals(((HCatException)exc).getErrorType()));
  }
  if (!isTableImmutable()) {
    assertNull(exc);
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px1","p1value2");
  partitionMap.put("px0","502");
  try {
    Job j=runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
    assertFalse(j.isSuccessful());
  }
 catch (  IOException e) {
    exc=e;
    assertNotNull(exc);
    assertTrue(exc instanceof HCatException);
    assertEquals(ErrorType.ERROR_MISSING_PARTITION_KEY,((HCatException)exc).getErrorType());
  }
  exc=null;
  partitionMap.clear();
  partitionMap.put("px","512");
  try {
    runMRCreate(partitionMap,partitionColumns,writeRecords,20,true);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertNotNull(exc);
  assertTrue(exc instanceof HCatException);
  assertEquals(ErrorType.ERROR_INVALID_PARTITION_VALUES,((HCatException)exc).getErrorType());
  exc=null;
  try {
    runMRCreate(null,partitionColumns,writeRecords,20,false);
  }
 catch (  IOException e) {
    exc=e;
  }
  assertTrue(exc == null);
  if (isTableImmutable()) {
    runMRRead(30);
  }
 else {
    runMRRead(50);
  }
  runMRRead(10,"part1 = \"p1value1\"");
  runMRRead(10,"part0 = \"501\"");
  if (isTableImmutable()) {
    runMRRead(20,"part1 = \"p1value2\"");
    runMRRead(30,"part1 = \"p1value1\" or part1 = \"p1value2\"");
    runMRRead(20,"part0 = \"502\"");
    runMRRead(30,"part0 = \"501\" or part0 = \"502\"");
  }
 else {
    runMRRead(40,"part1 = \"p1value2\"");
    runMRRead(50,"part1 = \"p1value1\" or part1 = \"p1value2\"");
    runMRRead(40,"part0 = \"502\"");
    runMRRead(50,"part0 = \"501\" or part0 = \"502\"");
  }
  tableSchemaTest();
  columnOrderChangeTest();
  hiveReadTest();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestInputJobInfo </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test4ArgCreate() throws Exception {
  Properties p=new Properties();
  p.setProperty("key","value");
  InputJobInfo jobInfo=InputJobInfo.create("Db","Table","Filter",p);
  Assert.assertEquals("Db",jobInfo.getDatabaseName());
  Assert.assertEquals("Table",jobInfo.getTableName());
  Assert.assertEquals("Filter",jobInfo.getFilter());
  Assert.assertEquals("value",jobInfo.getProperties().getProperty("key"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestMultiOutputFormat </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A test job that reads a input file and outputs each word and the index of
 * the word encountered to a text file and sequence file with different key
 * values.
 */
@Test public void testMultiOutputFormatWithoutReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutNoReduce");
  job.setMapperClass(MultiOutWordIndexMapper.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setNumReduceTasks(0);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  String fileContent="Hello World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  DistributedCache.addFileToClassPath(new Path(inputFile),job.getConfiguration(),fs);
  String dummyFile=createInputFile("dummy file");
  DistributedCache.addFileToClassPath(new Path(dummyFile),configurer.getJob("out1").getConfiguration(),fs);
  DistributedCache.addFileToClassPath(new Path(inputFile),configurer.getJob("out2").getConfiguration(),fs);
  configurer.configure();
  Path[] fileClassPaths=DistributedCache.getFileClassPaths(job.getConfiguration());
  List<Path> fileClassPathsList=Arrays.asList(fileClassPaths);
  Assert.assertTrue("Cannot find " + (new Path(inputFile)) + " in "+ fileClassPathsList,fileClassPathsList.contains(new Path(inputFile)));
  Assert.assertTrue("Cannot find " + (new Path(dummyFile)) + " in "+ fileClassPathsList,fileClassPathsList.contains(new Path(dummyFile)));
  URI[] cacheFiles=DistributedCache.getCacheFiles(job.getConfiguration());
  List<URI> cacheFilesList=Arrays.asList(cacheFiles);
  URI inputFileURI=new Path(inputFile).makeQualified(fs).toUri();
  Assert.assertTrue("Cannot find " + inputFileURI + " in "+ cacheFilesList,cacheFilesList.contains(inputFileURI));
  URI dummyFileURI=new Path(dummyFile).makeQualified(fs).toUri();
  Assert.assertTrue("Cannot find " + dummyFileURI + " in "+ cacheFilesList,cacheFilesList.contains(dummyFileURI));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-m-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-m-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words=fileContent.split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  LOG.info("Verifying file contents");
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 1) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 1),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * A word count test job that reads a input file and outputs the count of
 * words to a text file and sequence file with different key values.
 */
@Test public void testMultiOutputFormatWithReduce() throws Throwable {
  Job job=new Job(mrConf,"MultiOutWithReduce");
  job.setMapperClass(WordCountMapper.class);
  job.setReducerClass(MultiOutWordCountReducer.class);
  job.setJarByClass(this.getClass());
  job.setInputFormatClass(TextInputFormat.class);
  job.setOutputFormatClass(MultiOutputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(IntWritable.class);
  JobConfigurer configurer=MultiOutputFormat.createConfigurer(job);
  configurer.addOutputFormat("out1",TextOutputFormat.class,IntWritable.class,Text.class);
  configurer.addOutputFormat("out2",SequenceFileOutputFormat.class,Text.class,IntWritable.class);
  configurer.addOutputFormat("out3",NullOutputFormat.class,Text.class,IntWritable.class);
  Path outDir=new Path(workDir.getPath(),job.getJobName());
  FileOutputFormat.setOutputPath(configurer.getJob("out1"),new Path(outDir,"out1"));
  FileOutputFormat.setOutputPath(configurer.getJob("out2"),new Path(outDir,"out2"));
  configurer.configure();
  String fileContent="Hello World Hello World World";
  String inputFile=createInputFile(fileContent);
  FileInputFormat.setInputPaths(job,new Path(inputFile));
  Assert.assertTrue(job.waitForCompletion(true));
  Path textOutPath=new Path(outDir,"out1/part-r-00000");
  String[] textOutput=readFully(textOutPath).split("\n");
  Path seqOutPath=new Path(outDir,"out2/part-r-00000");
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,seqOutPath,mrConf);
  Text key=new Text();
  IntWritable value=new IntWritable();
  String[] words="Hello World".split(" ");
  Assert.assertEquals(words.length,textOutput.length);
  for (int i=0; i < words.length; i++) {
    Assert.assertEquals((i + 2) + "\t" + words[i],textOutput[i]);
    reader.next(key,value);
    Assert.assertEquals(words[i],key.toString());
    Assert.assertEquals((i + 2),value.get());
  }
  Assert.assertFalse(reader.next(key,value));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.mapreduce.TestSequenceFileReadWrite </h4><pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteRead() throws Exception {
  String createTable="CREATE TABLE demo_table(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + inputFileName + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSequenceTableWriteReadMR() throws Exception {
  String createTable="CREATE TABLE demo_table_2(a0 int, a1 String, a2 String) STORED AS SEQUENCEFILE";
  driver.run("drop table demo_table_2");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-seq-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  TextInputFormat.setInputPaths(job,inputFileName);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_2",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  job.setNumReduceTasks(0);
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("C = load 'default.demo_table_2' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("C");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteReadMR() throws Exception {
  String createTable="CREATE TABLE demo_table_3(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_3");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  Configuration conf=new Configuration();
  conf.set(HCatConstants.HCAT_KEY_HIVE_CONF,HCatUtil.serialize(hiveConf.getAllProperties()));
  Job job=new Job(conf,"Write-hcat-text-table");
  job.setJarByClass(TestSequenceFileReadWrite.class);
  job.setMapperClass(Map.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(DefaultHCatRecord.class);
  job.setInputFormatClass(TextInputFormat.class);
  job.setNumReduceTasks(0);
  TextInputFormat.setInputPaths(job,inputFileName);
  HCatOutputFormat.setOutput(job,OutputJobInfo.create(MetaStoreUtils.DEFAULT_DATABASE_NAME,"demo_table_3",null));
  job.setOutputFormatClass(HCatOutputFormat.class);
  HCatOutputFormat.setSchema(job,getSchema());
  assertTrue(job.waitForCompletion(true));
  if (!HCatUtil.isHadoop23()) {
    new FileOutputCommitterContainer(job,null).commitJob(job);
  }
  assertTrue(job.isSuccessful());
  server.setBatchOn();
  server.registerQuery("D = load 'default.demo_table_3' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.executeBatch();
  Iterator<Tuple> XIter=server.openIterator("D");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextTableWriteRead() throws Exception {
  String createTable="CREATE TABLE demo_table_1(a0 int, a1 String, a2 String) STORED AS TEXTFILE";
  driver.run("drop table demo_table_1");
  int retCode1=driver.run(createTable).getResponseCode();
  assertTrue(retCode1 == 0);
  server.setBatchOn();
  server.registerQuery("A = load '" + inputFileName + "' using PigStorage(',') as (a0:int,a1:chararray,a2:chararray);");
  server.registerQuery("store A into 'demo_table_1' using org.apache.hive.hcatalog.pig.HCatStorer();");
  server.executeBatch();
  server.registerQuery("B = load 'demo_table_1' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("B");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(3,t.size());
    assertEquals(t.get(0).toString(),"" + numTuplesRead);
    assertEquals(t.get(1).toString(),"a" + numTuplesRead);
    assertEquals(t.get(2).toString(),"b" + numTuplesRead);
    numTuplesRead++;
  }
  assertEquals(input.length,numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoader </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProjectionsBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("Y1 = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("Y2 = foreach Y1 generate a;");
  server.registerQuery("Y3 = foreach Y1 generate b,a;");
  Schema dumpedY2Schema=server.dumpSchema("Y2");
  Schema dumpedY3Schema=server.dumpSchema("Y3");
  List<FieldSchema> Y2fields=dumpedY2Schema.getFields();
  List<FieldSchema> Y3fields=dumpedY3Schema.getFields();
  assertEquals(1,Y2fields.size());
  assertEquals("a",Y2fields.get(0).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Y2fields.get(0).type);
  assertEquals(2,Y3fields.size());
  assertEquals("b",Y3fields.get(0).alias.toLowerCase());
  assertEquals(DataType.CHARARRAY,Y3fields.get(0).type);
  assertEquals("a",Y3fields.get(1).alias.toLowerCase());
  assertEquals(DataType.INTEGER,Y3fields.get(1).type);
  int numTuplesRead=0;
  Iterator<Tuple> Y2Iter=server.openIterator("Y2");
  while (Y2Iter.hasNext()) {
    Tuple t=Y2Iter.next();
    assertEquals(t.size(),1);
    assertNotNull(t.get(0));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    numTuplesRead++;
  }
  numTuplesRead=0;
  Iterator<Tuple> Y3Iter=server.openIterator("Y3");
  while (Y3Iter.hasNext()) {
    Tuple t=Y3Iter.next();
    assertEquals(t.size(),2);
    assertNotNull(t.get(0));
    assertTrue(t.get(0).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).second);
    assertNotNull(t.get(1));
    assertTrue(t.get(1).getClass() == Integer.class);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).first);
    numTuplesRead++;
  }
  assertEquals(basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInputBytes() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  File file=new File(TEST_WAREHOUSE_DIR + "/" + SPECIFIC_SIZE_TABLE+ "/part-m-00000");
  file.deleteOnExit();
  RandomAccessFile randomAccessFile=new RandomAccessFile(file,"rw");
  randomAccessFile.setLength(2L * 1024 * 1024* 1024);
  randomAccessFile.close();
  Job job=new Job();
  HCatLoader hCatLoader=new HCatLoader();
  hCatLoader.setUDFContextSignature("testGetInputBytes");
  hCatLoader.setLocation(SPECIFIC_SIZE_TABLE,job);
  ResourceStatistics statistics=hCatLoader.getStatistics(file.getAbsolutePath(),job);
  assertEquals(2048,(long)statistics.getmBytes());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the failure case caused by HIVE-10752
 * @throws Exception
 */
@Test public void testColumnarStorePushdown2() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("B = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("C = join A by name, B by name;");
  server.registerQuery("D = foreach C generate B::studentid;");
  server.registerQuery("E = ORDER D by studentid asc;");
  Iterator<Tuple> iter=server.openIterator("E");
  Tuple t=iter.next();
  assertEquals(42,t.get(0));
  t=iter.next();
  assertEquals(1337,t.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadPartitionedBasic() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  driver.run("select * from " + PARTITIONED_TABLE);
  ArrayList<String> valuesReadFromHiveDriver=new ArrayList<String>();
  driver.getResults(valuesReadFromHiveDriver);
  assertEquals(basicInputData.size(),valuesReadFromHiveDriver.size());
  server.registerQuery("W = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema dumpedWSchema=server.dumpSchema("W");
  List<FieldSchema> Wfields=dumpedWSchema.getFields();
  assertEquals(3,Wfields.size());
  assertTrue(Wfields.get(0).alias.equalsIgnoreCase("a"));
  assertTrue(Wfields.get(0).type == DataType.INTEGER);
  assertTrue(Wfields.get(1).alias.equalsIgnoreCase("b"));
  assertTrue(Wfields.get(1).type == DataType.CHARARRAY);
  assertTrue(Wfields.get(2).alias.equalsIgnoreCase("bkt"));
  assertTrue(Wfields.get(2).type == DataType.CHARARRAY);
  Iterator<Tuple> WIter=server.openIterator("W");
  Collection<Pair<Integer,String>> valuesRead=new ArrayList<Pair<Integer,String>>();
  while (WIter.hasNext()) {
    Tuple t=WIter.next();
    assertTrue(t.size() == 3);
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertNotNull(t.get(2));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertTrue(t.get(2).getClass() == String.class);
    valuesRead.add(new Pair<Integer,String>((Integer)t.get(0),(String)t.get(1)));
    if ((Integer)t.get(0) < 2) {
      assertEquals("0",t.get(2));
    }
 else {
      assertEquals("1",t.get(2));
    }
  }
  assertEquals(valuesReadFromHiveDriver.size(),valuesRead.size());
  server.registerQuery("P1 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P1filter = filter P1 by bkt == '0';");
  Iterator<Tuple> P1Iter=server.openIterator("P1filter");
  int count1=0;
  while (P1Iter.hasNext()) {
    Tuple t=P1Iter.next();
    assertEquals("0",t.get(2));
    assertEquals(1,t.get(0));
    count1++;
  }
  assertEquals(3,count1);
  server.registerQuery("P2 = load '" + PARTITIONED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  server.registerQuery("P2filter = filter P2 by bkt == '1';");
  Iterator<Tuple> P2Iter=server.openIterator("P2filter");
  int count2=0;
  while (P2Iter.hasNext()) {
    Tuple t=P2Iter.next();
    assertEquals("1",t.get(2));
    assertTrue(((Integer)t.get(0)) > 1);
    count2++;
  }
  assertEquals(6,count2);
}

</code></pre>

<br>
<pre class="type-11 type-12 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConvertBooleanToInt() throws Exception {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  String tbl="test_convert_boolean_to_int";
  String inputFileName=TEST_DATA_DIR + "/testConvertBooleanToInt/data.txt";
  File inputDataDir=new File(inputFileName).getParentFile();
  inputDataDir.mkdir();
  String[] lines=new String[]{"llama\ttrue","alpaca\tfalse"};
  HcatTestUtils.createTestDataFile(inputFileName,lines);
  assertEquals(0,driver.run("drop table if exists " + tbl).getResponseCode());
  assertEquals(0,driver.run("create external table " + tbl + " (a string, b boolean) row format delimited fields terminated by '\t'"+ " stored as textfile location 'file:///"+ inputDataDir.getPath().replaceAll("\\\\","/")+ "'").getResponseCode());
  Properties properties=new Properties();
  properties.setProperty(HCatConstants.HCAT_DATA_CONVERT_BOOLEAN_TO_INTEGER,"true");
  PigServer server=new PigServer(ExecType.LOCAL,properties);
  server.registerQuery("data = load 'test_convert_boolean_to_int' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  assertEquals(2,schema.getFields().size());
  assertEquals("a",schema.getField(0).alias);
  assertEquals(DataType.CHARARRAY,schema.getField(0).type);
  assertEquals("b",schema.getField(1).alias);
  if (PigHCatUtil.pigHasBooleanSupport()) {
    assertEquals(DataType.BOOLEAN,schema.getField(1).type);
  }
 else {
    assertEquals(DataType.INTEGER,schema.getField(1).type);
  }
  Iterator<Tuple> iterator=server.openIterator("data");
  Tuple t=iterator.next();
  assertEquals("llama",t.get(0));
  assertEquals(1,t.get(1));
  t=iterator.next();
  assertEquals("alpaca",t.get(0));
  assertEquals(0,t.get(1));
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataBasic() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + BASIC_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("X");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(2,t.size());
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals(basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnarStorePushdown() throws Exception {
  String PIGOUTPUT_DIR=TEST_DATA_DIR + "/colpushdownop";
  String PIG_FILE="test.pig";
  String expectedCols="0,1";
  PrintWriter w=new PrintWriter(new FileWriter(PIG_FILE));
  w.println("A = load '" + COMPLEX_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  w.println("B = foreach A generate name,studentid;");
  w.println("C = filter B by name is not null;");
  w.println("store C into '" + PIGOUTPUT_DIR + "' using PigStorage();");
  w.close();
  try {
    String[] args={"-x","local",PIG_FILE};
    PigStats stats=PigRunner.run(args,null);
    assertTrue(stats.isSuccessful());
    OutputStats outstats=stats.getOutputStats().get(0);
    assertTrue(outstats != null);
    assertEquals(expectedCols,outstats.getConf().get(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR));
    FileSystem fs=FileSystem.get(outstats.getConf());
    if (fs.exists(new Path(PIGOUTPUT_DIR))) {
      fs.delete(new Path(PIGOUTPUT_DIR),true);
    }
  }
  finally {
    new File(PIG_FILE).delete();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoaderEncryption </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadDataFromEncryptedHiveTableByPig() throws IOException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("X = load '" + ENCRYPTED_TABLE + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Iterator<Tuple> XIter=server.openIterator("X");
  int numTuplesRead=0;
  while (XIter.hasNext()) {
    Tuple t=XIter.next();
    assertEquals(2,t.size());
    assertNotNull(t.get(0));
    assertNotNull(t.get(1));
    assertTrue(t.get(0).getClass() == Integer.class);
    assertTrue(t.get(1).getClass() == String.class);
    assertEquals(t.get(0),basicInputData.get(numTuplesRead).first);
    assertEquals(t.get(1),basicInputData.get(numTuplesRead).second);
    numTuplesRead++;
  }
  assertEquals("failed with storage format: " + this.storageFormat,basicInputData.size(),numTuplesRead);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatLoaderStorer </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test round trip of smallint/tinyint: Hive->Pig->Hive.  This is a more general use case in HCatalog:
 * 'read some data from Hive, process it in Pig, write result back to a Hive table'
 */
@Test public void testReadWrite() throws Exception {
  final String tblName="small_ints_table";
  final String tblName2="pig_hcatalog_1";
  File dataDir=new File(TEST_DATA_DIR + File.separator + "testReadWrite");
  FileUtil.fullyDelete(dataDir);
  Assert.assertTrue(dataDir.mkdir());
  final String INPUT_FILE_NAME=dataDir + "/inputtrw.data";
  TestHCatLoader.dropTable(tblName,driver);
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,new String[]{"40\t1"});
  TestHCatLoader.executeStatementOnDriver("create external table " + tblName + " (my_small_int smallint, my_tiny_int tinyint)"+ " row format delimited fields terminated by '\t' stored as textfile location '"+ dataDir.toURI().getPath()+ "'",driver);
  TestHCatLoader.dropTable(tblName2,driver);
  TestHCatLoader.createTable(tblName2,"my_small_int smallint, my_tiny_int tinyint",null,driver,"textfile");
  LOG.debug("File=" + INPUT_FILE_NAME);
  TestHCatStorer.dumpFile(INPUT_FILE_NAME);
  PigServer server=createPigServer(true);
  try {
    int queryNumber=1;
    logAndRegister(server,"A = load '" + tblName + "' using org.apache.hive.hcatalog.pig.HCatLoader() as (my_small_int:int, my_tiny_int:int);",queryNumber++);
    logAndRegister(server,"b = foreach A generate my_small_int + my_tiny_int as my_small_int, my_tiny_int;",queryNumber++);
    logAndRegister(server,"store b into '" + tblName2 + "' using org.apache.hive.hcatalog.pig.HCatStorer();",queryNumber);
    TestHCatLoader.executeStatementOnDriver("select my_small_int from " + tblName2,driver);
    ArrayList l=new ArrayList();
    driver.getResults(l);
    for (    Object t : l) {
      LOG.debug("t=" + t);
    }
    Assert.assertEquals("Expected '1' rows; got '" + l.size() + "'",1,l.size());
    int result=Integer.parseInt((String)l.get(0));
    Assert.assertEquals("Expected value '41'; got '" + result + "'",41,result);
  }
  finally {
    server.shutdown();
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Ensure Pig can read/write tinyint/smallint columns.
 */
@Test public void testSmallTinyInt() throws Exception {
  String readTblName="test_small_tiny_int";
  File dataDir=new File(TEST_DATA_DIR + "/testSmallTinyIntData");
  File dataFile=new File(dataDir,"testSmallTinyInt.tsv");
  String writeTblName="test_small_tiny_int_write";
  File writeDataFile=new File(TEST_DATA_DIR,writeTblName + ".tsv");
  FileUtil.fullyDelete(dataDir);
  Assert.assertTrue(dataDir.mkdir());
  HcatTestUtils.createTestDataFile(dataFile.getAbsolutePath(),new String[]{String.format("%d\t%d",Short.MIN_VALUE,Byte.MIN_VALUE),String.format("%d\t%d",Short.MAX_VALUE,Byte.MAX_VALUE)});
  Assert.assertEquals(0,driver.run("drop table if exists " + readTblName).getResponseCode());
  Assert.assertEquals(0,driver.run("create external table " + readTblName + " (my_small_int smallint, my_tiny_int tinyint)"+ " row format delimited fields terminated by '\t' stored as textfile").getResponseCode());
  Assert.assertEquals(0,driver.run("load data local inpath '" + dataDir.getPath().replaceAll("\\\\","/") + "' into table "+ readTblName).getResponseCode());
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("data = load '" + readTblName + "' using org.apache.hive.hcatalog.pig.HCatLoader();");
  Schema schema=server.dumpSchema("data");
  Assert.assertEquals(2,schema.getFields().size());
  Assert.assertEquals("my_small_int",schema.getField(0).alias);
  Assert.assertEquals(DataType.INTEGER,schema.getField(0).type);
  Assert.assertEquals("my_tiny_int",schema.getField(1).alias);
  Assert.assertEquals(DataType.INTEGER,schema.getField(1).type);
  Iterator<Tuple> it=server.openIterator("data");
  Tuple t=it.next();
  Assert.assertEquals(new Integer(Short.MIN_VALUE),t.get(0));
  Assert.assertEquals(new Integer(Byte.MIN_VALUE),t.get(1));
  t=it.next();
  Assert.assertEquals(new Integer(Short.MAX_VALUE),t.get(0));
  Assert.assertEquals(new Integer(Byte.MAX_VALUE),t.get(1));
  Assert.assertFalse(it.hasNext());
  Assert.assertEquals(0,driver.run("drop table if exists " + writeTblName).getResponseCode());
  Assert.assertEquals(0,driver.run("create table " + writeTblName + " (my_small_int smallint, my_tiny_int tinyint) stored as rcfile").getResponseCode());
  HcatTestUtils.createTestDataFile(writeDataFile.getAbsolutePath(),new String[]{String.format("%d\t%d",Short.MIN_VALUE,Byte.MIN_VALUE),String.format("%d\t%d",Short.MAX_VALUE,Byte.MAX_VALUE)});
  smallTinyIntBoundsCheckHelper(writeDataFile.getPath().replaceAll("\\\\","/"),ExecJob.JOB_STATUS.COMPLETED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/shortTooSmall.tsv",new String[]{String.format("%d\t%d",Short.MIN_VALUE - 1,0)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/shortTooSmall.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/shortTooBig.tsv",new String[]{String.format("%d\t%d",Short.MAX_VALUE + 1,0)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/shortTooBig.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/byteTooSmall.tsv",new String[]{String.format("%d\t%d",0,Byte.MIN_VALUE - 1)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/byteTooSmall.tsv",ExecJob.JOB_STATUS.FAILED);
  HcatTestUtils.createTestDataFile(TEST_DATA_DIR + "/byteTooBig.tsv",new String[]{String.format("%d\t%d",0,Byte.MAX_VALUE + 1)});
  smallTinyIntBoundsCheckHelper(TEST_DATA_DIR + "/byteTooBig.tsv",ExecJob.JOB_STATUS.FAILED);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorer </h4><pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartColsInData() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "\t1";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertEquals(2,t.size());
    assertEquals(t.get(0),i);
    assertEquals(t.get(1),"1");
    i++;
  }
  assertFalse(itr.hasNext());
  assertEquals(LOOP_SIZE,i);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBagNStruct() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(b string,a struct<a1:int>,  arr_of_struct array<string>, " + "arr_of_struct2 array<struct<s1:string,s2:string>>,  arr_of_struct3 array<struct<s3:string>>) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  String[] inputData=new String[]{"zookeeper\t(2)\t{(pig)}\t{(pnuts,hdfs)}\t{(hadoop),(hcat)}","chubby\t(2)\t{(sawzall)}\t{(bigtable,gfs)}\t{(mapreduce),(hcat)}"};
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (b:chararray, a:tuple(a1:int), arr_of_struct:bag{mytup:tuple(s1:chararray)}, arr_of_struct2:bag{mytup:tuple(s1:chararray,s2:chararray)}, arr_of_struct3:bag{t3:tuple(s3:chararray)});");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','b:chararray, a:tuple(a1:int),"+ " arr_of_struct:bag{mytup:tuple(s1:chararray)}, arr_of_struct2:bag{mytup:tuple(s1:chararray,s2:chararray)}, arr_of_struct3:bag{t3:tuple(s3:chararray)}');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  assertEquals("zookeeper\t{\"a1\":2}\t[\"pig\"]\t[{\"s1\":\"pnuts\",\"s2\":\"hdfs\"}]\t[{\"s3\":\"hadoop\"},{\"s3\":\"hcat\"}]",itr.next());
  assertEquals("chubby\t{\"a1\":2}\t[\"sawzall\"]\t[{\"s1\":\"bigtable\",\"s2\":\"gfs\"}]\t[{\"s3\":\"mapreduce\"},{\"s3\":\"hcat\"}]",itr.next());
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-21 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyStore() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a > 100;");
  server.registerQuery("store B into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreMultiTables() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  driver.run("drop table junit_unparted2");
  createTable="create table junit_unparted2(a int, b string) stored as RCFILE";
  retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("B = filter A by a < 2;");
  server.registerQuery("store B into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.registerQuery("C = filter A by a >= 2;");
  server.registerQuery("store C into 'junit_unparted2' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("select * from junit_unparted2");
  ArrayList<String> res2=new ArrayList<String>();
  driver.getResults(res2);
  res.addAll(res2);
  driver.run("drop table junit_unparted");
  driver.run("drop table junit_unparted2");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncSimple() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int,b:chararray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      assertEquals(si + "\t" + j,itr.next());
    }
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoSchema() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoAlias() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_parted");
  String createTable="create table junit_parted(a int, b string) partitioned by (ds string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  PigServer server=new PigServer(ExecType.LOCAL);
  boolean errCaught=false;
  try {
    server.setBatchOn();
    server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
    server.registerQuery("B = foreach A generate a+10, b;");
    server.registerQuery("store B into 'junit_parted' using " + HCatStorer.class.getName() + "('ds=20100101');");
    server.executeBatch();
  }
 catch (  PigException fe) {
    PigException pe=LogUtils.getPigException(fe);
    assertTrue(pe instanceof FrontendException);
    assertEquals(PigHCatUtil.PIG_EXCEPTION_CODE,pe.getErrorCode());
    assertTrue(pe.getMessage().contains("Column name for a field is not specified. Please provide the full schema as an argument to HCatStorer."));
    errCaught=true;
  }
  assertTrue(errCaught);
  errCaught=false;
  try {
    server.setBatchOn();
    server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, B:chararray);");
    server.registerQuery("B = foreach A generate a, B;");
    server.registerQuery("store B into 'junit_parted' using " + HCatStorer.class.getName() + "('ds=20100101');");
    server.executeBatch();
  }
 catch (  PigException fe) {
    PigException pe=LogUtils.getPigException(fe);
    assertTrue(pe instanceof FrontendException);
    assertEquals(PigHCatUtil.PIG_EXCEPTION_CODE,pe.getErrorCode());
    assertTrue(pe.getMessage().contains("Column names should all be in lowercase. Invalid name found: B"));
    errCaught=true;
  }
  driver.run("drop table junit_parted");
  assertTrue(errCaught);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreFuncAllSimpleTypes() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b float, c double, d bigint, e string, h boolean, f binary, g binary) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int i=0;
  String[] input=new String[3];
  input[i++]="0\t\t\t\t\t\t\t";
  input[i++]="\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "true" + "\tbinary-data";
  input[i++]=i + "\t" + i * 2.1f + "\t" + i * 1.1d + "\t" + i * 2L + "\t" + "lets hcat" + "\t" + "false" + "\tbinary-data";
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('','a:int, b:float, c:double, d:long, e:chararray, h:boolean, f:bytearray');");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  Iterator<String> itr=res.iterator();
  String next=itr.next();
  assertEquals("0\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL\tNULL",next);
  assertEquals("NULL\t4.2\t2.2\t4\tlets hcat\ttrue\tbinary-data\tNULL",itr.next());
  assertEquals("3\t6.2999997\t3.3000000000000003\t6\tlets hcat\tfalse\tbinary-data\tNULL",itr.next());
  assertFalse(itr.hasNext());
  server.registerQuery("B = load 'junit_unparted' using " + HCatLoader.class.getName() + ";");
  Iterator<Tuple> iter=server.openIterator("B");
  int count=0;
  int num5nulls=0;
  while (iter.hasNext()) {
    Tuple t=iter.next();
    if (t.get(6) == null) {
      num5nulls++;
    }
 else {
      assertTrue(t.get(6) instanceof DataByteArray);
    }
    assertNull(t.get(7));
    count++;
  }
  assertEquals(3,count);
  assertEquals(1,num5nulls);
  driver.run("drop table junit_unparted");
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreInPartiitonedTbl() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int) partitioned by (b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=11;
  String[] input=new String[LOOP_SIZE];
  for (int i=0; i < LOOP_SIZE; i++) {
    input[i]=i + "";
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int);");
  server.registerQuery("store A into 'default.junit_unparted' using " + HCatStorer.class.getName() + "('b=1');");
  server.registerQuery("B = load 'default.junit_unparted' using " + HCatLoader.class.getName() + "();");
  Iterator<Tuple> itr=server.openIterator("B");
  int i=0;
  while (itr.hasNext()) {
    Tuple t=itr.next();
    assertEquals(2,t.size());
    assertEquals(t.get(0),i);
    assertEquals(t.get(1),"1");
    i++;
  }
  assertFalse(itr.hasNext());
  assertEquals(11,i);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-21 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreWithNoCtorArgs() throws IOException, CommandNeedRetryException {
  assumeTrue(!TestUtil.shouldSkip(storageFormat,DISABLED_STORAGE_FORMATS));
  driver.run("drop table junit_unparted");
  String createTable="create table junit_unparted(a int, b string) stored as " + storageFormat;
  int retCode=driver.run(createTable).getResponseCode();
  if (retCode != 0) {
    throw new IOException("Failed to create table.");
  }
  int LOOP_SIZE=3;
  String[] input=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      input[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,input);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  server.registerQuery("A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  server.registerQuery("store A into 'junit_unparted' using " + HCatStorer.class.getName() + "();");
  server.executeBatch();
  driver.run("select * from junit_unparted");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_unparted");
  Iterator<String> itr=res.iterator();
  for (int i=0; i < LOOP_SIZE * LOOP_SIZE; i++) {
    assertEquals(input[i],itr.next());
  }
  assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestHCatStorerWrapper </h4><pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStoreExternalTableWithExternalDir() throws IOException, CommandNeedRetryException {
  File tmpExternalDir=new File(TEST_DATA_DIR,UUID.randomUUID().toString());
  tmpExternalDir.deleteOnExit();
  String part_val="100";
  driver.run("drop table junit_external");
  String createTable="create external table junit_external(a int, b string) partitioned by (c string) stored as RCFILE";
  Assert.assertEquals(0,driver.run(createTable).getResponseCode());
  int LOOP_SIZE=3;
  String[] inputData=new String[LOOP_SIZE * LOOP_SIZE];
  int k=0;
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      inputData[k++]=si + "\t" + j;
    }
  }
  HcatTestUtils.createTestDataFile(INPUT_FILE_NAME,inputData);
  PigServer server=new PigServer(ExecType.LOCAL);
  server.setBatchOn();
  logAndRegister(server,"A = load '" + INPUT_FILE_NAME + "' as (a:int, b:chararray);");
  logAndRegister(server,"store A into 'default.junit_external' using " + HCatStorerWrapper.class.getName() + "('c="+ part_val+ "','"+ tmpExternalDir.getPath().replaceAll("\\\\","/")+ "');");
  server.executeBatch();
  Assert.assertTrue(tmpExternalDir.exists());
  boolean found=false;
  File[] f=tmpExternalDir.listFiles();
  if (f != null) {
    for (    File fin : f) {
      if (fin.getPath().contains("part-m-00000")) {
        found=true;
      }
    }
  }
  Assert.assertTrue(found);
  driver.run("select * from junit_external");
  ArrayList<String> res=new ArrayList<String>();
  driver.getResults(res);
  driver.run("drop table junit_external");
  Iterator<String> itr=res.iterator();
  for (int i=1; i <= LOOP_SIZE; i++) {
    String si=i + "";
    for (int j=1; j <= LOOP_SIZE; j++) {
      Assert.assertEquals(si + "\t" + j+ "\t"+ part_val,itr.next());
    }
  }
  Assert.assertFalse(itr.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.pig.TestPigHCatUtil </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetBagSubSchema() throws Exception {
  ResourceFieldSchema[] bagSubFieldSchemas=new ResourceFieldSchema[1];
  bagSubFieldSchemas[0]=new ResourceFieldSchema().setName("innertuple").setDescription("The tuple in the bag").setType(DataType.TUPLE);
  ResourceFieldSchema[] innerTupleFieldSchemas=new ResourceFieldSchema[1];
  innerTupleFieldSchemas[0]=new ResourceFieldSchema().setName("innerfield").setType(DataType.CHARARRAY);
  bagSubFieldSchemas[0].setSchema(new ResourceSchema().setFields(innerTupleFieldSchemas));
  ResourceSchema expected=new ResourceSchema().setFields(bagSubFieldSchemas);
  HCatSchema hCatSchema=new HCatSchema(Lists.newArrayList(new HCatFieldSchema("innerLlama",HCatFieldSchema.Type.STRING,null)));
  HCatFieldSchema hCatFieldSchema=new HCatFieldSchema("llama",HCatFieldSchema.Type.ARRAY,hCatSchema,null);
  ResourceSchema actual=PigHCatUtil.getBagSubSchema(hCatFieldSchema);
  Assert.assertEquals(expected.toString(),actual.toString());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetBagSubSchemaConfigured() throws Exception {
  System.setProperty(HCatConstants.HCAT_PIG_INNER_TUPLE_NAME,"t");
  System.setProperty(HCatConstants.HCAT_PIG_INNER_FIELD_NAME,"FIELDNAME_tuple");
  UDFContext.getUDFContext().setClientSystemProps(System.getProperties());
  ResourceFieldSchema[] bagSubFieldSchemas=new ResourceFieldSchema[1];
  bagSubFieldSchemas[0]=new ResourceFieldSchema().setName("t").setDescription("The tuple in the bag").setType(DataType.TUPLE);
  ResourceFieldSchema[] innerTupleFieldSchemas=new ResourceFieldSchema[1];
  innerTupleFieldSchemas[0]=new ResourceFieldSchema().setName("llama_tuple").setType(DataType.CHARARRAY);
  bagSubFieldSchemas[0].setSchema(new ResourceSchema().setFields(innerTupleFieldSchemas));
  ResourceSchema expected=new ResourceSchema().setFields(bagSubFieldSchemas);
  HCatSchema actualHCatSchema=new HCatSchema(Lists.newArrayList(new HCatFieldSchema("innerLlama",HCatFieldSchema.Type.STRING,null)));
  HCatFieldSchema actualHCatFieldSchema=new HCatFieldSchema("llama",HCatFieldSchema.Type.ARRAY,actualHCatSchema,null);
  ResourceSchema actual=PigHCatUtil.getBagSubSchema(actualHCatFieldSchema);
  Assert.assertEquals(expected.toString(),actual.toString());
  System.clearProperty(HCatConstants.HCAT_PIG_INNER_TUPLE_NAME);
  System.clearProperty(HCatConstants.HCAT_PIG_INNER_FIELD_NAME);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestDelimitedInputWriter </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFieldReordering() throws Exception {
  ArrayList<String> colNames=Lists.newArrayList(new String[]{"col1","col2","col3","col4","col5"});
{
    String[] fieldNames={null,"col2",null,"col4",null};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{-1,1,-1,3,-1}));
  }
{
    String[] fieldNames={"col5","col4","col3","col2","col1"};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{4,3,2,1,0}));
  }
{
    String[] fieldNames={"xyz","abc","col3","col4","as"};
    try {
      DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
      Assert.fail();
    }
 catch (    InvalidColumn e) {
    }
  }
{
    String[] fieldNames={"col3","col4"};
    int[] mapping=DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
    Assert.assertTrue(Arrays.equals(mapping,new int[]{2,3}));
  }
{
    String[] fieldNames={"col5","col4","col3","col2","col1","col1"};
    try {
      DelimitedInputWriter.getFieldReordering(fieldNames,colNames);
      Assert.fail();
    }
 catch (    InvalidColumn e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.TestStreaming </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileDumpCorruptSideFiles() throws Exception {
  dropDB(msClient,dbName3);
  String dbLocation=dbFolder.newFolder(dbName3).getCanonicalPath() + ".db";
  dbLocation=dbLocation.replaceAll("\\\\","/");
  String[] colNames="key1,key2,data".split(",");
  String[] colTypes="string,int,string".split(",");
  String[] bucketNames="key1,key2".split(",");
  int bucketCount=4;
  createDbAndTable(driver,dbName3,tblName3,null,colNames,colTypes,bucketNames,null,dbLocation,bucketCount);
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName3,tblName3,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(colNames,",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("name0,1,Hello streaming".getBytes());
  txnBatch.write("name2,2,Welcome to streaming".getBytes());
  txnBatch.write("name4,2,more Streaming unlimited".getBytes());
  txnBatch.write("name5,2,even more Streaming unlimited".getBytes());
  txnBatch.write("name6,3,aHello streaming".getBytes());
  txnBatch.commit();
  Map<String,List<Long>> offsetMap=new HashMap<String,List<Long>>();
  recordOffsets(conf,dbLocation,offsetMap);
  txnBatch.beginNextTransaction();
  txnBatch.write("name01,11,-Hello streaming".getBytes());
  txnBatch.write("name21,21,-Welcome to streaming".getBytes());
  txnBatch.write("name41,21,-more Streaming unlimited".getBytes());
  txnBatch.write("name51,21,-even more Streaming unlimited".getBytes());
  txnBatch.write("name02,12,--Hello streaming".getBytes());
  txnBatch.write("name22,22,--Welcome to streaming".getBytes());
  txnBatch.write("name42,22,--more Streaming unlimited".getBytes());
  txnBatch.write("name52,22,--even more Streaming unlimited".getBytes());
  txnBatch.write("name7,4,aWelcome to streaming".getBytes());
  txnBatch.write("name8,5,amore Streaming unlimited".getBytes());
  txnBatch.write("name9,6,aeven more Streaming unlimited".getBytes());
  txnBatch.write("name10,7,bHello streaming".getBytes());
  txnBatch.write("name11,8,bWelcome to streaming".getBytes());
  txnBatch.write("name12,9,bmore Streaming unlimited".getBytes());
  txnBatch.write("name13,10,beven more Streaming unlimited".getBytes());
  txnBatch.commit();
  recordOffsets(conf,dbLocation,offsetMap);
  Path path=new Path(dbLocation);
  Collection<String> files=FileDump.getAllFilesInPath(path,conf);
  for (  String file : files) {
    if (file.contains("bucket_00000")) {
      corruptSideFile(file,conf,offsetMap,"bucket_00000",-1);
    }
 else     if (file.contains("bucket_00001")) {
      corruptSideFile(file,conf,offsetMap,"bucket_00001",0);
    }
 else     if (file.contains("bucket_00002")) {
      corruptSideFile(file,conf,offsetMap,"bucket_00002",3);
    }
 else     if (file.contains("bucket_00003")) {
      corruptSideFile(file,conf,offsetMap,"bucket_00003",10);
    }
  }
  PrintStream origErr=System.err;
  ByteArrayOutputStream myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation});
  System.err.flush();
  System.setErr(origErr);
  String errDump=new String(myErr.toByteArray());
  Assert.assertEquals(true,errDump.contains("bucket_00000_flush_length [length: 11"));
  Assert.assertEquals(true,errDump.contains("bucket_00001_flush_length [length: 0"));
  Assert.assertEquals(true,errDump.contains("bucket_00002_flush_length [length: 24"));
  Assert.assertEquals(true,errDump.contains("bucket_00003_flush_length [length: 80"));
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(true,errDump.contains("4 file(s) are corrupted"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  origErr=System.err;
  myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation,"--recover","--skip-dump"});
  System.err.flush();
  System.setErr(origErr);
  errDump=new String(myErr.toByteArray());
  Assert.assertEquals(true,errDump.contains("bucket_00000 recovered successfully!"));
  Assert.assertEquals(true,errDump.contains("bucket_00001 recovered successfully!"));
  Assert.assertEquals(true,errDump.contains("bucket_00002 recovered successfully!"));
  Assert.assertEquals(true,errDump.contains("bucket_00003 recovered successfully!"));
  List<Long> offsets=offsetMap.get("bucket_00000");
  Assert.assertEquals(true,errDump.contains("Readable footerOffsets: " + offsets.toString()));
  offsets=offsetMap.get("bucket_00001");
  Assert.assertEquals(true,errDump.contains("Readable footerOffsets: " + offsets.toString()));
  offsets=offsetMap.get("bucket_00002");
  Assert.assertEquals(true,errDump.contains("Readable footerOffsets: " + offsets.toString()));
  offsets=offsetMap.get("bucket_00003");
  Assert.assertEquals(true,errDump.contains("Readable footerOffsets: " + offsets.toString()));
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  origErr=System.err;
  myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation});
  System.err.flush();
  System.setErr(origErr);
  errDump=new String(myErr.toByteArray());
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(false,errDump.contains("file(s) are corrupted"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  files=FileDump.getAllFilesInPath(path,conf);
  for (  String file : files) {
    Assert.assertEquals(false,file.contains("_flush_length"));
  }
  txnBatch.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testStreamBucketingMatchesRegularBucketing() throws Exception {
  int bucketCount=100;
  String dbUri="raw://" + new Path(dbFolder.newFolder().toString()).toUri().toString();
  String tableLoc="'" + dbUri + Path.SEPARATOR+ "streamedtable"+ "'";
  String tableLoc2="'" + dbUri + Path.SEPARATOR+ "finaltable"+ "'";
  String tableLoc3="'" + dbUri + Path.SEPARATOR+ "nobucket"+ "'";
  runDDL(driver,"create database testBucketing3");
  runDDL(driver,"use testBucketing3");
  runDDL(driver,"create table streamedtable ( key1 string,key2 int,data string ) clustered by ( key1,key2 ) into " + bucketCount + " buckets  stored as orc  location "+ tableLoc+ " TBLPROPERTIES ('transactional'='true')");
  runDDL(driver,"create table nobucket ( bucketid int, key1 string,key2 int,data string ) location " + tableLoc3);
  runDDL(driver,"create table finaltable ( bucketid int, key1 string,key2 int,data string ) clustered by ( key1,key2 ) into " + bucketCount + " buckets  stored as orc location "+ tableLoc2+ " TBLPROPERTIES ('transactional'='true')");
  String[] records=new String[]{"PSFAHYLZVC,29,EPNMA","PPPRKWAYAU,96,VUTEE","MIAOFERCHI,3,WBDSI","CEGQAZOWVN,0,WCUZL","XWAKMNSVQF,28,YJVHU","XBWTSAJWME,2,KDQFO","FUVLQTAXAY,5,LDSDG","QTQMDJMGJH,6,QBOMA","EFLOTLWJWN,71,GHWPS","PEQNAOJHCM,82,CAAFI","MOEKQLGZCP,41,RUACR","QZXMCOPTID,37,LFLWE","EYALVWICRD,13,JEZLC","VYWLZAYTXX,16,DMVZX","OSALYSQIXR,47,HNZVE","JGKVHKCEGQ,25,KSCJB","WQFMMYDHET,12,DTRWA","AJOVAYZKZQ,15,YBKFO","YAQONWCUAU,31,QJNHZ","DJBXUEUOEB,35,IYCBL"};
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,"testBucketing3","streamedtable",null);
  String[] colNames1=new String[]{"key1","key2","data"};
  DelimitedInputWriter wr=new DelimitedInputWriter(colNames1,",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,wr);
  txnBatch.beginNextTransaction();
  for (  String record : records) {
    txnBatch.write(record.toString().getBytes());
  }
  txnBatch.commit();
  txnBatch.close();
  connection.close();
  ArrayList<String> res1=queryTable(driver,"select row__id.bucketid, * from streamedtable order by key2");
  for (  String re : res1) {
    System.out.println(re);
  }
  driver.run("insert into nobucket select row__id.bucketid,* from streamedtable");
  runDDL(driver," insert into finaltable select * from nobucket");
  ArrayList<String> res2=queryTable(driver,"select row__id.bucketid,* from finaltable where row__id.bucketid<>bucketid");
  for (  String s : res2) {
    LOG.error(s);
  }
  Assert.assertTrue(res2.isEmpty());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBucketing() throws Exception {
  dropDB(msClient,dbName3);
  dropDB(msClient,dbName4);
  String dbLocation=dbFolder.newFolder(dbName3).getCanonicalPath() + ".db";
  dbLocation=dbLocation.replaceAll("\\\\","/");
  String[] colNames="key1,key2,data".split(",");
  String[] colTypes="string,int,string".split(",");
  String[] bucketNames="key1,key2".split(",");
  int bucketCount=4;
  createDbAndTable(driver,dbName3,tblName3,null,colNames,colTypes,bucketNames,null,dbLocation,bucketCount);
  String dbLocation2=dbFolder.newFolder(dbName4).getCanonicalPath() + ".db";
  dbLocation2=dbLocation2.replaceAll("\\\\","/");
  String[] colNames2="key3,key4,data2".split(",");
  String[] colTypes2="string,int,string".split(",");
  String[] bucketNames2="key3,key4".split(",");
  createDbAndTable(driver,dbName4,tblName4,null,colNames2,colTypes2,bucketNames2,null,dbLocation2,bucketCount);
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName3,tblName3,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(colNames,",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("name0,1,Hello streaming".getBytes());
  txnBatch.write("name2,2,Welcome to streaming".getBytes());
  txnBatch.write("name4,2,more Streaming unlimited".getBytes());
  txnBatch.write("name5,2,even more Streaming unlimited".getBytes());
  txnBatch.commit();
  HiveEndPoint endPt2=new HiveEndPoint(metaStoreURI,dbName4,tblName4,null);
  DelimitedInputWriter writer2=new DelimitedInputWriter(colNames2,",",endPt2);
  StreamingConnection connection2=endPt2.newConnection(false);
  TransactionBatch txnBatch2=connection2.fetchTransactionBatch(2,writer2);
  txnBatch2.beginNextTransaction();
  txnBatch2.write("name5,2,fact3".getBytes());
  txnBatch2.write("name8,2,fact3".getBytes());
  txnBatch2.write("name0,1,fact1".getBytes());
  txnBatch2.commit();
  HashMap<Integer,ArrayList<SampleRec>> actual1=dumpAllBuckets(dbLocation,tblName3);
  HashMap<Integer,ArrayList<SampleRec>> actual2=dumpAllBuckets(dbLocation2,tblName4);
  System.err.println("\n  Table 1");
  System.err.println(actual1);
  System.err.println("\n  Table 2");
  System.err.println(actual2);
  Assert.assertEquals("number of buckets does not match expectation",actual1.values().size(),4);
  Assert.assertEquals("records in bucket does not match expectation",actual1.get(0).size(),2);
  Assert.assertEquals("records in bucket does not match expectation",actual1.get(1).size(),1);
  Assert.assertEquals("records in bucket does not match expectation",actual1.get(2).size(),0);
  Assert.assertEquals("records in bucket does not match expectation",actual1.get(3).size(),1);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileDumpCorruptDataFiles() throws Exception {
  dropDB(msClient,dbName3);
  String dbLocation=dbFolder.newFolder(dbName3).getCanonicalPath() + ".db";
  dbLocation=dbLocation.replaceAll("\\\\","/");
  String[] colNames="key1,key2,data".split(",");
  String[] colTypes="string,int,string".split(",");
  String[] bucketNames="key1,key2".split(",");
  int bucketCount=4;
  createDbAndTable(driver,dbName3,tblName3,null,colNames,colTypes,bucketNames,null,dbLocation,bucketCount);
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName3,tblName3,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(colNames,",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("name0,1,Hello streaming".getBytes());
  txnBatch.write("name2,2,Welcome to streaming".getBytes());
  txnBatch.write("name4,2,more Streaming unlimited".getBytes());
  txnBatch.write("name5,2,even more Streaming unlimited".getBytes());
  txnBatch.commit();
  Path path=new Path(dbLocation);
  Collection<String> files=FileDump.getAllFilesInPath(path,conf);
  int readableFooter=-1;
  for (  String file : files) {
    if (file.contains("bucket_00000")) {
      corruptDataFile(file,conf,Integer.MIN_VALUE);
    }
 else     if (file.contains("bucket_00001")) {
      corruptDataFile(file,conf,-1);
    }
 else     if (file.contains("bucket_00002")) {
      Path bPath=new Path(file);
      FileSystem fs=bPath.getFileSystem(conf);
      FileStatus fileStatus=fs.getFileStatus(bPath);
      readableFooter=(int)fileStatus.getLen();
      corruptDataFile(file,conf,2);
    }
 else     if (file.contains("bucket_00003")) {
      corruptDataFile(file,conf,100);
    }
  }
  PrintStream origErr=System.err;
  ByteArrayOutputStream myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation});
  System.err.flush();
  System.setErr(origErr);
  String errDump=new String(myErr.toByteArray());
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(true,errDump.contains("4 file(s) are corrupted"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  origErr=System.err;
  myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation,"--recover","--skip-dump"});
  System.err.flush();
  System.setErr(origErr);
  errDump=new String(myErr.toByteArray());
  Assert.assertEquals(true,errDump.contains("bucket_00000 recovered successfully!"));
  Assert.assertEquals(true,errDump.contains("No readable footers found. Creating empty orc file."));
  Assert.assertEquals(true,errDump.contains("bucket_00001 recovered successfully!"));
  Assert.assertEquals(true,errDump.contains("bucket_00002 recovered successfully!"));
  Assert.assertEquals(true,errDump.contains("Readable footerOffsets: [" + readableFooter + "]"));
  Assert.assertEquals(true,errDump.contains("bucket_00003 recovered successfully!"));
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  origErr=System.err;
  myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation});
  System.err.flush();
  System.setErr(origErr);
  errDump=new String(myErr.toByteArray());
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(false,errDump.contains("file(s) are corrupted"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  files=FileDump.getAllFilesInPath(path,conf);
  for (  String file : files) {
    Assert.assertEquals(false,file.contains("_flush_length"));
  }
  txnBatch.close();
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileDump() throws Exception {
  dropDB(msClient,dbName3);
  dropDB(msClient,dbName4);
  String dbLocation=dbFolder.newFolder(dbName3).getCanonicalPath() + ".db";
  dbLocation=dbLocation.replaceAll("\\\\","/");
  String[] colNames="key1,key2,data".split(",");
  String[] colTypes="string,int,string".split(",");
  String[] bucketNames="key1,key2".split(",");
  int bucketCount=4;
  createDbAndTable(driver,dbName3,tblName3,null,colNames,colTypes,bucketNames,null,dbLocation,bucketCount);
  String dbLocation2=dbFolder.newFolder(dbName4).getCanonicalPath() + ".db";
  dbLocation2=dbLocation2.replaceAll("\\\\","/");
  String[] colNames2="key3,key4,data2".split(",");
  String[] colTypes2="string,int,string".split(",");
  String[] bucketNames2="key3,key4".split(",");
  createDbAndTable(driver,dbName4,tblName4,null,colNames2,colTypes2,bucketNames2,null,dbLocation2,bucketCount);
  HiveEndPoint endPt=new HiveEndPoint(metaStoreURI,dbName3,tblName3,null);
  DelimitedInputWriter writer=new DelimitedInputWriter(colNames,",",endPt);
  StreamingConnection connection=endPt.newConnection(false);
  TransactionBatch txnBatch=connection.fetchTransactionBatch(2,writer);
  txnBatch.beginNextTransaction();
  txnBatch.write("name0,1,Hello streaming".getBytes());
  txnBatch.write("name2,2,Welcome to streaming".getBytes());
  txnBatch.write("name4,2,more Streaming unlimited".getBytes());
  txnBatch.write("name5,2,even more Streaming unlimited".getBytes());
  txnBatch.commit();
  PrintStream origErr=System.err;
  ByteArrayOutputStream myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation});
  System.err.flush();
  System.setErr(origErr);
  String errDump=new String(myErr.toByteArray());
  Assert.assertEquals(false,errDump.contains("file(s) are corrupted"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
  HiveEndPoint endPt2=new HiveEndPoint(metaStoreURI,dbName4,tblName4,null);
  DelimitedInputWriter writer2=new DelimitedInputWriter(colNames2,",",endPt2);
  StreamingConnection connection2=endPt2.newConnection(false);
  TransactionBatch txnBatch2=connection2.fetchTransactionBatch(2,writer2);
  txnBatch2.beginNextTransaction();
  txnBatch2.write("name5,2,fact3".getBytes());
  txnBatch2.write("name8,2,fact3".getBytes());
  txnBatch2.write("name0,1,fact1".getBytes());
  txnBatch2.commit();
  origErr=System.err;
  myErr=new ByteArrayOutputStream();
  System.setErr(new PrintStream(myErr));
  FileDump.main(new String[]{dbLocation});
  System.out.flush();
  System.err.flush();
  System.setErr(origErr);
  errDump=new String(myErr.toByteArray());
  Assert.assertEquals(false,errDump.contains("Exception"));
  Assert.assertEquals(false,errDump.contains("file(s) are corrupted"));
  Assert.assertEquals(false,errDump.contains("is still open for writes."));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.mutate.TestMutations </h4><pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchAbort() throws Exception {
  Table table=partitionedTableBuilder.addPartition(ASIA_INDIA).create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  transaction.begin();
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  BucketIdResolver bucketIdResolver=mutatorFactory.newBucketIdResolver(destinations.get(0).getTotalBuckets());
  MutableRecord record1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(1,"Hello streaming"));
  MutableRecord record2=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(2,"Welcome to streaming"));
  coordinator.insert(ASIA_INDIA,record1);
  coordinator.insert(ASIA_INDIA,record2);
  coordinator.close();
  transaction.abort();
  assertThat(transaction.getState(),is(ABORTED));
  client.close();
  StreamingAssert streamingAssertions=assertionFactory.newStreamingAssert(table,ASIA_INDIA);
  streamingAssertions.assertNothingWritten();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchEmptyCommitUnpartitioned() throws Exception {
  Table table=unpartitionedTableBuilder.create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),false).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  transaction.begin();
  transaction.commit();
  assertThat(transaction.getState(),is(COMMITTED));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testMulti() throws Exception {
  Table table=partitionedTableBuilder.addPartition(ASIA_INDIA).create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  transaction.begin();
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  BucketIdResolver bucketIdResolver=mutatorFactory.newBucketIdResolver(destinations.get(0).getTotalBuckets());
  MutableRecord asiaIndiaRecord1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(1,"Hello streaming"));
  MutableRecord europeUkRecord1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(2,"Hello streaming"));
  MutableRecord europeFranceRecord1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(3,"Hello streaming"));
  MutableRecord europeFranceRecord2=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(4,"Bonjour streaming"));
  coordinator.insert(ASIA_INDIA,asiaIndiaRecord1);
  coordinator.insert(EUROPE_UK,europeUkRecord1);
  coordinator.insert(EUROPE_FRANCE,europeFranceRecord1);
  coordinator.insert(EUROPE_FRANCE,europeFranceRecord2);
  coordinator.close();
  transaction.commit();
  StreamingAssert streamingAssertions=assertionFactory.newStreamingAssert(table,ASIA_INDIA);
  streamingAssertions.assertMinTransactionId(1L);
  streamingAssertions.assertMaxTransactionId(1L);
  streamingAssertions.assertExpectedFileCount(1);
  List<Record> readRecords=streamingAssertions.readRecords();
  assertThat(readRecords.size(),is(1));
  assertThat(readRecords.get(0).getRow(),is("{1, Hello streaming}"));
  assertThat(readRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,0L)));
  streamingAssertions=assertionFactory.newStreamingAssert(table,EUROPE_UK);
  streamingAssertions.assertMinTransactionId(1L);
  streamingAssertions.assertMaxTransactionId(1L);
  streamingAssertions.assertExpectedFileCount(1);
  readRecords=streamingAssertions.readRecords();
  assertThat(readRecords.size(),is(1));
  assertThat(readRecords.get(0).getRow(),is("{2, Hello streaming}"));
  assertThat(readRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,0L)));
  streamingAssertions=assertionFactory.newStreamingAssert(table,EUROPE_FRANCE);
  streamingAssertions.assertMinTransactionId(1L);
  streamingAssertions.assertMaxTransactionId(1L);
  streamingAssertions.assertExpectedFileCount(1);
  readRecords=streamingAssertions.readRecords();
  assertThat(readRecords.size(),is(2));
  assertThat(readRecords.get(0).getRow(),is("{3, Hello streaming}"));
  assertThat(readRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,0L)));
  assertThat(readRecords.get(1).getRow(),is("{4, Bonjour streaming}"));
  assertThat(readRecords.get(1).getRecordIdentifier(),is(new RecordIdentifier(1L,0,1L)));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchCommitUnpartitioned() throws Exception {
  Table table=unpartitionedTableBuilder.create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),false).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  transaction.begin();
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  BucketIdResolver bucketIdResolver=mutatorFactory.newBucketIdResolver(destinations.get(0).getTotalBuckets());
  MutableRecord record=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(1,"Hello streaming"));
  coordinator.insert(Collections.<String>emptyList(),record);
  coordinator.close();
  transaction.commit();
  StreamingAssert streamingAssertions=assertionFactory.newStreamingAssert(table);
  streamingAssertions.assertMinTransactionId(1L);
  streamingAssertions.assertMaxTransactionId(1L);
  streamingAssertions.assertExpectedFileCount(1);
  List<Record> readRecords=streamingAssertions.readRecords();
  assertThat(readRecords.size(),is(1));
  assertThat(readRecords.get(0).getRow(),is("{1, Hello streaming}"));
  assertThat(readRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,0L)));
  assertThat(transaction.getState(),is(COMMITTED));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testUpdatesAndDeletes() throws Exception {
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  Table table=partitionedTableBuilder.addPartition(ASIA_INDIA).addPartition(EUROPE_FRANCE).create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction insertTransaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  insertTransaction.begin();
  MutatorCoordinator insertCoordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  BucketIdResolver bucketIdResolver=mutatorFactory.newBucketIdResolver(destinations.get(0).getTotalBuckets());
  MutableRecord asiaIndiaRecord1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(1,"Namaste streaming 1"));
  MutableRecord asiaIndiaRecord2=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(2,"Namaste streaming 2"));
  MutableRecord europeUkRecord1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(3,"Hello streaming 1"));
  MutableRecord europeUkRecord2=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(4,"Hello streaming 2"));
  MutableRecord europeFranceRecord1=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(5,"Bonjour streaming 1"));
  MutableRecord europeFranceRecord2=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(6,"Bonjour streaming 2"));
  insertCoordinator.insert(ASIA_INDIA,asiaIndiaRecord1);
  insertCoordinator.insert(ASIA_INDIA,asiaIndiaRecord2);
  insertCoordinator.insert(EUROPE_UK,europeUkRecord1);
  insertCoordinator.insert(EUROPE_UK,europeUkRecord2);
  insertCoordinator.insert(EUROPE_FRANCE,europeFranceRecord1);
  insertCoordinator.insert(EUROPE_FRANCE,europeFranceRecord2);
  insertCoordinator.close();
  insertTransaction.commit();
  assertThat(insertTransaction.getState(),is(COMMITTED));
  client.close();
  client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction mutateTransaction=client.newTransaction();
  destinations=client.getTables();
  mutateTransaction.begin();
  MutatorCoordinator mutateCoordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  bucketIdResolver=mutatorFactory.newBucketIdResolver(destinations.get(0).getTotalBuckets());
  MutableRecord asiaIndiaRecord3=(MutableRecord)bucketIdResolver.attachBucketIdToRecord(new MutableRecord(20,"Namaste streaming 3"));
  mutateCoordinator.update(ASIA_INDIA,new MutableRecord(2,"UPDATED: Namaste streaming 2",new RecordIdentifier(1L,0,1L)));
  mutateCoordinator.insert(ASIA_INDIA,asiaIndiaRecord3);
  mutateCoordinator.delete(EUROPE_UK,new MutableRecord(3,"Hello streaming 1",new RecordIdentifier(1L,0,0L)));
  mutateCoordinator.delete(EUROPE_FRANCE,new MutableRecord(5,"Bonjour streaming 1",new RecordIdentifier(1L,0,0L)));
  mutateCoordinator.update(EUROPE_FRANCE,new MutableRecord(6,"UPDATED: Bonjour streaming 2",new RecordIdentifier(1L,0,1L)));
  mutateCoordinator.close();
  mutateTransaction.commit();
  assertThat(mutateTransaction.getState(),is(COMMITTED));
  StreamingAssert indiaAssertions=assertionFactory.newStreamingAssert(table,ASIA_INDIA);
  indiaAssertions.assertMinTransactionId(1L);
  indiaAssertions.assertMaxTransactionId(2L);
  List<Record> indiaRecords=indiaAssertions.readRecords();
  assertThat(indiaRecords.size(),is(3));
  assertThat(indiaRecords.get(0).getRow(),is("{1, Namaste streaming 1}"));
  assertThat(indiaRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,0L)));
  assertThat(indiaRecords.get(1).getRow(),is("{2, UPDATED: Namaste streaming 2}"));
  assertThat(indiaRecords.get(1).getRecordIdentifier(),is(new RecordIdentifier(1L,0,1L)));
  assertThat(indiaRecords.get(2).getRow(),is("{20, Namaste streaming 3}"));
  assertThat(indiaRecords.get(2).getRecordIdentifier(),is(new RecordIdentifier(2L,0,0L)));
  StreamingAssert ukAssertions=assertionFactory.newStreamingAssert(table,EUROPE_UK);
  ukAssertions.assertMinTransactionId(1L);
  ukAssertions.assertMaxTransactionId(2L);
  List<Record> ukRecords=ukAssertions.readRecords();
  assertThat(ukRecords.size(),is(1));
  assertThat(ukRecords.get(0).getRow(),is("{4, Hello streaming 2}"));
  assertThat(ukRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,1L)));
  StreamingAssert franceAssertions=assertionFactory.newStreamingAssert(table,EUROPE_FRANCE);
  franceAssertions.assertMinTransactionId(1L);
  franceAssertions.assertMaxTransactionId(2L);
  List<Record> franceRecords=franceAssertions.readRecords();
  assertThat(franceRecords.size(),is(1));
  assertThat(franceRecords.get(0).getRow(),is("{6, UPDATED: Bonjour streaming 2}"));
  assertThat(franceRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,1L)));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchEmptyAbortPartitioned() throws Exception {
  Table table=partitionedTableBuilder.addPartition(ASIA_INDIA).create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  transaction.begin();
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  coordinator.close();
  transaction.abort();
  assertThat(transaction.getState(),is(ABORTED));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchCommitPartitioned() throws Exception {
  Table table=partitionedTableBuilder.addPartition(ASIA_INDIA).create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  transaction.begin();
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  BucketIdResolver bucketIdAppender=mutatorFactory.newBucketIdResolver(destinations.get(0).getTotalBuckets());
  MutableRecord record=(MutableRecord)bucketIdAppender.attachBucketIdToRecord(new MutableRecord(1,"Hello streaming"));
  coordinator.insert(ASIA_INDIA,record);
  coordinator.close();
  transaction.commit();
  StreamingAssert streamingAssertions=assertionFactory.newStreamingAssert(table,ASIA_INDIA);
  streamingAssertions.assertMinTransactionId(1L);
  streamingAssertions.assertMaxTransactionId(1L);
  streamingAssertions.assertExpectedFileCount(1);
  List<Record> readRecords=streamingAssertions.readRecords();
  assertThat(readRecords.size(),is(1));
  assertThat(readRecords.get(0).getRow(),is("{1, Hello streaming}"));
  assertThat(readRecords.get(0).getRecordIdentifier(),is(new RecordIdentifier(1L,0,0L)));
  assertThat(transaction.getState(),is(COMMITTED));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchEmptyAbortUnartitioned() throws Exception {
  Table table=unpartitionedTableBuilder.create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),false).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  List<AcidTable> destinations=client.getTables();
  transaction.begin();
  MutatorFactory mutatorFactory=new ReflectiveMutatorFactory(conf,MutableRecord.class,RECORD_ID_COLUMN,BUCKET_COLUMN_INDEXES);
  MutatorCoordinator coordinator=new MutatorCoordinatorBuilder().metaStoreUri(metaStoreUri).table(destinations.get(0)).mutatorFactory(mutatorFactory).build();
  coordinator.close();
  transaction.abort();
  assertThat(transaction.getState(),is(ABORTED));
  client.close();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testTransactionBatchEmptyCommitPartitioned() throws Exception {
  Table table=partitionedTableBuilder.addPartition(ASIA_INDIA).create(metaStoreClient);
  MutatorClient client=new MutatorClientBuilder().addSinkTable(table.getDbName(),table.getTableName(),true).metaStoreUri(metaStoreUri).build();
  client.connect();
  Transaction transaction=client.newTransaction();
  transaction.begin();
  transaction.commit();
  assertThat(transaction.getState(),is(COMMITTED));
  client.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.streaming.mutate.client.TestAcidTableSerializer </h4><pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testSerializeDeserializeNoTableNoTransaction() throws Exception {
  AcidTable acidTable=new AcidTable("db_1","table_1",true,TableType.SINK);
  String encoded=AcidTableSerializer.encode(acidTable);
  AcidTable decoded=AcidTableSerializer.decode(encoded);
  assertThat(decoded.getDatabaseName(),is("db_1"));
  assertThat(decoded.getTableName(),is("table_1"));
  assertThat(decoded.createPartitions(),is(true));
  assertThat(decoded.getOutputFormatName(),is(nullValue()));
  assertThat(decoded.getTotalBuckets(),is(0));
  assertThat(decoded.getQualifiedName(),is("DB_1.TABLE_1"));
  assertThat(decoded.getTransactionId(),is(0L));
  assertThat(decoded.getTableType(),is(TableType.SINK));
  assertThat(decoded.getTable(),is(nullValue()));
}

</code></pre>

<br>
<pre class="type-11 type-5 type-20 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void testSerializeDeserialize() throws Exception {
  Database database=StreamingTestUtils.databaseBuilder(new File("/tmp")).name("db_1").build();
  Table table=StreamingTestUtils.tableBuilder(database).name("table_1").addColumn("one","string").addColumn("two","integer").partitionKeys("partition").addPartition("p1").buckets(10).build();
  AcidTable acidTable=new AcidTable("db_1","table_1",true,TableType.SINK);
  acidTable.setTable(table);
  acidTable.setTransactionId(42L);
  String encoded=AcidTableSerializer.encode(acidTable);
  System.out.println(encoded);
  AcidTable decoded=AcidTableSerializer.decode(encoded);
  assertThat(decoded.getDatabaseName(),is("db_1"));
  assertThat(decoded.getTableName(),is("table_1"));
  assertThat(decoded.createPartitions(),is(true));
  assertThat(decoded.getOutputFormatName(),is("org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat"));
  assertThat(decoded.getTotalBuckets(),is(10));
  assertThat(decoded.getQualifiedName(),is("DB_1.TABLE_1"));
  assertThat(decoded.getTransactionId(),is(42L));
  assertThat(decoded.getTableType(),is(TableType.SINK));
  assertThat(decoded.getTable(),is(table));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.TestWebHCatE2e </h4><pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void describeNoSuchTable() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/no_such_table",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.NOT_FOUND_404,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),ErrorMsg.INVALID_TABLE.getErrorCode(),getErrorCode(p.responseBody));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getStatus() throws IOException {
  LOG.debug("+getStatus()");
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/status",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
  Assert.assertTrue(p.getAssertMsg(),jsonStringToSortedMap("{\"status\":\"ok\",\"version\":\"v1\"}").equals(jsonStringToSortedMap(p.responseBody)));
  LOG.debug("-getStatus()");
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void createTable() throws IOException {
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("comment","Table in default db");
  Map<String,Object> col=new HashMap<String,Object>();
  col.put("name","col1");
  col.put("type","string");
  List<Map<String,Object>> colList=new ArrayList<Map<String,Object>>(1);
  colList.add(col);
  props.put("columns",colList);
  Map<String,Object> format=new HashMap<String,Object>();
  format.put("storedAs","rcfile");
  props.put("format",format);
  MethodCallRetVal createTbl=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/test_table",HTTP_METHOD_TYPE.PUT,props,null);
  Assert.assertEquals(createTbl.getAssertMsg(),HttpStatus.OK_200,createTbl.httpStatusCode);
  LOG.info("createTable() resp: " + createTbl.responseBody);
  MethodCallRetVal descTbl=doHttpCall(templetonBaseUrl + "/ddl/database/default/table/test_table",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(descTbl.getAssertMsg(),HttpStatus.OK_200,descTbl.httpStatusCode);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void listDataBases() throws IOException {
  LOG.debug("+listDataBases()");
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database",HTTP_METHOD_TYPE.GET);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),"{\"databases\":[\"default\"]}",p.responseBody);
  LOG.debug("-listDataBases()");
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Ignore("not ready due to HIVE-4824") @Test public void createDataBase() throws IOException {
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("comment","Hello, there");
  props.put("location",System.getProperty("test.warehouse.dir"));
  Map<String,String> props2=new HashMap<String,String>();
  props2.put("prop","val");
  props.put("properties",props2);
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/newdb",HTTP_METHOD_TYPE.PUT,props,null);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.OK_200,p.httpStatusCode);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tries to drop table in a DB that doesn't exist
 */
@Ignore("not ready due to HIVE-4824") @Test public void dropTableNoSuchDB() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/no_such_db/table/t1",HTTP_METHOD_TYPE.DELETE);
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.NOT_FOUND_404,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),ErrorMsg.DATABASE_NOT_EXISTS.getErrorCode(),getErrorCode(p.responseBody));
}

</code></pre>

<br>
<pre class="type-11 type-7 type-17 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * tries to drop table in a DB that doesn't exist
 */
@Ignore("not ready due to HIVE-4824") @Test public void dropTableNoSuchDbIfExists() throws IOException {
  MethodCallRetVal p=doHttpCall(templetonBaseUrl + "/ddl/database/no_such_db/table/t1",HTTP_METHOD_TYPE.DELETE,null,new NameValuePair[]{new NameValuePair("ifExists","true")});
  Assert.assertEquals(p.getAssertMsg(),HttpStatus.NOT_FOUND_404,p.httpStatusCode);
  Assert.assertEquals(p.getAssertMsg(),ErrorMsg.DATABASE_NOT_EXISTS.getErrorCode(),getErrorCode(p.responseBody));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTempletonUtils </h4><pre class="type-11 type-6 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecodeArray(){
  Assert.assertTrue(TempletonUtils.encodeArray((String[])null) == null);
  String[] tmp=new String[3];
  tmp[0]="fred";
  tmp[1]=null;
  tmp[2]="peter,lisa,, barney";
  String[] tmp2=TempletonUtils.decodeArray(TempletonUtils.encodeArray(tmp));
  try {
    for (int i=0; i < tmp.length; i++) {
      Assert.assertEquals((String)tmp[i],(String)tmp2[i]);
    }
  }
 catch (  Exception e) {
    Assert.fail("Arrays were not equal" + e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConstructingUserHomeDirectory() throws Exception {
  String[] sources=new String[]{"output+","/user/hadoop/output","hdfs://container","hdfs://container/","hdfs://container/path","output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  String[] expectedResults=new String[]{"/user/webhcat/output+","/user/hadoop/output","hdfs://container/user/webhcat","hdfs://container/","hdfs://container/path","/user/webhcat/output#link","hdfs://cointaner/output#link","hdfs://container@acc/test"};
  for (int i=0; i < sources.length; i++) {
    String source=sources[i];
    String expectedResult=expectedResults[i];
    String result=TempletonUtils.addUserHomeDirectoryIfApplicable(source,"webhcat");
    Assert.assertEquals(result,expectedResult);
  }
  String badUri="c:\\some\\path";
  try {
    TempletonUtils.addUserHomeDirectoryIfApplicable(badUri,"webhcat");
    Assert.fail("addUserHomeDirectoryIfApplicable should fail for bad URI: " + badUri);
  }
 catch (  URISyntaxException ex) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPropertiesParsing() throws Exception {
  String[] props={"hive.metastore.uris=thrift://localhost:9933\\,thrift://127.0.0.1:9933","hive.metastore.sasl.enabled=false","hive.some.fake.path=C:\\foo\\bar.txt\\"};
  StringBuilder input=new StringBuilder();
  for (  String prop : props) {
    if (input.length() > 0) {
      input.append(',');
    }
    input.append(prop);
  }
  String[] newProps=StringUtils.split(input.toString());
  for (int i=0; i < newProps.length; i++) {
    Assert.assertEquals("Pre/post split values don't match",TempletonUtils.unEscapeString(props[i]),TempletonUtils.unEscapeString(newProps[i]));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.hcatalog.templeton.tool.TestTrivialExecService </h4><pre class="type-11 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  ArrayList<String> list=new ArrayList<String>();
  list.add("echo");
  list.add("success");
  BufferedReader out=null;
  BufferedReader err=null;
  try {
    Process process=TrivialExecService.getInstance().run(list,new ArrayList<String>(),new HashMap<String,String>());
    out=new BufferedReader(new InputStreamReader(process.getInputStream()));
    err=new BufferedReader(new InputStreamReader(process.getErrorStream()));
    Assert.assertEquals("success",out.readLine());
    out.close();
    String line;
    while ((line=err.readLine()) != null) {
      Assert.fail(line);
    }
    process.waitFor();
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail("Process caused exception.");
  }
 finally {
    try {
      out.close();
    }
 catch (    Exception ex) {
    }
    try {
      err.close();
    }
 catch (    Exception ex) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcDriver2 </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify 'explain ...' resultset
 * @throws SQLException
 */
@Test public void testExplainStmt() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("explain select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),1);
  assertEquals(md.getColumnLabel(1),EXPL_COLUMN_NAME);
  assertTrue("Nothing returned explain",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-10 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  con=getConnection("default");
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("set hive.support.concurrency = false");
  createTestTables(stmt,"",true);
  createTestTables(stmt,"testdb.",false);
  stmt.execute("drop table " + externalTable);
  stmt.execute("create external table " + externalTable + " (a int) comment '"+ externalTableComment+ "' location '"+ dataFileDir+ "'");
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testURLWithFetchSize() throws SQLException {
  Connection con=getConnection("default;fetchSize=1234");
  Statement stmt=con.createStatement();
  assertEquals(stmt.getFetchSize(),1234);
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},8);
  tests.put(new String[]{"testhiveJDBC%",null},8);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,"default",checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("c12_1",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Loads data from a table containing non-ascii value column
 * Runs a query and compares the return value
 * @throws Exception
 */
@Test public void testNonAsciiReturnValues() throws Exception {
  String nonAsciiTableName="nonAsciiTable";
  String nonAsciiString="Garu Kkaku kidtai";
  Path nonAsciiFilePath=new Path(dataFileDir,"non_ascii_tbl.txt");
  Statement stmt=con.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("create table " + nonAsciiTableName + " (key int, value string) "+ "row format delimited fields terminated by '|'");
  stmt.execute("load data local inpath '" + nonAsciiFilePath.toString() + "' into table "+ nonAsciiTableName);
  ResultSet rs=stmt.executeQuery("select value from " + nonAsciiTableName + " limit 1");
  while (rs.next()) {
    String resultValue=rs.getString(1);
    assertTrue(resultValue.equalsIgnoreCase(nonAsciiString));
  }
  try {
    stmt.execute("drop table " + nonAsciiTableName);
  }
 catch (  Exception ex) {
  }
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeTable() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("describe " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  assertEquals("Column type 'under_col' for column under_col not found","int",res.getString(2));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertEquals("Column type 'string' for column key not found","string",res.getString(2));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.1234560",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-13 type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  dropTestTables(stmt,"");
  dropTestTables(stmt,"testdb.");
  con.close();
  assertTrue("Connection should be closed",con.isClosed());
  Exception expectedException=null;
  try {
    con.createStatement();
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("createStatement() on closed connection should throw exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getProcedureColumns()
 * @throws SQLException
 */
@Test public void testProcCols() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedureColumns(null,null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),20);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting using builtin UDFs
 * @throws SQLException
 */
@Test public void testBuiltInUDFCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c12, bin(c12) from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(2),"c1");
  assertTrue(res.next());
  assertEquals(res.getLong(1),1);
  assertEquals(res.getString(2),"1");
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log when HS2 disable logging.
 * @throws Exception
 */
@Test public void testGetQueryLogOnDisabledLog() throws Exception {
  Statement setStmt=con.createStatement();
  setStmt.execute("set hive.server2.logging.operation.enabled = false");
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10);
  stmt.close();
  assertTrue(logs.size() == 0);
  setStmt.execute("set hive.server2.logging.operation.enabled = true");
  setStmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetSchemas() throws SQLException {
  ResultSet rs=con.getMetaData().getSchemas();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(2,resMeta.getColumnCount());
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(1));
  assertEquals("TABLE_CATALOG",resMeta.getColumnName(2));
  assertTrue(rs.next());
  assertEquals("default",rs.getString(1));
  assertTrue(rs.next());
  assertEquals("testdb",rs.getString(1));
  assertFalse(rs.next());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test testProccedures()
 * @throws SQLException
 */
@Test public void testProccedures() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedures(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),9);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetExternalTables() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("set " + HiveConf.ConfVars.HIVE_SERVER2_TABLE_TYPE_MAPPING.varname + " = "+ TableTypeMappings.HIVE.toString());
  stmt.close();
  ResultSet rs=con.getMetaData().getTables(null,null,null,new String[]{TableType.EXTERNAL_TABLE.toString()});
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(10,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(2));
  assertEquals("TABLE_NAME",resMeta.getColumnName(3));
  assertEquals("TABLE_TYPE",resMeta.getColumnName(4));
  assertEquals("REMARKS",resMeta.getColumnName(5));
  rs.next();
  String resultDbName=rs.getString("TABLE_SCHEM");
  assertEquals(resultDbName,"default");
  String resultTableName=rs.getString("TABLE_NAME");
  assertEquals(resultTableName,externalTable.toLowerCase());
  String resultTableComment=rs.getString("REMARKS");
  assertTrue("Missing comment on the table.",resultTableComment.length() > 0);
  String tableType=rs.getString("TABLE_TYPE");
  assertEquals(TableType.EXTERNAL_TABLE.toString(),tableType);
  assertFalse("Unexpected table",rs.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting named expression columns
 * @throws SQLException
 */
@Test public void testExprCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1+1 as col1, length(c4) as len from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(1),"col1");
  assertEquals(md.getColumnLabel(2),"len");
  assertTrue(res.next());
  assertEquals(res.getInt(1),2);
  assertEquals(res.getInt(2),1);
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetCatalogs() throws SQLException {
  ResultSet rs=con.getMetaData().getCatalogs();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(1,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertFalse(rs.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseMetaData() throws SQLException {
  DatabaseMetaData meta=con.getMetaData();
  assertEquals("Apache Hive",meta.getDatabaseProductName());
  assertEquals(HiveVersionInfo.getVersion(),meta.getDatabaseProductVersion());
  assertEquals(System.getProperty("hive.version"),meta.getDatabaseProductVersion());
  assertTrue("verifying hive version pattern. got " + meta.getDatabaseProductVersion(),Pattern.matches("\\d+\\.\\d+\\.\\d+.*",meta.getDatabaseProductVersion()));
  assertEquals(DatabaseMetaData.sqlStateSQL99,meta.getSQLStateType());
  assertFalse(meta.supportsCatalogsInTableDefinitions());
  assertTrue(meta.supportsSchemasInTableDefinitions());
  assertTrue(meta.supportsSchemasInDataManipulation());
  assertFalse(meta.supportsMultipleResultSets());
  assertFalse(meta.supportsStoredProcedures());
  assertTrue(meta.supportsAlterTableWithAddColumn());
  assertTrue(meta.getDatabaseMajorVersion() > -1);
  assertTrue(meta.getDatabaseMinorVersion() > -1);
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCloseResultSet() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  res.close();
  assertFalse(stmt.isClosed());
  try {
    stmt.cancel();
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  stmt.close();
  stmt=con.createStatement();
  res=stmt.executeQuery("select * from " + tableName);
  res.close();
  try {
    stmt.executeQuery("select * from " + tableName);
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  stmt.close();
  assertTrue(stmt.isClosed());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getPrimaryKeys()
 * @throws SQLException
 */
@Test public void testPrimaryKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getPrimaryKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),6);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowGrant() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("grant select on table " + dataTypeTableName + " to user hive_test_user");
  stmt.execute("show grant user hive_test_user on table " + dataTypeTableName);
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("default",res.getString(1));
  assertEquals(dataTypeTableName,res.getString(2));
  assertEquals("",res.getString(3));
  assertEquals("",res.getString(4));
  assertEquals("hive_test_user",res.getString(5));
  assertEquals("USER",res.getString(6));
  assertEquals("SELECT",res.getString(7));
  assertEquals(false,res.getBoolean(8));
  assertEquals(-1,res.getLong(9));
  assertNotNull(res.getString(10));
  assertFalse(res.next());
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParentReferences() throws Exception {
  Statement s=this.con.createStatement();
  ResultSet rs=s.executeQuery("SELECT * FROM " + dataTypeTableName);
  assertTrue(s.getConnection() == this.con);
  assertTrue(rs.getStatement() == s);
  rs.close();
  s.close();
  PreparedStatement ps=this.con.prepareStatement("SELECT * FROM " + dataTypeTableName);
  rs=ps.executeQuery();
  assertTrue(ps.getConnection() == this.con);
  assertTrue(rs.getStatement() == ps);
  rs.close();
  ps.close();
  DatabaseMetaData md=this.con.getMetaData();
  assertTrue(md.getConnection() == this.con);
  rs=md.getCatalogs();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getFunctions(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getImportedKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getPrimaryKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedureColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedures(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getSchemas();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTableTypes();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTables(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTypeInfo();
  assertNull(rs.getStatement());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getImportedKeys()
 * @throws SQLException
 */
@Test public void testImportedKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getImportedKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),14);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateColumnNameOrder() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet rs=stmt.executeQuery("SELECT 1 AS a, 2 AS a from " + tableName);
  assertTrue(rs.next());
  assertEquals(1,rs.getInt("a"));
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * validate schema generated by "set" command
 * @throws SQLException
 */
@Test public void testSetCommand() throws SQLException {
  String sql="set -v";
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery(sql);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(1,md.getColumnCount());
  assertEquals(SET_COLUMN_NAME,md.getColumnLabel(1));
  int numLines=0;
  while (res.next()) {
    numLines++;
    String rline=res.getString(1);
    assertFalse("set output must not contain hidden variables such as the metastore password:" + rline,rline.contains(HiveConf.ConfVars.METASTOREPWD.varname) && !(rline.contains(HiveConf.ConfVars.HIVE_CONF_HIDDEN_LIST.varname)));
  }
  assertTrue("Nothing returned by set -v",numLines > 0);
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutoCommit() throws Exception {
  con.clearWarnings();
  con.setAutoCommit(true);
  assertNull(con.getWarnings());
  con.setAutoCommit(false);
  SQLWarning warning=con.getWarnings();
  assertNotNull(warning);
  assertEquals("Hive does not support autoCommit=false",warning.getMessage());
  assertNull(warning.getNextWarning());
  con.clearWarnings();
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Validate the Metadata for the result set of a metadata getColumns call.
 */
@Test public void testMetaDataGetColumnsMetaData() throws SQLException {
  ResultSet rs=con.getMetaData().getColumns(null,null,"testhivejdbcdriver\\_table",null);
  ResultSetMetaData rsmd=rs.getMetaData();
  assertEquals("TABLE_CAT",rsmd.getColumnName(1));
  assertEquals(Types.VARCHAR,rsmd.getColumnType(1));
  assertEquals(Integer.MAX_VALUE,rsmd.getColumnDisplaySize(1));
  assertEquals("ORDINAL_POSITION",rsmd.getColumnName(17));
  assertEquals(Types.INTEGER,rsmd.getColumnType(17));
  assertEquals(11,rsmd.getColumnDisplaySize(17));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullType() throws Exception {
  Statement stmt=con.createStatement();
  try {
    ResultSet res=stmt.executeQuery("select null from " + dataTypeTableName);
    assertTrue(res.next());
    assertNull(res.getObject(1));
  }
  finally {
    stmt.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.execute("drop role role1");
  }
 catch (  Exception ex) {
    LOG.warn("Ignoring error during drop role: " + ex);
  }
  stmt.execute("create role role1");
  stmt.execute("grant role role1 to user hive_test_user");
  stmt.execute("show role grant user hive_test_user");
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("public",res.getString(1));
  assertTrue(res.next());
  assertEquals("role1",res.getString(1));
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetTimestamp() throws SQLException, ParseException {
  String sql=String.format("SELECT * FROM %s WHERE c17 = ?",dataTypeTableName);
  try (PreparedStatement ps=con.prepareStatement(sql)){
    Timestamp timestamp=Timestamp.valueOf("2012-04-22 09:00:00.123456789");
    ps.setTimestamp(1,timestamp);
    try (ResultSet resultSet=ps.executeQuery()){
      assertTrue(resultSet.next());
      assertEquals(1,resultSet.getInt(1));
      assertFalse(resultSet.next());
    }
   }
 }

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowColumns() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show columns in " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaDataDuplicateColumnNames() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1 as c2_1, c2, c1*2 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(3,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c2_1",meta.getColumnName(1));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertTrue(colRS.next());
  assertEquals("c2_2",meta.getColumnName(3));
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test bad args to getXXX()
 * @throws SQLException
 */
@Test public void testOutOfBoundCols() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertTrue(res.next());
  try {
    res.getInt(200);
  }
 catch (  SQLException e) {
  }
  try {
    res.getInt("zzzz");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithLocalClusterSpark </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPermFunc() throws Exception {
  String udfClassName="org.apache.hadoop.hive.contrib.udf.example.UDFExampleAdd";
  String mvnRepo=System.getProperty("maven.local.repository");
  String hiveVersion=System.getProperty("hive.version");
  String jarFileName="hive-contrib-" + hiveVersion + ".jar";
  String[] pathParts={"org","apache","hive","hive-contrib",hiveVersion,jarFileName};
  Path contribJarPath=new Path(mvnRepo);
  for (  String pathPart : pathParts) {
    contribJarPath=new Path(contribJarPath,pathPart);
  }
  FileSystem localFs=FileSystem.getLocal(conf);
  assertTrue("Hive contrib JAR exists at " + contribJarPath,localFs.exists(contribJarPath));
  String hdfsJarPathStr="hdfs:///" + jarFileName;
  Path hdfsJarPath=new Path(hdfsJarPathStr);
  FileSystem dfs=miniHS2.getDFS().getFileSystem();
  dfs.copyFromLocalFile(contribJarPath,hdfsJarPath);
  assertTrue("Verify contrib JAR copied to HDFS at " + hdfsJarPath,dfs.exists(hdfsJarPath));
  String queryStr="CREATE FUNCTION example_add AS '" + udfClassName + "'"+ " USING JAR '"+ hdfsJarPathStr+ "'";
  stmt.execute(queryStr);
  ResultSet res;
  res=stmt.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  String tableName="testTab3";
  setupKv1Tabs(tableName);
  res=stmt.executeQuery("SELECT EXAMPLE_ADD(1, 2) FROM " + tableName + " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(3,res.getInt(1));
  assertFalse("no more results",res.next());
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  res=stmt2.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  res=stmt2.executeQuery("SELECT " + dbName + ".example_add(1, 1) FROM "+ tableName+ " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(2,res.getInt(1));
  assertFalse("no more results",res.next());
  stmt.execute("DROP TABLE " + tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniHS2 </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentStatements() throws Exception {
  String tableName="testConcurrentStatements";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("DROP TABLE IF EXISTS " + tableName);
  stmt.execute("CREATE TABLE " + tableName + " (under_col INT COMMENT 'the under column', value STRING) COMMENT ' test table'");
  stmt.execute("load data local inpath '" + kvDataFilePath.toString() + "' into table "+ tableName);
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  assertTrue(res.next());
  res.close();
  stmt.close();
  int POOL_SIZE=100;
  int TASK_COUNT=300;
  SynchronousQueue<Runnable> executorQueue=new SynchronousQueue<Runnable>();
  ExecutorService workers=new ThreadPoolExecutor(1,POOL_SIZE,20,TimeUnit.SECONDS,executorQueue);
  List<Future<Boolean>> list=new ArrayList<Future<Boolean>>();
  int i=0;
  while (i < TASK_COUNT) {
    try {
      Future<Boolean> future=workers.submit(new JDBCTask(hs2Conn,i,tableName));
      list.add(future);
      i++;
    }
 catch (    RejectedExecutionException ree) {
      try {
        TimeUnit.MILLISECONDS.sleep(100);
      }
 catch (      InterruptedException e) {
        Thread.currentThread().interrupt();
      }
    }
  }
  for (  Future<Boolean> future : list) {
    try {
      Boolean result=future.get(30,TimeUnit.SECONDS);
      assertTrue(result);
    }
 catch (    ExecutionException ee) {
      fail("Concurrent Statement failed: " + ee.getCause());
    }
catch (    TimeoutException te) {
      System.out.println("Task was timeout after 30 second: " + te);
    }
catch (    CancellationException ce) {
      System.out.println("Task was interrupted: " + ce);
    }
catch (    InterruptedException ie) {
      System.out.println("Thread was interrupted: " + ie);
    }
  }
  workers.shutdown();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnection() throws Exception {
  String tableName="testTab1";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("DROP TABLE IF EXISTS " + tableName);
  stmt.execute("CREATE TABLE " + tableName + " (under_col INT COMMENT 'the under column', value STRING) COMMENT ' test table'");
  stmt.execute("load data local inpath '" + kvDataFilePath.toString() + "' into table "+ tableName);
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  assertTrue(res.next());
  assertEquals("val_238",res.getString(2));
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test is to connect to any database without using the command "Use <<DB>>"
 * 1)connect to default database.
 * 2) Create a new DB test_default.
 * 3) Connect to test_default database.
 * 4) Connect and create table under test_default_test.
 * 5) Connect and display all tables.
 * 6) Connect to default database and shouldn't find table test_default_test.
 * 7) Connect and drop test_default_test.
 * 8) drop test_default database.
 */
@Test public void testURIDatabaseName() throws Exception {
  String jdbcUri=miniHS2.getJdbcURL().substring(0,miniHS2.getJdbcURL().indexOf("default"));
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  String dbName="test_connection_non_default_db";
  String tableInNonDefaultSchema="table_in_non_default_schema";
  Statement stmt=hs2Conn.createStatement();
  stmt.execute("create database  if not exists " + dbName);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  boolean expected=stmt.execute(" create table " + tableInNonDefaultSchema + " (x int)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name  " + tableInNonDefaultSchema + "   found in SHOW TABLES result set",testTableExists);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  res=stmt.executeQuery("show tables");
  testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertFalse("table name " + tableInNonDefaultSchema + "  NOT  found in SHOW TABLES result set",testTableExists);
  stmt.close();
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + dbName,System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  res=stmt.executeQuery("show tables");
  stmt.execute(" drop table if exists table_in_non_default_schema");
  expected=stmt.execute("DROP DATABASE " + dbName);
  stmt.close();
  hs2Conn=getConnection(jdbcUri + "default",System.getProperty("user.name"),"bar");
  stmt=hs2Conn.createStatement();
  res=stmt.executeQuery("show tables");
  testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableInNonDefaultSchema.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  hs2Conn=getConnection(jdbcUri,System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + ";",System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
  hs2Conn=getConnection(jdbcUri + ";/foo=bar;foo1=bar1",System.getProperty("user.name"),"bar");
  verifyCurrentDB("default",hs2Conn);
  hs2Conn.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Tests that DataNucleus' NucleusContext.classLoaderResolverMap clears cached class objects
 * (& hence doesn't leak classloaders) on closing any session
 * @throws Exception
 */
@Test public void testAddJarDataNucleusUnCaching() throws Exception {
  Path jarFilePath=new Path(dataFileDir,"identity_udf.jar");
  Connection conn=getConnection(miniHS2.getJdbcURL(),"foo","bar");
  String tableName="testAddJar";
  Statement stmt=conn.createStatement();
  stmt.execute("SET hive.support.concurrency = false");
  stmt.execute("DROP TABLE IF EXISTS " + tableName);
  stmt.execute("CREATE TABLE " + tableName + " (key INT, value STRING)");
  stmt.execute("LOAD DATA LOCAL INPATH '" + kvDataFilePath.toString() + "' INTO TABLE "+ tableName);
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  assertTrue(res.next());
  int mapSizeBeforeClose;
  int mapSizeAfterClose;
  stmt.execute("ADD JAR " + jarFilePath.toString());
  stmt.execute("CREATE TEMPORARY FUNCTION func AS 'IdentityStringUDF'");
  stmt.execute("SELECT func(value) from " + tableName);
  mapSizeBeforeClose=getNucleusClassLoaderResolverMapSize();
  System.out.println("classLoaderResolverMap size before connection close: " + mapSizeBeforeClose);
  Assert.assertTrue(mapSizeBeforeClose > 0);
  conn.close();
  mapSizeAfterClose=getNucleusClassLoaderResolverMapSize();
  System.out.println("classLoaderResolverMap size after connection close: " + mapSizeAfterClose);
  Assert.assertTrue("Failed; NucleusContext classLoaderResolverMap size: " + mapSizeAfterClose,mapSizeAfterClose == 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestJdbcWithMiniMr </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPermFunc() throws Exception {
  String udfClassName="org.apache.hadoop.hive.contrib.udf.example.UDFExampleAdd";
  String mvnRepo=System.getProperty("maven.local.repository");
  String hiveVersion=System.getProperty("hive.version");
  String jarFileName="hive-contrib-" + hiveVersion + ".jar";
  String[] pathParts={"org","apache","hive","hive-contrib",hiveVersion,jarFileName};
  Path contribJarPath=new Path(mvnRepo);
  for (  String pathPart : pathParts) {
    contribJarPath=new Path(contribJarPath,pathPart);
  }
  FileSystem localFs=FileSystem.getLocal(conf);
  assertTrue("Hive contrib JAR exists at " + contribJarPath,localFs.exists(contribJarPath));
  String hdfsJarPathStr="hdfs:///" + jarFileName;
  Path hdfsJarPath=new Path(hdfsJarPathStr);
  FileSystem dfs=miniHS2.getDFS().getFileSystem();
  dfs.copyFromLocalFile(contribJarPath,hdfsJarPath);
  assertTrue("Verify contrib JAR copied to HDFS at " + hdfsJarPath,dfs.exists(hdfsJarPath));
  String queryStr="CREATE FUNCTION example_add AS '" + udfClassName + "'"+ " USING JAR '"+ hdfsJarPathStr+ "'";
  stmt.execute(queryStr);
  ResultSet res;
  res=stmt.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  String tableName="testTab3";
  setupKv1Tabs(tableName);
  res=stmt.executeQuery("SELECT EXAMPLE_ADD(1, 2) FROM " + tableName + " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(3,res.getInt(1));
  assertFalse("no more results",res.next());
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  res=stmt2.executeQuery("DESCRIBE FUNCTION " + dbName + ".example_add");
  checkForNotExist(res);
  res=stmt2.executeQuery("SELECT " + dbName + ".example_add(1, 1) FROM "+ tableName+ " LIMIT 1");
  assertTrue("query has results",res.next());
  assertEquals(2,res.getInt(1));
  assertFalse("no more results",res.next());
  stmt.execute("DROP TABLE " + tableName);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTempTable() throws Exception {
  String tempTableName="tmp1";
  stmt.execute("CREATE TEMPORARY TABLE " + tempTableName + " (key string, value string)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tempTableName);
  String resultVal="val_238";
  String queryStr="SELECT * FROM " + tempTableName + " where value = '"+ resultVal+ "'";
  verifyResult(queryStr,resultVal,2);
  DatabaseMetaData md=hs2Conn.getMetaData();
  assertTrue(md.getConnection() == hs2Conn);
  ResultSet rs=md.getTables(null,null,tempTableName,null);
  boolean foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getTables(null,null,null,null);
  foundTable=false;
  while (rs.next()) {
    String tableName=rs.getString(3);
    if (tableName.equalsIgnoreCase(tempTableName)) {
      assertFalse("Table not found yet",foundTable);
      foundTable=true;
    }
  }
  assertTrue("Found temp table",foundTable);
  rs=md.getColumns(null,null,tempTableName,null);
  assertTrue("First row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("key"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  assertTrue("Second row",rs.next());
  assertTrue(rs.getString(3).equalsIgnoreCase(tempTableName));
  assertTrue(rs.getString(4).equalsIgnoreCase("value"));
  assertEquals(Types.VARCHAR,rs.getInt(5));
  Connection conn2=DriverManager.getConnection(miniHS2.getJdbcURL(dbName),System.getProperty("user.name"),"bar");
  Statement stmt2=conn2.createStatement();
  stmt2.execute("USE " + dbName);
  boolean gotException=false;
  try {
    ResultSet res;
    res=stmt2.executeQuery(queryStr);
  }
 catch (  SQLException err) {
    assertTrue("Expecting table not found error, instead got: " + err,err.getMessage().contains("Table not found"));
    gotException=true;
  }
  assertTrue("Exception while querying non-existing temp table",gotException);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestSSL </h4><pre class="type-11 type-3 type-4 type-5 type-21 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests to ensure SSLv2 and SSLv3 are disabled
 */
@Test public void testSSLVersion() throws Exception {
  Assume.assumeTrue(execCommand("which openssl") == 0);
  Assume.assumeTrue(System.getProperty("os.name").toLowerCase().contains("linux"));
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD,System.getProperty("user.name"),"bar");
  hs2Conn.close();
  Assert.assertEquals("Expected exit code of 1",1,execCommand("openssl s_client -connect " + miniHS2.getHost() + ":"+ miniHS2.getBinaryPort()+ " -ssl2 < /dev/null"));
  Assert.assertEquals("Expected exit code of 1",1,execCommand("openssl s_client -connect " + miniHS2.getHost() + ":"+ miniHS2.getBinaryPort()+ " -ssl3 < /dev/null"));
  miniHS2.stop();
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  try {
    hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL() + ";ssl=true;sslTrustStore=" + dataFileDir+ File.separator+ TRUST_STORE_NAME+ ";trustStorePassword="+ KEY_STORE_PASSWORD,System.getProperty("user.name"),"bar");
    Assert.fail("Expected SQLException during connect");
  }
 catch (  SQLException e) {
    LOG.info("Expected exception: " + e,e);
    Assert.assertEquals("08S01",e.getSQLState().trim());
    Throwable cause=e.getCause();
    Assert.assertNotNull(cause);
    while (cause.getCause() != null) {
      cause=cause.getCause();
    }
    Assert.assertEquals("org.apache.http.NoHttpResponseException",cause.getClass().getName());
    Assert.assertTrue(cause.getMessage().contains("failed to respond"));
  }
  miniHS2.stop();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Start HS2 in SSL mode, open a SSL connection and fetch data
 * @throws Exception
 */
@Test public void testSSLFetch() throws Exception {
  setSslConfOverlay(confOverlay);
  setBinaryConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  String tableName="sslTab";
  Path dataFilePath=new Path(dataFileDir,"kv1.txt");
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
  setupTestTableWithData(tableName,dataFilePath,hs2Conn);
  Statement stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  int rowCount=0;
  while (res.next()) {
    ++rowCount;
    assertEquals("val_" + res.getInt(1),res.getString(2));
  }
  assertEquals(500,rowCount);
  hs2Conn.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Start HS2 in Http mode with SSL enabled, open a SSL connection and fetch data
 * @throws Exception
 */
@Test public void testSSLFetchHttp() throws Exception {
  setSslConfOverlay(confOverlay);
  setHttpConfOverlay(confOverlay);
  miniHS2.start(confOverlay);
  String tableName="sslTab";
  Path dataFilePath=new Path(dataFileDir,"kv1.txt");
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL("default",SSL_CONN_PARAMS),System.getProperty("user.name"),"bar");
  setupTestTableWithData(tableName,dataFilePath,hs2Conn);
  Statement stmt=hs2Conn.createStatement();
  ResultSet res=stmt.executeQuery("SELECT * FROM " + tableName);
  int rowCount=0;
  while (res.next()) {
    ++rowCount;
    assertEquals("val_" + res.getInt(1),res.getString(2));
  }
  assertEquals(500,rowCount);
  hs2Conn.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.TestServiceDiscovery </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConnect() throws Exception {
  Map<String,String> confs=new HashMap<String,String>();
  confs.put("hive.server2.thrift.bind.host","host-1");
  confs.put("hive.server2.transport.mode","binary");
  confs.put("hive.server2.thrift.port","8000");
  confs.put("hive.server2.authentication","PLAIN");
  publishConfsToZk(confs,"uri1");
  confs.clear();
  confs.put("hive.server2.thrift.bind.host","host-2");
  confs.put("hive.server2.transport.mode","binary");
  confs.put("hive.server2.thrift.port","9000");
  confs.put("hive.server2.authentication","PLAIN");
  publishConfsToZk(confs,"uri2");
  confs.clear();
  confs.put("hive.server2.thrift.bind.host","host-3");
  confs.put("hive.server2.transport.mode","binary");
  confs.put("hive.server2.thrift.port","10000");
  confs.put("hive.server2.authentication","PLAIN");
  publishConfsToZk(confs,"uri3");
  Utils.JdbcConnectionParams connParams=new Utils.JdbcConnectionParams();
  connParams.setZooKeeperEnsemble(server.getConnectString());
  connParams.getSessionVars().put(Utils.JdbcConnectionParams.ZOOKEEPER_NAMESPACE,"hiveserver2");
  List<ConnParamInfo> allConnectParams=new ArrayList<>();
  while (true) {
    try {
      ZooKeeperHiveClientHelper.configureConnParams(connParams);
    }
 catch (    ZooKeeperHiveClientException e) {
      break;
    }
    connParams.getRejectedHostZnodePaths().add(connParams.getCurrentHostZnodePath());
    allConnectParams.add(new ConnParamInfo(connParams.getHost(),connParams.getPort(),connParams.getCurrentHostZnodePath()));
  }
  Collection<ConnParamInfo> cp1=Collections2.filter(allConnectParams,new ConnParamInfoPred("host-1",8000,"serverUri=uri1"));
  Collection<ConnParamInfo> cp2=Collections2.filter(allConnectParams,new ConnParamInfoPred("host-2",9000,"serverUri=uri2"));
  Collection<ConnParamInfo> cp3=Collections2.filter(allConnectParams,new ConnParamInfoPred("host-3",10000,"serverUri=uri3"));
  Assert.assertEquals(cp1.size(),1);
  Assert.assertEquals(cp2.size(),1);
  Assert.assertEquals(cp3.size(),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestJdbcMetadataApiAuth </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Call the HS2 metadata api's with authorizer allowing those calls
 * @throws Exception
 */
@Test public void testMetaApiAllowed() throws Exception {
  TestAuthValidator.allowActions=true;
  Connection hs2Conn=getConnection("user1");
  DatabaseMetaData dbmetadata=hs2Conn.getMetaData();
  ResultSet res;
  res=dbmetadata.getCatalogs();
  assertFalse(res.next());
  res=dbmetadata.getSchemas();
  assertTrue(res.next());
  assertTrue(res.next());
  res=dbmetadata.getTypeInfo();
  assertTrue(res.next());
  res=dbmetadata.getTables(null,"default","t%",null);
  assertTrue(res.next());
  res=dbmetadata.getTableTypes();
  assertTrue(res.next());
  res=dbmetadata.getColumns(null,"default","nosuchtable",null);
  assertFalse(res.next());
  res=dbmetadata.getFunctions(null,null,"trim");
  assertTrue(res.next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.authorization.TestJdbcWithSQLAuthorization </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorization1() throws Exception {
  String tableName1="test_jdbc_sql_auth1";
  String tableName2="test_jdbc_sql_auth2";
{
    Connection hs2Conn=getConnection("user1");
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("create table " + tableName1 + "(i int) ");
    stmt.execute("create table " + tableName2 + "(i int) ");
    stmt.close();
    hs2Conn.close();
  }
{
    Connection hs2Conn=getConnection("user1");
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("drop table " + tableName1);
  }
{
    Connection hs2Conn=getConnection("user2");
    try {
      hs2Conn.getMetaData().getColumns(null,"default",tableName2,null);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("SELECT"));
    }
  }
{
    Connection hs2Conn=getConnection("user2");
    try {
      Statement stmt=hs2Conn.createStatement();
      stmt.execute("drop table " + tableName2);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("OBJECT OWNERSHIP"));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.jdbc.cbo_rp_TestJdbcDriver2 </h4><pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowColumns() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show columns in " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting using builtin UDFs
 * @throws SQLException
 */
@Test public void testBuiltInUDFCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c12, bin(c12) from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(2),"_c1");
  assertTrue(res.next());
  assertEquals(res.getLong(1),1);
  assertEquals(res.getString(2),"1");
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.execute("drop role role1");
  }
 catch (  Exception ex) {
    LOG.warn("Ignoring error during drop role: " + ex);
  }
  stmt.execute("create role role1");
  stmt.execute("grant role role1 to user hive_test_user");
  stmt.execute("show role grant user hive_test_user");
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("public",res.getString(1));
  assertTrue(res.next());
  assertEquals("role1",res.getString(1));
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getProcedureColumns()
 * @throws SQLException
 */
@Test public void testProcCols() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedureColumns(null,null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),20);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-10 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  con=getConnection("default");
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("set hive.cbo.returnpath.hiveop = true");
  try {
    stmt.execute("drop table " + tableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + tableName + " (under_col int comment 'the under column', value string) comment '"+ tableComment+ "'");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tableName);
  try {
    stmt.execute("drop table " + partitionedTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + partitionedTableName + " (under_col int, value string) comment '"+ partitionedTableComment+ "' partitioned by ("+ partitionedColumnName+ " STRING)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ partitionedTableName+ " PARTITION ("+ partitionedColumnName+ "="+ partitionedColumnValue+ ")");
  try {
    stmt.execute("drop table " + dataTypeTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + dataTypeTableName + " (c1 int, c2 boolean, c3 double, c4 string,"+ " c5 array<int>, c6 map<int,string>, c7 map<string,string>,"+ " c8 struct<r:string,s:int,t:double>,"+ " c9 tinyint, c10 smallint, c11 float, c12 bigint,"+ " c13 array<array<string>>,"+ " c14 map<int, map<int,int>>,"+ " c15 struct<r:int,s:struct<a:int,b:string>>,"+ " c16 array<struct<m:map<string,string>,n:int>>,"+ " c17 timestamp, "+ " c18 decimal(16,7), "+ " c19 binary, "+ " c20 date,"+ " c21 varchar(20),"+ " c22 char(15),"+ " c23 binary"+ ") comment'"+ dataTypeTableComment+ "' partitioned by (dt STRING)");
  stmt.execute("load data local inpath '" + dataTypeDataFilePath.toString() + "' into table "+ dataTypeTableName+ " PARTITION (dt='20090619')");
  try {
    stmt.execute("drop view " + viewName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create view " + viewName + " comment '"+ viewComment+ "' as select * from "+ tableName);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseMetaData() throws SQLException {
  DatabaseMetaData meta=con.getMetaData();
  assertEquals("Apache Hive",meta.getDatabaseProductName());
  assertEquals(HiveVersionInfo.getVersion(),meta.getDatabaseProductVersion());
  assertEquals(System.getProperty("hive.version"),meta.getDatabaseProductVersion());
  assertTrue("verifying hive version pattern. got " + meta.getDatabaseProductVersion(),Pattern.matches("\\d+\\.\\d+\\.\\d+.*",meta.getDatabaseProductVersion()));
  assertEquals(DatabaseMetaData.sqlStateSQL99,meta.getSQLStateType());
  assertFalse(meta.supportsCatalogsInTableDefinitions());
  assertTrue(meta.supportsSchemasInTableDefinitions());
  assertTrue(meta.supportsSchemasInDataManipulation());
  assertFalse(meta.supportsMultipleResultSets());
  assertFalse(meta.supportsStoredProcedures());
  assertTrue(meta.supportsAlterTableWithAddColumn());
  assertTrue(meta.getDatabaseMajorVersion() > -1);
  assertTrue(meta.getDatabaseMinorVersion() > -1);
}

</code></pre>

<br>
<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("_c12",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify 'explain ...' resultset
 * @throws SQLException
 */
@Test public void testExplainStmt() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("explain select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),1);
  assertEquals(md.getColumnLabel(1),EXPL_COLUMN_NAME);
  assertTrue("Nothing returned explain",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Validate the Metadata for the result set of a metadata getColumns call.
 */
@Test public void testMetaDataGetColumnsMetaData() throws SQLException {
  ResultSet rs=con.getMetaData().getColumns(null,null,"testhivejdbcdriver\\_table",null);
  ResultSetMetaData rsmd=rs.getMetaData();
  assertEquals("TABLE_CAT",rsmd.getColumnName(1));
  assertEquals(Types.VARCHAR,rsmd.getColumnType(1));
  assertEquals(Integer.MAX_VALUE,rsmd.getColumnDisplaySize(1));
  assertEquals("ORDINAL_POSITION",rsmd.getColumnName(17));
  assertEquals(Types.INTEGER,rsmd.getColumnType(17));
  assertEquals(11,rsmd.getColumnDisplaySize(17));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeTable() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("describe " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  assertEquals("Column type 'under_col' for column under_col not found","int",res.getString(2));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertEquals("Column type 'string' for column key not found","string",res.getString(2));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},7);
  tests.put(new String[]{"testhiveJDBC%",null},7);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,null,checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test testProccedures()
 * @throws SQLException
 */
@Test public void testProccedures() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedures(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),9);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCloseResultSet() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  res.close();
  assertFalse(stmt.isClosed());
  try {
    stmt.cancel();
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  stmt.close();
  stmt=con.createStatement();
  res=stmt.executeQuery("select * from " + tableName);
  res.close();
  try {
    stmt.executeQuery("select * from " + tableName);
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  stmt.close();
  assertTrue(stmt.isClosed());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetCatalogs() throws SQLException {
  ResultSet rs=con.getMetaData().getCatalogs();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(1,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertFalse(rs.next());
}

</code></pre>

<br>
<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.0123456",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateColumnNameOrder() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet rs=stmt.executeQuery("SELECT 1 AS a, 2 AS a from " + tableName);
  assertTrue(rs.next());
  assertEquals(1,rs.getInt("a"));
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting named expression columns
 * @throws SQLException
 */
@Test public void testExprCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1+1 as col1, length(c4) as len from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(1),"col1");
  assertEquals(md.getColumnLabel(2),"len");
  assertTrue(res.next());
  assertEquals(res.getInt(1),2);
  assertEquals(res.getInt(2),1);
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetSchemas() throws SQLException {
  ResultSet rs=con.getMetaData().getSchemas();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(2,resMeta.getColumnCount());
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(1));
  assertEquals("TABLE_CATALOG",resMeta.getColumnName(2));
  assertTrue(rs.next());
  assertEquals("default",rs.getString(1));
  assertFalse(rs.next());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getPrimaryKeys()
 * @throws SQLException
 */
@Test public void testPrimaryKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getPrimaryKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),6);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaDataDuplicateColumnNames() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1 as c2_1, c2, c1*2 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(3,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c2_1",meta.getColumnName(1));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertTrue(colRS.next());
  assertEquals("_c2",meta.getColumnName(3));
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * validate schema generated by "set" command
 * @throws SQLException
 */
@Test public void testSetCommand() throws SQLException {
  String sql="set -v";
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery(sql);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(1,md.getColumnCount());
  assertEquals(SET_COLUMN_NAME,md.getColumnLabel(1));
  assertTrue("Nothing returned by set -v",res.next());
  res.close();
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test bad args to getXXX()
 * @throws SQLException
 */
@Test public void testOutOfBoundCols() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertTrue(res.next());
  try {
    res.getInt(200);
  }
 catch (  SQLException e) {
  }
  try {
    res.getInt("zzzz");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowGrant() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("grant select on table " + dataTypeTableName + " to user hive_test_user");
  stmt.execute("show grant user hive_test_user on table " + dataTypeTableName);
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("default",res.getString(1));
  assertEquals(dataTypeTableName,res.getString(2));
  assertEquals("",res.getString(3));
  assertEquals("",res.getString(4));
  assertEquals("hive_test_user",res.getString(5));
  assertEquals("USER",res.getString(6));
  assertEquals("SELECT",res.getString(7));
  assertEquals(false,res.getBoolean(8));
  assertEquals(-1,res.getLong(9));
  assertNotNull(res.getString(10));
  assertFalse(res.next());
  res.close();
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetTimestamp() throws SQLException, ParseException {
  String sql=String.format("SELECT * FROM %s WHERE c17 = ?",dataTypeTableName);
  try (PreparedStatement ps=con.prepareStatement(sql)){
    Timestamp timestamp=Timestamp.valueOf("2012-04-22 09:00:00.123456789");
    ps.setTimestamp(1,timestamp);
    try (ResultSet resultSet=ps.executeQuery()){
      assertTrue(resultSet.next());
      assertEquals(1,resultSet.getInt(1));
      assertFalse(resultSet.next());
    }
   }
 }

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParentReferences() throws Exception {
  Statement s=this.con.createStatement();
  ResultSet rs=s.executeQuery("SELECT * FROM " + dataTypeTableName);
  assertTrue(s.getConnection() == this.con);
  assertTrue(rs.getStatement() == s);
  rs.close();
  s.close();
  PreparedStatement ps=this.con.prepareStatement("SELECT * FROM " + dataTypeTableName);
  rs=ps.executeQuery();
  assertTrue(ps.getConnection() == this.con);
  assertTrue(rs.getStatement() == ps);
  rs.close();
  ps.close();
  DatabaseMetaData md=this.con.getMetaData();
  assertTrue(md.getConnection() == this.con);
  rs=md.getCatalogs();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getFunctions(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getImportedKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getPrimaryKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedureColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedures(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getSchemas();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTableTypes();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTables(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTypeInfo();
  assertNull(rs.getStatement());
  rs.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getImportedKeys()
 * @throws SQLException
 */
@Test public void testImportedKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getImportedKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),14);
  assertFalse(res.next());
}

</code></pre>

<br>
<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullType() throws Exception {
  Statement stmt=con.createStatement();
  try {
    ResultSet res=stmt.executeQuery("select null from " + dataTypeTableName);
    assertTrue(res.next());
    assertNull(res.getObject(1));
  }
  finally {
    stmt.close();
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("drop table " + tableName);
  stmt.execute("drop table " + partitionedTableName);
  stmt.execute("drop table " + dataTypeTableName);
  con.close();
  assertTrue("Connection should be closed",con.isClosed());
  Exception expectedException=null;
  try {
    con.createStatement();
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("createStatement() on closed connection should throw exception",expectedException);
}

</code></pre>

<br>
<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Loads data from a table containing non-ascii value column
 * Runs a query and compares the return value
 * @throws Exception
 */
@Test public void testNonAsciiReturnValues() throws Exception {
  String nonAsciiTableName="nonAsciiTable";
  String nonAsciiString="Garu Kkaku kidtai";
  Path nonAsciiFilePath=new Path(dataFileDir,"non_ascii_tbl.txt");
  Statement stmt=con.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("create table " + nonAsciiTableName + " (key int, value string) "+ "row format delimited fields terminated by '|'");
  stmt.execute("load data local inpath '" + nonAsciiFilePath.toString() + "' into table "+ nonAsciiTableName);
  ResultSet rs=stmt.executeQuery("select value from " + nonAsciiTableName + " limit 1");
  while (rs.next()) {
    String resultValue=rs.getString(1);
    assertTrue(resultValue.equalsIgnoreCase(nonAsciiString));
  }
  try {
    stmt.execute("drop table " + nonAsciiTableName);
  }
 catch (  Exception ex) {
  }
  stmt.close();
}

</code></pre>

<br>
<pre class="type-11 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log when HS2 disable logging.
 * @throws Exception
 */
@Test public void testGetQueryLogOnDisabledLog() throws Exception {
  Statement setStmt=con.createStatement();
  setStmt.execute("set hive.server2.logging.operation.enabled = false");
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10);
  stmt.close();
  assertTrue(logs.size() == 0);
  setStmt.execute("set hive.server2.logging.operation.enabled = true");
  setStmt.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.minikdc.JdbcWithMiniKdcSQLAuthTest </h4><pre class="type-11 type-3 type-4 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthorization1() throws Exception {
  String tableName1="test_jdbc_sql_auth1";
  String tableName2="test_jdbc_sql_auth2";
{
    Connection hs2Conn=getConnection(MiniHiveKdc.HIVE_TEST_USER_1);
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("create table " + tableName1 + "(i int) ");
    stmt.execute("create table " + tableName2 + "(i int) ");
    stmt.execute("grant select on table " + tableName2 + " to user "+ MiniHiveKdc.HIVE_TEST_USER_2);
    stmt.close();
    hs2Conn.close();
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_1));
    Statement stmt=hs2Conn.createStatement();
    stmt.execute("drop table " + tableName1);
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_2));
    try {
      Statement stmt=hs2Conn.createStatement();
      stmt.execute("drop table " + tableName2);
      fail("Exception due to authorization failure is expected");
    }
 catch (    SQLException e) {
      String msg=e.getMessage();
      System.err.println("Got SQLException with message " + msg);
      assertTrue("Checking permission denied error",msg.contains("user2"));
      assertTrue("Checking permission denied error",msg.contains(tableName2));
      assertTrue("Checking permission denied error",msg.contains("OBJECT OWNERSHIP"));
    }
  }
{
    Connection hs2Conn=getConnection((MiniHiveKdc.HIVE_TEST_USER_2));
    Statement stmt=hs2Conn.createStatement();
    stmt.execute(" desc " + tableName2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.TestJIRAService </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTrimMesssagesTrimmed(){
  List<String> messages=Lists.newArrayList();
  for (int i=0; i < JIRAService.MAX_MESSAGES + 1; i++) {
    messages.add(String.valueOf(i));
  }
  List<String> expected=Lists.newArrayList(messages);
  expected.remove(0);
  expected.add(0,JIRAService.TRIMMED_MESSAGE);
  Assert.assertEquals(expected,JIRAService.trimMessages(messages));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.ptest.execution.conf.TestTestConfiguration </h4><pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGettersSetters() throws Exception {
  ExecutionContextConfiguration execConf=ExecutionContextConfiguration.fromInputStream(Resources.getResource("test-configuration.properties").openStream());
  TestConfiguration conf=TestConfiguration.fromInputStream(Resources.getResource("test-configuration.properties").openStream(),LOG);
  Set<Host> expectedHosts=Sets.newHashSet(new Host("localhost","hiveptest",new String[]{"/home/hiveptest"},2));
  ExecutionContext executionContext=execConf.getExecutionContextProvider().createExecutionContext();
  Assert.assertEquals(expectedHosts,executionContext.getHosts());
  Assert.assertEquals("/tmp/hive-ptest-units/working/dir",execConf.getWorkingDirectory());
  Assert.assertEquals("/etc/hiveptest/conf",execConf.getProfileDirectory());
  Assert.assertEquals("/tmp/hive-ptest-units/working/dir/logs",execConf.getGlobalLogDirectory());
  Assert.assertEquals("/home/brock/.ssh/id_rsa",executionContext.getPrivateKey());
  Assert.assertEquals("git://github.com/apache/hive.git",conf.getRepository());
  Assert.assertEquals("apache-github",conf.getRepositoryName());
  Assert.assertEquals("trunk",conf.getBranch());
  Assert.assertEquals("/tmp/hive-ptest-units/working/dir/working",executionContext.getLocalWorkingDirectory());
  Assert.assertEquals("-Dtest.continue.on.failure=true -Dtest.silent=false",conf.getAntArgs());
  Assert.assertEquals("hadoop-1,hadoop-2",conf.getAdditionalProfiles());
  Assert.assertNotNull(conf.toString());
  Assert.assertEquals("",conf.getPatch());
  conf.setPatch("Patch");
  Assert.assertEquals("Patch",conf.getPatch());
  conf.setRepository("Repository");
  Assert.assertEquals("Repository",conf.getRepository());
  conf.setRepositoryName("RepositoryName");
  Assert.assertEquals("RepositoryName",conf.getRepositoryName());
  conf.setBranch("Branch");
  Assert.assertEquals("Branch",conf.getBranch());
  conf.setAntArgs("AntArgs");
  Assert.assertEquals("AntArgs",conf.getAntArgs());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testContext() throws Exception {
  Properties properties=new Properties();
  properties.load(Resources.getResource("test-configuration.properties").openStream());
  Context context=new Context(Maps.fromProperties(properties));
  Assert.assertEquals(context.getParameters(),(new TestConfiguration(context,LOG)).getContext().getParameters());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPTest() throws Exception {
  Host testHost=new Host("test","test",new String[1],1);
  Set<Host> testHosts=new HashSet<Host>();
  testHosts.add(testHost);
  TestConfiguration conf=TestConfiguration.fromInputStream(Resources.getResource("test-configuration.properties").openStream(),LOG);
  ExecutionContext execContext=new ExecutionContext(null,testHosts,"test",null);
  PTest.Builder mPTestBuilder=new PTest.Builder();
  PTest ptest=mPTestBuilder.build(conf,execContext,"1234",baseDir.newFolder(),null,null,null,null);
  Map<String,String> templateDefaults=ptest.getTemplateDefaults();
  Assert.assertEquals("git://github.com/apache/hive.git",templateDefaults.get("repository"));
  Assert.assertEquals("apache-github",templateDefaults.get("repositoryName"));
  Assert.assertEquals("trunk",templateDefaults.get("branch"));
  Assert.assertEquals("-Dtest.continue.on.failure=true -Dtest.silent=false",templateDefaults.get("antArgs"));
  Assert.assertEquals("hadoop-1,hadoop-2",templateDefaults.get("additionalProfiles"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.TestHS2ImpersonationWithRemoteMS </h4><pre class="type-11 type-12 type-3 type-4 type-5 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImpersonation() throws Exception {
  assertTrue("Test setup failed. MiniHS2 is not initialized",miniHS2 != null && miniHS2.isStarted());
  Class.forName(MiniHS2.getJdbcDriverName());
  Connection hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"foo",null);
  Statement stmt=hs2Conn.createStatement();
  String tableName="foo_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  hs2Conn=DriverManager.getConnection(miniHS2.getJdbcURL(),"bar",null);
  stmt=hs2Conn.createStatement();
  tableName="bar_table";
  stmt.execute("drop table if exists " + tableName);
  stmt.execute("create table " + tableName + " (value string)");
  stmt.close();
  hs2Conn.close();
  MiniDFSShim dfs=miniHS2.getDfs();
  FileSystem fs=dfs.getFileSystem();
  FileStatus[] files=fs.listStatus(miniHS2.getWareHouseDir());
  boolean fooTableValidated=false;
  boolean barTableValidated=false;
  for (  FileStatus file : files) {
    final String name=file.getPath().getName();
    final String owner=file.getOwner();
    if (name.equals("foo_table")) {
      fooTableValidated=owner.equals("foo");
      assertTrue(String.format("User 'foo' table has wrong ownership '%s'",owner),fooTableValidated);
    }
 else     if (name.equals("bar_table")) {
      barTableValidated=owner.equals("bar");
      assertTrue(String.format("User 'bar' table has wrong ownership '%s'",owner),barTableValidated);
    }
 else {
      fail(String.format("Unexpected table directory '%s' in warehouse",name));
    }
    System.out.println(String.format("File: %s, Owner: %s",name,owner));
  }
  assertTrue("User 'foo' table not found in warehouse",fooTableValidated);
  assertTrue("User 'bar' table not found in warehouse",barTableValidated);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.CLIServiceTest </h4><pre class="type-11 type-6 type-12 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGlobalCompileLockTimeout() throws Exception {
  String tableName="TEST_COMPILE_LOCK_TIMEOUT";
  String columnDefinitions="(ID STRING)";
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,new HashMap<String,String>());
  assertNotNull(sessionHandle);
  int THREAD_COUNT=3;
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=(FutureTask<Void>[])new FutureTask[THREAD_COUNT];
  long longPollingTimeoutMs=10 * 60 * 1000;
  Map<String,String> confOverlay=getConfOverlay(0,longPollingTimeoutMs);
  confOverlay.put(HiveConf.ConfVars.SEMANTIC_ANALYZER_HOOK.varname,CompileLockTestSleepHook.class.getName());
  String query="SELECT 0 FROM " + tableName;
  tasks[0]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[0]).start();
  Thread.sleep(5 * 1000);
  confOverlay=getConfOverlay(1,longPollingTimeoutMs);
  query="SELECT 1 FROM " + tableName;
  tasks[1]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.ERROR,false,null,null));
  new Thread(tasks[1]).start();
  confOverlay=getConfOverlay(100,longPollingTimeoutMs);
  query="SELECT 2 FROM " + tableName;
  tasks[2]=new FutureTask<Void>(createQueryCallable(query,confOverlay,longPollingTimeoutMs,1,OperationState.FINISHED,false,null,null));
  new Thread(tasks[2]).start();
  boolean foundExpectedException=false;
  for (int i=0; i < THREAD_COUNT; ++i) {
    try {
      tasks[i].get();
    }
 catch (    Throwable t) {
      if (i == 1) {
        assertTrue(t.getMessage().contains(ErrorMsg.COMPILE_LOCK_TIMED_OUT.getMsg()));
        foundExpectedException=true;
      }
 else {
        throw new RuntimeException(t);
      }
    }
  }
  assertTrue(foundExpectedException);
  client.executeStatement(sessionHandle,"DROP TABLE " + tableName,getConfOverlay(0,longPollingTimeoutMs));
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test async execution of a well-formed and a malformed query with different long polling durations
 * - Test malformed query with default long polling timeout
 * - Test well-formed query with default long polling timeout
 * - Test well-formed query with long polling timeout set to 0
 * - Test well-formed query with long polling timeout set to 500 millis
 * - Test well-formed query cancellation
 * @throws Exception
 */
@Test public void testExecuteStatementAsync() throws Exception {
  Map<String,String> confOverlay=new HashMap<String,String>();
  String tableName="TEST_EXEC_ASYNC";
  String columnDefinitions="(ID STRING)";
  String queryString;
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,confOverlay);
  assertNotNull(sessionHandle);
  OperationState state=null;
  OperationHandle opHandle;
  OperationStatus opStatus=null;
  queryString="SET " + HiveConf.ConfVars.HIVE_SUPPORT_CONCURRENCY.varname + " = false";
  opHandle=client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeOperation(opHandle);
  long longPollingTimeout;
  longPollingTimeout=HiveConf.getTimeVar(new HiveConf(),HiveConf.ConfVars.HIVE_SERVER2_LONG_POLLING_TIMEOUT,TimeUnit.MILLISECONDS);
  queryString="SELECT NON_EXISTING_COLUMN FROM " + tableName;
  try {
    runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.ERROR,longPollingTimeout);
  }
 catch (  HiveSQLException e) {
  }
  queryString="CREATE TABLE NON_EXISTING_TAB (ID STRING) location 'invalid://localhost:10000/a/b/c'";
  opStatus=runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.ERROR,longPollingTimeout);
  assertEquals(opStatus.getOperationException().getSQLState(),"08S01");
  assertEquals(opStatus.getOperationException().getErrorCode(),1);
  queryString="SELECT ID+1 FROM " + tableName;
  runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.FINISHED,longPollingTimeout);
  longPollingTimeout=0;
  queryString="SELECT ID+1 FROM " + tableName;
  runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.FINISHED,longPollingTimeout);
  longPollingTimeout=500;
  queryString="SELECT ID+1 FROM " + tableName;
  runAsyncAndWait(sessionHandle,queryString,confOverlay,OperationState.FINISHED,longPollingTimeout);
  queryString="SELECT ID+1 FROM " + tableName;
  opHandle=client.executeStatementAsync(sessionHandle,queryString,confOverlay);
  System.out.println("Cancelling " + opHandle);
  client.cancelOperation(opHandle);
  state=client.getOperationStatus(opHandle).getState();
  System.out.println(opHandle + " after cancelling, state= " + state);
  assertEquals("Query should be cancelled",OperationState.CANCELED,state);
  queryString="DROP TABLE " + tableName;
  client.executeStatement(sessionHandle,queryString,confOverlay);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void testExecuteStatementParallel() throws Exception {
  Map<String,String> confOverlay=new HashMap<String,String>();
  String tableName="TEST_EXEC_PARALLEL";
  String columnDefinitions="(ID STRING)";
  SessionHandle sessionHandle=setupTestData(tableName,columnDefinitions,confOverlay);
  assertNotNull(sessionHandle);
  long longPollingTimeout=HiveConf.getTimeVar(new HiveConf(),HiveConf.ConfVars.HIVE_SERVER2_LONG_POLLING_TIMEOUT,TimeUnit.MILLISECONDS);
  confOverlay.put(HiveConf.ConfVars.HIVE_SERVER2_LONG_POLLING_TIMEOUT.varname,longPollingTimeout + "ms");
  int THREAD_COUNT=10, QUERY_COUNT=10;
  ExecutorService executor=Executors.newFixedThreadPool(THREAD_COUNT);
  CountDownLatch cdlIn=new CountDownLatch(THREAD_COUNT), cdlOut=new CountDownLatch(1);
  @SuppressWarnings("unchecked") Callable<Void>[] cs=new Callable[3];
  String query="SELECT ID + %1$d FROM " + tableName;
  cs[0]=createQueryCallable(query,confOverlay,longPollingTimeout,QUERY_COUNT,OperationState.FINISHED,true,cdlIn,cdlOut);
  query="SELECT t1.ID, SUM(t2.ID) + %1$d FROM  " + tableName + " t1 CROSS JOIN "+ tableName+ " t2 GROUP BY t1.ID HAVING t1.ID > 1";
  cs[1]=createQueryCallable(query,confOverlay,longPollingTimeout,QUERY_COUNT,OperationState.FINISHED,true,cdlIn,cdlOut);
  query="SELECT b.a FROM (SELECT (t1.ID + %1$d) as a , t2.* FROM  " + tableName + " t1 INNER JOIN "+ tableName+ " t2 ON t1.ID = t2.ID WHERE t2.ID > 2) b";
  cs[2]=createQueryCallable(query,confOverlay,longPollingTimeout,QUERY_COUNT,OperationState.FINISHED,true,cdlIn,cdlOut);
  @SuppressWarnings("unchecked") FutureTask<Void>[] tasks=new FutureTask[THREAD_COUNT];
  for (int i=0; i < THREAD_COUNT; ++i) {
    tasks[i]=new FutureTask<Void>(cs[i % cs.length]);
    executor.execute(tasks[i]);
  }
  try {
    cdlIn.await();
    cdlOut.countDown();
    for (int i=0; i < THREAD_COUNT; ++i) {
      tasks[i].get();
    }
  }
 catch (  Throwable t) {
    throw new RuntimeException(t);
  }
  client.executeStatement(sessionHandle,"DROP TABLE " + tableName,confOverlay);
  client.closeSession(sessionHandle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.TestColumn </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllIntegerTypeValues(){
  Map<Type,List> integerTypesAndValues=new LinkedHashMap<Type,List>();
  integerTypesAndValues.put(Type.TINYINT_TYPE,Arrays.asList(Byte.MIN_VALUE,Byte.MAX_VALUE));
  integerTypesAndValues.put(Type.SMALLINT_TYPE,Arrays.asList(Short.MIN_VALUE,Short.MIN_VALUE));
  integerTypesAndValues.put(Type.INT_TYPE,Arrays.asList(Integer.MIN_VALUE,Integer.MAX_VALUE));
  integerTypesAndValues.put(Type.BIGINT_TYPE,Arrays.asList(Long.MIN_VALUE,Long.MAX_VALUE));
  for (  Map.Entry entry : integerTypesAndValues.entrySet()) {
    Type type=(Type)entry.getKey();
    List values=(List)entry.getValue();
    Column c=new Column(type);
    for (    Object v : values) {
      c.addValue(type,v);
    }
    assertEquals(type,c.getType());
    assertEquals(values.size(),c.size());
    for (int i=0; i < c.size(); i++) {
      assertEquals(values.get(i),c.get(i));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.TestHiveSQLException </h4><pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion between the exception text with the simple cause and the
 * Throwable object
 */
@Test public void testExceptionMarshalling() throws Exception {
  Exception ex1=createException();
  ex1.initCause(createSimpleCause());
  Throwable ex=HiveSQLException.toCause(HiveSQLException.toString(ex1));
  Assert.assertSame(RuntimeException.class,ex.getClass());
  Assert.assertEquals("exception1",ex.getMessage());
  Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
  Assert.assertEquals("exception2",ex.getCause().getMessage());
}

</code></pre>

<br>
<pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion between the exception text with nested cause and
 * the Throwable object
 */
@Test public void testNestedException(){
  Exception ex1=createException();
  ex1.initCause(createNestedCause());
  Throwable ex=HiveSQLException.toCause(HiveSQLException.toString(ex1));
  Assert.assertSame(RuntimeException.class,ex.getClass());
  Assert.assertEquals("exception1",ex.getMessage());
  Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
  Assert.assertEquals("exception2",ex.getCause().getMessage());
  Assert.assertSame(Exception.class,ex.getCause().getCause().getClass());
  Assert.assertEquals("exception3",ex.getCause().getCause().getMessage());
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the conversion from a HiveSQLException exception to the TStatus object
 */
@Test public void testHiveSQLExceptionToTStatus(){
  String expectedMessage="reason";
  String expectedSqlState="sqlState";
  int expectedVendorCode=10;
  Exception ex1=new HiveSQLException(expectedMessage,expectedSqlState,expectedVendorCode,createSimpleCause());
  TStatus status=HiveSQLException.toTStatus(ex1);
  Assert.assertEquals(TStatusCode.ERROR_STATUS,status.getStatusCode());
  Assert.assertEquals(expectedSqlState,status.getSqlState());
  Assert.assertEquals(expectedMessage,status.getErrorMessage());
  Assert.assertEquals(HiveSQLException.toString(ex1),status.getInfoMessages());
}

</code></pre>

<br>
<pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion of the exception from anonymous class
 */
@Test public void testExceptionFromAnonymousClass(){
  Dummy d=new Dummy(){
    public void testExceptionConversion(){
      Exception ex1=createException();
      ex1.initCause(createSimpleCause());
      Throwable ex=HiveSQLException.toCause(HiveSQLException.toString(ex1));
      Assert.assertSame(RuntimeException.class,ex.getClass());
      Assert.assertEquals("exception1",ex.getMessage());
      Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
      Assert.assertEquals("exception2",ex.getCause().getMessage());
    }
  }
;
  d.testExceptionConversion();
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the conversion from a regular exception to the TStatus object
 */
@Test public void testExceptionToTStatus(){
  Exception ex1=createException();
  ex1.initCause(createSimpleCause());
  TStatus status=HiveSQLException.toTStatus(ex1);
  Assert.assertEquals(TStatusCode.ERROR_STATUS,status.getStatusCode());
  Assert.assertEquals(ex1.getMessage(),status.getErrorMessage());
  Assert.assertEquals(HiveSQLException.toString(ex1),status.getInfoMessages());
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the conversion of the exception that the class type of one of the causes
 * doesn't exist. The stack trace text is generated on the server and passed to JDBC
 * client. It's possible that some cause types don't exist on the client and HiveSQLException
 * can't convert them and use RunTimeException instead.
 */
@Test public void testExceptionWithMissingTypeOnClient(){
  Exception ex1=new UnsupportedOperationException();
  ex1.initCause(createSimpleCause());
  List<String> details=HiveSQLException.toString(ex1);
  String[] tokens=details.get(0).split(":");
  tokens[0]="*DummyException";
  details.set(0,StringUtils.join(tokens,":"));
  Throwable ex=HiveSQLException.toCause(details);
  Assert.assertEquals(RuntimeException.class,ex.getClass());
}

</code></pre>

<br>
<pre class="type-11 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests the conversion of the exception with unknown source
 */
@Test public void testExceptionWithUnknownSource(){
  Exception ex1=createException();
  ex1.initCause(createSimpleCause());
  List<String> details=HiveSQLException.toString(ex1);
  String[] tokens=details.get(1).split(":");
  tokens[2]=null;
  tokens[3]="-1";
  details.set(1,StringUtils.join(tokens,":"));
  Throwable ex=HiveSQLException.toCause(details);
  Assert.assertSame(RuntimeException.class,ex.getClass());
  Assert.assertEquals("exception1",ex.getMessage());
  Assert.assertSame(UnsupportedOperationException.class,ex.getCause().getClass());
  Assert.assertEquals("exception2",ex.getCause().getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.TestOperationLoggingAPIWithMr </h4><pre class="type-11 type-6 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFetchResultsOfLogAsync() throws Exception {
  OperationHandle operationHandle=client.executeStatementAsync(sessionHandle,sql,null);
  boolean isQueryRunning=true;
  long pollTimeout=System.currentTimeMillis() + 100000;
  OperationStatus opStatus;
  OperationState state=null;
  RowSet rowSetAccumulated=null;
  StringBuilder logs=new StringBuilder();
  while (isQueryRunning) {
    if (System.currentTimeMillis() > pollTimeout) {
      break;
    }
    opStatus=client.getOperationStatus(operationHandle);
    Assert.assertNotNull(opStatus);
    state=opStatus.getState();
    rowSetAccumulated=client.fetchResults(operationHandle,FetchOrientation.FETCH_NEXT,2000,FetchType.LOG);
    for (    Object[] row : rowSetAccumulated) {
      logs.append(row[0]);
    }
    if (state == OperationState.CANCELED || state == OperationState.CLOSED || state == OperationState.FINISHED || state == OperationState.ERROR) {
      isQueryRunning=false;
    }
    Thread.sleep(10);
  }
  Assert.assertEquals("Query should be finished",OperationState.FINISHED,state);
  verifyFetchedLogPost(logs.toString(),expectedLogsVerbose,true);
  RowSet rowSet=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,2000,FetchType.LOG);
  verifyFetchedLog(rowSet,expectedLogsVerbose);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFetchResultsOfLogWithOrientation() throws Exception {
  OperationHandle operationHandle=client.executeStatement(sessionHandle,sql,null);
  RowSet rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  int expectedLogLength=rowSetLog.numRows();
  OperationHandle operationHandleWithOrientation=client.executeStatement(sessionHandle,sql,null);
  RowSet rowSetLogWithOrientation;
  int logLength=0;
  int maxRows=calculateProperMaxRows(expectedLogLength);
  do {
    rowSetLogWithOrientation=client.fetchResults(operationHandleWithOrientation,FetchOrientation.FETCH_NEXT,maxRows,FetchType.LOG);
    logLength+=rowSetLogWithOrientation.numRows();
  }
 while (rowSetLogWithOrientation.numRows() == maxRows);
  Assert.assertEquals(expectedLogLength,logLength);
  rowSetLogWithOrientation=client.fetchResults(operationHandleWithOrientation,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  verifyFetchedLog(rowSetLogWithOrientation,expectedLogsVerbose);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.operation.TestOperationLoggingLayout </h4><pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSwitchLogLayout() throws Exception {
  OperationHandle operationHandle=client.executeStatement(sessionHandle,sqlCntStar,null);
  RowSet rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,1000,FetchType.LOG);
  Iterator<Object[]> iter=rowSetLog.iterator();
  while (iter.hasNext()) {
    String row=iter.next()[0].toString();
    Assert.assertEquals(true,row.matches("^(FATAL|ERROR|WARN|INFO|DEBUG|TRACE).*$"));
  }
  String queryString="set hive.server2.logging.operation.level=verbose";
  client.executeStatement(sessionHandle,queryString,null);
  operationHandle=client.executeStatement(sessionHandle,sqlCntStar,null);
  rowSetLog=client.fetchResults(operationHandle,FetchOrientation.FETCH_FIRST,10,FetchType.LOG);
  iter=rowSetLog.iterator();
  while (iter.hasNext()) {
    String row=iter.next()[0].toString();
    Assert.assertEquals(true,row.matches("^\\d{2}[/](0[1-9]|1[012])[/](0[1-9]|[12][0-9]|3[01]).*$"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.cli.session.TestSessionGlobalInitFile </h4><pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSessionGlobalInitFile() throws Exception {
  File tmpInitFile=new File(initFile.getParent(),"hiverc");
  Assert.assertTrue("Failed to rename " + initFile + " to "+ tmpInitFile,initFile.renameTo(tmpInitFile));
  initFile=tmpInitFile;
  hiveConf.setVar(HiveConf.ConfVars.HIVE_SERVER2_GLOBAL_INIT_FILE_LOCATION,initFile.getAbsolutePath());
  doTestSessionGlobalInitFile();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.service.server.TestHS2HttpServer </h4><pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStackServket() throws Exception {
  String baseURL="http://localhost:" + ConfVars.HIVE_SERVER2_WEBUI_PORT.getDefaultValue() + "/stacks";
  URL url=new URL(baseURL);
  HttpURLConnection conn=(HttpURLConnection)url.openConnection();
  Assert.assertEquals(HttpURLConnection.HTTP_OK,conn.getResponseCode());
  BufferedReader reader=new BufferedReader(new InputStreamReader(conn.getInputStream()));
  boolean contents=false;
  String line;
  while ((line=reader.readLine()) != null) {
    if (line.contains("Process Thread Dump:")) {
      contents=true;
    }
  }
  Assert.assertTrue(contents);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.TestSparkClient </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddJarsAndFiles() throws Exception {
  runTest(true,new TestFunction(){
    @Override public void call(    SparkClient client) throws Exception {
      File jar=null;
      File file=null;
      try {
        jar=File.createTempFile("test",".jar");
        JarOutputStream jarFile=new JarOutputStream(new FileOutputStream(jar));
        jarFile.putNextEntry(new ZipEntry("test.resource"));
        jarFile.write("test resource".getBytes("UTF-8"));
        jarFile.closeEntry();
        jarFile.close();
        client.addJar(new URI("file:" + jar.getAbsolutePath())).get(TIMEOUT,TimeUnit.SECONDS);
        String result=client.submit(new JarJob()).get(TIMEOUT,TimeUnit.SECONDS);
        assertEquals("test resource",result);
        file=File.createTempFile("test",".file");
        FileOutputStream fileStream=new FileOutputStream(file);
        fileStream.write("test file".getBytes("UTF-8"));
        fileStream.close();
        client.addJar(new URI("file:" + file.getAbsolutePath())).get(TIMEOUT,TimeUnit.SECONDS);
        result=client.submit(new FileJob(file.getName())).get(TIMEOUT,TimeUnit.SECONDS);
        assertEquals("test file",result);
      }
  finally {
        if (jar != null) {
          jar.delete();
        }
        if (file != null) {
          file.delete();
        }
      }
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.rpc.TestKryoMessageCodec </h4><pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryptDecrypt() throws Exception {
  List objects=encodeAndDecode(MESSAGE,new TestEncryptionHandler(true,true));
  assertEquals(1,objects.size());
  assertEquals(MESSAGE,objects.get(0));
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testEncryptionOnly() throws Exception {
  List objects=Collections.emptyList();
  try {
    objects=encodeAndDecode(MESSAGE,new TestEncryptionHandler(true,false));
  }
 catch (  Exception e) {
  }
  for (  Object msg : objects) {
    assertFalse(MESSAGE.equals(objects.get(0)));
  }
}

</code></pre>

<br>
<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDecryptionOnly() throws Exception {
  List objects=Collections.emptyList();
  try {
    objects=encodeAndDecode(MESSAGE,new TestEncryptionHandler(false,true));
  }
 catch (  Exception e) {
  }
  for (  Object msg : objects) {
    assertFalse(MESSAGE.equals(objects.get(0)));
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKryoCodec() throws Exception {
  List objects=encodeAndDecode(MESSAGE,null);
  assertEquals(1,objects.size());
  assertEquals(MESSAGE,objects.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.hive.spark.client.rpc.TestRpc </h4><pre class="type-11 type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientServer() throws Exception {
  RpcServer server=autoClose(new RpcServer(emptyConfig));
  Rpc[] rpcs=createRpcConnection(server);
  Rpc serverRpc=rpcs[0];
  Rpc client=rpcs[1];
  TestMessage outbound=new TestMessage("Hello World!");
  Future<TestMessage> call=client.call(outbound,TestMessage.class);
  TestMessage reply=call.get(10,TimeUnit.SECONDS);
  assertEquals(outbound.message,reply.message);
  TestMessage another=new TestMessage("Hello again!");
  Future<TestMessage> anotherCall=client.call(another,TestMessage.class);
  TestMessage anotherReply=anotherCall.get(10,TimeUnit.SECONDS);
  assertEquals(another.message,anotherReply.message);
  String errorMsg="This is an error.";
  try {
    client.call(new ErrorCall(errorMsg)).get(10,TimeUnit.SECONDS);
  }
 catch (  ExecutionException ee) {
    assertTrue(ee.getCause() instanceof RpcException);
    assertTrue(ee.getCause().getMessage().indexOf(errorMsg) >= 0);
  }
  TestMessage serverMsg=new TestMessage("Hello from the server!");
  Future<TestMessage> serverCall=serverRpc.call(serverMsg,TestMessage.class);
  TestMessage serverReply=serverCall.get(10,TimeUnit.SECONDS);
  assertEquals(serverMsg.message,serverReply.message);
}

</code></pre>

<br>
<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncryption() throws Exception {
  Map<String,String> eConf=ImmutableMap.<String,String>builder().putAll(emptyConfig).put(RpcConfiguration.RPC_SASL_OPT_PREFIX + "qop",Rpc.SASL_AUTH_CONF).build();
  RpcServer server=autoClose(new RpcServer(eConf));
  Rpc[] rpcs=createRpcConnection(server,eConf);
  Rpc client=rpcs[1];
  TestMessage outbound=new TestMessage("Hello World!");
  Future<TestMessage> call=client.call(outbound,TestMessage.class);
  TestMessage reply=call.get(10,TimeUnit.SECONDS);
  assertEquals(outbound.message,reply.message);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestBitFieldReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testBiggerItems() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  final int COUNT=16384;
  BitFieldWriter out=new BitFieldWriter(new OutStream("test",500,null,collect),3);
  for (int i=0; i < COUNT; ++i) {
    if (i < COUNT / 2) {
      out.write(i & 7);
    }
 else {
      out.write((i / 3) & 7);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  BitFieldReader in=new BitFieldReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,500),3);
  for (int i=0; i < COUNT; ++i) {
    int x=in.next();
    if (i < COUNT / 2) {
      assertEquals(i & 7,x);
    }
 else {
      assertEquals((i / 3) & 7,x);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  BitFieldWriter out=new BitFieldWriter(new OutStream("test",100,null,collect),1);
  final int COUNT=16384;
  for (int i=0; i < COUNT; ++i) {
    if (i < COUNT / 2) {
      out.write(i & 1);
    }
 else {
      out.write((i / 3) & 1);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  BitFieldReader in=new BitFieldReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),1);
  for (int i=0; i < COUNT; i+=5) {
    int x=(int)in.next();
    if (i < COUNT / 2) {
      assertEquals(i & 1,x);
    }
 else {
      assertEquals((i / 3) & 1,x);
    }
    if (i < COUNT - 5) {
      in.skip(4);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestInStream </h4><pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testUncompressed() throws Exception {
  OutputCollector collect=new OutputCollector();
  OutStream out=new OutStream("test",100,null,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    out.write(i);
  }
  out.flush();
  assertEquals(1024,collect.buffer.size());
  for (int i=0; i < 1024; ++i) {
    assertEquals((byte)i,collect.buffer.get(i));
  }
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  InStream in=InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100);
  assertEquals("uncompressed stream test position: 0 length: 1024" + " range: 0 offset: 0 limit: 0",in.toString());
  for (int i=0; i < 1024; ++i) {
    int x=in.read();
    assertEquals(i & 0xff,x);
  }
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i & 0xff,in.read());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCompressed() throws Exception {
  OutputCollector collect=new OutputCollector();
  CompressionCodec codec=new ZlibCodec();
  OutStream out=new OutStream("test",300,codec,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    out.write(i);
  }
  out.flush();
  assertEquals("test",out.toString());
  assertEquals(961,collect.buffer.size());
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  InStream in=InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,300);
  assertEquals("compressed stream test position: 0 length: 961 range: 0" + " offset: 0 limit: 0 range 0 = 0 to 961",in.toString());
  for (int i=0; i < 1024; ++i) {
    int x=in.read();
    assertEquals(i & 0xff,x);
  }
  assertEquals(0,in.available());
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i & 0xff,in.read());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUncompressedDisjointBuffers() throws Exception {
  OutputCollector collect=new OutputCollector();
  OutStream out=new OutStream("test",400,null,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  DataOutput stream=new DataOutputStream(out);
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    stream.writeInt(i);
  }
  out.flush();
  assertEquals("test",out.toString());
  assertEquals(4096,collect.buffer.size());
  ByteBuffer[] inBuf=new ByteBuffer[3];
  inBuf[0]=ByteBuffer.allocate(1100);
  inBuf[1]=ByteBuffer.allocate(2200);
  inBuf[2]=ByteBuffer.allocate(1100);
  collect.buffer.setByteBuffer(inBuf[0],0,1024);
  collect.buffer.setByteBuffer(inBuf[1],1024,2048);
  collect.buffer.setByteBuffer(inBuf[2],3072,1024);
  for (int i=0; i < inBuf.length; ++i) {
    inBuf[i].flip();
  }
  InStream in=InStream.create("test",inBuf,new long[]{0,1024,3072},4096,null,400);
  assertEquals("uncompressed stream test position: 0 length: 4096" + " range: 0 offset: 0 limit: 0",in.toString());
  DataInputStream inStream=new DataInputStream(in);
  for (int i=0; i < 1024; ++i) {
    int x=inStream.readInt();
    assertEquals(i,x);
  }
  assertEquals(0,in.available());
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[1],inBuf[2]},new long[]{1024,3072},4096,null,400);
  inStream=new DataInputStream(in);
  positions[256].reset();
  in.seek(positions[256]);
  for (int i=256; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[0],inBuf[2]},new long[]{0,3072},4096,null,400);
  inStream=new DataInputStream(in);
  positions[768].reset();
  for (int i=0; i < 256; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in.seek(positions[768]);
  for (int i=768; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDisjointBuffers() throws Exception {
  OutputCollector collect=new OutputCollector();
  CompressionCodec codec=new ZlibCodec();
  OutStream out=new OutStream("test",400,codec,collect);
  PositionCollector[] positions=new PositionCollector[1024];
  DataOutput stream=new DataOutputStream(out);
  for (int i=0; i < 1024; ++i) {
    positions[i]=new PositionCollector();
    out.getPosition(positions[i]);
    stream.writeInt(i);
  }
  out.flush();
  assertEquals("test",out.toString());
  assertEquals(1674,collect.buffer.size());
  ByteBuffer[] inBuf=new ByteBuffer[3];
  inBuf[0]=ByteBuffer.allocate(500);
  inBuf[1]=ByteBuffer.allocate(1200);
  inBuf[2]=ByteBuffer.allocate(500);
  collect.buffer.setByteBuffer(inBuf[0],0,483);
  collect.buffer.setByteBuffer(inBuf[1],483,1625 - 483);
  collect.buffer.setByteBuffer(inBuf[2],1625,1674 - 1625);
  for (int i=0; i < inBuf.length; ++i) {
    inBuf[i].flip();
  }
  InStream in=InStream.create("test",inBuf,new long[]{0,483,1625},1674,codec,400);
  assertEquals("compressed stream test position: 0 length: 1674 range: 0" + " offset: 0 limit: 0 range 0 = 0 to 483;" + "  range 1 = 483 to 1142;  range 2 = 1625 to 49",in.toString());
  DataInputStream inStream=new DataInputStream(in);
  for (int i=0; i < 1024; ++i) {
    int x=inStream.readInt();
    assertEquals(i,x);
  }
  assertEquals(0,in.available());
  for (int i=1023; i >= 0; --i) {
    in.seek(positions[i]);
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[1],inBuf[2]},new long[]{483,1625},1674,codec,400);
  inStream=new DataInputStream(in);
  positions[303].reset();
  in.seek(positions[303]);
  for (int i=303; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in=InStream.create("test",new ByteBuffer[]{inBuf[0],inBuf[2]},new long[]{0,1625},1674,codec,400);
  inStream=new DataInputStream(in);
  positions[1001].reset();
  for (int i=0; i < 300; ++i) {
    assertEquals(i,inStream.readInt());
  }
  in.seek(positions[1001]);
  for (int i=1001; i < 1024; ++i) {
    assertEquals(i,inStream.readInt());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestIntegerCompressionReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthIntegerWriterV2 out=new RunLengthIntegerWriterV2(new OutStream("test",100,null,collect),true);
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write(i);
    }
 else {
      out.write(256 * i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthIntegerReaderV2 in=new RunLengthIntegerReaderV2(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),true,false);
  for (int i=0; i < 2048; i+=10) {
    int x=(int)in.next();
    if (i < 1024) {
      assertEquals(i,x);
    }
 else {
      assertEquals(256 * i,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestRunLengthByteReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",100,null,collect));
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write((byte)(i / 16));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100));
  for (int i=0; i < 2048; i+=10) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 16) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testUncompressedSeek() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",100,null,collect));
  TestInStream.PositionCollector[] positions=new TestInStream.PositionCollector[2048];
  for (int i=0; i < 2048; ++i) {
    positions[i]=new TestInStream.PositionCollector();
    out.getPosition(positions[i]);
    if (i < 1024) {
      out.write((byte)(i / 4));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100));
  for (int i=0; i < 2048; ++i) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
  for (int i=2047; i >= 0; --i) {
    in.seek(positions[i]);
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCompressedSeek() throws Exception {
  CompressionCodec codec=new SnappyCodec();
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthByteWriter out=new RunLengthByteWriter(new OutStream("test",500,codec,collect));
  TestInStream.PositionCollector[] positions=new TestInStream.PositionCollector[2048];
  for (int i=0; i < 2048; ++i) {
    positions[i]=new TestInStream.PositionCollector();
    out.getPosition(positions[i]);
    if (i < 1024) {
      out.write((byte)(i / 4));
    }
 else {
      out.write((byte)i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthByteReader in=new RunLengthByteReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),codec,500));
  for (int i=0; i < 2048; ++i) {
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
  for (int i=2047; i >= 0; --i) {
    in.seek(positions[i]);
    int x=in.next() & 0xff;
    if (i < 1024) {
      assertEquals((i / 4) & 0xff,x);
    }
 else {
      assertEquals(i & 0xff,x);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestRunLengthIntegerReader </h4><pre class="type-11 type-6 type-12 type-5 type-7 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSkips() throws Exception {
  TestInStream.OutputCollector collect=new TestInStream.OutputCollector();
  RunLengthIntegerWriter out=new RunLengthIntegerWriter(new OutStream("test",100,null,collect),true);
  for (int i=0; i < 2048; ++i) {
    if (i < 1024) {
      out.write(i);
    }
 else {
      out.write(256 * i);
    }
  }
  out.flush();
  ByteBuffer inBuf=ByteBuffer.allocate(collect.buffer.size());
  collect.buffer.setByteBuffer(inBuf,0,collect.buffer.size());
  inBuf.flip();
  RunLengthIntegerReader in=new RunLengthIntegerReader(InStream.create("test",new ByteBuffer[]{inBuf},new long[]{0},inBuf.remaining(),null,100),true);
  for (int i=0; i < 2048; i+=10) {
    int x=(int)in.next();
    if (i < 1024) {
      assertEquals(i,x);
    }
 else {
      assertEquals(256 * i,x);
    }
    if (i < 2038) {
      in.skip(9);
    }
    in.skip(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.orc.impl.TestSerializationUtils </h4><pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubles() throws Exception {
  double tolerance=0.0000000000000001;
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  SerializationUtils utils=new SerializationUtils();
  utils.writeDouble(buffer,1343822337.759);
  assertEquals(1343822337.759,utils.readDouble(fromBuffer(buffer)),tolerance);
  buffer=new ByteArrayOutputStream();
  utils.writeDouble(buffer,0.8);
  double got=utils.readDouble(fromBuffer(buffer));
  assertEquals(0.8,got,tolerance);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
