<h3 style="margin:0px">Class: org.apache.hadoop.hive.accumulo.serde.TestAccumuloSerDe (15 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(4)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void withRowID() throws SerDeException {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf:f1,:rowID,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"field1,field2,field3,field4");
  serde.initialize(conf,properties);
  assertNotNull(serde.getCachedRow());
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setup(){
  serde=new AccumuloSerDe();
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TooManyAccumuloColumnsException.class) public void deserializeWithTooFewHiveColumns() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,col1,col2");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,string,string");
  serde.initialize(conf,properties);
  serde.deserialize(new Text("fail"));
}

</code></pre>

<pre class="type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompositeKeyDeserialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,field1");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"struct<col1:string,col2:string,col3:string>,string");
  properties.setProperty(DelimitedAccumuloRowIdFactory.ACCUMULO_COMPOSITE_DELIMITER,"_");
  properties.setProperty(AccumuloSerDeParameters.COMPOSITE_ROWID_FACTORY,DelimitedAccumuloRowIdFactory.class.getName());
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("p1_p2_p3");
  row.add("cf","f1","v1".getBytes());
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyStruct);
  LazyStruct struct=(LazyStruct)field0;
  List fields=struct.getFieldsAsList();
  assertEquals(3,fields.size());
  for (int i=0; i < fields.size(); i++) {
    assertEquals(LazyString.class,fields.get(i).getClass());
    assertEquals("p" + (i + 1),fields.get(i).toString());
  }
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue("Expected instance of LazyString but was " + field1.getClass(),field1 instanceof LazyString);
  assertEquals(field1.toString(),"v1");
}

</code></pre>

<pre class="type-4 type-5 type-1 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=InvalidColumnMappingException.class) public void invalidColMapping() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"field2,field3,field4");
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  lazyRow.getField(0);
}

</code></pre>

<pre class="type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void simpleColumnMapping() throws SerDeException {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,field1,field2,field3");
  serde.initialize(conf,properties);
  assertNotNull(serde.getCachedRow());
}

</code></pre>

<pre class="type-11 type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStructOfMapSerialization() throws IOException, SerDeException {
  List<String> columns=Arrays.asList("row","col");
  List<String> structColNames=Arrays.asList("map1","map2");
  TypeInfo mapTypeInfo=TypeInfoFactory.getMapTypeInfo(TypeInfoFactory.stringTypeInfo,TypeInfoFactory.stringTypeInfo);
  List<TypeInfo> types=Arrays.<TypeInfo>asList(TypeInfoFactory.getStructTypeInfo(structColNames,Arrays.asList(mapTypeInfo,mapTypeInfo)),TypeInfoFactory.stringTypeInfo);
  Properties tableProperties=new Properties();
  tableProperties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowid,cf:cq");
  tableProperties.setProperty(serdeConstants.LIST_COLUMNS,Joiner.on(',').join(columns));
  tableProperties.setProperty(serdeConstants.LIST_COLUMN_TYPES,Joiner.on(',').join(types));
  AccumuloSerDeParameters accumuloSerDeParams=new AccumuloSerDeParameters(new Configuration(),tableProperties,AccumuloSerDe.class.getSimpleName());
  LazySerDeParameters serDeParams=accumuloSerDeParams.getSerDeParameters();
  byte[] seps=serDeParams.getSeparators();
  TypeInfo stringTypeInfo=TypeInfoFactory.getPrimitiveTypeInfo(serdeConstants.STRING_TYPE_NAME);
  LazyStringObjectInspector stringOI=(LazyStringObjectInspector)LazyFactory.createLazyObjectInspector(stringTypeInfo,new byte[]{0},0,serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazyMapObjectInspector mapOI=LazyObjectInspectorFactory.getLazySimpleMapObjectInspector(stringOI,stringOI,seps[3],seps[4],serDeParams.getNullSequence(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector rowStructOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(structColNames,Arrays.<ObjectInspector>asList(mapOI,mapOI),(byte)seps[2],serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  LazySimpleStructObjectInspector structOI=(LazySimpleStructObjectInspector)LazyObjectInspectorFactory.getLazySimpleStructObjectInspector(columns,Arrays.asList(rowStructOI,stringOI),seps[1],serDeParams.getNullSequence(),serDeParams.isLastColumnTakesRest(),serDeParams.isEscaped(),serDeParams.getEscapeChar());
  AccumuloRowSerializer serializer=new AccumuloRowSerializer(0,serDeParams,accumuloSerDeParams.getColumnMappings(),new ColumnVisibility(),accumuloSerDeParams.getRowIdFactory());
  Map<String,String> map1=new HashMap<String,String>(), map2=new HashMap<String,String>();
  map1.put("key10","value10");
  map1.put("key11","value11");
  map2.put("key20","value20");
  map2.put("key21","value21");
  ByteArrayRef byteRef=new ByteArrayRef();
  String accumuloRow="key10\5value10\4key11\5value11\3key20\5value20\4key21\5value21";
  LazyStruct entireStruct=(LazyStruct)LazyFactory.createLazyObject(structOI);
  byteRef.setData((accumuloRow + "\2foo").getBytes());
  entireStruct.init(byteRef,0,byteRef.getData().length);
  Mutation m=serializer.serialize(entireStruct,structOI);
  Assert.assertArrayEquals(accumuloRow.getBytes(),m.getRow());
  Assert.assertEquals(1,m.getUpdates().size());
  ColumnUpdate update=m.getUpdates().get(0);
  Assert.assertEquals("cf",new String(update.getColumnFamily()));
  Assert.assertEquals("cq",new String(update.getColumnQualifier()));
  Assert.assertEquals("foo",new String(update.getValue()));
  AccumuloHiveRow haRow=new AccumuloHiveRow(new String(m.getRow()));
  haRow.add("cf","cq","foo".getBytes());
  LazyAccumuloRow lazyAccumuloRow=new LazyAccumuloRow(structOI);
  lazyAccumuloRow.init(haRow,accumuloSerDeParams.getColumnMappings(),accumuloSerDeParams.getRowIdFactory());
  List objects=lazyAccumuloRow.getFieldsAsList();
  Assert.assertEquals(2,objects.size());
  Assert.assertEquals("foo",objects.get(1).toString());
  LazyStruct rowStruct=(LazyStruct)objects.get(0);
  List rowObjects=rowStruct.getFieldsAsList();
  Assert.assertEquals(2,rowObjects.size());
  LazyMap rowMap=(LazyMap)rowObjects.get(0);
  Map<?,?> actualMap=rowMap.getMap();
  System.out.println("Actual map 1: " + actualMap);
  Map<String,String> actualStringMap=new HashMap<String,String>();
  for (  Entry<?,?> entry : actualMap.entrySet()) {
    actualStringMap.put(entry.getKey().toString(),entry.getValue().toString());
  }
  Assert.assertEquals(map1,actualStringMap);
  rowMap=(LazyMap)rowObjects.get(1);
  actualMap=rowMap.getMap();
  System.out.println("Actual map 2: " + actualMap);
  actualStringMap=new HashMap<String,String>();
  for (  Entry<?,?> entry : actualMap.entrySet()) {
    actualStringMap.put(entry.getKey().toString(),entry.getValue().toString());
  }
  Assert.assertEquals(map2,actualStringMap);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoVisibilitySetsEmptyVisibility() throws SerDeException {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf:f1,:rowID");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"field1,field2");
  serde.initialize(conf,properties);
  AccumuloRowSerializer serializer=serde.getSerializer();
  Assert.assertEquals(new ColumnVisibility(),serializer.getVisibility());
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=NullPointerException.class) public void emptyConfiguration() throws SerDeException {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  serde.initialize(conf,properties);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testColumnVisibilityForSerializer() throws SerDeException {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,"cf:f1,:rowID");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"field1,field2");
  properties.setProperty(AccumuloSerDeParameters.VISIBILITY_LABEL_KEY,"foobar");
  serde.initialize(conf,properties);
  AccumuloRowSerializer serializer=serde.getSerializer();
  Assert.assertEquals(new ColumnVisibility("foobar"),serializer.getVisibility());
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TooManyHiveColumnsException.class) public void moreHiveColumnsThanAccumuloColumns() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,field1,field2,field3,field4");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,string,string,string,string");
  serde.initialize(conf,properties);
  serde.deserialize(new Text("fail"));
}

</code></pre>

<pre class="type-11 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapSerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,map<string,string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  properties.setProperty(serdeConstants.MAPKEY_DELIM,"=");
  char collectionSeparator=':', kvSeparator='=';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("k1" + kvSeparator + "v1"+ collectionSeparator+ "k2"+ kvSeparator+ "v2"+ collectionSeparator+ "k3"+ kvSeparator+ "v3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyMap);
  LazyMap map=(LazyMap)field1;
  Map<Object,Object> untypedMap=map.getMap();
  assertEquals(3,map.getMapSize());
  Set<String> expectedKeys=new HashSet<String>();
  expectedKeys.add("k1");
  expectedKeys.add("k2");
  expectedKeys.add("k3");
  for (  Entry<Object,Object> entry : untypedMap.entrySet()) {
    assertNotNull(entry.getKey());
    assertTrue(entry.getKey() instanceof LazyString);
    LazyString key=(LazyString)entry.getKey();
    assertNotNull(entry.getValue());
    assertTrue(entry.getValue() instanceof LazyString);
    LazyString value=(LazyString)entry.getValue();
    String strKey=key.getWritableObject().toString(), strValue=value.getWritableObject().toString();
    assertTrue(expectedKeys.remove(strKey));
    assertEquals(2,strValue.length());
    assertTrue(strValue.startsWith("v"));
    assertTrue(strValue.endsWith(Character.toString(strKey.charAt(1))));
  }
  assertTrue("Did not find expected keys: " + expectedKeys,expectedKeys.isEmpty());
}

</code></pre>

<pre class="type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deserialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"blah,field2,field3,field4");
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","f1","v1".getBytes());
  row.add("cf","f2","v2".getBytes());
  Object obj=serde.deserialize(row);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(field0.toString(),"r1");
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue("Expected instance of LazyString but was " + field1.getClass(),field1 instanceof LazyString);
  assertEquals(field1.toString(),"v1");
  Object field2=lazyRow.getField(2);
  assertNotNull(field2);
  assertTrue(field2 instanceof LazyString);
  assertEquals(field2.toString(),"v2");
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=TooManyAccumuloColumnsException.class) public void moreAccumuloColumnsThanHiveColumns() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:f1,cf:f2,cf:f3");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,field1,field2");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,string,string");
  serde.initialize(conf,properties);
  serde.deserialize(new Text("fail"));
}

</code></pre>

<pre class="type-11 type-6 type-4 type-5 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArraySerialization() throws Exception {
  Properties properties=new Properties();
  Configuration conf=new Configuration();
  properties.setProperty(AccumuloSerDeParameters.COLUMN_MAPPINGS,":rowID,cf:vals");
  properties.setProperty(serdeConstants.LIST_COLUMNS,"row,values");
  properties.setProperty(serdeConstants.LIST_COLUMN_TYPES,"string,array<string>");
  properties.setProperty(serdeConstants.COLLECTION_DELIM,":");
  char separator=':';
  serde.initialize(conf,properties);
  AccumuloHiveRow row=new AccumuloHiveRow();
  row.setRowId("r1");
  row.add("cf","vals",("value1" + separator + "value2"+ separator+ "value3").getBytes());
  Object obj=serde.deserialize(row);
  assertNotNull(obj);
  assertTrue(obj instanceof LazyAccumuloRow);
  LazyAccumuloRow lazyRow=(LazyAccumuloRow)obj;
  Object field0=lazyRow.getField(0);
  assertNotNull(field0);
  assertTrue(field0 instanceof LazyString);
  assertEquals(row.getRowId(),((LazyString)field0).getWritableObject().toString());
  Object field1=lazyRow.getField(1);
  assertNotNull(field1);
  assertTrue(field1 instanceof LazyArray);
  LazyArray array=(LazyArray)field1;
  List values=array.getList();
  assertEquals(3,values.size());
  for (int i=0; i < 3; i++) {
    Object o=values.get(i);
    assertNotNull(o);
    assertTrue(o instanceof LazyString);
    assertEquals("value" + (i + 1),((LazyString)o).getWritableObject().toString());
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
