<h3 style="margin:0px">Class: org.apache.hive.jdbc.cbo_rp_TestJdbcDriver2 (66 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(37)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(37)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(32)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(30)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(20)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="16"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('16')" data-toggle="tooltip" title="Verifies values related to public fields."><kbd id="tag-16"class="label-info"style="display: inline-block;font-size:7pt" >PublicFieldVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="19"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('19')" data-toggle="tooltip" title="Invokes logging operations"><kbd id="tag-19"class="label-info"style="display: inline-block;font-size:7pt" >Logger&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowColumns() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show columns in " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<pre class="type-11 type-6 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log method in Jdbc
 * @throws Exception
 */
@Test public void testGetQueryLog() throws Exception {
  String[] expectedLogs={"Compiling command","Completed compiling command","Starting Semantic Analysis","Semantic Analysis Completed","Executing command","Completed executing command"};
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10000);
  stmt.close();
  verifyFetchedLog(logs,expectedLogs);
  final HiveStatement statement=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",statement);
  statement.setFetchSize(10000);
  final List<String> incrementalLogs=new ArrayList<String>();
  Runnable logThread=new Runnable(){
    @Override public void run(){
      while (statement.hasMoreLogs()) {
        try {
          incrementalLogs.addAll(statement.getQueryLog());
          Thread.sleep(500);
        }
 catch (        SQLException e) {
          LOG.error("Failed getQueryLog. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
catch (        InterruptedException e) {
          LOG.error("Getting log thread is interrupted. Error message: " + e.getMessage());
          fail("error in getting log thread");
        }
      }
    }
  }
;
  Thread thread=new Thread(logThread);
  thread.setDaemon(true);
  thread.start();
  statement.executeQuery(sql);
  thread.interrupt();
  thread.join(10000);
  List<String> remainingLogs;
  do {
    remainingLogs=statement.getQueryLog();
    incrementalLogs.addAll(remainingLogs);
  }
 while (remainingLogs.size() > 0);
  statement.close();
  verifyFetchedLog(incrementalLogs,expectedLogs);
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting using builtin UDFs
 * @throws SQLException
 */
@Test public void testBuiltInUDFCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c12, bin(c12) from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(2),"_c1");
  assertTrue(res.next());
  assertEquals(res.getLong(1),1);
  assertEquals(res.getString(2),"1");
  res.close();
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowRoleGrant() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.execute("drop role role1");
  }
 catch (  Exception ex) {
    LOG.warn("Ignoring error during drop role: " + ex);
  }
  stmt.execute("create role role1");
  stmt.execute("grant role role1 to user hive_test_user");
  stmt.execute("show role grant user hive_test_user");
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("public",res.getString(1));
  assertTrue(res.next());
  assertEquals("role1",res.getString(1));
  res.close();
}

</code></pre>

<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getProcedureColumns()
 * @throws SQLException
 */
@Test public void testProcCols() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedureColumns(null,null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),20);
  assertFalse(res.next());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the cursor repositioning to start of resultset from non-mr query
 * @throws Exception
 */
@Test public void testFetchFirstNonMR() throws Exception {
  execFetchFirst("select * from " + dataTypeTableName,dataTypeTableName.toLowerCase() + "." + "c4",false);
}

</code></pre>

<pre class="type-11 type-3 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareStatement(){
  String sql="FROM (SELECT 1 FROM " + tableName + " where   'not?param?not?param' <> 'not_param??not_param' and ?=? "+ " and 1=? and 2=? and 3.0=? and 4.0=? and 'test\\'string\"'=? and 5=? and ?=? "+ " and date '2012-01-01' = date ?"+ " and timestamp '2012-04-22 09:00:00.123456789' = timestamp ?"+ " ) t SELECT '2011-03-25' ddate,'China',true bv, 10 num LIMIT 1";
  try {
    try (PreparedStatement ps=createPreapredStatementUsingSetXXX(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
     try (PreparedStatement ps=createPreapredStatementUsingSetObject(sql);ResultSet res=ps.executeQuery()){
      assertPreparedStatementResultAsExpected(res);
    }
   }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
  Exception expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql);ResultSet ignored=ps.executeQuery()){
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the un-setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setBoolean(1,true);
    ps.setBoolean(2,true);
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setString(1,"wrong");
    try (ResultSet res=ps.executeQuery()){
      assertFalse("ResultSet was not empty",res.next());
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Execute the invalid setted sql statement should throw exception",expectedException);
  expectedException=null;
  try (PreparedStatement ps=con.prepareStatement(sql)){
    ps.setObject(1,new Date());
    try (ResultSet ignored=ps.executeQuery()){
    }
   }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("Setting to an unknown type should throw an exception",expectedException);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testParseUrlHttpMode() throws SQLException, JdbcUriParseException, ZooKeeperHiveClientException {
  new HiveDriver();
  for (  String[] testValues : HTTP_URL_PROPERTIES) {
    JdbcConnectionParams params=Utils.parseURL(testValues[0],new Properties());
    assertEquals(params.getHost(),testValues[1]);
    assertEquals(params.getPort(),Integer.parseInt(testValues[2]));
    assertEquals(params.getDbName(),testValues[3]);
    assertEquals(params.getSessionVars().get("transportMode"),testValues[4]);
    assertEquals(params.getSessionVars().get("httpPath"),testValues[5]);
  }
}

</code></pre>

<pre class="type-11 type-10 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Allocates resources before the execution of the test cases
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void setUp() throws Exception {
  con=getConnection("default");
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("set hive.cbo.returnpath.hiveop = true");
  try {
    stmt.execute("drop table " + tableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + tableName + " (under_col int comment 'the under column', value string) comment '"+ tableComment+ "'");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ tableName);
  try {
    stmt.execute("drop table " + partitionedTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + partitionedTableName + " (under_col int, value string) comment '"+ partitionedTableComment+ "' partitioned by ("+ partitionedColumnName+ " STRING)");
  stmt.execute("load data local inpath '" + dataFilePath.toString() + "' into table "+ partitionedTableName+ " PARTITION ("+ partitionedColumnName+ "="+ partitionedColumnValue+ ")");
  try {
    stmt.execute("drop table " + dataTypeTableName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create table " + dataTypeTableName + " (c1 int, c2 boolean, c3 double, c4 string,"+ " c5 array<int>, c6 map<int,string>, c7 map<string,string>,"+ " c8 struct<r:string,s:int,t:double>,"+ " c9 tinyint, c10 smallint, c11 float, c12 bigint,"+ " c13 array<array<string>>,"+ " c14 map<int, map<int,int>>,"+ " c15 struct<r:int,s:struct<a:int,b:string>>,"+ " c16 array<struct<m:map<string,string>,n:int>>,"+ " c17 timestamp, "+ " c18 decimal(16,7), "+ " c19 binary, "+ " c20 date,"+ " c21 varchar(20),"+ " c22 char(15),"+ " c23 binary"+ ") comment'"+ dataTypeTableComment+ "' partitioned by (dt STRING)");
  stmt.execute("load data local inpath '" + dataTypeDataFilePath.toString() + "' into table "+ dataTypeTableName+ " PARTITION (dt='20090619')");
  try {
    stmt.execute("drop view " + viewName);
  }
 catch (  Exception ex) {
    fail(ex.toString());
  }
  stmt.execute("create view " + viewName + " comment '"+ viewComment+ "' as select * from "+ tableName);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDriverProperties() throws SQLException {
  HiveDriver driver=new HiveDriver();
  for (  String[] testValues : URL_PROPERTIES) {
    DriverPropertyInfo[] dpi=driver.getPropertyInfo(testValues[0],null);
    assertEquals("unexpected DriverPropertyInfo array size",3,dpi.length);
    assertDpi(dpi[0],"HOST",testValues[1]);
    assertDpi(dpi[1],"PORT",testValues[2]);
    assertDpi(dpi[2],"DBNAME",testValues[3]);
  }
}

</code></pre>

<pre class="type-11 type-6 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIntervalTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select case when c17 is null then null else interval '1' year end as col1," + " c17 -  c17 as col2 from " + dataTypeTableName + " order by col1");
  ResultSetMetaData meta=res.getMetaData();
  assertEquals("col1",meta.getColumnLabel(1));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(1));
  assertEquals("interval_year_month",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(11,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals(HiveIntervalYearMonth.class.getName(),meta.getColumnClassName(1));
  assertEquals("col2",meta.getColumnLabel(2));
  assertEquals(java.sql.Types.OTHER,meta.getColumnType(2));
  assertEquals("interval_day_time",meta.getColumnTypeName(2));
  assertEquals(29,meta.getColumnDisplaySize(2));
  assertEquals(29,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals(HiveIntervalDayTime.class.getName(),meta.getColumnClassName(2));
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertTrue(res.next());
  assertEquals("1-0",res.getString(1));
  assertEquals(1,((HiveIntervalYearMonth)res.getObject(1)).getYears());
  assertEquals("0 00:00:00.000000000",res.getString(2));
  assertEquals(0,((HiveIntervalDayTime)res.getObject(2)).getDays());
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDatabaseMetaData() throws SQLException {
  DatabaseMetaData meta=con.getMetaData();
  assertEquals("Apache Hive",meta.getDatabaseProductName());
  assertEquals(HiveVersionInfo.getVersion(),meta.getDatabaseProductVersion());
  assertEquals(System.getProperty("hive.version"),meta.getDatabaseProductVersion());
  assertTrue("verifying hive version pattern. got " + meta.getDatabaseProductVersion(),Pattern.matches("\\d+\\.\\d+\\.\\d+.*",meta.getDatabaseProductVersion()));
  assertEquals(DatabaseMetaData.sqlStateSQL99,meta.getSQLStateType());
  assertFalse(meta.supportsCatalogsInTableDefinitions());
  assertTrue(meta.supportsSchemasInTableDefinitions());
  assertTrue(meta.supportsSchemasInDataManipulation());
  assertFalse(meta.supportsMultipleResultSets());
  assertFalse(meta.supportsStoredProcedures());
  assertTrue(meta.supportsAlterTableWithAddColumn());
  assertTrue(meta.getDatabaseMajorVersion() > -1);
  assertTrue(meta.getDatabaseMinorVersion() > -1);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Execute non-select statements using execute() and executeUpdated() APIs
 * of PreparedStatement interface
 * @throws Exception
 */
@Test public void testExecutePreparedStatement() throws Exception {
  String key="testKey";
  String val1="val1";
  String val2="val2";
  PreparedStatement ps=con.prepareStatement("set " + key + " = ?");
  ps.setString(1,val1);
  ps.execute();
  verifyConfValue(con,key,val1);
  ps.clearParameters();
  ps.setString(1,val2);
  ps.executeUpdate();
  verifyConfValue(con,key,val2);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaDataGetTablesHive() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("set " + HiveConf.ConfVars.HIVE_SERVER2_TABLE_TYPE_MAPPING.varname + " = "+ TableTypeMappings.HIVE.toString());
  getTablesTest(TableType.MANAGED_TABLE.toString(),TableType.VIRTUAL_VIEW.toString());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for cursor repositioning to start of resultset for non-sql commands
 * @throws Exception
 */
@Test public void testFetchFirstSetCmds() throws Exception {
  execFetchFirst("set -v",SET_COLUMN_NAME,false);
}

</code></pre>

<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetColumnNameCaseInsensitive() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res;
  res=stmt.executeQuery("select c1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
  res=stmt.executeQuery("select c1 C1 from " + dataTypeTableName + " limit 1");
  try {
    int count=0;
    while (res.next()) {
      res.findColumn("c1");
      res.findColumn("C1");
      count++;
    }
    assertEquals(count,1);
  }
 catch (  Exception e) {
    String msg="Unexpected exception: " + e;
    LOG.info(msg,e);
    fail(msg);
  }
}

</code></pre>

<pre class="type-19 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testNullResultSet() throws Exception {
  List<String> setupQueries=new ArrayList<String>();
  String testQuery;
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("select * from " + tableName);
    System.out.println("select: success");
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  setupQueries.add("drop table test_t1");
  testQuery="create table test_t1 (under_col int, value string)";
  checkResultSetExpected(stmt,setupQueries,testQuery,false);
  setupQueries.clear();
  setupQueries.add("drop table test_t1");
  testQuery="create table test_t1 as select * from " + tableName;
  checkResultSetExpected(stmt,setupQueries,testQuery,false);
  setupQueries.clear();
  setupQueries.add("drop table test_t1");
  setupQueries.add("create table test_t1 (under_col int, value string)");
  testQuery="insert into table test_t1 select under_col, value from " + tableName;
  checkResultSetExpected(stmt,setupQueries,testQuery,false);
  setupQueries.clear();
  stmt.close();
}

</code></pre>

<pre class="type-11 type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Validate error on closed resultset
 * @throws SQLException
 */
@Test public void testPostClose() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertNotNull("ResultSet is null",res);
  res.close();
  try {
    res.getInt(1);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.getMetaData();
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
  try {
    res.setFetchSize(10);
    fail("Expected SQLException");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset methods
 * @throws Exception
 */
@Test public void testFetchFirstError() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  try {
    res.beforeFirst();
    fail("beforeFirst() should fail for normal resultset");
  }
 catch (  SQLException e) {
    assertEquals("Method not supported for TYPE_FORWARD_ONLY resultset",e.getMessage());
  }
}

</code></pre>

<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes2() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c5, c1 from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull(res.getObject(i));
  }
}

</code></pre>

<pre class="type-11 type-6 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaData() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c17, c18, c20, c21, c22, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(20,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c1",meta.getColumnName(1));
  assertEquals(Types.INTEGER,meta.getColumnType(1));
  assertEquals("int",meta.getColumnTypeName(1));
  assertEquals(11,meta.getColumnDisplaySize(1));
  assertEquals(10,meta.getPrecision(1));
  assertEquals(0,meta.getScale(1));
  assertEquals("c1",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.INTEGER,colRS.getInt("DATA_TYPE"));
  assertEquals("int",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(1),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(1),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertEquals("boolean",meta.getColumnTypeName(2));
  assertEquals(Types.BOOLEAN,meta.getColumnType(2));
  assertEquals(1,meta.getColumnDisplaySize(2));
  assertEquals(1,meta.getPrecision(2));
  assertEquals(0,meta.getScale(2));
  assertEquals("c2",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BOOLEAN,colRS.getInt("DATA_TYPE"));
  assertEquals("boolean",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getScale(2),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c3",meta.getColumnName(3));
  assertEquals(Types.DOUBLE,meta.getColumnType(3));
  assertEquals("double",meta.getColumnTypeName(3));
  assertEquals(25,meta.getColumnDisplaySize(3));
  assertEquals(15,meta.getPrecision(3));
  assertEquals(15,meta.getScale(3));
  assertEquals("c3",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DOUBLE,colRS.getInt("DATA_TYPE"));
  assertEquals("double",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(3),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(3),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c4",meta.getColumnName(4));
  assertEquals(Types.VARCHAR,meta.getColumnType(4));
  assertEquals("string",meta.getColumnTypeName(4));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(4));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(4));
  assertEquals(0,meta.getScale(4));
  assertEquals("c4",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("string",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(4),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(4),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("a",meta.getColumnName(5));
  assertEquals(Types.ARRAY,meta.getColumnType(5));
  assertEquals("array",meta.getColumnTypeName(5));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(5));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(5));
  assertEquals(0,meta.getScale(5));
  assertEquals("c5",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.ARRAY,colRS.getInt("DATA_TYPE"));
  assertEquals("array<int>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c6",meta.getColumnName(6));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(6));
  assertEquals("map",meta.getColumnTypeName(6));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(6));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(6));
  assertEquals(0,meta.getScale(6));
  assertEquals("c6",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<int,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c7",meta.getColumnName(7));
  assertEquals(Types.JAVA_OBJECT,meta.getColumnType(7));
  assertEquals("map",meta.getColumnTypeName(7));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(7));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(7));
  assertEquals(0,meta.getScale(7));
  assertEquals("c7",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.JAVA_OBJECT,colRS.getInt("DATA_TYPE"));
  assertEquals("map<string,string>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c8",meta.getColumnName(8));
  assertEquals(Types.STRUCT,meta.getColumnType(8));
  assertEquals("struct",meta.getColumnTypeName(8));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(8));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(8));
  assertEquals(0,meta.getScale(8));
  assertEquals("c8",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.STRUCT,colRS.getInt("DATA_TYPE"));
  assertEquals("struct<r:string,s:int,t:double>",colRS.getString("TYPE_NAME").toLowerCase());
  assertTrue(colRS.next());
  assertEquals("c9",meta.getColumnName(9));
  assertEquals(Types.TINYINT,meta.getColumnType(9));
  assertEquals("tinyint",meta.getColumnTypeName(9));
  assertEquals(4,meta.getColumnDisplaySize(9));
  assertEquals(3,meta.getPrecision(9));
  assertEquals(0,meta.getScale(9));
  assertEquals("c9",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TINYINT,colRS.getInt("DATA_TYPE"));
  assertEquals("tinyint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(9),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(9),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c10",meta.getColumnName(10));
  assertEquals(Types.SMALLINT,meta.getColumnType(10));
  assertEquals("smallint",meta.getColumnTypeName(10));
  assertEquals(6,meta.getColumnDisplaySize(10));
  assertEquals(5,meta.getPrecision(10));
  assertEquals(0,meta.getScale(10));
  assertEquals("c10",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.SMALLINT,colRS.getInt("DATA_TYPE"));
  assertEquals("smallint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(10),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(10),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c11",meta.getColumnName(11));
  assertEquals(Types.FLOAT,meta.getColumnType(11));
  assertEquals("float",meta.getColumnTypeName(11));
  assertEquals(24,meta.getColumnDisplaySize(11));
  assertEquals(7,meta.getPrecision(11));
  assertEquals(7,meta.getScale(11));
  assertEquals("c11",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.FLOAT,colRS.getInt("DATA_TYPE"));
  assertEquals("float",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(11),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(11),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c12",meta.getColumnName(12));
  assertEquals(Types.BIGINT,meta.getColumnType(12));
  assertEquals("bigint",meta.getColumnTypeName(12));
  assertEquals(20,meta.getColumnDisplaySize(12));
  assertEquals(19,meta.getPrecision(12));
  assertEquals(0,meta.getScale(12));
  assertEquals("c12",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.BIGINT,colRS.getInt("DATA_TYPE"));
  assertEquals("bigint",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(12),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(12),colRS.getInt("DECIMAL_DIGITS"));
  assertEquals("_c12",meta.getColumnName(13));
  assertEquals(Types.INTEGER,meta.getColumnType(13));
  assertEquals("int",meta.getColumnTypeName(13));
  assertEquals(11,meta.getColumnDisplaySize(13));
  assertEquals(10,meta.getPrecision(13));
  assertEquals(0,meta.getScale(13));
  assertEquals("b",meta.getColumnName(14));
  assertEquals(Types.ARRAY,meta.getColumnType(14));
  assertEquals("array",meta.getColumnTypeName(14));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(14));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(14));
  assertEquals(0,meta.getScale(14));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c17",meta.getColumnName(15));
  assertEquals(Types.TIMESTAMP,meta.getColumnType(15));
  assertEquals("timestamp",meta.getColumnTypeName(15));
  assertEquals(29,meta.getColumnDisplaySize(15));
  assertEquals(29,meta.getPrecision(15));
  assertEquals(9,meta.getScale(15));
  assertEquals("c17",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.TIMESTAMP,colRS.getInt("DATA_TYPE"));
  assertEquals("timestamp",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(15),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(15),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c18",meta.getColumnName(16));
  assertEquals(Types.DECIMAL,meta.getColumnType(16));
  assertEquals("decimal",meta.getColumnTypeName(16));
  assertEquals(18,meta.getColumnDisplaySize(16));
  assertEquals(16,meta.getPrecision(16));
  assertEquals(7,meta.getScale(16));
  assertEquals("c18",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DECIMAL,colRS.getInt("DATA_TYPE"));
  assertEquals("decimal",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(16),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(16),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertTrue(colRS.next());
  assertEquals("c20",meta.getColumnName(17));
  assertEquals(Types.DATE,meta.getColumnType(17));
  assertEquals("date",meta.getColumnTypeName(17));
  assertEquals(10,meta.getColumnDisplaySize(17));
  assertEquals(10,meta.getPrecision(17));
  assertEquals(0,meta.getScale(17));
  assertEquals("c20",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.DATE,colRS.getInt("DATA_TYPE"));
  assertEquals("date",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(17),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(17),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c21",meta.getColumnName(18));
  assertEquals(Types.VARCHAR,meta.getColumnType(18));
  assertEquals("varchar",meta.getColumnTypeName(18));
  assertEquals(20,meta.getColumnDisplaySize(18));
  assertEquals(20,meta.getPrecision(18));
  assertEquals(0,meta.getScale(18));
  assertEquals("c21",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.VARCHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("varchar",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(18),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(18),colRS.getInt("DECIMAL_DIGITS"));
  assertTrue(colRS.next());
  assertEquals("c22",meta.getColumnName(19));
  assertEquals(Types.CHAR,meta.getColumnType(19));
  assertEquals("char",meta.getColumnTypeName(19));
  assertEquals(15,meta.getColumnDisplaySize(19));
  assertEquals(15,meta.getPrecision(19));
  assertEquals(0,meta.getScale(19));
  assertEquals("c23",meta.getColumnName(20));
  assertEquals(Types.BINARY,meta.getColumnType(20));
  assertEquals("binary",meta.getColumnTypeName(20));
  assertEquals(Integer.MAX_VALUE,meta.getColumnDisplaySize(20));
  assertEquals(Integer.MAX_VALUE,meta.getPrecision(20));
  assertEquals(0,meta.getScale(20));
  assertEquals("c22",colRS.getString("COLUMN_NAME"));
  assertEquals(Types.CHAR,colRS.getInt("DATA_TYPE"));
  assertEquals("char",colRS.getString("TYPE_NAME").toLowerCase());
  assertEquals(meta.getPrecision(19),colRS.getInt("COLUMN_SIZE"));
  assertEquals(meta.getScale(19),colRS.getInt("DECIMAL_DIGITS"));
  for (int i=1; i <= meta.getColumnCount(); i++) {
    assertFalse(meta.isAutoIncrement(i));
    assertFalse(meta.isCurrency(i));
    assertEquals(ResultSetMetaData.columnNullable,meta.isNullable(i));
  }
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * verify 'explain ...' resultset
 * @throws SQLException
 */
@Test public void testExplainStmt() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("explain select c1, c2, c3, c4, c5 as a, c6, c7, c8, c9, c10, c11, c12, " + "c1*2, sentences(null, null, null) as b, c23 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),1);
  assertEquals(md.getColumnLabel(1),EXPL_COLUMN_NAME);
  assertTrue("Nothing returned explain",res.next());
}

</code></pre>

<pre class="type-3 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test the cancellation of a query that is running.
 * We spawn 2 threads - one running the query and
 * the other attempting to cancel.
 * We're using a dummy udf to simulate a query,
 * that runs for a sufficiently long time.
 * @throws Exception
 */
@Test public void testQueryCancel() throws Exception {
  String udfName=SleepUDF.class.getName();
  Statement stmt1=con.createStatement();
  stmt1.execute("create temporary function sleepUDF as '" + udfName + "'");
  stmt1.close();
  final Statement stmt=con.createStatement();
  Thread tExecute=new Thread(new Runnable(){
    @Override public void run(){
      try {
        System.out.println("Executing query: ");
        stmt.executeQuery("select sleepUDF(t1.under_col) as u0, t1.under_col as u1, " + "t2.under_col as u2 from " + tableName + "t1 join "+ tableName+ " t2 on t1.under_col = t2.under_col");
        fail("Expecting SQLException");
      }
 catch (      SQLException e) {
        assertNotNull(e);
        System.out.println(e.toString());
      }
    }
  }
);
  Thread tCancel=new Thread(new Runnable(){
    @Override public void run(){
      try {
        Thread.sleep(1000);
        System.out.println("Cancelling query: ");
        stmt.cancel();
      }
 catch (      Exception e) {
      }
    }
  }
);
  tExecute.start();
  tCancel.start();
  tExecute.join();
  tCancel.join();
  stmt.close();
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaDataGetTables() throws SQLException {
  getTablesTest(ClassicTableTypes.TABLE.toString(),ClassicTableTypes.VIEW.toString());
}

</code></pre>

<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Validate the Metadata for the result set of a metadata getColumns call.
 */
@Test public void testMetaDataGetColumnsMetaData() throws SQLException {
  ResultSet rs=con.getMetaData().getColumns(null,null,"testhivejdbcdriver\\_table",null);
  ResultSetMetaData rsmd=rs.getMetaData();
  assertEquals("TABLE_CAT",rsmd.getColumnName(1));
  assertEquals(Types.VARCHAR,rsmd.getColumnType(1));
  assertEquals(Integer.MAX_VALUE,rsmd.getColumnDisplaySize(1));
  assertEquals("ORDINAL_POSITION",rsmd.getColumnName(17));
  assertEquals(Types.INTEGER,rsmd.getColumnType(17));
  assertEquals(11,rsmd.getColumnDisplaySize(17));
}

</code></pre>

<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDescribeTable() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("describe " + tableName);
  res.next();
  assertEquals("Column name 'under_col' not found","under_col",res.getString(1));
  assertEquals("Column type 'under_col' for column under_col not found","int",res.getString(2));
  res.next();
  assertEquals("Column name 'value' not found","value",res.getString(1));
  assertEquals("Column type 'string' for column key not found","string",res.getString(2));
  assertFalse("More results found than expected",res.next());
}

</code></pre>

<pre class="type-11 type-6 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetaDataGetColumns() throws SQLException {
  Map<String[],Integer> tests=new HashMap<String[],Integer>();
  tests.put(new String[]{"testhivejdbcdriver\\_table",null},2);
  tests.put(new String[]{"testhivejdbc%",null},7);
  tests.put(new String[]{"testhiveJDBC%",null},7);
  tests.put(new String[]{"%jdbcdriver\\_table",null},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under\\_co_"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","under_col"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","und%"},1);
  tests.put(new String[]{"%jdbcdriver\\_table%","%"},2);
  tests.put(new String[]{"%jdbcdriver\\_table%","_%"},2);
  for (  String[] checkPattern : tests.keySet()) {
    ResultSet rs=con.getMetaData().getColumns(null,null,checkPattern[0],checkPattern[1]);
    ResultSetMetaData rsmd=rs.getMetaData();
    assertEquals("TABLE_CAT",rsmd.getColumnName(1));
    int cnt=0;
    while (rs.next()) {
      String columnname=rs.getString("COLUMN_NAME");
      int ordinalPos=rs.getInt("ORDINAL_POSITION");
switch (cnt) {
case 0:
        assertEquals("Wrong column name found","under_col",columnname);
      assertEquals("Wrong ordinal position found",ordinalPos,1);
    break;
case 1:
  assertEquals("Wrong column name found","value",columnname);
assertEquals("Wrong ordinal position found",ordinalPos,2);
break;
default :
break;
}
cnt++;
}
rs.close();
assertEquals("Found less columns then we test for.",tests.get(checkPattern).intValue(),cnt);
}
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaDataGetHiveTableTypes() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("set " + HiveConf.ConfVars.HIVE_SERVER2_TABLE_TYPE_MAPPING.varname + " = "+ TableTypeMappings.HIVE.toString());
  stmt.close();
  metaDataGetTableTypeTest(new HiveTableTypeMapping().getTableTypeNames());
}

</code></pre>

<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test testProccedures()
 * @throws SQLException
 */
@Test public void testProccedures() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getProcedures(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),9);
  assertFalse(res.next());
}

</code></pre>

<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCloseResultSet() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  res.close();
  assertFalse(stmt.isClosed());
  try {
    stmt.cancel();
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  stmt.close();
  stmt=con.createStatement();
  res=stmt.executeQuery("select * from " + tableName);
  res.close();
  try {
    stmt.executeQuery("select * from " + tableName);
  }
 catch (  SQLException e) {
    failWithExceptionMsg(e);
  }
  stmt.close();
  assertTrue(stmt.isClosed());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public final void testSelectAllFetchSize() throws Exception {
  doTestSelectAll(tableName,100,20);
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetCatalogs() throws SQLException {
  ResultSet rs=con.getMetaData().getCatalogs();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(1,resMeta.getColumnCount());
  assertEquals("TABLE_CAT",resMeta.getColumnName(1));
  assertFalse(rs.next());
}

</code></pre>

<pre class="type-11 type-3 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetDate() throws Exception {
  try {
    String sql="select * from " + dataTypeTableName + " where c20 = ?";
    PreparedStatement ps=con.prepareStatement(sql);
    java.sql.Date dtValue=java.sql.Date.valueOf("2013-01-01");
    ps.setDate(1,dtValue);
    ResultSet res=ps.executeQuery();
    assertTrue(res.next());
    assertEquals("2013-01-01",res.getString(20));
    ps.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.toString());
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test the cursor repositioning to start of resultset
 * @throws Exception
 */
@Test public void testFetchFirstQuery() throws Exception {
  execFetchFirst("select c4, c1 from " + dataTypeTableName + " order by c1","c4",false);
  execFetchFirst("select c4, c1 from " + dataTypeTableName + " order by c1","c4",true);
}

</code></pre>

<pre class="type-11 type-6 type-4 type-7 type-8 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDataTypes() throws Exception {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + dataTypeTableName + " order by c1");
  ResultSetMetaData meta=res.getMetaData();
  assertTrue(res.next());
  for (int i=1; i < meta.getColumnCount(); i++) {
    assertNull("Column " + i + " should be null",res.getObject(i));
  }
  assertEquals(0,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(0d,res.getDouble(3),floatCompareDelta);
  assertEquals(null,res.getString(4));
  assertEquals(null,res.getString(5));
  assertEquals(null,res.getString(6));
  assertEquals(null,res.getString(7));
  assertEquals(null,res.getString(8));
  assertEquals(0,res.getByte(9));
  assertEquals(0,res.getShort(10));
  assertEquals(0f,res.getFloat(11),floatCompareDelta);
  assertEquals(0L,res.getLong(12));
  assertEquals(null,res.getString(13));
  assertEquals(null,res.getString(14));
  assertEquals(null,res.getString(15));
  assertEquals(null,res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getString(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertTrue(res.next());
  assertEquals(-1,res.getInt(1));
  assertEquals(false,res.getBoolean(2));
  assertEquals(-1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("",res.getString(4));
  assertEquals("[]",res.getString(5));
  assertEquals("{}",res.getString(6));
  assertEquals("{}",res.getString(7));
  assertEquals("{\"r\":null,\"s\":null,\"t\":null}",res.getString(8));
  assertEquals(-1,res.getByte(9));
  assertEquals(-1,res.getShort(10));
  assertEquals(-1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(-1,res.getLong(12));
  assertEquals("[]",res.getString(13));
  assertEquals("{}",res.getString(14));
  assertEquals("{\"r\":null,\"s\":null}",res.getString(15));
  assertEquals("[]",res.getString(16));
  assertEquals(null,res.getString(17));
  assertEquals(null,res.getTimestamp(17));
  assertEquals(null,res.getBigDecimal(18));
  assertEquals(null,res.getString(19));
  assertEquals(null,res.getString(20));
  assertEquals(null,res.getDate(20));
  assertEquals(null,res.getString(21));
  assertEquals(null,res.getString(22));
  assertEquals(null,res.getString(23));
  assertTrue(res.next());
  assertEquals(1,res.getInt(1));
  assertEquals(true,res.getBoolean(2));
  assertEquals(1.1d,res.getDouble(3),floatCompareDelta);
  assertEquals("1",res.getString(4));
  assertEquals("[1,2]",res.getString(5));
  assertEquals("{1:\"x\",2:\"y\"}",res.getString(6));
  assertEquals("{\"k\":\"v\"}",res.getString(7));
  assertEquals("{\"r\":\"a\",\"s\":9,\"t\":2.2}",res.getString(8));
  assertEquals(1,res.getByte(9));
  assertEquals(1,res.getShort(10));
  assertEquals(1.0f,res.getFloat(11),floatCompareDelta);
  assertEquals(1,res.getLong(12));
  assertEquals("[[\"a\",\"b\"],[\"c\",\"d\"]]",res.getString(13));
  assertEquals("{1:{11:12,13:14},2:{21:22}}",res.getString(14));
  assertEquals("{\"r\":1,\"s\":{\"a\":2,\"b\":\"x\"}}",res.getString(15));
  assertEquals("[{\"m\":{},\"n\":1},{\"m\":{\"a\":\"b\",\"c\":\"d\"},\"n\":2}]",res.getString(16));
  assertEquals("2012-04-22 09:00:00.123456789",res.getString(17));
  assertEquals("2012-04-22 09:00:00.123456789",res.getTimestamp(17).toString());
  assertEquals("123456789.0123456",res.getBigDecimal(18).toString());
  assertEquals("abcd",res.getString(19));
  assertEquals("2013-01-01",res.getString(20));
  assertEquals("2013-01-01",res.getDate(20).toString());
  assertEquals("abc123",res.getString(21));
  assertEquals("abc123         ",res.getString(22));
  byte[] bytes="X'01FF'".getBytes("UTF-8");
  InputStream resultSetInputStream=res.getBinaryStream(23);
  int len=bytes.length;
  byte[] b=new byte[len];
  resultSetInputStream.read(b,0,len);
  for (int i=0; i < len; i++) {
    assertEquals(bytes[i],b[i]);
  }
  assertEquals(true,res.getBoolean(1));
  assertEquals(true,res.getBoolean(4));
  assertFalse(meta.isCaseSensitive(1));
  assertFalse(meta.isCaseSensitive(2));
  assertFalse(meta.isCaseSensitive(3));
  assertTrue(meta.isCaseSensitive(4));
  assertFalse(res.next());
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateColumnNameOrder() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet rs=stmt.executeQuery("SELECT 1 AS a, 2 AS a from " + tableName);
  assertTrue(rs.next());
  assertEquals(1,rs.getInt("a"));
  rs.close();
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verify selecting named expression columns
 * @throws SQLException
 */
@Test public void testExprCol() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1+1 as col1, length(c4) as len from " + dataTypeTableName + " where c1=1");
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),2);
  assertEquals(md.getColumnLabel(1),"col1");
  assertEquals(md.getColumnLabel(2),"len");
  assertTrue(res.next());
  assertEquals(res.getInt(1),2);
  assertEquals(res.getInt(2),1);
  res.close();
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMetaDataGetSchemas() throws SQLException {
  ResultSet rs=con.getMetaData().getSchemas();
  ResultSetMetaData resMeta=rs.getMetaData();
  assertEquals(2,resMeta.getColumnCount());
  assertEquals("TABLE_SCHEM",resMeta.getColumnName(1));
  assertEquals("TABLE_CATALOG",resMeta.getColumnName(2));
  assertTrue(rs.next());
  assertEquals("default",rs.getString(1));
  assertFalse(rs.next());
  rs.close();
}

</code></pre>

<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getPrimaryKeys()
 * @throws SQLException
 */
@Test public void testPrimaryKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getPrimaryKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),6);
  assertFalse(res.next());
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testResultSetMetaDataDuplicateColumnNames() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select c1 as c2_1, c2, c1*2 from " + dataTypeTableName + " limit 1");
  ResultSetMetaData meta=res.getMetaData();
  ResultSet colRS=con.getMetaData().getColumns(null,null,dataTypeTableName.toLowerCase(),null);
  assertEquals(3,meta.getColumnCount());
  assertTrue(colRS.next());
  assertEquals("c2_1",meta.getColumnName(1));
  assertTrue(colRS.next());
  assertEquals("c2",meta.getColumnName(2));
  assertTrue(colRS.next());
  assertEquals("_c2",meta.getColumnName(3));
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * validate schema generated by "set" command
 * @throws SQLException
 */
@Test public void testSetCommand() throws SQLException {
  String sql="set -v";
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery(sql);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(1,md.getColumnCount());
  assertEquals(SET_COLUMN_NAME,md.getColumnLabel(1));
  assertTrue("Nothing returned by set -v",res.next());
  res.close();
  stmt.close();
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaDataGetTablesClassic() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("set " + HiveConf.ConfVars.HIVE_SERVER2_TABLE_TYPE_MAPPING.varname + " = "+ TableTypeMappings.CLASSIC.toString());
  stmt.close();
  getTablesTest(ClassicTableTypes.TABLE.toString(),ClassicTableTypes.VIEW.toString());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public final void testSelectAll() throws Exception {
  doTestSelectAll(tableName,-1,-1);
  doTestSelectAll(tableName,0,-1);
}

</code></pre>

<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * Test bad args to getXXX()
 * @throws SQLException
 */
@Test public void testOutOfBoundCols() throws SQLException {
  Statement stmt=con.createStatement();
  ResultSet res=stmt.executeQuery("select * from " + tableName);
  assertTrue(res.next());
  try {
    res.getInt(200);
  }
 catch (  SQLException e) {
  }
  try {
    res.getInt("zzzz");
  }
 catch (  SQLException e) {
  }
}

</code></pre>

<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowGrant() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("grant select on table " + dataTypeTableName + " to user hive_test_user");
  stmt.execute("show grant user hive_test_user on table " + dataTypeTableName);
  ResultSet res=stmt.getResultSet();
  assertTrue(res.next());
  assertEquals("default",res.getString(1));
  assertEquals(dataTypeTableName,res.getString(2));
  assertEquals("",res.getString(3));
  assertEquals("",res.getString(4));
  assertEquals("hive_test_user",res.getString(5));
  assertEquals("USER",res.getString(6));
  assertEquals("SELECT",res.getString(7));
  assertEquals(false,res.getBoolean(8));
  assertEquals(-1,res.getLong(9));
  assertNotNull(res.getString(10));
  assertFalse(res.next());
  res.close();
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBadURL() throws Exception {
  checkBadUrl("jdbc:hive2://localhost:10000;principal=test");
  checkBadUrl("jdbc:hive2://localhost:10000;" + "principal=hive/HiveServer2Host@YOUR-REALM.COM");
  checkBadUrl("jdbc:hive2://localhost:10000test");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public final void testSelectAllFromView() throws Exception {
  doTestSelectAll(viewName,-1,-1);
  doTestSelectAll(viewName,0,-1);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testErrorMessages() throws SQLException {
  String invalidSyntaxSQLState="42000";
  doTestErrorCase("SELECTT * FROM " + tableName,"cannot recognize input near 'SELECTT' '*' 'FROM'",invalidSyntaxSQLState,40000);
  doTestErrorCase("SELECT * FROM some_table_that_does_not_exist","Table not found","42S02",10001);
  doTestErrorCase("drop table some_table_that_does_not_exist","Table not found","42S02",10001);
  doTestErrorCase("SELECT invalid_column FROM " + tableName,"Invalid table alias or column reference",invalidSyntaxSQLState,10004);
  doTestErrorCase("SELECT invalid_function(under_col) FROM " + tableName,"Invalid function",invalidSyntaxSQLState,10011);
  doTestErrorCase("create table " + tableName + " (key int, value string)","FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask","08S01",1);
}

</code></pre>

<pre class="type-11 type-6 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShowTables() throws SQLException {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  ResultSet res=stmt.executeQuery("show tables");
  boolean testTableExists=false;
  while (res.next()) {
    assertNotNull("table name is null in result set",res.getString(1));
    if (tableName.equalsIgnoreCase(res.getString(1))) {
      testTableExists=true;
    }
  }
  assertTrue("table name " + tableName + " not found in SHOW TABLES result set",testTableExists);
}

</code></pre>

<pre class="type-5 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * If the Driver implementation understands the URL, it will return a Connection object;
 * otherwise it returns null
 */
@Test public void testInvalidURL() throws Exception {
  HiveDriver driver=new HiveDriver();
  Connection conn=driver.connect("jdbc:derby://localhost:10000/default",new Properties());
  assertNull(conn);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test for cursor repositioning to start of resultset for non-sql commands
 * @throws Exception
 */
@Test public void testFetchFirstDfsCmds() throws Exception {
  String wareHouseDir=conf.get(HiveConf.ConfVars.METASTOREWAREHOUSE.varname);
  execFetchFirst("dfs -ls " + wareHouseDir,DfsProcessor.DFS_RESULT_HEADER,false);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public final void testSelectAllMaxRows() throws Exception {
  doTestSelectAll(tableName,100,-1);
}

</code></pre>

<pre class="type-11 type-4 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPrepareSetTimestamp() throws SQLException, ParseException {
  String sql=String.format("SELECT * FROM %s WHERE c17 = ?",dataTypeTableName);
  try (PreparedStatement ps=con.prepareStatement(sql)){
    Timestamp timestamp=Timestamp.valueOf("2012-04-22 09:00:00.123456789");
    ps.setTimestamp(1,timestamp);
    try (ResultSet resultSet=ps.executeQuery()){
      assertTrue(resultSet.next());
      assertEquals(1,resultSet.getInt(1));
      assertFalse(resultSet.next());
    }
   }
 }

</code></pre>

<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testParentReferences() throws Exception {
  Statement s=this.con.createStatement();
  ResultSet rs=s.executeQuery("SELECT * FROM " + dataTypeTableName);
  assertTrue(s.getConnection() == this.con);
  assertTrue(rs.getStatement() == s);
  rs.close();
  s.close();
  PreparedStatement ps=this.con.prepareStatement("SELECT * FROM " + dataTypeTableName);
  rs=ps.executeQuery();
  assertTrue(ps.getConnection() == this.con);
  assertTrue(rs.getStatement() == ps);
  rs.close();
  ps.close();
  DatabaseMetaData md=this.con.getMetaData();
  assertTrue(md.getConnection() == this.con);
  rs=md.getCatalogs();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getFunctions(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getImportedKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getPrimaryKeys(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedureColumns(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getProcedures(null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getSchemas();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTableTypes();
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTables(null,null,null,null);
  assertNull(rs.getStatement());
  rs.close();
  rs=md.getTypeInfo();
  assertNull(rs.getStatement());
  rs.close();
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public final void testSelectAllPartioned() throws Exception {
  doTestSelectAll(partitionedTableName,-1,-1);
  doTestSelectAll(partitionedTableName,0,-1);
}

</code></pre>

<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testErrorDiag() throws SQLException {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("select from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
  try {
    stmt.executeQuery("select * from nonTable");
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42S02",e.getSQLState());
  }
  try {
    stmt.executeQuery("select zzzz from " + dataTypeTableName);
    fail("SQLException is expected");
  }
 catch (  SQLException e) {
    assertEquals("42000",e.getSQLState());
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaDataGetClassicTableTypes() throws SQLException {
  Statement stmt=con.createStatement();
  stmt.execute("set " + HiveConf.ConfVars.HIVE_SERVER2_TABLE_TYPE_MAPPING.varname + " = "+ TableTypeMappings.CLASSIC.toString());
  stmt.close();
  metaDataGetTableTypeTest(new ClassicTableTypeMapping().getTableTypeNames());
}

</code></pre>

<pre class="type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Negative Test for cursor repositioning to start of resultset
 * Verify unsupported JDBC resultset attributes
 * @throws Exception
 */
@Test public void testUnsupportedFetchTypes() throws Exception {
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_READ_ONLY);
    fail("createStatement with TYPE_SCROLL_SENSITIVE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
  try {
    con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
    fail("createStatement with CONCUR_UPDATABLE should fail");
  }
 catch (  SQLException e) {
    assertEquals("HYC00",e.getSQLState().trim());
  }
}

</code></pre>

<pre class="type-11 type-4 type-7 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test getImportedKeys()
 * @throws SQLException
 */
@Test public void testImportedKeys() throws SQLException {
  DatabaseMetaData dbmd=con.getMetaData();
  assertNotNull(dbmd);
  ResultSet res=dbmd.getImportedKeys(null,null,null);
  ResultSetMetaData md=res.getMetaData();
  assertEquals(md.getColumnCount(),14);
  assertFalse(res.next());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSetOnConnection() throws Exception {
  Connection connection=getConnection("test?conf1=conf2;conf3=conf4#var1=var2;var3=var4");
  try {
    verifyConfValue(connection,"conf1","conf2");
    verifyConfValue(connection,"conf3","conf4");
    verifyConfValue(connection,"var1","var2");
    verifyConfValue(connection,"var3","var4");
  }
 catch (  Exception e) {
    connection.close();
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMetaDataGetTableTypes() throws SQLException {
  metaDataGetTableTypeTest(new ClassicTableTypeMapping().getTableTypeNames());
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExecuteQueryException() throws Exception {
  Statement stmt=con.createStatement();
  try {
    stmt.executeQuery("create table test_t2 (under_col int, value string)");
    fail("Expecting SQLException");
  }
 catch (  SQLException e) {
    System.out.println("Caught an expected SQLException: " + e.getMessage());
  }
 finally {
    stmt.close();
  }
}

</code></pre>

<pre class="type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNullType() throws Exception {
  Statement stmt=con.createStatement();
  try {
    ResultSet res=stmt.executeQuery("select null from " + dataTypeTableName);
    assertTrue(res.next());
    assertNull(res.getObject(1));
  }
  finally {
    stmt.close();
  }
}

</code></pre>

<pre class="type-13 type-11 type-4 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@After public void tearDown() throws Exception {
  Statement stmt=con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.execute("drop table " + tableName);
  stmt.execute("drop table " + partitionedTableName);
  stmt.execute("drop table " + dataTypeTableName);
  con.close();
  assertTrue("Connection should be closed",con.isClosed());
  Exception expectedException=null;
  try {
    con.createStatement();
  }
 catch (  Exception e) {
    expectedException=e;
  }
  assertNotNull("createStatement() on closed connection should throw exception",expectedException);
}

</code></pre>

<pre class="type-11 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
/** 
 * Loads data from a table containing non-ascii value column
 * Runs a query and compares the return value
 * @throws Exception
 */
@Test public void testNonAsciiReturnValues() throws Exception {
  String nonAsciiTableName="nonAsciiTable";
  String nonAsciiString="Garu Kkaku kidtai";
  Path nonAsciiFilePath=new Path(dataFileDir,"non_ascii_tbl.txt");
  Statement stmt=con.createStatement();
  stmt.execute("set hive.support.concurrency = false");
  stmt.execute("create table " + nonAsciiTableName + " (key int, value string) "+ "row format delimited fields terminated by '|'");
  stmt.execute("load data local inpath '" + nonAsciiFilePath.toString() + "' into table "+ nonAsciiTableName);
  ResultSet rs=stmt.executeQuery("select value from " + nonAsciiTableName + " limit 1");
  while (rs.next()) {
    String resultValue=rs.getString(1);
    assertTrue(resultValue.equalsIgnoreCase(nonAsciiString));
  }
  try {
    stmt.execute("drop table " + nonAsciiTableName);
  }
 catch (  Exception ex) {
  }
  stmt.close();
}

</code></pre>

<pre class="type-11 type-4 type-5 type-8 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting query log when HS2 disable logging.
 * @throws Exception
 */
@Test public void testGetQueryLogOnDisabledLog() throws Exception {
  Statement setStmt=con.createStatement();
  setStmt.execute("set hive.server2.logging.operation.enabled = false");
  String sql="select count(*) from " + tableName;
  HiveStatement stmt=(HiveStatement)con.createStatement();
  assertNotNull("Statement is null",stmt);
  stmt.executeQuery(sql);
  List<String> logs=stmt.getQueryLog(false,10);
  stmt.close();
  assertTrue(logs.size() == 0);
  setStmt.execute("set hive.server2.logging.operation.enabled = true");
  setStmt.close();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
