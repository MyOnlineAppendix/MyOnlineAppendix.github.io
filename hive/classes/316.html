<h3 style="margin:0px">Class: org.apache.hive.beeline.TestBeeLineWithArgs (40 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(37)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using new CSV format
 */
@Test public void testCSV2OutputWithDoubleQuotes() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQueryForEableQuotes();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=csv2");
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"false");
  final String EXPECTED_PATTERN="1,NULL,defg,\"ab\"\"c\",\"\"\"aa\"\"\",1.0";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"true");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using new TSV format
 */
@Test public void testTSV2OutputWithDoubleQuotes() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQueryForEableQuotes();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=tsv2");
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"false");
  final String EXPECTED_PATTERN="1\tNULL\tdefg\t\"ab\"\"c\"\t\"\"\"aa\"\"\"\t1.0";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"true");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Select null from table , check if default null is printed differently
 * Print PASSED or FAILED
 */
@Test public void testNullNonEmpty() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "!set nullemptystring false\n select null from " + tableName + " limit 1 ;\n";
  final String EXPECTED_PATTERN="NULL";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,getBaseArgs(miniHS2.getBaseJdbcURL()));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Attempt to execute a simple script file with the -f option to BeeLine
 * The first command should fail and the second command should not execute
 * Print PASSED or FAILED
 */
@Test public void testBreakOnErrorScriptFile() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  final String SCRIPT_TEXT="select * from abcdefg01;\nshow databases;\n";
  final String EXPECTED_PATTERN=" default ";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testConnectionUrlWithSemiColon() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getJdbcURL("default","sess_var_list?var1=value1"));
  final String SCRIPT_TEXT="set var1";
  final String EXPECTED_PATTERN="var1=value1";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiCommandsInOneline() throws Throwable {
  final String SCRIPT_TEXT="drop table if exists multiCmdTbl;create table multiCmdTbl " + "(key int);show tables; --multicommands in one line";
  final String EXPECTED_PATTERN=" multicmdtbl ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  final String SCRIPT_TEXT_DROP="drop table multiCmdTbl;show tables;";
  testScriptFile(SCRIPT_TEXT_DROP,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBeelineShellCommand() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  final String SCRIPT_TEXT="!sh echo \"hello world.\" > hw.txt\n!sh cat hw.txt\n!rm hw.txt";
  final String EXPECTED_PATTERN="hello world";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-11 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
/** 
 * HIVE-4566
 * @throws UnsupportedEncodingException
 */
@Test public void testNPE() throws UnsupportedEncodingException {
  BeeLine beeLine=new BeeLine();
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  PrintStream beelineOutputStream=new PrintStream(os);
  beeLine.setOutputStream(beelineOutputStream);
  beeLine.setErrorStream(beelineOutputStream);
  beeLine.runCommands(new String[]{"!typeinfo"});
  String output=os.toString("UTF8");
  Assert.assertFalse(output.contains("java.lang.NullPointerException"));
  Assert.assertTrue(output.contains("No current connection"));
  beeLine.runCommands(new String[]{"!nativesql"});
  output=os.toString("UTF8");
  Assert.assertFalse(output.contains("java.lang.NullPointerException"));
  Assert.assertTrue(output.contains("No current connection"));
  System.out.println(">>> PASSED " + "testNPE");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Beeline -hivevar option. User can specify --hivevar name=value on Beeline command line.
 * This test defines multiple variables using repeated --hivevar or --hiveconf flags.
 * @throws Throwable
 */
@Test public void testBeelineMultiHiveVariable() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--hivevar");
  argList.add("TABLE_NAME=dummy2");
  argList.add("--hiveconf");
  argList.add("COLUMN_NAME=d");
  argList.add("--hivevar");
  argList.add("COMMAND=create");
  argList.add("--hivevar");
  argList.add("OBJECT=table");
  argList.add("--hiveconf");
  argList.add("COLUMN_TYPE=int");
  final String SCRIPT_TEXT="${COMMAND} ${OBJECT} ${TABLE_NAME} (${hiveconf:COLUMN_NAME} ${hiveconf:COLUMN_TYPE});\nshow tables;\n";
  final String EXPECTED_PATTERN="dummy2";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using TSV (new) format
 */
@Test public void testTSV2Output() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQuery();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=tsv2");
  final String EXPECTED_PATTERN="1\tNULL\tdefg\tab\"c\t1.0";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using CSV deprecated format
 * Check for deprecation message
 */
@Test public void testCSVOutputDeprecation() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQuery();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=csv");
  final String EXPECTED_PATTERN="Format csv is deprecated, please use csv2";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmbeddedBeelineOutputs() throws Throwable {
  String embeddedJdbcURL=BeeLine.BEELINE_DEFAULT_JDBC_URL + "/Default";
  List<String> argList=getBaseArgs(embeddedJdbcURL);
  final String SCRIPT_TEXT="set hive.lock.manager=org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager;\n" + "create table if not exists embeddedBeelineOutputs(d int);\n" + "set a=1;\nselect count(*) from embeddedBeelineOutputs;\n";
  final String EXPECTED_PATTERN="Stage-1 map =";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testMultiCommandsInOneEnclosedQuery() throws Throwable {
  final String QUERY_TEXT="drop table if exists multiCmdTbl;create table multiCmdTbl " + "(key int);show tables; --multicommands in one line";
  final String EXPECTED_PATTERN=" multicmdtbl ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testCommandEnclosedQuery(QUERY_TEXT,EXPECTED_PATTERN,true,argList);
  final String QUERY_TEXT_DROP="drop table multiCmdTbl;show tables;";
  testCommandEnclosedQuery(QUERY_TEXT_DROP,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test that BeeLine will read comment lines that start with whitespace
 * @throws Throwable
 */
@Test public void testWhitespaceBeforeCommentScriptFile() throws Throwable {
  final String SCRIPT_TEXT=" 	 	-- comment has spaces and tabs before it\n 	 	# comment has spaces and tabs before it\n";
  final String EXPECTED_PATTERN="cannot recognize input near '<EOF>'";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using TSV deprecated format
 */
@Test public void testTSVOutputWithDoubleQuotes() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQueryForEableQuotes();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=tsv");
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"false");
  final String EXPECTED_PATTERN="'1'\t'NULL'\t'defg'\t'ab\"c'\t'\"aa\"'\t'1.0'";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"true");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testGetVariableValue() throws Throwable {
  final String SCRIPT_TEXT="set env:TERM;";
  final String EXPECTED_PATTERN="env:TERM";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,getBaseArgs(miniHS2.getBaseJdbcURL()));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Beeline could show the query progress for time-consuming query when hive.exec.parallel
 * is true
 * @throws Throwable
 */
@Test public void testQueryProgressParallel() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "set hive.exec.parallel = true;\n" + "select count(*) from " + tableName + ";\n";
  final String EXPECTED_PATTERN="number of splits";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,getBaseArgs(miniHS2.getBaseJdbcURL()));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testBeelineHiveConfVariable() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--hiveconf");
  argList.add("test.hive.table.name=dummy");
  final String SCRIPT_TEXT="create table ${hiveconf:test.hive.table.name} (d int);\nshow tables;\n";
  final String EXPECTED_PATTERN="dummy";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEscapeSemiColonInQueries() throws Throwable {
  final String SCRIPT_TEXT="drop table if exists multiCmdTbl;create table multiCmdTbl " + "(key int, value string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\;' LINES " + " TERMINATED BY '\\n';show tables; --one command in multiple lines";
  final String EXPECTED_PATTERN=" multicmdtbl ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  final String SCRIPT_TEXT_DROP="drop table\nmultiCmdTbl;show tables;";
  testScriptFile(SCRIPT_TEXT_DROP,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
/** 
 * Shut down a local Hive Server 2 for these tests
 */
@AfterClass public static void postTests(){
  if (miniHS2.isStarted()) {
    miniHS2.stop();
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using CSV deprecated format
 */
@Test public void testCSVOutput() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQuery();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=csv");
  final String EXPECTED_PATTERN="'1','NULL','defg','ab\"c\','1.0'";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Attempt to execute a simple script file with the -f option to BeeLine
 * Test for presence of an expected pattern
 * in the output (stdout or stderr), fail if not found
 * Print PASSED or FAILED
 */
@Test public void testPositiveScriptFile() throws Throwable {
  final String SCRIPT_TEXT="show databases;\n";
  final String EXPECTED_PATTERN=" default ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Select null from table , check how null is printed
 * Print PASSED or FAILED
 */
@Test public void testNullDefault() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "select null from " + tableName + " limit 1 ;\n";
  final String EXPECTED_PATTERN="NULL";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,getBaseArgs(miniHS2.getBaseJdbcURL()));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using TSV deprecated format
 */
@Test public void testTSVOutput() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQuery();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=tsv");
  final String EXPECTED_PATTERN="'1'\t'NULL'\t'defg'\t'ab\"c\'\t'1.0'";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using DSV format, with custom delimiter ";"
 */
@Test public void testDSVOutputWithDoubleQuotes() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQueryForEableQuotes();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=dsv");
  argList.add("--delimiterForDSV=;");
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"false");
  final String EXPECTED_PATTERN="1;NULL;defg;\"ab\"\"c\";\"\"\"aa\"\"\";1.0";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"true");
}

</code></pre>

<pre class="type-11 type-12 type-3 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Attempt to execute a missing script file with the -f option to BeeLine
 */
@Test public void testNegativeScriptFile() throws Throwable {
  final String EXPECTED_PATTERN=" default ";
  File scriptFile=File.createTempFile("beelinenegative","temp");
  scriptFile.delete();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("-f");
  argList.add(scriptFile.getAbsolutePath());
  try {
    String output=testCommandLineScript(argList,null);
    if (output.contains(EXPECTED_PATTERN)) {
      fail("Output: " + output + " Negative pattern: "+ EXPECTED_PATTERN);
    }
  }
 catch (  Throwable e) {
    e.printStackTrace();
    throw e;
  }
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Fix to HIVE-10541: Beeline requires a newline at the end of each query in a file.
 * Otherwise, the last line of cmd in the script will be ignored.
 */
@Test public void testLastLineCmdInScriptFile() throws Throwable {
  final String SCRIPT_TEXT="show databases;\nshow tables;";
  final String EXPECTED_PATTERN=" testbeelinetable1 ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Select null from table , check if setting null to empty string works - Using beeling cmd line
 * argument.
 * Original beeline/sqlline used to print nulls as empty strings
 * Print PASSED or FAILED
 */
@Test public void testNullEmptyCmdArg() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "select 'abc',null,'def' from " + tableName + " limit 1 ;\n";
  final String EXPECTED_PATTERN="'abc','','def'";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--nullemptystring=true");
  argList.add("--outputformat=csv");
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testHiveVarSubstitution() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL() + "#D_TBL=dummy_t");
  final String SCRIPT_TEXT="create table ${D_TBL} (d int);\nshow tables;\n";
  final String EXPECTED_PATTERN="dummy_t";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using TSV deprecated format
 * Check for deprecation message
 */
@Test public void testTSVOutputDeprecation() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQuery();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=tsv");
  final String EXPECTED_PATTERN="Format tsv is deprecated, please use tsv2";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Beeline -hivevar option. User can specify --hivevar name=value on Beeline command line.
 * In the script, user should be able to use it in the form of ${name}, which will be substituted with
 * the value.
 * @throws Throwable
 */
@Test public void testBeelineHiveVariable() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--hivevar");
  argList.add("DUMMY_TBL=dummy");
  final String SCRIPT_TEXT="create table ${DUMMY_TBL} (d int);\nshow tables;\n";
  final String EXPECTED_PATTERN="dummy";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using DSV format, with custom delimiter ";"
 */
@Test public void testDSVOutput() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQuery();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=dsv");
  argList.add("--delimiterForDSV=;");
  final String EXPECTED_PATTERN="1;NULL;defg;ab\"c;1.0";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testTabInScriptFile() throws Throwable {
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  final String SCRIPT_TEXT="CREATE\tTABLE IF NOT EXISTS testTabInScriptFile\n(id\tint);\nSHOW TABLES;";
  final String EXPECTED_PATTERN="testTabInScriptFile";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testOneCommandInMultiLines() throws Throwable {
  final String SCRIPT_TEXT="drop table if exists multiCmdTbl;create table \nmultiCmdTbl " + "(key int);show tables; --one command in multiple lines";
  final String EXPECTED_PATTERN=" multicmdtbl ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  final String SCRIPT_TEXT_DROP="drop table\nmultiCmdTbl;show tables;";
  testScriptFile(SCRIPT_TEXT_DROP,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test writing output using CSV deprecated format
 */
@Test public void testCSVOutputWithDoubleQuotes() throws Throwable {
  String SCRIPT_TEXT=getFormatTestQueryForEableQuotes();
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=csv");
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"false");
  final String EXPECTED_PATTERN="'1','NULL','defg','ab\"c','\"aa\"','1.0'";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
  System.setProperty(SeparatedValuesOutputFormat.DISABLE_QUOTING_FOR_SV,"true");
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Beeline could show the query progress for time-consuming query.
 * @throws Throwable
 */
@Test public void testQueryProgress() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "select count(*) from " + tableName + ";\n";
  final String EXPECTED_PATTERN="number of splits";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,getBaseArgs(miniHS2.getBaseJdbcURL()));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Test Beeline will hide the query progress when silent option is set.
 * @throws Throwable
 */
@Test public void testQueryProgressHidden() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "!set silent true\n" + "select count(*) from " + tableName + ";\n";
  final String EXPECTED_PATTERN="Executing command";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,false,getBaseArgs(miniHS2.getBaseJdbcURL()));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Select null from table , check if setting null to empty string works.
 * Original beeline/sqlline used to print nulls as empty strings.
 * Also test csv2 output format
 * Print PASSED or FAILED
 */
@Test public void testNullEmpty() throws Throwable {
  final String SCRIPT_TEXT="set hive.support.concurrency = false;\n" + "!set nullemptystring true\n select 'abc',null,'def' from " + tableName + " limit 1 ;\n";
  final String EXPECTED_PATTERN="abc,,def";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  argList.add("--outputformat=csv2");
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEscapeSemiColonInEnclosedQuery() throws Throwable {
  final String QUERY_TEXT="drop table if exists multiCmdTbl;create table multiCmdTbl " + "(key int, value string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\;' LINES " + " TERMINATED BY '\\n';show tables;";
  final String EXPECTED_PATTERN=" multicmdtbl ";
  List<String> argList=getBaseArgs(miniHS2.getBaseJdbcURL());
  testCommandEnclosedQuery(QUERY_TEXT,EXPECTED_PATTERN,true,argList);
  final String QUERY_TEXT_DROP="drop table multiCmdTbl;show tables;";
  testCommandEnclosedQuery(QUERY_TEXT_DROP,EXPECTED_PATTERN,false,argList);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testEmbeddedBeelineConnection() throws Throwable {
  String embeddedJdbcURL=BeeLine.BEELINE_DEFAULT_JDBC_URL + "/Default";
  List<String> argList=getBaseArgs(embeddedJdbcURL);
  argList.add("--hivevar");
  argList.add("DUMMY_TBL=embedded_table");
  final String SCRIPT_TEXT="set hive.lock.manager=org.apache.hadoop.hive.ql.lockmgr.EmbeddedLockManager;\n" + "create table ${DUMMY_TBL} (d int);\nshow tables;\n";
  final String EXPECTED_PATTERN="embedded_table";
  testScriptFile(SCRIPT_TEXT,EXPECTED_PATTERN,true,argList);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
