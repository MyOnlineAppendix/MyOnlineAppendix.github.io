<h3 style="margin:0px">Class: org.apache.hadoop.hive.ql.exec.vector.TestVectorizationContext (30 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(24)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(21)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(3)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testUnaryMinusColumnDouble() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Float.class,"col1","table",false);
  GenericUDF gudf=new GenericUDFOPNegative();
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>(1);
  children.add(col1Expr);
  ExprNodeGenericFuncDesc negExprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.doubleTypeInfo,gudf,children);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(negExprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof DoubleColUnaryMinus);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterBooleanColumnCompareBooleanScalar() throws HiveException {
  ExprNodeGenericFuncDesc colEqualScalar=new ExprNodeGenericFuncDesc();
  GenericUDFOPEqual gudf=new GenericUDFOPEqual();
  colEqualScalar.setGenericUDF(gudf);
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>(2);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(TypeInfoFactory.booleanTypeInfo,20);
  ExprNodeColumnDesc colDesc=new ExprNodeColumnDesc(Boolean.class,"a","table",false);
  children.add(colDesc);
  children.add(constDesc);
  colEqualScalar.setChildren(children);
  List<String> columns=new ArrayList<String>();
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(colEqualScalar,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(FilterLongColEqualLongScalar.class,ve.getClass());
}

</code></pre>

<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMathFunctions() throws HiveException {
  ExprNodeGenericFuncDesc mathFuncExpr=new ExprNodeGenericFuncDesc();
  mathFuncExpr.setTypeInfo(TypeInfoFactory.doubleTypeInfo);
  ExprNodeColumnDesc colDesc1=new ExprNodeColumnDesc(Integer.class,"a","table",false);
  ExprNodeColumnDesc colDesc2=new ExprNodeColumnDesc(Double.class,"b","table",false);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>();
  children1.add(colDesc1);
  children2.add(colDesc2);
  List<String> columns=new ArrayList<String>();
  columns.add("b");
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  GenericUDFBridge gudfBridge=new GenericUDFBridge("sin",false,UDFSin.class.getName());
  mathFuncExpr.setGenericUDF(gudfBridge);
  mathFuncExpr.setChildren(children2);
  VectorExpression ve=vc.getVectorExpression(mathFuncExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  Assert.assertEquals(FuncSinDoubleToDouble.class,ve.getClass());
  GenericUDFRound udfRound=new GenericUDFRound();
  mathFuncExpr.setGenericUDF(udfRound);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncRoundDoubleToDouble.class,ve.getClass());
  GenericUDFBRound udfBRound=new GenericUDFBRound();
  mathFuncExpr.setGenericUDF(udfBRound);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncBRoundDoubleToDouble.class,ve.getClass());
  mathFuncExpr.setGenericUDF(udfRound);
  children2.add(new ExprNodeConstantDesc(4));
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(RoundWithNumDigitsDoubleToDouble.class,ve.getClass());
  Assert.assertEquals(4,((RoundWithNumDigitsDoubleToDouble)ve).getDecimalPlaces().get());
  mathFuncExpr.setGenericUDF(udfBRound);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(BRoundWithNumDigitsDoubleToDouble.class,ve.getClass());
  Assert.assertEquals(4,((BRoundWithNumDigitsDoubleToDouble)ve).getDecimalPlaces().get());
  gudfBridge=new GenericUDFBridge("log",false,UDFLog.class.getName());
  mathFuncExpr.setGenericUDF(gudfBridge);
  children2.clear();
  children2.add(new ExprNodeConstantDesc(4.0));
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLogWithBaseDoubleToDouble.class,ve.getClass());
  Assert.assertTrue(4 == ((FuncLogWithBaseDoubleToDouble)ve).getBase());
  children2.clear();
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLnDoubleToDouble.class,ve.getClass());
  children2.clear();
  children2.add(new ExprNodeConstantDesc(4.5));
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLogWithBaseDoubleToDouble.class,ve.getClass());
  Assert.assertTrue(4.5 == ((FuncLogWithBaseDoubleToDouble)ve).getBase());
  children2.clear();
  children2.add(new ExprNodeConstantDesc(4.5));
  children2.add(colDesc1);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncLogWithBaseLongToDouble.class,ve.getClass());
  Assert.assertTrue(4.5 == ((FuncLogWithBaseLongToDouble)ve).getBase());
  children2.clear();
  children2.add(colDesc2);
  children2.add(new ExprNodeConstantDesc(4.5));
  mathFuncExpr.setGenericUDF(new GenericUDFPower());
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncPowerDoubleToDouble.class,ve.getClass());
  Assert.assertTrue(4.5 == ((FuncPowerDoubleToDouble)ve).getPower());
  mathFuncExpr.setGenericUDF(udfRound);
  children2.clear();
  children2.add(colDesc2);
  mathFuncExpr.setChildren(children2);
  ve=vc.getVectorExpression(mathFuncExpr);
  Assert.assertEquals(FuncRoundDoubleToDouble.class,ve.getClass());
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSIMDGreaterEqual(){
  long a;
  long b;
  a=0;
  b=0;
  assertEquals(a >= b ? 1 : 0,((a - b) >>> 63) ^ 1);
  a=1;
  b=0;
  assertEquals(a >= b ? 1 : 0,((a - b) >>> 63) ^ 1);
  a=0;
  b=1;
  assertEquals(a >= b ? 1 : 0,((a - b) >>> 63) ^ 1);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFloatInExpressions() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Float.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPPlus udf=new GenericUDFOPPlus();
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.doubleTypeInfo,udf,children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col1");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve.getOutputType().equalsIgnoreCase("double"));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSIMDLessEqual(){
  long a;
  long b;
  a=0;
  b=0;
  assertEquals(a <= b ? 1 : 0,((b - a) >>> 63) ^ 1);
  a=1;
  b=0;
  assertEquals(a <= b ? 1 : 0,((b - a) >>> 63) ^ 1);
  a=0;
  b=1;
  assertEquals(a <= b ? 1 : 0,((b - a) >>> 63) ^ 1);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFilterStringColCompareStringColumnExpressions() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(String.class,"col1","table",false);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(String.class,"col2","table",false);
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(col2Expr);
  exprDesc.setChildren(children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringGroupColumn);
  CharTypeInfo charTypeInfo=new CharTypeInfo(10);
  col1Expr=new ExprNodeColumnDesc(charTypeInfo,"col1","table",false);
  col2Expr=new ExprNodeColumnDesc(charTypeInfo,"col2","table",false);
  udf=new GenericUDFOPGreaterThan();
  exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(col2Expr);
  exprDesc.setChildren(children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringGroupColumn);
  VarcharTypeInfo varcharTypeInfo=new VarcharTypeInfo(10);
  col1Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col1","table",false);
  col2Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col2","table",false);
  udf=new GenericUDFOPGreaterThan();
  exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(col2Expr);
  exprDesc.setChildren(children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringGroupColumn);
  col1Expr=new ExprNodeColumnDesc(String.class,"col1","table",false);
  col2Expr=new ExprNodeColumnDesc(charTypeInfo,"col2","table",false);
  udf=new GenericUDFOPGreaterThan();
  exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(col2Expr);
  exprDesc.setChildren(children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringGroupColumn);
  col1Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col1","table",false);
  col2Expr=new ExprNodeColumnDesc(charTypeInfo,"col2","table",false);
  udf=new GenericUDFOPGreaterThan();
  exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(col2Expr);
  exprDesc.setChildren(children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringGroupColumn);
  col1Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col1","table",false);
  col2Expr=new ExprNodeColumnDesc(String.class,"col2","table",false);
  udf=new GenericUDFOPGreaterThan();
  exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(col2Expr);
  exprDesc.setChildren(children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringGroupColumn);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFilterWithNegativeScalar() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(-10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  exprDesc.setChildren(children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterLongColGreaterLongScalar);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnaryStringExpressions() throws HiveException {
  ExprNodeGenericFuncDesc stringUnary=new ExprNodeGenericFuncDesc();
  stringUnary.setTypeInfo(TypeInfoFactory.stringTypeInfo);
  ExprNodeColumnDesc colDesc=new ExprNodeColumnDesc(String.class,"a","table",false);
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  children.add(colDesc);
  stringUnary.setChildren(children);
  List<String> columns=new ArrayList<String>();
  columns.add("b");
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  GenericUDF stringLower=new GenericUDFLower();
  stringUnary.setGenericUDF(stringLower);
  VectorExpression ve=vc.getVectorExpression(stringUnary);
  assertEquals(StringLower.class,ve.getClass());
  assertEquals(1,((StringLower)ve).getColNum());
  assertEquals(2,((StringLower)ve).getOutputColumn());
  vc=new VectorizationContext("name",columns);
  ExprNodeGenericFuncDesc anotherUnary=new ExprNodeGenericFuncDesc();
  anotherUnary.setTypeInfo(TypeInfoFactory.stringTypeInfo);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>();
  children2.add(stringUnary);
  anotherUnary.setChildren(children2);
  GenericUDFBridge udfbridge=new GenericUDFBridge("ltrim",false,GenericUDFLTrim.class.getName());
  anotherUnary.setGenericUDF(udfbridge);
  ve=vc.getVectorExpression(anotherUnary);
  VectorExpression childVe=ve.getChildExpressions()[0];
  assertEquals(StringLower.class,childVe.getClass());
  assertEquals(1,((StringLower)childVe).getColNum());
  assertEquals(2,((StringLower)childVe).getOutputColumn());
  assertEquals(StringLTrim.class,ve.getClass());
  assertEquals(2,((StringLTrim)ve).getInputColumn());
  assertEquals(3,((StringLTrim)ve).getOutputColumn());
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testUnaryMinusColumnLong() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  GenericUDF gudf=new GenericUDFOPNegative();
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>(1);
  children.add(col1Expr);
  ExprNodeGenericFuncDesc negExprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.longTypeInfo,gudf,children);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(negExprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof LongColUnaryMinus);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSIMDEqual(){
  long a;
  long b;
  a=0;
  b=0;
  assertEquals(a == b ? 1 : 0,(((a - b) ^ (b - a)) >>> 63) ^ 1);
  a=1;
  b=0;
  assertEquals(a == b ? 1 : 0,(((a - b) ^ (b - a)) >>> 63) ^ 1);
  a=0;
  b=1;
  assertEquals(a == b ? 1 : 0,(((a - b) ^ (b - a)) >>> 63) ^ 1);
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSIMDNotEqual(){
  long a;
  long b;
  a=0;
  b=0;
  assertEquals(a != b ? 1 : 0,((a - b) ^ (b - a)) >>> 63);
  a=1;
  b=0;
  assertEquals(a != b ? 1 : 0,((a - b) ^ (b - a)) >>> 63);
  a=0;
  b=1;
  assertEquals(a != b ? 1 : 0,((a - b) ^ (b - a)) >>> 63);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test that correct VectorExpression classes are chosen for the
 * IF (expr1, expr2, expr3) conditional expression for integer, float,
 * boolean, timestamp and string input types. expr1 is always an input column expression
 * of type long. expr2 and expr3 can be column expressions or constants of other types
 * but must have the same type.
 */
@Test public void testIfConditionalExprs() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Long.class,"col1","table",false);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Long.class,"col2","table",false);
  ExprNodeColumnDesc col3Expr=new ExprNodeColumnDesc(Long.class,"col3","table",false);
  ExprNodeConstantDesc constDesc2=new ExprNodeConstantDesc(new Integer(1));
  ExprNodeConstantDesc constDesc3=new ExprNodeConstantDesc(new Integer(2));
  GenericUDFIf udf=new GenericUDFIf();
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  children1.add(col1Expr);
  children1.add(col2Expr);
  children1.add(col3Expr);
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  columns.add("col3");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongColumn);
  children1.set(2,new ExprNodeConstantDesc(1L));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongScalar);
  children1.set(1,new ExprNodeConstantDesc(1L));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongColumn);
  col2Expr=new ExprNodeColumnDesc(Double.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(Double.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleColumnDoubleColumn);
  children1.set(2,new ExprNodeConstantDesc(1D));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleColumnDoubleScalar);
  children1.set(1,new ExprNodeConstantDesc(1D));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleScalarDoubleScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleScalarDoubleColumn);
  children1.set(2,new ExprNodeColumnDesc(Long.class,"col3","table",false));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprDoubleScalarLongColumn);
  col2Expr=new ExprNodeColumnDesc(Timestamp.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(Timestamp.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongColumn);
  ExprNodeGenericFuncDesc f=new ExprNodeGenericFuncDesc();
  f.setGenericUDF(new GenericUDFTimestamp());
  f.setTypeInfo(TypeInfoFactory.timestampTypeInfo);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>();
  f.setChildren(children2);
  children2.add(new ExprNodeConstantDesc("2013-11-05 00:00:00.000"));
  children1.set(2,f);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(IfExprLongColumnLongColumn.class == ve.getClass() || IfExprLongColumnLongScalar.class == ve.getClass());
  children1.set(1,f);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(IfExprLongColumnLongColumn.class == ve.getClass() || IfExprLongScalarLongScalar.class == ve.getClass());
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(IfExprLongColumnLongColumn.class == ve.getClass() || IfExprLongScalarLongColumn.class == ve.getClass());
  col2Expr=new ExprNodeColumnDesc(Boolean.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(Boolean.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongColumn);
  children1.set(2,new ExprNodeConstantDesc(true));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongColumnLongScalar);
  children1.set(1,new ExprNodeConstantDesc(true));
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprLongScalarLongColumn);
  constDesc2=new ExprNodeConstantDesc("Alpha");
  constDesc3=new ExprNodeConstantDesc("Bravo");
  col2Expr=new ExprNodeColumnDesc(String.class,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(String.class,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringGroupColumnStringGroupColumn);
  children1.set(2,constDesc3);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringGroupColumnStringScalar);
  children1.set(1,constDesc2);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringScalarStringScalar);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringScalarStringGroupColumn);
  CharTypeInfo charTypeInfo=new CharTypeInfo(10);
  constDesc2=new ExprNodeConstantDesc(charTypeInfo,new HiveChar("Alpha",10));
  constDesc3=new ExprNodeConstantDesc(charTypeInfo,new HiveChar("Bravo",10));
  col2Expr=new ExprNodeColumnDesc(charTypeInfo,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(charTypeInfo,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringGroupColumnStringGroupColumn);
  children1.set(2,constDesc3);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringGroupColumnCharScalar);
  children1.set(1,constDesc2);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprCharScalarStringGroupColumn);
  VarcharTypeInfo varcharTypeInfo=new VarcharTypeInfo(10);
  constDesc2=new ExprNodeConstantDesc(varcharTypeInfo,new HiveVarchar("Alpha",10));
  constDesc3=new ExprNodeConstantDesc(varcharTypeInfo,new HiveVarchar("Bravo",10));
  col2Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col2","table",false);
  col3Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col3","table",false);
  children1.set(1,col2Expr);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringGroupColumnStringGroupColumn);
  children1.set(2,constDesc3);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprStringGroupColumnVarCharScalar);
  children1.set(1,constDesc2);
  children1.set(2,col3Expr);
  ve=vc.getVectorExpression(exprDesc);
  assertTrue(ve instanceof IfExprVarCharScalarStringGroupColumn);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTimeStampUdfs() throws HiveException {
  ExprNodeGenericFuncDesc tsFuncExpr=new ExprNodeGenericFuncDesc();
  tsFuncExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  ExprNodeColumnDesc colDesc1=new ExprNodeColumnDesc(TypeInfoFactory.timestampTypeInfo,"a","table",false);
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>();
  children.add(colDesc1);
  List<String> columns=new ArrayList<String>();
  columns.add("b");
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  GenericUDFBridge gudfBridge=new GenericUDFBridge("year",false,UDFYear.class.getName());
  tsFuncExpr.setGenericUDF(gudfBridge);
  tsFuncExpr.setChildren(children);
  VectorExpression ve=vc.getVectorExpression(tsFuncExpr);
  Assert.assertEquals(VectorUDFYearLong.class,ve.getClass());
  GenericUDFToUnixTimeStamp gudf=new GenericUDFToUnixTimeStamp();
  tsFuncExpr.setGenericUDF(gudf);
  tsFuncExpr.setTypeInfo(TypeInfoFactory.longTypeInfo);
  ve=vc.getVectorExpression(tsFuncExpr);
  Assert.assertEquals(VectorUDFUnixTimeStampLong.class,ve.getClass());
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNotNullExpressions() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc=new ExprNodeGenericFuncDesc();
  greaterExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  greaterExprDesc.setChildren(children1);
  ExprNodeGenericFuncDesc isNotNullExpr=new ExprNodeGenericFuncDesc();
  isNotNullExpr.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  GenericUDFOPNotNull notNullUdf=new GenericUDFOPNotNull();
  isNotNullExpr.setGenericUDF(notNullUdf);
  List<ExprNodeDesc> childOfNot=new ArrayList<ExprNodeDesc>();
  childOfNot.add(greaterExprDesc);
  isNotNullExpr.setChildren(childOfNot);
  List<String> columns=new ArrayList<String>();
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(isNotNullExpr,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(ve.getClass(),SelectColumnIsNotNull.class);
  assertEquals(2,((SelectColumnIsNotNull)ve).getColNum());
  assertEquals(ve.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
  ve=vc.getVectorExpression(isNotNullExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(ve.getClass(),IsNotNull.class);
  assertEquals(2,((IsNotNull)ve).getColNum());
  assertEquals(ve.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
}

</code></pre>

<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBetweenFilters() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(String.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc("Alpha");
  ExprNodeConstantDesc constDesc2=new ExprNodeConstantDesc("Bravo");
  GenericUDFBetween udf=new GenericUDFBetween();
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  children1.add(new ExprNodeConstantDesc(new Boolean(false)));
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringColumnNotBetween);
  CharTypeInfo charTypeInfo=new CharTypeInfo(10);
  col1Expr=new ExprNodeColumnDesc(charTypeInfo,"col1","table",false);
  constDesc=new ExprNodeConstantDesc(charTypeInfo,new HiveChar("Alpha",10));
  constDesc2=new ExprNodeConstantDesc(charTypeInfo,new HiveChar("Bravo",10));
  udf=new GenericUDFBetween();
  children1=new ArrayList<ExprNodeDesc>();
  children1.add(new ExprNodeConstantDesc(new Boolean(false)));
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterCharColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterCharColumnNotBetween);
  VarcharTypeInfo varcharTypeInfo=new VarcharTypeInfo(10);
  col1Expr=new ExprNodeColumnDesc(varcharTypeInfo,"col1","table",false);
  constDesc=new ExprNodeConstantDesc(varcharTypeInfo,new HiveVarchar("Alpha",10));
  constDesc2=new ExprNodeConstantDesc(varcharTypeInfo,new HiveVarchar("Bravo",10));
  udf=new GenericUDFBetween();
  children1=new ArrayList<ExprNodeDesc>();
  children1.add(new ExprNodeConstantDesc(new Boolean(false)));
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  vc=new VectorizationContext("name",columns);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterVarCharColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterVarCharColumnNotBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(false)));
  children1.set(1,new ExprNodeColumnDesc(Long.class,"col1","table",false));
  children1.set(2,new ExprNodeConstantDesc(10));
  children1.set(3,new ExprNodeConstantDesc(20));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterLongColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterLongColumnNotBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(false)));
  children1.set(1,new ExprNodeColumnDesc(Double.class,"col1","table",false));
  children1.set(2,new ExprNodeConstantDesc(10.0d));
  children1.set(3,new ExprNodeConstantDesc(20.0d));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterDoubleColumnBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterDoubleColumnNotBetween);
  children1.set(0,new ExprNodeConstantDesc(new Boolean(false)));
  children1.set(1,new ExprNodeColumnDesc(Timestamp.class,"col1","table",false));
  children1.set(2,new ExprNodeConstantDesc("2013-11-05 00:00:00.000"));
  children1.set(3,new ExprNodeConstantDesc("2013-11-06 00:00:00.000"));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(FilterStringColumnBetween.class,ve.getClass());
  children1.set(0,new ExprNodeConstantDesc(new Boolean(true)));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(FilterStringColumnNotBetween.class,ve.getClass());
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFilterScalarCompareColumn() throws HiveException {
  ExprNodeGenericFuncDesc scalarGreaterColExpr=new ExprNodeGenericFuncDesc();
  GenericUDFOPGreaterThan gudf=new GenericUDFOPGreaterThan();
  scalarGreaterColExpr.setGenericUDF(gudf);
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>(2);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(TypeInfoFactory.longTypeInfo,20);
  ExprNodeColumnDesc colDesc=new ExprNodeColumnDesc(Long.class,"a","table",false);
  children.add(constDesc);
  children.add(colDesc);
  scalarGreaterColExpr.setChildren(children);
  List<String> columns=new ArrayList<String>();
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(scalarGreaterColExpr,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(FilterLongScalarGreaterLongColumn.class,ve.getClass());
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBooleanColumnCompareBooleanScalar() throws HiveException {
  ExprNodeGenericFuncDesc colEqualScalar=new ExprNodeGenericFuncDesc();
  GenericUDFOPEqual gudf=new GenericUDFOPEqual();
  colEqualScalar.setGenericUDF(gudf);
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>(2);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(TypeInfoFactory.booleanTypeInfo,20);
  ExprNodeColumnDesc colDesc=new ExprNodeColumnDesc(Boolean.class,"a","table",false);
  children.add(colDesc);
  children.add(constDesc);
  colEqualScalar.setChildren(children);
  List<String> columns=new ArrayList<String>();
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(colEqualScalar,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(LongColEqualLongScalar.class,ve.getClass());
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSIMDLessThan(){
  long a;
  long b;
  a=0;
  b=0;
  assertEquals(a < b ? 1 : 0,(a - b) >>> 63);
  a=1;
  b=0;
  assertEquals(a < b ? 1 : 0,(a - b) >>> 63);
  a=0;
  b=1;
  assertEquals(a < b ? 1 : 0,(a - b) >>> 63);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVectorizeScalarColumnExpression() throws HiveException {
  GenericUDFOPMinus gudf=new GenericUDFOPMinus();
  List<ExprNodeDesc> children=new ArrayList<ExprNodeDesc>(2);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(TypeInfoFactory.longTypeInfo,20);
  ExprNodeColumnDesc colDesc=new ExprNodeColumnDesc(Long.class,"a","table",false);
  children.add(constDesc);
  children.add(colDesc);
  ExprNodeGenericFuncDesc scalarMinusConstant=new ExprNodeGenericFuncDesc(TypeInfoFactory.longTypeInfo,gudf,children);
  List<String> columns=new ArrayList<String>();
  columns.add("a");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(scalarMinusConstant,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(ve.getClass(),LongScalarSubtractLongColumn.class);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testVectorExpressionDescriptor(){
  VectorUDFUnixTimeStampLong v1=new VectorUDFUnixTimeStampLong();
  VectorExpressionDescriptor.Builder builder1=new VectorExpressionDescriptor.Builder();
  VectorExpressionDescriptor.Descriptor d1=builder1.setMode(VectorExpressionDescriptor.Mode.PROJECTION).setNumArguments(1).setArgumentTypes(VectorExpressionDescriptor.ArgumentType.INT_DATETIME_INTERVAL_FAMILY).setInputExpressionTypes(VectorExpressionDescriptor.InputExpressionType.COLUMN).build();
  assertTrue(d1.matches(v1.getDescriptor()));
  VectorExpressionDescriptor.Builder builder2=new VectorExpressionDescriptor.Builder();
  VectorExpressionDescriptor.Descriptor d2=builder2.setMode(VectorExpressionDescriptor.Mode.FILTER).setNumArguments(2).setArgumentTypes(VectorExpressionDescriptor.ArgumentType.INT_FAMILY,VectorExpressionDescriptor.ArgumentType.FLOAT_FAMILY).setInputExpressionTypes(VectorExpressionDescriptor.InputExpressionType.COLUMN,VectorExpressionDescriptor.InputExpressionType.SCALAR).build();
  FilterLongColLessDoubleScalar v2=new FilterLongColLessDoubleScalar();
  assertTrue(d2.matches(v2.getDescriptor()));
  VectorExpressionDescriptor.Builder builder3=new VectorExpressionDescriptor.Builder();
  VectorExpressionDescriptor.Descriptor d3=builder3.setMode(VectorExpressionDescriptor.Mode.PROJECTION).setNumArguments(1).setArgumentTypes(VectorExpressionDescriptor.ArgumentType.STRING).setInputExpressionTypes(VectorExpressionDescriptor.InputExpressionType.COLUMN).build();
  StringLower v3=new StringLower();
  assertTrue(d3.matches(v3.getDescriptor()));
  VectorExpressionDescriptor.Builder builder4=new VectorExpressionDescriptor.Builder();
  VectorExpressionDescriptor.Descriptor d4=builder4.setMode(VectorExpressionDescriptor.Mode.PROJECTION).setNumArguments(1).setArgumentTypes(VectorExpressionDescriptor.ArgumentType.ALL_FAMILY).setInputExpressionTypes(VectorExpressionDescriptor.InputExpressionType.COLUMN).build();
  StringUpper v4=new StringUpper();
  assertTrue(d4.matches(v4.getDescriptor()));
  VectorExpressionDescriptor.Builder builder5=new VectorExpressionDescriptor.Builder();
  VectorExpressionDescriptor.Descriptor d5=builder5.setMode(VectorExpressionDescriptor.Mode.PROJECTION).setNumArguments(1).setArgumentTypes(VectorExpressionDescriptor.ArgumentType.STRING).setInputExpressionTypes(VectorExpressionDescriptor.InputExpressionType.COLUMN).build();
  IsNull v5=new IsNull();
  assertTrue(d5.matches(v5.getDescriptor()));
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInFiltersAndExprs() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(String.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc("Alpha");
  ExprNodeConstantDesc constDesc2=new ExprNodeConstantDesc("Bravo");
  GenericUDFIn udf=new GenericUDFIn();
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>();
  children1.add(col1Expr);
  children1.add(constDesc);
  children1.add(constDesc2);
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc(TypeInfoFactory.booleanTypeInfo,udf,children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringColumnInList);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof StringColumnInList);
  children1.set(0,new ExprNodeColumnDesc(Long.class,"col1","table",false));
  children1.set(1,new ExprNodeConstantDesc(10));
  children1.set(2,new ExprNodeConstantDesc(20));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterLongColumnInList);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof LongColumnInList);
  children1.set(0,new ExprNodeColumnDesc(Double.class,"col1","table",false));
  children1.set(1,new ExprNodeConstantDesc(10d));
  children1.set(2,new ExprNodeConstantDesc(20d));
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterDoubleColumnInList);
  ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof DoubleColumnInList);
}

</code></pre>

<pre class="type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testStringFilterExpressions() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(String.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc("Alpha");
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc exprDesc=new ExprNodeGenericFuncDesc();
  exprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  exprDesc.setChildren(children1);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(exprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertTrue(ve instanceof FilterStringGroupColGreaterStringScalar);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNullExpressions() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc=new ExprNodeGenericFuncDesc();
  greaterExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  greaterExprDesc.setChildren(children1);
  ExprNodeGenericFuncDesc isNullExpr=new ExprNodeGenericFuncDesc();
  isNullExpr.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  GenericUDFOPNull isNullUdf=new GenericUDFOPNull();
  isNullExpr.setGenericUDF(isNullUdf);
  List<ExprNodeDesc> childOfIsNull=new ArrayList<ExprNodeDesc>();
  childOfIsNull.add(greaterExprDesc);
  isNullExpr.setChildren(childOfIsNull);
  List<String> columns=new ArrayList<String>();
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(isNullExpr,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(ve.getClass(),SelectColumnIsNull.class);
  assertEquals(ve.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
  assertEquals(2,ve.getChildExpressions()[0].getOutputColumn());
  assertEquals(2,((SelectColumnIsNull)ve).getColNum());
  ve=vc.getVectorExpression(isNullExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(ve.getClass(),IsNull.class);
  assertEquals(2,((IsNull)ve).getColNum());
  assertEquals(3,ve.getOutputColumn());
  assertEquals(ve.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNotExpression() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc=new ExprNodeGenericFuncDesc();
  greaterExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  greaterExprDesc.setChildren(children1);
  ExprNodeGenericFuncDesc notExpr=new ExprNodeGenericFuncDesc();
  notExpr.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  GenericUDFOPNot notUdf=new GenericUDFOPNot();
  notExpr.setGenericUDF(notUdf);
  List<ExprNodeDesc> childOfNot=new ArrayList<ExprNodeDesc>();
  childOfNot.add(greaterExprDesc);
  notExpr.setChildren(childOfNot);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(notExpr,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(ve.getClass(),SelectColumnIsFalse.class);
  assertEquals(ve.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
  ve=vc.getVectorExpression(notExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(ve.getClass(),NotCol.class);
  assertEquals(ve.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVectorizeFilterAndOrExpression() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc=new ExprNodeGenericFuncDesc();
  greaterExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  greaterExprDesc.setChildren(children1);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Float.class,"col2","table",false);
  ExprNodeConstantDesc const2Desc=new ExprNodeConstantDesc(new Float(1.0));
  GenericUDFOPLessThan udf2=new GenericUDFOPLessThan();
  ExprNodeGenericFuncDesc lessExprDesc=new ExprNodeGenericFuncDesc();
  lessExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  lessExprDesc.setGenericUDF(udf2);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>(2);
  children2.add(col2Expr);
  children2.add(const2Desc);
  lessExprDesc.setChildren(children2);
  GenericUDFOPAnd andUdf=new GenericUDFOPAnd();
  ExprNodeGenericFuncDesc andExprDesc=new ExprNodeGenericFuncDesc();
  andExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  andExprDesc.setGenericUDF(andUdf);
  List<ExprNodeDesc> children3=new ArrayList<ExprNodeDesc>(2);
  children3.add(greaterExprDesc);
  children3.add(lessExprDesc);
  andExprDesc.setChildren(children3);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(andExprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(ve.getClass(),FilterExprAndExpr.class);
  assertEquals(ve.getChildExpressions()[0].getClass(),FilterLongColGreaterLongScalar.class);
  assertEquals(ve.getChildExpressions()[1].getClass(),FilterDoubleColLessDoubleScalar.class);
  GenericUDFOPOr orUdf=new GenericUDFOPOr();
  ExprNodeGenericFuncDesc orExprDesc=new ExprNodeGenericFuncDesc();
  orExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  orExprDesc.setGenericUDF(orUdf);
  List<ExprNodeDesc> children4=new ArrayList<ExprNodeDesc>(2);
  children4.add(greaterExprDesc);
  children4.add(lessExprDesc);
  orExprDesc.setChildren(children4);
  VectorExpression veOr=vc.getVectorExpression(orExprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(veOr.getClass(),FilterExprOrExpr.class);
  assertEquals(veOr.getChildExpressions()[0].getClass(),FilterLongColGreaterLongScalar.class);
  assertEquals(veOr.getChildExpressions()[1].getClass(),FilterDoubleColLessDoubleScalar.class);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVectorizeFilterMultiAndOrExpression() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc=new ExprNodeGenericFuncDesc();
  greaterExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  greaterExprDesc.setChildren(children1);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Float.class,"col2","table",false);
  ExprNodeConstantDesc const2Desc=new ExprNodeConstantDesc(new Float(1.0));
  GenericUDFOPLessThan udf2=new GenericUDFOPLessThan();
  ExprNodeGenericFuncDesc lessExprDesc=new ExprNodeGenericFuncDesc();
  lessExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  lessExprDesc.setGenericUDF(udf2);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>(2);
  children2.add(col2Expr);
  children2.add(const2Desc);
  lessExprDesc.setChildren(children2);
  ExprNodeColumnDesc col3Expr=new ExprNodeColumnDesc(Integer.class,"col3","table",false);
  ExprNodeConstantDesc const3Desc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf3=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc3=new ExprNodeGenericFuncDesc();
  greaterExprDesc3.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc3.setGenericUDF(udf3);
  List<ExprNodeDesc> children3=new ArrayList<ExprNodeDesc>(2);
  children3.add(col3Expr);
  children3.add(const3Desc);
  greaterExprDesc3.setChildren(children3);
  GenericUDFOPAnd andUdf=new GenericUDFOPAnd();
  ExprNodeGenericFuncDesc andExprDesc=new ExprNodeGenericFuncDesc();
  andExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  andExprDesc.setGenericUDF(andUdf);
  List<ExprNodeDesc> children4=new ArrayList<ExprNodeDesc>(2);
  children4.add(greaterExprDesc);
  children4.add(lessExprDesc);
  children4.add(greaterExprDesc3);
  andExprDesc.setChildren(children4);
  List<String> columns=new ArrayList<String>();
  columns.add("col0");
  columns.add("col1");
  columns.add("col2");
  columns.add("col3");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression ve=vc.getVectorExpression(andExprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(ve.getClass(),FilterExprAndExpr.class);
  assertEquals(ve.getChildExpressions()[0].getClass(),FilterLongColGreaterLongScalar.class);
  assertEquals(ve.getChildExpressions()[1].getClass(),FilterDoubleColLessDoubleScalar.class);
  assertEquals(ve.getChildExpressions()[2].getClass(),FilterLongColGreaterLongScalar.class);
  GenericUDFOPOr orUdf=new GenericUDFOPOr();
  ExprNodeGenericFuncDesc orExprDesc=new ExprNodeGenericFuncDesc();
  orExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  orExprDesc.setGenericUDF(orUdf);
  List<ExprNodeDesc> children5=new ArrayList<ExprNodeDesc>(2);
  children5.add(greaterExprDesc);
  children5.add(lessExprDesc);
  children5.add(greaterExprDesc3);
  orExprDesc.setChildren(children5);
  VectorExpression veOr=vc.getVectorExpression(orExprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(veOr.getClass(),FilterExprOrExpr.class);
  assertEquals(veOr.getChildExpressions()[0].getClass(),FilterLongColGreaterLongScalar.class);
  assertEquals(veOr.getChildExpressions()[1].getClass(),FilterDoubleColLessDoubleScalar.class);
  assertEquals(ve.getChildExpressions()[2].getClass(),FilterLongColGreaterLongScalar.class);
}

</code></pre>

<pre class="type-4 type-5 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testArithmeticExpressionVectorization() throws HiveException {
  GenericUDFOPPlus udf1=new GenericUDFOPPlus();
  GenericUDFOPMinus udf2=new GenericUDFOPMinus();
  GenericUDFOPMultiply udf3=new GenericUDFOPMultiply();
  GenericUDFOPPlus udf4=new GenericUDFOPPlus();
  GenericUDFOPMod udf5=new GenericUDFOPMod();
  ExprNodeGenericFuncDesc sumExpr=new ExprNodeGenericFuncDesc();
  sumExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  sumExpr.setGenericUDF(udf1);
  ExprNodeGenericFuncDesc minusExpr=new ExprNodeGenericFuncDesc();
  minusExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  minusExpr.setGenericUDF(udf2);
  ExprNodeGenericFuncDesc multiplyExpr=new ExprNodeGenericFuncDesc();
  multiplyExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  multiplyExpr.setGenericUDF(udf3);
  ExprNodeGenericFuncDesc sum2Expr=new ExprNodeGenericFuncDesc();
  sum2Expr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  sum2Expr.setGenericUDF(udf4);
  ExprNodeGenericFuncDesc modExpr=new ExprNodeGenericFuncDesc();
  modExpr.setTypeInfo(TypeInfoFactory.intTypeInfo);
  modExpr.setGenericUDF(udf5);
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Long.class,"col1","table",false);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Long.class,"col2","table",false);
  ExprNodeColumnDesc col3Expr=new ExprNodeColumnDesc(Long.class,"col3","table",false);
  ExprNodeColumnDesc col4Expr=new ExprNodeColumnDesc(Long.class,"col4","table",false);
  ExprNodeColumnDesc col5Expr=new ExprNodeColumnDesc(Long.class,"col5","table",false);
  ExprNodeColumnDesc col6Expr=new ExprNodeColumnDesc(Long.class,"col6","table",false);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children2=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children3=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children4=new ArrayList<ExprNodeDesc>(2);
  List<ExprNodeDesc> children5=new ArrayList<ExprNodeDesc>(2);
  children1.add(minusExpr);
  children1.add(multiplyExpr);
  sumExpr.setChildren(children1);
  children2.add(sum2Expr);
  children2.add(col3Expr);
  minusExpr.setChildren(children2);
  children3.add(col1Expr);
  children3.add(col2Expr);
  sum2Expr.setChildren(children3);
  children4.add(col4Expr);
  children4.add(modExpr);
  multiplyExpr.setChildren(children4);
  children5.add(col5Expr);
  children5.add(col6Expr);
  modExpr.setChildren(children5);
  VectorizationContext vc=new VectorizationContext("name");
  vc.addInitialColumn("col1");
  vc.addInitialColumn("col2");
  vc.addInitialColumn("col3");
  vc.addInitialColumn("col4");
  vc.addInitialColumn("col5");
  vc.addInitialColumn("col6");
  vc.finishedAddingInitialColumns();
  VectorExpression ve=vc.getVectorExpression(sumExpr,VectorExpressionDescriptor.Mode.PROJECTION);
  assertTrue(ve instanceof LongColAddLongColumn);
  assertEquals(2,ve.getChildExpressions().length);
  VectorExpression childExpr1=ve.getChildExpressions()[0];
  VectorExpression childExpr2=ve.getChildExpressions()[1];
  System.out.println(ve.toString());
  assertEquals(6,ve.getOutputColumn());
  assertTrue(childExpr1 instanceof LongColSubtractLongColumn);
  assertEquals(1,childExpr1.getChildExpressions().length);
  assertTrue(childExpr1.getChildExpressions()[0] instanceof LongColAddLongColumn);
  assertEquals(7,childExpr1.getOutputColumn());
  assertEquals(6,childExpr1.getChildExpressions()[0].getOutputColumn());
  assertTrue(childExpr2 instanceof LongColMultiplyLongColumn);
  assertEquals(1,childExpr2.getChildExpressions().length);
  assertTrue(childExpr2.getChildExpressions()[0] instanceof LongColModuloLongColumn);
  assertEquals(8,childExpr2.getOutputColumn());
  assertEquals(6,childExpr2.getChildExpressions()[0].getOutputColumn());
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSIMDGreaterThan(){
  long a;
  long b;
  a=0;
  b=0;
  assertEquals(a > b ? 1 : 0,(b - a) >>> 63);
  a=1;
  b=0;
  assertEquals(a > b ? 1 : 0,(b - a) >>> 63);
  a=0;
  b=1;
  assertEquals(a > b ? 1 : 0,(b - a) >>> 63);
}

</code></pre>

<pre class="type-5 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVectorizeAndOrProjectionExpression() throws HiveException {
  ExprNodeColumnDesc col1Expr=new ExprNodeColumnDesc(Integer.class,"col1","table",false);
  ExprNodeConstantDesc constDesc=new ExprNodeConstantDesc(new Integer(10));
  GenericUDFOPGreaterThan udf=new GenericUDFOPGreaterThan();
  ExprNodeGenericFuncDesc greaterExprDesc=new ExprNodeGenericFuncDesc();
  greaterExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  greaterExprDesc.setGenericUDF(udf);
  List<ExprNodeDesc> children1=new ArrayList<ExprNodeDesc>(2);
  children1.add(col1Expr);
  children1.add(constDesc);
  greaterExprDesc.setChildren(children1);
  ExprNodeColumnDesc col2Expr=new ExprNodeColumnDesc(Boolean.class,"col2","table",false);
  GenericUDFOPAnd andUdf=new GenericUDFOPAnd();
  ExprNodeGenericFuncDesc andExprDesc=new ExprNodeGenericFuncDesc();
  andExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  andExprDesc.setGenericUDF(andUdf);
  List<ExprNodeDesc> children3=new ArrayList<ExprNodeDesc>(2);
  children3.add(greaterExprDesc);
  children3.add(col2Expr);
  andExprDesc.setChildren(children3);
  List<String> columns=new ArrayList<String>();
  columns.add("col1");
  columns.add("col2");
  VectorizationContext vc=new VectorizationContext("name",columns);
  VectorExpression veAnd=vc.getVectorExpression(andExprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(veAnd.getClass(),FilterExprAndExpr.class);
  assertEquals(veAnd.getChildExpressions()[0].getClass(),FilterLongColGreaterLongScalar.class);
  assertEquals(veAnd.getChildExpressions()[1].getClass(),SelectColumnIsTrue.class);
  veAnd=vc.getVectorExpression(andExprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(veAnd.getClass(),ColAndCol.class);
  assertEquals(1,veAnd.getChildExpressions().length);
  assertEquals(veAnd.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
  assertEquals(2,((ColAndCol)veAnd).getColNum1());
  assertEquals(1,((ColAndCol)veAnd).getColNum2());
  assertEquals(3,((ColAndCol)veAnd).getOutputColumn());
  GenericUDFOPOr orUdf=new GenericUDFOPOr();
  ExprNodeGenericFuncDesc orExprDesc=new ExprNodeGenericFuncDesc();
  orExprDesc.setTypeInfo(TypeInfoFactory.booleanTypeInfo);
  orExprDesc.setGenericUDF(orUdf);
  List<ExprNodeDesc> children4=new ArrayList<ExprNodeDesc>(2);
  children4.add(greaterExprDesc);
  children4.add(col2Expr);
  orExprDesc.setChildren(children4);
  vc=new VectorizationContext("name",columns);
  VectorExpression veOr=vc.getVectorExpression(orExprDesc,VectorExpressionDescriptor.Mode.FILTER);
  assertEquals(veOr.getClass(),FilterExprOrExpr.class);
  assertEquals(veOr.getChildExpressions()[0].getClass(),FilterLongColGreaterLongScalar.class);
  assertEquals(veOr.getChildExpressions()[1].getClass(),SelectColumnIsTrue.class);
  veOr=vc.getVectorExpression(orExprDesc,VectorExpressionDescriptor.Mode.PROJECTION);
  assertEquals(veOr.getClass(),ColOrCol.class);
  assertEquals(1,veAnd.getChildExpressions().length);
  assertEquals(veAnd.getChildExpressions()[0].getClass(),LongColGreaterLongScalar.class);
  assertEquals(2,((ColOrCol)veOr).getColNum1());
  assertEquals(1,((ColOrCol)veOr).getColNum2());
  assertEquals(3,((ColOrCol)veOr).getOutputColumn());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
