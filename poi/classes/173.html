<h3 style="margin:0px">Class: org.apache.poi.ss.usermodel.BaseTestWorkbook (19 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(15)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(3)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void defaultValues() throws IOException {
  Workbook b=_testDataProvider.createWorkbook();
  assertEquals(0,b.getActiveSheetIndex());
  assertEquals(0,b.getFirstVisibleTab());
  assertEquals(0,b.getNumberOfNames());
  assertEquals(0,b.getNumberOfSheets());
  b.close();
}

</code></pre>

<pre class="type-14 type-10 type-1 type-3 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createSheet() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  assertEquals(0,wb.getNumberOfSheets());
  assertNull(wb.getSheet("Sheet1"));
  try {
    wb.getSheetAt(0);
    fail("should have thrown exceptiuon due to invalid sheet index");
  }
 catch (  IllegalArgumentException e) {
    assertFalse(e.getMessage().contains("-1"));
  }
  Sheet sheet0=wb.createSheet();
  Sheet sheet1=wb.createSheet();
  assertEquals("Sheet0",sheet0.getSheetName());
  assertEquals("Sheet1",sheet1.getSheetName());
  assertEquals(2,wb.getNumberOfSheets());
  Sheet originalSheet=wb.createSheet("Sheet3");
  Sheet fetchedSheet=wb.getSheet("sheet3");
  if (fetchedSheet == null) {
    fail("Identified bug 44892");
  }
  assertEquals("Sheet3",fetchedSheet.getSheetName());
  assertEquals(3,wb.getNumberOfSheets());
  assertSame(originalSheet,fetchedSheet);
  try {
    wb.createSheet("sHeeT3");
    fail("should have thrown exceptiuon due to duplicate sheet name");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  String[] invalidNames={"","Sheet/","Sheet\\","Sheet?","Sheet*","Sheet[","Sheet]","'Sheet'","My:Sheet"};
  for (  String sheetName : invalidNames) {
    try {
      wb.createSheet(sheetName);
      fail("should have thrown exception due to invalid sheet name: " + sheetName);
    }
 catch (    IllegalArgumentException e) {
    }
  }
  assertEquals(3,wb.getNumberOfSheets());
  wb.setSheetName(2,"I changed!");
  try {
    wb.setSheetName(1,"[I'm invalid]");
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    wb.createSheet(null);
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    wb.setSheetName(2,null);
    fail("should have thrown exceptiuon due to invalid sheet name");
  }
 catch (  IllegalArgumentException e) {
  }
  assertEquals(0,wb.getSheetIndex("sheet0"));
  assertEquals(1,wb.getSheetIndex("sheet1"));
  assertEquals(2,wb.getSheetIndex("I changed!"));
  assertSame(sheet0,wb.getSheet("sheet0"));
  assertSame(sheet1,wb.getSheet("sheet1"));
  assertSame(originalSheet,wb.getSheet("I changed!"));
  assertNull(wb.getSheet("unknown"));
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(3,wb2.getNumberOfSheets());
  assertEquals(0,wb2.getSheetIndex("sheet0"));
  assertEquals(1,wb2.getSheetIndex("sheet1"));
  assertEquals(2,wb2.getSheetIndex("I changed!"));
  wb2.close();
}

</code></pre>

<pre class="type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests that all of the unicode capable string fields can be set, written and then read back
 */
@Test public void unicodeInAll() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  CreationHelper factory=wb1.getCreationHelper();
  DataFormat df=wb1.createDataFormat();
  final String formatStr="_([$\u20ac-2]\\\\\\ * #,##0.00_);_([$\u20ac-2]\\\\\\ * \\\\\\(#,##0.00\\\\\\);_([$\u20ac-2]\\\\\\ *\\\"\\-\\\\\"??_);_(@_)";
  short fmt=df.getFormat(formatStr);
  Sheet s=wb1.createSheet("\u20ac");
  Header h=s.getHeader();
  h.setCenter("\u20ac");
  h.setLeft("\u20ac");
  h.setRight("\u20ac");
  Footer f=s.getFooter();
  f.setCenter("\u20ac");
  f.setLeft("\u20ac");
  f.setRight("\u20ac");
  Row r=s.createRow(0);
  Cell c=r.createCell(1);
  c.setCellValue(12.34);
  c.getCellStyle().setDataFormat(fmt);
  r.createCell(2);
  c.setCellValue(factory.createRichTextString("\u20ac"));
  Cell c3=r.createCell(3);
  String formulaString="TEXT(12.34,\"\u20ac###,##\")";
  c3.setCellFormula(formulaString);
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  s=wb2.getSheet("\u20ac");
  assertNotNull(s);
  h=s.getHeader();
  assertEquals(h.getCenter(),"\u20ac");
  assertEquals(h.getLeft(),"\u20ac");
  assertEquals(h.getRight(),"\u20ac");
  f=s.getFooter();
  assertEquals(f.getCenter(),"\u20ac");
  assertEquals(f.getLeft(),"\u20ac");
  assertEquals(f.getRight(),"\u20ac");
  r=s.getRow(0);
  c=r.getCell(1);
  df=wb2.createDataFormat();
  assertEquals(formatStr,df.getFormat(c.getCellStyle().getDataFormat()));
  r.getCell(2);
  assertEquals(c.getRichStringCellValue().getString(),"\u20ac");
  c3=r.getCell(3);
  assertEquals(c3.getCellFormula(),formulaString);
  wb2.close();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sheetSelection() throws IOException {
  Workbook b=_testDataProvider.createWorkbook();
  b.createSheet("Sheet One");
  b.createSheet("Sheet Two");
  b.setActiveSheet(1);
  b.setSelectedTab(1);
  b.setFirstVisibleTab(1);
  assertEquals(1,b.getActiveSheetIndex());
  assertEquals(1,b.getFirstVisibleTab());
  b.close();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Ensure that Workbook#setSheetName updates all dependent formulas and named ranges
 * @see <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=47100">Bugzilla 47100</a>
 */
@Test public void setSheetName() throws IOException {
  Workbook wb1=newSetSheetNameTestingWorkbook();
  Sheet sh1=wb1.getSheetAt(0);
  Name sale_2=wb1.getNameAt(1);
  Name sale_3=wb1.getNameAt(2);
  Name sale_4=wb1.getNameAt(3);
  assertEquals("sale_2",sale_2.getNameName());
  assertEquals("'Testing 47100'!$A$1",sale_2.getRefersToFormula());
  assertEquals("sale_3",sale_3.getNameName());
  assertEquals("'Testing 47100'!$B$1",sale_3.getRefersToFormula());
  assertEquals("sale_4",sale_4.getNameName());
  assertEquals("'To be renamed'!$A$3",sale_4.getRefersToFormula());
  FormulaEvaluator evaluator=wb1.getCreationHelper().createFormulaEvaluator();
  Cell cell0=sh1.getRow(0).getCell(0);
  Cell cell1=sh1.getRow(1).getCell(0);
  Cell cell2=sh1.getRow(2).getCell(0);
  assertEquals("SUM('Testing 47100'!A1:C1)",cell0.getCellFormula());
  assertEquals("SUM('Testing 47100'!A1:C1,'To be renamed'!A1:A5)",cell1.getCellFormula());
  assertEquals("sale_2+sale_3+'Testing 47100'!C1",cell2.getCellFormula());
  assertEquals(6.0,evaluator.evaluate(cell0).getNumberValue(),0);
  assertEquals(21.0,evaluator.evaluate(cell1).getNumberValue(),0);
  assertEquals(6.0,evaluator.evaluate(cell2).getNumberValue(),0);
  wb1.setSheetName(1,"47100 - First");
  wb1.setSheetName(2,"47100 - Second");
  assertEquals("sale_2",sale_2.getNameName());
  assertEquals("'47100 - First'!$A$1",sale_2.getRefersToFormula());
  assertEquals("sale_3",sale_3.getNameName());
  assertEquals("'47100 - First'!$B$1",sale_3.getRefersToFormula());
  assertEquals("sale_4",sale_4.getNameName());
  assertEquals("'47100 - Second'!$A$3",sale_4.getRefersToFormula());
  assertEquals("SUM('47100 - First'!A1:C1)",cell0.getCellFormula());
  assertEquals("SUM('47100 - First'!A1:C1,'47100 - Second'!A1:A5)",cell1.getCellFormula());
  assertEquals("sale_2+sale_3+'47100 - First'!C1",cell2.getCellFormula());
  evaluator.clearAllCachedResultValues();
  assertEquals(6.0,evaluator.evaluate(cell0).getNumberValue(),0);
  assertEquals(21.0,evaluator.evaluate(cell1).getNumberValue(),0);
  assertEquals(6.0,evaluator.evaluate(cell2).getNumberValue(),0);
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sh1=wb2.getSheetAt(0);
  sale_2=wb2.getNameAt(1);
  sale_3=wb2.getNameAt(2);
  sale_4=wb2.getNameAt(3);
  cell0=sh1.getRow(0).getCell(0);
  cell1=sh1.getRow(1).getCell(0);
  cell2=sh1.getRow(2).getCell(0);
  assertEquals("sale_2",sale_2.getNameName());
  assertEquals("'47100 - First'!$A$1",sale_2.getRefersToFormula());
  assertEquals("sale_3",sale_3.getNameName());
  assertEquals("'47100 - First'!$B$1",sale_3.getRefersToFormula());
  assertEquals("sale_4",sale_4.getNameName());
  assertEquals("'47100 - Second'!$A$3",sale_4.getRefersToFormula());
  assertEquals("SUM('47100 - First'!A1:C1)",cell0.getCellFormula());
  assertEquals("SUM('47100 - First'!A1:C1,'47100 - Second'!A1:A5)",cell1.getCellFormula());
  assertEquals("sale_2+sale_3+'47100 - First'!C1",cell2.getCellFormula());
  evaluator=wb2.getCreationHelper().createFormulaEvaluator();
  assertEquals(6.0,evaluator.evaluate(cell0).getNumberValue(),0);
  assertEquals(21.0,evaluator.evaluate(cell1).getNumberValue(),0);
  assertEquals(6.0,evaluator.evaluate(cell2).getNumberValue(),0);
  wb2.close();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getSetActiveSheet() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  assertEquals(0,workbook.getActiveSheetIndex());
  workbook.createSheet("sheet1");
  workbook.createSheet("sheet2");
  workbook.createSheet("sheet3");
  workbook.setActiveSheet(1);
  assertEquals(1,workbook.getActiveSheetIndex());
  workbook.setActiveSheet(0);
  assertEquals(0,workbook.getActiveSheetIndex());
  workbook.close();
}

</code></pre>

<pre class="type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void printArea() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet1=workbook.createSheet("Test Print Area");
  String sheetName1=sheet1.getSheetName();
  workbook.setPrintArea(0,1,5,4,9);
  String retrievedPrintArea=workbook.getPrintArea(0);
  assertEquals("'" + sheetName1 + "'!$B$5:$F$10",retrievedPrintArea);
  String reference="$A$1:$B$1";
  workbook.setPrintArea(0,reference);
  retrievedPrintArea=workbook.getPrintArea(0);
  assertEquals("'" + sheetName1 + "'!"+ reference,retrievedPrintArea);
  workbook.removePrintArea(0);
  assertNull(workbook.getPrintArea(0));
  workbook.close();
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sheetIterator_forEach() throws IOException {
  final Workbook wb=_testDataProvider.createWorkbook();
  wb.createSheet("Sheet0");
  wb.createSheet("Sheet1");
  wb.createSheet("Sheet2");
  int i=0;
  for (  Sheet sh : wb) {
    assertEquals("Sheet" + i,sh.getSheetName());
    i++;
  }
  wb.close();
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Expected UnsupportedOperationException:
 * should not be able to remove sheets from the sheet iterator
 */
@Test(expected=UnsupportedOperationException.class) public void sheetIterator_remove() throws IOException {
  final Workbook wb=_testDataProvider.createWorkbook();
  wb.createSheet("Sheet0");
  Iterator<Sheet> it=wb.sheetIterator();
  it.next();
  try {
    it.remove();
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void parentReferences() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  Sheet sheet=wb1.createSheet();
  assertSame(wb1,sheet.getWorkbook());
  Row row=sheet.createRow(0);
  assertSame(sheet,row.getSheet());
  Cell cell=row.createCell(1);
  assertSame(sheet,cell.getSheet());
  assertSame(row,cell.getRow());
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  sheet=wb2.getSheetAt(0);
  assertSame(wb2,sheet.getWorkbook());
  row=sheet.getRow(0);
  assertSame(sheet,row.getSheet());
  cell=row.getCell(1);
  assertSame(sheet,cell.getSheet());
  assertSame(row,cell.getRow());
  wb2.close();
}

</code></pre>

<pre class="type-1 type-3 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cloneSheet() throws IOException {
  Workbook book=_testDataProvider.createWorkbook();
  Sheet sheet=book.createSheet("TEST");
  sheet.createRow(0).createCell(0).setCellValue("Test");
  sheet.createRow(1).createCell(0).setCellValue(36.6);
  sheet.addMergedRegion(new CellRangeAddress(0,1,0,2));
  sheet.addMergedRegion(new CellRangeAddress(2,3,0,2));
  assertTrue(sheet.isSelected());
  Sheet clonedSheet=book.cloneSheet(0);
  assertEquals("TEST (2)",clonedSheet.getSheetName());
  assertEquals(2,clonedSheet.getPhysicalNumberOfRows());
  assertEquals(2,clonedSheet.getNumMergedRegions());
  assertFalse(clonedSheet.isSelected());
  sheet.createRow(2).createCell(0).setCellValue(1);
  sheet.addMergedRegion(new CellRangeAddress(4,5,0,2));
  assertEquals(2,clonedSheet.getPhysicalNumberOfRows());
  assertEquals(2,clonedSheet.getNumMergedRegions());
  clonedSheet.createRow(2).createCell(0).setCellValue(1);
  clonedSheet.addMergedRegion(new CellRangeAddress(6,7,0,2));
  assertEquals(3,clonedSheet.getPhysicalNumberOfRows());
  assertEquals(3,clonedSheet.getNumMergedRegions());
  book.close();
}

</code></pre>

<pre class="type-10 type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void windowOneDefaults() throws IOException {
  Workbook b=_testDataProvider.createWorkbook();
  try {
    assertEquals(b.getActiveSheetIndex(),0);
    assertEquals(b.getFirstVisibleTab(),0);
  }
 catch (  NullPointerException npe) {
    fail("WindowOneRecord in Workbook is probably not initialized");
  }
  b.close();
}

</code></pre>

<pre class="type-1 type-6 type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Expected ConcurrentModificationException:
 * should not be able to advance an iterator when the
 * underlying data has been reordered
 */
@Test(expected=ConcurrentModificationException.class) public void sheetIterator_sheetsReordered() throws IOException {
  final Workbook wb=_testDataProvider.createWorkbook();
  wb.createSheet("Sheet0");
  wb.createSheet("Sheet1");
  wb.createSheet("Sheet2");
  Iterator<Sheet> it=wb.sheetIterator();
  it.next();
  wb.setSheetOrder("Sheet2",1);
  try {
    assertEquals("Sheet1",it.next().getSheetName());
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test is kept to ensure stub for deprecated business method passes test.
 * @Deprecated remove this test when {@link Workbook#setRepeatingRowsAndColumns(int,int,int,int,int)} 
 * is removed 
 */
@Deprecated @Test public void setRepeatingRowsAnsColumns() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  Sheet sheet1=wb.createSheet();
  wb.setRepeatingRowsAndColumns(wb.getSheetIndex(sheet1),0,0,0,3);
  assertEquals("1:4",sheet1.getRepeatingRows().formatAsString());
  assertEquals("A:A",sheet1.getRepeatingColumns().formatAsString());
  Sheet sheet2=wb.createSheet("My' Sheet");
  wb.setRepeatingRowsAndColumns(wb.getSheetIndex(sheet2),0,0,0,3);
  assertEquals("1:4",sheet2.getRepeatingRows().formatAsString());
  assertEquals("A:A",sheet1.getRepeatingColumns().formatAsString());
  wb.close();
}

</code></pre>

<pre class="type-12 type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void setSheetOrder() throws IOException {
  Workbook wb=_testDataProvider.createWorkbook();
  for (int i=0; i < 10; i++) {
    wb.createSheet("Sheet " + i);
  }
  assertEquals(0,wb.getSheetIndex("Sheet 0"));
  assertEquals(1,wb.getSheetIndex("Sheet 1"));
  assertEquals(2,wb.getSheetIndex("Sheet 2"));
  assertEquals(3,wb.getSheetIndex("Sheet 3"));
  assertEquals(4,wb.getSheetIndex("Sheet 4"));
  assertEquals(5,wb.getSheetIndex("Sheet 5"));
  assertEquals(6,wb.getSheetIndex("Sheet 6"));
  assertEquals(7,wb.getSheetIndex("Sheet 7"));
  assertEquals(8,wb.getSheetIndex("Sheet 8"));
  assertEquals(9,wb.getSheetIndex("Sheet 9"));
  assertEquals(0,wb.getActiveSheetIndex());
  wb.setSheetOrder("Sheet 6",0);
  assertEquals(1,wb.getActiveSheetIndex());
  wb.setSheetOrder("Sheet 3",7);
  wb.setSheetOrder("Sheet 1",9);
  assertEquals(1,wb.getActiveSheetIndex());
  assertEquals(0,wb.getSheetIndex("Sheet 6"));
  assertEquals(1,wb.getSheetIndex("Sheet 0"));
  assertEquals(2,wb.getSheetIndex("Sheet 2"));
  assertEquals(3,wb.getSheetIndex("Sheet 4"));
  assertEquals(4,wb.getSheetIndex("Sheet 5"));
  assertEquals(5,wb.getSheetIndex("Sheet 7"));
  assertEquals(6,wb.getSheetIndex("Sheet 3"));
  assertEquals(7,wb.getSheetIndex("Sheet 8"));
  assertEquals(8,wb.getSheetIndex("Sheet 9"));
  assertEquals(9,wb.getSheetIndex("Sheet 1"));
  Workbook wbr=_testDataProvider.writeOutAndReadBack(wb);
  wb.close();
  assertEquals(0,wbr.getSheetIndex("Sheet 6"));
  assertEquals(1,wbr.getSheetIndex("Sheet 0"));
  assertEquals(2,wbr.getSheetIndex("Sheet 2"));
  assertEquals(3,wbr.getSheetIndex("Sheet 4"));
  assertEquals(4,wbr.getSheetIndex("Sheet 5"));
  assertEquals(5,wbr.getSheetIndex("Sheet 7"));
  assertEquals(6,wbr.getSheetIndex("Sheet 3"));
  assertEquals(7,wbr.getSheetIndex("Sheet 8"));
  assertEquals(8,wbr.getSheetIndex("Sheet 9"));
  assertEquals(9,wbr.getSheetIndex("Sheet 1"));
  assertEquals(1,wb.getActiveSheetIndex());
  for (int i=0; i < 10; i++) {
    Sheet s=wbr.getSheetAt(i);
    assertEquals(i,wbr.getSheetIndex(s));
  }
  wbr.close();
}

</code></pre>

<pre class="type-2 type-10 type-1 type-15 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * POI allows creating sheets with names longer than 31 characters.
 * Excel opens files with long sheet names without error or warning.
 * However, long sheet names are silently truncated to 31 chars.  In order to
 * avoid funny duplicate sheet name errors, POI enforces uniqueness on only the first 31 chars.
 * but for the purpose of uniqueness long sheet names are silently truncated to 31 chars.
 */
@Test public void createSheetWithLongNames() throws IOException {
  Workbook wb1=_testDataProvider.createWorkbook();
  String sheetName1="My very long sheet name which is longer than 31 chars";
  String truncatedSheetName1=sheetName1.substring(0,31);
  Sheet sh1=wb1.createSheet(sheetName1);
  assertEquals(truncatedSheetName1,sh1.getSheetName());
  assertSame(sh1,wb1.getSheet(truncatedSheetName1));
  wb1.setSheetName(0,sheetName1);
  assertEquals(truncatedSheetName1,sh1.getSheetName());
  assertSame(sh1,wb1.getSheet(truncatedSheetName1));
  String sheetName2="My very long sheet name which is longer than 31 chars " + "and sheetName2.substring(0, 31) == sheetName1.substring(0, 31)";
  try {
    wb1.createSheet(sheetName2);
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("The workbook already contains a sheet of this name",e.getMessage());
  }
  String sheetName3="POI allows creating sheets with names longer than 31 characters";
  String truncatedSheetName3=sheetName3.substring(0,31);
  Sheet sh3=wb1.createSheet(sheetName3);
  assertEquals(truncatedSheetName3,sh3.getSheetName());
  assertSame(sh3,wb1.getSheet(truncatedSheetName3));
  Workbook wb2=_testDataProvider.writeOutAndReadBack(wb1);
  wb1.close();
  assertEquals(2,wb2.getNumberOfSheets());
  assertEquals(0,wb2.getSheetIndex(truncatedSheetName1));
  assertEquals(1,wb2.getSheetIndex(truncatedSheetName3));
  wb2.close();
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void test58499() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  Sheet sheet=workbook.createSheet();
  for (int i=0; i < 900; i++) {
    Row r=sheet.createRow(i);
    Cell c=r.createCell(0);
    CellStyle cs=workbook.createCellStyle();
    c.setCellStyle(cs);
    c.setCellValue("AAA");
  }
  OutputStream os=new NullOutputStream();
  try {
    workbook.write(os);
  }
  finally {
    os.close();
  }
  workbook.close();
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void removeSheetAt() throws IOException {
  Workbook workbook=_testDataProvider.createWorkbook();
  try {
    workbook.createSheet("sheet1");
    workbook.createSheet("sheet2");
    workbook.createSheet("sheet3");
    assertEquals(3,workbook.getNumberOfSheets());
    assertEquals(0,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(1);
    assertEquals(2,workbook.getNumberOfSheets());
    assertEquals("sheet3",workbook.getSheetName(1));
    assertEquals(0,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(0);
    assertEquals(1,workbook.getNumberOfSheets());
    assertEquals("sheet3",workbook.getSheetName(0));
    assertEquals(0,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(0);
    assertEquals(0,workbook.getNumberOfSheets());
    assertEquals(0,workbook.getActiveSheetIndex());
    workbook.createSheet("sheet1");
    workbook.createSheet("sheet2");
    workbook.createSheet("sheet3");
    workbook.createSheet("sheet4");
    assertEquals(4,workbook.getNumberOfSheets());
    assertEquals(0,workbook.getActiveSheetIndex());
    workbook.setActiveSheet(2);
    assertEquals(2,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(2);
    assertEquals(2,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(1);
    assertEquals(1,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(0);
    assertEquals(0,workbook.getActiveSheetIndex());
    workbook.removeSheetAt(0);
    assertEquals(0,workbook.getActiveSheetIndex());
  }
  finally {
    workbook.close();
  }
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Expected ConcurrentModificationException:
 * should not be able to advance an iterator when the
 * underlying data has been reordered
 */
@Test(expected=ConcurrentModificationException.class) public void sheetIterator_sheetRemoved() throws IOException {
  final Workbook wb=_testDataProvider.createWorkbook();
  wb.createSheet("Sheet0");
  wb.createSheet("Sheet1");
  wb.createSheet("Sheet2");
  Iterator<Sheet> it=wb.sheetIterator();
  wb.removeSheetAt(1);
  try {
    it.next();
  }
  finally {
    wb.close();
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
