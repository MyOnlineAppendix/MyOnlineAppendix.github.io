<h3 style="margin:0px">Class: org.apache.poi.xssf.usermodel.TestXSSFComment (7 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(6)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(1)</kbd></button>&nbsp;<button id="18"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('18')" data-toggle="tooltip" title="Is not executed with the test suite"><kbd id="tag-18"class="label-info"style="display: inline-block;font-size:7pt" >IgnoredMethod&nbsp;(1)</kbd></button>&nbsp;<button id="15"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('15')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-15"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getSetCol(){
  CommentsTable sheetComments=new CommentsTable();
  XSSFVMLDrawing vml=new XSSFVMLDrawing();
  CTComment ctComment=sheetComments.newComment(CellAddress.A1);
  CTShape vmlShape=vml.newCommentShape();
  XSSFComment comment=new XSSFComment(sheetComments,ctComment,vmlShape);
  comment.setColumn(1);
  assertEquals(1,comment.getColumn());
  assertEquals(1,new CellReference(ctComment.getRef()).getCol());
  assertEquals(1,vmlShape.getClientDataArray(0).getColumnArray(0).intValue());
  comment.setColumn(5);
  assertEquals(5,comment.getColumn());
  assertEquals(5,new CellReference(ctComment.getRef()).getCol());
  assertEquals(5,vmlShape.getClientDataArray(0).getColumnArray(0).intValue());
}

</code></pre>

<pre class="type-1 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * test properties of a newly constructed comment
 */
@Test public void constructor(){
  CommentsTable sheetComments=new CommentsTable();
  assertNotNull(sheetComments.getCTComments().getCommentList());
  assertNotNull(sheetComments.getCTComments().getAuthors());
  assertEquals(1,sheetComments.getCTComments().getAuthors().sizeOfAuthorArray());
  assertEquals(1,sheetComments.getNumberOfAuthors());
  CTComment ctComment=sheetComments.newComment(CellAddress.A1);
  CTShape vmlShape=CTShape.Factory.newInstance();
  XSSFComment comment=new XSSFComment(sheetComments,ctComment,vmlShape);
  assertEquals(null,comment.getString());
  assertEquals(0,comment.getRow());
  assertEquals(0,comment.getColumn());
  assertEquals("",comment.getAuthor());
  assertEquals(false,comment.isVisible());
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void author(){
  CommentsTable sheetComments=new CommentsTable();
  CTComment ctComment=sheetComments.newComment(CellAddress.A1);
  assertEquals(1,sheetComments.getNumberOfAuthors());
  XSSFComment comment=new XSSFComment(sheetComments,ctComment,null);
  assertEquals("",comment.getAuthor());
  comment.setAuthor("Apache POI");
  assertEquals("Apache POI",comment.getAuthor());
  assertEquals(2,sheetComments.getNumberOfAuthors());
  comment.setAuthor("Apache POI");
  assertEquals(2,sheetComments.getNumberOfAuthors());
  comment.setAuthor("");
  assertEquals("",comment.getAuthor());
  assertEquals(2,sheetComments.getNumberOfAuthors());
}

</code></pre>

<pre class="type-10 type-1 type-15 type-4 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void setString(){
  XSSFWorkbook wb=new XSSFWorkbook();
  XSSFSheet sh=wb.createSheet();
  XSSFComment comment=sh.createDrawingPatriarch().createCellComment(new XSSFClientAnchor());
  try {
    comment.setString(new HSSFRichTextString(TEST_RICHTEXTSTRING));
    fail("expected exception");
  }
 catch (  IllegalArgumentException e) {
    assertEquals("Only XSSFRichTextString argument is supported",e.getMessage());
  }
  comment.setString(TEST_RICHTEXTSTRING);
  assertEquals(TEST_RICHTEXTSTRING,comment.getString().getString());
  comment.setString(TEST_RICHTEXTSTRING);
  CTComment ctComment=comment.getCTComment();
  XmlObject[] obj=ctComment.selectPath("declare namespace w='http://schemas.openxmlformats.org/spreadsheetml/2006/main' .//w:text");
  assertEquals(1,obj.length);
  assertEquals(TEST_RICHTEXTSTRING,comment.getString().getString());
  assertSame(comment.getString(),comment.getString());
  XSSFRichTextString richText=new XSSFRichTextString(TEST_RICHTEXTSTRING);
  XSSFFont font1=wb.createFont();
  font1.setFontName("Tahoma");
  font1.setFontHeight(8.5);
  font1.setItalic(true);
  font1.setColor(IndexedColors.BLUE_GREY.getIndex());
  richText.applyFont(0,5,font1);
  comment.setString(richText);
  obj=ctComment.selectPath("declare namespace w='http://schemas.openxmlformats.org/spreadsheetml/2006/main' .//w:text");
  assertEquals(1,obj.length);
  assertSame(comment.getString(),richText);
  CTRPrElt rPr=richText.getCTRst().getRArray(0).getRPr();
  assertEquals(true,rPr.getIArray(0).getVal());
  assertEquals(8.5,rPr.getSzArray(0).getVal(),0);
  assertEquals(IndexedColors.BLUE_GREY.getIndex(),rPr.getColorArray(0).getIndexed());
  assertEquals("Tahoma",rPr.getRFontArray(0).getVal());
  assertNotNull(XSSFTestDataSamples.writeOutAndReadBack(wb));
}

</code></pre>

<pre class="type-18 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Is not executed with the test suite
- Executes methods or other tests from the same test unit
"></span><br>
@Ignore("Used for manual testing with opening the resulting Workbook in Excel") @Test public void testBug58175a() throws IOException {
  Workbook wb=new SXSSFWorkbook();
  try {
    Sheet sheet=wb.createSheet();
    Row row=sheet.createRow(1);
    Cell cell=row.createCell(3);
    cell.setCellValue("F4");
    Drawing drawing=sheet.createDrawingPatriarch();
    CreationHelper factory=wb.getCreationHelper();
    ClientAnchor anchor=factory.createClientAnchor();
    anchor.setCol1(cell.getColumnIndex());
    anchor.setCol2(cell.getColumnIndex() + 1);
    anchor.setRow1(row.getRowNum());
    anchor.setRow2(row.getRowNum() + 3);
    Comment comment=drawing.createCellComment(anchor);
    RichTextString str=factory.createRichTextString("Hello, World!");
    comment.setString(str);
    comment.setAuthor("Apache POI");
    cell.setCellComment(comment);
    OutputStream out=new FileOutputStream("C:\\temp\\58175.xlsx");
    try {
      wb.write(out);
    }
  finally {
      out.close();
    }
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBug58175() throws IOException {
  Workbook wb=new SXSSFWorkbook();
  try {
    Sheet sheet=wb.createSheet();
    Row row=sheet.createRow(1);
    Cell cell=row.createCell(3);
    cell.setCellValue("F4");
    CreationHelper factory=wb.getCreationHelper();
    ClientAnchor anchor=factory.createClientAnchor();
    anchor.setCol1(cell.getColumnIndex());
    anchor.setCol2(cell.getColumnIndex() + 1);
    anchor.setRow1(row.getRowNum());
    anchor.setRow2(row.getRowNum() + 3);
    XSSFClientAnchor ca=(XSSFClientAnchor)anchor;
    CommentsTable comments=((SXSSFWorkbook)wb).getXSSFWorkbook().getSheetAt(0).getCommentsTable(true);
    XSSFVMLDrawing vml=((SXSSFWorkbook)wb).getXSSFWorkbook().getSheetAt(0).getVMLDrawing(true);
    CTShape vmlShape1=vml.newCommentShape();
    if (ca.isSet()) {
      String position=ca.getCol1() + ", 0, " + ca.getRow1()+ ", 0, "+ ca.getCol2()+ ", 0, "+ ca.getRow2()+ ", 0";
      vmlShape1.getClientDataArray(0).setAnchorArray(0,position);
    }
    XSSFComment shape1=new XSSFComment(comments,comments.newComment(CellAddress.A1),vmlShape1);
    shape1.setColumn(ca.getCol1());
    shape1.setRow(ca.getRow1());
    CTShape vmlShape2=vml.newCommentShape();
    if (ca.isSet()) {
      String position=ca.getCol1() + ", 0, " + ca.getRow1()+ ", 0, "+ ca.getCol2()+ ", 0, "+ ca.getRow2()+ ", 0";
      vmlShape2.getClientDataArray(0).setAnchorArray(0,position);
    }
    CellAddress ref=new CellAddress(ca.getRow1(),ca.getCol1());
    XSSFComment shape2=new XSSFComment(comments,comments.newComment(ref),vmlShape2);
    assertEquals(shape1.getAuthor(),shape2.getAuthor());
    assertEquals(shape1.getClientAnchor(),shape2.getClientAnchor());
    assertEquals(shape1.getColumn(),shape2.getColumn());
    assertEquals(shape1.getRow(),shape2.getRow());
    assertEquals(shape1.getCTComment().toString(),shape2.getCTComment().toString());
    assertEquals(shape1.getCTComment().getRef(),shape2.getCTComment().getRef());
    assertEquals("The vmlShapes should have equal content afterwards",vmlShape1.toString().replaceAll("_x0000_s\\d+","_x0000_s0000"),vmlShape2.toString().replaceAll("_x0000_s\\d+","_x0000_s0000"));
  }
  finally {
    wb.close();
  }
}

</code></pre>

<pre class="type-1 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getSetRow(){
  CommentsTable sheetComments=new CommentsTable();
  XSSFVMLDrawing vml=new XSSFVMLDrawing();
  CTComment ctComment=sheetComments.newComment(CellAddress.A1);
  CTShape vmlShape=vml.newCommentShape();
  XSSFComment comment=new XSSFComment(sheetComments,ctComment,vmlShape);
  comment.setRow(1);
  assertEquals(1,comment.getRow());
  assertEquals(1,new CellReference(ctComment.getRef()).getRow());
  assertEquals(1,vmlShape.getClientDataArray(0).getRowArray(0).intValue());
  comment.setRow(5);
  assertEquals(5,comment.getRow());
  assertEquals(5,new CellReference(ctComment.getRef()).getRow());
  assertEquals(5,vmlShape.getClientDataArray(0).getRowArray(0).intValue());
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
